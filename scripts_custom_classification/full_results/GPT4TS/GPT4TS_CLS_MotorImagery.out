Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.861120700836182
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.913402795791626
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.938495635986328
Epoch: 3, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.678968667984009
Epoch: 4, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.688 Vali Acc: 0.600 Test Loss: 0.688 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 3.461515188217163
Epoch: 5, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.752 Vali Acc: 0.570 Test Loss: 0.752 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.423462152481079
Epoch: 6, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.284384489059448
Epoch: 7, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.888 Vali Acc: 0.510 Test Loss: 0.888 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.919355630874634
Epoch: 8, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.032 Vali Acc: 0.580 Test Loss: 1.032 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7071096897125244
Epoch: 9, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.060 Vali Acc: 0.580 Test Loss: 1.060 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.333677530288696
Epoch: 10, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8846890926361084
Epoch: 11, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.979 Vali Acc: 0.610 Test Loss: 0.979 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609990).  Saving model ...
Epoch: 12 cost time: 4.29590916633606
Epoch: 12, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.897512435913086
Epoch: 13, Steps: 18 | Train Loss: 0.387 Vali Loss: 2.225 Vali Acc: 0.530 Test Loss: 2.225 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5375359058380127
Epoch: 14, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.802 Vali Acc: 0.510 Test Loss: 1.802 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.4427807331085205
Epoch: 15, Steps: 18 | Train Loss: 0.421 Vali Loss: 1.688 Vali Acc: 0.580 Test Loss: 1.688 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.967519521713257
Epoch: 16, Steps: 18 | Train Loss: 0.825 Vali Loss: 1.662 Vali Acc: 0.490 Test Loss: 1.662 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9608726501464844
Epoch: 17, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.601 Vali Acc: 0.600 Test Loss: 1.601 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.276073932647705
Epoch: 18, Steps: 18 | Train Loss: 0.346 Vali Loss: 2.141 Vali Acc: 0.510 Test Loss: 2.141 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.9705142974853516
Epoch: 19, Steps: 18 | Train Loss: 0.313 Vali Loss: 5.129 Vali Acc: 0.460 Test Loss: 5.129 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.7022571563720703
Epoch: 20, Steps: 18 | Train Loss: 0.323 Vali Loss: 2.089 Vali Acc: 0.520 Test Loss: 2.089 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.423083782196045
Epoch: 21, Steps: 18 | Train Loss: 0.386 Vali Loss: 2.251 Vali Acc: 0.520 Test Loss: 2.251 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 61369346
model size : 248.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.406136512756348
Epoch: 1, Steps: 18 | Train Loss: 0.780 Vali Loss: 0.697 Vali Acc: 0.560 Test Loss: 0.697 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.828909397125244
Epoch: 2, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.182245969772339
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.144575357437134
Epoch: 4, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.803395986557007
Epoch: 5, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.788 Vali Acc: 0.610 Test Loss: 0.788 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 3.083787202835083
Epoch: 6, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.794 Vali Acc: 0.580 Test Loss: 0.794 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6971237659454346
Epoch: 7, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.740 Vali Acc: 0.600 Test Loss: 0.740 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4888663291931152
Epoch: 8, Steps: 18 | Train Loss: 0.462 Vali Loss: 0.802 Vali Acc: 0.590 Test Loss: 0.802 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9742867946624756
Epoch: 9, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.865 Vali Acc: 0.600 Test Loss: 0.865 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.186722755432129
Epoch: 10, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.831 Vali Acc: 0.590 Test Loss: 0.831 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.84672212600708
Epoch: 11, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.653 Vali Acc: 0.480 Test Loss: 1.653 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.812743663787842
Epoch: 12, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1656670570373535
Epoch: 13, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.255 Vali Acc: 0.560 Test Loss: 1.255 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.586160182952881
Epoch: 14, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.262 Vali Acc: 0.570 Test Loss: 1.262 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.775688409805298
Epoch: 15, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.446 Vali Acc: 0.500 Test Loss: 1.446 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 61221890
model size : 248.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.890536308288574
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.9239060878753662
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6567459106445312
Epoch: 3, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.016252279281616
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.013106346130371
Epoch: 5, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.698 Vali Acc: 0.600 Test Loss: 0.698 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 2.653700828552246
Epoch: 6, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.763 Vali Acc: 0.570 Test Loss: 0.763 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.689049482345581
Epoch: 7, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.785 Vali Acc: 0.540 Test Loss: 0.785 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3532981872558594
Epoch: 8, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3398993015289307
Epoch: 9, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.917 Vali Acc: 0.550 Test Loss: 0.917 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7374939918518066
Epoch: 10, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4116296768188477
Epoch: 11, Steps: 18 | Train Loss: 0.453 Vali Loss: 1.062 Vali Acc: 0.510 Test Loss: 1.062 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1607823371887207
Epoch: 12, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.018 Vali Acc: 0.510 Test Loss: 1.018 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8220510482788086
Epoch: 13, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.132 Vali Acc: 0.470 Test Loss: 1.132 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.8014729022979736
Epoch: 14, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.121 Vali Acc: 0.560 Test Loss: 1.121 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0450477600097656
Epoch: 15, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.180 Vali Acc: 0.460 Test Loss: 1.180 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 61148162
model size : 247.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.286491632461548
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.733 Vali Acc: 0.450 Test Loss: 0.733 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.8003413677215576
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.683 Vali Acc: 0.500 Test Loss: 0.683 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 4.083208322525024
Epoch: 3, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.700 Vali Acc: 0.600 Test Loss: 0.700 Test Acc: 0.600
Validation loss decreased (-0.499993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 3.588998556137085
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.761 Vali Acc: 0.610 Test Loss: 0.761 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609992).  Saving model ...
Epoch: 5 cost time: 3.947357416152954
Epoch: 5, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.60628342628479
Epoch: 6, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.920 Vali Acc: 0.600 Test Loss: 0.920 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.636617660522461
Epoch: 7, Steps: 18 | Train Loss: 0.509 Vali Loss: 1.143 Vali Acc: 0.430 Test Loss: 1.143 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.13107967376709
Epoch: 8, Steps: 18 | Train Loss: 0.497 Vali Loss: 1.184 Vali Acc: 0.430 Test Loss: 1.184 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.544302463531494
Epoch: 9, Steps: 18 | Train Loss: 0.484 Vali Loss: 1.113 Vali Acc: 0.490 Test Loss: 1.113 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.496293067932129
Epoch: 10, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.191 Vali Acc: 0.580 Test Loss: 1.191 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.9793245792388916
Epoch: 11, Steps: 18 | Train Loss: 0.527 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6101458072662354
Epoch: 12, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.141 Vali Acc: 0.470 Test Loss: 1.141 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.7335433959960938
Epoch: 13, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.384 Vali Acc: 0.530 Test Loss: 1.384 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.2813661098480225
Epoch: 14, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.539 Vali Acc: 0.500 Test Loss: 1.539 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 62085122
model size : 251.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.730687141418457
Epoch: 1, Steps: 18 | Train Loss: 0.747 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.6578524112701416
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.727 Vali Acc: 0.570 Test Loss: 0.727 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.313265562057495
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.755 Vali Acc: 0.590 Test Loss: 0.755 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 1.7682418823242188
Epoch: 4, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.850 Vali Acc: 0.530 Test Loss: 0.850 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.375784397125244
Epoch: 5, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4482736587524414
Epoch: 6, Steps: 18 | Train Loss: 0.550 Vali Loss: 1.630 Vali Acc: 0.500 Test Loss: 1.630 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.818101167678833
Epoch: 7, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.817 Vali Acc: 0.560 Test Loss: 0.817 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5258736610412598
Epoch: 8, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 1.828805685043335
Epoch: 9, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.128 Vali Acc: 0.490 Test Loss: 1.128 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5232365131378174
Epoch: 10, Steps: 18 | Train Loss: 0.362 Vali Loss: 2.465 Vali Acc: 0.490 Test Loss: 2.465 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.296123743057251
Epoch: 11, Steps: 18 | Train Loss: 0.567 Vali Loss: 1.309 Vali Acc: 0.470 Test Loss: 1.309 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7942616939544678
Epoch: 12, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.402 Vali Acc: 0.510 Test Loss: 1.402 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5345168113708496
Epoch: 13, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.708 Vali Acc: 0.470 Test Loss: 1.708 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6043903827667236
Epoch: 14, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.399 Vali Acc: 0.550 Test Loss: 1.399 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4784772396087646
Epoch: 15, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.318 Vali Acc: 0.550 Test Loss: 1.318 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.233708381652832
Epoch: 16, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.998 Vali Acc: 0.510 Test Loss: 1.998 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.595064640045166
Epoch: 17, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.859 Vali Acc: 0.410 Test Loss: 1.859 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4836068153381348
Epoch: 18, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.859 Vali Acc: 0.530 Test Loss: 1.859 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 61949954
model size : 251.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.312584400177002
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.708 Vali Acc: 0.570 Test Loss: 0.708 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.8579251766204834
Epoch: 2, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.708 Vali Acc: 0.580 Test Loss: 0.708 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.094985246658325
Epoch: 3, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9879982471466064
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9219605922698975
Epoch: 5, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.697 Vali Acc: 0.560 Test Loss: 0.697 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.123030662536621
Epoch: 6, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8500537872314453
Epoch: 7, Steps: 18 | Train Loss: 0.494 Vali Loss: 1.332 Vali Acc: 0.510 Test Loss: 1.332 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4555139541625977
Epoch: 8, Steps: 18 | Train Loss: 0.445 Vali Loss: 0.792 Vali Acc: 0.590 Test Loss: 0.792 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 9 cost time: 2.1316168308258057
Epoch: 9, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.968 Vali Acc: 0.540 Test Loss: 0.968 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7058780193328857
Epoch: 10, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.481 Vali Acc: 0.540 Test Loss: 1.481 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.057152032852173
Epoch: 11, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.840 Vali Acc: 0.630 Test Loss: 0.840 Test Acc: 0.630
Validation loss decreased (-0.589992 --> -0.629992).  Saving model ...
Epoch: 12 cost time: 2.133692741394043
Epoch: 12, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.901 Vali Acc: 0.600 Test Loss: 0.901 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1244266033172607
Epoch: 13, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.427 Vali Acc: 0.570 Test Loss: 1.427 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7620205879211426
Epoch: 14, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.080 Vali Acc: 0.610 Test Loss: 1.080 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1312172412872314
Epoch: 15, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.985 Vali Acc: 0.570 Test Loss: 0.985 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9058966636657715
Epoch: 16, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.153 Vali Acc: 0.530 Test Loss: 1.153 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.103489875793457
Epoch: 17, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.240 Vali Acc: 0.530 Test Loss: 1.240 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7668430805206299
Epoch: 18, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.426 Vali Acc: 0.530 Test Loss: 1.426 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.157567262649536
Epoch: 19, Steps: 18 | Train Loss: 0.212 Vali Loss: 2.104 Vali Acc: 0.540 Test Loss: 2.104 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0973708629608154
Epoch: 20, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.758 Vali Acc: 0.550 Test Loss: 1.758 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.974921703338623
Epoch: 21, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.893 Vali Acc: 0.540 Test Loss: 1.893 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 61882370
model size : 250.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps131_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.181488037109375
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.1482043266296387
Epoch: 2, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.9640822410583496
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0036895275115967
Epoch: 4, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.11565899848938
Epoch: 5, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.872 Vali Acc: 0.490 Test Loss: 0.872 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2232580184936523
Epoch: 6, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.971 Vali Acc: 0.490 Test Loss: 0.971 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.951394557952881
Epoch: 7, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 2.999706745147705
Epoch: 8, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.849 Vali Acc: 0.630 Test Loss: 0.849 Test Acc: 0.630
Validation loss decreased (-0.549992 --> -0.629992).  Saving model ...
Epoch: 9 cost time: 3.2267909049987793
Epoch: 9, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.106 Vali Acc: 0.530 Test Loss: 1.106 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.896005153656006
Epoch: 10, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1548428535461426
Epoch: 11, Steps: 18 | Train Loss: 0.574 Vali Loss: 1.362 Vali Acc: 0.510 Test Loss: 1.362 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1085543632507324
Epoch: 12, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.272 Vali Acc: 0.560 Test Loss: 1.272 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9170567989349365
Epoch: 13, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.134 Vali Acc: 0.470 Test Loss: 1.134 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.974525213241577
Epoch: 14, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.148926019668579
Epoch: 15, Steps: 18 | Train Loss: 0.414 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1526806354522705
Epoch: 16, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.619 Vali Acc: 0.560 Test Loss: 1.619 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8982794284820557
Epoch: 17, Steps: 18 | Train Loss: 0.560 Vali Loss: 2.147 Vali Acc: 0.530 Test Loss: 2.147 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.952908754348755
Epoch: 18, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.373 Vali Acc: 0.570 Test Loss: 1.373 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps131_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 62960642
model size : 254.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps131_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0750646591186523
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.0045394897460938
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8330597877502441
Epoch: 3, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5810019969940186
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.908 Vali Acc: 0.440 Test Loss: 0.908 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9868528842926025
Epoch: 5, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.810 Vali Acc: 0.580 Test Loss: 0.810 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 1.686518669128418
Epoch: 6, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9688148498535156
Epoch: 7, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.778 Vali Acc: 0.560 Test Loss: 0.778 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.659942626953125
Epoch: 8, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.945 Vali Acc: 0.590 Test Loss: 0.945 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 9 cost time: 2.0160274505615234
Epoch: 9, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.373 Vali Acc: 0.460 Test Loss: 1.373 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7158010005950928
Epoch: 10, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0753588676452637
Epoch: 11, Steps: 18 | Train Loss: 0.434 Vali Loss: 1.108 Vali Acc: 0.560 Test Loss: 1.108 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9882252216339111
Epoch: 12, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.301 Vali Acc: 0.510 Test Loss: 1.301 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.282163381576538
Epoch: 13, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.677 Vali Acc: 0.500 Test Loss: 1.677 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2753381729125977
Epoch: 14, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.497 Vali Acc: 0.460 Test Loss: 1.497 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0928874015808105
Epoch: 15, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.265 Vali Acc: 0.580 Test Loss: 1.265 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0812244415283203
Epoch: 16, Steps: 18 | Train Loss: 0.305 Vali Loss: 1.530 Vali Acc: 0.570 Test Loss: 1.530 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1511709690093994
Epoch: 17, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.633 Vali Acc: 0.540 Test Loss: 1.633 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7109448909759521
Epoch: 18, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.598 Vali Acc: 0.560 Test Loss: 1.598 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps131_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 62828546
model size : 254.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps131_str131_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.822824001312256
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.8375048637390137
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.829 Vali Acc: 0.430 Test Loss: 0.829 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8742926120758057
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.698 Vali Acc: 0.590 Test Loss: 0.698 Test Acc: 0.590
Validation loss decreased (-0.509993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 1.4469890594482422
Epoch: 4, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7156429290771484
Epoch: 5, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.761 Vali Acc: 0.590 Test Loss: 0.761 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8354377746582031
Epoch: 6, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.989 Vali Acc: 0.480 Test Loss: 0.989 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7551624774932861
Epoch: 7, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.885887861251831
Epoch: 8, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8021671772003174
Epoch: 9, Steps: 18 | Train Loss: 0.368 Vali Loss: 0.880 Vali Acc: 0.540 Test Loss: 0.880 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5524089336395264
Epoch: 10, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6821575164794922
Epoch: 11, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.333 Vali Acc: 0.490 Test Loss: 1.333 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8651807308197021
Epoch: 12, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.285 Vali Acc: 0.520 Test Loss: 1.285 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.827376127243042
Epoch: 13, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.417 Vali Acc: 0.520 Test Loss: 1.417 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps131_str131_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 62760962
model size : 254.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps137_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.041095495223999
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 2.8601224422454834
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
Validation loss decreased (-0.469992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 2.8801796436309814
Epoch: 3, Steps: 18 | Train Loss: 0.683 Vali Loss: 1.290 Vali Acc: 0.460 Test Loss: 1.290 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.012287139892578
Epoch: 4, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.827 Vali Acc: 0.620 Test Loss: 0.827 Test Acc: 0.620
Validation loss decreased (-0.469992 --> -0.619992).  Saving model ...
Epoch: 5 cost time: 2.215745210647583
Epoch: 5, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.817 Vali Acc: 0.590 Test Loss: 0.817 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0788354873657227
Epoch: 6, Steps: 18 | Train Loss: 0.520 Vali Loss: 1.024 Vali Acc: 0.500 Test Loss: 1.024 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.161320686340332
Epoch: 7, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.216468334197998
Epoch: 8, Steps: 18 | Train Loss: 0.460 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.216608762741089
Epoch: 9, Steps: 18 | Train Loss: 0.680 Vali Loss: 1.385 Vali Acc: 0.510 Test Loss: 1.385 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.183368682861328
Epoch: 10, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.174 Vali Acc: 0.480 Test Loss: 1.174 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.226288080215454
Epoch: 11, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.401 Vali Acc: 0.540 Test Loss: 1.401 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.837615489959717
Epoch: 12, Steps: 18 | Train Loss: 0.555 Vali Loss: 1.317 Vali Acc: 0.510 Test Loss: 1.317 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.2646358013153076
Epoch: 13, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.594 Vali Acc: 0.610 Test Loss: 1.594 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1268725395202637
Epoch: 14, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.216 Vali Acc: 0.520 Test Loss: 1.216 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps137_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 63830018
model size : 258.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps137_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2456698417663574
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.689 Vali Acc: 0.520 Test Loss: 0.689 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.4743540287017822
Epoch: 2, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.706 Vali Acc: 0.560 Test Loss: 0.706 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.6490213871002197
Epoch: 3, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.704 Vali Acc: 0.590 Test Loss: 0.704 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 2.4447600841522217
Epoch: 4, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1734628677368164
Epoch: 5, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.795 Vali Acc: 0.570 Test Loss: 0.795 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4286935329437256
Epoch: 6, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.869 Vali Acc: 0.600 Test Loss: 0.869 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 7 cost time: 2.2271456718444824
Epoch: 7, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5131001472473145
Epoch: 8, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.810 Vali Acc: 0.560 Test Loss: 0.810 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.427419900894165
Epoch: 9, Steps: 18 | Train Loss: 0.397 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7727456092834473
Epoch: 10, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.937 Vali Acc: 0.550 Test Loss: 0.937 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4483273029327393
Epoch: 11, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.042 Vali Acc: 0.460 Test Loss: 1.042 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2281458377838135
Epoch: 12, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.028 Vali Acc: 0.530 Test Loss: 1.028 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5904407501220703
Epoch: 13, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.107 Vali Acc: 0.620 Test Loss: 1.107 Test Acc: 0.620
Validation loss decreased (-0.599991 --> -0.619989).  Saving model ...
Epoch: 14 cost time: 2.489240884780884
Epoch: 14, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.503 Vali Acc: 0.570 Test Loss: 1.503 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.481170654296875
Epoch: 15, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.128 Vali Acc: 0.510 Test Loss: 1.128 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.477473020553589
Epoch: 16, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.426 Vali Acc: 0.540 Test Loss: 1.426 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4381165504455566
Epoch: 17, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.996 Vali Acc: 0.460 Test Loss: 1.996 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5036568641662598
Epoch: 18, Steps: 18 | Train Loss: 0.321 Vali Loss: 2.350 Vali Acc: 0.490 Test Loss: 2.350 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3207297325134277
Epoch: 19, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.373 Vali Acc: 0.550 Test Loss: 1.373 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6397452354431152
Epoch: 20, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.318 Vali Acc: 0.560 Test Loss: 1.318 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2153632640838623
Epoch: 21, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.652 Vali Acc: 0.500 Test Loss: 1.652 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5970137119293213
Epoch: 22, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.959 Vali Acc: 0.480 Test Loss: 1.959 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5038516521453857
Epoch: 23, Steps: 18 | Train Loss: 0.217 Vali Loss: 2.054 Vali Acc: 0.540 Test Loss: 2.054 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps137_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 63707138
model size : 257.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps137_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3088605403900146
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.179939031600952
Epoch: 2, Steps: 18 | Train Loss: 0.688 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.094930648803711
Epoch: 3, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.142857074737549
Epoch: 4, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.853 Vali Acc: 0.580 Test Loss: 0.853 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 2.034834384918213
Epoch: 5, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4537427425384521
Epoch: 6, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.947 Vali Acc: 0.460 Test Loss: 0.947 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.140651226043701
Epoch: 7, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.932 Vali Acc: 0.510 Test Loss: 0.932 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.083552598953247
Epoch: 8, Steps: 18 | Train Loss: 0.429 Vali Loss: 0.888 Vali Acc: 0.470 Test Loss: 0.888 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.016353130340576
Epoch: 9, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.008 Vali Acc: 0.550 Test Loss: 1.008 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7642250061035156
Epoch: 10, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.042 Vali Acc: 0.440 Test Loss: 1.042 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.17541241645813
Epoch: 11, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.272 Vali Acc: 0.470 Test Loss: 1.272 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.00673246383667
Epoch: 12, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.196 Vali Acc: 0.460 Test Loss: 1.196 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7714509963989258
Epoch: 13, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.302 Vali Acc: 0.550 Test Loss: 1.302 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1843838691711426
Epoch: 14, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.174 Vali Acc: 0.550 Test Loss: 1.174 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps137_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 63642626
model size : 257.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps143_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.381906032562256
Epoch: 1, Steps: 18 | Train Loss: 0.800 Vali Loss: 0.726 Vali Acc: 0.570 Test Loss: 0.726 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 3.2607581615448
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.987851858139038
Epoch: 3, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.212266445159912
Epoch: 4, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0387754440307617
Epoch: 5, Steps: 18 | Train Loss: 0.581 Vali Loss: 1.335 Vali Acc: 0.440 Test Loss: 1.335 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1647772789001465
Epoch: 6, Steps: 18 | Train Loss: 0.567 Vali Loss: 1.356 Vali Acc: 0.500 Test Loss: 1.356 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.278550863265991
Epoch: 7, Steps: 18 | Train Loss: 0.761 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0858747959136963
Epoch: 8, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.827 Vali Acc: 0.570 Test Loss: 0.827 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.24642276763916
Epoch: 9, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.923 Vali Acc: 0.550 Test Loss: 0.923 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.3115267753601074
Epoch: 10, Steps: 18 | Train Loss: 0.608 Vali Loss: 1.609 Vali Acc: 0.510 Test Loss: 1.609 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1016221046447754
Epoch: 11, Steps: 18 | Train Loss: 0.613 Vali Loss: 1.054 Vali Acc: 0.530 Test Loss: 1.054 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps143_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 64708610
model size : 261.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps143_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7657549381256104
Epoch: 1, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.809 Vali Acc: 0.450 Test Loss: 0.809 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.672973871231079
Epoch: 2, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
Validation loss decreased (-0.449992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.524773597717285
Epoch: 3, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.860 Vali Acc: 0.460 Test Loss: 0.860 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6706695556640625
Epoch: 4, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.863 Vali Acc: 0.460 Test Loss: 0.863 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.568369150161743
Epoch: 5, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2766075134277344
Epoch: 6, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6341543197631836
Epoch: 7, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.926 Vali Acc: 0.540 Test Loss: 0.926 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1426801681518555
Epoch: 8, Steps: 18 | Train Loss: 0.734 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0976741313934326
Epoch: 9, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7943425178527832
Epoch: 10, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.850 Vali Acc: 0.560 Test Loss: 0.850 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7661173343658447
Epoch: 11, Steps: 18 | Train Loss: 0.408 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6952571868896484
Epoch: 12, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.267 Vali Acc: 0.570 Test Loss: 1.267 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569987).  Saving model ...
Epoch: 13 cost time: 2.3341424465179443
Epoch: 13, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.175 Vali Acc: 0.470 Test Loss: 1.175 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2766454219818115
Epoch: 14, Steps: 18 | Train Loss: 0.364 Vali Loss: 1.896 Vali Acc: 0.540 Test Loss: 1.896 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1090822219848633
Epoch: 15, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.136 Vali Acc: 0.510 Test Loss: 1.136 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7167809009552002
Epoch: 16, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.563 Vali Acc: 0.510 Test Loss: 1.563 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1793506145477295
Epoch: 17, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.753 Vali Acc: 0.490 Test Loss: 1.753 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.375096082687378
Epoch: 18, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.347 Vali Acc: 0.480 Test Loss: 1.347 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2553718090057373
Epoch: 19, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.391 Vali Acc: 0.500 Test Loss: 1.391 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1367928981781006
Epoch: 20, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.694 Vali Acc: 0.470 Test Loss: 1.694 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.32881498336792
Epoch: 21, Steps: 18 | Train Loss: 0.142 Vali Loss: 2.310 Vali Acc: 0.490 Test Loss: 2.310 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3626835346221924
Epoch: 22, Steps: 18 | Train Loss: 0.401 Vali Loss: 2.346 Vali Acc: 0.550 Test Loss: 2.346 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps143_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 64585730
model size : 261.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps143_str143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.651003122329712
Epoch: 1, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.170767307281494
Epoch: 2, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.779 Vali Acc: 0.430 Test Loss: 0.779 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8697569370269775
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.840 Vali Acc: 0.510 Test Loss: 0.840 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4942281246185303
Epoch: 4, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.732 Vali Acc: 0.580 Test Loss: 0.732 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 2.109459400177002
Epoch: 5, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.708 Vali Acc: 0.610 Test Loss: 0.708 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 2.0936789512634277
Epoch: 6, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.753769874572754
Epoch: 7, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.945 Vali Acc: 0.550 Test Loss: 0.945 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7252604961395264
Epoch: 8, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.873 Vali Acc: 0.550 Test Loss: 0.873 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8795499801635742
Epoch: 9, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.035 Vali Acc: 0.530 Test Loss: 1.035 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9085495471954346
Epoch: 10, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.905 Vali Acc: 0.590 Test Loss: 0.905 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0660412311553955
Epoch: 11, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2053909301757812
Epoch: 12, Steps: 18 | Train Loss: 0.271 Vali Loss: 0.996 Vali Acc: 0.490 Test Loss: 0.996 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0649311542510986
Epoch: 13, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.208 Vali Acc: 0.520 Test Loss: 1.208 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1162753105163574
Epoch: 14, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.476 Vali Acc: 0.490 Test Loss: 1.476 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7031023502349854
Epoch: 15, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.095 Vali Acc: 0.560 Test Loss: 1.095 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps143_str143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 64524290
model size : 260.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5132811069488525
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.848 Vali Acc: 0.500 Test Loss: 0.848 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.2168760299682617
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.761 Vali Acc: 0.440 Test Loss: 0.761 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5508995056152344
Epoch: 3, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.729 Vali Acc: 0.590 Test Loss: 0.729 Test Acc: 0.590
Validation loss decreased (-0.499992 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 2.7225265502929688
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.706066846847534
Epoch: 5, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.994 Vali Acc: 0.460 Test Loss: 0.994 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7754201889038086
Epoch: 6, Steps: 18 | Train Loss: 0.546 Vali Loss: 1.110 Vali Acc: 0.570 Test Loss: 1.110 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.784654378890991
Epoch: 7, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6004045009613037
Epoch: 8, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.349 Vali Acc: 0.480 Test Loss: 1.349 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8369908332824707
Epoch: 9, Steps: 18 | Train Loss: 0.424 Vali Loss: 1.096 Vali Acc: 0.520 Test Loss: 1.096 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4630117416381836
Epoch: 10, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.157 Vali Acc: 0.470 Test Loss: 1.157 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7158362865448
Epoch: 11, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.505 Vali Acc: 0.490 Test Loss: 1.505 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.370943069458008
Epoch: 12, Steps: 18 | Train Loss: 0.524 Vali Loss: 1.870 Vali Acc: 0.520 Test Loss: 1.870 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.791714668273926
Epoch: 13, Steps: 18 | Train Loss: 0.657 Vali Loss: 1.394 Vali Acc: 0.550 Test Loss: 1.394 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 65728514
model size : 265.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.370260238647461
Epoch: 1, Steps: 18 | Train Loss: 0.747 Vali Loss: 0.706 Vali Acc: 0.620 Test Loss: 0.706 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 1.9933264255523682
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.041834831237793
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1239678859710693
Epoch: 4, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.799 Vali Acc: 0.490 Test Loss: 0.799 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.31261944770813
Epoch: 5, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.900 Vali Acc: 0.600 Test Loss: 0.900 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1449124813079834
Epoch: 6, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.759 Vali Acc: 0.560 Test Loss: 0.759 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1661088466644287
Epoch: 7, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.927 Vali Acc: 0.480 Test Loss: 0.927 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1896462440490723
Epoch: 8, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.930 Vali Acc: 0.530 Test Loss: 0.930 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.306868553161621
Epoch: 9, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.978 Vali Acc: 0.500 Test Loss: 0.978 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.045717477798462
Epoch: 10, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.102 Vali Acc: 0.540 Test Loss: 1.102 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1193578243255615
Epoch: 11, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.389 Vali Acc: 0.520 Test Loss: 1.389 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 65614850
model size : 264.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.392902135848999
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 1.9831604957580566
Epoch: 2, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6997170448303223
Epoch: 3, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.121873378753662
Epoch: 4, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.6229948997497559
Epoch: 5, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7492144107818604
Epoch: 6, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.903310775756836
Epoch: 7, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.814 Vali Acc: 0.560 Test Loss: 0.814 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 1.99583101272583
Epoch: 8, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.927 Vali Acc: 0.550 Test Loss: 0.927 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0382392406463623
Epoch: 9, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.877 Vali Acc: 0.560 Test Loss: 0.877 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8569257259368896
Epoch: 10, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.820 Vali Acc: 0.580 Test Loss: 0.820 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 1.8723807334899902
Epoch: 11, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.107 Vali Acc: 0.530 Test Loss: 1.107 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2074787616729736
Epoch: 12, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 2.001574993133545
Epoch: 13, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.003 Vali Acc: 0.570 Test Loss: 1.003 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.931884765625
Epoch: 14, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.496 Vali Acc: 0.450 Test Loss: 1.496 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8824734687805176
Epoch: 15, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.272 Vali Acc: 0.540 Test Loss: 1.272 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.851349115371704
Epoch: 16, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.229 Vali Acc: 0.570 Test Loss: 1.229 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0804476737976074
Epoch: 17, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.394 Vali Acc: 0.590 Test Loss: 1.394 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8547272682189941
Epoch: 18, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.762 Vali Acc: 0.540 Test Loss: 1.762 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7599759101867676
Epoch: 19, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.790 Vali Acc: 0.460 Test Loss: 1.790 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9881060123443604
Epoch: 20, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.389 Vali Acc: 0.510 Test Loss: 1.389 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0865964889526367
Epoch: 21, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.509 Vali Acc: 0.530 Test Loss: 1.509 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9549195766448975
Epoch: 22, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.547 Vali Acc: 0.460 Test Loss: 1.547 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 65556482
model size : 264.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps158_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.259612798690796
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.706 Vali Acc: 0.570 Test Loss: 0.706 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.880234479904175
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.813 Vali Acc: 0.440 Test Loss: 0.813 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6394097805023193
Epoch: 3, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.686 Vali Acc: 0.620 Test Loss: 0.686 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 2.8529250621795654
Epoch: 4, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6964690685272217
Epoch: 5, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9598710536956787
Epoch: 6, Steps: 18 | Train Loss: 0.523 Vali Loss: 1.016 Vali Acc: 0.570 Test Loss: 1.016 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8866186141967773
Epoch: 7, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.897 Vali Acc: 0.570 Test Loss: 0.897 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7910287380218506
Epoch: 8, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.904 Vali Acc: 0.610 Test Loss: 0.904 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.375058174133301
Epoch: 9, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.849 Vali Acc: 0.610 Test Loss: 0.849 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2221555709838867
Epoch: 10, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.220 Vali Acc: 0.490 Test Loss: 1.220 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.132502555847168
Epoch: 11, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.194 Vali Acc: 0.580 Test Loss: 1.194 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9267122745513916
Epoch: 12, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.575 Vali Acc: 0.540 Test Loss: 1.575 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0970232486724854
Epoch: 13, Steps: 18 | Train Loss: 0.540 Vali Loss: 0.916 Vali Acc: 0.620 Test Loss: 0.916 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps158_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 66895874
model size : 269.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps158_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1921956539154053
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.685 Vali Acc: 0.630 Test Loss: 0.685 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 2.4385862350463867
Epoch: 2, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.504237651824951
Epoch: 3, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.936 Vali Acc: 0.470 Test Loss: 0.936 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4196510314941406
Epoch: 4, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.739 Vali Acc: 0.430 Test Loss: 0.739 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5061066150665283
Epoch: 5, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.45998215675354
Epoch: 6, Steps: 18 | Train Loss: 0.623 Vali Loss: 1.010 Vali Acc: 0.470 Test Loss: 1.010 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9569077491760254
Epoch: 7, Steps: 18 | Train Loss: 0.545 Vali Loss: 1.070 Vali Acc: 0.490 Test Loss: 1.070 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.681919574737549
Epoch: 8, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2144486904144287
Epoch: 9, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.844 Vali Acc: 0.590 Test Loss: 0.844 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.576892614364624
Epoch: 10, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.884 Vali Acc: 0.560 Test Loss: 0.884 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.314532995223999
Epoch: 11, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.408 Vali Acc: 0.550 Test Loss: 1.408 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps158_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 66785282
model size : 269.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps158_str158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.95112943649292
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.785 Vali Acc: 0.590 Test Loss: 0.785 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 1.9859344959259033
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5384271144866943
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2833638191223145
Epoch: 4, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.696 Vali Acc: 0.580 Test Loss: 0.696 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0683019161224365
Epoch: 5, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.129028081893921
Epoch: 6, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.803 Vali Acc: 0.590 Test Loss: 0.803 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0588746070861816
Epoch: 7, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.851 Vali Acc: 0.560 Test Loss: 0.851 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.276548147201538
Epoch: 8, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9500706195831299
Epoch: 9, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.037 Vali Acc: 0.460 Test Loss: 1.037 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.299872636795044
Epoch: 10, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.953 Vali Acc: 0.570 Test Loss: 0.953 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.287630319595337
Epoch: 11, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.956 Vali Acc: 0.530 Test Loss: 0.956 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps158_str158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 66729986
model size : 269.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.870224714279175
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.2068488597869873
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3065953254699707
Epoch: 3, Steps: 18 | Train Loss: 0.780 Vali Loss: 1.075 Vali Acc: 0.490 Test Loss: 1.075 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0247433185577393
Epoch: 4, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.830 Vali Acc: 0.470 Test Loss: 0.830 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.135554552078247
Epoch: 5, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 3.0661919116973877
Epoch: 6, Steps: 18 | Train Loss: 0.574 Vali Loss: 1.026 Vali Acc: 0.510 Test Loss: 1.026 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9491007328033447
Epoch: 7, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.865 Vali Acc: 0.460 Test Loss: 0.865 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0785202980041504
Epoch: 8, Steps: 18 | Train Loss: 0.561 Vali Loss: 1.036 Vali Acc: 0.530 Test Loss: 1.036 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529990).  Saving model ...
Epoch: 9 cost time: 3.322434425354004
Epoch: 9, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.838 Vali Acc: 0.570 Test Loss: 0.838 Test Acc: 0.570
Validation loss decreased (-0.529990 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 3.238823890686035
Epoch: 10, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.936 Vali Acc: 0.540 Test Loss: 0.936 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.307368040084839
Epoch: 11, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2521579265594482
Epoch: 12, Steps: 18 | Train Loss: 0.448 Vali Loss: 1.084 Vali Acc: 0.580 Test Loss: 1.084 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579989).  Saving model ...
Epoch: 13 cost time: 3.342010498046875
Epoch: 13, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.048 Vali Acc: 0.480 Test Loss: 1.048 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0073046684265137
Epoch: 14, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.245 Vali Acc: 0.490 Test Loss: 1.245 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2797083854675293
Epoch: 15, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.595 Vali Acc: 0.550 Test Loss: 1.595 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.158191680908203
Epoch: 16, Steps: 18 | Train Loss: 0.487 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0189499855041504
Epoch: 17, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.286 Vali Acc: 0.470 Test Loss: 1.286 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.293421983718872
Epoch: 18, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.369 Vali Acc: 0.530 Test Loss: 1.369 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.999992847442627
Epoch: 19, Steps: 18 | Train Loss: 0.247 Vali Loss: 2.336 Vali Acc: 0.590 Test Loss: 2.336 Test Acc: 0.590
Validation loss decreased (-0.579989 --> -0.589977).  Saving model ...
Epoch: 20 cost time: 3.1174957752227783
Epoch: 20, Steps: 18 | Train Loss: 0.358 Vali Loss: 1.982 Vali Acc: 0.440 Test Loss: 1.982 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.27651309967041
Epoch: 21, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.446 Vali Acc: 0.510 Test Loss: 1.446 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3064193725585938
Epoch: 22, Steps: 18 | Train Loss: 0.315 Vali Loss: 2.319 Vali Acc: 0.480 Test Loss: 2.319 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9696109294891357
Epoch: 23, Steps: 18 | Train Loss: 0.260 Vali Loss: 2.405 Vali Acc: 0.470 Test Loss: 2.405 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.451617479324341
Epoch: 24, Steps: 18 | Train Loss: 0.500 Vali Loss: 2.164 Vali Acc: 0.530 Test Loss: 2.164 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.207916736602783
Epoch: 25, Steps: 18 | Train Loss: 0.192 Vali Loss: 2.177 Vali Acc: 0.430 Test Loss: 2.177 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.181492567062378
Epoch: 26, Steps: 18 | Train Loss: 0.234 Vali Loss: 2.209 Vali Acc: 0.470 Test Loss: 2.209 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3442184925079346
Epoch: 27, Steps: 18 | Train Loss: 0.207 Vali Loss: 2.407 Vali Acc: 0.470 Test Loss: 2.407 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.940739870071411
Epoch: 28, Steps: 18 | Train Loss: 0.234 Vali Loss: 2.117 Vali Acc: 0.420 Test Loss: 2.117 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3063745498657227
Epoch: 29, Steps: 18 | Train Loss: 0.416 Vali Loss: 2.203 Vali Acc: 0.460 Test Loss: 2.203 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 68210690
model size : 274.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.808058977127075
Epoch: 1, Steps: 18 | Train Loss: 0.804 Vali Loss: 0.677 Vali Acc: 0.580 Test Loss: 0.677 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.273374557495117
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.666 Vali Acc: 0.600 Test Loss: 0.666 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 1.8089094161987305
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.729 Vali Acc: 0.570 Test Loss: 0.729 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.236114263534546
Epoch: 4, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.040205717086792
Epoch: 5, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.876 Vali Acc: 0.620 Test Loss: 0.876 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619991).  Saving model ...
Epoch: 6 cost time: 2.3425095081329346
Epoch: 6, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.963 Vali Acc: 0.540 Test Loss: 0.963 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.465480089187622
Epoch: 7, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.872 Vali Acc: 0.560 Test Loss: 0.872 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4123337268829346
Epoch: 8, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.999 Vali Acc: 0.560 Test Loss: 0.999 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3580257892608643
Epoch: 9, Steps: 18 | Train Loss: 0.512 Vali Loss: 1.379 Vali Acc: 0.550 Test Loss: 1.379 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.278074264526367
Epoch: 10, Steps: 18 | Train Loss: 0.453 Vali Loss: 1.036 Vali Acc: 0.520 Test Loss: 1.036 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.572521686553955
Epoch: 11, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.217 Vali Acc: 0.470 Test Loss: 1.217 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3217825889587402
Epoch: 12, Steps: 18 | Train Loss: 0.527 Vali Loss: 1.038 Vali Acc: 0.560 Test Loss: 1.038 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4527742862701416
Epoch: 13, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.947 Vali Acc: 0.610 Test Loss: 0.947 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.329117774963379
Epoch: 14, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.032 Vali Acc: 0.620 Test Loss: 1.032 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4596879482269287
Epoch: 15, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 68106242
model size : 274.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2984278202056885
Epoch: 1, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.677 Vali Acc: 0.570 Test Loss: 0.677 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.015317440032959
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.699 Vali Acc: 0.490 Test Loss: 0.699 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7236342430114746
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.687 Vali Acc: 0.580 Test Loss: 0.687 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 2.0367019176483154
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.067521333694458
Epoch: 5, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.876 Vali Acc: 0.440 Test Loss: 0.876 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.964327096939087
Epoch: 6, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.229229688644409
Epoch: 7, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2067196369171143
Epoch: 8, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.853 Vali Acc: 0.580 Test Loss: 0.853 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1553807258605957
Epoch: 9, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.080869197845459
Epoch: 10, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.000 Vali Acc: 0.570 Test Loss: 1.000 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0046253204345703
Epoch: 11, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.931 Vali Acc: 0.530 Test Loss: 0.931 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.926722526550293
Epoch: 12, Steps: 18 | Train Loss: 0.282 Vali Loss: 0.921 Vali Acc: 0.530 Test Loss: 0.921 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.104832410812378
Epoch: 13, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 68054018
model size : 274.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps177_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.105341196060181
Epoch: 1, Steps: 18 | Train Loss: 0.795 Vali Loss: 0.717 Vali Acc: 0.580 Test Loss: 0.717 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.7213690280914307
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.967310667037964
Epoch: 3, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9903745651245117
Epoch: 4, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.877 Vali Acc: 0.460 Test Loss: 0.877 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0543253421783447
Epoch: 5, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.861 Vali Acc: 0.520 Test Loss: 0.861 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9460272789001465
Epoch: 6, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.860 Vali Acc: 0.570 Test Loss: 0.860 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.945667028427124
Epoch: 7, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.822 Vali Acc: 0.620 Test Loss: 0.822 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619992).  Saving model ...
Epoch: 8 cost time: 1.9563441276550293
Epoch: 8, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.214 Vali Acc: 0.540 Test Loss: 1.214 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5498006343841553
Epoch: 9, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.886 Vali Acc: 0.470 Test Loss: 0.886 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5648131370544434
Epoch: 10, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.824 Vali Acc: 0.570 Test Loss: 0.824 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1885781288146973
Epoch: 11, Steps: 18 | Train Loss: 0.522 Vali Loss: 1.000 Vali Acc: 0.510 Test Loss: 1.000 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.479111671447754
Epoch: 12, Steps: 18 | Train Loss: 0.494 Vali Loss: 1.154 Vali Acc: 0.540 Test Loss: 1.154 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9858689308166504
Epoch: 13, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.353 Vali Acc: 0.470 Test Loss: 1.353 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.591737747192383
Epoch: 14, Steps: 18 | Train Loss: 0.332 Vali Loss: 2.001 Vali Acc: 0.570 Test Loss: 2.001 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0295233726501465
Epoch: 15, Steps: 18 | Train Loss: 0.326 Vali Loss: 2.009 Vali Acc: 0.610 Test Loss: 2.009 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5375967025756836
Epoch: 16, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.587 Vali Acc: 0.570 Test Loss: 1.587 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7132728099823
Epoch: 17, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.543 Vali Acc: 0.450 Test Loss: 1.543 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps177_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 69669890
model size : 280.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps177_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.680612564086914
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.2048819065093994
Epoch: 2, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.2219021320343018
Epoch: 3, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.669 Vali Acc: 0.530 Test Loss: 0.669 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 2.2253212928771973
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.684 Vali Acc: 0.500 Test Loss: 0.684 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1612513065338135
Epoch: 5, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 1.7920761108398438
Epoch: 6, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.979271650314331
Epoch: 7, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.982 Vali Acc: 0.480 Test Loss: 0.982 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.320465326309204
Epoch: 8, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.947 Vali Acc: 0.560 Test Loss: 0.947 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7307000160217285
Epoch: 9, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.316 Vali Acc: 0.540 Test Loss: 1.316 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.305795431137085
Epoch: 10, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.386 Vali Acc: 0.460 Test Loss: 1.386 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.287210702896118
Epoch: 11, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.068 Vali Acc: 0.570 Test Loss: 1.068 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0914597511291504
Epoch: 12, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.658 Vali Acc: 0.560 Test Loss: 1.658 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.230933427810669
Epoch: 13, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.202 Vali Acc: 0.530 Test Loss: 1.202 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1318752765655518
Epoch: 14, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.339 Vali Acc: 0.590 Test Loss: 1.339 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2380471229553223
Epoch: 15, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.468 Vali Acc: 0.470 Test Loss: 1.468 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps177_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 69574658
model size : 280.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps177_str177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3658804893493652
Epoch: 1, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.766 Vali Acc: 0.380 Test Loss: 0.766 Test Acc: 0.380
Validation loss decreased (inf --> -0.379992).  Saving model ...
Epoch: 2 cost time: 1.843123435974121
Epoch: 2, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.725 Vali Acc: 0.420 Test Loss: 0.725 Test Acc: 0.420
Validation loss decreased (-0.379992 --> -0.419993).  Saving model ...
Epoch: 3 cost time: 2.058958053588867
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (-0.419993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.9418363571166992
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.021923065185547
Epoch: 5, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.735 Vali Acc: 0.570 Test Loss: 0.735 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.975827693939209
Epoch: 6, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.885 Vali Acc: 0.470 Test Loss: 0.885 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.886875867843628
Epoch: 7, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.877 Vali Acc: 0.510 Test Loss: 0.877 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9531316757202148
Epoch: 8, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9372870922088623
Epoch: 9, Steps: 18 | Train Loss: 0.378 Vali Loss: 1.087 Vali Acc: 0.520 Test Loss: 1.087 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.993779182434082
Epoch: 10, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.081 Vali Acc: 0.610 Test Loss: 1.081 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609989).  Saving model ...
Epoch: 11 cost time: 1.909400463104248
Epoch: 11, Steps: 18 | Train Loss: 0.338 Vali Loss: 0.974 Vali Acc: 0.560 Test Loss: 0.974 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9249365329742432
Epoch: 12, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.079 Vali Acc: 0.540 Test Loss: 1.079 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9171292781829834
Epoch: 13, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0187628269195557
Epoch: 14, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.525 Vali Acc: 0.520 Test Loss: 1.525 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.971580982208252
Epoch: 15, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.017827033996582
Epoch: 16, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.374 Vali Acc: 0.580 Test Loss: 1.374 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.765406847000122
Epoch: 17, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.493 Vali Acc: 0.590 Test Loss: 1.493 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7152869701385498
Epoch: 18, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.409 Vali Acc: 0.570 Test Loss: 1.409 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6514544486999512
Epoch: 19, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.334 Vali Acc: 0.510 Test Loss: 1.334 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5397706031799316
Epoch: 20, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.792 Vali Acc: 0.520 Test Loss: 1.792 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps177_str177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 69525506
model size : 279.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps188_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9681997299194336
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.0421674251556396
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.830 Vali Acc: 0.540 Test Loss: 0.830 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.345414876937866
Epoch: 3, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.690 Vali Acc: 0.600 Test Loss: 0.690 Test Acc: 0.600
Validation loss decreased (-0.539992 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 2.9992358684539795
Epoch: 4, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4101972579956055
Epoch: 5, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.837 Vali Acc: 0.450 Test Loss: 0.837 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2226016521453857
Epoch: 6, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9830172061920166
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.896 Vali Acc: 0.620 Test Loss: 0.896 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619991).  Saving model ...
Epoch: 8 cost time: 2.9781789779663086
Epoch: 8, Steps: 18 | Train Loss: 0.452 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1663639545440674
Epoch: 9, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.830 Vali Acc: 0.540 Test Loss: 0.830 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.224181652069092
Epoch: 10, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.850 Vali Acc: 0.530 Test Loss: 1.850 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2176060676574707
Epoch: 11, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.859 Vali Acc: 0.540 Test Loss: 0.859 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9028992652893066
Epoch: 12, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2849996089935303
Epoch: 13, Steps: 18 | Train Loss: 0.451 Vali Loss: 1.891 Vali Acc: 0.520 Test Loss: 1.891 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.083986520767212
Epoch: 14, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.199 Vali Acc: 0.540 Test Loss: 1.199 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2879791259765625
Epoch: 15, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.203 Vali Acc: 0.510 Test Loss: 1.203 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8401336669921875
Epoch: 16, Steps: 18 | Train Loss: 0.299 Vali Loss: 2.260 Vali Acc: 0.490 Test Loss: 2.260 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.155109405517578
Epoch: 17, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.475 Vali Acc: 0.540 Test Loss: 1.475 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps188_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 71282690
model size : 286.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.621586799621582
Epoch: 1, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.687 Vali Acc: 0.600 Test Loss: 0.687 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 2.596688747406006
Epoch: 2, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.684 Vali Acc: 0.490 Test Loss: 0.684 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2711334228515625
Epoch: 3, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.554558515548706
Epoch: 4, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.771 Vali Acc: 0.590 Test Loss: 0.771 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5852315425872803
Epoch: 5, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.775 Vali Acc: 0.590 Test Loss: 0.775 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6531589031219482
Epoch: 6, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5992703437805176
Epoch: 7, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.000 Vali Acc: 0.540 Test Loss: 1.000 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6442532539367676
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.952 Vali Acc: 0.530 Test Loss: 0.952 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5575907230377197
Epoch: 9, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.378624677658081
Epoch: 10, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.311 Vali Acc: 0.570 Test Loss: 1.311 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.630544900894165
Epoch: 11, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 71190530
model size : 286.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps188_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.372671365737915
Epoch: 1, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.725 Vali Acc: 0.540 Test Loss: 0.725 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.0951004028320312
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.697 Vali Acc: 0.610 Test Loss: 0.697 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 2.2599105834960938
Epoch: 3, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.829 Vali Acc: 0.460 Test Loss: 0.829 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.233058452606201
Epoch: 4, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.798 Vali Acc: 0.410 Test Loss: 0.798 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9524919986724854
Epoch: 5, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.064649820327759
Epoch: 6, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.779 Vali Acc: 0.510 Test Loss: 0.779 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.171557903289795
Epoch: 7, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.809 Vali Acc: 0.470 Test Loss: 0.809 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2525012493133545
Epoch: 8, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.946 Vali Acc: 0.490 Test Loss: 0.946 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9810118675231934
Epoch: 9, Steps: 18 | Train Loss: 0.328 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.200640916824341
Epoch: 10, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.123 Vali Acc: 0.540 Test Loss: 1.123 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1150760650634766
Epoch: 11, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.135 Vali Acc: 0.480 Test Loss: 1.135 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.130763530731201
Epoch: 12, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps188_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 71144450
model size : 286.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2493574619293213
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.676 Vali Acc: 0.640 Test Loss: 0.676 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 1.9854369163513184
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5956103801727295
Epoch: 3, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.732 Vali Acc: 0.600 Test Loss: 0.732 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.292328357696533
Epoch: 4, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.858 Vali Acc: 0.510 Test Loss: 0.858 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5295443534851074
Epoch: 5, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.695 Vali Acc: 0.620 Test Loss: 0.695 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.920621871948242
Epoch: 6, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.894 Vali Acc: 0.560 Test Loss: 0.894 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.992002010345459
Epoch: 7, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.015 Vali Acc: 0.560 Test Loss: 1.015 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6958906650543213
Epoch: 8, Steps: 18 | Train Loss: 0.606 Vali Loss: 1.008 Vali Acc: 0.580 Test Loss: 1.008 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7503013610839844
Epoch: 9, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.935 Vali Acc: 0.480 Test Loss: 0.935 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6937360763549805
Epoch: 10, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.948 Vali Acc: 0.580 Test Loss: 0.948 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.134260416030884
Epoch: 11, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.987 Vali Acc: 0.530 Test Loss: 0.987 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 73042946
model size : 293.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.729177474975586
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.753 Vali Acc: 0.440 Test Loss: 0.753 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.359639883041382
Epoch: 2, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.679 Vali Acc: 0.580 Test Loss: 0.679 Test Acc: 0.580
Validation loss decreased (-0.439992 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.192608118057251
Epoch: 3, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.832 Vali Acc: 0.440 Test Loss: 0.832 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.246549606323242
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1987640857696533
Epoch: 5, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1488373279571533
Epoch: 6, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4437010288238525
Epoch: 7, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.25616455078125
Epoch: 8, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.857 Vali Acc: 0.590 Test Loss: 0.857 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 9 cost time: 1.8227331638336182
Epoch: 9, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.423214912414551
Epoch: 10, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.451 Vali Acc: 0.460 Test Loss: 1.451 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2568929195404053
Epoch: 11, Steps: 18 | Train Loss: 0.340 Vali Loss: 2.101 Vali Acc: 0.500 Test Loss: 2.101 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.801426649093628
Epoch: 12, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.251 Vali Acc: 0.530 Test Loss: 1.251 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.191161870956421
Epoch: 13, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.995 Vali Acc: 0.540 Test Loss: 0.995 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.131617307662964
Epoch: 14, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.123 Vali Acc: 0.550 Test Loss: 1.123 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.347548484802246
Epoch: 15, Steps: 18 | Train Loss: 0.451 Vali Loss: 1.275 Vali Acc: 0.510 Test Loss: 1.275 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.29618763923645
Epoch: 16, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.086 Vali Acc: 0.480 Test Loss: 1.086 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.725095510482788
Epoch: 17, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.906 Vali Acc: 0.490 Test Loss: 1.906 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3796846866607666
Epoch: 18, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.669 Vali Acc: 0.480 Test Loss: 1.669 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 72956930
model size : 292.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.240227460861206
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.828 Vali Acc: 0.420 Test Loss: 0.828 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 1.9830889701843262
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
Validation loss decreased (-0.419992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.082062005996704
Epoch: 3, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.778 Vali Acc: 0.430 Test Loss: 0.778 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0043463706970215
Epoch: 4, Steps: 18 | Train Loss: 0.563 Vali Loss: 1.016 Vali Acc: 0.490 Test Loss: 1.016 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0867018699645996
Epoch: 5, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.852 Vali Acc: 0.540 Test Loss: 0.852 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539991).  Saving model ...
Epoch: 6 cost time: 2.156497001647949
Epoch: 6, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.9192073345184326
Epoch: 7, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9103119373321533
Epoch: 8, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.97165846824646
Epoch: 9, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.801189661026001
Epoch: 10, Steps: 18 | Train Loss: 0.362 Vali Loss: 0.896 Vali Acc: 0.530 Test Loss: 0.896 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6664845943450928
Epoch: 11, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6467220783233643
Epoch: 12, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.218 Vali Acc: 0.540 Test Loss: 1.218 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6418156623840332
Epoch: 13, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.323 Vali Acc: 0.560 Test Loss: 1.323 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559987).  Saving model ...
Epoch: 14 cost time: 2.015493631362915
Epoch: 14, Steps: 18 | Train Loss: 0.305 Vali Loss: 1.111 Vali Acc: 0.560 Test Loss: 1.111 Test Acc: 0.560
Validation loss decreased (-0.559987 --> -0.559989).  Saving model ...
Epoch: 15 cost time: 1.6565632820129395
Epoch: 15, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.142 Vali Acc: 0.510 Test Loss: 1.142 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9552597999572754
Epoch: 16, Steps: 18 | Train Loss: 0.173 Vali Loss: 2.147 Vali Acc: 0.520 Test Loss: 2.147 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8026461601257324
Epoch: 17, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.241 Vali Acc: 0.540 Test Loss: 1.241 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6871740818023682
Epoch: 18, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.830 Vali Acc: 0.490 Test Loss: 1.830 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8738582134246826
Epoch: 19, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.312 Vali Acc: 0.550 Test Loss: 1.312 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9429097175598145
Epoch: 20, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.452 Vali Acc: 0.540 Test Loss: 1.452 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9047698974609375
Epoch: 21, Steps: 18 | Train Loss: 0.182 Vali Loss: 2.059 Vali Acc: 0.500 Test Loss: 2.059 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6042771339416504
Epoch: 22, Steps: 18 | Train Loss: 0.189 Vali Loss: 2.372 Vali Acc: 0.550 Test Loss: 2.372 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8496344089508057
Epoch: 23, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.945 Vali Acc: 0.500 Test Loss: 1.945 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8515512943267822
Epoch: 24, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.634 Vali Acc: 0.550 Test Loss: 1.634 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 72913922
model size : 292.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps215_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7124226093292236
Epoch: 1, Steps: 18 | Train Loss: 0.810 Vali Loss: 0.676 Vali Acc: 0.580 Test Loss: 0.676 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.5048909187316895
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.760 Vali Acc: 0.420 Test Loss: 0.760 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.337932825088501
Epoch: 3, Steps: 18 | Train Loss: 0.657 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6534316539764404
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.803 Vali Acc: 0.540 Test Loss: 0.803 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6104929447174072
Epoch: 5, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.869 Vali Acc: 0.560 Test Loss: 0.869 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.473334789276123
Epoch: 6, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.895 Vali Acc: 0.450 Test Loss: 0.895 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4496285915374756
Epoch: 7, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.4511752128601074
Epoch: 8, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.122 Vali Acc: 0.490 Test Loss: 1.122 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.662659168243408
Epoch: 9, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4959769248962402
Epoch: 10, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.045 Vali Acc: 0.490 Test Loss: 1.045 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6768510341644287
Epoch: 11, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.528 Vali Acc: 0.460 Test Loss: 1.528 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps215_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 75239426
model size : 301.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps215_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.224486827850342
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.7741820812225342
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.916 Vali Acc: 0.540 Test Loss: 0.916 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 1.7114150524139404
Epoch: 3, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6852622032165527
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.928 Vali Acc: 0.480 Test Loss: 0.928 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8294007778167725
Epoch: 5, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.317 Vali Acc: 0.470 Test Loss: 1.317 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.603484630584717
Epoch: 6, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.822 Vali Acc: 0.480 Test Loss: 0.822 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5519943237304688
Epoch: 7, Steps: 18 | Train Loss: 0.456 Vali Loss: 1.105 Vali Acc: 0.540 Test Loss: 1.105 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.035939931869507
Epoch: 8, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.922 Vali Acc: 0.490 Test Loss: 0.922 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6388912200927734
Epoch: 9, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.030 Vali Acc: 0.510 Test Loss: 1.030 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3598875999450684
Epoch: 10, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.313 Vali Acc: 0.570 Test Loss: 1.313 Test Acc: 0.570
Validation loss decreased (-0.539991 --> -0.569987).  Saving model ...
Epoch: 11 cost time: 1.7917251586914062
Epoch: 11, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.247 Vali Acc: 0.510 Test Loss: 1.247 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6783642768859863
Epoch: 12, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.124 Vali Acc: 0.540 Test Loss: 1.124 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5823731422424316
Epoch: 13, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.273 Vali Acc: 0.580 Test Loss: 1.273 Test Acc: 0.580
Validation loss decreased (-0.569987 --> -0.579987).  Saving model ...
Epoch: 14 cost time: 2.111984968185425
Epoch: 14, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.642 Vali Acc: 0.500 Test Loss: 1.642 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.809161901473999
Epoch: 15, Steps: 18 | Train Loss: 0.276 Vali Loss: 2.388 Vali Acc: 0.490 Test Loss: 2.388 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.325216770172119
Epoch: 16, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.661 Vali Acc: 0.530 Test Loss: 1.661 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7943198680877686
Epoch: 17, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.814 Vali Acc: 0.530 Test Loss: 1.814 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7990946769714355
Epoch: 18, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.695 Vali Acc: 0.470 Test Loss: 1.695 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.6579947471618652
Epoch: 19, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.935 Vali Acc: 0.550 Test Loss: 1.935 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3732166290283203
Epoch: 20, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.896 Vali Acc: 0.550 Test Loss: 1.896 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6056723594665527
Epoch: 21, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.864 Vali Acc: 0.490 Test Loss: 1.864 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4821431636810303
Epoch: 22, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.866 Vali Acc: 0.490 Test Loss: 1.866 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8197646141052246
Epoch: 23, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.727 Vali Acc: 0.530 Test Loss: 1.727 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps215_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 75159554
model size : 301.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps215_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4922096729278564
Epoch: 1, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.866 Vali Acc: 0.430 Test Loss: 0.866 Test Acc: 0.430
Validation loss decreased (inf --> -0.429991).  Saving model ...
Epoch: 2 cost time: 1.9245920181274414
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
Validation loss decreased (-0.429991 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 2.271707534790039
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.685 Vali Acc: 0.630 Test Loss: 0.685 Test Acc: 0.630
Validation loss decreased (-0.449993 --> -0.629993).  Saving model ...
Epoch: 4 cost time: 2.3250467777252197
Epoch: 4, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.746 Vali Acc: 0.570 Test Loss: 0.746 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2324750423431396
Epoch: 5, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.265172243118286
Epoch: 6, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.699 Vali Acc: 0.630 Test Loss: 0.699 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2785074710845947
Epoch: 7, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.974 Vali Acc: 0.500 Test Loss: 0.974 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.272078275680542
Epoch: 8, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.11238694190979
Epoch: 9, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.133 Vali Acc: 0.620 Test Loss: 1.133 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3084030151367188
Epoch: 10, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.062 Vali Acc: 0.450 Test Loss: 1.062 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.039510488510132
Epoch: 11, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.357 Vali Acc: 0.520 Test Loss: 1.357 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2030189037323
Epoch: 12, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.151 Vali Acc: 0.520 Test Loss: 1.151 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.246232271194458
Epoch: 13, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.319 Vali Acc: 0.490 Test Loss: 1.319 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps215_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 75119618
model size : 301.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.812200546264648
Epoch: 1, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.1834967136383057
Epoch: 2, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 3.1884868144989014
Epoch: 3, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.957554578781128
Epoch: 4, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3037562370300293
Epoch: 5, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2960894107818604
Epoch: 6, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.853 Vali Acc: 0.460 Test Loss: 0.853 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.099747896194458
Epoch: 7, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.834 Vali Acc: 0.470 Test Loss: 0.834 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.018857479095459
Epoch: 8, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.913 Vali Acc: 0.520 Test Loss: 0.913 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1216795444488525
Epoch: 9, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.012 Vali Acc: 0.550 Test Loss: 1.012 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3968257904052734
Epoch: 10, Steps: 18 | Train Loss: 0.490 Vali Loss: 1.096 Vali Acc: 0.510 Test Loss: 1.096 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0037903785705566
Epoch: 11, Steps: 18 | Train Loss: 0.467 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.3144707679748535
Epoch: 12, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.822 Vali Acc: 0.500 Test Loss: 1.822 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 77586434
model size : 310.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.543383359909058
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.672 Vali Acc: 0.570 Test Loss: 0.672 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.8430180549621582
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7802574634552002
Epoch: 3, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.679 Vali Acc: 0.540 Test Loss: 0.679 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8850834369659424
Epoch: 4, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.23098087310791
Epoch: 5, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0405948162078857
Epoch: 6, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.835 Vali Acc: 0.590 Test Loss: 0.835 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 2.4966912269592285
Epoch: 7, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3700380325317383
Epoch: 8, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4087817668914795
Epoch: 9, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.813 Vali Acc: 0.550 Test Loss: 0.813 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.000631093978882
Epoch: 10, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.840 Vali Acc: 0.580 Test Loss: 0.840 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3481802940368652
Epoch: 11, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.006 Vali Acc: 0.580 Test Loss: 1.006 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.959444284439087
Epoch: 12, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.159 Vali Acc: 0.480 Test Loss: 1.159 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.488224506378174
Epoch: 13, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.099 Vali Acc: 0.490 Test Loss: 1.099 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3488550186157227
Epoch: 14, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.170 Vali Acc: 0.460 Test Loss: 1.170 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1023905277252197
Epoch: 15, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.117 Vali Acc: 0.570 Test Loss: 1.117 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.413027763366699
Epoch: 16, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.172 Vali Acc: 0.490 Test Loss: 1.172 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 77512706
model size : 310.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3611674308776855
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.060256242752075
Epoch: 2, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.996539831161499
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.735 Vali Acc: 0.540 Test Loss: 0.735 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.2332077026367188
Epoch: 4, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7844080924987793
Epoch: 5, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.704 Vali Acc: 0.560 Test Loss: 0.704 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 2.1895854473114014
Epoch: 6, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1708807945251465
Epoch: 7, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.978 Vali Acc: 0.420 Test Loss: 0.978 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9933552742004395
Epoch: 8, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1552743911743164
Epoch: 9, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.986 Vali Acc: 0.520 Test Loss: 0.986 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9870998859405518
Epoch: 10, Steps: 18 | Train Loss: 0.358 Vali Loss: 0.878 Vali Acc: 0.480 Test Loss: 0.878 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1824240684509277
Epoch: 11, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.091 Vali Acc: 0.490 Test Loss: 1.091 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.043120861053467
Epoch: 12, Steps: 18 | Train Loss: 0.318 Vali Loss: 0.967 Vali Acc: 0.440 Test Loss: 0.967 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0794503688812256
Epoch: 13, Steps: 18 | Train Loss: 0.247 Vali Loss: 0.984 Vali Acc: 0.480 Test Loss: 0.984 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0290966033935547
Epoch: 14, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.951 Vali Acc: 0.540 Test Loss: 0.951 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.162574529647827
Epoch: 15, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.141 Vali Acc: 0.570 Test Loss: 1.141 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569989).  Saving model ...
Epoch: 16 cost time: 2.270423173904419
Epoch: 16, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.425 Vali Acc: 0.430 Test Loss: 1.425 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.021733283996582
Epoch: 17, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.337 Vali Acc: 0.510 Test Loss: 1.337 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.678145408630371
Epoch: 18, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.317 Vali Acc: 0.510 Test Loss: 1.317 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0076904296875
Epoch: 19, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.608 Vali Acc: 0.450 Test Loss: 1.608 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.176241397857666
Epoch: 20, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.182 Vali Acc: 0.510 Test Loss: 1.182 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.177438259124756
Epoch: 21, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.233 Vali Acc: 0.450 Test Loss: 1.233 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.179438829421997
Epoch: 22, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.294 Vali Acc: 0.510 Test Loss: 1.294 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3067102432250977
Epoch: 23, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.724 Vali Acc: 0.440 Test Loss: 1.724 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9851605892181396
Epoch: 24, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3364675045013428
Epoch: 25, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.183 Vali Acc: 0.430 Test Loss: 2.183 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 77475842
model size : 310.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.940614700317383
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.966 Vali Acc: 0.400 Test Loss: 0.966 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 2.0463411808013916
Epoch: 2, Steps: 18 | Train Loss: 0.793 Vali Loss: 0.729 Vali Acc: 0.430 Test Loss: 0.729 Test Acc: 0.430
Validation loss decreased (-0.399990 --> -0.429993).  Saving model ...
Epoch: 3 cost time: 2.82064151763916
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
Validation loss decreased (-0.429993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.906658172607422
Epoch: 4, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7957191467285156
Epoch: 5, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6807916164398193
Epoch: 6, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.150 Vali Acc: 0.450 Test Loss: 1.150 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0869858264923096
Epoch: 7, Steps: 18 | Train Loss: 0.551 Vali Loss: 1.263 Vali Acc: 0.470 Test Loss: 1.263 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7800397872924805
Epoch: 8, Steps: 18 | Train Loss: 0.432 Vali Loss: 1.022 Vali Acc: 0.520 Test Loss: 1.022 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6133484840393066
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.145 Vali Acc: 0.590 Test Loss: 1.145 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589989).  Saving model ...
Epoch: 10 cost time: 2.652418851852417
Epoch: 10, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.243 Vali Acc: 0.530 Test Loss: 1.243 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9460701942443848
Epoch: 11, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.263 Vali Acc: 0.460 Test Loss: 1.263 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9620048999786377
Epoch: 12, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8359339237213135
Epoch: 13, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.098 Vali Acc: 0.460 Test Loss: 1.098 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4327659606933594
Epoch: 14, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.640 Vali Acc: 0.490 Test Loss: 1.640 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8814191818237305
Epoch: 15, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.559 Vali Acc: 0.470 Test Loss: 1.559 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9333648681640625
Epoch: 16, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.383 Vali Acc: 0.590 Test Loss: 1.383 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.947371006011963
Epoch: 17, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.656 Vali Acc: 0.520 Test Loss: 1.656 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6928913593292236
Epoch: 18, Steps: 18 | Train Loss: 0.269 Vali Loss: 1.338 Vali Acc: 0.520 Test Loss: 1.338 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8285160064697266
Epoch: 19, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.904 Vali Acc: 0.510 Test Loss: 1.904 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 80375810
model size : 321.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.220216751098633
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.659 Vali Acc: 0.610 Test Loss: 0.659 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 2.5654666423797607
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.439711570739746
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4508960247039795
Epoch: 4, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.698 Vali Acc: 0.570 Test Loss: 0.698 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3908302783966064
Epoch: 5, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3773512840270996
Epoch: 6, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.767 Vali Acc: 0.590 Test Loss: 0.767 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8630738258361816
Epoch: 7, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.848 Vali Acc: 0.550 Test Loss: 0.848 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.842634916305542
Epoch: 8, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.930 Vali Acc: 0.580 Test Loss: 0.930 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8133902549743652
Epoch: 9, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.941 Vali Acc: 0.580 Test Loss: 0.941 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8164987564086914
Epoch: 10, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.865 Vali Acc: 0.600 Test Loss: 0.865 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1198034286499023
Epoch: 11, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.344 Vali Acc: 0.540 Test Loss: 1.344 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 80311298
model size : 321.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.667229175567627
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.718 Vali Acc: 0.580 Test Loss: 0.718 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.230233669281006
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8205559253692627
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0953052043914795
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.744 Vali Acc: 0.580 Test Loss: 0.744 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1834897994995117
Epoch: 5, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.779 Vali Acc: 0.480 Test Loss: 0.779 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1302995681762695
Epoch: 6, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.929 Vali Acc: 0.580 Test Loss: 0.929 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.080657958984375
Epoch: 7, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8269290924072266
Epoch: 8, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.045 Vali Acc: 0.500 Test Loss: 1.045 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2107009887695312
Epoch: 9, Steps: 18 | Train Loss: 0.446 Vali Loss: 1.092 Vali Acc: 0.470 Test Loss: 1.092 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9917750358581543
Epoch: 10, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.209 Vali Acc: 0.470 Test Loss: 1.209 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2591052055358887
Epoch: 11, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.182 Vali Acc: 0.510 Test Loss: 1.182 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 80277506
model size : 320.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps273_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.102943181991577
Epoch: 1, Steps: 18 | Train Loss: 0.766 Vali Loss: 0.798 Vali Acc: 0.420 Test Loss: 0.798 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 2.7830991744995117
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (-0.419992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.6552138328552246
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.865 Vali Acc: 0.460 Test Loss: 0.865 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8068888187408447
Epoch: 4, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6445021629333496
Epoch: 5, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.887 Vali Acc: 0.520 Test Loss: 0.887 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.806913375854492
Epoch: 6, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.730 Vali Acc: 0.580 Test Loss: 0.730 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 2.7683300971984863
Epoch: 7, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.827 Vali Acc: 0.550 Test Loss: 0.827 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9964265823364258
Epoch: 8, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.995 Vali Acc: 0.530 Test Loss: 0.995 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1290128231048584
Epoch: 9, Steps: 18 | Train Loss: 0.527 Vali Loss: 1.270 Vali Acc: 0.440 Test Loss: 1.270 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.071687698364258
Epoch: 10, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.983 Vali Acc: 0.540 Test Loss: 0.983 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0636825561523438
Epoch: 11, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0326356887817383
Epoch: 12, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.512 Vali Acc: 0.480 Test Loss: 1.512 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1166224479675293
Epoch: 13, Steps: 18 | Train Loss: 0.401 Vali Loss: 1.052 Vali Acc: 0.510 Test Loss: 1.052 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1137402057647705
Epoch: 14, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.381 Vali Acc: 0.490 Test Loss: 1.381 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9397497177124023
Epoch: 15, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.775 Vali Acc: 0.470 Test Loss: 1.775 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.220972776412964
Epoch: 16, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.813 Vali Acc: 0.510 Test Loss: 1.813 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps273_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 83755010
model size : 334.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps273_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.171694278717041
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.684 Vali Acc: 0.490 Test Loss: 0.684 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.8246262073516846
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.737886905670166
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.673 Vali Acc: 0.630 Test Loss: 0.673 Test Acc: 0.630
Validation loss decreased (-0.559993 --> -0.629993).  Saving model ...
Epoch: 4 cost time: 2.502622127532959
Epoch: 4, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7510390281677246
Epoch: 5, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.76082181930542
Epoch: 6, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4103753566741943
Epoch: 7, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.168 Vali Acc: 0.590 Test Loss: 1.168 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9349429607391357
Epoch: 8, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7507917881011963
Epoch: 9, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.971 Vali Acc: 0.480 Test Loss: 0.971 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.749373435974121
Epoch: 10, Steps: 18 | Train Loss: 0.425 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5633656978607178
Epoch: 11, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.945 Vali Acc: 0.560 Test Loss: 0.945 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5190484523773193
Epoch: 12, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.930 Vali Acc: 0.520 Test Loss: 0.930 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5314786434173584
Epoch: 13, Steps: 18 | Train Loss: 0.358 Vali Loss: 1.085 Vali Acc: 0.560 Test Loss: 1.085 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps273_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 83693570
model size : 333.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps273_str273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4593639373779297
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.725 Vali Acc: 0.540 Test Loss: 0.725 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.313415050506592
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.5317153930664062
Epoch: 3, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2708992958068848
Epoch: 4, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5144081115722656
Epoch: 5, Steps: 18 | Train Loss: 0.462 Vali Loss: 0.772 Vali Acc: 0.570 Test Loss: 0.772 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 2.4697248935699463
Epoch: 6, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.804 Vali Acc: 0.560 Test Loss: 0.804 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.321375608444214
Epoch: 7, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.870 Vali Acc: 0.570 Test Loss: 0.870 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5522565841674805
Epoch: 8, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.418484687805176
Epoch: 9, Steps: 18 | Train Loss: 0.358 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.249279499053955
Epoch: 10, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.241 Vali Acc: 0.580 Test Loss: 1.241 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 2.4950196743011475
Epoch: 11, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3282432556152344
Epoch: 12, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.214 Vali Acc: 0.480 Test Loss: 1.214 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.497032880783081
Epoch: 13, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.278 Vali Acc: 0.530 Test Loss: 1.278 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.477942943572998
Epoch: 14, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.216 Vali Acc: 0.470 Test Loss: 1.216 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.376702308654785
Epoch: 15, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.480 Vali Acc: 0.490 Test Loss: 1.480 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5586159229278564
Epoch: 16, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.485 Vali Acc: 0.450 Test Loss: 1.485 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5216617584228516
Epoch: 17, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.547 Vali Acc: 0.450 Test Loss: 1.547 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8214962482452393
Epoch: 18, Steps: 18 | Train Loss: 0.195 Vali Loss: 2.116 Vali Acc: 0.480 Test Loss: 2.116 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4921934604644775
Epoch: 19, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.466 Vali Acc: 0.560 Test Loss: 1.466 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5020675659179688
Epoch: 20, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.968 Vali Acc: 0.440 Test Loss: 1.968 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps273_str273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 83662850
model size : 333.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps300_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.714725971221924
Epoch: 1, Steps: 18 | Train Loss: 0.780 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.1514992713928223
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
Validation loss decreased (-0.479993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.3109335899353027
Epoch: 3, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.687 Vali Acc: 0.570 Test Loss: 0.687 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.0633628368377686
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9804015159606934
Epoch: 5, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.095761299133301
Epoch: 6, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.742 Vali Acc: 0.570 Test Loss: 0.742 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2398674488067627
Epoch: 7, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.924 Vali Acc: 0.590 Test Loss: 0.924 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589991).  Saving model ...
Epoch: 8 cost time: 3.271963596343994
Epoch: 8, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.071 Vali Acc: 0.520 Test Loss: 1.071 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9680049419403076
Epoch: 9, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.029 Vali Acc: 0.510 Test Loss: 1.029 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3050832748413086
Epoch: 10, Steps: 18 | Train Loss: 0.400 Vali Loss: 1.615 Vali Acc: 0.540 Test Loss: 1.615 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.993476152420044
Epoch: 11, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.745 Vali Acc: 0.540 Test Loss: 1.745 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1915335655212402
Epoch: 12, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.315 Vali Acc: 0.510 Test Loss: 1.315 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.236659526824951
Epoch: 13, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.919 Vali Acc: 0.510 Test Loss: 1.919 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.957771062850952
Epoch: 14, Steps: 18 | Train Loss: 0.485 Vali Loss: 1.809 Vali Acc: 0.510 Test Loss: 1.809 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9953646659851074
Epoch: 15, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.537 Vali Acc: 0.470 Test Loss: 1.537 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.987419605255127
Epoch: 16, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.706 Vali Acc: 0.450 Test Loss: 1.706 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.987847089767456
Epoch: 17, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.082 Vali Acc: 0.460 Test Loss: 2.082 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps300_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 87727106
model size : 349.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.304853916168213
Epoch: 1, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.707 Vali Acc: 0.470 Test Loss: 0.707 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.8892881870269775
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.6915667057037354
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.698 Vali Acc: 0.620 Test Loss: 0.698 Test Acc: 0.620
Validation loss decreased (-0.529993 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 2.1547513008117676
Epoch: 4, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.070585012435913
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.829420328140259
Epoch: 6, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.971 Vali Acc: 0.600 Test Loss: 0.971 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0090012550354004
Epoch: 7, Steps: 18 | Train Loss: 0.455 Vali Loss: 0.942 Vali Acc: 0.500 Test Loss: 0.942 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.002842426300049
Epoch: 8, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.115 Vali Acc: 0.520 Test Loss: 1.115 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7760045528411865
Epoch: 9, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.018 Vali Acc: 0.540 Test Loss: 1.018 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.898266553878784
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.019 Vali Acc: 0.580 Test Loss: 1.019 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.958317279815674
Epoch: 11, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.009 Vali Acc: 0.510 Test Loss: 1.009 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.682443141937256
Epoch: 12, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.431 Vali Acc: 0.580 Test Loss: 1.431 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.963059425354004
Epoch: 13, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.355 Vali Acc: 0.560 Test Loss: 1.355 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 87671810
model size : 349.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps300_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.463557481765747
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.3516674041748047
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9288268089294434
Epoch: 3, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.690 Vali Acc: 0.580 Test Loss: 0.690 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.8570222854614258
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2744767665863037
Epoch: 5, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.828 Vali Acc: 0.480 Test Loss: 0.828 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5126535892486572
Epoch: 6, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.846 Vali Acc: 0.480 Test Loss: 0.846 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9348208904266357
Epoch: 7, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.985 Vali Acc: 0.470 Test Loss: 0.985 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4766409397125244
Epoch: 8, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.896 Vali Acc: 0.530 Test Loss: 0.896 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6394670009613037
Epoch: 9, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.890 Vali Acc: 0.510 Test Loss: 0.890 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2121245861053467
Epoch: 10, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.948 Vali Acc: 0.520 Test Loss: 0.948 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.520916700363159
Epoch: 11, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.105 Vali Acc: 0.520 Test Loss: 1.105 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.08174991607666
Epoch: 12, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.038 Vali Acc: 0.510 Test Loss: 1.038 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3753468990325928
Epoch: 13, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.235 Vali Acc: 0.510 Test Loss: 1.235 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps300_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 87644162
model size : 349.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps334_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.23284912109375
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.680 Vali Acc: 0.600 Test Loss: 0.680 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 3.0414068698883057
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.027222156524658
Epoch: 3, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.847 Vali Acc: 0.430 Test Loss: 0.847 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1492159366607666
Epoch: 4, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.751 Vali Acc: 0.580 Test Loss: 0.751 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2245824337005615
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.013712167739868
Epoch: 6, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.849 Vali Acc: 0.470 Test Loss: 0.849 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4241714477539062
Epoch: 7, Steps: 18 | Train Loss: 0.534 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.112622022628784
Epoch: 8, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.867 Vali Acc: 0.510 Test Loss: 0.867 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0757226943969727
Epoch: 9, Steps: 18 | Train Loss: 0.518 Vali Loss: 1.099 Vali Acc: 0.510 Test Loss: 1.099 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.0579965114593506
Epoch: 10, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1842331886291504
Epoch: 11, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.268 Vali Acc: 0.580 Test Loss: 1.268 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps334_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 92725250
model size : 368.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps334_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.083358287811279
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.749 Vali Acc: 0.440 Test Loss: 0.749 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.5997793674468994
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.717 Vali Acc: 0.590 Test Loss: 0.717 Test Acc: 0.590
Validation loss decreased (-0.439993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.7489218711853027
Epoch: 3, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.690 Vali Acc: 0.560 Test Loss: 0.690 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9230995178222656
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7874205112457275
Epoch: 5, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.889 Vali Acc: 0.600 Test Loss: 0.889 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 2.697929859161377
Epoch: 6, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.808 Vali Acc: 0.580 Test Loss: 0.808 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.576977014541626
Epoch: 7, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7683374881744385
Epoch: 8, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.125 Vali Acc: 0.470 Test Loss: 1.125 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9438836574554443
Epoch: 9, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.990 Vali Acc: 0.520 Test Loss: 0.990 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.947974443435669
Epoch: 10, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.596 Vali Acc: 0.430 Test Loss: 1.596 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.618030548095703
Epoch: 11, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.987 Vali Acc: 0.510 Test Loss: 0.987 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.960983991622925
Epoch: 12, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.196 Vali Acc: 0.520 Test Loss: 1.196 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.948338508605957
Epoch: 13, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.274 Vali Acc: 0.560 Test Loss: 1.274 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7481837272644043
Epoch: 14, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7124359607696533
Epoch: 15, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.155 Vali Acc: 0.470 Test Loss: 1.155 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps334_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 92676098
model size : 368.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps334_str334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0902605056762695
Epoch: 1, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.696 Vali Acc: 0.440 Test Loss: 0.696 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.58172869682312
Epoch: 2, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 2.635056734085083
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
Validation loss decreased (-0.459993 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 2.5355851650238037
Epoch: 4, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.811 Vali Acc: 0.570 Test Loss: 0.811 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 2.5461931228637695
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.816 Vali Acc: 0.600 Test Loss: 0.816 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.636402130126953
Epoch: 6, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5003795623779297
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.875 Vali Acc: 0.560 Test Loss: 0.875 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5554685592651367
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.093 Vali Acc: 0.520 Test Loss: 1.093 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.707355499267578
Epoch: 9, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.052 Vali Acc: 0.520 Test Loss: 1.052 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5110905170440674
Epoch: 10, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.014 Vali Acc: 0.450 Test Loss: 1.014 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4626810550689697
Epoch: 11, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.157 Vali Acc: 0.490 Test Loss: 1.157 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0919253826141357
Epoch: 12, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.056 Vali Acc: 0.470 Test Loss: 1.056 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.103952407836914
Epoch: 13, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.970 Vali Acc: 0.540 Test Loss: 0.970 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.017890453338623
Epoch: 14, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.350 Vali Acc: 0.510 Test Loss: 1.350 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4596869945526123
Epoch: 15, Steps: 18 | Train Loss: 0.168 Vali Loss: 1.272 Vali Acc: 0.560 Test Loss: 1.272 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps334_str334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 92651522
model size : 368.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps375_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9507505893707275
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.2828621864318848
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
Validation loss decreased (-0.509992 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.464617967605591
Epoch: 3, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.733 Vali Acc: 0.660 Test Loss: 0.733 Test Acc: 0.660
Validation loss decreased (-0.589993 --> -0.659993).  Saving model ...
Epoch: 4 cost time: 2.8787453174591064
Epoch: 4, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.057990074157715
Epoch: 5, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.71821665763855
Epoch: 6, Steps: 18 | Train Loss: 0.519 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8376336097717285
Epoch: 7, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.884 Vali Acc: 0.590 Test Loss: 0.884 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8425610065460205
Epoch: 8, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.863 Vali Acc: 0.590 Test Loss: 0.863 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.713803291320801
Epoch: 9, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.882 Vali Acc: 0.520 Test Loss: 0.882 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.766505241394043
Epoch: 10, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.111 Vali Acc: 0.510 Test Loss: 1.111 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.327120304107666
Epoch: 11, Steps: 18 | Train Loss: 0.500 Vali Loss: 1.116 Vali Acc: 0.550 Test Loss: 1.116 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.759107828140259
Epoch: 12, Steps: 18 | Train Loss: 0.270 Vali Loss: 0.996 Vali Acc: 0.550 Test Loss: 0.996 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3349664211273193
Epoch: 13, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.786 Vali Acc: 0.470 Test Loss: 1.786 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps375_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 98758658
model size : 391.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.004597187042236
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.695 Vali Acc: 0.560 Test Loss: 0.695 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.427839994430542
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6674094200134277
Epoch: 3, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4929099082946777
Epoch: 4, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.847 Vali Acc: 0.520 Test Loss: 0.847 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9496090412139893
Epoch: 5, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.748 Vali Acc: 0.540 Test Loss: 0.748 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4776062965393066
Epoch: 6, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.672943115234375
Epoch: 7, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.723 Vali Acc: 0.580 Test Loss: 0.723 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 2.2120678424835205
Epoch: 8, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.887 Vali Acc: 0.500 Test Loss: 0.887 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1293399333953857
Epoch: 9, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.981 Vali Acc: 0.480 Test Loss: 0.981 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1257922649383545
Epoch: 10, Steps: 18 | Train Loss: 0.421 Vali Loss: 1.471 Vali Acc: 0.510 Test Loss: 1.471 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.068399667739868
Epoch: 11, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.212 Vali Acc: 0.530 Test Loss: 1.212 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1092188358306885
Epoch: 12, Steps: 18 | Train Loss: 0.385 Vali Loss: 1.068 Vali Acc: 0.570 Test Loss: 1.068 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.05881404876709
Epoch: 13, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.194 Vali Acc: 0.490 Test Loss: 1.194 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.174394130706787
Epoch: 14, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.397 Vali Acc: 0.490 Test Loss: 1.397 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8689167499542236
Epoch: 15, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.402 Vali Acc: 0.530 Test Loss: 1.402 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9356472492218018
Epoch: 16, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2852354049682617
Epoch: 17, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 98715650
model size : 391.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps375_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7263877391815186
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.758 Vali Acc: 0.440 Test Loss: 0.758 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.987306833267212
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.439992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.98698091506958
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.707 Vali Acc: 0.570 Test Loss: 0.707 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.992673873901367
Epoch: 4, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.671 Vali Acc: 0.580 Test Loss: 0.671 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 2.812865972518921
Epoch: 5, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.710 Vali Acc: 0.620 Test Loss: 0.710 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619993).  Saving model ...
Epoch: 6 cost time: 2.8730218410491943
Epoch: 6, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9645369052886963
Epoch: 7, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.855 Vali Acc: 0.530 Test Loss: 0.855 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7435829639434814
Epoch: 8, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.843 Vali Acc: 0.550 Test Loss: 0.843 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7670023441314697
Epoch: 9, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.924 Vali Acc: 0.530 Test Loss: 0.924 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.812373399734497
Epoch: 10, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.252 Vali Acc: 0.470 Test Loss: 1.252 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9654903411865234
Epoch: 11, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.432 Vali Acc: 0.520 Test Loss: 1.432 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.753993272781372
Epoch: 12, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.155 Vali Acc: 0.560 Test Loss: 1.155 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2832822799682617
Epoch: 13, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.449 Vali Acc: 0.520 Test Loss: 1.449 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9362680912017822
Epoch: 14, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.310 Vali Acc: 0.520 Test Loss: 1.310 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8511908054351807
Epoch: 15, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.170 Vali Acc: 0.580 Test Loss: 1.170 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps375_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 98697218
model size : 391.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps429_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.0272135734558105
Epoch: 1, Steps: 18 | Train Loss: 0.796 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 3.602114200592041
Epoch: 2, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.685 Vali Acc: 0.530 Test Loss: 0.685 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4301369190216064
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.661649227142334
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2546141147613525
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 1.046 Vali Acc: 0.490 Test Loss: 1.046 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.605121612548828
Epoch: 6, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.985 Vali Acc: 0.460 Test Loss: 0.985 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3886184692382812
Epoch: 7, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.878 Vali Acc: 0.530 Test Loss: 0.878 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.589350938796997
Epoch: 8, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.886 Vali Acc: 0.490 Test Loss: 0.886 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5178279876708984
Epoch: 9, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.008 Vali Acc: 0.470 Test Loss: 1.008 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5578136444091797
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 0.981 Vali Acc: 0.590 Test Loss: 0.981 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589990).  Saving model ...
Epoch: 11 cost time: 3.119114637374878
Epoch: 11, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.941 Vali Acc: 0.500 Test Loss: 0.941 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3216357231140137
Epoch: 12, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.084 Vali Acc: 0.520 Test Loss: 1.084 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2747671604156494
Epoch: 13, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.040 Vali Acc: 0.540 Test Loss: 1.040 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.387911319732666
Epoch: 14, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.221 Vali Acc: 0.480 Test Loss: 1.221 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.479856014251709
Epoch: 15, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.229 Vali Acc: 0.520 Test Loss: 1.229 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.358315944671631
Epoch: 16, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3115546703338623
Epoch: 17, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3682053089141846
Epoch: 18, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.325 Vali Acc: 0.520 Test Loss: 1.325 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.354252576828003
Epoch: 19, Steps: 18 | Train Loss: 0.153 Vali Loss: 2.773 Vali Acc: 0.460 Test Loss: 2.773 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.330780267715454
Epoch: 20, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.686 Vali Acc: 0.480 Test Loss: 1.686 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps429_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 106708994
model size : 421.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps429_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.02397346496582
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.908 Vali Acc: 0.450 Test Loss: 0.908 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 2.371150493621826
Epoch: 2, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.697 Vali Acc: 0.530 Test Loss: 0.697 Test Acc: 0.530
Validation loss decreased (-0.449991 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.1572117805480957
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1766655445098877
Epoch: 4, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1362242698669434
Epoch: 5, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 3.170118570327759
Epoch: 6, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.818 Vali Acc: 0.480 Test Loss: 0.818 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1341352462768555
Epoch: 7, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.988 Vali Acc: 0.530 Test Loss: 0.988 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1673479080200195
Epoch: 8, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.398118019104004
Epoch: 9, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.891 Vali Acc: 0.510 Test Loss: 0.891 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2856075763702393
Epoch: 10, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.144 Vali Acc: 0.510 Test Loss: 1.144 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.440847873687744
Epoch: 11, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.084 Vali Acc: 0.470 Test Loss: 1.084 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.146912097930908
Epoch: 12, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.510 Vali Acc: 0.610 Test Loss: 1.510 Test Acc: 0.610
Validation loss decreased (-0.539992 --> -0.609985).  Saving model ...
Epoch: 13 cost time: 3.3092262744903564
Epoch: 13, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.153 Vali Acc: 0.530 Test Loss: 1.153 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4191582202911377
Epoch: 14, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.599 Vali Acc: 0.570 Test Loss: 1.599 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.365647315979004
Epoch: 15, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.224 Vali Acc: 0.540 Test Loss: 1.224 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3224937915802
Epoch: 16, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.132 Vali Acc: 0.520 Test Loss: 1.132 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.3209099769592285
Epoch: 17, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.425 Vali Acc: 0.470 Test Loss: 1.425 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.427002429962158
Epoch: 18, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.085 Vali Acc: 0.530 Test Loss: 1.085 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3828248977661133
Epoch: 19, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.476 Vali Acc: 0.490 Test Loss: 1.476 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4393868446350098
Epoch: 20, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.657 Vali Acc: 0.510 Test Loss: 1.657 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.240058183670044
Epoch: 21, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.042 Vali Acc: 0.530 Test Loss: 2.042 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.186882495880127
Epoch: 22, Steps: 18 | Train Loss: 0.130 Vali Loss: 2.005 Vali Acc: 0.490 Test Loss: 2.005 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps429_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 106672130
model size : 421.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps429_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.447603702545166
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.807 Vali Acc: 0.460 Test Loss: 0.807 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.3147597312927246
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.814 Vali Acc: 0.440 Test Loss: 0.814 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.294748067855835
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.785 Vali Acc: 0.450 Test Loss: 0.785 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2823963165283203
Epoch: 4, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
Validation loss decreased (-0.459992 --> -0.499991).  Saving model ...
Epoch: 5 cost time: 2.766050338745117
Epoch: 5, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 2.7541890144348145
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 1.069 Vali Acc: 0.490 Test Loss: 1.069 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5995686054229736
Epoch: 7, Steps: 18 | Train Loss: 0.538 Vali Loss: 1.395 Vali Acc: 0.420 Test Loss: 1.395 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8361213207244873
Epoch: 8, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.004 Vali Acc: 0.410 Test Loss: 1.004 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.062574625015259
Epoch: 9, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 10 cost time: 3.0878965854644775
Epoch: 10, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.086 Vali Acc: 0.470 Test Loss: 1.086 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7811696529388428
Epoch: 11, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.313 Vali Acc: 0.440 Test Loss: 1.313 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9924075603485107
Epoch: 12, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.383 Vali Acc: 0.470 Test Loss: 1.383 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.846665620803833
Epoch: 13, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.387 Vali Acc: 0.500 Test Loss: 1.387 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0715630054473877
Epoch: 14, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.141 Vali Acc: 0.510 Test Loss: 1.141 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.883434534072876
Epoch: 15, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.288 Vali Acc: 0.490 Test Loss: 1.288 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.852907657623291
Epoch: 16, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.360 Vali Acc: 0.490 Test Loss: 1.360 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.55277943611145
Epoch: 17, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.614 Vali Acc: 0.480 Test Loss: 1.614 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0622076988220215
Epoch: 18, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7221202850341797
Epoch: 19, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.420 Vali Acc: 0.490 Test Loss: 1.420 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps429_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 106653698
model size : 421.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.034468173980713
Epoch: 1, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.726 Vali Acc: 0.450 Test Loss: 0.726 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.7194182872772217
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (-0.449993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 3.4856719970703125
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.693686008453369
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.329246759414673
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.748 Vali Acc: 0.580 Test Loss: 0.748 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 3.381972551345825
Epoch: 6, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0882277488708496
Epoch: 7, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.659367084503174
Epoch: 8, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3226146697998047
Epoch: 9, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.824 Vali Acc: 0.580 Test Loss: 0.824 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4115970134735107
Epoch: 10, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.049 Vali Acc: 0.470 Test Loss: 1.049 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.076117992401123
Epoch: 11, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.303 Vali Acc: 0.450 Test Loss: 1.303 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.599466562271118
Epoch: 12, Steps: 18 | Train Loss: 0.521 Vali Loss: 1.184 Vali Acc: 0.480 Test Loss: 1.184 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.441042423248291
Epoch: 13, Steps: 18 | Train Loss: 0.332 Vali Loss: 0.988 Vali Acc: 0.530 Test Loss: 0.988 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.510200023651123
Epoch: 14, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.5349488258361816
Epoch: 15, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 117169154
model size : 461.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.760563135147095
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.204490900039673
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 3.5128173828125
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.705 Vali Acc: 0.570 Test Loss: 0.705 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.3022632598876953
Epoch: 4, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5695688724517822
Epoch: 5, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.944 Vali Acc: 0.460 Test Loss: 0.944 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.594994306564331
Epoch: 6, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.537745237350464
Epoch: 7, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0495378971099854
Epoch: 8, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7830708026885986
Epoch: 9, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.902 Vali Acc: 0.510 Test Loss: 0.902 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0004920959472656
Epoch: 10, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.162 Vali Acc: 0.480 Test Loss: 1.162 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9324018955230713
Epoch: 11, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.400 Vali Acc: 0.510 Test Loss: 1.400 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.136784076690674
Epoch: 12, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.204594135284424
Epoch: 13, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.484 Vali Acc: 0.480 Test Loss: 1.484 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 117138434
model size : 461.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.291524887084961
Epoch: 1, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.933535099029541
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.756 Vali Acc: 0.550 Test Loss: 0.756 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 3.0693771839141846
Epoch: 3, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0172765254974365
Epoch: 4, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.838 Vali Acc: 0.510 Test Loss: 0.838 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0796966552734375
Epoch: 5, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.853 Vali Acc: 0.480 Test Loss: 0.853 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.255918502807617
Epoch: 6, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.710 Vali Acc: 0.600 Test Loss: 0.710 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 7 cost time: 3.1112124919891357
Epoch: 7, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.856 Vali Acc: 0.560 Test Loss: 0.856 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0515053272247314
Epoch: 8, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.922 Vali Acc: 0.490 Test Loss: 0.922 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.042811632156372
Epoch: 9, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.036 Vali Acc: 0.490 Test Loss: 1.036 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.203371047973633
Epoch: 10, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.422 Vali Acc: 0.540 Test Loss: 1.422 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0805504322052
Epoch: 11, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.016 Vali Acc: 0.520 Test Loss: 1.016 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9830052852630615
Epoch: 12, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8945298194885254
Epoch: 13, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.196 Vali Acc: 0.540 Test Loss: 1.196 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.982926368713379
Epoch: 14, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.440 Vali Acc: 0.490 Test Loss: 1.440 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.998493194580078
Epoch: 15, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.633 Vali Acc: 0.470 Test Loss: 1.633 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.423705816268921
Epoch: 16, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.485 Vali Acc: 0.520 Test Loss: 1.485 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 117123074
model size : 461.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps600_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.505146265029907
Epoch: 1, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.765 Vali Acc: 0.400 Test Loss: 0.765 Test Acc: 0.400
Validation loss decreased (inf --> -0.399992).  Saving model ...
Epoch: 2 cost time: 3.798156499862671
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
Validation loss decreased (-0.399992 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 3.5184640884399414
Epoch: 3, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.794 Vali Acc: 0.460 Test Loss: 0.794 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.613978147506714
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.843 Vali Acc: 0.470 Test Loss: 0.843 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.0564165115356445
Epoch: 5, Steps: 18 | Train Loss: 0.549 Vali Loss: 1.170 Vali Acc: 0.450 Test Loss: 1.170 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8363776206970215
Epoch: 6, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.947 Vali Acc: 0.480 Test Loss: 0.947 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479991).  Saving model ...
Epoch: 7 cost time: 3.516822099685669
Epoch: 7, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.002 Vali Acc: 0.550 Test Loss: 1.002 Test Acc: 0.550
Validation loss decreased (-0.479991 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 2.945312261581421
Epoch: 8, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.963 Vali Acc: 0.520 Test Loss: 0.963 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9879403114318848
Epoch: 9, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.195 Vali Acc: 0.530 Test Loss: 1.195 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.879042863845825
Epoch: 10, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.965 Vali Acc: 0.520 Test Loss: 0.965 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.008653402328491
Epoch: 11, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.456646203994751
Epoch: 12, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.146 Vali Acc: 0.520 Test Loss: 1.146 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.05204963684082
Epoch: 13, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.174 Vali Acc: 0.530 Test Loss: 1.174 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.463032007217407
Epoch: 14, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.228 Vali Acc: 0.560 Test Loss: 1.228 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559988).  Saving model ...
Epoch: 15 cost time: 3.852895736694336
Epoch: 15, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.288 Vali Acc: 0.540 Test Loss: 1.288 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.144582033157349
Epoch: 16, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.720 Vali Acc: 0.560 Test Loss: 1.720 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5295650959014893
Epoch: 17, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.236 Vali Acc: 0.560 Test Loss: 1.236 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.194929599761963
Epoch: 18, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.664 Vali Acc: 0.530 Test Loss: 1.664 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3145198822021484
Epoch: 19, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.741 Vali Acc: 0.530 Test Loss: 1.741 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.25464391708374
Epoch: 20, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.572 Vali Acc: 0.540 Test Loss: 1.572 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.9370648860931396
Epoch: 21, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.001 Vali Acc: 0.470 Test Loss: 2.001 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.4888083934783936
Epoch: 22, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.715 Vali Acc: 0.530 Test Loss: 1.715 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.1822874546051025
Epoch: 23, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.752 Vali Acc: 0.550 Test Loss: 1.752 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.412036418914795
Epoch: 24, Steps: 18 | Train Loss: 0.108 Vali Loss: 2.153 Vali Acc: 0.480 Test Loss: 2.153 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps600_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 131902466
model size : 517.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.649472236633301
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.806 Vali Acc: 0.420 Test Loss: 0.806 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 3.8566112518310547
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
Validation loss decreased (-0.419992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.083230257034302
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.828 Vali Acc: 0.450 Test Loss: 0.828 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8390440940856934
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 4.004324197769165
Epoch: 5, Steps: 18 | Train Loss: 0.525 Vali Loss: 1.010 Vali Acc: 0.500 Test Loss: 1.010 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.136415481567383
Epoch: 6, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.876 Vali Acc: 0.530 Test Loss: 0.876 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9568984508514404
Epoch: 7, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.905 Vali Acc: 0.570 Test Loss: 0.905 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 3.098320722579956
Epoch: 8, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.020 Vali Acc: 0.550 Test Loss: 1.020 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.904008626937866
Epoch: 9, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.031 Vali Acc: 0.530 Test Loss: 1.031 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.064030408859253
Epoch: 10, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.040 Vali Acc: 0.570 Test Loss: 1.040 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.071818590164185
Epoch: 11, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.028 Vali Acc: 0.500 Test Loss: 1.028 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.971257448196411
Epoch: 12, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.005 Vali Acc: 0.520 Test Loss: 1.005 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.99580717086792
Epoch: 13, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.004770994186401
Epoch: 14, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.276 Vali Acc: 0.520 Test Loss: 1.276 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.157725811004639
Epoch: 15, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.528 Vali Acc: 0.540 Test Loss: 1.528 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.1905434131622314
Epoch: 16, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.307 Vali Acc: 0.570 Test Loss: 1.307 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.852853775024414
Epoch: 17, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.251 Vali Acc: 0.580 Test Loss: 1.251 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579987).  Saving model ...
Epoch: 18 cost time: 4.061927080154419
Epoch: 18, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.736 Vali Acc: 0.500 Test Loss: 1.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8470516204833984
Epoch: 19, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.924 Vali Acc: 0.510 Test Loss: 1.924 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.236663818359375
Epoch: 20, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.460 Vali Acc: 0.490 Test Loss: 1.460 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.286216974258423
Epoch: 21, Steps: 18 | Train Loss: 0.106 Vali Loss: 2.021 Vali Acc: 0.570 Test Loss: 2.021 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.015169620513916
Epoch: 22, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.619 Vali Acc: 0.490 Test Loss: 1.619 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.112711191177368
Epoch: 23, Steps: 18 | Train Loss: 0.081 Vali Loss: 1.752 Vali Acc: 0.490 Test Loss: 1.752 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.9760468006134033
Epoch: 24, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.757 Vali Acc: 0.510 Test Loss: 1.757 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9173285961151123
Epoch: 25, Steps: 18 | Train Loss: 0.117 Vali Loss: 2.566 Vali Acc: 0.520 Test Loss: 2.566 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.946772813796997
Epoch: 26, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.620 Vali Acc: 0.510 Test Loss: 1.620 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.014123439788818
Epoch: 27, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.051 Vali Acc: 0.550 Test Loss: 2.051 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 131877890
model size : 517.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps600_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.939448356628418
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.818 Vali Acc: 0.370 Test Loss: 0.818 Test Acc: 0.370
Validation loss decreased (inf --> -0.369992).  Saving model ...
Epoch: 2 cost time: 2.911393880844116
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
Validation loss decreased (-0.369992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.4167182445526123
Epoch: 3, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.736 Vali Acc: 0.430 Test Loss: 0.736 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.888956308364868
Epoch: 4, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4126882553100586
Epoch: 5, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.879 Vali Acc: 0.480 Test Loss: 0.879 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.954352617263794
Epoch: 6, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 3.399461269378662
Epoch: 7, Steps: 18 | Train Loss: 0.453 Vali Loss: 1.154 Vali Acc: 0.530 Test Loss: 1.154 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6849207878112793
Epoch: 8, Steps: 18 | Train Loss: 0.451 Vali Loss: 1.081 Vali Acc: 0.500 Test Loss: 1.081 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2458372116088867
Epoch: 9, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.830 Vali Acc: 0.580 Test Loss: 0.830 Test Acc: 0.580
Validation loss decreased (-0.539991 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 3.5529580116271973
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.392380952835083
Epoch: 11, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.313 Vali Acc: 0.480 Test Loss: 1.313 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6591691970825195
Epoch: 12, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.296 Vali Acc: 0.530 Test Loss: 1.296 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4840829372406006
Epoch: 13, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.022 Vali Acc: 0.550 Test Loss: 1.022 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6072041988372803
Epoch: 14, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4641246795654297
Epoch: 15, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.426 Vali Acc: 0.500 Test Loss: 1.426 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.5968825817108154
Epoch: 16, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.219 Vali Acc: 0.530 Test Loss: 1.219 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.631408214569092
Epoch: 17, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.446 Vali Acc: 0.510 Test Loss: 1.446 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.658005475997925
Epoch: 18, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.452 Vali Acc: 0.520 Test Loss: 1.452 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.583150625228882
Epoch: 19, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.457 Vali Acc: 0.530 Test Loss: 1.457 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el6_dm768_df768_ps600_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 131865602
model size : 517.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.396160840988159
Epoch: 1, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.373391628265381
Epoch: 2, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.667 Vali Acc: 0.620 Test Loss: 0.667 Test Acc: 0.620
Validation loss decreased (-0.499992 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 2.7116572856903076
Epoch: 3, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.838467597961426
Epoch: 4, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.769782304763794
Epoch: 5, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.705 Vali Acc: 0.580 Test Loss: 0.705 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.825840950012207
Epoch: 6, Steps: 18 | Train Loss: 0.868 Vali Loss: 1.173 Vali Acc: 0.480 Test Loss: 1.173 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7993836402893066
Epoch: 7, Steps: 18 | Train Loss: 0.768 Vali Loss: 0.922 Vali Acc: 0.450 Test Loss: 0.922 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.414262533187866
Epoch: 8, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.754 Vali Acc: 0.570 Test Loss: 0.754 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.675210952758789
Epoch: 9, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.976 Vali Acc: 0.590 Test Loss: 0.976 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8598337173461914
Epoch: 10, Steps: 18 | Train Loss: 0.637 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.942798376083374
Epoch: 11, Steps: 18 | Train Loss: 0.490 Vali Loss: 1.070 Vali Acc: 0.570 Test Loss: 1.070 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.903123617172241
Epoch: 12, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.967 Vali Acc: 0.620 Test Loss: 0.967 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 54281474
model size : 221.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.284174919128418
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.97529935836792
Epoch: 2, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.755 Vali Acc: 0.460 Test Loss: 0.755 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0363717079162598
Epoch: 3, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.694 Vali Acc: 0.540 Test Loss: 0.694 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.9599595069885254
Epoch: 4, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.047534465789795
Epoch: 5, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.805 Vali Acc: 0.530 Test Loss: 0.805 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.887315273284912
Epoch: 6, Steps: 18 | Train Loss: 0.576 Vali Loss: 1.000 Vali Acc: 0.560 Test Loss: 1.000 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559990).  Saving model ...
Epoch: 7 cost time: 1.964482307434082
Epoch: 7, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.136 Vali Acc: 0.490 Test Loss: 1.136 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.032728672027588
Epoch: 8, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.872413158416748
Epoch: 9, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.752 Vali Acc: 0.570 Test Loss: 0.752 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 2.0012054443359375
Epoch: 10, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8643136024475098
Epoch: 11, Steps: 18 | Train Loss: 0.399 Vali Loss: 1.095 Vali Acc: 0.590 Test Loss: 1.095 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589989).  Saving model ...
Epoch: 12 cost time: 2.069216012954712
Epoch: 12, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.907 Vali Acc: 0.550 Test Loss: 0.907 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9291093349456787
Epoch: 13, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.165 Vali Acc: 0.560 Test Loss: 1.165 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8642265796661377
Epoch: 14, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.037 Vali Acc: 0.530 Test Loss: 1.037 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.845907211303711
Epoch: 15, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.142 Vali Acc: 0.590 Test Loss: 1.142 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7312898635864258
Epoch: 16, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.292 Vali Acc: 0.540 Test Loss: 1.292 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5868942737579346
Epoch: 17, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.586 Vali Acc: 0.520 Test Loss: 1.586 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5541493892669678
Epoch: 18, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.645 Vali Acc: 0.620 Test Loss: 1.645 Test Acc: 0.620
Validation loss decreased (-0.589989 --> -0.619984).  Saving model ...
Epoch: 19 cost time: 1.67012619972229
Epoch: 19, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.331 Vali Acc: 0.580 Test Loss: 1.331 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.950887680053711
Epoch: 20, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.525 Vali Acc: 0.570 Test Loss: 1.525 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7353184223175049
Epoch: 21, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.550 Vali Acc: 0.510 Test Loss: 1.550 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5193748474121094
Epoch: 22, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.578 Vali Acc: 0.500 Test Loss: 1.578 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8918182849884033
Epoch: 23, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.629 Vali Acc: 0.500 Test Loss: 1.629 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5348608493804932
Epoch: 24, Steps: 18 | Train Loss: 0.236 Vali Loss: 2.106 Vali Acc: 0.550 Test Loss: 2.106 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7535490989685059
Epoch: 25, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.531 Vali Acc: 0.470 Test Loss: 1.531 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7096624374389648
Epoch: 26, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.886 Vali Acc: 0.550 Test Loss: 1.886 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.046074867248535
Epoch: 27, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.323 Vali Acc: 0.600 Test Loss: 1.323 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.022392749786377
Epoch: 28, Steps: 18 | Train Loss: 0.236 Vali Loss: 2.500 Vali Acc: 0.530 Test Loss: 2.500 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 54134018
model size : 221.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9275805950164795
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.5864078998565674
Epoch: 2, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.687 Vali Acc: 0.540 Test Loss: 0.687 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5142035484313965
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.681 Vali Acc: 0.520 Test Loss: 0.681 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5308544635772705
Epoch: 4, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.962 Vali Acc: 0.530 Test Loss: 0.962 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6450002193450928
Epoch: 5, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.788 Vali Acc: 0.530 Test Loss: 0.788 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4509797096252441
Epoch: 6, Steps: 18 | Train Loss: 0.528 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7028565406799316
Epoch: 7, Steps: 18 | Train Loss: 0.497 Vali Loss: 1.018 Vali Acc: 0.530 Test Loss: 1.018 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6082417964935303
Epoch: 8, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.848 Vali Acc: 0.510 Test Loss: 0.848 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5740327835083008
Epoch: 9, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.830 Vali Acc: 0.560 Test Loss: 0.830 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.634995460510254
Epoch: 10, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.377 Vali Acc: 0.580 Test Loss: 1.377 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579986).  Saving model ...
Epoch: 11 cost time: 1.5373945236206055
Epoch: 11, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.183 Vali Acc: 0.490 Test Loss: 1.183 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4172711372375488
Epoch: 12, Steps: 18 | Train Loss: 0.310 Vali Loss: 0.900 Vali Acc: 0.560 Test Loss: 0.900 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5498771667480469
Epoch: 13, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.078 Vali Acc: 0.490 Test Loss: 1.078 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6938819885253906
Epoch: 14, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.055 Vali Acc: 0.610 Test Loss: 1.055 Test Acc: 0.610
Validation loss decreased (-0.579986 --> -0.609989).  Saving model ...
Epoch: 15 cost time: 1.7401018142700195
Epoch: 15, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.978 Vali Acc: 0.530 Test Loss: 0.978 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4760489463806152
Epoch: 16, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.314 Vali Acc: 0.590 Test Loss: 1.314 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6179430484771729
Epoch: 17, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.036 Vali Acc: 0.530 Test Loss: 2.036 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5260465145111084
Epoch: 18, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.672 Vali Acc: 0.440 Test Loss: 1.672 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.562638521194458
Epoch: 19, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.425 Vali Acc: 0.510 Test Loss: 1.425 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5687260627746582
Epoch: 20, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.524 Vali Acc: 0.540 Test Loss: 1.524 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6380839347839355
Epoch: 21, Steps: 18 | Train Loss: 0.196 Vali Loss: 2.127 Vali Acc: 0.470 Test Loss: 2.127 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.862626075744629
Epoch: 22, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.657 Vali Acc: 0.580 Test Loss: 1.657 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7086694240570068
Epoch: 23, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.767 Vali Acc: 0.520 Test Loss: 1.767 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7228202819824219
Epoch: 24, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.687 Vali Acc: 0.510 Test Loss: 1.687 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 54060290
model size : 220.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.336463212966919
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 0.858 Vali Acc: 0.430 Test Loss: 0.858 Test Acc: 0.430
Validation loss decreased (inf --> -0.429991).  Saving model ...
Epoch: 2 cost time: 2.8713204860687256
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
Validation loss decreased (-0.429991 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 2.061918258666992
Epoch: 3, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.697 Vali Acc: 0.610 Test Loss: 0.697 Test Acc: 0.610
Validation loss decreased (-0.459993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 3.0697479248046875
Epoch: 4, Steps: 18 | Train Loss: 0.700 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.490952253341675
Epoch: 5, Steps: 18 | Train Loss: 0.595 Vali Loss: 1.203 Vali Acc: 0.530 Test Loss: 1.203 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.782925605773926
Epoch: 6, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.802 Vali Acc: 0.610 Test Loss: 0.802 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.189394474029541
Epoch: 7, Steps: 18 | Train Loss: 0.579 Vali Loss: 1.054 Vali Acc: 0.440 Test Loss: 1.054 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9270291328430176
Epoch: 8, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.974 Vali Acc: 0.490 Test Loss: 0.974 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1448678970336914
Epoch: 9, Steps: 18 | Train Loss: 0.548 Vali Loss: 1.388 Vali Acc: 0.440 Test Loss: 1.388 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9257922172546387
Epoch: 10, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5278899669647217
Epoch: 11, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.219 Vali Acc: 0.460 Test Loss: 1.219 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.2367894649505615
Epoch: 12, Steps: 18 | Train Loss: 0.510 Vali Loss: 1.445 Vali Acc: 0.570 Test Loss: 1.445 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0042247772216797
Epoch: 13, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.267 Vali Acc: 0.450 Test Loss: 1.267 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 54997250
model size : 224.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3003809452056885
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.166536808013916
Epoch: 2, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.7576265335083008
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.771 Vali Acc: 0.560 Test Loss: 0.771 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 2.153028964996338
Epoch: 4, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.867 Vali Acc: 0.520 Test Loss: 0.867 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9796550273895264
Epoch: 5, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.877 Vali Acc: 0.540 Test Loss: 0.877 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3347201347351074
Epoch: 6, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.412 Vali Acc: 0.500 Test Loss: 1.412 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.875842809677124
Epoch: 7, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2175819873809814
Epoch: 8, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.008 Vali Acc: 0.570 Test Loss: 1.008 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569990).  Saving model ...
Epoch: 9 cost time: 1.9631729125976562
Epoch: 9, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.146397590637207
Epoch: 10, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.132 Vali Acc: 0.530 Test Loss: 1.132 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1354458332061768
Epoch: 11, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.987 Vali Acc: 0.530 Test Loss: 0.987 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0923538208007812
Epoch: 12, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.071324586868286
Epoch: 13, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.666 Vali Acc: 0.450 Test Loss: 1.666 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.132699966430664
Epoch: 14, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.910 Vali Acc: 0.490 Test Loss: 1.910 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1242034435272217
Epoch: 15, Steps: 18 | Train Loss: 0.294 Vali Loss: 2.257 Vali Acc: 0.460 Test Loss: 2.257 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1196343898773193
Epoch: 16, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.554 Vali Acc: 0.500 Test Loss: 1.554 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.183800458908081
Epoch: 17, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.471 Vali Acc: 0.480 Test Loss: 1.471 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.029364585876465
Epoch: 18, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.940 Vali Acc: 0.510 Test Loss: 1.940 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 54862082
model size : 223.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.734499454498291
Epoch: 1, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.6389639377593994
Epoch: 2, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 1.3340752124786377
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.868 Vali Acc: 0.490 Test Loss: 0.868 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6159498691558838
Epoch: 4, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 1.7377352714538574
Epoch: 5, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6512846946716309
Epoch: 6, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.955 Vali Acc: 0.510 Test Loss: 0.955 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3477859497070312
Epoch: 7, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.194 Vali Acc: 0.510 Test Loss: 1.194 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7169232368469238
Epoch: 8, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5602896213531494
Epoch: 9, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.151 Vali Acc: 0.530 Test Loss: 1.151 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7010343074798584
Epoch: 10, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.620 Vali Acc: 0.480 Test Loss: 1.620 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6901307106018066
Epoch: 11, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.172 Vali Acc: 0.580 Test Loss: 1.172 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 1.6787335872650146
Epoch: 12, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.044 Vali Acc: 0.520 Test Loss: 1.044 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6514110565185547
Epoch: 13, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.894 Vali Acc: 0.610 Test Loss: 0.894 Test Acc: 0.610
Validation loss decreased (-0.579988 --> -0.609991).  Saving model ...
Epoch: 14 cost time: 1.7653980255126953
Epoch: 14, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.424 Vali Acc: 0.520 Test Loss: 1.424 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.837965488433838
Epoch: 15, Steps: 18 | Train Loss: 0.310 Vali Loss: 1.415 Vali Acc: 0.520 Test Loss: 1.415 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8115272521972656
Epoch: 16, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.595 Vali Acc: 0.570 Test Loss: 1.595 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.761023759841919
Epoch: 17, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.649 Vali Acc: 0.520 Test Loss: 1.649 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6583034992218018
Epoch: 18, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.551 Vali Acc: 0.490 Test Loss: 1.551 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7928001880645752
Epoch: 19, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.531 Vali Acc: 0.520 Test Loss: 1.531 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5479531288146973
Epoch: 20, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.898 Vali Acc: 0.480 Test Loss: 1.898 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7793121337890625
Epoch: 21, Steps: 18 | Train Loss: 0.127 Vali Loss: 2.158 Vali Acc: 0.530 Test Loss: 2.158 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7177965641021729
Epoch: 22, Steps: 18 | Train Loss: 0.129 Vali Loss: 2.010 Vali Acc: 0.550 Test Loss: 2.010 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8253793716430664
Epoch: 23, Steps: 18 | Train Loss: 0.143 Vali Loss: 2.200 Vali Acc: 0.500 Test Loss: 2.200 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 54794498
model size : 223.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps131_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.10747504234314
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.4596407413482666
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.768 Vali Acc: 0.620 Test Loss: 0.768 Test Acc: 0.620
Validation loss decreased (-0.539993 --> -0.619992).  Saving model ...
Epoch: 3 cost time: 2.6374502182006836
Epoch: 3, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.776 Vali Acc: 0.600 Test Loss: 0.776 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.440016269683838
Epoch: 4, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.834 Vali Acc: 0.490 Test Loss: 0.834 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5372092723846436
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 1.024 Vali Acc: 0.490 Test Loss: 1.024 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5907974243164062
Epoch: 6, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.828 Vali Acc: 0.580 Test Loss: 0.828 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7326066493988037
Epoch: 7, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.935 Vali Acc: 0.640 Test Loss: 0.935 Test Acc: 0.640
Validation loss decreased (-0.619992 --> -0.639991).  Saving model ...
Epoch: 8 cost time: 2.558849811553955
Epoch: 8, Steps: 18 | Train Loss: 0.601 Vali Loss: 1.665 Vali Acc: 0.590 Test Loss: 1.665 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.293795108795166
Epoch: 9, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6432974338531494
Epoch: 10, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.196 Vali Acc: 0.540 Test Loss: 1.196 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5740530490875244
Epoch: 11, Steps: 18 | Train Loss: 0.480 Vali Loss: 1.048 Vali Acc: 0.530 Test Loss: 1.048 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4692447185516357
Epoch: 12, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.275 Vali Acc: 0.480 Test Loss: 1.275 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7005527019500732
Epoch: 13, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.255 Vali Acc: 0.580 Test Loss: 1.255 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.657960891723633
Epoch: 14, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.364 Vali Acc: 0.470 Test Loss: 1.364 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4819090366363525
Epoch: 15, Steps: 18 | Train Loss: 0.615 Vali Loss: 1.148 Vali Acc: 0.590 Test Loss: 1.148 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6380598545074463
Epoch: 16, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.194 Vali Acc: 0.560 Test Loss: 1.194 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6450002193450928
Epoch: 17, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.933 Vali Acc: 0.540 Test Loss: 1.933 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps131_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 55872770
model size : 227.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps131_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3396077156066895
Epoch: 1, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.690 Vali Acc: 0.610 Test Loss: 0.690 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.5783333778381348
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.763 Vali Acc: 0.470 Test Loss: 0.763 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6740145683288574
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.687 Vali Acc: 0.500 Test Loss: 0.687 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5764048099517822
Epoch: 4, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5238041877746582
Epoch: 5, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6897633075714111
Epoch: 6, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.956 Vali Acc: 0.500 Test Loss: 0.956 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5600898265838623
Epoch: 7, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9771769046783447
Epoch: 8, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.887 Vali Acc: 0.550 Test Loss: 0.887 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7731688022613525
Epoch: 9, Steps: 18 | Train Loss: 0.424 Vali Loss: 1.142 Vali Acc: 0.480 Test Loss: 1.142 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5565764904022217
Epoch: 10, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7592217922210693
Epoch: 11, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.918 Vali Acc: 0.590 Test Loss: 0.918 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps131_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 55740674
model size : 227.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps131_str131_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.026050567626953
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.686 Vali Acc: 0.600 Test Loss: 0.686 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 1.4728868007659912
Epoch: 2, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.762 Vali Acc: 0.400 Test Loss: 0.762 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4102051258087158
Epoch: 3, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.668 Vali Acc: 0.570 Test Loss: 0.668 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5214509963989258
Epoch: 4, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6974098682403564
Epoch: 5, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.665 Vali Acc: 0.610 Test Loss: 0.665 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 1.7837371826171875
Epoch: 6, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6157410144805908
Epoch: 7, Steps: 18 | Train Loss: 0.510 Vali Loss: 1.020 Vali Acc: 0.470 Test Loss: 1.020 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.499382734298706
Epoch: 8, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5920379161834717
Epoch: 9, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.170 Vali Acc: 0.570 Test Loss: 1.170 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7253057956695557
Epoch: 10, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.789 Vali Acc: 0.590 Test Loss: 0.789 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8031964302062988
Epoch: 11, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.938 Vali Acc: 0.540 Test Loss: 0.938 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.714965581893921
Epoch: 12, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.034 Vali Acc: 0.490 Test Loss: 1.034 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6135382652282715
Epoch: 13, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.094 Vali Acc: 0.540 Test Loss: 1.094 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5170388221740723
Epoch: 14, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.593493938446045
Epoch: 15, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.324 Vali Acc: 0.550 Test Loss: 1.324 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps131_str131_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 55673090
model size : 227.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps137_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.547015428543091
Epoch: 1, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.801 Vali Acc: 0.440 Test Loss: 0.801 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.4875640869140625
Epoch: 2, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
Validation loss decreased (-0.439992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.4592480659484863
Epoch: 3, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.655 Vali Acc: 0.580 Test Loss: 0.655 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 2.4102540016174316
Epoch: 4, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.861 Vali Acc: 0.560 Test Loss: 0.861 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4647583961486816
Epoch: 5, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.800 Vali Acc: 0.540 Test Loss: 0.800 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2582526206970215
Epoch: 6, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.963 Vali Acc: 0.480 Test Loss: 0.963 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.136043071746826
Epoch: 7, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.885 Vali Acc: 0.570 Test Loss: 0.885 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.214560031890869
Epoch: 8, Steps: 18 | Train Loss: 0.476 Vali Loss: 1.052 Vali Acc: 0.520 Test Loss: 1.052 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.057663679122925
Epoch: 9, Steps: 18 | Train Loss: 0.462 Vali Loss: 1.238 Vali Acc: 0.490 Test Loss: 1.238 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9238975048065186
Epoch: 10, Steps: 18 | Train Loss: 0.393 Vali Loss: 1.403 Vali Acc: 0.470 Test Loss: 1.403 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8138694763183594
Epoch: 11, Steps: 18 | Train Loss: 0.581 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.067172050476074
Epoch: 12, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.952 Vali Acc: 0.450 Test Loss: 0.952 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.672427177429199
Epoch: 13, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.222 Vali Acc: 0.550 Test Loss: 1.222 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps137_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 56742146
model size : 231.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps137_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7448999881744385
Epoch: 1, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.688 Vali Acc: 0.540 Test Loss: 0.688 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.307142972946167
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.992905855178833
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.805 Vali Acc: 0.540 Test Loss: 0.805 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.274040460586548
Epoch: 4, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.064789295196533
Epoch: 5, Steps: 18 | Train Loss: 0.700 Vali Loss: 0.692 Vali Acc: 0.600 Test Loss: 0.692 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 2.0556421279907227
Epoch: 6, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3526575565338135
Epoch: 7, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3137190341949463
Epoch: 8, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.904 Vali Acc: 0.480 Test Loss: 0.904 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6277847290039062
Epoch: 9, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.337 Vali Acc: 0.540 Test Loss: 1.337 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3439648151397705
Epoch: 10, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.000 Vali Acc: 0.500 Test Loss: 1.000 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.946664810180664
Epoch: 11, Steps: 18 | Train Loss: 0.636 Vali Loss: 1.020 Vali Acc: 0.510 Test Loss: 1.020 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.277570962905884
Epoch: 12, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.915 Vali Acc: 0.520 Test Loss: 0.915 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0708773136138916
Epoch: 13, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.071 Vali Acc: 0.580 Test Loss: 1.071 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.096775531768799
Epoch: 14, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.572 Vali Acc: 0.560 Test Loss: 1.572 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2217864990234375
Epoch: 15, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps137_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 56619266
model size : 230.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps137_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.454275608062744
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8294003009796143
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.694 Vali Acc: 0.610 Test Loss: 0.694 Test Acc: 0.610
Validation loss decreased (-0.499993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 1.4189019203186035
Epoch: 3, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.875256061553955
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8024511337280273
Epoch: 5, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.729 Vali Acc: 0.410 Test Loss: 0.729 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9596621990203857
Epoch: 6, Steps: 18 | Train Loss: 0.540 Vali Loss: 1.025 Vali Acc: 0.510 Test Loss: 1.025 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6719777584075928
Epoch: 7, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.840 Vali Acc: 0.570 Test Loss: 0.840 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7029824256896973
Epoch: 8, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8083255290985107
Epoch: 9, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.878 Vali Acc: 0.580 Test Loss: 0.878 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7535858154296875
Epoch: 10, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.094 Vali Acc: 0.530 Test Loss: 1.094 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7933015823364258
Epoch: 11, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7357878684997559
Epoch: 12, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps137_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 56554754
model size : 230.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps143_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9835093021392822
Epoch: 1, Steps: 18 | Train Loss: 0.834 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.7883999347686768
Epoch: 2, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9643890857696533
Epoch: 3, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.98976993560791
Epoch: 4, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.865 Vali Acc: 0.590 Test Loss: 0.865 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589991).  Saving model ...
Epoch: 5 cost time: 2.918768882751465
Epoch: 5, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.966 Vali Acc: 0.430 Test Loss: 0.966 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8032398223876953
Epoch: 6, Steps: 18 | Train Loss: 0.622 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.937008857727051
Epoch: 7, Steps: 18 | Train Loss: 0.557 Vali Loss: 1.052 Vali Acc: 0.450 Test Loss: 1.052 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7805287837982178
Epoch: 8, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.997 Vali Acc: 0.510 Test Loss: 0.997 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9752049446105957
Epoch: 9, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8951337337493896
Epoch: 10, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.951 Vali Acc: 0.560 Test Loss: 0.951 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.038081169128418
Epoch: 11, Steps: 18 | Train Loss: 0.682 Vali Loss: 1.487 Vali Acc: 0.580 Test Loss: 1.487 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.837920904159546
Epoch: 12, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.958 Vali Acc: 0.570 Test Loss: 0.958 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9074161052703857
Epoch: 13, Steps: 18 | Train Loss: 0.524 Vali Loss: 1.210 Vali Acc: 0.540 Test Loss: 1.210 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.662601947784424
Epoch: 14, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.673 Vali Acc: 0.450 Test Loss: 1.673 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps143_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 57620738
model size : 234.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps143_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.542062759399414
Epoch: 1, Steps: 18 | Train Loss: 0.833 Vali Loss: 0.819 Vali Acc: 0.400 Test Loss: 0.819 Test Acc: 0.400
Validation loss decreased (inf --> -0.399992).  Saving model ...
Epoch: 2 cost time: 2.1098194122314453
Epoch: 2, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (-0.399992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.3216915130615234
Epoch: 3, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3751792907714844
Epoch: 4, Steps: 18 | Train Loss: 0.644 Vali Loss: 1.035 Vali Acc: 0.460 Test Loss: 1.035 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.916121482849121
Epoch: 5, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 2.3043267726898193
Epoch: 6, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8774609565734863
Epoch: 7, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3435311317443848
Epoch: 8, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.828 Vali Acc: 0.570 Test Loss: 0.828 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 2.032731056213379
Epoch: 9, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.146 Vali Acc: 0.490 Test Loss: 1.146 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.936030387878418
Epoch: 10, Steps: 18 | Train Loss: 0.388 Vali Loss: 1.013 Vali Acc: 0.570 Test Loss: 1.013 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0489206314086914
Epoch: 11, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.988 Vali Acc: 0.590 Test Loss: 0.988 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589990).  Saving model ...
Epoch: 12 cost time: 2.215308904647827
Epoch: 12, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.325 Vali Acc: 0.550 Test Loss: 1.325 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3327226638793945
Epoch: 13, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.341 Vali Acc: 0.490 Test Loss: 1.341 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.964660882949829
Epoch: 14, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.248 Vali Acc: 0.510 Test Loss: 1.248 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.14852237701416
Epoch: 15, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.608 Vali Acc: 0.520 Test Loss: 1.608 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5340468883514404
Epoch: 16, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.844 Vali Acc: 0.520 Test Loss: 1.844 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6000895500183105
Epoch: 17, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.467 Vali Acc: 0.540 Test Loss: 1.467 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5593035221099854
Epoch: 18, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.759 Vali Acc: 0.520 Test Loss: 1.759 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.489837646484375
Epoch: 19, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.789 Vali Acc: 0.590 Test Loss: 1.789 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5560214519500732
Epoch: 20, Steps: 18 | Train Loss: 0.314 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6082208156585693
Epoch: 21, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.935 Vali Acc: 0.490 Test Loss: 1.935 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps143_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 57497858
model size : 234.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps143_str143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.170443058013916
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.4927260875701904
Epoch: 2, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.758 Vali Acc: 0.460 Test Loss: 0.758 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4307477474212646
Epoch: 3, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.6291618347167969
Epoch: 4, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6195249557495117
Epoch: 5, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.6789608001708984
Epoch: 6, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.761 Vali Acc: 0.590 Test Loss: 0.761 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.5451087951660156
Epoch: 7, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.840 Vali Acc: 0.550 Test Loss: 0.840 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8118562698364258
Epoch: 8, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.137 Vali Acc: 0.540 Test Loss: 1.137 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7190439701080322
Epoch: 9, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.904 Vali Acc: 0.520 Test Loss: 0.904 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.712392807006836
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.942 Vali Acc: 0.600 Test Loss: 0.942 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599991).  Saving model ...
Epoch: 11 cost time: 1.588918924331665
Epoch: 11, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.087 Vali Acc: 0.560 Test Loss: 1.087 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6172988414764404
Epoch: 12, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.084 Vali Acc: 0.530 Test Loss: 1.084 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6035771369934082
Epoch: 13, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.975 Vali Acc: 0.490 Test Loss: 0.975 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6436457633972168
Epoch: 14, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6080822944641113
Epoch: 15, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5160832405090332
Epoch: 16, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.580 Vali Acc: 0.450 Test Loss: 1.580 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6972413063049316
Epoch: 17, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.670 Vali Acc: 0.590 Test Loss: 1.670 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5671794414520264
Epoch: 18, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.532 Vali Acc: 0.590 Test Loss: 1.532 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6250660419464111
Epoch: 19, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.595 Vali Acc: 0.530 Test Loss: 1.595 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7001330852508545
Epoch: 20, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.860 Vali Acc: 0.500 Test Loss: 1.860 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps143_str143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 57436418
model size : 233.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7828333377838135
Epoch: 1, Steps: 18 | Train Loss: 0.809 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.378781795501709
Epoch: 2, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.911 Vali Acc: 0.470 Test Loss: 0.911 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3536436557769775
Epoch: 3, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 2.5184922218322754
Epoch: 4, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.4264678955078125
Epoch: 5, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.770 Vali Acc: 0.600 Test Loss: 0.770 Test Acc: 0.600
Validation loss decreased (-0.529992 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.5366904735565186
Epoch: 6, Steps: 18 | Train Loss: 0.601 Vali Loss: 1.169 Vali Acc: 0.580 Test Loss: 1.169 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0081005096435547
Epoch: 7, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4994254112243652
Epoch: 8, Steps: 18 | Train Loss: 0.483 Vali Loss: 1.028 Vali Acc: 0.480 Test Loss: 1.028 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4308974742889404
Epoch: 9, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.020 Vali Acc: 0.540 Test Loss: 1.020 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.351059913635254
Epoch: 10, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4756834506988525
Epoch: 11, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.304 Vali Acc: 0.480 Test Loss: 1.304 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3241052627563477
Epoch: 12, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.558 Vali Acc: 0.450 Test Loss: 1.558 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.509497880935669
Epoch: 13, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.331 Vali Acc: 0.550 Test Loss: 1.331 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5226359367370605
Epoch: 14, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.450 Vali Acc: 0.570 Test Loss: 1.450 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.66728138923645
Epoch: 15, Steps: 18 | Train Loss: 0.457 Vali Loss: 1.283 Vali Acc: 0.480 Test Loss: 1.283 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 58640642
model size : 238.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1140005588531494
Epoch: 1, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.703 Vali Acc: 0.590 Test Loss: 0.703 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.9410550594329834
Epoch: 2, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0398263931274414
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8851861953735352
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.698 Vali Acc: 0.590 Test Loss: 0.698 Test Acc: 0.590
Validation loss decreased (-0.589993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 1.9091334342956543
Epoch: 5, Steps: 18 | Train Loss: 0.552 Vali Loss: 1.049 Vali Acc: 0.510 Test Loss: 1.049 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9396166801452637
Epoch: 6, Steps: 18 | Train Loss: 0.455 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9928677082061768
Epoch: 7, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.994 Vali Acc: 0.460 Test Loss: 0.994 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9520747661590576
Epoch: 8, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.989 Vali Acc: 0.480 Test Loss: 0.989 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.010560989379883
Epoch: 9, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.026 Vali Acc: 0.540 Test Loss: 1.026 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.00868821144104
Epoch: 10, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.015 Vali Acc: 0.560 Test Loss: 1.015 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9401781558990479
Epoch: 11, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.293 Vali Acc: 0.470 Test Loss: 1.293 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.044667959213257
Epoch: 12, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.864 Vali Acc: 0.570 Test Loss: 0.864 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.041168451309204
Epoch: 13, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.161 Vali Acc: 0.490 Test Loss: 1.161 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.95271897315979
Epoch: 14, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.558 Vali Acc: 0.480 Test Loss: 1.558 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 58526978
model size : 237.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0346839427948
Epoch: 1, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.605536937713623
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 1.020 Vali Acc: 0.480 Test Loss: 1.020 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5885918140411377
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.652271032333374
Epoch: 4, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6226310729980469
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7645652294158936
Epoch: 6, Steps: 18 | Train Loss: 0.476 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.721670389175415
Epoch: 7, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.040 Vali Acc: 0.460 Test Loss: 1.040 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.751871109008789
Epoch: 8, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.883 Vali Acc: 0.500 Test Loss: 0.883 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4686837196350098
Epoch: 9, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.208 Vali Acc: 0.560 Test Loss: 1.208 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 1.6789424419403076
Epoch: 10, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6796765327453613
Epoch: 11, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.610 Vali Acc: 0.510 Test Loss: 1.610 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6407673358917236
Epoch: 12, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.133 Vali Acc: 0.460 Test Loss: 1.133 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6638753414154053
Epoch: 13, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.455 Vali Acc: 0.480 Test Loss: 1.455 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4562461376190186
Epoch: 14, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.563 Vali Acc: 0.430 Test Loss: 1.563 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5334300994873047
Epoch: 15, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.619 Vali Acc: 0.460 Test Loss: 1.619 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3639752864837646
Epoch: 16, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.414 Vali Acc: 0.520 Test Loss: 1.414 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.397918462753296
Epoch: 17, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.871 Vali Acc: 0.530 Test Loss: 1.871 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5032095909118652
Epoch: 18, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.978 Vali Acc: 0.430 Test Loss: 1.978 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.336987018585205
Epoch: 19, Steps: 18 | Train Loss: 0.243 Vali Loss: 2.805 Vali Acc: 0.430 Test Loss: 2.805 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 58468610
model size : 237.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps158_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.721811056137085
Epoch: 1, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.9969334602355957
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.419116258621216
Epoch: 3, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0464603900909424
Epoch: 4, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4274439811706543
Epoch: 5, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5914788246154785
Epoch: 6, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.897 Vali Acc: 0.560 Test Loss: 0.897 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 2.561875820159912
Epoch: 7, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.181 Vali Acc: 0.540 Test Loss: 1.181 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6434056758880615
Epoch: 8, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.980 Vali Acc: 0.590 Test Loss: 0.980 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589990).  Saving model ...
Epoch: 9 cost time: 2.7536091804504395
Epoch: 9, Steps: 18 | Train Loss: 0.605 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.207244873046875
Epoch: 10, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.966 Vali Acc: 0.570 Test Loss: 0.966 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.418821334838867
Epoch: 11, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.962 Vali Acc: 0.520 Test Loss: 0.962 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.514853000640869
Epoch: 12, Steps: 18 | Train Loss: 0.354 Vali Loss: 2.096 Vali Acc: 0.500 Test Loss: 2.096 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5655887126922607
Epoch: 13, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.737 Vali Acc: 0.500 Test Loss: 1.737 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6104447841644287
Epoch: 14, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.769134044647217
Epoch: 15, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.433 Vali Acc: 0.540 Test Loss: 1.433 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.503272533416748
Epoch: 16, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.618 Vali Acc: 0.540 Test Loss: 1.618 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.466553211212158
Epoch: 17, Steps: 18 | Train Loss: 0.599 Vali Loss: 2.278 Vali Acc: 0.510 Test Loss: 2.278 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.65057110786438
Epoch: 18, Steps: 18 | Train Loss: 0.292 Vali Loss: 2.113 Vali Acc: 0.510 Test Loss: 2.113 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps158_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 59808002
model size : 242.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps158_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2020370960235596
Epoch: 1, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.670 Vali Acc: 0.620 Test Loss: 0.670 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 1.6520483493804932
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1339755058288574
Epoch: 3, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.927 Vali Acc: 0.490 Test Loss: 0.927 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1503353118896484
Epoch: 4, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.856917381286621
Epoch: 5, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.25546932220459
Epoch: 6, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.927 Vali Acc: 0.450 Test Loss: 0.927 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6881487369537354
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.909 Vali Acc: 0.480 Test Loss: 0.909 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2018721103668213
Epoch: 8, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.249443531036377
Epoch: 9, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9560010433197021
Epoch: 10, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.115 Vali Acc: 0.520 Test Loss: 1.115 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2329046726226807
Epoch: 11, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.932 Vali Acc: 0.580 Test Loss: 0.932 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps158_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 59697410
model size : 242.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps158_str158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1200764179229736
Epoch: 1, Steps: 18 | Train Loss: 0.812 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 2.09293532371521
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.681 Vali Acc: 0.570 Test Loss: 0.681 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.938976764678955
Epoch: 3, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8252527713775635
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.758 Vali Acc: 0.580 Test Loss: 0.758 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.9084603786468506
Epoch: 5, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6740520000457764
Epoch: 6, Steps: 18 | Train Loss: 0.599 Vali Loss: 1.112 Vali Acc: 0.530 Test Loss: 1.112 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.845583438873291
Epoch: 7, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.838 Vali Acc: 0.580 Test Loss: 0.838 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.713745355606079
Epoch: 8, Steps: 18 | Train Loss: 0.555 Vali Loss: 1.119 Vali Acc: 0.590 Test Loss: 1.119 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589989).  Saving model ...
Epoch: 9 cost time: 2.0595147609710693
Epoch: 9, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.773 Vali Acc: 0.610 Test Loss: 0.773 Test Acc: 0.610
Validation loss decreased (-0.589989 --> -0.609992).  Saving model ...
Epoch: 10 cost time: 1.7636988162994385
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.924 Vali Acc: 0.560 Test Loss: 0.924 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.767512321472168
Epoch: 11, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.981 Vali Acc: 0.540 Test Loss: 0.981 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7383747100830078
Epoch: 12, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.341 Vali Acc: 0.550 Test Loss: 1.341 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.777247428894043
Epoch: 13, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.179 Vali Acc: 0.510 Test Loss: 1.179 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9486913681030273
Epoch: 14, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.352 Vali Acc: 0.530 Test Loss: 1.352 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9311621189117432
Epoch: 15, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.423 Vali Acc: 0.550 Test Loss: 1.423 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9503021240234375
Epoch: 16, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.875 Vali Acc: 0.550 Test Loss: 1.875 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.936957597732544
Epoch: 17, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.417 Vali Acc: 0.530 Test Loss: 1.417 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4645731449127197
Epoch: 18, Steps: 18 | Train Loss: 0.141 Vali Loss: 2.048 Vali Acc: 0.520 Test Loss: 2.048 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.013949394226074
Epoch: 19, Steps: 18 | Train Loss: 0.171 Vali Loss: 2.173 Vali Acc: 0.530 Test Loss: 2.173 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps158_str158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 59642114
model size : 242.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.13311767578125
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.824 Vali Acc: 0.480 Test Loss: 0.824 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.5928611755371094
Epoch: 2, Steps: 18 | Train Loss: 0.775 Vali Loss: 0.966 Vali Acc: 0.520 Test Loss: 0.966 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 2.5005133152008057
Epoch: 3, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.837 Vali Acc: 0.470 Test Loss: 0.837 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.661036968231201
Epoch: 4, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.730 Vali Acc: 0.560 Test Loss: 0.730 Test Acc: 0.560
Validation loss decreased (-0.519990 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.641218662261963
Epoch: 5, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4002466201782227
Epoch: 6, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7036311626434326
Epoch: 7, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.938 Vali Acc: 0.590 Test Loss: 0.938 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589991).  Saving model ...
Epoch: 8 cost time: 2.0138332843780518
Epoch: 8, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.677 Vali Acc: 0.610 Test Loss: 0.677 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609993).  Saving model ...
Epoch: 9 cost time: 1.8797757625579834
Epoch: 9, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.788 Vali Acc: 0.630 Test Loss: 0.788 Test Acc: 0.630
Validation loss decreased (-0.609993 --> -0.629992).  Saving model ...
Epoch: 10 cost time: 2.340353012084961
Epoch: 10, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9087119102478027
Epoch: 11, Steps: 18 | Train Loss: 0.520 Vali Loss: 1.214 Vali Acc: 0.560 Test Loss: 1.214 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.313408851623535
Epoch: 12, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.972 Vali Acc: 0.650 Test Loss: 0.972 Test Acc: 0.650
Validation loss decreased (-0.629992 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 2.418684959411621
Epoch: 13, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.975 Vali Acc: 0.610 Test Loss: 0.975 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6148383617401123
Epoch: 14, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.546 Vali Acc: 0.570 Test Loss: 1.546 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.317730665206909
Epoch: 15, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.199 Vali Acc: 0.570 Test Loss: 1.199 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4779653549194336
Epoch: 16, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.853 Vali Acc: 0.520 Test Loss: 1.853 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.466764211654663
Epoch: 17, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.251 Vali Acc: 0.610 Test Loss: 1.251 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.114318370819092
Epoch: 18, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.441 Vali Acc: 0.570 Test Loss: 1.441 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.485912322998047
Epoch: 19, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.661 Vali Acc: 0.520 Test Loss: 1.661 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.214709997177124
Epoch: 20, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.601 Vali Acc: 0.550 Test Loss: 1.601 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5071518421173096
Epoch: 21, Steps: 18 | Train Loss: 0.189 Vali Loss: 2.062 Vali Acc: 0.660 Test Loss: 2.062 Test Acc: 0.660
Validation loss decreased (-0.649990 --> -0.659979).  Saving model ...
Epoch: 22 cost time: 2.319544792175293
Epoch: 22, Steps: 18 | Train Loss: 0.340 Vali Loss: 3.085 Vali Acc: 0.530 Test Loss: 3.085 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3371901512145996
Epoch: 23, Steps: 18 | Train Loss: 0.564 Vali Loss: 1.571 Vali Acc: 0.530 Test Loss: 1.571 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6986026763916016
Epoch: 24, Steps: 18 | Train Loss: 0.291 Vali Loss: 2.116 Vali Acc: 0.570 Test Loss: 2.116 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.387765884399414
Epoch: 25, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.971 Vali Acc: 0.560 Test Loss: 1.971 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5710415840148926
Epoch: 26, Steps: 18 | Train Loss: 0.199 Vali Loss: 2.464 Vali Acc: 0.530 Test Loss: 2.464 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.925053834915161
Epoch: 27, Steps: 18 | Train Loss: 0.127 Vali Loss: 2.305 Vali Acc: 0.510 Test Loss: 2.305 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.4930906295776367
Epoch: 28, Steps: 18 | Train Loss: 0.089 Vali Loss: 2.542 Vali Acc: 0.630 Test Loss: 2.542 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.656106948852539
Epoch: 29, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.711 Vali Acc: 0.530 Test Loss: 2.711 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.4101552963256836
Epoch: 30, Steps: 18 | Train Loss: 0.212 Vali Loss: 2.994 Vali Acc: 0.560 Test Loss: 2.994 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.481675386428833
Epoch: 31, Steps: 18 | Train Loss: 0.338 Vali Loss: 2.132 Vali Acc: 0.550 Test Loss: 2.132 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 61122818
model size : 247.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.285768985748291
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.674 Vali Acc: 0.550 Test Loss: 0.674 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.186277389526367
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.665 Vali Acc: 0.560 Test Loss: 0.665 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.0650582313537598
Epoch: 3, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.712 Vali Acc: 0.560 Test Loss: 0.712 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9532749652862549
Epoch: 4, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.711 Vali Acc: 0.590 Test Loss: 0.711 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 1.9919140338897705
Epoch: 5, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.895437479019165
Epoch: 6, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.956 Vali Acc: 0.500 Test Loss: 0.956 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9161126613616943
Epoch: 7, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.842 Vali Acc: 0.600 Test Loss: 0.842 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 2.1150062084198
Epoch: 8, Steps: 18 | Train Loss: 0.528 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9623215198516846
Epoch: 9, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.979 Vali Acc: 0.570 Test Loss: 0.979 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.345379590988159
Epoch: 10, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0742099285125732
Epoch: 11, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.459 Vali Acc: 0.460 Test Loss: 1.459 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9293122291564941
Epoch: 12, Steps: 18 | Train Loss: 0.584 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.820802927017212
Epoch: 13, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.035 Vali Acc: 0.550 Test Loss: 1.035 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.624706745147705
Epoch: 14, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.599992 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.622103214263916
Epoch: 15, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.975 Vali Acc: 0.550 Test Loss: 0.975 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6530544757843018
Epoch: 16, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.227 Vali Acc: 0.600 Test Loss: 1.227 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9861345291137695
Epoch: 17, Steps: 18 | Train Loss: 0.496 Vali Loss: 1.923 Vali Acc: 0.530 Test Loss: 1.923 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.717696189880371
Epoch: 18, Steps: 18 | Train Loss: 0.509 Vali Loss: 1.314 Vali Acc: 0.510 Test Loss: 1.314 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.175002098083496
Epoch: 19, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.685 Vali Acc: 0.550 Test Loss: 1.685 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9270007610321045
Epoch: 20, Steps: 18 | Train Loss: 0.267 Vali Loss: 2.378 Vali Acc: 0.480 Test Loss: 2.378 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.121861696243286
Epoch: 21, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.757 Vali Acc: 0.520 Test Loss: 1.757 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.201680898666382
Epoch: 22, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.452 Vali Acc: 0.590 Test Loss: 1.452 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6643743515014648
Epoch: 23, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.512 Vali Acc: 0.570 Test Loss: 1.512 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1525824069976807
Epoch: 24, Steps: 18 | Train Loss: 0.144 Vali Loss: 2.062 Vali Acc: 0.600 Test Loss: 2.062 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 61018370
model size : 247.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.413655996322632
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.678 Vali Acc: 0.590 Test Loss: 0.678 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.860313892364502
Epoch: 2, Steps: 18 | Train Loss: 0.690 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7139136791229248
Epoch: 3, Steps: 18 | Train Loss: 0.650 Vali Loss: 0.703 Vali Acc: 0.570 Test Loss: 0.703 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7766706943511963
Epoch: 4, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7711422443389893
Epoch: 5, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8038451671600342
Epoch: 6, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.841 Vali Acc: 0.560 Test Loss: 0.841 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8619954586029053
Epoch: 7, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.924 Vali Acc: 0.450 Test Loss: 0.924 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6799850463867188
Epoch: 8, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.903 Vali Acc: 0.510 Test Loss: 0.903 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.425156593322754
Epoch: 9, Steps: 18 | Train Loss: 0.451 Vali Loss: 1.003 Vali Acc: 0.520 Test Loss: 1.003 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.65830397605896
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 0.897 Vali Acc: 0.530 Test Loss: 0.897 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8378064632415771
Epoch: 11, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.029 Vali Acc: 0.550 Test Loss: 1.029 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 60966146
model size : 247.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps177_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7069921493530273
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.209991693496704
Epoch: 2, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.863 Vali Acc: 0.500 Test Loss: 0.863 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.408778667449951
Epoch: 3, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1841683387756348
Epoch: 4, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.891 Vali Acc: 0.580 Test Loss: 0.891 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 2.3506662845611572
Epoch: 5, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9046788215637207
Epoch: 6, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.885 Vali Acc: 0.560 Test Loss: 0.885 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9566619396209717
Epoch: 7, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.763 Vali Acc: 0.600 Test Loss: 0.763 Test Acc: 0.600
Validation loss decreased (-0.579991 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 2.353788137435913
Epoch: 8, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.743 Vali Acc: 0.620 Test Loss: 0.743 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619993).  Saving model ...
Epoch: 9 cost time: 1.9300940036773682
Epoch: 9, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.986 Vali Acc: 0.540 Test Loss: 0.986 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.578223466873169
Epoch: 10, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2756829261779785
Epoch: 11, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.838 Vali Acc: 0.540 Test Loss: 0.838 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6343164443969727
Epoch: 12, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.305 Vali Acc: 0.490 Test Loss: 1.305 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6960861682891846
Epoch: 13, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5286641120910645
Epoch: 14, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.919 Vali Acc: 0.570 Test Loss: 0.919 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2929916381835938
Epoch: 15, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.446 Vali Acc: 0.550 Test Loss: 1.446 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7299554347991943
Epoch: 16, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.570 Vali Acc: 0.580 Test Loss: 1.570 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.847039222717285
Epoch: 17, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.719 Vali Acc: 0.570 Test Loss: 1.719 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4417033195495605
Epoch: 18, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.336 Vali Acc: 0.600 Test Loss: 1.336 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps177_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 62582018
model size : 253.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps177_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4470956325531006
Epoch: 1, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.224426507949829
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.821 Vali Acc: 0.440 Test Loss: 0.821 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2649898529052734
Epoch: 3, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1227786540985107
Epoch: 4, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.781 Vali Acc: 0.450 Test Loss: 0.781 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.329537868499756
Epoch: 5, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.902 Vali Acc: 0.580 Test Loss: 0.902 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 2.1564245223999023
Epoch: 6, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.793 Vali Acc: 0.590 Test Loss: 0.793 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 2.1263434886932373
Epoch: 7, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.981 Vali Acc: 0.490 Test Loss: 0.981 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.058473825454712
Epoch: 8, Steps: 18 | Train Loss: 0.454 Vali Loss: 0.993 Vali Acc: 0.550 Test Loss: 0.993 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6644480228424072
Epoch: 9, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.635 Vali Acc: 0.510 Test Loss: 1.635 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.267153739929199
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0778870582580566
Epoch: 11, Steps: 18 | Train Loss: 0.500 Vali Loss: 1.127 Vali Acc: 0.540 Test Loss: 1.127 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1911323070526123
Epoch: 12, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.436 Vali Acc: 0.570 Test Loss: 1.436 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2782371044158936
Epoch: 13, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.899 Vali Acc: 0.450 Test Loss: 1.899 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3406248092651367
Epoch: 14, Steps: 18 | Train Loss: 0.315 Vali Loss: 2.068 Vali Acc: 0.520 Test Loss: 2.068 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3280420303344727
Epoch: 15, Steps: 18 | Train Loss: 0.414 Vali Loss: 1.554 Vali Acc: 0.520 Test Loss: 1.554 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1215248107910156
Epoch: 16, Steps: 18 | Train Loss: 0.227 Vali Loss: 2.252 Vali Acc: 0.530 Test Loss: 2.252 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps177_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 62486786
model size : 253.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps177_str177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4183619022369385
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.04544734954834
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.9476919174194336
Epoch: 3, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.712 Vali Acc: 0.580 Test Loss: 0.712 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.9049947261810303
Epoch: 4, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9660568237304688
Epoch: 5, Steps: 18 | Train Loss: 0.540 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8632221221923828
Epoch: 6, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.828 Vali Acc: 0.420 Test Loss: 0.828 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1701555252075195
Epoch: 7, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.962 Vali Acc: 0.430 Test Loss: 0.962 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7409377098083496
Epoch: 8, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.947 Vali Acc: 0.500 Test Loss: 0.947 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9686768054962158
Epoch: 9, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.896 Vali Acc: 0.520 Test Loss: 0.896 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7772712707519531
Epoch: 10, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.991 Vali Acc: 0.460 Test Loss: 0.991 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8013179302215576
Epoch: 11, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.062 Vali Acc: 0.480 Test Loss: 1.062 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8361694812774658
Epoch: 12, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.954 Vali Acc: 0.510 Test Loss: 0.954 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.819206953048706
Epoch: 13, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.273 Vali Acc: 0.470 Test Loss: 1.273 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps177_str177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 62437634
model size : 252.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps188_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.155296564102173
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.6682536602020264
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.712 Vali Acc: 0.620 Test Loss: 0.712 Test Acc: 0.620
Validation loss decreased (-0.489992 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 2.671625852584839
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.795 Vali Acc: 0.600 Test Loss: 0.795 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.583972215652466
Epoch: 4, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.832723379135132
Epoch: 5, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.958 Vali Acc: 0.510 Test Loss: 0.958 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5046346187591553
Epoch: 6, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.690048933029175
Epoch: 7, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.838 Vali Acc: 0.660 Test Loss: 0.838 Test Acc: 0.660
Validation loss decreased (-0.619993 --> -0.659992).  Saving model ...
Epoch: 8 cost time: 2.6724276542663574
Epoch: 8, Steps: 18 | Train Loss: 0.452 Vali Loss: 1.022 Vali Acc: 0.500 Test Loss: 1.022 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5009982585906982
Epoch: 9, Steps: 18 | Train Loss: 0.569 Vali Loss: 1.207 Vali Acc: 0.510 Test Loss: 1.207 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5676331520080566
Epoch: 10, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.139 Vali Acc: 0.460 Test Loss: 1.139 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.522690534591675
Epoch: 11, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.013 Vali Acc: 0.490 Test Loss: 1.013 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5313398838043213
Epoch: 12, Steps: 18 | Train Loss: 0.452 Vali Loss: 1.186 Vali Acc: 0.530 Test Loss: 1.186 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5200912952423096
Epoch: 13, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.449 Vali Acc: 0.530 Test Loss: 1.449 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8510704040527344
Epoch: 14, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.344 Vali Acc: 0.490 Test Loss: 1.344 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7000341415405273
Epoch: 15, Steps: 18 | Train Loss: 0.460 Vali Loss: 1.085 Vali Acc: 0.530 Test Loss: 1.085 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.534583568572998
Epoch: 16, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.593 Vali Acc: 0.490 Test Loss: 1.593 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7150943279266357
Epoch: 17, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.246 Vali Acc: 0.490 Test Loss: 1.246 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps188_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 64194818
model size : 259.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.276747941970825
Epoch: 1, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.691 Vali Acc: 0.480 Test Loss: 0.691 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.082775354385376
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.682 Vali Acc: 0.520 Test Loss: 0.682 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.6252357959747314
Epoch: 3, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.686 Vali Acc: 0.550 Test Loss: 0.686 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.6260013580322266
Epoch: 4, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.104598045349121
Epoch: 5, Steps: 18 | Train Loss: 0.455 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.83205246925354
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.881 Vali Acc: 0.520 Test Loss: 0.881 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9246604442596436
Epoch: 7, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.587 Vali Acc: 0.440 Test Loss: 1.587 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9766297340393066
Epoch: 8, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 1.9646010398864746
Epoch: 9, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.759352684020996
Epoch: 10, Steps: 18 | Train Loss: 0.368 Vali Loss: 0.941 Vali Acc: 0.510 Test Loss: 0.941 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.074307441711426
Epoch: 11, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1777021884918213
Epoch: 12, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.845 Vali Acc: 0.600 Test Loss: 0.845 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599992).  Saving model ...
Epoch: 13 cost time: 2.1404762268066406
Epoch: 13, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.146 Vali Acc: 0.520 Test Loss: 1.146 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.028743267059326
Epoch: 14, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.558 Vali Acc: 0.450 Test Loss: 1.558 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.102917432785034
Epoch: 15, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9524941444396973
Epoch: 16, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.406 Vali Acc: 0.530 Test Loss: 1.406 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5831925868988037
Epoch: 17, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.626 Vali Acc: 0.470 Test Loss: 1.626 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.907083511352539
Epoch: 18, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.838 Vali Acc: 0.460 Test Loss: 1.838 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0482099056243896
Epoch: 19, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.879 Vali Acc: 0.500 Test Loss: 1.879 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9033563137054443
Epoch: 20, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.085292100906372
Epoch: 21, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.988 Vali Acc: 0.500 Test Loss: 1.988 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8581264019012451
Epoch: 22, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.887 Vali Acc: 0.510 Test Loss: 1.887 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 64102658
model size : 259.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps188_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4572322368621826
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.78505277633667
Epoch: 2, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.7997853755950928
Epoch: 3, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9700605869293213
Epoch: 4, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.774808406829834
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.788 Vali Acc: 0.590 Test Loss: 0.788 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 1.789336919784546
Epoch: 6, Steps: 18 | Train Loss: 0.488 Vali Loss: 1.003 Vali Acc: 0.440 Test Loss: 1.003 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0413575172424316
Epoch: 7, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7595171928405762
Epoch: 8, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.212 Vali Acc: 0.540 Test Loss: 1.212 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.915440320968628
Epoch: 9, Steps: 18 | Train Loss: 0.368 Vali Loss: 0.972 Vali Acc: 0.490 Test Loss: 0.972 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8097808361053467
Epoch: 10, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.116 Vali Acc: 0.540 Test Loss: 1.116 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5224668979644775
Epoch: 11, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.697469711303711
Epoch: 12, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.281 Vali Acc: 0.520 Test Loss: 1.281 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7235782146453857
Epoch: 13, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.477 Vali Acc: 0.460 Test Loss: 1.477 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6479086875915527
Epoch: 14, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9981050491333008
Epoch: 15, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.394 Vali Acc: 0.500 Test Loss: 1.394 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps188_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 64056578
model size : 259.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8875699043273926
Epoch: 1, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.689 Vali Acc: 0.600 Test Loss: 0.689 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 2.2930588722229004
Epoch: 2, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.559598922729492
Epoch: 3, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7919068336486816
Epoch: 4, Steps: 18 | Train Loss: 0.680 Vali Loss: 1.047 Vali Acc: 0.500 Test Loss: 1.047 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4861929416656494
Epoch: 5, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.750 Vali Acc: 0.610 Test Loss: 0.750 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 2.0185649394989014
Epoch: 6, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.939326524734497
Epoch: 7, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0123050212860107
Epoch: 8, Steps: 18 | Train Loss: 0.476 Vali Loss: 1.134 Vali Acc: 0.630 Test Loss: 1.134 Test Acc: 0.630
Validation loss decreased (-0.609993 --> -0.629989).  Saving model ...
Epoch: 9 cost time: 2.253828525543213
Epoch: 9, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.981 Vali Acc: 0.510 Test Loss: 0.981 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5332868099212646
Epoch: 10, Steps: 18 | Train Loss: 0.625 Vali Loss: 1.039 Vali Acc: 0.590 Test Loss: 1.039 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1068127155303955
Epoch: 11, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.169 Vali Acc: 0.580 Test Loss: 1.169 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.451610565185547
Epoch: 12, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.951 Vali Acc: 0.590 Test Loss: 0.951 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0526304244995117
Epoch: 13, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.336 Vali Acc: 0.570 Test Loss: 1.336 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3711512088775635
Epoch: 14, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.389 Vali Acc: 0.630 Test Loss: 1.389 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.068265438079834
Epoch: 15, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.481 Vali Acc: 0.560 Test Loss: 1.481 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5070319175720215
Epoch: 16, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.390 Vali Acc: 0.560 Test Loss: 1.390 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.516287088394165
Epoch: 17, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.477 Vali Acc: 0.550 Test Loss: 1.477 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0012402534484863
Epoch: 18, Steps: 18 | Train Loss: 0.503 Vali Loss: 1.432 Vali Acc: 0.590 Test Loss: 1.432 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 65955074
model size : 266.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.512800455093384
Epoch: 1, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.705 Vali Acc: 0.450 Test Loss: 0.705 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.9858994483947754
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.051347494125366
Epoch: 3, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.674 Vali Acc: 0.580 Test Loss: 0.674 Test Acc: 0.580
Validation loss decreased (-0.479992 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.944288730621338
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.767 Vali Acc: 0.590 Test Loss: 0.767 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 1.970304250717163
Epoch: 5, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9575259685516357
Epoch: 6, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.929 Vali Acc: 0.480 Test Loss: 0.929 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.147834062576294
Epoch: 7, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.071286201477051
Epoch: 8, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.775714635848999
Epoch: 9, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.657930850982666
Epoch: 10, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.495 Vali Acc: 0.550 Test Loss: 1.495 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7114040851593018
Epoch: 11, Steps: 18 | Train Loss: 0.420 Vali Loss: 1.608 Vali Acc: 0.480 Test Loss: 1.608 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.776064395904541
Epoch: 12, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.925 Vali Acc: 0.520 Test Loss: 0.925 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.232511520385742
Epoch: 13, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.189 Vali Acc: 0.550 Test Loss: 1.189 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.25460147857666
Epoch: 14, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.113 Vali Acc: 0.540 Test Loss: 1.113 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 65869058
model size : 265.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.264326810836792
Epoch: 1, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.839 Vali Acc: 0.400 Test Loss: 0.839 Test Acc: 0.400
Validation loss decreased (inf --> -0.399992).  Saving model ...
Epoch: 2 cost time: 1.6620054244995117
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
Validation loss decreased (-0.399992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.731205701828003
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.812 Vali Acc: 0.420 Test Loss: 0.812 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9151413440704346
Epoch: 4, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 1.9478511810302734
Epoch: 5, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.941 Vali Acc: 0.480 Test Loss: 0.941 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9282958507537842
Epoch: 6, Steps: 18 | Train Loss: 0.481 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 1.8672356605529785
Epoch: 7, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.779 Vali Acc: 0.590 Test Loss: 0.779 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 1.9303691387176514
Epoch: 8, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.878 Vali Acc: 0.470 Test Loss: 0.878 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.979264259338379
Epoch: 9, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.017 Vali Acc: 0.540 Test Loss: 1.017 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9192464351654053
Epoch: 10, Steps: 18 | Train Loss: 0.328 Vali Loss: 0.995 Vali Acc: 0.580 Test Loss: 0.995 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.875434398651123
Epoch: 11, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.919 Vali Acc: 0.560 Test Loss: 0.919 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.958545446395874
Epoch: 12, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.149 Vali Acc: 0.480 Test Loss: 1.149 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9664826393127441
Epoch: 13, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.219 Vali Acc: 0.490 Test Loss: 1.219 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9401991367340088
Epoch: 14, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.126 Vali Acc: 0.600 Test Loss: 1.126 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.8604683876037598
Epoch: 15, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.120 Vali Acc: 0.570 Test Loss: 1.120 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7578368186950684
Epoch: 16, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.796 Vali Acc: 0.520 Test Loss: 1.796 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8385365009307861
Epoch: 17, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.126 Vali Acc: 0.490 Test Loss: 1.126 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7893447875976562
Epoch: 18, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.451 Vali Acc: 0.450 Test Loss: 1.451 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8110105991363525
Epoch: 19, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.334 Vali Acc: 0.490 Test Loss: 1.334 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8342242240905762
Epoch: 20, Steps: 18 | Train Loss: 0.152 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0598137378692627
Epoch: 21, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.257 Vali Acc: 0.540 Test Loss: 1.257 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8923602104187012
Epoch: 22, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.984703540802002
Epoch: 23, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.394 Vali Acc: 0.590 Test Loss: 1.394 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.922473430633545
Epoch: 24, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.082 Vali Acc: 0.500 Test Loss: 2.082 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 65826050
model size : 265.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps215_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.707069158554077
Epoch: 1, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.669 Vali Acc: 0.600 Test Loss: 0.669 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 2.239093780517578
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.529726982116699
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1856465339660645
Epoch: 4, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.680 Vali Acc: 0.510 Test Loss: 0.680 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4403531551361084
Epoch: 5, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.800 Vali Acc: 0.620 Test Loss: 0.800 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619992).  Saving model ...
Epoch: 6 cost time: 2.3637795448303223
Epoch: 6, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.944 Vali Acc: 0.540 Test Loss: 0.944 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5931990146636963
Epoch: 7, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.44230580329895
Epoch: 8, Steps: 18 | Train Loss: 0.475 Vali Loss: 0.918 Vali Acc: 0.560 Test Loss: 0.918 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3807671070098877
Epoch: 9, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.005 Vali Acc: 0.580 Test Loss: 1.005 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9419763088226318
Epoch: 10, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.574 Vali Acc: 0.450 Test Loss: 1.574 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3745598793029785
Epoch: 11, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.509 Vali Acc: 0.540 Test Loss: 1.509 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.578568696975708
Epoch: 12, Steps: 18 | Train Loss: 0.494 Vali Loss: 1.640 Vali Acc: 0.480 Test Loss: 1.640 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.227290630340576
Epoch: 13, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.629 Vali Acc: 0.530 Test Loss: 1.629 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.402817726135254
Epoch: 14, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.866 Vali Acc: 0.520 Test Loss: 1.866 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5758326053619385
Epoch: 15, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.784 Vali Acc: 0.560 Test Loss: 1.784 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps215_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 68151554
model size : 274.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps215_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.567455768585205
Epoch: 1, Steps: 18 | Train Loss: 0.747 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.9517738819122314
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.672 Vali Acc: 0.570 Test Loss: 0.672 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.631744384765625
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.913480520248413
Epoch: 4, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.064393997192383
Epoch: 5, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9852263927459717
Epoch: 6, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.810 Vali Acc: 0.510 Test Loss: 0.810 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.259746789932251
Epoch: 7, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.903 Vali Acc: 0.530 Test Loss: 0.903 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9552645683288574
Epoch: 8, Steps: 18 | Train Loss: 0.480 Vali Loss: 1.005 Vali Acc: 0.470 Test Loss: 1.005 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0311050415039062
Epoch: 9, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.314 Vali Acc: 0.460 Test Loss: 1.314 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9943959712982178
Epoch: 10, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.009 Vali Acc: 0.490 Test Loss: 1.009 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.973651647567749
Epoch: 11, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.077 Vali Acc: 0.510 Test Loss: 1.077 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.204425096511841
Epoch: 12, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.296 Vali Acc: 0.520 Test Loss: 1.296 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps215_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 68071682
model size : 274.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps215_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.360990285873413
Epoch: 1, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.9681804180145264
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.7678942680358887
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.901859998703003
Epoch: 4, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.9020700454711914
Epoch: 5, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.771 Vali Acc: 0.590 Test Loss: 0.771 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 1.8559637069702148
Epoch: 6, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.878 Vali Acc: 0.560 Test Loss: 0.878 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8071482181549072
Epoch: 7, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8570094108581543
Epoch: 8, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.965 Vali Acc: 0.500 Test Loss: 0.965 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8856940269470215
Epoch: 9, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.936 Vali Acc: 0.500 Test Loss: 0.936 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9545326232910156
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.947 Vali Acc: 0.480 Test Loss: 0.947 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8233506679534912
Epoch: 11, Steps: 18 | Train Loss: 0.385 Vali Loss: 1.478 Vali Acc: 0.590 Test Loss: 1.478 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9559211730957031
Epoch: 12, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7268035411834717
Epoch: 13, Steps: 18 | Train Loss: 0.376 Vali Loss: 2.005 Vali Acc: 0.480 Test Loss: 2.005 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9831738471984863
Epoch: 14, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8045754432678223
Epoch: 15, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.499 Vali Acc: 0.480 Test Loss: 1.499 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps215_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 68031746
model size : 274.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.682124376296997
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.910 Vali Acc: 0.470 Test Loss: 0.910 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 2.4533097743988037
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
Validation loss decreased (-0.469991 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.8786306381225586
Epoch: 3, Steps: 18 | Train Loss: 0.657 Vali Loss: 0.692 Vali Acc: 0.510 Test Loss: 0.692 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.9220259189605713
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 1.030 Vali Acc: 0.490 Test Loss: 1.030 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.101076364517212
Epoch: 5, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.724 Vali Acc: 0.580 Test Loss: 0.724 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 2.4298362731933594
Epoch: 6, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.950 Vali Acc: 0.500 Test Loss: 0.950 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2898406982421875
Epoch: 7, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.754 Vali Acc: 0.590 Test Loss: 0.754 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 2.1772751808166504
Epoch: 8, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.720 Vali Acc: 0.650 Test Loss: 0.720 Test Acc: 0.650
Validation loss decreased (-0.589992 --> -0.649993).  Saving model ...
Epoch: 9 cost time: 2.125504732131958
Epoch: 9, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.358 Vali Acc: 0.520 Test Loss: 1.358 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4316885471343994
Epoch: 10, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9860024452209473
Epoch: 11, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.802 Vali Acc: 0.560 Test Loss: 1.802 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3277428150177
Epoch: 12, Steps: 18 | Train Loss: 0.468 Vali Loss: 1.347 Vali Acc: 0.510 Test Loss: 1.347 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9340741634368896
Epoch: 13, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.896 Vali Acc: 0.580 Test Loss: 0.896 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.350684642791748
Epoch: 14, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.275 Vali Acc: 0.600 Test Loss: 1.275 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9861421585083008
Epoch: 15, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.298 Vali Acc: 0.570 Test Loss: 1.298 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3980445861816406
Epoch: 16, Steps: 18 | Train Loss: 0.266 Vali Loss: 1.242 Vali Acc: 0.560 Test Loss: 1.242 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.530463218688965
Epoch: 17, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.986 Vali Acc: 0.560 Test Loss: 1.986 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.028346300125122
Epoch: 18, Steps: 18 | Train Loss: 0.186 Vali Loss: 2.627 Vali Acc: 0.560 Test Loss: 2.627 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 70498562
model size : 283.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.382732391357422
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.671 Vali Acc: 0.600 Test Loss: 0.671 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 2.0375478267669678
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.696 Vali Acc: 0.460 Test Loss: 0.696 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0340664386749268
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.671 Vali Acc: 0.580 Test Loss: 0.671 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8427836894989014
Epoch: 4, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.128877878189087
Epoch: 5, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9339756965637207
Epoch: 6, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.698122501373291
Epoch: 7, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.015 Vali Acc: 0.490 Test Loss: 1.015 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8747437000274658
Epoch: 8, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.995 Vali Acc: 0.550 Test Loss: 0.995 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1013779640197754
Epoch: 9, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.839970588684082
Epoch: 10, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.039 Vali Acc: 0.610 Test Loss: 1.039 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609990).  Saving model ...
Epoch: 11 cost time: 2.002200126647949
Epoch: 11, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.229 Vali Acc: 0.540 Test Loss: 1.229 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.980149745941162
Epoch: 12, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.874 Vali Acc: 0.590 Test Loss: 0.874 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0390336513519287
Epoch: 13, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.281 Vali Acc: 0.490 Test Loss: 1.281 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9041743278503418
Epoch: 14, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.634 Vali Acc: 0.470 Test Loss: 1.634 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2703187465667725
Epoch: 15, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.218 Vali Acc: 0.480 Test Loss: 1.218 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9411048889160156
Epoch: 16, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.823 Vali Acc: 0.600 Test Loss: 1.823 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9716882705688477
Epoch: 17, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.898 Vali Acc: 0.480 Test Loss: 1.898 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.050212860107422
Epoch: 18, Steps: 18 | Train Loss: 0.311 Vali Loss: 2.121 Vali Acc: 0.530 Test Loss: 2.121 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.036217451095581
Epoch: 19, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.790 Vali Acc: 0.550 Test Loss: 1.790 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.017993211746216
Epoch: 20, Steps: 18 | Train Loss: 0.227 Vali Loss: 2.099 Vali Acc: 0.520 Test Loss: 2.099 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 70424834
model size : 283.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.257772207260132
Epoch: 1, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.8707172870635986
Epoch: 2, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8196465969085693
Epoch: 3, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9162852764129639
Epoch: 4, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.798 Vali Acc: 0.440 Test Loss: 0.798 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8457694053649902
Epoch: 5, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.842 Vali Acc: 0.450 Test Loss: 0.842 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0053694248199463
Epoch: 6, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.815 Vali Acc: 0.460 Test Loss: 0.815 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.873516321182251
Epoch: 7, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.9450461864471436
Epoch: 8, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.789 Vali Acc: 0.560 Test Loss: 0.789 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 1.9765188694000244
Epoch: 9, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.049 Vali Acc: 0.490 Test Loss: 1.049 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9448268413543701
Epoch: 10, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8906724452972412
Epoch: 11, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.990 Vali Acc: 0.530 Test Loss: 0.990 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8899645805358887
Epoch: 12, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.306 Vali Acc: 0.500 Test Loss: 1.306 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9197120666503906
Epoch: 13, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.230 Vali Acc: 0.570 Test Loss: 1.230 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569988).  Saving model ...
Epoch: 14 cost time: 1.9866914749145508
Epoch: 14, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.282 Vali Acc: 0.490 Test Loss: 1.282 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7823197841644287
Epoch: 15, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.071 Vali Acc: 0.570 Test Loss: 1.071 Test Acc: 0.570
Validation loss decreased (-0.569988 --> -0.569989).  Saving model ...
Epoch: 16 cost time: 1.9152390956878662
Epoch: 16, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.092 Vali Acc: 0.530 Test Loss: 1.092 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8267457485198975
Epoch: 17, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.306 Vali Acc: 0.480 Test Loss: 1.306 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.901059865951538
Epoch: 18, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.242 Vali Acc: 0.520 Test Loss: 1.242 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9025065898895264
Epoch: 19, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.206 Vali Acc: 0.520 Test Loss: 1.206 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9951882362365723
Epoch: 20, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.444 Vali Acc: 0.530 Test Loss: 1.444 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8253953456878662
Epoch: 21, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.539 Vali Acc: 0.510 Test Loss: 1.539 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7646617889404297
Epoch: 22, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.435 Vali Acc: 0.490 Test Loss: 1.435 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.86814284324646
Epoch: 23, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.560 Vali Acc: 0.500 Test Loss: 1.560 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8852777481079102
Epoch: 24, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.802 Vali Acc: 0.490 Test Loss: 1.802 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6504011154174805
Epoch: 25, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.525 Vali Acc: 0.490 Test Loss: 2.525 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 70387970
model size : 283.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.678879499435425
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.831 Vali Acc: 0.420 Test Loss: 0.831 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 2.4130911827087402
Epoch: 2, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
Validation loss decreased (-0.419992 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 2.5645360946655273
Epoch: 3, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 2.463775396347046
Epoch: 4, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9480388164520264
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 2.4881253242492676
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.55273699760437
Epoch: 7, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5888404846191406
Epoch: 8, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.598323106765747
Epoch: 9, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.866 Vali Acc: 0.540 Test Loss: 0.866 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6802217960357666
Epoch: 10, Steps: 18 | Train Loss: 0.364 Vali Loss: 1.074 Vali Acc: 0.520 Test Loss: 1.074 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.663686752319336
Epoch: 11, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.261 Vali Acc: 0.470 Test Loss: 1.261 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5795884132385254
Epoch: 12, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.991 Vali Acc: 0.570 Test Loss: 0.991 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569990).  Saving model ...
Epoch: 13 cost time: 2.442775011062622
Epoch: 13, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.276 Vali Acc: 0.520 Test Loss: 1.276 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5447475910186768
Epoch: 14, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.539 Vali Acc: 0.590 Test Loss: 1.539 Test Acc: 0.590
Validation loss decreased (-0.569990 --> -0.589985).  Saving model ...
Epoch: 15 cost time: 2.583718776702881
Epoch: 15, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.574 Vali Acc: 0.500 Test Loss: 1.574 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6347122192382812
Epoch: 16, Steps: 18 | Train Loss: 0.397 Vali Loss: 1.702 Vali Acc: 0.550 Test Loss: 1.702 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4464118480682373
Epoch: 17, Steps: 18 | Train Loss: 0.450 Vali Loss: 2.463 Vali Acc: 0.490 Test Loss: 2.463 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.595993995666504
Epoch: 18, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.556 Vali Acc: 0.490 Test Loss: 1.556 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.664163112640381
Epoch: 19, Steps: 18 | Train Loss: 0.129 Vali Loss: 3.670 Vali Acc: 0.510 Test Loss: 3.670 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.535196304321289
Epoch: 20, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.840 Vali Acc: 0.460 Test Loss: 1.840 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3132450580596924
Epoch: 21, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.898 Vali Acc: 0.510 Test Loss: 1.898 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6275174617767334
Epoch: 22, Steps: 18 | Train Loss: 0.205 Vali Loss: 2.110 Vali Acc: 0.490 Test Loss: 2.110 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5937581062316895
Epoch: 23, Steps: 18 | Train Loss: 0.173 Vali Loss: 2.002 Vali Acc: 0.500 Test Loss: 2.002 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.554987907409668
Epoch: 24, Steps: 18 | Train Loss: 0.153 Vali Loss: 2.129 Vali Acc: 0.500 Test Loss: 2.129 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 73287938
model size : 294.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5392634868621826
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.071606159210205
Epoch: 2, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.805 Vali Acc: 0.460 Test Loss: 0.805 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.289860725402832
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3417913913726807
Epoch: 4, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.370781660079956
Epoch: 5, Steps: 18 | Train Loss: 0.523 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2517924308776855
Epoch: 6, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.838 Vali Acc: 0.590 Test Loss: 0.838 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.8130171298980713
Epoch: 7, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.070 Vali Acc: 0.520 Test Loss: 1.070 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7746398448944092
Epoch: 8, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.017 Vali Acc: 0.540 Test Loss: 1.017 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7942311763763428
Epoch: 9, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.981 Vali Acc: 0.570 Test Loss: 0.981 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.076312303543091
Epoch: 10, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.819 Vali Acc: 0.590 Test Loss: 0.819 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 2.037031888961792
Epoch: 11, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9916117191314697
Epoch: 12, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.007 Vali Acc: 0.560 Test Loss: 1.007 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.925849199295044
Epoch: 13, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.400 Vali Acc: 0.530 Test Loss: 1.400 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.11906099319458
Epoch: 14, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.076 Vali Acc: 0.530 Test Loss: 1.076 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8570313453674316
Epoch: 15, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.695 Vali Acc: 0.570 Test Loss: 1.695 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.161034345626831
Epoch: 16, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.320 Vali Acc: 0.590 Test Loss: 1.320 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7613263130187988
Epoch: 17, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.294 Vali Acc: 0.510 Test Loss: 1.294 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.178018808364868
Epoch: 18, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.203 Vali Acc: 0.550 Test Loss: 1.203 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3613641262054443
Epoch: 19, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.526 Vali Acc: 0.530 Test Loss: 1.526 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.138639211654663
Epoch: 20, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.403 Vali Acc: 0.510 Test Loss: 1.403 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 73223426
model size : 294.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2923197746276855
Epoch: 1, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.675 Vali Acc: 0.570 Test Loss: 0.675 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.9248249530792236
Epoch: 2, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.694 Vali Acc: 0.540 Test Loss: 0.694 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9488584995269775
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.960139513015747
Epoch: 4, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.910 Vali Acc: 0.580 Test Loss: 0.910 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 1.9021399021148682
Epoch: 5, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9505414962768555
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.904 Vali Acc: 0.560 Test Loss: 0.904 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0802032947540283
Epoch: 7, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0177419185638428
Epoch: 8, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9680163860321045
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.161 Vali Acc: 0.480 Test Loss: 1.161 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.975599765777588
Epoch: 10, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.866 Vali Acc: 0.540 Test Loss: 0.866 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0746161937713623
Epoch: 11, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.063 Vali Acc: 0.590 Test Loss: 1.063 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589989).  Saving model ...
Epoch: 12 cost time: 1.7256031036376953
Epoch: 12, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.998 Vali Acc: 0.530 Test Loss: 0.998 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.163025140762329
Epoch: 13, Steps: 18 | Train Loss: 0.251 Vali Loss: 0.984 Vali Acc: 0.520 Test Loss: 0.984 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9492530822753906
Epoch: 14, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.222 Vali Acc: 0.490 Test Loss: 1.222 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9314665794372559
Epoch: 15, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.352 Vali Acc: 0.500 Test Loss: 1.352 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.129912853240967
Epoch: 16, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.654 Vali Acc: 0.490 Test Loss: 1.654 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9680306911468506
Epoch: 17, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.428 Vali Acc: 0.560 Test Loss: 1.428 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.12992787361145
Epoch: 18, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.904 Vali Acc: 0.480 Test Loss: 1.904 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9122579097747803
Epoch: 19, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.341 Vali Acc: 0.520 Test Loss: 1.341 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0190255641937256
Epoch: 20, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.074545383453369
Epoch: 21, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.550 Vali Acc: 0.500 Test Loss: 1.550 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 73189634
model size : 293.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps273_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.372968912124634
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.886 Vali Acc: 0.400 Test Loss: 0.886 Test Acc: 0.400
Validation loss decreased (inf --> -0.399991).  Saving model ...
Epoch: 2 cost time: 1.9421029090881348
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
Validation loss decreased (-0.399991 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.240849733352661
Epoch: 3, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.986 Vali Acc: 0.440 Test Loss: 0.986 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1858508586883545
Epoch: 4, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.995 Vali Acc: 0.450 Test Loss: 0.995 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1524531841278076
Epoch: 5, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.797 Vali Acc: 0.590 Test Loss: 0.797 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.2163989543914795
Epoch: 6, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4680163860321045
Epoch: 7, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.452291488647461
Epoch: 8, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.296839952468872
Epoch: 9, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.768 Vali Acc: 0.520 Test Loss: 1.768 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.502912759780884
Epoch: 10, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.446 Vali Acc: 0.520 Test Loss: 1.446 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3005332946777344
Epoch: 11, Steps: 18 | Train Loss: 0.636 Vali Loss: 1.245 Vali Acc: 0.470 Test Loss: 1.245 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2534549236297607
Epoch: 12, Steps: 18 | Train Loss: 0.364 Vali Loss: 1.295 Vali Acc: 0.460 Test Loss: 1.295 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4600839614868164
Epoch: 13, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.365 Vali Acc: 0.520 Test Loss: 1.365 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.631777286529541
Epoch: 14, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.573 Vali Acc: 0.480 Test Loss: 1.573 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4129185676574707
Epoch: 15, Steps: 18 | Train Loss: 0.344 Vali Loss: 2.529 Vali Acc: 0.450 Test Loss: 2.529 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps273_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 76667138
model size : 307.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps273_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4486424922943115
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.704 Vali Acc: 0.460 Test Loss: 0.704 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.0156190395355225
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.1310925483703613
Epoch: 3, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9711780548095703
Epoch: 4, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.674 Vali Acc: 0.560 Test Loss: 0.674 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.0777149200439453
Epoch: 5, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.753 Vali Acc: 0.590 Test Loss: 0.753 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.0391979217529297
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.937 Vali Acc: 0.590 Test Loss: 0.937 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1089470386505127
Epoch: 7, Steps: 18 | Train Loss: 0.462 Vali Loss: 1.266 Vali Acc: 0.570 Test Loss: 1.266 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0107290744781494
Epoch: 8, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0293281078338623
Epoch: 9, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0089216232299805
Epoch: 10, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.996978759765625
Epoch: 11, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.311 Vali Acc: 0.530 Test Loss: 1.311 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1709585189819336
Epoch: 12, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.099 Vali Acc: 0.520 Test Loss: 1.099 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.096374034881592
Epoch: 13, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.045 Vali Acc: 0.560 Test Loss: 1.045 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.936917781829834
Epoch: 14, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.344 Vali Acc: 0.460 Test Loss: 1.344 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.177741527557373
Epoch: 15, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.424 Vali Acc: 0.500 Test Loss: 1.424 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps273_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 76605698
model size : 306.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps273_str273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.880662679672241
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.0636367797851562
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.671 Vali Acc: 0.580 Test Loss: 0.671 Test Acc: 0.580
Validation loss decreased (-0.469993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.045159339904785
Epoch: 3, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3289263248443604
Epoch: 4, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.843 Vali Acc: 0.580 Test Loss: 0.843 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.071990966796875
Epoch: 5, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.828 Vali Acc: 0.580 Test Loss: 0.828 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.084158182144165
Epoch: 6, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.784 Vali Acc: 0.590 Test Loss: 0.784 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 2.166684627532959
Epoch: 7, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.948 Vali Acc: 0.510 Test Loss: 0.948 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2916157245635986
Epoch: 8, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.262 Vali Acc: 0.560 Test Loss: 1.262 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.136240243911743
Epoch: 9, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.024 Vali Acc: 0.580 Test Loss: 1.024 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.135756731033325
Epoch: 10, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.694 Vali Acc: 0.590 Test Loss: 1.694 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2439706325531006
Epoch: 11, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.069053888320923
Epoch: 12, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.144 Vali Acc: 0.540 Test Loss: 1.144 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.125844955444336
Epoch: 13, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.406 Vali Acc: 0.550 Test Loss: 1.406 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7804486751556396
Epoch: 14, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.424 Vali Acc: 0.580 Test Loss: 1.424 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0811240673065186
Epoch: 15, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.274 Vali Acc: 0.510 Test Loss: 1.274 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1785902976989746
Epoch: 16, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.608 Vali Acc: 0.560 Test Loss: 1.608 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps273_str273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 76574978
model size : 306.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps300_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8303375244140625
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.651294469833374
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.720 Vali Acc: 0.560 Test Loss: 0.720 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.4701645374298096
Epoch: 3, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.775 Vali Acc: 0.620 Test Loss: 0.775 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619992).  Saving model ...
Epoch: 4 cost time: 2.2727787494659424
Epoch: 4, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.940 Vali Acc: 0.420 Test Loss: 0.940 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.545502185821533
Epoch: 5, Steps: 18 | Train Loss: 0.576 Vali Loss: 1.006 Vali Acc: 0.540 Test Loss: 1.006 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9828572273254395
Epoch: 6, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6022884845733643
Epoch: 7, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.979 Vali Acc: 0.490 Test Loss: 0.979 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9976551532745361
Epoch: 8, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.965 Vali Acc: 0.470 Test Loss: 0.965 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.486710548400879
Epoch: 9, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.290 Vali Acc: 0.610 Test Loss: 1.290 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8993289470672607
Epoch: 10, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.134 Vali Acc: 0.540 Test Loss: 1.134 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.601287603378296
Epoch: 11, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.061 Vali Acc: 0.500 Test Loss: 1.061 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7590506076812744
Epoch: 12, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.184 Vali Acc: 0.490 Test Loss: 1.184 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6970908641815186
Epoch: 13, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.546 Vali Acc: 0.440 Test Loss: 1.546 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps300_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 80639234
model size : 322.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.134765148162842
Epoch: 1, Steps: 18 | Train Loss: 0.804 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.2892746925354004
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.697 Vali Acc: 0.480 Test Loss: 0.697 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.39042067527771
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.672 Vali Acc: 0.620 Test Loss: 0.672 Test Acc: 0.620
Validation loss decreased (-0.509992 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 1.9185514450073242
Epoch: 4, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.707 Vali Acc: 0.570 Test Loss: 0.707 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7994778156280518
Epoch: 5, Steps: 18 | Train Loss: 0.557 Vali Loss: 1.167 Vali Acc: 0.430 Test Loss: 1.167 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8628571033477783
Epoch: 6, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.261333703994751
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.914480447769165
Epoch: 8, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.293605089187622
Epoch: 9, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.207 Vali Acc: 0.530 Test Loss: 1.207 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9945359230041504
Epoch: 10, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3533501625061035
Epoch: 11, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.051 Vali Acc: 0.520 Test Loss: 1.051 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9834342002868652
Epoch: 12, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3194687366485596
Epoch: 13, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.498 Vali Acc: 0.510 Test Loss: 1.498 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 80583938
model size : 322.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps300_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.462449073791504
Epoch: 1, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.273186683654785
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0804617404937744
Epoch: 3, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.9588837623596191
Epoch: 4, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.801 Vali Acc: 0.450 Test Loss: 0.801 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1603477001190186
Epoch: 5, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 2.2179901599884033
Epoch: 6, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.057910203933716
Epoch: 7, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.860 Vali Acc: 0.490 Test Loss: 0.860 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.014708995819092
Epoch: 8, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.841 Vali Acc: 0.470 Test Loss: 0.841 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2160825729370117
Epoch: 9, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.927 Vali Acc: 0.470 Test Loss: 0.927 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.094269275665283
Epoch: 10, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.838 Vali Acc: 0.530 Test Loss: 0.838 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.248499870300293
Epoch: 11, Steps: 18 | Train Loss: 0.423 Vali Loss: 0.926 Vali Acc: 0.560 Test Loss: 0.926 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.050894260406494
Epoch: 12, Steps: 18 | Train Loss: 0.397 Vali Loss: 1.125 Vali Acc: 0.520 Test Loss: 1.125 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.237813711166382
Epoch: 13, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.209 Vali Acc: 0.450 Test Loss: 1.209 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3587729930877686
Epoch: 14, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.274 Vali Acc: 0.540 Test Loss: 1.274 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.122727155685425
Epoch: 15, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 2.073047399520874
Epoch: 16, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.726 Vali Acc: 0.590 Test Loss: 1.726 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2580461502075195
Epoch: 17, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.430 Vali Acc: 0.460 Test Loss: 1.430 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.199000120162964
Epoch: 18, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.316 Vali Acc: 0.510 Test Loss: 1.316 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.177001953125
Epoch: 19, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.572 Vali Acc: 0.480 Test Loss: 1.572 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.151669979095459
Epoch: 20, Steps: 18 | Train Loss: 0.126 Vali Loss: 2.082 Vali Acc: 0.430 Test Loss: 2.082 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.056596040725708
Epoch: 21, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.378 Vali Acc: 0.510 Test Loss: 1.378 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.329590082168579
Epoch: 22, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.325 Vali Acc: 0.530 Test Loss: 1.325 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1227681636810303
Epoch: 23, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.710 Vali Acc: 0.450 Test Loss: 1.710 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1701509952545166
Epoch: 24, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.410 Vali Acc: 0.560 Test Loss: 1.410 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.401057481765747
Epoch: 25, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.813 Vali Acc: 0.500 Test Loss: 1.813 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps300_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 80556290
model size : 321.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps334_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6080949306488037
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.074489116668701
Epoch: 2, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.766 Vali Acc: 0.490 Test Loss: 0.766 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.097426414489746
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.986 Vali Acc: 0.440 Test Loss: 0.986 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.103705883026123
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.802 Vali Acc: 0.470 Test Loss: 0.802 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4596920013427734
Epoch: 5, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1000800132751465
Epoch: 6, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.997 Vali Acc: 0.480 Test Loss: 0.997 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3877460956573486
Epoch: 7, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.928 Vali Acc: 0.490 Test Loss: 0.928 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.314805030822754
Epoch: 8, Steps: 18 | Train Loss: 0.393 Vali Loss: 1.167 Vali Acc: 0.570 Test Loss: 1.167 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569988).  Saving model ...
Epoch: 9 cost time: 2.6601428985595703
Epoch: 9, Steps: 18 | Train Loss: 0.519 Vali Loss: 1.159 Vali Acc: 0.510 Test Loss: 1.159 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.472952365875244
Epoch: 10, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.988 Vali Acc: 0.460 Test Loss: 0.988 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7547566890716553
Epoch: 11, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.464 Vali Acc: 0.470 Test Loss: 1.464 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.278198003768921
Epoch: 12, Steps: 18 | Train Loss: 0.266 Vali Loss: 1.892 Vali Acc: 0.430 Test Loss: 1.892 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.621783971786499
Epoch: 13, Steps: 18 | Train Loss: 0.324 Vali Loss: 2.004 Vali Acc: 0.470 Test Loss: 2.004 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.824418306350708
Epoch: 14, Steps: 18 | Train Loss: 0.228 Vali Loss: 2.205 Vali Acc: 0.470 Test Loss: 2.205 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4711718559265137
Epoch: 15, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.372 Vali Acc: 0.490 Test Loss: 1.372 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3646278381347656
Epoch: 16, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.452 Vali Acc: 0.540 Test Loss: 1.452 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.290656805038452
Epoch: 17, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.754 Vali Acc: 0.450 Test Loss: 1.754 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6514673233032227
Epoch: 18, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.685 Vali Acc: 0.520 Test Loss: 1.685 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps334_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 85637378
model size : 341.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps334_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.345676898956299
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.813 Vali Acc: 0.490 Test Loss: 0.813 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.4136109352111816
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.762 Vali Acc: 0.560 Test Loss: 0.762 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 2.346294403076172
Epoch: 3, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.435845375061035
Epoch: 4, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.404176712036133
Epoch: 5, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3390820026397705
Epoch: 6, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2928733825683594
Epoch: 7, Steps: 18 | Train Loss: 0.405 Vali Loss: 0.930 Vali Acc: 0.530 Test Loss: 0.930 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9963622093200684
Epoch: 8, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.884 Vali Acc: 0.490 Test Loss: 0.884 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.251358985900879
Epoch: 9, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.024 Vali Acc: 0.490 Test Loss: 1.024 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.409935235977173
Epoch: 10, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.321 Vali Acc: 0.440 Test Loss: 1.321 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.236004114151001
Epoch: 11, Steps: 18 | Train Loss: 0.326 Vali Loss: 0.992 Vali Acc: 0.530 Test Loss: 0.992 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2404308319091797
Epoch: 12, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.068 Vali Acc: 0.510 Test Loss: 1.068 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps334_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 85588226
model size : 341.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps334_str334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7805798053741455
Epoch: 1, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.689 Vali Acc: 0.560 Test Loss: 0.689 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.2488701343536377
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0460758209228516
Epoch: 3, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.721 Vali Acc: 0.590 Test Loss: 0.721 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 2.3186373710632324
Epoch: 4, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.312917947769165
Epoch: 5, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.238412380218506
Epoch: 6, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.781 Vali Acc: 0.560 Test Loss: 0.781 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3246819972991943
Epoch: 7, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.867 Vali Acc: 0.510 Test Loss: 0.867 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.33674955368042
Epoch: 8, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.037 Vali Acc: 0.530 Test Loss: 1.037 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3376259803771973
Epoch: 9, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.068 Vali Acc: 0.530 Test Loss: 1.068 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.23948073387146
Epoch: 10, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.001 Vali Acc: 0.530 Test Loss: 1.001 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1903440952301025
Epoch: 11, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3876922130584717
Epoch: 12, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.105 Vali Acc: 0.450 Test Loss: 1.105 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3176982402801514
Epoch: 13, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps334_str334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 85563650
model size : 341.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps375_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8518450260162354
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 2.448033094406128
Epoch: 2, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.6728081703186035
Epoch: 3, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.737 Vali Acc: 0.620 Test Loss: 0.737 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 2.4581685066223145
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.792 Vali Acc: 0.480 Test Loss: 0.792 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5583088397979736
Epoch: 5, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5410537719726562
Epoch: 6, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.848 Vali Acc: 0.630 Test Loss: 0.848 Test Acc: 0.630
Validation loss decreased (-0.619993 --> -0.629992).  Saving model ...
Epoch: 7 cost time: 2.5196423530578613
Epoch: 7, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2608847618103027
Epoch: 8, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.083 Vali Acc: 0.510 Test Loss: 1.083 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3061461448669434
Epoch: 9, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.175 Vali Acc: 0.490 Test Loss: 1.175 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2287986278533936
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.172 Vali Acc: 0.470 Test Loss: 1.172 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9745540618896484
Epoch: 11, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.589 Vali Acc: 0.560 Test Loss: 1.589 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.855755567550659
Epoch: 12, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.207 Vali Acc: 0.490 Test Loss: 1.207 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3897745609283447
Epoch: 13, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.616 Vali Acc: 0.440 Test Loss: 1.616 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.87910795211792
Epoch: 14, Steps: 18 | Train Loss: 0.235 Vali Loss: 2.394 Vali Acc: 0.470 Test Loss: 2.394 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.103165149688721
Epoch: 15, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.515 Vali Acc: 0.530 Test Loss: 1.515 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.459163188934326
Epoch: 16, Steps: 18 | Train Loss: 0.266 Vali Loss: 1.815 Vali Acc: 0.560 Test Loss: 1.815 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps375_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 91670786
model size : 364.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.665924787521362
Epoch: 1, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 3.8046371936798096
Epoch: 2, Steps: 18 | Train Loss: 0.657 Vali Loss: 0.645 Vali Acc: 0.570 Test Loss: 0.645 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569994).  Saving model ...
Epoch: 3 cost time: 3.0545461177825928
Epoch: 3, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.673 Vali Acc: 0.620 Test Loss: 0.673 Test Acc: 0.620
Validation loss decreased (-0.569994 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 3.1363561153411865
Epoch: 4, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3966355323791504
Epoch: 5, Steps: 18 | Train Loss: 0.538 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7307779788970947
Epoch: 6, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.764 Vali Acc: 0.570 Test Loss: 0.764 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5260772705078125
Epoch: 7, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.963 Vali Acc: 0.520 Test Loss: 0.963 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.667912483215332
Epoch: 8, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.898 Vali Acc: 0.520 Test Loss: 0.898 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8978638648986816
Epoch: 9, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.411656379699707
Epoch: 10, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.231 Vali Acc: 0.510 Test Loss: 1.231 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1288468837738037
Epoch: 11, Steps: 18 | Train Loss: 0.335 Vali Loss: 0.957 Vali Acc: 0.520 Test Loss: 0.957 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.9453463554382324
Epoch: 12, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.039 Vali Acc: 0.520 Test Loss: 1.039 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0233030319213867
Epoch: 13, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.363 Vali Acc: 0.550 Test Loss: 1.363 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 91627778
model size : 364.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps375_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.910648822784424
Epoch: 1, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.0834922790527344
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 3.4893617630004883
Epoch: 3, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.193338394165039
Epoch: 4, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7781386375427246
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0822834968566895
Epoch: 6, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.982 Vali Acc: 0.500 Test Loss: 0.982 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.858093500137329
Epoch: 7, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3585727214813232
Epoch: 8, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.972 Vali Acc: 0.500 Test Loss: 0.972 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4709811210632324
Epoch: 9, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.006 Vali Acc: 0.540 Test Loss: 1.006 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8441202640533447
Epoch: 10, Steps: 18 | Train Loss: 0.364 Vali Loss: 1.403 Vali Acc: 0.500 Test Loss: 1.403 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3071465492248535
Epoch: 11, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.158499002456665
Epoch: 12, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.273 Vali Acc: 0.530 Test Loss: 1.273 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps375_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 91609346
model size : 364.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps429_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.23729395866394
Epoch: 1, Steps: 18 | Train Loss: 0.812 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.4079535007476807
Epoch: 2, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
Validation loss decreased (-0.469993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 3.619231939315796
Epoch: 3, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.698 Vali Acc: 0.590 Test Loss: 0.698 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 3.23419451713562
Epoch: 4, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.864 Vali Acc: 0.570 Test Loss: 0.864 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.738257884979248
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.873 Vali Acc: 0.450 Test Loss: 0.873 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7472083568573
Epoch: 6, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.000 Vali Acc: 0.490 Test Loss: 1.000 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2460694313049316
Epoch: 7, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5531485080718994
Epoch: 8, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.880 Vali Acc: 0.530 Test Loss: 0.880 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1696879863739014
Epoch: 9, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.348 Vali Acc: 0.480 Test Loss: 1.348 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2975711822509766
Epoch: 10, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9891104698181152
Epoch: 11, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.58013916015625
Epoch: 12, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.330 Vali Acc: 0.520 Test Loss: 1.330 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.2008321285247803
Epoch: 13, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps429_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 99621122
model size : 394.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps429_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.419033527374268
Epoch: 1, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.814 Vali Acc: 0.390 Test Loss: 0.814 Test Acc: 0.390
Validation loss decreased (inf --> -0.389992).  Saving model ...
Epoch: 2 cost time: 2.4945263862609863
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
Validation loss decreased (-0.389992 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 3.2519683837890625
Epoch: 3, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.766 Vali Acc: 0.550 Test Loss: 0.766 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.461249351501465
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.733 Vali Acc: 0.600 Test Loss: 0.733 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 3.196629524230957
Epoch: 5, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.852 Vali Acc: 0.630 Test Loss: 0.852 Test Acc: 0.630
Validation loss decreased (-0.599993 --> -0.629991).  Saving model ...
Epoch: 6 cost time: 3.244141101837158
Epoch: 6, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3777949810028076
Epoch: 7, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.017 Vali Acc: 0.540 Test Loss: 1.017 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.167140007019043
Epoch: 8, Steps: 18 | Train Loss: 0.496 Vali Loss: 1.101 Vali Acc: 0.510 Test Loss: 1.101 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2213494777679443
Epoch: 9, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.920 Vali Acc: 0.540 Test Loss: 0.920 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.382903575897217
Epoch: 10, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.978 Vali Acc: 0.580 Test Loss: 0.978 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2213964462280273
Epoch: 11, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.137 Vali Acc: 0.530 Test Loss: 1.137 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.3358049392700195
Epoch: 12, Steps: 18 | Train Loss: 0.293 Vali Loss: 0.910 Vali Acc: 0.550 Test Loss: 0.910 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2969119548797607
Epoch: 13, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.2099668979644775
Epoch: 14, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.295 Vali Acc: 0.540 Test Loss: 1.295 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9653384685516357
Epoch: 15, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.311 Vali Acc: 0.490 Test Loss: 1.311 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps429_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 99584258
model size : 394.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps429_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.471311330795288
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.047729015350342
Epoch: 2, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.685 Vali Acc: 0.590 Test Loss: 0.685 Test Acc: 0.590
Validation loss decreased (-0.499993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 3.129969835281372
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.810 Vali Acc: 0.480 Test Loss: 0.810 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8902013301849365
Epoch: 4, Steps: 18 | Train Loss: 0.582 Vali Loss: 1.030 Vali Acc: 0.430 Test Loss: 1.030 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.105339527130127
Epoch: 5, Steps: 18 | Train Loss: 0.549 Vali Loss: 1.012 Vali Acc: 0.460 Test Loss: 1.012 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.95212459564209
Epoch: 6, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.696218252182007
Epoch: 7, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.020 Vali Acc: 0.450 Test Loss: 1.020 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3571228981018066
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.981 Vali Acc: 0.520 Test Loss: 0.981 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.278364896774292
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.132 Vali Acc: 0.510 Test Loss: 1.132 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3052239418029785
Epoch: 10, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.117 Vali Acc: 0.520 Test Loss: 1.117 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2548952102661133
Epoch: 11, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.804 Vali Acc: 0.500 Test Loss: 1.804 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2680866718292236
Epoch: 12, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps429_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 99565826
model size : 394.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.071997165679932
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.691 Vali Acc: 0.510 Test Loss: 0.691 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.4623255729675293
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.683 Vali Acc: 0.530 Test Loss: 0.683 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.258488178253174
Epoch: 3, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.814 Vali Acc: 0.570 Test Loss: 0.814 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 3.6375484466552734
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.287299156188965
Epoch: 5, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.789 Vali Acc: 0.460 Test Loss: 0.789 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3418052196502686
Epoch: 6, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3620645999908447
Epoch: 7, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0355007648468018
Epoch: 8, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.870 Vali Acc: 0.550 Test Loss: 0.870 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.525973320007324
Epoch: 9, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.5598278045654297
Epoch: 10, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.037 Vali Acc: 0.530 Test Loss: 1.037 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.2551488876342773
Epoch: 11, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.405 Vali Acc: 0.460 Test Loss: 1.405 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4541797637939453
Epoch: 12, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.981 Vali Acc: 0.550 Test Loss: 0.981 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.407858371734619
Epoch: 13, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.426 Vali Acc: 0.510 Test Loss: 1.426 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 110081282
model size : 434.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.759211540222168
Epoch: 1, Steps: 18 | Train Loss: 0.821 Vali Loss: 0.800 Vali Acc: 0.460 Test Loss: 0.800 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 3.0335159301757812
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (-0.459992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.2047080993652344
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.717 Vali Acc: 0.560 Test Loss: 0.717 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 3.0729193687438965
Epoch: 4, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.710 Vali Acc: 0.580 Test Loss: 0.710 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 3.217188596725464
Epoch: 5, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.953 Vali Acc: 0.440 Test Loss: 0.953 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0301640033721924
Epoch: 6, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1290829181671143
Epoch: 7, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0915722846984863
Epoch: 8, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.990 Vali Acc: 0.580 Test Loss: 0.990 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2152016162872314
Epoch: 9, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.107534646987915
Epoch: 10, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1287872791290283
Epoch: 11, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.332 Vali Acc: 0.490 Test Loss: 1.332 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.26011323928833
Epoch: 12, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.009 Vali Acc: 0.540 Test Loss: 1.009 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0635526180267334
Epoch: 13, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.459 Vali Acc: 0.490 Test Loss: 1.459 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.123556137084961
Epoch: 14, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.199 Vali Acc: 0.470 Test Loss: 1.199 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 110050562
model size : 434.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.373248338699341
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.146052360534668
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 3.2434115409851074
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.857 Vali Acc: 0.430 Test Loss: 0.857 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.095571756362915
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.734 Vali Acc: 0.610 Test Loss: 0.734 Test Acc: 0.610
Validation loss decreased (-0.539992 --> -0.609993).  Saving model ...
Epoch: 5 cost time: 3.1270034313201904
Epoch: 5, Steps: 18 | Train Loss: 0.462 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.526702880859375
Epoch: 6, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.902 Vali Acc: 0.520 Test Loss: 0.902 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.468472480773926
Epoch: 7, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.490217447280884
Epoch: 8, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.114 Vali Acc: 0.480 Test Loss: 1.114 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8875019550323486
Epoch: 9, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.557 Vali Acc: 0.490 Test Loss: 1.557 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.359800338745117
Epoch: 10, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.304196357727051
Epoch: 11, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.186 Vali Acc: 0.530 Test Loss: 1.186 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.743999719619751
Epoch: 12, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.140 Vali Acc: 0.530 Test Loss: 1.140 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.5423102378845215
Epoch: 13, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.390 Vali Acc: 0.470 Test Loss: 1.390 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.443160057067871
Epoch: 14, Steps: 18 | Train Loss: 0.214 Vali Loss: 1.511 Vali Acc: 0.450 Test Loss: 1.511 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 110035202
model size : 434.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps600_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.530069351196289
Epoch: 1, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 4.520215749740601
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.090744733810425
Epoch: 3, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.709 Vali Acc: 0.580 Test Loss: 0.709 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 4.10125732421875
Epoch: 4, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.720 Vali Acc: 0.660 Test Loss: 0.720 Test Acc: 0.660
Validation loss decreased (-0.579993 --> -0.659993).  Saving model ...
Epoch: 5 cost time: 4.1015918254852295
Epoch: 5, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.820 Vali Acc: 0.560 Test Loss: 0.820 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.158557176589966
Epoch: 6, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.15546441078186
Epoch: 7, Steps: 18 | Train Loss: 0.505 Vali Loss: 1.314 Vali Acc: 0.570 Test Loss: 1.314 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.161329030990601
Epoch: 8, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.967 Vali Acc: 0.530 Test Loss: 0.967 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.095596790313721
Epoch: 9, Steps: 18 | Train Loss: 0.460 Vali Loss: 1.032 Vali Acc: 0.560 Test Loss: 1.032 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.150699853897095
Epoch: 10, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.355945110321045
Epoch: 11, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.068 Vali Acc: 0.530 Test Loss: 1.068 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.3865509033203125
Epoch: 12, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.243 Vali Acc: 0.590 Test Loss: 1.243 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.2346320152282715
Epoch: 13, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.523 Vali Acc: 0.540 Test Loss: 1.523 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.498613595962524
Epoch: 14, Steps: 18 | Train Loss: 0.305 Vali Loss: 1.829 Vali Acc: 0.500 Test Loss: 1.829 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps600_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 124814594
model size : 490.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.031418561935425
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.742 Vali Acc: 0.440 Test Loss: 0.742 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 3.688533067703247
Epoch: 2, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (-0.439993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 4.175619602203369
Epoch: 3, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.808 Vali Acc: 0.460 Test Loss: 0.808 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.776571750640869
Epoch: 4, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 4.039720296859741
Epoch: 5, Steps: 18 | Train Loss: 0.535 Vali Loss: 1.050 Vali Acc: 0.470 Test Loss: 1.050 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.04529595375061
Epoch: 6, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.956 Vali Acc: 0.530 Test Loss: 0.956 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6859490871429443
Epoch: 7, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.120651721954346
Epoch: 8, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.942 Vali Acc: 0.560 Test Loss: 0.942 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 4.1534106731414795
Epoch: 9, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.317 Vali Acc: 0.450 Test Loss: 1.317 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.809359550476074
Epoch: 10, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.114354610443115
Epoch: 11, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.119 Vali Acc: 0.530 Test Loss: 1.119 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9618494510650635
Epoch: 12, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.073 Vali Acc: 0.530 Test Loss: 1.073 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9213807582855225
Epoch: 13, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.747 Vali Acc: 0.520 Test Loss: 1.747 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.8506112098693848
Epoch: 14, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.264 Vali Acc: 0.530 Test Loss: 1.264 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.347688913345337
Epoch: 15, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.466 Vali Acc: 0.510 Test Loss: 1.466 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.195885419845581
Epoch: 16, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.549 Vali Acc: 0.450 Test Loss: 1.549 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.819953441619873
Epoch: 17, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.598 Vali Acc: 0.490 Test Loss: 1.598 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.06074070930481
Epoch: 18, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.726 Vali Acc: 0.470 Test Loss: 1.726 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 124790018
model size : 490.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps600_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.334292888641357
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.789 Vali Acc: 0.420 Test Loss: 0.789 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 4.027208089828491
Epoch: 2, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
Validation loss decreased (-0.419992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 4.051698923110962
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8124070167541504
Epoch: 4, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.908 Vali Acc: 0.440 Test Loss: 0.908 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9530882835388184
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8298401832580566
Epoch: 6, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
Validation loss decreased (-0.509993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 3.7372841835021973
Epoch: 7, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.993 Vali Acc: 0.530 Test Loss: 0.993 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.080657243728638
Epoch: 8, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.942 Vali Acc: 0.540 Test Loss: 0.942 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6676406860351562
Epoch: 9, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.830 Vali Acc: 0.600 Test Loss: 0.830 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 10 cost time: 3.9512619972229004
Epoch: 10, Steps: 18 | Train Loss: 0.325 Vali Loss: 0.941 Vali Acc: 0.500 Test Loss: 0.941 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.013426303863525
Epoch: 11, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.779646873474121
Epoch: 12, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.224 Vali Acc: 0.590 Test Loss: 1.224 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.087522506713867
Epoch: 13, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.080 Vali Acc: 0.510 Test Loss: 1.080 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8065378665924072
Epoch: 14, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.305 Vali Acc: 0.580 Test Loss: 1.305 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.034240245819092
Epoch: 15, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.188 Vali Acc: 0.530 Test Loss: 1.188 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.771073818206787
Epoch: 16, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.167 Vali Acc: 0.530 Test Loss: 1.167 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6681747436523438
Epoch: 17, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.685 Vali Acc: 0.540 Test Loss: 1.685 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8189916610717773
Epoch: 18, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.599 Vali Acc: 0.570 Test Loss: 1.599 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7198081016540527
Epoch: 19, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.527 Vali Acc: 0.560 Test Loss: 1.527 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el5_dm768_df768_ps600_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 124777730
model size : 490.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.12896728515625
Epoch: 1, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.265770673751831
Epoch: 2, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.709 Vali Acc: 0.600 Test Loss: 0.709 Test Acc: 0.600
Validation loss decreased (-0.499992 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 2.589937210083008
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.786079168319702
Epoch: 4, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.802 Vali Acc: 0.570 Test Loss: 0.802 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4894001483917236
Epoch: 5, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8773906230926514
Epoch: 6, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.752 Vali Acc: 0.570 Test Loss: 0.752 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6847116947174072
Epoch: 7, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.765138626098633
Epoch: 8, Steps: 18 | Train Loss: 0.540 Vali Loss: 0.987 Vali Acc: 0.560 Test Loss: 0.987 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.543818235397339
Epoch: 9, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.277 Vali Acc: 0.590 Test Loss: 1.277 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.723069190979004
Epoch: 10, Steps: 18 | Train Loss: 0.556 Vali Loss: 1.285 Vali Acc: 0.520 Test Loss: 1.285 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7179031372070312
Epoch: 11, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.004 Vali Acc: 0.630 Test Loss: 1.004 Test Acc: 0.630
Validation loss decreased (-0.599993 --> -0.629990).  Saving model ...
Epoch: 12 cost time: 2.6779611110687256
Epoch: 12, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.308 Vali Acc: 0.550 Test Loss: 1.308 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5485761165618896
Epoch: 13, Steps: 18 | Train Loss: 0.444 Vali Loss: 2.051 Vali Acc: 0.560 Test Loss: 2.051 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.763796329498291
Epoch: 14, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.668 Vali Acc: 0.580 Test Loss: 1.668 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3715763092041016
Epoch: 15, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.540 Vali Acc: 0.450 Test Loss: 1.540 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6984310150146484
Epoch: 16, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.501 Vali Acc: 0.550 Test Loss: 1.501 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.727674961090088
Epoch: 17, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.663 Vali Acc: 0.520 Test Loss: 1.663 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.701364278793335
Epoch: 18, Steps: 18 | Train Loss: 0.202 Vali Loss: 2.129 Vali Acc: 0.560 Test Loss: 2.129 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1114869117736816
Epoch: 19, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.746 Vali Acc: 0.540 Test Loss: 1.746 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5893235206604004
Epoch: 20, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.922 Vali Acc: 0.520 Test Loss: 1.922 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6204469203948975
Epoch: 21, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.764 Vali Acc: 0.500 Test Loss: 1.764 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 47193602
model size : 194.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1790690422058105
Epoch: 1, Steps: 18 | Train Loss: 0.812 Vali Loss: 0.832 Vali Acc: 0.440 Test Loss: 0.832 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.8499743938446045
Epoch: 2, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.814 Vali Acc: 0.450 Test Loss: 0.814 Test Acc: 0.450
Validation loss decreased (-0.439992 --> -0.449992).  Saving model ...
Epoch: 3 cost time: 1.9958055019378662
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.738 Vali Acc: 0.610 Test Loss: 0.738 Test Acc: 0.610
Validation loss decreased (-0.449992 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 1.9459166526794434
Epoch: 4, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0798401832580566
Epoch: 5, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9276974201202393
Epoch: 6, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.858 Vali Acc: 0.590 Test Loss: 0.858 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.087747097015381
Epoch: 7, Steps: 18 | Train Loss: 0.583 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0455658435821533
Epoch: 8, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.907 Vali Acc: 0.510 Test Loss: 0.907 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1494710445404053
Epoch: 9, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.722 Vali Acc: 0.570 Test Loss: 0.722 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9719548225402832
Epoch: 10, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.898 Vali Acc: 0.480 Test Loss: 0.898 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9543871879577637
Epoch: 11, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.002 Vali Acc: 0.540 Test Loss: 1.002 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5334672927856445
Epoch: 12, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.314 Vali Acc: 0.530 Test Loss: 1.314 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.876072883605957
Epoch: 13, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.911 Vali Acc: 0.570 Test Loss: 0.911 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 47046146
model size : 194.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1482431888580322
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.7218682765960693
Epoch: 2, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.749553918838501
Epoch: 3, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.61977219581604
Epoch: 4, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.714 Vali Acc: 0.570 Test Loss: 0.714 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 1.6743319034576416
Epoch: 5, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.691 Vali Acc: 0.510 Test Loss: 0.691 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6033225059509277
Epoch: 6, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7399330139160156
Epoch: 7, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5453710556030273
Epoch: 8, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.819 Vali Acc: 0.500 Test Loss: 0.819 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7412161827087402
Epoch: 9, Steps: 18 | Train Loss: 0.375 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6529152393341064
Epoch: 10, Steps: 18 | Train Loss: 0.535 Vali Loss: 1.033 Vali Acc: 0.470 Test Loss: 1.033 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6714403629302979
Epoch: 11, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.048 Vali Acc: 0.540 Test Loss: 1.048 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6625018119812012
Epoch: 12, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.824 Vali Acc: 0.610 Test Loss: 0.824 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 13 cost time: 1.8329284191131592
Epoch: 13, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.956 Vali Acc: 0.510 Test Loss: 0.956 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6359531879425049
Epoch: 14, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.348 Vali Acc: 0.580 Test Loss: 1.348 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8761634826660156
Epoch: 15, Steps: 18 | Train Loss: 0.232 Vali Loss: 0.962 Vali Acc: 0.530 Test Loss: 0.962 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8099744319915771
Epoch: 16, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.814 Vali Acc: 0.490 Test Loss: 1.814 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.033280611038208
Epoch: 17, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.434 Vali Acc: 0.560 Test Loss: 1.434 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.002211809158325
Epoch: 18, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.500 Vali Acc: 0.590 Test Loss: 1.500 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.696807861328125
Epoch: 19, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.458 Vali Acc: 0.520 Test Loss: 1.458 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5853126049041748
Epoch: 20, Steps: 18 | Train Loss: 0.185 Vali Loss: 2.033 Vali Acc: 0.500 Test Loss: 2.033 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7604503631591797
Epoch: 21, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.807 Vali Acc: 0.470 Test Loss: 1.807 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.616994857788086
Epoch: 22, Steps: 18 | Train Loss: 0.314 Vali Loss: 1.142 Vali Acc: 0.570 Test Loss: 1.142 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 46972418
model size : 193.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.572131395339966
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.742 Vali Acc: 0.440 Test Loss: 0.742 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.3306894302368164
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.651 Vali Acc: 0.600 Test Loss: 0.651 Test Acc: 0.600
Validation loss decreased (-0.439993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 2.03998064994812
Epoch: 3, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.307786703109741
Epoch: 4, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.780 Vali Acc: 0.570 Test Loss: 0.780 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.486851692199707
Epoch: 5, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.714 Vali Acc: 0.590 Test Loss: 0.714 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4947261810302734
Epoch: 6, Steps: 18 | Train Loss: 0.688 Vali Loss: 0.917 Vali Acc: 0.510 Test Loss: 0.917 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6564266681671143
Epoch: 7, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.938 Vali Acc: 0.470 Test Loss: 0.938 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.631871461868286
Epoch: 8, Steps: 18 | Train Loss: 0.609 Vali Loss: 1.143 Vali Acc: 0.420 Test Loss: 1.143 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.599979877471924
Epoch: 9, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.706 Vali Acc: 0.640 Test Loss: 0.706 Test Acc: 0.640
Validation loss decreased (-0.599993 --> -0.639993).  Saving model ...
Epoch: 10 cost time: 2.4478094577789307
Epoch: 10, Steps: 18 | Train Loss: 0.435 Vali Loss: 1.025 Vali Acc: 0.490 Test Loss: 1.025 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.367091655731201
Epoch: 11, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.100 Vali Acc: 0.520 Test Loss: 1.100 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.51277232170105
Epoch: 12, Steps: 18 | Train Loss: 0.647 Vali Loss: 1.675 Vali Acc: 0.480 Test Loss: 1.675 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.564286470413208
Epoch: 13, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.057 Vali Acc: 0.540 Test Loss: 1.057 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.20241117477417
Epoch: 14, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.572 Vali Acc: 0.480 Test Loss: 1.572 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.536557912826538
Epoch: 15, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.386 Vali Acc: 0.540 Test Loss: 1.386 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5155835151672363
Epoch: 16, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.624 Vali Acc: 0.400 Test Loss: 1.624 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4694302082061768
Epoch: 17, Steps: 18 | Train Loss: 0.384 Vali Loss: 2.234 Vali Acc: 0.470 Test Loss: 2.234 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5223824977874756
Epoch: 18, Steps: 18 | Train Loss: 0.361 Vali Loss: 2.392 Vali Acc: 0.460 Test Loss: 2.392 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5219027996063232
Epoch: 19, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.418 Vali Acc: 0.530 Test Loss: 1.418 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 47909378
model size : 197.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4004361629486084
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.8066155910491943
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.694 Vali Acc: 0.590 Test Loss: 0.694 Test Acc: 0.590
Validation loss decreased (-0.489993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 1.7130606174468994
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9193522930145264
Epoch: 4, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8173003196716309
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.775 Vali Acc: 0.570 Test Loss: 0.775 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9850523471832275
Epoch: 6, Steps: 18 | Train Loss: 0.530 Vali Loss: 1.628 Vali Acc: 0.490 Test Loss: 1.628 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8728408813476562
Epoch: 7, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7341103553771973
Epoch: 8, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0366322994232178
Epoch: 9, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7921178340911865
Epoch: 10, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7871084213256836
Epoch: 11, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.455 Vali Acc: 0.550 Test Loss: 1.455 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8692774772644043
Epoch: 12, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.203 Vali Acc: 0.520 Test Loss: 1.203 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 47774210
model size : 196.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3725500106811523
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.8313162326812744
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.715 Vali Acc: 0.600 Test Loss: 0.715 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 1.9662692546844482
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8285496234893799
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.350837230682373
Epoch: 5, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.835 Vali Acc: 0.420 Test Loss: 0.835 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9362244606018066
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.477 Vali Acc: 0.500 Test Loss: 1.477 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7063519954681396
Epoch: 7, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.866 Vali Acc: 0.490 Test Loss: 0.866 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7567212581634521
Epoch: 8, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.932 Vali Acc: 0.490 Test Loss: 0.932 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9064240455627441
Epoch: 9, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.037 Vali Acc: 0.450 Test Loss: 1.037 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8960680961608887
Epoch: 10, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.611 Vali Acc: 0.490 Test Loss: 1.611 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7436497211456299
Epoch: 11, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.973 Vali Acc: 0.510 Test Loss: 0.973 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9355778694152832
Epoch: 12, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.689 Vali Acc: 0.470 Test Loss: 1.689 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 47706626
model size : 196.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps131_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.952258586883545
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.6777052879333496
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 2.4064226150512695
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.741 Vali Acc: 0.630 Test Loss: 0.741 Test Acc: 0.630
Validation loss decreased (-0.549992 --> -0.629993).  Saving model ...
Epoch: 4 cost time: 2.748358964920044
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.689 Vali Acc: 0.620 Test Loss: 0.689 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.432783365249634
Epoch: 5, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.780029296875
Epoch: 6, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.863 Vali Acc: 0.560 Test Loss: 0.863 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.541048526763916
Epoch: 7, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.751 Vali Acc: 0.600 Test Loss: 0.751 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6425957679748535
Epoch: 8, Steps: 18 | Train Loss: 0.670 Vali Loss: 1.299 Vali Acc: 0.580 Test Loss: 1.299 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7439913749694824
Epoch: 9, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.834 Vali Acc: 0.580 Test Loss: 0.834 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.632145881652832
Epoch: 10, Steps: 18 | Train Loss: 0.474 Vali Loss: 2.285 Vali Acc: 0.510 Test Loss: 2.285 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.555973529815674
Epoch: 11, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.947 Vali Acc: 0.530 Test Loss: 0.947 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.636237621307373
Epoch: 12, Steps: 18 | Train Loss: 0.458 Vali Loss: 1.098 Vali Acc: 0.510 Test Loss: 1.098 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4552128314971924
Epoch: 13, Steps: 18 | Train Loss: 0.495 Vali Loss: 1.060 Vali Acc: 0.550 Test Loss: 1.060 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps131_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 48784898
model size : 200.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps131_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2189254760742188
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.676 Vali Acc: 0.600 Test Loss: 0.676 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 2.0681657791137695
Epoch: 2, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.102701425552368
Epoch: 3, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.127671957015991
Epoch: 4, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9704656600952148
Epoch: 5, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0352301597595215
Epoch: 6, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8234388828277588
Epoch: 7, Steps: 18 | Train Loss: 0.425 Vali Loss: 1.224 Vali Acc: 0.490 Test Loss: 1.224 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2302329540252686
Epoch: 8, Steps: 18 | Train Loss: 0.519 Vali Loss: 1.454 Vali Acc: 0.590 Test Loss: 1.454 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.97467041015625
Epoch: 9, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.408 Vali Acc: 0.510 Test Loss: 1.408 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.064307689666748
Epoch: 10, Steps: 18 | Train Loss: 0.434 Vali Loss: 1.335 Vali Acc: 0.540 Test Loss: 1.335 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.942850112915039
Epoch: 11, Steps: 18 | Train Loss: 0.535 Vali Loss: 1.015 Vali Acc: 0.500 Test Loss: 1.015 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps131_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 48652802
model size : 200.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps131_str131_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2250266075134277
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.687 Vali Acc: 0.560 Test Loss: 0.687 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.009647846221924
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.798 Vali Acc: 0.460 Test Loss: 0.798 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.000404119491577
Epoch: 3, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.684 Vali Acc: 0.560 Test Loss: 0.684 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 1.922576665878296
Epoch: 4, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.797347068786621
Epoch: 5, Steps: 18 | Train Loss: 0.690 Vali Loss: 0.794 Vali Acc: 0.460 Test Loss: 0.794 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5822031497955322
Epoch: 6, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.848 Vali Acc: 0.460 Test Loss: 0.848 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8572180271148682
Epoch: 7, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.130 Vali Acc: 0.490 Test Loss: 1.130 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7963223457336426
Epoch: 8, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.978 Vali Acc: 0.490 Test Loss: 0.978 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6282010078430176
Epoch: 9, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.900848627090454
Epoch: 10, Steps: 18 | Train Loss: 0.483 Vali Loss: 1.429 Vali Acc: 0.470 Test Loss: 1.429 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5235021114349365
Epoch: 11, Steps: 18 | Train Loss: 0.400 Vali Loss: 1.066 Vali Acc: 0.510 Test Loss: 1.066 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9578051567077637
Epoch: 12, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.330 Vali Acc: 0.480 Test Loss: 1.330 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6439383029937744
Epoch: 13, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.073 Vali Acc: 0.480 Test Loss: 1.073 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps131_str131_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 48585218
model size : 200.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps137_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5512423515319824
Epoch: 1, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.796 Vali Acc: 0.450 Test Loss: 0.796 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.471358299255371
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.6427788734436035
Epoch: 3, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 2.5006604194641113
Epoch: 4, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.758 Vali Acc: 0.580 Test Loss: 0.758 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 2.6967599391937256
Epoch: 5, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.841 Vali Acc: 0.610 Test Loss: 0.841 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 2.6651201248168945
Epoch: 6, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.759 Vali Acc: 0.560 Test Loss: 0.759 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6177313327789307
Epoch: 7, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.591029167175293
Epoch: 8, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.114 Vali Acc: 0.580 Test Loss: 1.114 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4052720069885254
Epoch: 9, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.989 Vali Acc: 0.520 Test Loss: 0.989 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7471370697021484
Epoch: 10, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.383 Vali Acc: 0.580 Test Loss: 1.383 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7173988819122314
Epoch: 11, Steps: 18 | Train Loss: 0.487 Vali Loss: 1.018 Vali Acc: 0.540 Test Loss: 1.018 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2802255153656006
Epoch: 12, Steps: 18 | Train Loss: 0.503 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.694885492324829
Epoch: 13, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.317 Vali Acc: 0.560 Test Loss: 1.317 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4011828899383545
Epoch: 14, Steps: 18 | Train Loss: 0.558 Vali Loss: 2.628 Vali Acc: 0.550 Test Loss: 2.628 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6154696941375732
Epoch: 15, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.612 Vali Acc: 0.560 Test Loss: 1.612 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps137_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 49654274
model size : 204.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps137_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5674309730529785
Epoch: 1, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.682 Vali Acc: 0.620 Test Loss: 0.682 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 1.904350996017456
Epoch: 2, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.704 Vali Acc: 0.590 Test Loss: 0.704 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9390368461608887
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.916011095046997
Epoch: 4, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8771569728851318
Epoch: 5, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.839 Vali Acc: 0.560 Test Loss: 0.839 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0245566368103027
Epoch: 6, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.698 Vali Acc: 0.590 Test Loss: 0.698 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.107456922531128
Epoch: 7, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.829 Vali Acc: 0.620 Test Loss: 0.829 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0333139896392822
Epoch: 8, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.036 Vali Acc: 0.530 Test Loss: 1.036 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0360522270202637
Epoch: 9, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.995 Vali Acc: 0.520 Test Loss: 0.995 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.196971893310547
Epoch: 10, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9512708187103271
Epoch: 11, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.050 Vali Acc: 0.550 Test Loss: 1.050 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps137_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 49531394
model size : 203.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps137_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7751715183258057
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3287711143493652
Epoch: 2, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4537005424499512
Epoch: 3, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.853 Vali Acc: 0.520 Test Loss: 0.853 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 1.3664608001708984
Epoch: 4, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.894 Vali Acc: 0.570 Test Loss: 0.894 Test Acc: 0.570
Validation loss decreased (-0.519991 --> -0.569991).  Saving model ...
Epoch: 5 cost time: 1.4687631130218506
Epoch: 5, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4594194889068604
Epoch: 6, Steps: 18 | Train Loss: 0.491 Vali Loss: 0.894 Vali Acc: 0.510 Test Loss: 0.894 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5862302780151367
Epoch: 7, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.892 Vali Acc: 0.490 Test Loss: 0.892 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2478981018066406
Epoch: 8, Steps: 18 | Train Loss: 0.429 Vali Loss: 0.906 Vali Acc: 0.520 Test Loss: 0.906 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3886237144470215
Epoch: 9, Steps: 18 | Train Loss: 0.444 Vali Loss: 0.931 Vali Acc: 0.550 Test Loss: 0.931 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.266571283340454
Epoch: 10, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.995 Vali Acc: 0.510 Test Loss: 0.995 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5372264385223389
Epoch: 11, Steps: 18 | Train Loss: 0.296 Vali Loss: 0.880 Vali Acc: 0.560 Test Loss: 0.880 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5152413845062256
Epoch: 12, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.109 Vali Acc: 0.570 Test Loss: 1.109 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5695326328277588
Epoch: 13, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.132 Vali Acc: 0.530 Test Loss: 1.132 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.428856372833252
Epoch: 14, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.168 Vali Acc: 0.510 Test Loss: 1.168 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps137_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 49466882
model size : 203.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps143_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.565887212753296
Epoch: 1, Steps: 18 | Train Loss: 0.835 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.2504374980926514
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.830 Vali Acc: 0.530 Test Loss: 0.830 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2270822525024414
Epoch: 3, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4347970485687256
Epoch: 4, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3876559734344482
Epoch: 5, Steps: 18 | Train Loss: 0.650 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.290384292602539
Epoch: 6, Steps: 18 | Train Loss: 0.578 Vali Loss: 1.147 Vali Acc: 0.480 Test Loss: 1.147 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.486995220184326
Epoch: 7, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.992 Vali Acc: 0.450 Test Loss: 0.992 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3127102851867676
Epoch: 8, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.878 Vali Acc: 0.550 Test Loss: 0.878 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.314225196838379
Epoch: 9, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.943 Vali Acc: 0.560 Test Loss: 0.943 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9398629665374756
Epoch: 10, Steps: 18 | Train Loss: 0.477 Vali Loss: 2.016 Vali Acc: 0.500 Test Loss: 2.016 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.34740948677063
Epoch: 11, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.961 Vali Acc: 0.560 Test Loss: 0.961 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps143_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 50532866
model size : 207.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps143_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.193763494491577
Epoch: 1, Steps: 18 | Train Loss: 0.824 Vali Loss: 0.753 Vali Acc: 0.440 Test Loss: 0.753 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.7311372756958008
Epoch: 2, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.714 Vali Acc: 0.570 Test Loss: 0.714 Test Acc: 0.570
Validation loss decreased (-0.439992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.689988374710083
Epoch: 3, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7223341464996338
Epoch: 4, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.962 Vali Acc: 0.430 Test Loss: 0.962 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.78648042678833
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.754 Vali Acc: 0.570 Test Loss: 0.754 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8704161643981934
Epoch: 6, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.855 Vali Acc: 0.460 Test Loss: 0.855 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7880804538726807
Epoch: 7, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.850 Vali Acc: 0.580 Test Loss: 0.850 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 8 cost time: 1.471144437789917
Epoch: 8, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.015 Vali Acc: 0.550 Test Loss: 1.015 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4646263122558594
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.277 Vali Acc: 0.530 Test Loss: 1.277 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4497628211975098
Epoch: 10, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.073 Vali Acc: 0.510 Test Loss: 1.073 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4509170055389404
Epoch: 11, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.450 Vali Acc: 0.530 Test Loss: 1.450 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4762873649597168
Epoch: 12, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4812090396881104
Epoch: 13, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.778 Vali Acc: 0.470 Test Loss: 1.778 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4894790649414062
Epoch: 14, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.249 Vali Acc: 0.570 Test Loss: 1.249 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1219334602355957
Epoch: 15, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.310 Vali Acc: 0.530 Test Loss: 1.310 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0777857303619385
Epoch: 16, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.775 Vali Acc: 0.510 Test Loss: 1.775 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1222851276397705
Epoch: 17, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.848 Vali Acc: 0.580 Test Loss: 1.848 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps143_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 50409986
model size : 206.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps143_str143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0956199169158936
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.686 Vali Acc: 0.460 Test Loss: 0.686 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.8750996589660645
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.9691827297210693
Epoch: 3, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.804 Vali Acc: 0.530 Test Loss: 0.804 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.9059734344482422
Epoch: 4, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.759253740310669
Epoch: 5, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8914804458618164
Epoch: 6, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.870 Vali Acc: 0.530 Test Loss: 0.870 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5983567237854004
Epoch: 7, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9291205406188965
Epoch: 8, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.992 Vali Acc: 0.520 Test Loss: 0.992 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7848701477050781
Epoch: 9, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.071 Vali Acc: 0.510 Test Loss: 1.071 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9398391246795654
Epoch: 10, Steps: 18 | Train Loss: 0.401 Vali Loss: 1.352 Vali Acc: 0.510 Test Loss: 1.352 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7470641136169434
Epoch: 11, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.197 Vali Acc: 0.450 Test Loss: 1.197 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7160673141479492
Epoch: 12, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.387 Vali Acc: 0.440 Test Loss: 1.387 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.016932249069214
Epoch: 13, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.431 Vali Acc: 0.460 Test Loss: 1.431 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5454542636871338
Epoch: 14, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.252 Vali Acc: 0.490 Test Loss: 1.252 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps143_str143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 50348546
model size : 206.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.305286645889282
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 2.848627805709839
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.797 Vali Acc: 0.440 Test Loss: 0.797 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6633715629577637
Epoch: 3, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.806 Vali Acc: 0.530 Test Loss: 0.806 Test Acc: 0.530
Validation loss decreased (-0.469992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.8452694416046143
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7911136150360107
Epoch: 5, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.836 Vali Acc: 0.610 Test Loss: 0.836 Test Acc: 0.610
Validation loss decreased (-0.529992 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 2.625155210494995
Epoch: 6, Steps: 18 | Train Loss: 0.583 Vali Loss: 1.216 Vali Acc: 0.520 Test Loss: 1.216 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.772113084793091
Epoch: 7, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.895 Vali Acc: 0.520 Test Loss: 0.895 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.85248064994812
Epoch: 8, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.232 Vali Acc: 0.470 Test Loss: 1.232 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7961807250976562
Epoch: 9, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.243 Vali Acc: 0.470 Test Loss: 1.243 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.259247303009033
Epoch: 10, Steps: 18 | Train Loss: 0.633 Vali Loss: 1.026 Vali Acc: 0.450 Test Loss: 1.026 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7406818866729736
Epoch: 11, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7631618976593018
Epoch: 12, Steps: 18 | Train Loss: 0.500 Vali Loss: 1.330 Vali Acc: 0.540 Test Loss: 1.330 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.752056121826172
Epoch: 13, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.423 Vali Acc: 0.570 Test Loss: 1.423 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.566075325012207
Epoch: 14, Steps: 18 | Train Loss: 0.364 Vali Loss: 1.091 Vali Acc: 0.560 Test Loss: 1.091 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7538211345672607
Epoch: 15, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.222 Vali Acc: 0.580 Test Loss: 1.222 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 51552770
model size : 211.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7882425785064697
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.690 Vali Acc: 0.620 Test Loss: 0.690 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 1.9811511039733887
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.685 Vali Acc: 0.540 Test Loss: 0.685 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.266170024871826
Epoch: 3, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.705 Vali Acc: 0.640 Test Loss: 0.705 Test Acc: 0.640
Validation loss decreased (-0.619993 --> -0.639993).  Saving model ...
Epoch: 4 cost time: 2.085639476776123
Epoch: 4, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.371687889099121
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.690 Vali Acc: 0.580 Test Loss: 0.690 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.324000120162964
Epoch: 6, Steps: 18 | Train Loss: 0.681 Vali Loss: 1.018 Vali Acc: 0.490 Test Loss: 1.018 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.048165798187256
Epoch: 7, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6812355518341064
Epoch: 8, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.731 Vali Acc: 0.600 Test Loss: 0.731 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6760649681091309
Epoch: 9, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.186 Vali Acc: 0.540 Test Loss: 1.186 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.561251163482666
Epoch: 10, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.965 Vali Acc: 0.540 Test Loss: 0.965 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4676237106323242
Epoch: 11, Steps: 18 | Train Loss: 0.505 Vali Loss: 1.784 Vali Acc: 0.450 Test Loss: 1.784 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.523869276046753
Epoch: 12, Steps: 18 | Train Loss: 0.704 Vali Loss: 1.126 Vali Acc: 0.530 Test Loss: 1.126 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5583736896514893
Epoch: 13, Steps: 18 | Train Loss: 0.357 Vali Loss: 0.853 Vali Acc: 0.630 Test Loss: 0.853 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 51439106
model size : 210.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5815932750701904
Epoch: 1, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.7951910495758057
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.733292818069458
Epoch: 3, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 1.3683409690856934
Epoch: 4, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6986851692199707
Epoch: 5, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.995 Vali Acc: 0.490 Test Loss: 0.995 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.730691909790039
Epoch: 6, Steps: 18 | Train Loss: 0.533 Vali Loss: 1.169 Vali Acc: 0.460 Test Loss: 1.169 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6587646007537842
Epoch: 7, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.966 Vali Acc: 0.430 Test Loss: 0.966 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7183401584625244
Epoch: 8, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.052 Vali Acc: 0.520 Test Loss: 1.052 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.320061445236206
Epoch: 9, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.330 Vali Acc: 0.560 Test Loss: 1.330 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7936065196990967
Epoch: 10, Steps: 18 | Train Loss: 0.399 Vali Loss: 1.024 Vali Acc: 0.520 Test Loss: 1.024 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.733830213546753
Epoch: 11, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.766695499420166
Epoch: 12, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.196 Vali Acc: 0.530 Test Loss: 1.196 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6338832378387451
Epoch: 13, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.390 Vali Acc: 0.530 Test Loss: 1.390 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 51380738
model size : 210.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps158_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9589760303497314
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 0.680 Vali Acc: 0.620 Test Loss: 0.680 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 2.3670027256011963
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.867 Vali Acc: 0.500 Test Loss: 0.867 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2554314136505127
Epoch: 3, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.502002716064453
Epoch: 4, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.613670825958252
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.945 Vali Acc: 0.550 Test Loss: 0.945 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4163966178894043
Epoch: 6, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.546823024749756
Epoch: 7, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.781 Vali Acc: 0.580 Test Loss: 0.781 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.567399740219116
Epoch: 8, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.396 Vali Acc: 0.530 Test Loss: 1.396 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4870100021362305
Epoch: 9, Steps: 18 | Train Loss: 0.606 Vali Loss: 1.322 Vali Acc: 0.500 Test Loss: 1.322 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.277735710144043
Epoch: 10, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.951 Vali Acc: 0.500 Test Loss: 1.951 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4992637634277344
Epoch: 11, Steps: 18 | Train Loss: 0.530 Vali Loss: 1.232 Vali Acc: 0.520 Test Loss: 1.232 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps158_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 52720130
model size : 215.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps158_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.60943603515625
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.667 Vali Acc: 0.620 Test Loss: 0.667 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 2.123112916946411
Epoch: 2, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.679 Vali Acc: 0.620 Test Loss: 0.679 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.067378520965576
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9639818668365479
Epoch: 4, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.902076005935669
Epoch: 5, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.099844455718994
Epoch: 6, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.696 Vali Acc: 0.570 Test Loss: 0.696 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0661118030548096
Epoch: 7, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.875 Vali Acc: 0.600 Test Loss: 0.875 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0016093254089355
Epoch: 8, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.754 Vali Acc: 0.600 Test Loss: 0.754 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0485727787017822
Epoch: 9, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.947 Vali Acc: 0.530 Test Loss: 0.947 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9785890579223633
Epoch: 10, Steps: 18 | Train Loss: 0.551 Vali Loss: 1.348 Vali Acc: 0.540 Test Loss: 1.348 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9889779090881348
Epoch: 11, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.850 Vali Acc: 0.570 Test Loss: 0.850 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps158_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 52609538
model size : 215.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps158_str158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1487138271331787
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.5253379344940186
Epoch: 2, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.742 Vali Acc: 0.570 Test Loss: 0.742 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.4381916522979736
Epoch: 3, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7040462493896484
Epoch: 4, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5888922214508057
Epoch: 5, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.870 Vali Acc: 0.460 Test Loss: 0.870 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.733121633529663
Epoch: 6, Steps: 18 | Train Loss: 0.491 Vali Loss: 1.093 Vali Acc: 0.580 Test Loss: 1.093 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579989).  Saving model ...
Epoch: 7 cost time: 1.414884090423584
Epoch: 7, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.960 Vali Acc: 0.540 Test Loss: 0.960 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6203606128692627
Epoch: 8, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.990 Vali Acc: 0.560 Test Loss: 0.990 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4490222930908203
Epoch: 9, Steps: 18 | Train Loss: 0.417 Vali Loss: 1.045 Vali Acc: 0.580 Test Loss: 1.045 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579990).  Saving model ...
Epoch: 10 cost time: 1.7078869342803955
Epoch: 10, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.057 Vali Acc: 0.550 Test Loss: 1.057 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6891593933105469
Epoch: 11, Steps: 18 | Train Loss: 0.403 Vali Loss: 1.135 Vali Acc: 0.510 Test Loss: 1.135 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.612379550933838
Epoch: 12, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.963 Vali Acc: 0.530 Test Loss: 0.963 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7166476249694824
Epoch: 13, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.659 Vali Acc: 0.490 Test Loss: 1.659 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7120654582977295
Epoch: 14, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.422 Vali Acc: 0.530 Test Loss: 1.422 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.530778408050537
Epoch: 15, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.238 Vali Acc: 0.570 Test Loss: 1.238 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.674292802810669
Epoch: 16, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.828 Vali Acc: 0.580 Test Loss: 1.828 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7734568119049072
Epoch: 17, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.677 Vali Acc: 0.530 Test Loss: 1.677 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6173126697540283
Epoch: 18, Steps: 18 | Train Loss: 0.314 Vali Loss: 1.930 Vali Acc: 0.480 Test Loss: 1.930 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6470072269439697
Epoch: 19, Steps: 18 | Train Loss: 0.397 Vali Loss: 1.443 Vali Acc: 0.540 Test Loss: 1.443 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps158_str158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 52554242
model size : 215.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0022177696228027
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.8705577850341797
Epoch: 2, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.605756998062134
Epoch: 3, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.911 Vali Acc: 0.490 Test Loss: 0.911 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.442629337310791
Epoch: 4, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.833 Vali Acc: 0.560 Test Loss: 0.833 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 2.7025063037872314
Epoch: 5, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.664306402206421
Epoch: 6, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5221805572509766
Epoch: 7, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.477715492248535
Epoch: 8, Steps: 18 | Train Loss: 0.523 Vali Loss: 1.268 Vali Acc: 0.480 Test Loss: 1.268 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6451079845428467
Epoch: 9, Steps: 18 | Train Loss: 0.612 Vali Loss: 1.145 Vali Acc: 0.530 Test Loss: 1.145 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.799830198287964
Epoch: 10, Steps: 18 | Train Loss: 0.562 Vali Loss: 1.564 Vali Acc: 0.500 Test Loss: 1.564 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.441483497619629
Epoch: 11, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 2.82775616645813
Epoch: 12, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.436 Vali Acc: 0.460 Test Loss: 1.436 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5032455921173096
Epoch: 13, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.078 Vali Acc: 0.590 Test Loss: 1.078 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589989).  Saving model ...
Epoch: 14 cost time: 2.8581762313842773
Epoch: 14, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.241 Vali Acc: 0.540 Test Loss: 1.241 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.454684257507324
Epoch: 15, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.260 Vali Acc: 0.530 Test Loss: 1.260 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8878600597381592
Epoch: 16, Steps: 18 | Train Loss: 0.663 Vali Loss: 1.838 Vali Acc: 0.500 Test Loss: 1.838 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.755235195159912
Epoch: 17, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.149 Vali Acc: 0.530 Test Loss: 1.149 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.399099826812744
Epoch: 18, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.368 Vali Acc: 0.560 Test Loss: 1.368 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7397267818450928
Epoch: 19, Steps: 18 | Train Loss: 0.316 Vali Loss: 2.076 Vali Acc: 0.540 Test Loss: 2.076 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.643176794052124
Epoch: 20, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.832 Vali Acc: 0.480 Test Loss: 1.832 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.644909143447876
Epoch: 21, Steps: 18 | Train Loss: 0.387 Vali Loss: 2.017 Vali Acc: 0.580 Test Loss: 2.017 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5724029541015625
Epoch: 22, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.617 Vali Acc: 0.470 Test Loss: 1.617 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5875062942504883
Epoch: 23, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.398 Vali Acc: 0.580 Test Loss: 1.398 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 54034946
model size : 220.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4636518955230713
Epoch: 1, Steps: 18 | Train Loss: 0.810 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.0844740867614746
Epoch: 2, Steps: 18 | Train Loss: 0.688 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.4396753311157227
Epoch: 3, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2617740631103516
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1257665157318115
Epoch: 5, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1557044982910156
Epoch: 6, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.179138422012329
Epoch: 7, Steps: 18 | Train Loss: 0.465 Vali Loss: 1.015 Vali Acc: 0.520 Test Loss: 1.015 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3731377124786377
Epoch: 8, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.876 Vali Acc: 0.530 Test Loss: 0.876 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2712981700897217
Epoch: 9, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.900 Vali Acc: 0.560 Test Loss: 0.900 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559991).  Saving model ...
Epoch: 10 cost time: 2.4359679222106934
Epoch: 10, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.074 Vali Acc: 0.510 Test Loss: 1.074 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.11972975730896
Epoch: 11, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.150 Vali Acc: 0.510 Test Loss: 1.150 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4136595726013184
Epoch: 12, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.161 Vali Acc: 0.560 Test Loss: 1.161 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.215317726135254
Epoch: 13, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.331 Vali Acc: 0.570 Test Loss: 1.331 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569987).  Saving model ...
Epoch: 14 cost time: 2.4063353538513184
Epoch: 14, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.869 Vali Acc: 0.590 Test Loss: 1.869 Test Acc: 0.590
Validation loss decreased (-0.569987 --> -0.589981).  Saving model ...
Epoch: 15 cost time: 2.050776243209839
Epoch: 15, Steps: 18 | Train Loss: 0.295 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.589981 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 2.2087812423706055
Epoch: 16, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.304 Vali Acc: 0.610 Test Loss: 1.304 Test Acc: 0.610
Validation loss decreased (-0.599989 --> -0.609987).  Saving model ...
Epoch: 17 cost time: 2.355426549911499
Epoch: 17, Steps: 18 | Train Loss: 0.276 Vali Loss: 2.114 Vali Acc: 0.540 Test Loss: 2.114 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0311338901519775
Epoch: 18, Steps: 18 | Train Loss: 0.179 Vali Loss: 2.022 Vali Acc: 0.550 Test Loss: 2.022 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.309079647064209
Epoch: 19, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.942 Vali Acc: 0.560 Test Loss: 1.942 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2021069526672363
Epoch: 20, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.601 Vali Acc: 0.500 Test Loss: 1.601 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2977497577667236
Epoch: 21, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.800 Vali Acc: 0.550 Test Loss: 1.800 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3611621856689453
Epoch: 22, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.303 Vali Acc: 0.490 Test Loss: 2.303 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9338934421539307
Epoch: 23, Steps: 18 | Train Loss: 0.326 Vali Loss: 2.086 Vali Acc: 0.510 Test Loss: 2.086 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.364819049835205
Epoch: 24, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.191 Vali Acc: 0.560 Test Loss: 2.191 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6388306617736816
Epoch: 25, Steps: 18 | Train Loss: 0.103 Vali Loss: 2.162 Vali Acc: 0.570 Test Loss: 2.162 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6511259078979492
Epoch: 26, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.210 Vali Acc: 0.550 Test Loss: 2.210 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 53930498
model size : 220.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.303966522216797
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.689 Vali Acc: 0.580 Test Loss: 0.689 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.8476834297180176
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8819787502288818
Epoch: 3, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.706 Vali Acc: 0.570 Test Loss: 0.706 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6716172695159912
Epoch: 4, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9318406581878662
Epoch: 5, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.735 Vali Acc: 0.590 Test Loss: 0.735 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 1.853409767150879
Epoch: 6, Steps: 18 | Train Loss: 0.528 Vali Loss: 0.898 Vali Acc: 0.590 Test Loss: 0.898 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8132150173187256
Epoch: 7, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.004 Vali Acc: 0.520 Test Loss: 1.004 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.372100591659546
Epoch: 8, Steps: 18 | Train Loss: 0.417 Vali Loss: 1.086 Vali Acc: 0.610 Test Loss: 1.086 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609989).  Saving model ...
Epoch: 9 cost time: 1.7321043014526367
Epoch: 9, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.960 Vali Acc: 0.550 Test Loss: 0.960 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9220900535583496
Epoch: 10, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.268 Vali Acc: 0.590 Test Loss: 1.268 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8389949798583984
Epoch: 11, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.406 Vali Acc: 0.550 Test Loss: 1.406 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4854071140289307
Epoch: 12, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.372 Vali Acc: 0.450 Test Loss: 1.372 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8002073764801025
Epoch: 13, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.235 Vali Acc: 0.580 Test Loss: 1.235 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8035588264465332
Epoch: 14, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.215 Vali Acc: 0.530 Test Loss: 1.215 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6537790298461914
Epoch: 15, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.330 Vali Acc: 0.520 Test Loss: 1.330 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5902941226959229
Epoch: 16, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.707 Vali Acc: 0.580 Test Loss: 1.707 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9953720569610596
Epoch: 17, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.680 Vali Acc: 0.590 Test Loss: 1.680 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8083600997924805
Epoch: 18, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.958 Vali Acc: 0.610 Test Loss: 1.958 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 53878274
model size : 220.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps177_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.58211612701416
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.691030740737915
Epoch: 2, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.3934457302093506
Epoch: 3, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3124823570251465
Epoch: 4, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 2.418653726577759
Epoch: 5, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.839 Vali Acc: 0.450 Test Loss: 0.839 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.426564931869507
Epoch: 6, Steps: 18 | Train Loss: 0.579 Vali Loss: 1.131 Vali Acc: 0.430 Test Loss: 1.131 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4812421798706055
Epoch: 7, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4476852416992188
Epoch: 8, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.864 Vali Acc: 0.610 Test Loss: 0.864 Test Acc: 0.610
Validation loss decreased (-0.549992 --> -0.609991).  Saving model ...
Epoch: 9 cost time: 2.4736602306365967
Epoch: 9, Steps: 18 | Train Loss: 0.453 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3750338554382324
Epoch: 10, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.185 Vali Acc: 0.540 Test Loss: 1.185 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2570571899414062
Epoch: 11, Steps: 18 | Train Loss: 0.437 Vali Loss: 1.248 Vali Acc: 0.530 Test Loss: 1.248 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2195210456848145
Epoch: 12, Steps: 18 | Train Loss: 0.530 Vali Loss: 1.140 Vali Acc: 0.510 Test Loss: 1.140 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3704135417938232
Epoch: 13, Steps: 18 | Train Loss: 0.348 Vali Loss: 2.169 Vali Acc: 0.480 Test Loss: 2.169 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2687222957611084
Epoch: 14, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.420 Vali Acc: 0.550 Test Loss: 1.420 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4642035961151123
Epoch: 15, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.399 Vali Acc: 0.510 Test Loss: 1.399 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4252967834472656
Epoch: 16, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.063 Vali Acc: 0.570 Test Loss: 1.063 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.374218702316284
Epoch: 17, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.362 Vali Acc: 0.590 Test Loss: 1.362 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3481671810150146
Epoch: 18, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.456 Vali Acc: 0.490 Test Loss: 1.456 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps177_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 55494146
model size : 226.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps177_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.630202054977417
Epoch: 1, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.8617496490478516
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.6166586875915527
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.072936534881592
Epoch: 4, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.702620267868042
Epoch: 5, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 1.874840259552002
Epoch: 6, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7863531112670898
Epoch: 7, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1062965393066406
Epoch: 8, Steps: 18 | Train Loss: 0.456 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.825120449066162
Epoch: 9, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.288 Vali Acc: 0.530 Test Loss: 1.288 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7596635818481445
Epoch: 10, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.048 Vali Acc: 0.550 Test Loss: 1.048 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8493647575378418
Epoch: 11, Steps: 18 | Train Loss: 0.408 Vali Loss: 1.304 Vali Acc: 0.570 Test Loss: 1.304 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569987).  Saving model ...
Epoch: 12 cost time: 1.7999298572540283
Epoch: 12, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.386 Vali Acc: 0.490 Test Loss: 1.386 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.77915620803833
Epoch: 13, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.668 Vali Acc: 0.450 Test Loss: 1.668 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.103590250015259
Epoch: 14, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8685944080352783
Epoch: 15, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.560 Vali Acc: 0.470 Test Loss: 1.560 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9219920635223389
Epoch: 16, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.254 Vali Acc: 0.520 Test Loss: 1.254 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9653096199035645
Epoch: 17, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.511 Vali Acc: 0.440 Test Loss: 1.511 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.79836106300354
Epoch: 18, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.688 Vali Acc: 0.460 Test Loss: 1.688 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1456055641174316
Epoch: 19, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.625 Vali Acc: 0.500 Test Loss: 1.625 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9431500434875488
Epoch: 20, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.968 Vali Acc: 0.530 Test Loss: 1.968 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9131858348846436
Epoch: 21, Steps: 18 | Train Loss: 0.234 Vali Loss: 2.032 Vali Acc: 0.500 Test Loss: 2.032 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps177_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 55398914
model size : 226.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps177_str177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2062432765960693
Epoch: 1, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.9078848361968994
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.6184372901916504
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.748 Vali Acc: 0.460 Test Loss: 0.748 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6026408672332764
Epoch: 4, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5156638622283936
Epoch: 5, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.743 Vali Acc: 0.570 Test Loss: 0.743 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.5490949153900146
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4255051612854004
Epoch: 7, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4280836582183838
Epoch: 8, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.435518741607666
Epoch: 9, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.462357997894287
Epoch: 10, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.854 Vali Acc: 0.530 Test Loss: 0.854 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4661612510681152
Epoch: 11, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 12 cost time: 1.9506309032440186
Epoch: 12, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.887 Vali Acc: 0.590 Test Loss: 0.887 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4657697677612305
Epoch: 13, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.990 Vali Acc: 0.530 Test Loss: 0.990 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0122835636138916
Epoch: 14, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7142069339752197
Epoch: 15, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.057 Vali Acc: 0.540 Test Loss: 1.057 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.420121669769287
Epoch: 16, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.395 Vali Acc: 0.490 Test Loss: 1.395 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9758689403533936
Epoch: 17, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.354 Vali Acc: 0.550 Test Loss: 1.354 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.060870409011841
Epoch: 18, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.113 Vali Acc: 0.530 Test Loss: 1.113 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.046297073364258
Epoch: 19, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0079333782196045
Epoch: 20, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.421 Vali Acc: 0.540 Test Loss: 1.421 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9235076904296875
Epoch: 21, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.355 Vali Acc: 0.570 Test Loss: 1.355 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps177_str177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 55349762
model size : 225.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps188_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8931236267089844
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.762 Vali Acc: 0.450 Test Loss: 0.762 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.677990436553955
Epoch: 2, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.721 Vali Acc: 0.630 Test Loss: 0.721 Test Acc: 0.630
Validation loss decreased (-0.449992 --> -0.629993).  Saving model ...
Epoch: 3 cost time: 1.8263685703277588
Epoch: 3, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.716 Vali Acc: 0.610 Test Loss: 0.716 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.413761615753174
Epoch: 4, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.467445135116577
Epoch: 5, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.849 Vali Acc: 0.510 Test Loss: 0.849 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3824868202209473
Epoch: 6, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.738 Vali Acc: 0.570 Test Loss: 0.738 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.35246205329895
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.009 Vali Acc: 0.570 Test Loss: 1.009 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3269221782684326
Epoch: 8, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.449 Vali Acc: 0.500 Test Loss: 1.449 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.469062328338623
Epoch: 9, Steps: 18 | Train Loss: 0.719 Vali Loss: 1.186 Vali Acc: 0.570 Test Loss: 1.186 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.403040885925293
Epoch: 10, Steps: 18 | Train Loss: 0.679 Vali Loss: 2.317 Vali Acc: 0.570 Test Loss: 2.317 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.709717035293579
Epoch: 11, Steps: 18 | Train Loss: 0.491 Vali Loss: 0.917 Vali Acc: 0.480 Test Loss: 0.917 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4166886806488037
Epoch: 12, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.255 Vali Acc: 0.540 Test Loss: 1.255 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps188_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 57106946
model size : 232.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.426039934158325
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.676 Vali Acc: 0.560 Test Loss: 0.676 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.231663942337036
Epoch: 2, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0173466205596924
Epoch: 3, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9593918323516846
Epoch: 4, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2198262214660645
Epoch: 5, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.857 Vali Acc: 0.470 Test Loss: 0.857 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.176691770553589
Epoch: 6, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.855 Vali Acc: 0.530 Test Loss: 0.855 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0424983501434326
Epoch: 7, Steps: 18 | Train Loss: 0.398 Vali Loss: 0.881 Vali Acc: 0.510 Test Loss: 0.881 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2337405681610107
Epoch: 8, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.908 Vali Acc: 0.550 Test Loss: 0.908 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1715924739837646
Epoch: 9, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.640587329864502
Epoch: 10, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.912 Vali Acc: 0.480 Test Loss: 0.912 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2492129802703857
Epoch: 11, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.113 Vali Acc: 0.530 Test Loss: 1.113 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 57014786
model size : 232.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps188_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3950412273406982
Epoch: 1, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.9719517230987549
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.679 Vali Acc: 0.600 Test Loss: 0.679 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 1.9743640422821045
Epoch: 3, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9945180416107178
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.714 Vali Acc: 0.580 Test Loss: 0.714 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8382728099822998
Epoch: 5, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.713 Vali Acc: 0.600 Test Loss: 0.713 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8856687545776367
Epoch: 6, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.938678503036499
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.836 Vali Acc: 0.500 Test Loss: 0.836 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5629918575286865
Epoch: 8, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.956 Vali Acc: 0.560 Test Loss: 0.956 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4687962532043457
Epoch: 9, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5589356422424316
Epoch: 10, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.961 Vali Acc: 0.520 Test Loss: 0.961 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4638221263885498
Epoch: 11, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.985 Vali Acc: 0.510 Test Loss: 0.985 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6509013175964355
Epoch: 12, Steps: 18 | Train Loss: 0.335 Vali Loss: 0.991 Vali Acc: 0.470 Test Loss: 0.991 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps188_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 56968706
model size : 231.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7590975761413574
Epoch: 1, Steps: 18 | Train Loss: 0.780 Vali Loss: 0.704 Vali Acc: 0.560 Test Loss: 0.704 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.274045944213867
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4063022136688232
Epoch: 3, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.350229024887085
Epoch: 4, Steps: 18 | Train Loss: 0.667 Vali Loss: 1.120 Vali Acc: 0.510 Test Loss: 1.120 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.509019613265991
Epoch: 5, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.949744462966919
Epoch: 6, Steps: 18 | Train Loss: 0.600 Vali Loss: 1.148 Vali Acc: 0.470 Test Loss: 1.148 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.302767276763916
Epoch: 7, Steps: 18 | Train Loss: 0.614 Vali Loss: 1.023 Vali Acc: 0.470 Test Loss: 1.023 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5157148838043213
Epoch: 8, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3854174613952637
Epoch: 9, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4858009815216064
Epoch: 10, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.3150475025177
Epoch: 11, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.618 Vali Acc: 0.510 Test Loss: 1.618 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 58867202
model size : 239.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9010701179504395
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.775 Vali Acc: 0.440 Test Loss: 0.775 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.0111889839172363
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (-0.439992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.912771463394165
Epoch: 3, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.683 Vali Acc: 0.610 Test Loss: 0.683 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 2.0406079292297363
Epoch: 4, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.691 Vali Acc: 0.610 Test Loss: 0.691 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.075932741165161
Epoch: 5, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.755 Vali Acc: 0.600 Test Loss: 0.755 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0877912044525146
Epoch: 6, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.894 Vali Acc: 0.530 Test Loss: 0.894 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.096438407897949
Epoch: 7, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.892 Vali Acc: 0.520 Test Loss: 0.892 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1576645374298096
Epoch: 8, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0648114681243896
Epoch: 9, Steps: 18 | Train Loss: 0.552 Vali Loss: 1.000 Vali Acc: 0.520 Test Loss: 1.000 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1941211223602295
Epoch: 10, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.135796070098877
Epoch: 11, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.559 Vali Acc: 0.530 Test Loss: 1.559 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1157374382019043
Epoch: 12, Steps: 18 | Train Loss: 0.432 Vali Loss: 1.488 Vali Acc: 0.540 Test Loss: 1.488 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6577539443969727
Epoch: 13, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.196 Vali Acc: 0.530 Test Loss: 1.196 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 58781186
model size : 238.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.39351487159729
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.91666841506958
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9128763675689697
Epoch: 3, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.8667020797729492
Epoch: 4, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.781 Vali Acc: 0.580 Test Loss: 0.781 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.8873906135559082
Epoch: 5, Steps: 18 | Train Loss: 0.564 Vali Loss: 1.032 Vali Acc: 0.490 Test Loss: 1.032 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.783799648284912
Epoch: 6, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8255949020385742
Epoch: 7, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.003 Vali Acc: 0.470 Test Loss: 1.003 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.502737283706665
Epoch: 8, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.902 Vali Acc: 0.580 Test Loss: 0.902 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4176125526428223
Epoch: 9, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.898 Vali Acc: 0.550 Test Loss: 0.898 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.499361515045166
Epoch: 10, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.011 Vali Acc: 0.480 Test Loss: 1.011 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5617177486419678
Epoch: 11, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.038 Vali Acc: 0.550 Test Loss: 1.038 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.901778221130371
Epoch: 12, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.154 Vali Acc: 0.490 Test Loss: 1.154 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.727348804473877
Epoch: 13, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.176 Vali Acc: 0.520 Test Loss: 1.176 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7755053043365479
Epoch: 14, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.331 Vali Acc: 0.490 Test Loss: 1.331 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 58738178
model size : 238.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps215_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.660909414291382
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 0.707 Vali Acc: 0.570 Test Loss: 0.707 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.219444751739502
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.109715700149536
Epoch: 3, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1805994510650635
Epoch: 4, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3916172981262207
Epoch: 5, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.755 Vali Acc: 0.600 Test Loss: 0.755 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.4109818935394287
Epoch: 6, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.883 Vali Acc: 0.510 Test Loss: 0.883 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0087156295776367
Epoch: 7, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.024501085281372
Epoch: 8, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.330 Vali Acc: 0.450 Test Loss: 1.330 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.56889271736145
Epoch: 9, Steps: 18 | Train Loss: 0.495 Vali Loss: 1.490 Vali Acc: 0.520 Test Loss: 1.490 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1786177158355713
Epoch: 10, Steps: 18 | Train Loss: 0.377 Vali Loss: 2.164 Vali Acc: 0.450 Test Loss: 2.164 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2400918006896973
Epoch: 11, Steps: 18 | Train Loss: 0.491 Vali Loss: 1.162 Vali Acc: 0.460 Test Loss: 1.162 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2647616863250732
Epoch: 12, Steps: 18 | Train Loss: 0.417 Vali Loss: 2.083 Vali Acc: 0.460 Test Loss: 2.083 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.144038677215576
Epoch: 13, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.296 Vali Acc: 0.510 Test Loss: 1.296 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3098502159118652
Epoch: 14, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.052 Vali Acc: 0.560 Test Loss: 1.052 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8676140308380127
Epoch: 15, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.092 Vali Acc: 0.540 Test Loss: 1.092 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps215_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 61063682
model size : 247.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps215_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.179047107696533
Epoch: 1, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.685 Vali Acc: 0.540 Test Loss: 0.685 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.7816414833068848
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.914 Vali Acc: 0.530 Test Loss: 0.914 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0706279277801514
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.817 Vali Acc: 0.410 Test Loss: 0.817 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.858069658279419
Epoch: 4, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.712 Vali Acc: 0.560 Test Loss: 0.712 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 1.8796532154083252
Epoch: 5, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.574303388595581
Epoch: 6, Steps: 18 | Train Loss: 0.495 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5736913681030273
Epoch: 7, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.856 Vali Acc: 0.550 Test Loss: 0.856 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5078766345977783
Epoch: 8, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.967 Vali Acc: 0.550 Test Loss: 0.967 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4899141788482666
Epoch: 9, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.972 Vali Acc: 0.530 Test Loss: 0.972 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.205684185028076
Epoch: 10, Steps: 18 | Train Loss: 0.588 Vali Loss: 1.394 Vali Acc: 0.520 Test Loss: 1.394 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2328097820281982
Epoch: 11, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.080 Vali Acc: 0.520 Test Loss: 1.080 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6763591766357422
Epoch: 12, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.094 Vali Acc: 0.510 Test Loss: 1.094 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2065188884735107
Epoch: 13, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.189 Vali Acc: 0.450 Test Loss: 1.189 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.035609245300293
Epoch: 14, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.983 Vali Acc: 0.470 Test Loss: 1.983 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps215_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 60983810
model size : 247.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps215_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.251832962036133
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.1230454444885254
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (-0.449993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.784512996673584
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.790 Vali Acc: 0.570 Test Loss: 0.790 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 1.9782929420471191
Epoch: 4, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.095745086669922
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.886 Vali Acc: 0.480 Test Loss: 0.886 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.106823444366455
Epoch: 6, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.06720232963562
Epoch: 7, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.017 Vali Acc: 0.490 Test Loss: 1.017 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9766719341278076
Epoch: 8, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.051 Vali Acc: 0.540 Test Loss: 1.051 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0726664066314697
Epoch: 9, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.047 Vali Acc: 0.480 Test Loss: 1.047 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0141923427581787
Epoch: 10, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.223 Vali Acc: 0.490 Test Loss: 1.223 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9115657806396484
Epoch: 11, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.182 Vali Acc: 0.530 Test Loss: 1.182 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9817450046539307
Epoch: 12, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1389358043670654
Epoch: 13, Steps: 18 | Train Loss: 0.318 Vali Loss: 2.013 Vali Acc: 0.420 Test Loss: 2.013 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps215_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 60943874
model size : 247.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.849874258041382
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.5377838611602783
Epoch: 2, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.6411149501800537
Epoch: 3, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6659719944000244
Epoch: 4, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.931 Vali Acc: 0.470 Test Loss: 0.931 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.556105136871338
Epoch: 5, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5920259952545166
Epoch: 6, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6523327827453613
Epoch: 7, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.786 Vali Acc: 0.580 Test Loss: 0.786 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 2.7596445083618164
Epoch: 8, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599991).  Saving model ...
Epoch: 9 cost time: 2.788118839263916
Epoch: 9, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.254 Vali Acc: 0.490 Test Loss: 1.254 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5349607467651367
Epoch: 10, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.104 Vali Acc: 0.530 Test Loss: 1.104 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7804038524627686
Epoch: 11, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.981 Vali Acc: 0.560 Test Loss: 0.981 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4148285388946533
Epoch: 12, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.859 Vali Acc: 0.580 Test Loss: 0.859 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6740477085113525
Epoch: 13, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.082 Vali Acc: 0.530 Test Loss: 1.082 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.470606803894043
Epoch: 14, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.646 Vali Acc: 0.530 Test Loss: 1.646 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.074784517288208
Epoch: 15, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.292 Vali Acc: 0.560 Test Loss: 1.292 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.480320930480957
Epoch: 16, Steps: 18 | Train Loss: 0.424 Vali Loss: 1.026 Vali Acc: 0.550 Test Loss: 1.026 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4460363388061523
Epoch: 17, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.132 Vali Acc: 0.570 Test Loss: 1.132 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.50895619392395
Epoch: 18, Steps: 18 | Train Loss: 0.189 Vali Loss: 2.055 Vali Acc: 0.550 Test Loss: 2.055 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 63410690
model size : 256.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5353000164031982
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.675 Vali Acc: 0.570 Test Loss: 0.675 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.2891435623168945
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.730 Vali Acc: 0.430 Test Loss: 0.730 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.044403314590454
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1922740936279297
Epoch: 4, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.945 Vali Acc: 0.530 Test Loss: 0.945 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.328383684158325
Epoch: 5, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.741 Vali Acc: 0.580 Test Loss: 0.741 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 2.352644681930542
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.817 Vali Acc: 0.600 Test Loss: 0.817 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 2.3721914291381836
Epoch: 7, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0675551891326904
Epoch: 8, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.091362714767456
Epoch: 9, Steps: 18 | Train Loss: 0.395 Vali Loss: 0.920 Vali Acc: 0.520 Test Loss: 0.920 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7563068866729736
Epoch: 10, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6263227462768555
Epoch: 11, Steps: 18 | Train Loss: 0.342 Vali Loss: 0.907 Vali Acc: 0.590 Test Loss: 0.907 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6338956356048584
Epoch: 12, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.271 Vali Acc: 0.520 Test Loss: 1.271 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6309499740600586
Epoch: 13, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.048 Vali Acc: 0.520 Test Loss: 1.048 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.997666835784912
Epoch: 14, Steps: 18 | Train Loss: 0.269 Vali Loss: 1.269 Vali Acc: 0.560 Test Loss: 1.269 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9066252708435059
Epoch: 15, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.518 Vali Acc: 0.520 Test Loss: 1.518 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0239405632019043
Epoch: 16, Steps: 18 | Train Loss: 0.403 Vali Loss: 1.529 Vali Acc: 0.530 Test Loss: 1.529 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 63336962
model size : 256.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1673998832702637
Epoch: 1, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.938614845275879
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.9122397899627686
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.723 Vali Acc: 0.530 Test Loss: 0.723 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.9780375957489014
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9796502590179443
Epoch: 5, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.873917579650879
Epoch: 6, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.009 Vali Acc: 0.460 Test Loss: 1.009 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7693912982940674
Epoch: 7, Steps: 18 | Train Loss: 0.462 Vali Loss: 0.956 Vali Acc: 0.460 Test Loss: 0.956 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8549163341522217
Epoch: 8, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.923 Vali Acc: 0.500 Test Loss: 0.923 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7992644309997559
Epoch: 9, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.107 Vali Acc: 0.460 Test Loss: 1.107 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9522764682769775
Epoch: 10, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.035 Vali Acc: 0.490 Test Loss: 1.035 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5694618225097656
Epoch: 11, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.211 Vali Acc: 0.480 Test Loss: 1.211 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9917991161346436
Epoch: 12, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.368 Vali Acc: 0.480 Test Loss: 1.368 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8569865226745605
Epoch: 13, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.947 Vali Acc: 0.570 Test Loss: 0.947 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569991).  Saving model ...
Epoch: 14 cost time: 1.9043450355529785
Epoch: 14, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0055091381073
Epoch: 15, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.296 Vali Acc: 0.560 Test Loss: 1.296 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.053555488586426
Epoch: 16, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.116 Vali Acc: 0.490 Test Loss: 1.116 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9443635940551758
Epoch: 17, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.342 Vali Acc: 0.500 Test Loss: 1.342 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8852131366729736
Epoch: 18, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.508 Vali Acc: 0.490 Test Loss: 1.508 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9877095222473145
Epoch: 19, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.429 Vali Acc: 0.510 Test Loss: 1.429 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.018105983734131
Epoch: 20, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.752 Vali Acc: 0.530 Test Loss: 1.752 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9001047611236572
Epoch: 21, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.274 Vali Acc: 0.450 Test Loss: 1.274 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.897827386856079
Epoch: 22, Steps: 18 | Train Loss: 0.184 Vali Loss: 2.012 Vali Acc: 0.520 Test Loss: 2.012 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9127652645111084
Epoch: 23, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.362 Vali Acc: 0.590 Test Loss: 1.362 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589986).  Saving model ...
Epoch: 24 cost time: 1.94858980178833
Epoch: 24, Steps: 18 | Train Loss: 0.092 Vali Loss: 2.075 Vali Acc: 0.510 Test Loss: 2.075 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5478997230529785
Epoch: 25, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.370 Vali Acc: 0.540 Test Loss: 1.370 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9021131992340088
Epoch: 26, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.307 Vali Acc: 0.530 Test Loss: 1.307 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8885371685028076
Epoch: 27, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.808 Vali Acc: 0.490 Test Loss: 1.808 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0445799827575684
Epoch: 28, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.517 Vali Acc: 0.510 Test Loss: 1.517 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0084383487701416
Epoch: 29, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.876 Vali Acc: 0.500 Test Loss: 1.876 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8711926937103271
Epoch: 30, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.049 Vali Acc: 0.480 Test Loss: 2.049 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8102984428405762
Epoch: 31, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.878 Vali Acc: 0.510 Test Loss: 1.878 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8932700157165527
Epoch: 32, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.034 Vali Acc: 0.490 Test Loss: 2.034 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8819303512573242
Epoch: 33, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.003 Vali Acc: 0.510 Test Loss: 2.003 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 63300098
model size : 256.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.957385540008545
Epoch: 1, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.887 Vali Acc: 0.410 Test Loss: 0.887 Test Acc: 0.410
Validation loss decreased (inf --> -0.409991).  Saving model ...
Epoch: 2 cost time: 2.322934627532959
Epoch: 2, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.741 Vali Acc: 0.430 Test Loss: 0.741 Test Acc: 0.430
Validation loss decreased (-0.409991 --> -0.429993).  Saving model ...
Epoch: 3 cost time: 2.289330005645752
Epoch: 3, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.783 Vali Acc: 0.470 Test Loss: 0.783 Test Acc: 0.470
Validation loss decreased (-0.429993 --> -0.469992).  Saving model ...
Epoch: 4 cost time: 2.6464552879333496
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.045849323272705
Epoch: 5, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.905 Vali Acc: 0.490 Test Loss: 0.905 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0138072967529297
Epoch: 6, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.805 Vali Acc: 0.570 Test Loss: 0.805 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 1.8760647773742676
Epoch: 7, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.874 Vali Acc: 0.560 Test Loss: 0.874 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.217972993850708
Epoch: 8, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.968 Vali Acc: 0.620 Test Loss: 0.968 Test Acc: 0.620
Validation loss decreased (-0.569992 --> -0.619990).  Saving model ...
Epoch: 9 cost time: 2.3665807247161865
Epoch: 9, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.167224168777466
Epoch: 10, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.093 Vali Acc: 0.510 Test Loss: 1.093 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7806427478790283
Epoch: 11, Steps: 18 | Train Loss: 0.401 Vali Loss: 1.793 Vali Acc: 0.470 Test Loss: 1.793 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.434741973876953
Epoch: 12, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.362 Vali Acc: 0.480 Test Loss: 1.362 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8454029560089111
Epoch: 13, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.449 Vali Acc: 0.460 Test Loss: 1.449 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1712143421173096
Epoch: 14, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.800 Vali Acc: 0.530 Test Loss: 1.800 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9281611442565918
Epoch: 15, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.457 Vali Acc: 0.470 Test Loss: 1.457 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3430957794189453
Epoch: 16, Steps: 18 | Train Loss: 0.318 Vali Loss: 2.533 Vali Acc: 0.520 Test Loss: 2.533 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9639227390289307
Epoch: 17, Steps: 18 | Train Loss: 0.258 Vali Loss: 2.129 Vali Acc: 0.550 Test Loss: 2.129 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2071712017059326
Epoch: 18, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.876 Vali Acc: 0.450 Test Loss: 1.876 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 66200066
model size : 267.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.399035692214966
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.694 Vali Acc: 0.610 Test Loss: 0.694 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.9502675533294678
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.818 Vali Acc: 0.420 Test Loss: 0.818 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0455355644226074
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9528324604034424
Epoch: 4, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.096569061279297
Epoch: 5, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.976 Vali Acc: 0.500 Test Loss: 0.976 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9644293785095215
Epoch: 6, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.895630121231079
Epoch: 7, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.759 Vali Acc: 0.570 Test Loss: 0.759 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.077556610107422
Epoch: 8, Steps: 18 | Train Loss: 0.491 Vali Loss: 1.448 Vali Acc: 0.500 Test Loss: 1.448 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.951047658920288
Epoch: 9, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.090 Vali Acc: 0.440 Test Loss: 1.090 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.001725673675537
Epoch: 10, Steps: 18 | Train Loss: 0.362 Vali Loss: 0.959 Vali Acc: 0.520 Test Loss: 0.959 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.135039806365967
Epoch: 11, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.513 Vali Acc: 0.510 Test Loss: 1.513 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 66135554
model size : 266.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2503390312194824
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.681 Vali Acc: 0.640 Test Loss: 0.681 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 1.8052372932434082
Epoch: 2, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.664 Vali Acc: 0.550 Test Loss: 0.664 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2930874824523926
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3348581790924072
Epoch: 4, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.251540184020996
Epoch: 5, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.893 Vali Acc: 0.520 Test Loss: 0.893 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1934139728546143
Epoch: 6, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.935 Vali Acc: 0.460 Test Loss: 0.935 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0880541801452637
Epoch: 7, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.900 Vali Acc: 0.490 Test Loss: 0.900 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1342995166778564
Epoch: 8, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.010 Vali Acc: 0.460 Test Loss: 1.010 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.770853042602539
Epoch: 9, Steps: 18 | Train Loss: 0.514 Vali Loss: 1.204 Vali Acc: 0.410 Test Loss: 1.204 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.305046319961548
Epoch: 10, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.380 Vali Acc: 0.480 Test Loss: 1.380 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.172666072845459
Epoch: 11, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.062 Vali Acc: 0.510 Test Loss: 1.062 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 66101762
model size : 266.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps273_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.005807161331177
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.768 Vali Acc: 0.440 Test Loss: 0.768 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.800363779067993
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
Validation loss decreased (-0.439992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.7480270862579346
Epoch: 3, Steps: 18 | Train Loss: 0.640 Vali Loss: 1.059 Vali Acc: 0.500 Test Loss: 1.059 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.60553240776062
Epoch: 4, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8837692737579346
Epoch: 5, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569991).  Saving model ...
Epoch: 6 cost time: 2.55422306060791
Epoch: 6, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.850 Vali Acc: 0.560 Test Loss: 0.850 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6962058544158936
Epoch: 7, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.796 Vali Acc: 0.600 Test Loss: 0.796 Test Acc: 0.600
Validation loss decreased (-0.569991 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 2.773343324661255
Epoch: 8, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.870 Vali Acc: 0.590 Test Loss: 0.870 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6877849102020264
Epoch: 9, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.659 Vali Acc: 0.500 Test Loss: 1.659 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8464574813842773
Epoch: 10, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.396 Vali Acc: 0.540 Test Loss: 1.396 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.622964859008789
Epoch: 11, Steps: 18 | Train Loss: 0.485 Vali Loss: 1.577 Vali Acc: 0.470 Test Loss: 1.577 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.839548349380493
Epoch: 12, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.774 Vali Acc: 0.530 Test Loss: 1.774 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7881381511688232
Epoch: 13, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.432 Vali Acc: 0.550 Test Loss: 1.432 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8791465759277344
Epoch: 14, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.428 Vali Acc: 0.540 Test Loss: 1.428 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.601203680038452
Epoch: 15, Steps: 18 | Train Loss: 0.309 Vali Loss: 2.112 Vali Acc: 0.430 Test Loss: 2.112 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.854633331298828
Epoch: 16, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.661 Vali Acc: 0.560 Test Loss: 1.661 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.586644172668457
Epoch: 17, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.322 Vali Acc: 0.540 Test Loss: 2.322 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps273_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 69579266
model size : 280.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps273_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1565823554992676
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.690 Vali Acc: 0.480 Test Loss: 0.690 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.7459826469421387
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.650 Vali Acc: 0.600 Test Loss: 0.650 Test Acc: 0.600
Validation loss decreased (-0.479993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 2.2376294136047363
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8412108421325684
Epoch: 4, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.736 Vali Acc: 0.620 Test Loss: 0.736 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619993).  Saving model ...
Epoch: 5 cost time: 1.9659178256988525
Epoch: 5, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.791 Vali Acc: 0.580 Test Loss: 0.791 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1021981239318848
Epoch: 6, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1599390506744385
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.090480327606201
Epoch: 8, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.235 Vali Acc: 0.490 Test Loss: 1.235 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1863467693328857
Epoch: 9, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.313 Vali Acc: 0.490 Test Loss: 1.313 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1055984497070312
Epoch: 10, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.569 Vali Acc: 0.540 Test Loss: 1.569 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.357874870300293
Epoch: 11, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.086 Vali Acc: 0.480 Test Loss: 1.086 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1456356048583984
Epoch: 12, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.409 Vali Acc: 0.520 Test Loss: 1.409 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0667998790740967
Epoch: 13, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.762 Vali Acc: 0.550 Test Loss: 1.762 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8041269779205322
Epoch: 14, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.980 Vali Acc: 0.510 Test Loss: 0.980 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps273_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 69517826
model size : 279.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps273_str273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.498189926147461
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.714 Vali Acc: 0.450 Test Loss: 0.714 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.062781810760498
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
Validation loss decreased (-0.449993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.008794069290161
Epoch: 3, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 1.9871768951416016
Epoch: 4, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 2.0607314109802246
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.078052520751953
Epoch: 6, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0243701934814453
Epoch: 7, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.950 Vali Acc: 0.570 Test Loss: 0.950 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9993464946746826
Epoch: 8, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7000422477722168
Epoch: 9, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0225579738616943
Epoch: 10, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.976 Vali Acc: 0.590 Test Loss: 0.976 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589990).  Saving model ...
Epoch: 11 cost time: 1.979264497756958
Epoch: 11, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.889 Vali Acc: 0.590 Test Loss: 0.889 Test Acc: 0.590
Validation loss decreased (-0.589990 --> -0.589991).  Saving model ...
Epoch: 12 cost time: 2.110185384750366
Epoch: 12, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.902 Vali Acc: 0.580 Test Loss: 0.902 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1006693840026855
Epoch: 13, Steps: 18 | Train Loss: 0.263 Vali Loss: 0.969 Vali Acc: 0.590 Test Loss: 0.969 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9516246318817139
Epoch: 14, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.632 Vali Acc: 0.580 Test Loss: 1.632 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2219479084014893
Epoch: 15, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.105 Vali Acc: 0.610 Test Loss: 1.105 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609989).  Saving model ...
Epoch: 16 cost time: 1.899960994720459
Epoch: 16, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.064 Vali Acc: 0.560 Test Loss: 1.064 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.04380464553833
Epoch: 17, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.165 Vali Acc: 0.520 Test Loss: 1.165 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0015125274658203
Epoch: 18, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9207725524902344
Epoch: 19, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.324 Vali Acc: 0.520 Test Loss: 1.324 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.050133228302002
Epoch: 20, Steps: 18 | Train Loss: 0.161 Vali Loss: 1.262 Vali Acc: 0.560 Test Loss: 1.262 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0969552993774414
Epoch: 21, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.483 Vali Acc: 0.530 Test Loss: 1.483 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0368661880493164
Epoch: 22, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8915886878967285
Epoch: 23, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.306 Vali Acc: 0.560 Test Loss: 1.306 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1816246509552
Epoch: 24, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.776 Vali Acc: 0.510 Test Loss: 1.776 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1297624111175537
Epoch: 25, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.516 Vali Acc: 0.550 Test Loss: 1.516 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps273_str273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 69487106
model size : 279.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps300_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.810136556625366
Epoch: 1, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.451259136199951
Epoch: 2, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.745 Vali Acc: 0.590 Test Loss: 0.745 Test Acc: 0.590
Validation loss decreased (-0.509993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.397538423538208
Epoch: 3, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9373400211334229
Epoch: 4, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.858 Vali Acc: 0.460 Test Loss: 0.858 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3886845111846924
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.713 Vali Acc: 0.600 Test Loss: 0.713 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 2.2844178676605225
Epoch: 6, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0933258533477783
Epoch: 7, Steps: 18 | Train Loss: 0.577 Vali Loss: 1.038 Vali Acc: 0.540 Test Loss: 1.038 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.465275287628174
Epoch: 8, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3722646236419678
Epoch: 9, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.118 Vali Acc: 0.560 Test Loss: 1.118 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6989707946777344
Epoch: 10, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.227 Vali Acc: 0.530 Test Loss: 1.227 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2777700424194336
Epoch: 11, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.027 Vali Acc: 0.520 Test Loss: 1.027 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.400688886642456
Epoch: 12, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.381 Vali Acc: 0.480 Test Loss: 1.381 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7144155502319336
Epoch: 13, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.225 Vali Acc: 0.480 Test Loss: 1.225 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2521700859069824
Epoch: 14, Steps: 18 | Train Loss: 0.403 Vali Loss: 1.121 Vali Acc: 0.540 Test Loss: 1.121 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5624449253082275
Epoch: 15, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.816 Vali Acc: 0.470 Test Loss: 1.816 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps300_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 73551362
model size : 295.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.503559112548828
Epoch: 1, Steps: 18 | Train Loss: 0.800 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.3002395629882812
Epoch: 2, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.679 Vali Acc: 0.560 Test Loss: 0.679 Test Acc: 0.560
Validation loss decreased (-0.479993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.1330885887145996
Epoch: 3, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.691 Vali Acc: 0.600 Test Loss: 0.691 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 2.2829196453094482
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.159393548965454
Epoch: 5, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1226325035095215
Epoch: 6, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.797 Vali Acc: 0.570 Test Loss: 0.797 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1510660648345947
Epoch: 7, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8958041667938232
Epoch: 8, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8041749000549316
Epoch: 9, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.098 Vali Acc: 0.570 Test Loss: 1.098 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8136255741119385
Epoch: 10, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.912 Vali Acc: 0.560 Test Loss: 0.912 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.463181257247925
Epoch: 11, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.835 Vali Acc: 0.590 Test Loss: 0.835 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3731141090393066
Epoch: 12, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.842888355255127
Epoch: 13, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 73496066
model size : 295.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps300_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.841383695602417
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.8847053050994873
Epoch: 2, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.386639356613159
Epoch: 3, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.729 Vali Acc: 0.420 Test Loss: 0.729 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.607393741607666
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.830514907836914
Epoch: 5, Steps: 18 | Train Loss: 0.528 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 2.3549094200134277
Epoch: 6, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.445204973220825
Epoch: 7, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.844 Vali Acc: 0.520 Test Loss: 0.844 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4315505027770996
Epoch: 8, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4602601528167725
Epoch: 9, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.857 Vali Acc: 0.490 Test Loss: 0.857 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4186036586761475
Epoch: 10, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.932 Vali Acc: 0.530 Test Loss: 0.932 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8611929416656494
Epoch: 11, Steps: 18 | Train Loss: 0.537 Vali Loss: 1.093 Vali Acc: 0.570 Test Loss: 1.093 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569989).  Saving model ...
Epoch: 12 cost time: 2.2340195178985596
Epoch: 12, Steps: 18 | Train Loss: 0.365 Vali Loss: 0.930 Vali Acc: 0.550 Test Loss: 0.930 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.233128309249878
Epoch: 13, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.987 Vali Acc: 0.510 Test Loss: 0.987 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.261979341506958
Epoch: 14, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.500 Vali Acc: 0.540 Test Loss: 1.500 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.415895462036133
Epoch: 15, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.543 Vali Acc: 0.480 Test Loss: 1.543 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4057650566101074
Epoch: 16, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.320 Vali Acc: 0.560 Test Loss: 1.320 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3223812580108643
Epoch: 17, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.331 Vali Acc: 0.510 Test Loss: 1.331 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5523452758789062
Epoch: 18, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.557 Vali Acc: 0.560 Test Loss: 1.557 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5576071739196777
Epoch: 19, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.663 Vali Acc: 0.490 Test Loss: 1.663 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4494078159332275
Epoch: 20, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.396 Vali Acc: 0.520 Test Loss: 1.396 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.343217372894287
Epoch: 21, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.551 Vali Acc: 0.510 Test Loss: 1.551 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps300_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 73468418
model size : 294.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps334_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.073979616165161
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.019423484802246
Epoch: 2, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9845235347747803
Epoch: 3, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3050825595855713
Epoch: 4, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.847 Vali Acc: 0.580 Test Loss: 0.847 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 2.560335636138916
Epoch: 5, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.796 Vali Acc: 0.600 Test Loss: 0.796 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.6155335903167725
Epoch: 6, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.77873158454895
Epoch: 7, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.660496711730957
Epoch: 8, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.860 Vali Acc: 0.510 Test Loss: 0.860 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.571247100830078
Epoch: 9, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.126 Vali Acc: 0.480 Test Loss: 1.126 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5110950469970703
Epoch: 10, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.221 Vali Acc: 0.550 Test Loss: 1.221 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6468398571014404
Epoch: 11, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.117 Vali Acc: 0.530 Test Loss: 1.117 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.451340436935425
Epoch: 12, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.752 Vali Acc: 0.530 Test Loss: 1.752 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6103384494781494
Epoch: 13, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.584 Vali Acc: 0.530 Test Loss: 1.584 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5800671577453613
Epoch: 14, Steps: 18 | Train Loss: 0.229 Vali Loss: 2.347 Vali Acc: 0.500 Test Loss: 2.347 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6436939239501953
Epoch: 15, Steps: 18 | Train Loss: 0.574 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps334_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 78549506
model size : 314.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps334_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.955615282058716
Epoch: 1, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.865 Vali Acc: 0.430 Test Loss: 0.865 Test Acc: 0.430
Validation loss decreased (inf --> -0.429991).  Saving model ...
Epoch: 2 cost time: 2.3223178386688232
Epoch: 2, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (-0.429991 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.401296854019165
Epoch: 3, Steps: 18 | Train Loss: 0.690 Vali Loss: 0.744 Vali Acc: 0.450 Test Loss: 0.744 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5417392253875732
Epoch: 4, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.840 Vali Acc: 0.450 Test Loss: 0.840 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.321070671081543
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 2.4231338500976562
Epoch: 6, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.993 Vali Acc: 0.490 Test Loss: 0.993 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.367349147796631
Epoch: 7, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.935 Vali Acc: 0.510 Test Loss: 0.935 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2892065048217773
Epoch: 8, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.263 Vali Acc: 0.490 Test Loss: 1.263 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3207924365997314
Epoch: 9, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.004 Vali Acc: 0.480 Test Loss: 1.004 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.514418840408325
Epoch: 10, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.521516799926758
Epoch: 11, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.153 Vali Acc: 0.520 Test Loss: 1.153 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3207619190216064
Epoch: 12, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.142 Vali Acc: 0.560 Test Loss: 1.142 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559989).  Saving model ...
Epoch: 13 cost time: 2.564985990524292
Epoch: 13, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.120 Vali Acc: 0.480 Test Loss: 1.120 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.316375255584717
Epoch: 14, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.382 Vali Acc: 0.430 Test Loss: 1.382 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.368356943130493
Epoch: 15, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.573 Vali Acc: 0.490 Test Loss: 1.573 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4312803745269775
Epoch: 16, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.920 Vali Acc: 0.400 Test Loss: 1.920 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9666688442230225
Epoch: 17, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.611 Vali Acc: 0.500 Test Loss: 1.611 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9337239265441895
Epoch: 18, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.901 Vali Acc: 0.430 Test Loss: 1.901 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0227479934692383
Epoch: 19, Steps: 18 | Train Loss: 0.108 Vali Loss: 2.101 Vali Acc: 0.530 Test Loss: 2.101 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0180723667144775
Epoch: 20, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.541 Vali Acc: 0.560 Test Loss: 1.541 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9458043575286865
Epoch: 21, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.397 Vali Acc: 0.550 Test Loss: 1.397 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8810036182403564
Epoch: 22, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.113 Vali Acc: 0.480 Test Loss: 2.113 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps334_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 78500354
model size : 314.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps334_str334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.480149984359741
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.730 Vali Acc: 0.430 Test Loss: 0.730 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 2.292004108428955
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.727 Vali Acc: 0.410 Test Loss: 0.727 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0965142250061035
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
Validation loss decreased (-0.429993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.277374267578125
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.163437843322754
Epoch: 5, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.121398448944092
Epoch: 6, Steps: 18 | Train Loss: 0.438 Vali Loss: 0.959 Vali Acc: 0.560 Test Loss: 0.959 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559990).  Saving model ...
Epoch: 7 cost time: 2.203822612762451
Epoch: 7, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3528082370758057
Epoch: 8, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.082 Vali Acc: 0.560 Test Loss: 1.082 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.149319648742676
Epoch: 9, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.903 Vali Acc: 0.440 Test Loss: 0.903 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.159254550933838
Epoch: 10, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.041 Vali Acc: 0.420 Test Loss: 1.041 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.411799907684326
Epoch: 11, Steps: 18 | Train Loss: 0.305 Vali Loss: 1.281 Vali Acc: 0.460 Test Loss: 1.281 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.180176258087158
Epoch: 12, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.293 Vali Acc: 0.420 Test Loss: 1.293 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.171276569366455
Epoch: 13, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.991 Vali Acc: 0.550 Test Loss: 0.991 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.372915029525757
Epoch: 14, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.224 Vali Acc: 0.490 Test Loss: 1.224 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.107914924621582
Epoch: 15, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.280 Vali Acc: 0.470 Test Loss: 1.280 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2786293029785156
Epoch: 16, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps334_str334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 78475778
model size : 314.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps375_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.548781633377075
Epoch: 1, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.800 Vali Acc: 0.460 Test Loss: 0.800 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.1005148887634277
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.720 Vali Acc: 0.560 Test Loss: 0.720 Test Acc: 0.560
Validation loss decreased (-0.459992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.1332099437713623
Epoch: 3, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.745 Vali Acc: 0.560 Test Loss: 0.745 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.942065477371216
Epoch: 4, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.800485849380493
Epoch: 5, Steps: 18 | Train Loss: 0.467 Vali Loss: 1.007 Vali Acc: 0.470 Test Loss: 1.007 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.94248366355896
Epoch: 6, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.840 Vali Acc: 0.550 Test Loss: 0.840 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9381182193756104
Epoch: 7, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.004 Vali Acc: 0.570 Test Loss: 1.004 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569990).  Saving model ...
Epoch: 8 cost time: 2.855163097381592
Epoch: 8, Steps: 18 | Train Loss: 0.438 Vali Loss: 0.840 Vali Acc: 0.570 Test Loss: 0.840 Test Acc: 0.570
Validation loss decreased (-0.569990 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 2.7963931560516357
Epoch: 9, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2913930416107178
Epoch: 10, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.203 Vali Acc: 0.530 Test Loss: 1.203 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8088717460632324
Epoch: 11, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.010228157043457
Epoch: 12, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.084 Vali Acc: 0.460 Test Loss: 1.084 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9618887901306152
Epoch: 13, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.653 Vali Acc: 0.450 Test Loss: 1.653 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0640647411346436
Epoch: 14, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.114934206008911
Epoch: 15, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.191 Vali Acc: 0.580 Test Loss: 1.191 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579988).  Saving model ...
Epoch: 16 cost time: 2.8726861476898193
Epoch: 16, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.502 Vali Acc: 0.530 Test Loss: 1.502 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8584628105163574
Epoch: 17, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.973 Vali Acc: 0.460 Test Loss: 1.973 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8928604125976562
Epoch: 18, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.406 Vali Acc: 0.570 Test Loss: 1.406 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.150627374649048
Epoch: 19, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.418 Vali Acc: 0.530 Test Loss: 1.418 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.104738712310791
Epoch: 20, Steps: 18 | Train Loss: 0.102 Vali Loss: 2.058 Vali Acc: 0.560 Test Loss: 2.058 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.911837100982666
Epoch: 21, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7523374557495117
Epoch: 22, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.785 Vali Acc: 0.440 Test Loss: 1.785 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.157111406326294
Epoch: 23, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.070 Vali Acc: 0.480 Test Loss: 2.070 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.767611503601074
Epoch: 24, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.053 Vali Acc: 0.440 Test Loss: 2.053 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0354621410369873
Epoch: 25, Steps: 18 | Train Loss: 0.170 Vali Loss: 2.514 Vali Acc: 0.470 Test Loss: 2.514 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps375_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 84582914
model size : 337.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.861952304840088
Epoch: 1, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.5257885456085205
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.669 Vali Acc: 0.600 Test Loss: 0.669 Test Acc: 0.600
Validation loss decreased (-0.479993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 2.98002552986145
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.681 Vali Acc: 0.560 Test Loss: 0.681 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5198073387145996
Epoch: 4, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7524924278259277
Epoch: 5, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.740 Vali Acc: 0.560 Test Loss: 0.740 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7005374431610107
Epoch: 6, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.841261386871338
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5840463638305664
Epoch: 8, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.955 Vali Acc: 0.500 Test Loss: 0.955 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.808414936065674
Epoch: 9, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.567462921142578
Epoch: 10, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.049 Vali Acc: 0.560 Test Loss: 1.049 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6610472202301025
Epoch: 11, Steps: 18 | Train Loss: 0.378 Vali Loss: 1.169 Vali Acc: 0.510 Test Loss: 1.169 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.638118267059326
Epoch: 12, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.016 Vali Acc: 0.560 Test Loss: 1.016 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 84539906
model size : 337.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps375_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.752873420715332
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.684 Vali Acc: 0.580 Test Loss: 0.684 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.5028040409088135
Epoch: 2, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.714 Vali Acc: 0.550 Test Loss: 0.714 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.36987042427063
Epoch: 3, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.41862416267395
Epoch: 4, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.342003107070923
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.810 Vali Acc: 0.590 Test Loss: 0.810 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.471442937850952
Epoch: 6, Steps: 18 | Train Loss: 0.429 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6536190509796143
Epoch: 7, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.906 Vali Acc: 0.450 Test Loss: 0.906 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.454469680786133
Epoch: 8, Steps: 18 | Train Loss: 0.424 Vali Loss: 1.021 Vali Acc: 0.450 Test Loss: 1.021 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3608720302581787
Epoch: 9, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4767792224884033
Epoch: 10, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.376 Vali Acc: 0.460 Test Loss: 1.376 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.493957996368408
Epoch: 11, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.410 Vali Acc: 0.490 Test Loss: 1.410 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.061321258544922
Epoch: 12, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.404 Vali Acc: 0.460 Test Loss: 1.404 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.46563720703125
Epoch: 13, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.223 Vali Acc: 0.480 Test Loss: 1.223 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4564247131347656
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.437 Vali Acc: 0.470 Test Loss: 1.437 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.404155969619751
Epoch: 15, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps375_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 84521474
model size : 337.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps429_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8377554416656494
Epoch: 1, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.796140432357788
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.7151074409484863
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.933109998703003
Epoch: 4, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4859189987182617
Epoch: 5, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.958965301513672
Epoch: 6, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.832 Vali Acc: 0.490 Test Loss: 0.832 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8151652812957764
Epoch: 7, Steps: 18 | Train Loss: 0.436 Vali Loss: 1.011 Vali Acc: 0.580 Test Loss: 1.011 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579990).  Saving model ...
Epoch: 8 cost time: 2.738792896270752
Epoch: 8, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.800 Vali Acc: 0.520 Test Loss: 0.800 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9237377643585205
Epoch: 9, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6784777641296387
Epoch: 10, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.956 Vali Acc: 0.630 Test Loss: 0.956 Test Acc: 0.630
Validation loss decreased (-0.579990 --> -0.629990).  Saving model ...
Epoch: 11 cost time: 2.3746602535247803
Epoch: 11, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.979 Vali Acc: 0.590 Test Loss: 0.979 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8081870079040527
Epoch: 12, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.438 Vali Acc: 0.580 Test Loss: 1.438 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.820887565612793
Epoch: 13, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.345 Vali Acc: 0.570 Test Loss: 1.345 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.846048593521118
Epoch: 14, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.287 Vali Acc: 0.510 Test Loss: 1.287 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9361419677734375
Epoch: 15, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.326 Vali Acc: 0.530 Test Loss: 1.326 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.79487943649292
Epoch: 16, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.653346300125122
Epoch: 17, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.887 Vali Acc: 0.470 Test Loss: 1.887 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9698915481567383
Epoch: 18, Steps: 18 | Train Loss: 0.238 Vali Loss: 2.076 Vali Acc: 0.540 Test Loss: 2.076 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.815826177597046
Epoch: 19, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.106 Vali Acc: 0.530 Test Loss: 2.106 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7374300956726074
Epoch: 20, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.974 Vali Acc: 0.530 Test Loss: 1.974 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps429_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 92533250
model size : 367.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps429_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8264451026916504
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.781 Vali Acc: 0.420 Test Loss: 0.781 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 2.5989887714385986
Epoch: 2, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.681 Vali Acc: 0.500 Test Loss: 0.681 Test Acc: 0.500
Validation loss decreased (-0.419992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.754796266555786
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.684 Vali Acc: 0.570 Test Loss: 0.684 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.5819923877716064
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.680 Vali Acc: 0.610 Test Loss: 0.680 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 5 cost time: 2.6564488410949707
Epoch: 5, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.801 Vali Acc: 0.590 Test Loss: 0.801 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.631795644760132
Epoch: 6, Steps: 18 | Train Loss: 0.455 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7990803718566895
Epoch: 7, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.996 Vali Acc: 0.590 Test Loss: 0.996 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6944191455841064
Epoch: 8, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.675589084625244
Epoch: 9, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.939 Vali Acc: 0.570 Test Loss: 0.939 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.615412473678589
Epoch: 10, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.047 Vali Acc: 0.530 Test Loss: 1.047 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.578972339630127
Epoch: 11, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.078 Vali Acc: 0.550 Test Loss: 1.078 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.635925054550171
Epoch: 12, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.054 Vali Acc: 0.570 Test Loss: 1.054 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5364577770233154
Epoch: 13, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.344 Vali Acc: 0.560 Test Loss: 1.344 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7423062324523926
Epoch: 14, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.838 Vali Acc: 0.550 Test Loss: 1.838 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps429_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 92496386
model size : 367.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps429_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3269383907318115
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 0.883 Vali Acc: 0.500 Test Loss: 0.883 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.5078494548797607
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.372098207473755
Epoch: 3, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5037670135498047
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.755 Vali Acc: 0.440 Test Loss: 0.755 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5677695274353027
Epoch: 5, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.791 Vali Acc: 0.530 Test Loss: 0.791 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 2.4273409843444824
Epoch: 6, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.982 Vali Acc: 0.440 Test Loss: 0.982 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.555241584777832
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.962 Vali Acc: 0.490 Test Loss: 0.962 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4414758682250977
Epoch: 8, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.029 Vali Acc: 0.490 Test Loss: 1.029 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5058064460754395
Epoch: 9, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.945 Vali Acc: 0.510 Test Loss: 0.945 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.824167013168335
Epoch: 10, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.956 Vali Acc: 0.520 Test Loss: 0.956 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.636974334716797
Epoch: 11, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.992 Vali Acc: 0.560 Test Loss: 0.992 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 2.5879297256469727
Epoch: 12, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.305 Vali Acc: 0.520 Test Loss: 1.305 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.451241970062256
Epoch: 13, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.206 Vali Acc: 0.480 Test Loss: 1.206 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.666422128677368
Epoch: 14, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.175 Vali Acc: 0.590 Test Loss: 1.175 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589988).  Saving model ...
Epoch: 15 cost time: 2.6951966285705566
Epoch: 15, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.500 Vali Acc: 0.480 Test Loss: 1.500 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.77067494392395
Epoch: 16, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6046290397644043
Epoch: 17, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.313 Vali Acc: 0.530 Test Loss: 1.313 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7313003540039062
Epoch: 18, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.488 Vali Acc: 0.550 Test Loss: 1.488 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.571021556854248
Epoch: 19, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.653 Vali Acc: 0.520 Test Loss: 1.653 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6435022354125977
Epoch: 20, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.815 Vali Acc: 0.550 Test Loss: 1.815 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.5660464763641357
Epoch: 21, Steps: 18 | Train Loss: 0.185 Vali Loss: 2.525 Vali Acc: 0.510 Test Loss: 2.525 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8508269786834717
Epoch: 22, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.707 Vali Acc: 0.490 Test Loss: 1.707 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.667947292327881
Epoch: 23, Steps: 18 | Train Loss: 0.131 Vali Loss: 2.315 Vali Acc: 0.490 Test Loss: 2.315 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5106654167175293
Epoch: 24, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps429_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 92477954
model size : 367.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.982356309890747
Epoch: 1, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.218653917312622
Epoch: 2, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.657 Vali Acc: 0.650 Test Loss: 0.657 Test Acc: 0.650
Validation loss decreased (-0.469993 --> -0.649993).  Saving model ...
Epoch: 3 cost time: 3.1657071113586426
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.870 Vali Acc: 0.570 Test Loss: 0.870 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.227818012237549
Epoch: 4, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.985 Vali Acc: 0.540 Test Loss: 0.985 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.428966760635376
Epoch: 5, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.658 Vali Acc: 0.580 Test Loss: 0.658 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.587224245071411
Epoch: 6, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.740 Vali Acc: 0.580 Test Loss: 0.740 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.41860294342041
Epoch: 7, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.860 Vali Acc: 0.560 Test Loss: 0.860 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5994014739990234
Epoch: 8, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.983 Vali Acc: 0.550 Test Loss: 0.983 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.496659517288208
Epoch: 9, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.940 Vali Acc: 0.590 Test Loss: 0.940 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3917317390441895
Epoch: 10, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.068190336227417
Epoch: 11, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.190 Vali Acc: 0.510 Test Loss: 1.190 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.355689525604248
Epoch: 12, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.955 Vali Acc: 0.560 Test Loss: 0.955 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 102993410
model size : 407.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.472472190856934
Epoch: 1, Steps: 18 | Train Loss: 0.802 Vali Loss: 0.779 Vali Acc: 0.440 Test Loss: 0.779 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 3.193702459335327
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
Validation loss decreased (-0.439992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.133418083190918
Epoch: 3, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.700 Vali Acc: 0.590 Test Loss: 0.700 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 3.1290695667266846
Epoch: 4, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.717 Vali Acc: 0.600 Test Loss: 0.717 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 2.646693706512451
Epoch: 5, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.828 Vali Acc: 0.450 Test Loss: 0.828 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0550119876861572
Epoch: 6, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1817562580108643
Epoch: 7, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.954 Vali Acc: 0.530 Test Loss: 0.954 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.259239435195923
Epoch: 8, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.805 Vali Acc: 0.570 Test Loss: 0.805 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1809985637664795
Epoch: 9, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.944 Vali Acc: 0.540 Test Loss: 0.944 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.096341133117676
Epoch: 10, Steps: 18 | Train Loss: 0.405 Vali Loss: 0.914 Vali Acc: 0.510 Test Loss: 0.914 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.114251136779785
Epoch: 11, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.085 Vali Acc: 0.510 Test Loss: 1.085 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.307021141052246
Epoch: 12, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.280 Vali Acc: 0.490 Test Loss: 1.280 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.223320722579956
Epoch: 13, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.607 Vali Acc: 0.410 Test Loss: 1.607 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.405860424041748
Epoch: 14, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.316 Vali Acc: 0.500 Test Loss: 1.316 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 102962690
model size : 407.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.5149054527282715
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.743 Vali Acc: 0.450 Test Loss: 0.743 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.0879101753234863
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 3.0250966548919678
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.820 Vali Acc: 0.440 Test Loss: 0.820 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9492506980895996
Epoch: 4, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 3.0415422916412354
Epoch: 5, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2993545532226562
Epoch: 6, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.911 Vali Acc: 0.480 Test Loss: 0.911 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.270268201828003
Epoch: 7, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.850 Vali Acc: 0.520 Test Loss: 0.850 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.066972017288208
Epoch: 8, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.066 Vali Acc: 0.520 Test Loss: 1.066 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0756585597991943
Epoch: 9, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.215 Vali Acc: 0.540 Test Loss: 1.215 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.173064947128296
Epoch: 10, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.147 Vali Acc: 0.540 Test Loss: 1.147 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2046239376068115
Epoch: 11, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.152 Vali Acc: 0.460 Test Loss: 1.152 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.093116044998169
Epoch: 12, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.402 Vali Acc: 0.510 Test Loss: 1.402 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.371587038040161
Epoch: 13, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.416 Vali Acc: 0.490 Test Loss: 1.416 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.425410270690918
Epoch: 14, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 102947330
model size : 407.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps600_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.5886030197143555
Epoch: 1, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.294189691543579
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 3.581305742263794
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.891258716583252
Epoch: 4, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 3.4442625045776367
Epoch: 5, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.962 Vali Acc: 0.470 Test Loss: 0.962 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7404587268829346
Epoch: 6, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.848 Vali Acc: 0.470 Test Loss: 0.848 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.909886360168457
Epoch: 7, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.900 Vali Acc: 0.570 Test Loss: 0.900 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 3.4807755947113037
Epoch: 8, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.019 Vali Acc: 0.460 Test Loss: 1.019 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5862488746643066
Epoch: 9, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.836 Vali Acc: 0.480 Test Loss: 0.836 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8443100452423096
Epoch: 10, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.065 Vali Acc: 0.560 Test Loss: 1.065 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6360864639282227
Epoch: 11, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.100 Vali Acc: 0.510 Test Loss: 1.100 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5180535316467285
Epoch: 12, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.305 Vali Acc: 0.550 Test Loss: 1.305 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.168961763381958
Epoch: 13, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.345 Vali Acc: 0.540 Test Loss: 1.345 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5440330505371094
Epoch: 14, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.875 Vali Acc: 0.550 Test Loss: 1.875 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.041373014450073
Epoch: 15, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.383 Vali Acc: 0.550 Test Loss: 1.383 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7694530487060547
Epoch: 16, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.534 Vali Acc: 0.530 Test Loss: 1.534 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.261462450027466
Epoch: 17, Steps: 18 | Train Loss: 0.269 Vali Loss: 1.355 Vali Acc: 0.540 Test Loss: 1.355 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps600_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 117726722
model size : 463.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.202879905700684
Epoch: 1, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.833 Vali Acc: 0.440 Test Loss: 0.833 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 3.6767358779907227
Epoch: 2, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
Validation loss decreased (-0.439992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 3.5676705837249756
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.817 Vali Acc: 0.530 Test Loss: 0.817 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.4998862743377686
Epoch: 4, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.334737539291382
Epoch: 5, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7863519191741943
Epoch: 6, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 2.903489351272583
Epoch: 7, Steps: 18 | Train Loss: 0.423 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0966384410858154
Epoch: 8, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.975 Vali Acc: 0.520 Test Loss: 0.975 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.394686460494995
Epoch: 9, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.433 Vali Acc: 0.510 Test Loss: 1.433 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.837005615234375
Epoch: 10, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 3.1652066707611084
Epoch: 11, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.251 Vali Acc: 0.520 Test Loss: 1.251 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2979540824890137
Epoch: 12, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.032766580581665
Epoch: 13, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.239 Vali Acc: 0.520 Test Loss: 1.239 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1860461235046387
Epoch: 14, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1830544471740723
Epoch: 15, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.715 Vali Acc: 0.520 Test Loss: 1.715 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3787992000579834
Epoch: 16, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.627 Vali Acc: 0.520 Test Loss: 1.627 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4422898292541504
Epoch: 17, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.979 Vali Acc: 0.530 Test Loss: 1.979 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.033012866973877
Epoch: 18, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.455 Vali Acc: 0.490 Test Loss: 1.455 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2282049655914307
Epoch: 19, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.786 Vali Acc: 0.540 Test Loss: 1.786 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3297226428985596
Epoch: 20, Steps: 18 | Train Loss: 0.135 Vali Loss: 2.353 Vali Acc: 0.490 Test Loss: 2.353 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 117702146
model size : 463.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps600_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.713075876235962
Epoch: 1, Steps: 18 | Train Loss: 0.766 Vali Loss: 0.734 Vali Acc: 0.440 Test Loss: 0.734 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 3.279095411300659
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
Validation loss decreased (-0.439993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 3.4254236221313477
Epoch: 3, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 3.307332992553711
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.777 Vali Acc: 0.440 Test Loss: 0.777 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2566428184509277
Epoch: 5, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1276731491088867
Epoch: 6, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 3.319366693496704
Epoch: 7, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 3.278818368911743
Epoch: 8, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.088 Vali Acc: 0.490 Test Loss: 1.088 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3439111709594727
Epoch: 9, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.982 Vali Acc: 0.540 Test Loss: 0.982 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539990).  Saving model ...
Epoch: 10 cost time: 3.312950372695923
Epoch: 10, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2940096855163574
Epoch: 11, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5113840103149414
Epoch: 12, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.971 Vali Acc: 0.490 Test Loss: 0.971 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3258328437805176
Epoch: 13, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.877 Vali Acc: 0.550 Test Loss: 0.877 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549991).  Saving model ...
Epoch: 14 cost time: 3.216264247894287
Epoch: 14, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.153 Vali Acc: 0.490 Test Loss: 1.153 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2862355709075928
Epoch: 15, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.019 Vali Acc: 0.590 Test Loss: 1.019 Test Acc: 0.590
Validation loss decreased (-0.549991 --> -0.589990).  Saving model ...
Epoch: 16 cost time: 3.067279577255249
Epoch: 16, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.442 Vali Acc: 0.470 Test Loss: 1.442 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6782453060150146
Epoch: 17, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.225 Vali Acc: 0.470 Test Loss: 1.225 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.685896873474121
Epoch: 18, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.298374891281128
Epoch: 19, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.407 Vali Acc: 0.500 Test Loss: 1.407 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.356421947479248
Epoch: 20, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.841 Vali Acc: 0.470 Test Loss: 1.841 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.5004045963287354
Epoch: 21, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.392 Vali Acc: 0.540 Test Loss: 1.392 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.5249080657958984
Epoch: 22, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.387 Vali Acc: 0.540 Test Loss: 1.387 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.37591290473938
Epoch: 23, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.701 Vali Acc: 0.510 Test Loss: 1.701 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.3445005416870117
Epoch: 24, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.509 Vali Acc: 0.530 Test Loss: 1.509 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.5720198154449463
Epoch: 25, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.514 Vali Acc: 0.480 Test Loss: 1.514 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el4_dm768_df768_ps600_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 117689858
model size : 463.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.630540370941162
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.2859408855438232
Epoch: 2, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.690 Vali Acc: 0.500 Test Loss: 0.690 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.2039127349853516
Epoch: 3, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.3814544677734375
Epoch: 4, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.671 Vali Acc: 0.600 Test Loss: 0.671 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 2.3022301197052
Epoch: 5, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4527809619903564
Epoch: 6, Steps: 18 | Train Loss: 0.926 Vali Loss: 1.036 Vali Acc: 0.440 Test Loss: 1.036 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.384265184402466
Epoch: 7, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.436939001083374
Epoch: 8, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4012610912323
Epoch: 9, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.582 Vali Acc: 0.510 Test Loss: 1.582 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.287182092666626
Epoch: 10, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.399733304977417
Epoch: 11, Steps: 18 | Train Loss: 0.480 Vali Loss: 1.122 Vali Acc: 0.530 Test Loss: 1.122 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2932498455047607
Epoch: 12, Steps: 18 | Train Loss: 0.507 Vali Loss: 1.096 Vali Acc: 0.440 Test Loss: 1.096 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.444894552230835
Epoch: 13, Steps: 18 | Train Loss: 0.496 Vali Loss: 1.182 Vali Acc: 0.560 Test Loss: 1.182 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4029617309570312
Epoch: 14, Steps: 18 | Train Loss: 0.403 Vali Loss: 2.014 Vali Acc: 0.570 Test Loss: 2.014 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 40105730
model size : 167.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9195199012756348
Epoch: 1, Steps: 18 | Train Loss: 0.802 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.64090895652771
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.720 Vali Acc: 0.440 Test Loss: 0.720 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5566580295562744
Epoch: 3, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.5901727676391602
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.872 Vali Acc: 0.460 Test Loss: 0.872 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4367763996124268
Epoch: 5, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.907 Vali Acc: 0.550 Test Loss: 0.907 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 1.5614352226257324
Epoch: 6, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.7061388492584229
Epoch: 7, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.972 Vali Acc: 0.500 Test Loss: 0.972 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6073253154754639
Epoch: 8, Steps: 18 | Train Loss: 0.500 Vali Loss: 1.234 Vali Acc: 0.450 Test Loss: 1.234 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4881055355072021
Epoch: 9, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.976 Vali Acc: 0.470 Test Loss: 0.976 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5433270931243896
Epoch: 10, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.120 Vali Acc: 0.480 Test Loss: 1.120 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6411819458007812
Epoch: 11, Steps: 18 | Train Loss: 0.420 Vali Loss: 1.218 Vali Acc: 0.550 Test Loss: 1.218 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.547642469406128
Epoch: 12, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.153 Vali Acc: 0.590 Test Loss: 1.153 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589988).  Saving model ...
Epoch: 13 cost time: 1.6946909427642822
Epoch: 13, Steps: 18 | Train Loss: 0.298 Vali Loss: 2.425 Vali Acc: 0.530 Test Loss: 2.425 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5860440731048584
Epoch: 14, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.376 Vali Acc: 0.490 Test Loss: 1.376 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4133269786834717
Epoch: 15, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.688 Vali Acc: 0.440 Test Loss: 1.688 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5367116928100586
Epoch: 16, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.690 Vali Acc: 0.550 Test Loss: 1.690 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3120262622833252
Epoch: 17, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.498 Vali Acc: 0.540 Test Loss: 1.498 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8486824035644531
Epoch: 18, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.747 Vali Acc: 0.510 Test Loss: 1.747 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5687053203582764
Epoch: 19, Steps: 18 | Train Loss: 0.351 Vali Loss: 2.291 Vali Acc: 0.480 Test Loss: 2.291 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4429168701171875
Epoch: 20, Steps: 18 | Train Loss: 0.854 Vali Loss: 1.567 Vali Acc: 0.490 Test Loss: 1.567 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4027800559997559
Epoch: 21, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.519 Vali Acc: 0.520 Test Loss: 1.519 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6580450534820557
Epoch: 22, Steps: 18 | Train Loss: 0.219 Vali Loss: 2.267 Vali Acc: 0.570 Test Loss: 2.267 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 39958274
model size : 167.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8003695011138916
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.275886058807373
Epoch: 2, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.676 Vali Acc: 0.560 Test Loss: 0.676 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.3334424495697021
Epoch: 3, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.671 Vali Acc: 0.550 Test Loss: 0.671 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.281846523284912
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.723 Vali Acc: 0.590 Test Loss: 0.723 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 1.3008148670196533
Epoch: 5, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.690 Vali Acc: 0.590 Test Loss: 0.690 Test Acc: 0.590
Validation loss decreased (-0.589993 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 1.3782062530517578
Epoch: 6, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.873 Vali Acc: 0.550 Test Loss: 0.873 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5088012218475342
Epoch: 7, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.893 Vali Acc: 0.480 Test Loss: 0.893 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.24749755859375
Epoch: 8, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6519434452056885
Epoch: 9, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.808 Vali Acc: 0.460 Test Loss: 0.808 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.344447135925293
Epoch: 10, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.239 Vali Acc: 0.570 Test Loss: 1.239 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4197173118591309
Epoch: 11, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.892 Vali Acc: 0.570 Test Loss: 0.892 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5025615692138672
Epoch: 12, Steps: 18 | Train Loss: 0.482 Vali Loss: 1.600 Vali Acc: 0.610 Test Loss: 1.600 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609984).  Saving model ...
Epoch: 13 cost time: 1.3829526901245117
Epoch: 13, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.087 Vali Acc: 0.570 Test Loss: 1.087 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4882562160491943
Epoch: 14, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.118 Vali Acc: 0.570 Test Loss: 1.118 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4374923706054688
Epoch: 15, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4340453147888184
Epoch: 16, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.501 Vali Acc: 0.490 Test Loss: 1.501 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3150794506072998
Epoch: 17, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.369 Vali Acc: 0.580 Test Loss: 1.369 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.55295991897583
Epoch: 18, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.382 Vali Acc: 0.530 Test Loss: 1.382 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.385559320449829
Epoch: 19, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.191 Vali Acc: 0.530 Test Loss: 1.191 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5191831588745117
Epoch: 20, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.330 Vali Acc: 0.600 Test Loss: 1.330 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4106042385101318
Epoch: 21, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.244 Vali Acc: 0.510 Test Loss: 1.244 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2835114002227783
Epoch: 22, Steps: 18 | Train Loss: 0.150 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 39884546
model size : 166.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.221951484680176
Epoch: 1, Steps: 18 | Train Loss: 0.866 Vali Loss: 1.000 Vali Acc: 0.500 Test Loss: 1.000 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 1.9608886241912842
Epoch: 2, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.685 Vali Acc: 0.570 Test Loss: 0.685 Test Acc: 0.570
Validation loss decreased (-0.499990 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.9771287441253662
Epoch: 3, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1127073764801025
Epoch: 4, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.829451560974121
Epoch: 5, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0810039043426514
Epoch: 6, Steps: 18 | Train Loss: 0.688 Vali Loss: 1.204 Vali Acc: 0.570 Test Loss: 1.204 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7990937232971191
Epoch: 7, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.108 Vali Acc: 0.530 Test Loss: 1.108 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1391260623931885
Epoch: 8, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.861 Vali Acc: 0.490 Test Loss: 0.861 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.031461238861084
Epoch: 9, Steps: 18 | Train Loss: 0.624 Vali Loss: 1.500 Vali Acc: 0.520 Test Loss: 1.500 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2080461978912354
Epoch: 10, Steps: 18 | Train Loss: 0.561 Vali Loss: 1.452 Vali Acc: 0.540 Test Loss: 1.452 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1901679039001465
Epoch: 11, Steps: 18 | Train Loss: 0.609 Vali Loss: 1.455 Vali Acc: 0.550 Test Loss: 1.455 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8902931213378906
Epoch: 12, Steps: 18 | Train Loss: 0.523 Vali Loss: 1.447 Vali Acc: 0.480 Test Loss: 1.447 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 40821506
model size : 170.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8411319255828857
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5243418216705322
Epoch: 2, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.736 Vali Acc: 0.580 Test Loss: 0.736 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 1.598846435546875
Epoch: 3, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5926504135131836
Epoch: 4, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6044495105743408
Epoch: 5, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5240137577056885
Epoch: 6, Steps: 18 | Train Loss: 0.503 Vali Loss: 1.224 Vali Acc: 0.510 Test Loss: 1.224 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5481553077697754
Epoch: 7, Steps: 18 | Train Loss: 0.529 Vali Loss: 1.003 Vali Acc: 0.550 Test Loss: 1.003 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.515998363494873
Epoch: 8, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.157 Vali Acc: 0.530 Test Loss: 1.157 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5223288536071777
Epoch: 9, Steps: 18 | Train Loss: 0.529 Vali Loss: 1.735 Vali Acc: 0.480 Test Loss: 1.735 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6787333488464355
Epoch: 10, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5795114040374756
Epoch: 11, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.652 Vali Acc: 0.530 Test Loss: 1.652 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3646478652954102
Epoch: 12, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 40686338
model size : 169.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.768461227416992
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.5413017272949219
Epoch: 2, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.699 Vali Acc: 0.630 Test Loss: 0.699 Test Acc: 0.630
Validation loss decreased (-0.549993 --> -0.629993).  Saving model ...
Epoch: 3 cost time: 1.3058006763458252
Epoch: 3, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.871 Vali Acc: 0.460 Test Loss: 0.871 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5547549724578857
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5903477668762207
Epoch: 5, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.968 Vali Acc: 0.480 Test Loss: 0.968 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.492631196975708
Epoch: 6, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5735278129577637
Epoch: 7, Steps: 18 | Train Loss: 0.575 Vali Loss: 1.089 Vali Acc: 0.520 Test Loss: 1.089 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.415097951889038
Epoch: 8, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.908 Vali Acc: 0.550 Test Loss: 0.908 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3324453830718994
Epoch: 9, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.207 Vali Acc: 0.530 Test Loss: 1.207 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.659118890762329
Epoch: 10, Steps: 18 | Train Loss: 0.437 Vali Loss: 1.298 Vali Acc: 0.510 Test Loss: 1.298 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5655794143676758
Epoch: 11, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.048 Vali Acc: 0.480 Test Loss: 1.048 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2386879920959473
Epoch: 12, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.402 Vali Acc: 0.580 Test Loss: 1.402 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 40618754
model size : 169.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps131_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1813595294952393
Epoch: 1, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.802 Vali Acc: 0.440 Test Loss: 0.802 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.0661773681640625
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (-0.439992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.2133867740631104
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 2.1389482021331787
Epoch: 4, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.679 Vali Acc: 0.590 Test Loss: 0.679 Test Acc: 0.590
Validation loss decreased (-0.509992 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 2.0687689781188965
Epoch: 5, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.852 Vali Acc: 0.510 Test Loss: 0.852 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2688183784484863
Epoch: 6, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.944 Vali Acc: 0.480 Test Loss: 0.944 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.136699676513672
Epoch: 7, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.910 Vali Acc: 0.470 Test Loss: 0.910 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.111471176147461
Epoch: 8, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.881 Vali Acc: 0.520 Test Loss: 0.881 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.235527992248535
Epoch: 9, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.781 Vali Acc: 0.550 Test Loss: 0.781 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1019136905670166
Epoch: 10, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.141 Vali Acc: 0.470 Test Loss: 1.141 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.107098340988159
Epoch: 11, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.646 Vali Acc: 0.520 Test Loss: 1.646 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2729480266571045
Epoch: 12, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8390398025512695
Epoch: 13, Steps: 18 | Train Loss: 0.295 Vali Loss: 1.090 Vali Acc: 0.570 Test Loss: 1.090 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.244070529937744
Epoch: 14, Steps: 18 | Train Loss: 0.626 Vali Loss: 1.268 Vali Acc: 0.510 Test Loss: 1.268 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps131_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 41697026
model size : 173.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps131_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0971832275390625
Epoch: 1, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.685 Vali Acc: 0.640 Test Loss: 0.685 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 1.6137409210205078
Epoch: 2, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5669665336608887
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.683 Vali Acc: 0.610 Test Loss: 0.683 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6070897579193115
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.752593755722046
Epoch: 5, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.799 Vali Acc: 0.560 Test Loss: 0.799 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8877732753753662
Epoch: 6, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.743 Vali Acc: 0.570 Test Loss: 0.743 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6258130073547363
Epoch: 7, Steps: 18 | Train Loss: 0.452 Vali Loss: 1.269 Vali Acc: 0.570 Test Loss: 1.269 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7916934490203857
Epoch: 8, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.746 Vali Acc: 0.600 Test Loss: 0.746 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7435383796691895
Epoch: 9, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.031 Vali Acc: 0.470 Test Loss: 1.031 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7985310554504395
Epoch: 10, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.174 Vali Acc: 0.530 Test Loss: 1.174 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.64689302444458
Epoch: 11, Steps: 18 | Train Loss: 0.475 Vali Loss: 0.946 Vali Acc: 0.520 Test Loss: 0.946 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps131_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 41564930
model size : 173.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps131_str131_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.876164674758911
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.677 Vali Acc: 0.600 Test Loss: 0.677 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 1.498547077178955
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.793 Vali Acc: 0.400 Test Loss: 0.793 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5161333084106445
Epoch: 3, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.685 Vali Acc: 0.590 Test Loss: 0.685 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.545609474182129
Epoch: 4, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.774 Vali Acc: 0.460 Test Loss: 0.774 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4888114929199219
Epoch: 5, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5560476779937744
Epoch: 6, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.731 Vali Acc: 0.580 Test Loss: 0.731 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5245468616485596
Epoch: 7, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.067 Vali Acc: 0.550 Test Loss: 1.067 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5445444583892822
Epoch: 8, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5610692501068115
Epoch: 9, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.963 Vali Acc: 0.570 Test Loss: 0.963 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5113766193389893
Epoch: 10, Steps: 18 | Train Loss: 0.414 Vali Loss: 1.247 Vali Acc: 0.550 Test Loss: 1.247 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.50645112991333
Epoch: 11, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.061 Vali Acc: 0.520 Test Loss: 1.061 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps131_str131_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 41497346
model size : 172.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps137_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.613818883895874
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.855 Vali Acc: 0.470 Test Loss: 0.855 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 1.972424030303955
Epoch: 2, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.810 Vali Acc: 0.450 Test Loss: 0.810 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2757883071899414
Epoch: 3, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.889 Vali Acc: 0.450 Test Loss: 0.889 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.260817527770996
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.749 Vali Acc: 0.600 Test Loss: 0.749 Test Acc: 0.600
Validation loss decreased (-0.469991 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 2.114959716796875
Epoch: 5, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.852 Vali Acc: 0.590 Test Loss: 0.852 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2109339237213135
Epoch: 6, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.894 Vali Acc: 0.560 Test Loss: 0.894 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8532278537750244
Epoch: 7, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.983 Vali Acc: 0.540 Test Loss: 0.983 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7172572612762451
Epoch: 8, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.969 Vali Acc: 0.510 Test Loss: 0.969 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7826473712921143
Epoch: 9, Steps: 18 | Train Loss: 0.518 Vali Loss: 1.390 Vali Acc: 0.460 Test Loss: 1.390 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7092199325561523
Epoch: 10, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.028 Vali Acc: 0.520 Test Loss: 1.028 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.144850254058838
Epoch: 11, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.585 Vali Acc: 0.530 Test Loss: 1.585 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7782573699951172
Epoch: 12, Steps: 18 | Train Loss: 0.652 Vali Loss: 1.076 Vali Acc: 0.490 Test Loss: 1.076 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.321735382080078
Epoch: 13, Steps: 18 | Train Loss: 0.393 Vali Loss: 1.714 Vali Acc: 0.560 Test Loss: 1.714 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0596015453338623
Epoch: 14, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.108 Vali Acc: 0.530 Test Loss: 1.108 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps137_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 42566402
model size : 177.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps137_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7970516681671143
Epoch: 1, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.721 Vali Acc: 0.580 Test Loss: 0.721 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.607079029083252
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6180589199066162
Epoch: 3, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.808 Vali Acc: 0.600 Test Loss: 0.808 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 1.7438690662384033
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6248741149902344
Epoch: 5, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.833 Vali Acc: 0.580 Test Loss: 0.833 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6273927688598633
Epoch: 6, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5624885559082031
Epoch: 7, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.874 Vali Acc: 0.610 Test Loss: 0.874 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609991).  Saving model ...
Epoch: 8 cost time: 1.6725730895996094
Epoch: 8, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6118767261505127
Epoch: 9, Steps: 18 | Train Loss: 0.514 Vali Loss: 1.021 Vali Acc: 0.540 Test Loss: 1.021 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7115390300750732
Epoch: 10, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.387 Vali Acc: 0.560 Test Loss: 1.387 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5415854454040527
Epoch: 11, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.759 Vali Acc: 0.570 Test Loss: 0.759 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.703624963760376
Epoch: 12, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.008 Vali Acc: 0.530 Test Loss: 1.008 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8964900970458984
Epoch: 13, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.733 Vali Acc: 0.520 Test Loss: 1.733 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6185145378112793
Epoch: 14, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.566 Vali Acc: 0.580 Test Loss: 1.566 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.371027946472168
Epoch: 15, Steps: 18 | Train Loss: 0.397 Vali Loss: 1.275 Vali Acc: 0.550 Test Loss: 1.275 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3513462543487549
Epoch: 16, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.310 Vali Acc: 0.520 Test Loss: 1.310 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4057252407073975
Epoch: 17, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.196 Vali Acc: 0.530 Test Loss: 1.196 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps137_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 42443522
model size : 176.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps137_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.4388175010681152
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.686 Vali Acc: 0.530 Test Loss: 0.686 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.3861796855926514
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.4094676971435547
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.679 Vali Acc: 0.610 Test Loss: 0.679 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 1.2382829189300537
Epoch: 4, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.748 Vali Acc: 0.610 Test Loss: 0.748 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3223440647125244
Epoch: 5, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2366769313812256
Epoch: 6, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.789 Vali Acc: 0.470 Test Loss: 0.789 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4445130825042725
Epoch: 7, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3137733936309814
Epoch: 8, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.752 Vali Acc: 0.580 Test Loss: 0.752 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.500945806503296
Epoch: 9, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.929 Vali Acc: 0.570 Test Loss: 0.929 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2887954711914062
Epoch: 10, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4286155700683594
Epoch: 11, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.380 Vali Acc: 0.520 Test Loss: 1.380 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.397132396697998
Epoch: 12, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.997 Vali Acc: 0.500 Test Loss: 0.997 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3609142303466797
Epoch: 13, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.306 Vali Acc: 0.470 Test Loss: 1.306 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps137_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 42379010
model size : 176.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps143_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.853271722793579
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.0159173011779785
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.1447956562042236
Epoch: 3, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.12542724609375
Epoch: 4, Steps: 18 | Train Loss: 0.650 Vali Loss: 1.006 Vali Acc: 0.590 Test Loss: 1.006 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589990).  Saving model ...
Epoch: 5 cost time: 2.035698175430298
Epoch: 5, Steps: 18 | Train Loss: 0.644 Vali Loss: 1.298 Vali Acc: 0.460 Test Loss: 1.298 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3636233806610107
Epoch: 6, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.956 Vali Acc: 0.490 Test Loss: 0.956 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9002506732940674
Epoch: 7, Steps: 18 | Train Loss: 0.519 Vali Loss: 1.151 Vali Acc: 0.470 Test Loss: 1.151 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1419196128845215
Epoch: 8, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.041 Vali Acc: 0.540 Test Loss: 1.041 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1859025955200195
Epoch: 9, Steps: 18 | Train Loss: 0.405 Vali Loss: 1.052 Vali Acc: 0.570 Test Loss: 1.052 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1232588291168213
Epoch: 10, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.993 Vali Acc: 0.570 Test Loss: 0.993 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0103907585144043
Epoch: 11, Steps: 18 | Train Loss: 0.470 Vali Loss: 1.290 Vali Acc: 0.580 Test Loss: 1.290 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0540926456451416
Epoch: 12, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.447 Vali Acc: 0.550 Test Loss: 1.447 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0733773708343506
Epoch: 13, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.690 Vali Acc: 0.500 Test Loss: 1.690 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7273790836334229
Epoch: 14, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.950 Vali Acc: 0.520 Test Loss: 1.950 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps143_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 43444994
model size : 180.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps143_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.6230568885803223
Epoch: 1, Steps: 18 | Train Loss: 0.828 Vali Loss: 0.840 Vali Acc: 0.400 Test Loss: 0.840 Test Acc: 0.400
Validation loss decreased (inf --> -0.399992).  Saving model ...
Epoch: 2 cost time: 1.6183476448059082
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.737 Vali Acc: 0.470 Test Loss: 0.737 Test Acc: 0.470
Validation loss decreased (-0.399992 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.525907278060913
Epoch: 3, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.5775747299194336
Epoch: 4, Steps: 18 | Train Loss: 0.650 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4071345329284668
Epoch: 5, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.722 Vali Acc: 0.580 Test Loss: 0.722 Test Acc: 0.580
Validation loss decreased (-0.499992 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 1.63895583152771
Epoch: 6, Steps: 18 | Train Loss: 0.505 Vali Loss: 1.007 Vali Acc: 0.550 Test Loss: 1.007 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6101109981536865
Epoch: 7, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.876 Vali Acc: 0.610 Test Loss: 0.876 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609991).  Saving model ...
Epoch: 8 cost time: 1.7486767768859863
Epoch: 8, Steps: 18 | Train Loss: 0.483 Vali Loss: 1.109 Vali Acc: 0.580 Test Loss: 1.109 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.591266393661499
Epoch: 9, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.160 Vali Acc: 0.510 Test Loss: 1.160 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2994208335876465
Epoch: 10, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5623362064361572
Epoch: 11, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5314228534698486
Epoch: 12, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4928452968597412
Epoch: 13, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.227 Vali Acc: 0.540 Test Loss: 1.227 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5845603942871094
Epoch: 14, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5650479793548584
Epoch: 15, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.281 Vali Acc: 0.550 Test Loss: 1.281 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.599275827407837
Epoch: 16, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.456 Vali Acc: 0.580 Test Loss: 1.456 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5784976482391357
Epoch: 17, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.578 Vali Acc: 0.500 Test Loss: 1.578 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps143_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 43322114
model size : 179.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps143_str143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8039543628692627
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.4741642475128174
Epoch: 2, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.2759830951690674
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
Validation loss decreased (-0.469992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.2864739894866943
Epoch: 4, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.841 Vali Acc: 0.530 Test Loss: 0.841 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1982064247131348
Epoch: 5, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2291452884674072
Epoch: 6, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 1.3362741470336914
Epoch: 7, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.24703049659729
Epoch: 8, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 1.388582706451416
Epoch: 9, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.177980661392212
Epoch: 10, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.942 Vali Acc: 0.540 Test Loss: 0.942 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4752960205078125
Epoch: 11, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.502 Vali Acc: 0.540 Test Loss: 1.502 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4213974475860596
Epoch: 12, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.353 Vali Acc: 0.550 Test Loss: 1.353 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4712932109832764
Epoch: 13, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.274 Vali Acc: 0.540 Test Loss: 1.274 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3987994194030762
Epoch: 14, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.164 Vali Acc: 0.540 Test Loss: 1.164 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2153606414794922
Epoch: 15, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.197 Vali Acc: 0.580 Test Loss: 1.197 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4548261165618896
Epoch: 16, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.723 Vali Acc: 0.600 Test Loss: 1.723 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3463761806488037
Epoch: 17, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.476 Vali Acc: 0.570 Test Loss: 1.476 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4949455261230469
Epoch: 18, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.529 Vali Acc: 0.540 Test Loss: 1.529 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps143_str143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 43260674
model size : 179.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.198880672454834
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 0.824 Vali Acc: 0.450 Test Loss: 0.824 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.042975902557373
Epoch: 2, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
Validation loss decreased (-0.449992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.9598500728607178
Epoch: 3, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.671 Vali Acc: 0.580 Test Loss: 0.671 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.9972498416900635
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.275066614151001
Epoch: 5, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.116492509841919
Epoch: 6, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.777 Vali Acc: 0.670 Test Loss: 0.777 Test Acc: 0.670
Validation loss decreased (-0.579993 --> -0.669992).  Saving model ...
Epoch: 7 cost time: 2.007951021194458
Epoch: 7, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.994 Vali Acc: 0.540 Test Loss: 0.994 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1244425773620605
Epoch: 8, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2741270065307617
Epoch: 9, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.013 Vali Acc: 0.530 Test Loss: 1.013 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8085410594940186
Epoch: 10, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1408419609069824
Epoch: 11, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.137 Vali Acc: 0.590 Test Loss: 1.137 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.057725191116333
Epoch: 12, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.198 Vali Acc: 0.510 Test Loss: 1.198 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1687910556793213
Epoch: 13, Steps: 18 | Train Loss: 0.400 Vali Loss: 1.122 Vali Acc: 0.520 Test Loss: 1.122 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.186272144317627
Epoch: 14, Steps: 18 | Train Loss: 0.368 Vali Loss: 2.427 Vali Acc: 0.540 Test Loss: 2.427 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1010332107543945
Epoch: 15, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.636 Vali Acc: 0.460 Test Loss: 1.636 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8935770988464355
Epoch: 16, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.655 Vali Acc: 0.500 Test Loss: 1.655 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 44464898
model size : 184.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.644488573074341
Epoch: 1, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.676 Vali Acc: 0.610 Test Loss: 0.676 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.5668776035308838
Epoch: 2, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.681 Vali Acc: 0.570 Test Loss: 0.681 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7885756492614746
Epoch: 3, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.673 Vali Acc: 0.620 Test Loss: 0.673 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 1.4747185707092285
Epoch: 4, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5612132549285889
Epoch: 5, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.890 Vali Acc: 0.590 Test Loss: 0.890 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3470959663391113
Epoch: 6, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6515414714813232
Epoch: 7, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4435248374938965
Epoch: 8, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.068 Vali Acc: 0.510 Test Loss: 1.068 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6290969848632812
Epoch: 9, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.928 Vali Acc: 0.510 Test Loss: 0.928 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4212074279785156
Epoch: 10, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.916 Vali Acc: 0.480 Test Loss: 0.916 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5634419918060303
Epoch: 11, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.110 Vali Acc: 0.480 Test Loss: 1.110 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6754176616668701
Epoch: 12, Steps: 18 | Train Loss: 0.515 Vali Loss: 1.181 Vali Acc: 0.560 Test Loss: 1.181 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.489680528640747
Epoch: 13, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.012 Vali Acc: 0.510 Test Loss: 1.012 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 44351234
model size : 183.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.987675428390503
Epoch: 1, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.5297086238861084
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.771 Vali Acc: 0.470 Test Loss: 0.771 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5068762302398682
Epoch: 3, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5043108463287354
Epoch: 4, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5218462944030762
Epoch: 5, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4855570793151855
Epoch: 6, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.158 Vali Acc: 0.420 Test Loss: 1.158 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5233280658721924
Epoch: 7, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.871 Vali Acc: 0.510 Test Loss: 0.871 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5414888858795166
Epoch: 8, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.874 Vali Acc: 0.590 Test Loss: 0.874 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589991).  Saving model ...
Epoch: 9 cost time: 1.6001598834991455
Epoch: 9, Steps: 18 | Train Loss: 0.457 Vali Loss: 1.132 Vali Acc: 0.630 Test Loss: 1.132 Test Acc: 0.630
Validation loss decreased (-0.589991 --> -0.629989).  Saving model ...
Epoch: 10 cost time: 1.4405767917633057
Epoch: 10, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.864 Vali Acc: 0.510 Test Loss: 0.864 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5902650356292725
Epoch: 11, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.012 Vali Acc: 0.520 Test Loss: 1.012 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.458604335784912
Epoch: 12, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.131 Vali Acc: 0.480 Test Loss: 1.131 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.38381028175354
Epoch: 13, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.460 Vali Acc: 0.450 Test Loss: 1.460 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4508962631225586
Epoch: 14, Steps: 18 | Train Loss: 0.421 Vali Loss: 1.432 Vali Acc: 0.540 Test Loss: 1.432 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4054715633392334
Epoch: 15, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.113 Vali Acc: 0.510 Test Loss: 1.113 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3884809017181396
Epoch: 16, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.377 Vali Acc: 0.550 Test Loss: 1.377 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3266558647155762
Epoch: 17, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.362 Vali Acc: 0.470 Test Loss: 1.362 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4080934524536133
Epoch: 18, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.376 Vali Acc: 0.530 Test Loss: 1.376 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4875075817108154
Epoch: 19, Steps: 18 | Train Loss: 0.266 Vali Loss: 2.212 Vali Acc: 0.470 Test Loss: 2.212 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 44292866
model size : 183.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps158_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.415201425552368
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.7299575805664062
Epoch: 2, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.747 Vali Acc: 0.460 Test Loss: 0.747 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8261511325836182
Epoch: 3, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 2.178454637527466
Epoch: 4, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.710 Vali Acc: 0.560 Test Loss: 0.710 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.1195356845855713
Epoch: 5, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9514851570129395
Epoch: 6, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.821 Vali Acc: 0.580 Test Loss: 0.821 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 2.07875919342041
Epoch: 7, Steps: 18 | Train Loss: 0.577 Vali Loss: 1.120 Vali Acc: 0.510 Test Loss: 1.120 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1301803588867188
Epoch: 8, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.878 Vali Acc: 0.470 Test Loss: 0.878 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.107840061187744
Epoch: 9, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.744 Vali Acc: 0.590 Test Loss: 0.744 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 2.2149240970611572
Epoch: 10, Steps: 18 | Train Loss: 0.432 Vali Loss: 1.177 Vali Acc: 0.460 Test Loss: 1.177 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0421698093414307
Epoch: 11, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2538938522338867
Epoch: 12, Steps: 18 | Train Loss: 0.452 Vali Loss: 1.175 Vali Acc: 0.510 Test Loss: 1.175 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9966130256652832
Epoch: 13, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.994 Vali Acc: 0.510 Test Loss: 0.994 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0579023361206055
Epoch: 14, Steps: 18 | Train Loss: 0.420 Vali Loss: 1.415 Vali Acc: 0.440 Test Loss: 1.415 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1216249465942383
Epoch: 15, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8925871849060059
Epoch: 16, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.242 Vali Acc: 0.460 Test Loss: 1.242 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.327397346496582
Epoch: 17, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.593 Vali Acc: 0.530 Test Loss: 1.593 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0761537551879883
Epoch: 18, Steps: 18 | Train Loss: 0.366 Vali Loss: 1.343 Vali Acc: 0.510 Test Loss: 1.343 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9458794593811035
Epoch: 19, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps158_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 45632258
model size : 188.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps158_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7401771545410156
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.707 Vali Acc: 0.610 Test Loss: 0.707 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.3810813426971436
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.347684383392334
Epoch: 3, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.929 Vali Acc: 0.430 Test Loss: 0.929 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6779530048370361
Epoch: 4, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.681 Vali Acc: 0.560 Test Loss: 0.681 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5596692562103271
Epoch: 5, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.600944995880127
Epoch: 6, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5504837036132812
Epoch: 7, Steps: 18 | Train Loss: 0.518 Vali Loss: 1.486 Vali Acc: 0.500 Test Loss: 1.486 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4393103122711182
Epoch: 8, Steps: 18 | Train Loss: 0.454 Vali Loss: 0.986 Vali Acc: 0.500 Test Loss: 0.986 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6197357177734375
Epoch: 9, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.188 Vali Acc: 0.490 Test Loss: 1.188 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3616325855255127
Epoch: 10, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.998 Vali Acc: 0.470 Test Loss: 0.998 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8149254322052002
Epoch: 11, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.762 Vali Acc: 0.530 Test Loss: 1.762 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps158_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 45521666
model size : 188.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps158_str158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.01175856590271
Epoch: 1, Steps: 18 | Train Loss: 0.824 Vali Loss: 0.793 Vali Acc: 0.560 Test Loss: 0.793 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 1.7067584991455078
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4949584007263184
Epoch: 3, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7632408142089844
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5975267887115479
Epoch: 5, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5973851680755615
Epoch: 6, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.957 Vali Acc: 0.510 Test Loss: 0.957 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6182494163513184
Epoch: 7, Steps: 18 | Train Loss: 0.485 Vali Loss: 1.029 Vali Acc: 0.560 Test Loss: 1.029 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8908929824829102
Epoch: 8, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.926 Vali Acc: 0.520 Test Loss: 0.926 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7638654708862305
Epoch: 9, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.964 Vali Acc: 0.530 Test Loss: 0.964 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6393494606018066
Epoch: 10, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.044 Vali Acc: 0.530 Test Loss: 1.044 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.90090012550354
Epoch: 11, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.081 Vali Acc: 0.520 Test Loss: 1.081 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps158_str158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 45466370
model size : 188.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1108293533325195
Epoch: 1, Steps: 18 | Train Loss: 0.768 Vali Loss: 0.914 Vali Acc: 0.510 Test Loss: 0.914 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 1.8760385513305664
Epoch: 2, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8440847396850586
Epoch: 3, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.7330548763275146
Epoch: 4, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9176132678985596
Epoch: 5, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.894 Vali Acc: 0.530 Test Loss: 0.894 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6651873588562012
Epoch: 6, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.797 Vali Acc: 0.590 Test Loss: 0.797 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.7166955471038818
Epoch: 7, Steps: 18 | Train Loss: 0.582 Vali Loss: 1.034 Vali Acc: 0.430 Test Loss: 1.034 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9746451377868652
Epoch: 8, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.759 Vali Acc: 0.600 Test Loss: 0.759 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 9 cost time: 2.02890944480896
Epoch: 9, Steps: 18 | Train Loss: 0.538 Vali Loss: 0.920 Vali Acc: 0.560 Test Loss: 0.920 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6716318130493164
Epoch: 10, Steps: 18 | Train Loss: 0.599 Vali Loss: 1.074 Vali Acc: 0.540 Test Loss: 1.074 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.989475965499878
Epoch: 11, Steps: 18 | Train Loss: 0.437 Vali Loss: 1.559 Vali Acc: 0.510 Test Loss: 1.559 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.022716999053955
Epoch: 12, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.760 Vali Acc: 0.490 Test Loss: 1.760 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0902721881866455
Epoch: 13, Steps: 18 | Train Loss: 0.520 Vali Loss: 1.145 Vali Acc: 0.590 Test Loss: 1.145 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.11377215385437
Epoch: 14, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.190 Vali Acc: 0.560 Test Loss: 1.190 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0438930988311768
Epoch: 15, Steps: 18 | Train Loss: 0.403 Vali Loss: 1.420 Vali Acc: 0.510 Test Loss: 1.420 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.009709596633911
Epoch: 16, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.941 Vali Acc: 0.440 Test Loss: 1.941 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1882190704345703
Epoch: 17, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.833 Vali Acc: 0.570 Test Loss: 1.833 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9014098644256592
Epoch: 18, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.796 Vali Acc: 0.510 Test Loss: 1.796 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 46947074
model size : 193.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.853642702102661
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.8708369731903076
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.690 Vali Acc: 0.530 Test Loss: 0.690 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.44480037689209
Epoch: 3, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.071657657623291
Epoch: 4, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.740 Vali Acc: 0.590 Test Loss: 0.740 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.475433111190796
Epoch: 5, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.772 Vali Acc: 0.600 Test Loss: 0.772 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.074502468109131
Epoch: 6, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.948 Vali Acc: 0.530 Test Loss: 0.948 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2797489166259766
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.221 Vali Acc: 0.530 Test Loss: 1.221 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5681803226470947
Epoch: 8, Steps: 18 | Train Loss: 0.457 Vali Loss: 1.283 Vali Acc: 0.570 Test Loss: 1.283 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1289074420928955
Epoch: 9, Steps: 18 | Train Loss: 0.497 Vali Loss: 1.243 Vali Acc: 0.560 Test Loss: 1.243 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3381707668304443
Epoch: 10, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3461966514587402
Epoch: 11, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.932 Vali Acc: 0.510 Test Loss: 0.932 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.558457612991333
Epoch: 12, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.950 Vali Acc: 0.550 Test Loss: 0.950 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9376263618469238
Epoch: 13, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.159 Vali Acc: 0.570 Test Loss: 1.159 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.563645362854004
Epoch: 14, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.056 Vali Acc: 0.610 Test Loss: 1.056 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609989).  Saving model ...
Epoch: 15 cost time: 2.1095800399780273
Epoch: 15, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.412092924118042
Epoch: 16, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.364 Vali Acc: 0.540 Test Loss: 1.364 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.284588575363159
Epoch: 17, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.413 Vali Acc: 0.510 Test Loss: 1.413 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5727806091308594
Epoch: 18, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.277 Vali Acc: 0.510 Test Loss: 1.277 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0033118724823
Epoch: 19, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.281 Vali Acc: 0.540 Test Loss: 1.281 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.521920919418335
Epoch: 20, Steps: 18 | Train Loss: 0.171 Vali Loss: 2.002 Vali Acc: 0.520 Test Loss: 2.002 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6104063987731934
Epoch: 21, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.547 Vali Acc: 0.520 Test Loss: 1.547 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.228938102722168
Epoch: 22, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.503 Vali Acc: 0.540 Test Loss: 1.503 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.562870979309082
Epoch: 23, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.629 Vali Acc: 0.550 Test Loss: 1.629 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3007924556732178
Epoch: 24, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.968 Vali Acc: 0.510 Test Loss: 1.968 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 46842626
model size : 193.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6899971961975098
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.676 Vali Acc: 0.610 Test Loss: 0.676 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 2.1165621280670166
Epoch: 2, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4312829971313477
Epoch: 3, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.689 Vali Acc: 0.600 Test Loss: 0.689 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9751691818237305
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2022500038146973
Epoch: 5, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4147539138793945
Epoch: 6, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.821 Vali Acc: 0.570 Test Loss: 0.821 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.890446424484253
Epoch: 7, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.966 Vali Acc: 0.570 Test Loss: 0.966 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.206275224685669
Epoch: 8, Steps: 18 | Train Loss: 0.423 Vali Loss: 0.837 Vali Acc: 0.600 Test Loss: 0.837 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4348013401031494
Epoch: 9, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9354641437530518
Epoch: 10, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.822 Vali Acc: 0.570 Test Loss: 0.822 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.144737482070923
Epoch: 11, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.007 Vali Acc: 0.510 Test Loss: 1.007 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 46790402
model size : 193.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps177_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9226388931274414
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.253748655319214
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.717 Vali Acc: 0.580 Test Loss: 0.717 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.449681520462036
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7422873973846436
Epoch: 4, Steps: 18 | Train Loss: 0.607 Vali Loss: 1.076 Vali Acc: 0.450 Test Loss: 1.076 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.94053316116333
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3663740158081055
Epoch: 6, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.850 Vali Acc: 0.620 Test Loss: 0.850 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619991).  Saving model ...
Epoch: 7 cost time: 3.084618330001831
Epoch: 7, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7248833179473877
Epoch: 8, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.499953269958496
Epoch: 9, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.211 Vali Acc: 0.530 Test Loss: 1.211 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.972322463989258
Epoch: 10, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.942 Vali Acc: 0.520 Test Loss: 0.942 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3978936672210693
Epoch: 11, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9850614070892334
Epoch: 12, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4908058643341064
Epoch: 13, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.426 Vali Acc: 0.460 Test Loss: 1.426 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.74458384513855
Epoch: 14, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.160 Vali Acc: 0.530 Test Loss: 1.160 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.013040065765381
Epoch: 15, Steps: 18 | Train Loss: 0.437 Vali Loss: 1.058 Vali Acc: 0.570 Test Loss: 1.058 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6207635402679443
Epoch: 16, Steps: 18 | Train Loss: 0.447 Vali Loss: 2.093 Vali Acc: 0.480 Test Loss: 2.093 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps177_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 48406274
model size : 199.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps177_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.806938409805298
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.5496025085449219
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.888 Vali Acc: 0.430 Test Loss: 0.888 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5025196075439453
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.8593556880950928
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0808377265930176
Epoch: 5, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.822 Vali Acc: 0.610 Test Loss: 0.822 Test Acc: 0.610
Validation loss decreased (-0.529993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 1.7767126560211182
Epoch: 6, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.808 Vali Acc: 0.590 Test Loss: 0.808 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.094076633453369
Epoch: 7, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7099971771240234
Epoch: 8, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.914 Vali Acc: 0.550 Test Loss: 0.914 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9849944114685059
Epoch: 9, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.095 Vali Acc: 0.580 Test Loss: 1.095 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7817606925964355
Epoch: 10, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.126 Vali Acc: 0.480 Test Loss: 1.126 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.105522632598877
Epoch: 11, Steps: 18 | Train Loss: 0.487 Vali Loss: 1.014 Vali Acc: 0.580 Test Loss: 1.014 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9066267013549805
Epoch: 12, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.558 Vali Acc: 0.610 Test Loss: 1.558 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2040910720825195
Epoch: 13, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8476176261901855
Epoch: 14, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.283 Vali Acc: 0.560 Test Loss: 1.283 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1829254627227783
Epoch: 15, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps177_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 48311042
model size : 198.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps177_str177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.110077381134033
Epoch: 1, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.871880292892456
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8283965587615967
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9263312816619873
Epoch: 4, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0061609745025635
Epoch: 5, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.676 Vali Acc: 0.590 Test Loss: 0.676 Test Acc: 0.590
Validation loss decreased (-0.509992 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 1.963019847869873
Epoch: 6, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.051 Vali Acc: 0.490 Test Loss: 1.051 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.729177474975586
Epoch: 7, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.896 Vali Acc: 0.490 Test Loss: 0.896 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9815196990966797
Epoch: 8, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.889 Vali Acc: 0.520 Test Loss: 0.889 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8702516555786133
Epoch: 9, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9051802158355713
Epoch: 10, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.012 Vali Acc: 0.540 Test Loss: 1.012 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8143272399902344
Epoch: 11, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.007 Vali Acc: 0.550 Test Loss: 1.007 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7984910011291504
Epoch: 12, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.021 Vali Acc: 0.560 Test Loss: 1.021 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.786454677581787
Epoch: 13, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.185 Vali Acc: 0.580 Test Loss: 1.185 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.743718147277832
Epoch: 14, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.058 Vali Acc: 0.540 Test Loss: 1.058 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.804743766784668
Epoch: 15, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.346 Vali Acc: 0.490 Test Loss: 1.346 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps177_str177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 48261890
model size : 198.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps188_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8740460872650146
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.95933198928833
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
Validation loss decreased (-0.469993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.3524258136749268
Epoch: 3, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.746 Vali Acc: 0.610 Test Loss: 0.746 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 2.243267297744751
Epoch: 4, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.675 Vali Acc: 0.550 Test Loss: 0.675 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.998307466506958
Epoch: 5, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.678 Vali Acc: 0.590 Test Loss: 0.678 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.455749750137329
Epoch: 6, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.852 Vali Acc: 0.460 Test Loss: 0.852 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3065662384033203
Epoch: 7, Steps: 18 | Train Loss: 0.454 Vali Loss: 0.872 Vali Acc: 0.510 Test Loss: 0.872 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.908881664276123
Epoch: 8, Steps: 18 | Train Loss: 0.677 Vali Loss: 2.301 Vali Acc: 0.490 Test Loss: 2.301 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.266299247741699
Epoch: 9, Steps: 18 | Train Loss: 0.672 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.160395383834839
Epoch: 10, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4642863273620605
Epoch: 11, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.898 Vali Acc: 0.590 Test Loss: 0.898 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.63456654548645
Epoch: 12, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.073 Vali Acc: 0.520 Test Loss: 1.073 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.322744131088257
Epoch: 13, Steps: 18 | Train Loss: 0.310 Vali Loss: 1.643 Vali Acc: 0.440 Test Loss: 1.643 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps188_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 50019074
model size : 205.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.508244514465332
Epoch: 1, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.660 Vali Acc: 0.580 Test Loss: 0.660 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.060987949371338
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0843324661254883
Epoch: 3, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.689 Vali Acc: 0.540 Test Loss: 0.689 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0786290168762207
Epoch: 4, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0397729873657227
Epoch: 5, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7677600383758545
Epoch: 6, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6776463985443115
Epoch: 7, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.982 Vali Acc: 0.540 Test Loss: 0.982 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.690511703491211
Epoch: 8, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.084 Vali Acc: 0.480 Test Loss: 1.084 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7471566200256348
Epoch: 9, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.936 Vali Acc: 0.540 Test Loss: 0.936 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1332645416259766
Epoch: 10, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.019 Vali Acc: 0.510 Test Loss: 1.019 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7634944915771484
Epoch: 11, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.063 Vali Acc: 0.580 Test Loss: 1.063 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 49926914
model size : 205.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps188_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.585963726043701
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 2.159477472305298
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.688 Vali Acc: 0.600 Test Loss: 0.688 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 2.2262327671051025
Epoch: 3, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.896730899810791
Epoch: 4, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.648613691329956
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.045074939727783
Epoch: 6, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.853 Vali Acc: 0.540 Test Loss: 0.853 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0943045616149902
Epoch: 7, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.15092396736145
Epoch: 8, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1013224124908447
Epoch: 9, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0645742416381836
Epoch: 10, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.966 Vali Acc: 0.550 Test Loss: 0.966 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9717152118682861
Epoch: 11, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.870 Vali Acc: 0.530 Test Loss: 0.870 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7440521717071533
Epoch: 12, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.178 Vali Acc: 0.590 Test Loss: 1.178 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps188_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 49880834
model size : 204.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.025359392166138
Epoch: 1, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.739 Vali Acc: 0.590 Test Loss: 0.739 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 2.5402028560638428
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.767 Vali Acc: 0.590 Test Loss: 0.767 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.530555486679077
Epoch: 3, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.984 Vali Acc: 0.540 Test Loss: 0.984 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5564210414886475
Epoch: 4, Steps: 18 | Train Loss: 0.739 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6815550327301025
Epoch: 5, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.728 Vali Acc: 0.610 Test Loss: 0.728 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 2.353311061859131
Epoch: 6, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.712 Vali Acc: 0.580 Test Loss: 0.712 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6792259216308594
Epoch: 7, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.964 Vali Acc: 0.480 Test Loss: 0.964 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3162739276885986
Epoch: 8, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6764023303985596
Epoch: 9, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6059937477111816
Epoch: 10, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.923 Vali Acc: 0.540 Test Loss: 0.923 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.68546462059021
Epoch: 11, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.894 Vali Acc: 0.570 Test Loss: 0.894 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5639114379882812
Epoch: 12, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.853 Vali Acc: 0.620 Test Loss: 0.853 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619991).  Saving model ...
Epoch: 13 cost time: 2.2673721313476562
Epoch: 13, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6580991744995117
Epoch: 14, Steps: 18 | Train Loss: 0.478 Vali Loss: 1.100 Vali Acc: 0.530 Test Loss: 1.100 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3359241485595703
Epoch: 15, Steps: 18 | Train Loss: 0.446 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2955563068389893
Epoch: 16, Steps: 18 | Train Loss: 0.393 Vali Loss: 1.199 Vali Acc: 0.570 Test Loss: 1.199 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8660032749176025
Epoch: 17, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.511 Vali Acc: 0.570 Test Loss: 1.511 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7772746086120605
Epoch: 18, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.873 Vali Acc: 0.510 Test Loss: 1.873 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8482530117034912
Epoch: 19, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.738 Vali Acc: 0.460 Test Loss: 1.738 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.321199655532837
Epoch: 20, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.523 Vali Acc: 0.430 Test Loss: 1.523 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9374802112579346
Epoch: 21, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.763 Vali Acc: 0.510 Test Loss: 1.763 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2652852535247803
Epoch: 22, Steps: 18 | Train Loss: 0.260 Vali Loss: 2.343 Vali Acc: 0.480 Test Loss: 2.343 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 51779330
model size : 212.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5768072605133057
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.811 Vali Acc: 0.420 Test Loss: 0.811 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 2.081050157546997
Epoch: 2, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.675 Vali Acc: 0.570 Test Loss: 0.675 Test Acc: 0.570
Validation loss decreased (-0.419992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.9055957794189453
Epoch: 3, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.720 Vali Acc: 0.570 Test Loss: 0.720 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.093912363052368
Epoch: 4, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.199169635772705
Epoch: 5, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9495196342468262
Epoch: 6, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.949 Vali Acc: 0.560 Test Loss: 0.949 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0270440578460693
Epoch: 7, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.809 Vali Acc: 0.600 Test Loss: 0.809 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 2.1141092777252197
Epoch: 8, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9088542461395264
Epoch: 9, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.041 Vali Acc: 0.490 Test Loss: 1.041 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9709994792938232
Epoch: 10, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.720 Vali Acc: 0.480 Test Loss: 1.720 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.084282875061035
Epoch: 11, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.990 Vali Acc: 0.490 Test Loss: 0.990 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9832885265350342
Epoch: 12, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.358 Vali Acc: 0.540 Test Loss: 1.358 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1967859268188477
Epoch: 13, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.173 Vali Acc: 0.520 Test Loss: 1.173 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.135274887084961
Epoch: 14, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.221 Vali Acc: 0.530 Test Loss: 1.221 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0136020183563232
Epoch: 15, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2793776988983154
Epoch: 16, Steps: 18 | Train Loss: 0.358 Vali Loss: 1.235 Vali Acc: 0.530 Test Loss: 1.235 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9655647277832031
Epoch: 17, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.222 Vali Acc: 0.490 Test Loss: 1.222 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 51693314
model size : 211.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9937987327575684
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.766 Vali Acc: 0.460 Test Loss: 0.766 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.8809235095977783
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
Validation loss decreased (-0.459992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.792428731918335
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6792235374450684
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.705876350402832
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.994 Vali Acc: 0.550 Test Loss: 0.994 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 1.7887468338012695
Epoch: 6, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.709 Vali Acc: 0.610 Test Loss: 0.709 Test Acc: 0.610
Validation loss decreased (-0.549990 --> -0.609993).  Saving model ...
Epoch: 7 cost time: 1.5550549030303955
Epoch: 7, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.745546579360962
Epoch: 8, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.995 Vali Acc: 0.530 Test Loss: 0.995 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8382346630096436
Epoch: 9, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7387185096740723
Epoch: 10, Steps: 18 | Train Loss: 0.395 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7950453758239746
Epoch: 11, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.950 Vali Acc: 0.500 Test Loss: 0.950 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6110219955444336
Epoch: 12, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7393231391906738
Epoch: 13, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.799858570098877
Epoch: 14, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.273 Vali Acc: 0.600 Test Loss: 1.273 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.786689281463623
Epoch: 15, Steps: 18 | Train Loss: 0.314 Vali Loss: 1.344 Vali Acc: 0.600 Test Loss: 1.344 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7164068222045898
Epoch: 16, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.014 Vali Acc: 0.460 Test Loss: 2.014 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 51650306
model size : 211.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps215_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3687262535095215
Epoch: 1, Steps: 18 | Train Loss: 0.802 Vali Loss: 0.679 Vali Acc: 0.580 Test Loss: 0.679 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.87650728225708
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.744551181793213
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.735 Vali Acc: 0.570 Test Loss: 0.735 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7361619472503662
Epoch: 4, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.873 Vali Acc: 0.530 Test Loss: 0.873 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6947541236877441
Epoch: 5, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.831 Vali Acc: 0.590 Test Loss: 0.831 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.264972448348999
Epoch: 6, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.43533992767334
Epoch: 7, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4961886405944824
Epoch: 8, Steps: 18 | Train Loss: 0.458 Vali Loss: 1.347 Vali Acc: 0.460 Test Loss: 1.347 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.42252254486084
Epoch: 9, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.947 Vali Acc: 0.570 Test Loss: 0.947 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7782881259918213
Epoch: 10, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.966 Vali Acc: 0.520 Test Loss: 0.966 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.545799732208252
Epoch: 11, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.161 Vali Acc: 0.620 Test Loss: 1.161 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619988).  Saving model ...
Epoch: 12 cost time: 1.816171407699585
Epoch: 12, Steps: 18 | Train Loss: 0.512 Vali Loss: 1.129 Vali Acc: 0.470 Test Loss: 1.129 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.474357843399048
Epoch: 13, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.232 Vali Acc: 0.460 Test Loss: 1.232 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4328157901763916
Epoch: 14, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.925 Vali Acc: 0.460 Test Loss: 1.925 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4143683910369873
Epoch: 15, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.904 Vali Acc: 0.540 Test Loss: 1.904 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2226879596710205
Epoch: 16, Steps: 18 | Train Loss: 0.250 Vali Loss: 2.343 Vali Acc: 0.530 Test Loss: 2.343 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.132646083831787
Epoch: 17, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.444 Vali Acc: 0.480 Test Loss: 1.444 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.236067056655884
Epoch: 18, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.263 Vali Acc: 0.510 Test Loss: 2.263 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.262842893600464
Epoch: 19, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.965 Vali Acc: 0.540 Test Loss: 1.965 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4789304733276367
Epoch: 20, Steps: 18 | Train Loss: 0.385 Vali Loss: 1.538 Vali Acc: 0.540 Test Loss: 1.538 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2662954330444336
Epoch: 21, Steps: 18 | Train Loss: 0.239 Vali Loss: 2.185 Vali Acc: 0.510 Test Loss: 2.185 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps215_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 53975810
model size : 220.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps215_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.631221055984497
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.1658284664154053
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.1876516342163086
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.762 Vali Acc: 0.450 Test Loss: 0.762 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.143362045288086
Epoch: 4, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.697 Vali Acc: 0.540 Test Loss: 0.697 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.223533868789673
Epoch: 5, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.974271535873413
Epoch: 6, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.794 Vali Acc: 0.580 Test Loss: 0.794 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1831538677215576
Epoch: 7, Steps: 18 | Train Loss: 0.559 Vali Loss: 1.005 Vali Acc: 0.590 Test Loss: 1.005 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589990).  Saving model ...
Epoch: 8 cost time: 1.9122037887573242
Epoch: 8, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.772 Vali Acc: 0.620 Test Loss: 0.772 Test Acc: 0.620
Validation loss decreased (-0.589990 --> -0.619992).  Saving model ...
Epoch: 9 cost time: 2.1374378204345703
Epoch: 9, Steps: 18 | Train Loss: 0.375 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6381871700286865
Epoch: 10, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.810 Vali Acc: 0.630 Test Loss: 0.810 Test Acc: 0.630
Validation loss decreased (-0.619992 --> -0.629992).  Saving model ...
Epoch: 11 cost time: 2.0690836906433105
Epoch: 11, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.209470748901367
Epoch: 12, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.097 Vali Acc: 0.530 Test Loss: 1.097 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.129209518432617
Epoch: 13, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.074 Vali Acc: 0.540 Test Loss: 1.074 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.112079620361328
Epoch: 14, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.468 Vali Acc: 0.530 Test Loss: 1.468 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8650476932525635
Epoch: 15, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.035 Vali Acc: 0.490 Test Loss: 1.035 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0208845138549805
Epoch: 16, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.148 Vali Acc: 0.610 Test Loss: 1.148 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.214893341064453
Epoch: 17, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.279 Vali Acc: 0.600 Test Loss: 1.279 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9471855163574219
Epoch: 18, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.458 Vali Acc: 0.520 Test Loss: 1.458 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.473783016204834
Epoch: 19, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.491 Vali Acc: 0.590 Test Loss: 1.491 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.183716297149658
Epoch: 20, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.951 Vali Acc: 0.540 Test Loss: 1.951 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps215_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 53895938
model size : 220.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps215_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5691113471984863
Epoch: 1, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.785 Vali Acc: 0.460 Test Loss: 0.785 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.9293599128723145
Epoch: 2, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.968 Vali Acc: 0.450 Test Loss: 0.968 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.819504976272583
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
Validation loss decreased (-0.459992 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.9572346210479736
Epoch: 4, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.8640925884246826
Epoch: 5, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.057687759399414
Epoch: 6, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9439706802368164
Epoch: 7, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.830 Vali Acc: 0.540 Test Loss: 0.830 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5132770538330078
Epoch: 8, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.885 Vali Acc: 0.450 Test Loss: 0.885 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0261752605438232
Epoch: 9, Steps: 18 | Train Loss: 0.398 Vali Loss: 0.964 Vali Acc: 0.510 Test Loss: 0.964 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.954554557800293
Epoch: 10, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.313 Vali Acc: 0.490 Test Loss: 1.313 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.01845121383667
Epoch: 11, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.096 Vali Acc: 0.580 Test Loss: 1.096 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 1.943894386291504
Epoch: 12, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.683 Vali Acc: 0.570 Test Loss: 1.683 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0143651962280273
Epoch: 13, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.917 Vali Acc: 0.430 Test Loss: 1.917 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.788149356842041
Epoch: 14, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.219 Vali Acc: 0.450 Test Loss: 1.219 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0431954860687256
Epoch: 15, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.208 Vali Acc: 0.490 Test Loss: 1.208 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.079711437225342
Epoch: 16, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.800 Vali Acc: 0.510 Test Loss: 1.800 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0847182273864746
Epoch: 17, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.558 Vali Acc: 0.450 Test Loss: 1.558 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8033089637756348
Epoch: 18, Steps: 18 | Train Loss: 0.247 Vali Loss: 2.355 Vali Acc: 0.500 Test Loss: 2.355 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.025501012802124
Epoch: 19, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.765 Vali Acc: 0.500 Test Loss: 1.765 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.087862730026245
Epoch: 20, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.496 Vali Acc: 0.470 Test Loss: 1.496 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7801530361175537
Epoch: 21, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.965 Vali Acc: 0.490 Test Loss: 1.965 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps215_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 53856002
model size : 220.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.985123634338379
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.751 Vali Acc: 0.560 Test Loss: 0.751 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 1.7195608615875244
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.688 Vali Acc: 0.620 Test Loss: 0.688 Test Acc: 0.620
Validation loss decreased (-0.559992 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 1.8406305313110352
Epoch: 3, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.705 Vali Acc: 0.520 Test Loss: 0.705 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2700421810150146
Epoch: 4, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.878 Vali Acc: 0.510 Test Loss: 0.878 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7640173435211182
Epoch: 5, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.888 Vali Acc: 0.510 Test Loss: 0.888 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2850162982940674
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8057019710540771
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.927 Vali Acc: 0.570 Test Loss: 0.927 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3144798278808594
Epoch: 8, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.983 Vali Acc: 0.580 Test Loss: 0.983 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1608529090881348
Epoch: 9, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.153 Vali Acc: 0.440 Test Loss: 1.153 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3909237384796143
Epoch: 10, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5391414165496826
Epoch: 11, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.729 Vali Acc: 0.490 Test Loss: 1.729 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4447431564331055
Epoch: 12, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.398 Vali Acc: 0.500 Test Loss: 1.398 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 56322818
model size : 229.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4925732612609863
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.683 Vali Acc: 0.560 Test Loss: 0.683 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.2244009971618652
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.704 Vali Acc: 0.480 Test Loss: 0.704 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.103534698486328
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0877861976623535
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.717 Vali Acc: 0.590 Test Loss: 0.717 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 1.9906134605407715
Epoch: 5, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0718376636505127
Epoch: 6, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.794 Vali Acc: 0.600 Test Loss: 0.794 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 2.306959390640259
Epoch: 7, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.930 Vali Acc: 0.510 Test Loss: 0.930 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.958599328994751
Epoch: 8, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.114657163619995
Epoch: 9, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.910 Vali Acc: 0.580 Test Loss: 0.910 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0626721382141113
Epoch: 10, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.960 Vali Acc: 0.610 Test Loss: 0.960 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609990).  Saving model ...
Epoch: 11 cost time: 2.1623942852020264
Epoch: 11, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.343 Vali Acc: 0.540 Test Loss: 1.343 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.058955192565918
Epoch: 12, Steps: 18 | Train Loss: 0.579 Vali Loss: 1.322 Vali Acc: 0.520 Test Loss: 1.322 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3598577976226807
Epoch: 13, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.103 Vali Acc: 0.510 Test Loss: 1.103 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.943411111831665
Epoch: 14, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.246 Vali Acc: 0.490 Test Loss: 1.246 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2417917251586914
Epoch: 15, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.292 Vali Acc: 0.470 Test Loss: 1.292 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.254122495651245
Epoch: 16, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.385 Vali Acc: 0.550 Test Loss: 1.385 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1646065711975098
Epoch: 17, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.607 Vali Acc: 0.520 Test Loss: 1.607 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.08434796333313
Epoch: 18, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3276944160461426
Epoch: 19, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.459 Vali Acc: 0.500 Test Loss: 1.459 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.047680377960205
Epoch: 20, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.643 Vali Acc: 0.470 Test Loss: 1.643 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 56249090
model size : 229.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1298351287841797
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.731424331665039
Epoch: 2, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8712491989135742
Epoch: 3, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.8147544860839844
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.753 Vali Acc: 0.580 Test Loss: 0.753 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.7285480499267578
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.631744384765625
Epoch: 6, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.993 Vali Acc: 0.480 Test Loss: 0.993 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7187106609344482
Epoch: 7, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.591520071029663
Epoch: 8, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.742572546005249
Epoch: 9, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.014 Vali Acc: 0.490 Test Loss: 1.014 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8750147819519043
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.827 Vali Acc: 0.590 Test Loss: 0.827 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 1.8921213150024414
Epoch: 11, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.946 Vali Acc: 0.550 Test Loss: 0.946 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7704970836639404
Epoch: 12, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.023 Vali Acc: 0.520 Test Loss: 1.023 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8660118579864502
Epoch: 13, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9855976104736328
Epoch: 14, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.186 Vali Acc: 0.560 Test Loss: 1.186 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.833073616027832
Epoch: 15, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.008 Vali Acc: 0.470 Test Loss: 1.008 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9142522811889648
Epoch: 16, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.152 Vali Acc: 0.580 Test Loss: 1.152 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5610456466674805
Epoch: 17, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8182389736175537
Epoch: 18, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.365 Vali Acc: 0.520 Test Loss: 1.365 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.855194091796875
Epoch: 19, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.616 Vali Acc: 0.510 Test Loss: 1.616 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7936198711395264
Epoch: 20, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.250 Vali Acc: 0.510 Test Loss: 1.250 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 56212226
model size : 229.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3741517066955566
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.2094311714172363
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8678946495056152
Epoch: 3, Steps: 18 | Train Loss: 0.657 Vali Loss: 1.010 Vali Acc: 0.510 Test Loss: 1.010 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.147820234298706
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.936 Vali Acc: 0.480 Test Loss: 0.936 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3490042686462402
Epoch: 5, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.072254180908203
Epoch: 6, Steps: 18 | Train Loss: 0.545 Vali Loss: 1.263 Vali Acc: 0.440 Test Loss: 1.263 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1506972312927246
Epoch: 7, Steps: 18 | Train Loss: 0.476 Vali Loss: 1.101 Vali Acc: 0.490 Test Loss: 1.101 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3041157722473145
Epoch: 8, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.153 Vali Acc: 0.490 Test Loss: 1.153 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.198529005050659
Epoch: 9, Steps: 18 | Train Loss: 0.463 Vali Loss: 1.171 Vali Acc: 0.560 Test Loss: 1.171 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 2.111687660217285
Epoch: 10, Steps: 18 | Train Loss: 0.517 Vali Loss: 1.212 Vali Acc: 0.520 Test Loss: 1.212 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.013549566268921
Epoch: 11, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.958 Vali Acc: 0.510 Test Loss: 0.958 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2366764545440674
Epoch: 12, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.122 Vali Acc: 0.480 Test Loss: 1.122 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3359405994415283
Epoch: 13, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.265 Vali Acc: 0.490 Test Loss: 1.265 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2416253089904785
Epoch: 14, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.441 Vali Acc: 0.530 Test Loss: 1.441 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1133391857147217
Epoch: 15, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.655 Vali Acc: 0.470 Test Loss: 1.655 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2240631580352783
Epoch: 16, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.512 Vali Acc: 0.460 Test Loss: 1.512 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.364885091781616
Epoch: 17, Steps: 18 | Train Loss: 0.488 Vali Loss: 2.194 Vali Acc: 0.430 Test Loss: 2.194 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.832617998123169
Epoch: 18, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.593 Vali Acc: 0.480 Test Loss: 1.593 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7992775440216064
Epoch: 19, Steps: 18 | Train Loss: 0.145 Vali Loss: 2.366 Vali Acc: 0.520 Test Loss: 2.366 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 59112194
model size : 240.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.094449281692505
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.653 Vali Acc: 0.620 Test Loss: 0.653 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 2.1279563903808594
Epoch: 2, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0574522018432617
Epoch: 3, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.740 Vali Acc: 0.610 Test Loss: 0.740 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5757758617401123
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1150403022766113
Epoch: 5, Steps: 18 | Train Loss: 0.482 Vali Loss: 1.207 Vali Acc: 0.480 Test Loss: 1.207 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5079710483551025
Epoch: 6, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.874 Vali Acc: 0.480 Test Loss: 0.874 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.190640926361084
Epoch: 7, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.967 Vali Acc: 0.440 Test Loss: 0.967 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5543065071105957
Epoch: 8, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.925 Vali Acc: 0.510 Test Loss: 0.925 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3190174102783203
Epoch: 9, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.008 Vali Acc: 0.450 Test Loss: 1.008 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.435063600540161
Epoch: 10, Steps: 18 | Train Loss: 0.411 Vali Loss: 1.148 Vali Acc: 0.450 Test Loss: 1.148 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.295391798019409
Epoch: 11, Steps: 18 | Train Loss: 0.310 Vali Loss: 1.086 Vali Acc: 0.450 Test Loss: 1.086 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 59047682
model size : 239.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5507688522338867
Epoch: 1, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.705 Vali Acc: 0.590 Test Loss: 0.705 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 2.309385299682617
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.189645290374756
Epoch: 3, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.698 Vali Acc: 0.470 Test Loss: 0.698 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2523386478424072
Epoch: 4, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.062319278717041
Epoch: 5, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2570013999938965
Epoch: 6, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6864917278289795
Epoch: 7, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.950 Vali Acc: 0.460 Test Loss: 0.950 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.636584997177124
Epoch: 8, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.973 Vali Acc: 0.550 Test Loss: 0.973 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6657123565673828
Epoch: 9, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.968 Vali Acc: 0.490 Test Loss: 0.968 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6949379444122314
Epoch: 10, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.397 Vali Acc: 0.410 Test Loss: 1.397 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6750717163085938
Epoch: 11, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.022 Vali Acc: 0.560 Test Loss: 1.022 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 59013890
model size : 239.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps273_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.552443265914917
Epoch: 1, Steps: 18 | Train Loss: 0.780 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.463893413543701
Epoch: 2, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.716 Vali Acc: 0.580 Test Loss: 0.716 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.1914100646972656
Epoch: 3, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.842 Vali Acc: 0.440 Test Loss: 0.842 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.399972915649414
Epoch: 4, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.821 Vali Acc: 0.470 Test Loss: 0.821 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.478076457977295
Epoch: 5, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.910 Vali Acc: 0.620 Test Loss: 0.910 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619991).  Saving model ...
Epoch: 6 cost time: 2.4288265705108643
Epoch: 6, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.982 Vali Acc: 0.550 Test Loss: 0.982 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.352315902709961
Epoch: 7, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.938 Vali Acc: 0.550 Test Loss: 0.938 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4188265800476074
Epoch: 8, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.029 Vali Acc: 0.570 Test Loss: 1.029 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5144219398498535
Epoch: 9, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.173 Vali Acc: 0.460 Test Loss: 1.173 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3189260959625244
Epoch: 10, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.431438684463501
Epoch: 11, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.393 Vali Acc: 0.460 Test Loss: 1.393 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.627957820892334
Epoch: 12, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.278 Vali Acc: 0.440 Test Loss: 1.278 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.611739158630371
Epoch: 13, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.432 Vali Acc: 0.530 Test Loss: 1.432 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2615151405334473
Epoch: 14, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.579 Vali Acc: 0.440 Test Loss: 1.579 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0330443382263184
Epoch: 15, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.638 Vali Acc: 0.550 Test Loss: 1.638 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps273_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 62491394
model size : 253.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps273_str137_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7613747119903564
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.355834722518921
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.718 Vali Acc: 0.590 Test Loss: 0.718 Test Acc: 0.590
Validation loss decreased (-0.479993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.116950035095215
Epoch: 3, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.859 Vali Acc: 0.600 Test Loss: 0.859 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 2.152381658554077
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.823723554611206
Epoch: 5, Steps: 18 | Train Loss: 0.539 Vali Loss: 1.003 Vali Acc: 0.580 Test Loss: 1.003 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.13485050201416
Epoch: 6, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.809 Vali Acc: 0.600 Test Loss: 0.809 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 2.246504545211792
Epoch: 7, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.797 Vali Acc: 0.590 Test Loss: 0.797 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1738011837005615
Epoch: 8, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.24092698097229
Epoch: 9, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.227 Vali Acc: 0.530 Test Loss: 1.227 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0538225173950195
Epoch: 10, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.181262493133545
Epoch: 11, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.364 Vali Acc: 0.520 Test Loss: 1.364 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2536141872406006
Epoch: 12, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.211 Vali Acc: 0.540 Test Loss: 1.211 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.058689832687378
Epoch: 13, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.144 Vali Acc: 0.530 Test Loss: 1.144 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2050206661224365
Epoch: 14, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.671 Vali Acc: 0.490 Test Loss: 1.671 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9334971904754639
Epoch: 15, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.347 Vali Acc: 0.440 Test Loss: 1.347 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2306957244873047
Epoch: 16, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.137 Vali Acc: 0.530 Test Loss: 1.137 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps273_str137_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 62429954
model size : 252.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps273_str273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2794103622436523
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.682 Vali Acc: 0.520 Test Loss: 0.682 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.957367181777954
Epoch: 2, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.671 Vali Acc: 0.600 Test Loss: 0.671 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 1.9381046295166016
Epoch: 3, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.816 Vali Acc: 0.470 Test Loss: 0.816 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.108577251434326
Epoch: 4, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.748 Vali Acc: 0.560 Test Loss: 0.748 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1161787509918213
Epoch: 5, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.806 Vali Acc: 0.550 Test Loss: 0.806 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9513895511627197
Epoch: 6, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7441248893737793
Epoch: 7, Steps: 18 | Train Loss: 0.375 Vali Loss: 0.961 Vali Acc: 0.500 Test Loss: 0.961 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6098377704620361
Epoch: 8, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.969 Vali Acc: 0.580 Test Loss: 0.969 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.606588363647461
Epoch: 9, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.214 Vali Acc: 0.510 Test Loss: 1.214 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5545475482940674
Epoch: 10, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.068 Vali Acc: 0.480 Test Loss: 1.068 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.922334909439087
Epoch: 11, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.324 Vali Acc: 0.510 Test Loss: 1.324 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8114209175109863
Epoch: 12, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.275 Vali Acc: 0.490 Test Loss: 1.275 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps273_str273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 62399234
model size : 252.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps300_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.551255226135254
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.744 Vali Acc: 0.450 Test Loss: 0.744 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.1104304790496826
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.681 Vali Acc: 0.540 Test Loss: 0.681 Test Acc: 0.540
Validation loss decreased (-0.449993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.8920273780822754
Epoch: 3, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 2.195685625076294
Epoch: 4, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.247593641281128
Epoch: 5, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.462033987045288
Epoch: 6, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3595874309539795
Epoch: 7, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.859 Vali Acc: 0.540 Test Loss: 0.859 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3368403911590576
Epoch: 8, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.65950608253479
Epoch: 9, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.961 Vali Acc: 0.470 Test Loss: 0.961 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2500317096710205
Epoch: 10, Steps: 18 | Train Loss: 0.467 Vali Loss: 1.628 Vali Acc: 0.470 Test Loss: 1.628 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2353522777557373
Epoch: 11, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.118 Vali Acc: 0.510 Test Loss: 1.118 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.365509033203125
Epoch: 12, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.186 Vali Acc: 0.520 Test Loss: 1.186 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4029479026794434
Epoch: 13, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.983 Vali Acc: 0.480 Test Loss: 1.983 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps300_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 66463490
model size : 268.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8540639877319336
Epoch: 1, Steps: 18 | Train Loss: 0.812 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.9677035808563232
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.5308408737182617
Epoch: 3, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 2.475829839706421
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.770 Vali Acc: 0.560 Test Loss: 0.770 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.036165714263916
Epoch: 5, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.792 Vali Acc: 0.450 Test Loss: 0.792 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.902292013168335
Epoch: 6, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.870 Vali Acc: 0.570 Test Loss: 0.870 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 2.7884089946746826
Epoch: 7, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.048 Vali Acc: 0.540 Test Loss: 1.048 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.493367910385132
Epoch: 8, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.125 Vali Acc: 0.510 Test Loss: 1.125 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8680050373077393
Epoch: 9, Steps: 18 | Train Loss: 0.366 Vali Loss: 1.040 Vali Acc: 0.540 Test Loss: 1.040 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.460888385772705
Epoch: 10, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.231 Vali Acc: 0.520 Test Loss: 1.231 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5143003463745117
Epoch: 11, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6814792156219482
Epoch: 12, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.397 Vali Acc: 0.470 Test Loss: 1.397 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5677335262298584
Epoch: 13, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.226 Vali Acc: 0.520 Test Loss: 1.226 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.710367441177368
Epoch: 14, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.422 Vali Acc: 0.520 Test Loss: 1.422 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.392244577407837
Epoch: 15, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.615 Vali Acc: 0.470 Test Loss: 1.615 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5815393924713135
Epoch: 16, Steps: 18 | Train Loss: 0.234 Vali Loss: 1.284 Vali Acc: 0.510 Test Loss: 1.284 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 66408194
model size : 267.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps300_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.144150018692017
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.810 Vali Acc: 0.430 Test Loss: 0.810 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 2.3550541400909424
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.830 Vali Acc: 0.500 Test Loss: 0.830 Test Acc: 0.500
Validation loss decreased (-0.429992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.42936635017395
Epoch: 3, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 2.325601577758789
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.505403995513916
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.175102949142456
Epoch: 6, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5653915405273438
Epoch: 7, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.827 Vali Acc: 0.470 Test Loss: 0.827 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4330894947052
Epoch: 8, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5365116596221924
Epoch: 9, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.862 Vali Acc: 0.570 Test Loss: 0.862 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569991).  Saving model ...
Epoch: 10 cost time: 2.41204833984375
Epoch: 10, Steps: 18 | Train Loss: 0.358 Vali Loss: 1.090 Vali Acc: 0.440 Test Loss: 1.090 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.455533981323242
Epoch: 11, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.980 Vali Acc: 0.570 Test Loss: 0.980 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.515819787979126
Epoch: 12, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.888 Vali Acc: 0.560 Test Loss: 0.888 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.635697603225708
Epoch: 13, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.164 Vali Acc: 0.490 Test Loss: 1.164 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.439838171005249
Epoch: 14, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.186 Vali Acc: 0.540 Test Loss: 1.186 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8475227355957031
Epoch: 15, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8872795104980469
Epoch: 16, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.370 Vali Acc: 0.580 Test Loss: 1.370 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579986).  Saving model ...
Epoch: 17 cost time: 1.8769850730895996
Epoch: 17, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.248 Vali Acc: 0.560 Test Loss: 1.248 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.839313268661499
Epoch: 18, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.650 Vali Acc: 0.470 Test Loss: 1.650 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.804002285003662
Epoch: 19, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.617 Vali Acc: 0.490 Test Loss: 1.617 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8606972694396973
Epoch: 20, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.718 Vali Acc: 0.490 Test Loss: 1.718 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.312047004699707
Epoch: 21, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.531 Vali Acc: 0.490 Test Loss: 1.531 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3056893348693848
Epoch: 22, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.588 Vali Acc: 0.550 Test Loss: 1.588 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.290597677230835
Epoch: 23, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.577 Vali Acc: 0.520 Test Loss: 1.577 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2510950565338135
Epoch: 24, Steps: 18 | Train Loss: 0.227 Vali Loss: 2.173 Vali Acc: 0.540 Test Loss: 2.173 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.43316912651062
Epoch: 25, Steps: 18 | Train Loss: 0.178 Vali Loss: 2.078 Vali Acc: 0.550 Test Loss: 2.078 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0120487213134766
Epoch: 26, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.347 Vali Acc: 0.450 Test Loss: 2.347 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps300_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 66380546
model size : 267.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps334_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.035539627075195
Epoch: 1, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.088587760925293
Epoch: 2, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.734 Vali Acc: 0.450 Test Loss: 0.734 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5802953243255615
Epoch: 3, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.906 Vali Acc: 0.480 Test Loss: 0.906 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479991).  Saving model ...
Epoch: 4 cost time: 2.521876335144043
Epoch: 4, Steps: 18 | Train Loss: 0.540 Vali Loss: 0.901 Vali Acc: 0.560 Test Loss: 0.901 Test Acc: 0.560
Validation loss decreased (-0.479991 --> -0.559991).  Saving model ...
Epoch: 5 cost time: 2.6405398845672607
Epoch: 5, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.903 Vali Acc: 0.450 Test Loss: 0.903 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5865039825439453
Epoch: 6, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.969 Vali Acc: 0.520 Test Loss: 0.969 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6555771827697754
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.914 Vali Acc: 0.460 Test Loss: 0.914 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6699182987213135
Epoch: 8, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.972 Vali Acc: 0.560 Test Loss: 0.972 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.627882242202759
Epoch: 9, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.580648899078369
Epoch: 10, Steps: 18 | Train Loss: 0.332 Vali Loss: 0.985 Vali Acc: 0.550 Test Loss: 0.985 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.441638469696045
Epoch: 11, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.080 Vali Acc: 0.510 Test Loss: 1.080 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.586529016494751
Epoch: 12, Steps: 18 | Train Loss: 0.246 Vali Loss: 1.339 Vali Acc: 0.490 Test Loss: 1.339 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7493247985839844
Epoch: 13, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.624 Vali Acc: 0.490 Test Loss: 1.624 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4995055198669434
Epoch: 14, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.746 Vali Acc: 0.530 Test Loss: 1.746 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps334_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 71461634
model size : 287.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps334_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6782398223876953
Epoch: 1, Steps: 18 | Train Loss: 0.747 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.394545793533325
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.3677501678466797
Epoch: 3, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.697 Vali Acc: 0.540 Test Loss: 0.697 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.4658281803131104
Epoch: 4, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3987083435058594
Epoch: 5, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.807 Vali Acc: 0.560 Test Loss: 0.807 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 2.364421844482422
Epoch: 6, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.830 Vali Acc: 0.570 Test Loss: 0.830 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 1.9351999759674072
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8570091724395752
Epoch: 8, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.854 Vali Acc: 0.620 Test Loss: 0.854 Test Acc: 0.620
Validation loss decreased (-0.569992 --> -0.619991).  Saving model ...
Epoch: 9 cost time: 1.9550654888153076
Epoch: 9, Steps: 18 | Train Loss: 0.453 Vali Loss: 1.045 Vali Acc: 0.530 Test Loss: 1.045 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.227802038192749
Epoch: 10, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.169 Vali Acc: 0.510 Test Loss: 1.169 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.11719012260437
Epoch: 11, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.140 Vali Acc: 0.570 Test Loss: 1.140 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2740533351898193
Epoch: 12, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.070 Vali Acc: 0.560 Test Loss: 1.070 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3982813358306885
Epoch: 13, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.331 Vali Acc: 0.540 Test Loss: 1.331 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.221465587615967
Epoch: 14, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.050 Vali Acc: 0.530 Test Loss: 1.050 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3575592041015625
Epoch: 15, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.089 Vali Acc: 0.520 Test Loss: 1.089 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3333356380462646
Epoch: 16, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2304282188415527
Epoch: 17, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.367 Vali Acc: 0.570 Test Loss: 1.367 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5232555866241455
Epoch: 18, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.410 Vali Acc: 0.550 Test Loss: 1.410 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps334_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 71412482
model size : 287.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps334_str334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6007800102233887
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.2382290363311768
Epoch: 2, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.745 Vali Acc: 0.460 Test Loss: 0.745 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.311338424682617
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2858388423919678
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.691 Vali Acc: 0.590 Test Loss: 0.691 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 2.1997389793395996
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.315037250518799
Epoch: 6, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.760 Vali Acc: 0.560 Test Loss: 0.760 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.155406951904297
Epoch: 7, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2082102298736572
Epoch: 8, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.922 Vali Acc: 0.570 Test Loss: 0.922 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3575081825256348
Epoch: 9, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.843 Vali Acc: 0.590 Test Loss: 0.843 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0740907192230225
Epoch: 10, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.909 Vali Acc: 0.480 Test Loss: 0.909 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2097086906433105
Epoch: 11, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.911 Vali Acc: 0.460 Test Loss: 0.911 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.376502513885498
Epoch: 12, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.005 Vali Acc: 0.550 Test Loss: 1.005 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.259141445159912
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.052 Vali Acc: 0.520 Test Loss: 1.052 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1728947162628174
Epoch: 14, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.124 Vali Acc: 0.530 Test Loss: 1.124 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps334_str334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 71387906
model size : 286.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps375_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.131380319595337
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.838 Vali Acc: 0.540 Test Loss: 0.838 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.2153847217559814
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5199825763702393
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.8535962104797363
Epoch: 4, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.4991843700408936
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.845 Vali Acc: 0.460 Test Loss: 0.845 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7022132873535156
Epoch: 6, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.817 Vali Acc: 0.610 Test Loss: 0.817 Test Acc: 0.610
Validation loss decreased (-0.549993 --> -0.609992).  Saving model ...
Epoch: 7 cost time: 2.4556429386138916
Epoch: 7, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.556993007659912
Epoch: 8, Steps: 18 | Train Loss: 0.401 Vali Loss: 1.149 Vali Acc: 0.480 Test Loss: 1.149 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6185998916625977
Epoch: 9, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6658413410186768
Epoch: 10, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.327 Vali Acc: 0.470 Test Loss: 1.327 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.54240083694458
Epoch: 11, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.118 Vali Acc: 0.470 Test Loss: 1.118 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6081461906433105
Epoch: 12, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.213 Vali Acc: 0.510 Test Loss: 1.213 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5955593585968018
Epoch: 13, Steps: 18 | Train Loss: 0.294 Vali Loss: 2.151 Vali Acc: 0.460 Test Loss: 2.151 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.582893133163452
Epoch: 14, Steps: 18 | Train Loss: 0.305 Vali Loss: 1.730 Vali Acc: 0.520 Test Loss: 1.730 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4562792778015137
Epoch: 15, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.336 Vali Acc: 0.510 Test Loss: 1.336 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7094151973724365
Epoch: 16, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps375_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 77495042
model size : 310.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.657958984375
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.691 Vali Acc: 0.590 Test Loss: 0.691 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 2.375636339187622
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.676 Vali Acc: 0.580 Test Loss: 0.676 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.994530439376831
Epoch: 3, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.693 Vali Acc: 0.600 Test Loss: 0.693 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 2.0315957069396973
Epoch: 4, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1637680530548096
Epoch: 5, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.718 Vali Acc: 0.580 Test Loss: 0.718 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.573914051055908
Epoch: 6, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.745 Vali Acc: 0.560 Test Loss: 0.745 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.332185983657837
Epoch: 7, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.749873638153076
Epoch: 8, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0602688789367676
Epoch: 9, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.823 Vali Acc: 0.510 Test Loss: 0.823 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.856973886489868
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.953 Vali Acc: 0.520 Test Loss: 0.953 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.836967945098877
Epoch: 11, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.904971122741699
Epoch: 12, Steps: 18 | Train Loss: 0.342 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6744532585144043
Epoch: 13, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 77452034
model size : 310.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps375_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.118783950805664
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.769390344619751
Epoch: 2, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.681082248687744
Epoch: 3, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5645623207092285
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.711 Vali Acc: 0.570 Test Loss: 0.711 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8137898445129395
Epoch: 5, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.902 Vali Acc: 0.550 Test Loss: 0.902 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5652353763580322
Epoch: 6, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.792 Vali Acc: 0.580 Test Loss: 0.792 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7388534545898438
Epoch: 7, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.846 Vali Acc: 0.540 Test Loss: 0.846 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7958216667175293
Epoch: 8, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.013 Vali Acc: 0.540 Test Loss: 1.013 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6822257041931152
Epoch: 9, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.008 Vali Acc: 0.570 Test Loss: 1.008 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4426429271698
Epoch: 10, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.380 Vali Acc: 0.510 Test Loss: 1.380 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.813671588897705
Epoch: 11, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps375_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 77433602
model size : 310.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps429_str108_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.583076238632202
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.705 Vali Acc: 0.600 Test Loss: 0.705 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 2.9648706912994385
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.673 Vali Acc: 0.610 Test Loss: 0.673 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 2.8888890743255615
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.672 Vali Acc: 0.560 Test Loss: 0.672 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0041608810424805
Epoch: 4, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.688 Vali Acc: 0.570 Test Loss: 0.688 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2719972133636475
Epoch: 5, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.140 Vali Acc: 0.490 Test Loss: 1.140 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.881035566329956
Epoch: 6, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.432 Vali Acc: 0.460 Test Loss: 1.432 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.146976947784424
Epoch: 7, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.873 Vali Acc: 0.540 Test Loss: 0.873 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9561381340026855
Epoch: 8, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.101 Vali Acc: 0.470 Test Loss: 1.101 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.955540657043457
Epoch: 9, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.532 Vali Acc: 0.520 Test Loss: 1.532 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.161109685897827
Epoch: 10, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.557 Vali Acc: 0.550 Test Loss: 1.557 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.9623501300811768
Epoch: 11, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.173 Vali Acc: 0.510 Test Loss: 1.173 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.2274208068847656
Epoch: 12, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.360 Vali Acc: 0.510 Test Loss: 1.360 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps429_str108_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 85445378
model size : 340.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps429_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.552480697631836
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.799 Vali Acc: 0.440 Test Loss: 0.799 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.1185336112976074
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
Validation loss decreased (-0.439992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.170661687850952
Epoch: 3, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.138195753097534
Epoch: 4, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.705 Vali Acc: 0.600 Test Loss: 0.705 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 2.668779134750366
Epoch: 5, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.944 Vali Acc: 0.560 Test Loss: 0.944 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5748887062072754
Epoch: 6, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.855 Vali Acc: 0.540 Test Loss: 0.855 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.851630210876465
Epoch: 7, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.024 Vali Acc: 0.540 Test Loss: 1.024 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.895768165588379
Epoch: 8, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.079 Vali Acc: 0.540 Test Loss: 1.079 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.33701753616333
Epoch: 9, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.578 Vali Acc: 0.520 Test Loss: 1.578 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7195706367492676
Epoch: 10, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.556 Vali Acc: 0.460 Test Loss: 1.556 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9034907817840576
Epoch: 11, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.219 Vali Acc: 0.490 Test Loss: 1.219 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8977158069610596
Epoch: 12, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.556 Vali Acc: 0.550 Test Loss: 1.556 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8462789058685303
Epoch: 13, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.689 Vali Acc: 0.520 Test Loss: 1.689 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.86842679977417
Epoch: 14, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.686 Vali Acc: 0.500 Test Loss: 1.686 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps429_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 85408514
model size : 340.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps429_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0482704639434814
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.730573892593384
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 2.8393750190734863
Epoch: 3, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.832 Vali Acc: 0.520 Test Loss: 0.832 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6345808506011963
Epoch: 4, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.457257032394409
Epoch: 5, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.887 Vali Acc: 0.440 Test Loss: 0.887 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6774752140045166
Epoch: 6, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.890 Vali Acc: 0.460 Test Loss: 0.890 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.438448190689087
Epoch: 7, Steps: 18 | Train Loss: 0.460 Vali Loss: 1.349 Vali Acc: 0.470 Test Loss: 1.349 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.475039482116699
Epoch: 8, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.874 Vali Acc: 0.470 Test Loss: 0.874 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.804565906524658
Epoch: 9, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.043 Vali Acc: 0.550 Test Loss: 1.043 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549990).  Saving model ...
Epoch: 10 cost time: 2.522338628768921
Epoch: 10, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.094 Vali Acc: 0.530 Test Loss: 1.094 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.693791389465332
Epoch: 11, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.067 Vali Acc: 0.530 Test Loss: 1.067 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5512049198150635
Epoch: 12, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.732 Vali Acc: 0.440 Test Loss: 1.732 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5681886672973633
Epoch: 13, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.056 Vali Acc: 0.470 Test Loss: 1.056 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6454100608825684
Epoch: 14, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.053 Vali Acc: 0.530 Test Loss: 1.053 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5451600551605225
Epoch: 15, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.774 Vali Acc: 0.490 Test Loss: 1.774 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5147783756256104
Epoch: 16, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.421 Vali Acc: 0.460 Test Loss: 1.421 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5816895961761475
Epoch: 17, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.462 Vali Acc: 0.430 Test Loss: 1.462 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5006422996520996
Epoch: 18, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.423 Vali Acc: 0.520 Test Loss: 1.423 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7035458087921143
Epoch: 19, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.445 Vali Acc: 0.470 Test Loss: 1.445 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps429_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 85390082
model size : 340.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.63860821723938
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.6254799365997314
Epoch: 2, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 3.1082000732421875
Epoch: 3, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5827014446258545
Epoch: 4, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.945 Vali Acc: 0.410 Test Loss: 0.945 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.889200448989868
Epoch: 5, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.380782127380371
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.895563840866089
Epoch: 7, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 3.0742805004119873
Epoch: 8, Steps: 18 | Train Loss: 0.454 Vali Loss: 0.949 Vali Acc: 0.510 Test Loss: 0.949 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.20306396484375
Epoch: 9, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.853990316390991
Epoch: 10, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.253 Vali Acc: 0.520 Test Loss: 1.253 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.088017463684082
Epoch: 11, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.626 Vali Acc: 0.470 Test Loss: 1.626 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0789222717285156
Epoch: 12, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.364 Vali Acc: 0.470 Test Loss: 1.364 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4551384449005127
Epoch: 13, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.272 Vali Acc: 0.520 Test Loss: 1.272 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.369549512863159
Epoch: 14, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.137 Vali Acc: 0.540 Test Loss: 1.137 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2174768447875977
Epoch: 15, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.511 Vali Acc: 0.500 Test Loss: 1.511 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0835487842559814
Epoch: 16, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.767 Vali Acc: 0.480 Test Loss: 1.767 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.868952512741089
Epoch: 17, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.789 Vali Acc: 0.490 Test Loss: 1.789 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 95905538
model size : 380.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.364943504333496
Epoch: 1, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.9009742736816406
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.081151247024536
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.684 Vali Acc: 0.560 Test Loss: 0.684 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 3.009925127029419
Epoch: 4, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.719 Vali Acc: 0.610 Test Loss: 0.719 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 5 cost time: 3.226350784301758
Epoch: 5, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.973 Vali Acc: 0.460 Test Loss: 0.973 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0907084941864014
Epoch: 6, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.775 Vali Acc: 0.550 Test Loss: 0.775 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0069079399108887
Epoch: 7, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.928 Vali Acc: 0.550 Test Loss: 0.928 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9761977195739746
Epoch: 8, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.965 Vali Acc: 0.540 Test Loss: 0.965 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9354476928710938
Epoch: 9, Steps: 18 | Train Loss: 0.423 Vali Loss: 0.943 Vali Acc: 0.510 Test Loss: 0.943 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.216080904006958
Epoch: 10, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.318311929702759
Epoch: 11, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.117 Vali Acc: 0.510 Test Loss: 1.117 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1697309017181396
Epoch: 12, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.143 Vali Acc: 0.550 Test Loss: 1.143 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9351704120635986
Epoch: 13, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.248 Vali Acc: 0.550 Test Loss: 1.248 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0206432342529297
Epoch: 14, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.097 Vali Acc: 0.570 Test Loss: 1.097 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 95874818
model size : 380.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.392876625061035
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.951148748397827
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.894463300704956
Epoch: 3, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.924 Vali Acc: 0.440 Test Loss: 0.924 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1693623065948486
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.038792133331299
Epoch: 5, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.827 Vali Acc: 0.480 Test Loss: 0.827 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.482451915740967
Epoch: 6, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.916 Vali Acc: 0.460 Test Loss: 0.916 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3233447074890137
Epoch: 7, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 3.141834259033203
Epoch: 8, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.857 Vali Acc: 0.520 Test Loss: 0.857 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1839053630828857
Epoch: 9, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.506 Vali Acc: 0.490 Test Loss: 1.506 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.18117356300354
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.426 Vali Acc: 0.480 Test Loss: 1.426 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.238774538040161
Epoch: 11, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.395907402038574
Epoch: 12, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.665 Vali Acc: 0.510 Test Loss: 1.665 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3241918087005615
Epoch: 13, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.358 Vali Acc: 0.550 Test Loss: 1.358 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7968811988830566
Epoch: 14, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.229 Vali Acc: 0.460 Test Loss: 1.229 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2221105098724365
Epoch: 15, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.667 Vali Acc: 0.520 Test Loss: 1.667 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.3585681915283203
Epoch: 16, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.384 Vali Acc: 0.460 Test Loss: 1.384 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1870861053466797
Epoch: 17, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.506 Vali Acc: 0.490 Test Loss: 1.506 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 95859458
model size : 380.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps600_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.189035415649414
Epoch: 1, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.7320733070373535
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 3.8099584579467773
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.00679087638855
Epoch: 4, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.728 Vali Acc: 0.580 Test Loss: 0.728 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 3.758683204650879
Epoch: 5, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.989 Vali Acc: 0.470 Test Loss: 0.989 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.844627857208252
Epoch: 6, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8488142490386963
Epoch: 7, Steps: 18 | Train Loss: 0.488 Vali Loss: 1.047 Vali Acc: 0.620 Test Loss: 1.047 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619990).  Saving model ...
Epoch: 8 cost time: 3.7816007137298584
Epoch: 8, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7429234981536865
Epoch: 9, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.944 Vali Acc: 0.540 Test Loss: 0.944 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6957831382751465
Epoch: 10, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.144 Vali Acc: 0.490 Test Loss: 1.144 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.656186103820801
Epoch: 11, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.240 Vali Acc: 0.490 Test Loss: 1.240 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.422044038772583
Epoch: 12, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9117720127105713
Epoch: 13, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.316 Vali Acc: 0.510 Test Loss: 1.316 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5460944175720215
Epoch: 14, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.439 Vali Acc: 0.500 Test Loss: 1.439 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.4082624912261963
Epoch: 15, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.484 Vali Acc: 0.510 Test Loss: 1.484 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.5182547569274902
Epoch: 16, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.587 Vali Acc: 0.510 Test Loss: 1.587 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.6851279735565186
Epoch: 17, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.560 Vali Acc: 0.500 Test Loss: 1.560 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps600_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 110638850
model size : 436.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.697275161743164
Epoch: 1, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.884 Vali Acc: 0.450 Test Loss: 0.884 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 3.5965843200683594
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
Validation loss decreased (-0.449991 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.10209059715271
Epoch: 3, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.818 Vali Acc: 0.450 Test Loss: 0.818 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2993059158325195
Epoch: 4, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 3.1597838401794434
Epoch: 5, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.905 Vali Acc: 0.540 Test Loss: 0.905 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3685390949249268
Epoch: 6, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.948 Vali Acc: 0.550 Test Loss: 0.948 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 7 cost time: 3.3835737705230713
Epoch: 7, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2277352809906006
Epoch: 8, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.973 Vali Acc: 0.510 Test Loss: 0.973 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.443014144897461
Epoch: 9, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.085 Vali Acc: 0.510 Test Loss: 1.085 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6609930992126465
Epoch: 10, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.040 Vali Acc: 0.530 Test Loss: 1.040 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.2964510917663574
Epoch: 11, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.182 Vali Acc: 0.510 Test Loss: 1.182 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.433166265487671
Epoch: 12, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.431 Vali Acc: 0.520 Test Loss: 1.431 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.355107307434082
Epoch: 13, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.309 Vali Acc: 0.460 Test Loss: 1.309 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.3748369216918945
Epoch: 14, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.723 Vali Acc: 0.470 Test Loss: 1.723 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.3807878494262695
Epoch: 15, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.556 Vali Acc: 0.460 Test Loss: 1.556 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.419583797454834
Epoch: 16, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.583 Vali Acc: 0.480 Test Loss: 1.583 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 110614274
model size : 436.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps600_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.391841173171997
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.779 Vali Acc: 0.430 Test Loss: 0.779 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 2.946782112121582
Epoch: 2, Steps: 18 | Train Loss: 0.690 Vali Loss: 0.681 Vali Acc: 0.560 Test Loss: 0.681 Test Acc: 0.560
Validation loss decreased (-0.429992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 3.191075086593628
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.682 Vali Acc: 0.590 Test Loss: 0.682 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 3.092083215713501
Epoch: 4, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.716 Vali Acc: 0.540 Test Loss: 0.716 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.263082981109619
Epoch: 5, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.370039939880371
Epoch: 6, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.262756586074829
Epoch: 7, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.977 Vali Acc: 0.530 Test Loss: 0.977 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1210098266601562
Epoch: 8, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.946 Vali Acc: 0.530 Test Loss: 0.946 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2360377311706543
Epoch: 9, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.930 Vali Acc: 0.550 Test Loss: 0.930 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4334163665771484
Epoch: 10, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.150 Vali Acc: 0.490 Test Loss: 1.150 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.0904409885406494
Epoch: 11, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.391 Vali Acc: 0.520 Test Loss: 1.391 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.196324348449707
Epoch: 12, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.150998830795288
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.166 Vali Acc: 0.540 Test Loss: 1.166 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_GPT4TS_UEA_ftM_sl3000_ll0_pl0_el3_dm768_df768_ps600_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 110601986
model size : 436.58MB
