Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.056742906570435
Epoch: 1, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.5185794830322266
Epoch: 2, Steps: 8 | Train Loss: 1.437 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.7269234657287598
Epoch: 3, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.42612886428833
Epoch: 4, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.516 Vali Acc: 0.427 Test Loss: 1.516 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 2.704961061477661
Epoch: 5, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.461 Vali Acc: 0.450 Test Loss: 1.461 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 2.3067996501922607
Epoch: 6, Steps: 8 | Train Loss: 0.765 Vali Loss: 1.412 Vali Acc: 0.481 Test Loss: 1.412 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 2.591137170791626
Epoch: 7, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.425 Vali Acc: 0.489 Test Loss: 1.425 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 2.0352585315704346
Epoch: 8, Steps: 8 | Train Loss: 0.425 Vali Loss: 1.359 Vali Acc: 0.504 Test Loss: 1.359 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 2.072934865951538
Epoch: 9, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.394 Vali Acc: 0.504 Test Loss: 1.394 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.458827018737793
Epoch: 10, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.417 Vali Acc: 0.519 Test Loss: 1.417 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 2.7923028469085693
Epoch: 11, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.366 Vali Acc: 0.519 Test Loss: 1.366 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 2.5711617469787598
Epoch: 12, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6204168796539307
Epoch: 13, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3018221855163574
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.584 Vali Acc: 0.519 Test Loss: 1.584 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.439554214477539
Epoch: 15, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.498 Vali Acc: 0.511 Test Loss: 1.498 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.137594699859619
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.457 Vali Acc: 0.519 Test Loss: 1.457 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.722393274307251
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.496 Vali Acc: 0.519 Test Loss: 1.496 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2153570652008057
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.573 Vali Acc: 0.519 Test Loss: 1.573 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.196998119354248
Epoch: 19, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.562 Vali Acc: 0.519 Test Loss: 1.562 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.910203456878662
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.628 Vali Acc: 0.519 Test Loss: 1.628 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2301270961761475
Epoch: 21, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.718 Vali Acc: 0.519 Test Loss: 1.718 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1252325
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.503414154052734
Epoch: 1, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 2.4274532794952393
Epoch: 2, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.688307523727417
Epoch: 3, Steps: 8 | Train Loss: 1.360 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.6056787967681885
Epoch: 4, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.119880199432373
Epoch: 5, Steps: 8 | Train Loss: 1.106 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 2.343055248260498
Epoch: 6, Steps: 8 | Train Loss: 0.977 Vali Loss: 1.498 Vali Acc: 0.435 Test Loss: 1.498 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 2.475473642349243
Epoch: 7, Steps: 8 | Train Loss: 0.845 Vali Loss: 1.468 Vali Acc: 0.450 Test Loss: 1.468 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 2.3547089099884033
Epoch: 8, Steps: 8 | Train Loss: 0.713 Vali Loss: 1.453 Vali Acc: 0.481 Test Loss: 1.453 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 2.5443484783172607
Epoch: 9, Steps: 8 | Train Loss: 0.571 Vali Loss: 1.430 Vali Acc: 0.496 Test Loss: 1.430 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 2.516011953353882
Epoch: 10, Steps: 8 | Train Loss: 0.445 Vali Loss: 1.375 Vali Acc: 0.534 Test Loss: 1.375 Test Acc: 0.534
Validation loss decreased (-0.496169 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 2.034069538116455
Epoch: 11, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.419 Vali Acc: 0.504 Test Loss: 1.419 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1668403148651123
Epoch: 12, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.501 Vali Acc: 0.504 Test Loss: 1.501 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5498430728912354
Epoch: 13, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.488 Vali Acc: 0.511 Test Loss: 1.488 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.097541570663452
Epoch: 14, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.451 Vali Acc: 0.550 Test Loss: 1.451 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 15 cost time: 2.486976146697998
Epoch: 15, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.498 Vali Acc: 0.534 Test Loss: 1.498 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2875773906707764
Epoch: 16, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.525 Vali Acc: 0.519 Test Loss: 1.525 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3383281230926514
Epoch: 17, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.470 Vali Acc: 0.565 Test Loss: 1.470 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564871).  Saving model ...
Epoch: 18 cost time: 2.2759885787963867
Epoch: 18, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.588 Vali Acc: 0.534 Test Loss: 1.588 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3452835083007812
Epoch: 19, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.637 Vali Acc: 0.534 Test Loss: 1.637 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.449462890625
Epoch: 20, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.565 Vali Acc: 0.557 Test Loss: 1.565 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0364596843719482
Epoch: 21, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.589 Vali Acc: 0.557 Test Loss: 1.589 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.328889846801758
Epoch: 22, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.559 Vali Acc: 0.557 Test Loss: 1.559 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5448062419891357
Epoch: 23, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.555 Vali Acc: 0.550 Test Loss: 1.555 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.230912685394287
Epoch: 24, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.630 Vali Acc: 0.550 Test Loss: 1.630 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.43037748336792
Epoch: 25, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.831 Vali Acc: 0.534 Test Loss: 1.831 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.025491237640381
Epoch: 26, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.852 Vali Acc: 0.519 Test Loss: 1.852 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6063218116760254
Epoch: 27, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.696 Vali Acc: 0.534 Test Loss: 1.696 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1228325
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.3360514640808105
Epoch: 1, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.593 Vali Acc: 0.313 Test Loss: 1.593 Test Acc: 0.313
Validation loss decreased (inf --> -0.312961).  Saving model ...
Epoch: 2 cost time: 2.0197980403900146
Epoch: 2, Steps: 8 | Train Loss: 1.566 Vali Loss: 1.564 Vali Acc: 0.427 Test Loss: 1.564 Test Acc: 0.427
Validation loss decreased (-0.312961 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 2.101513385772705
Epoch: 3, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6611218452453613
Epoch: 4, Steps: 8 | Train Loss: 1.320 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3279383182525635
Epoch: 5, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6204993724823
Epoch: 6, Steps: 8 | Train Loss: 1.090 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5686380863189697
Epoch: 7, Steps: 8 | Train Loss: 1.004 Vali Loss: 1.482 Vali Acc: 0.435 Test Loss: 1.482 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435100).  Saving model ...
Epoch: 8 cost time: 2.422908306121826
Epoch: 8, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.441 Vali Acc: 0.458 Test Loss: 1.441 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 2.910308837890625
Epoch: 9, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.448 Vali Acc: 0.481 Test Loss: 1.448 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 2.6181082725524902
Epoch: 10, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.422 Vali Acc: 0.481 Test Loss: 1.422 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 2.192920446395874
Epoch: 11, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.405 Vali Acc: 0.504 Test Loss: 1.405 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.9905483722686768
Epoch: 12, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.416 Vali Acc: 0.496 Test Loss: 1.416 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.67572021484375
Epoch: 13, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.386 Vali Acc: 0.504 Test Loss: 1.386 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 14 cost time: 2.28615665435791
Epoch: 14, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.379 Vali Acc: 0.511 Test Loss: 1.379 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 15 cost time: 2.507051944732666
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.411 Vali Acc: 0.511 Test Loss: 1.411 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1583242416381836
Epoch: 16, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.378 Vali Acc: 0.519 Test Loss: 1.378 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 17 cost time: 2.523263454437256
Epoch: 17, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.397 Vali Acc: 0.519 Test Loss: 1.397 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6098170280456543
Epoch: 18, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 19 cost time: 2.403972864151001
Epoch: 19, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5602567195892334
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.229231595993042
Epoch: 21, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.415 Vali Acc: 0.519 Test Loss: 1.415 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7130329608917236
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.386 Vali Acc: 0.519 Test Loss: 1.386 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.558727741241455
Epoch: 23, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.352 Vali Acc: 0.527 Test Loss: 1.352 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 24 cost time: 2.079850912094116
Epoch: 24, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.439 Vali Acc: 0.527 Test Loss: 1.439 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0997369289398193
Epoch: 25, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.458 Vali Acc: 0.519 Test Loss: 1.458 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4173500537872314
Epoch: 26, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.371 Vali Acc: 0.519 Test Loss: 1.371 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.8932576179504395
Epoch: 27, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.809373617172241
Epoch: 28, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.436 Vali Acc: 0.542 Test Loss: 1.436 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541970).  Saving model ...
Epoch: 29 cost time: 2.3127810955047607
Epoch: 29, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.431 Vali Acc: 0.542 Test Loss: 1.431 Test Acc: 0.542
Validation loss decreased (-0.541970 --> -0.541970).  Saving model ...
Epoch: 30 cost time: 2.7973544597625732
Epoch: 30, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.388 Vali Acc: 0.565 Test Loss: 1.388 Test Acc: 0.565
Validation loss decreased (-0.541970 --> -0.564872).  Saving model ...
Epoch: 31 cost time: 2.3819000720977783
Epoch: 31, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.418 Vali Acc: 0.565 Test Loss: 1.418 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.545123815536499
Epoch: 32, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.495 Vali Acc: 0.550 Test Loss: 1.495 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.244035482406616
Epoch: 33, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.531 Vali Acc: 0.542 Test Loss: 1.531 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.1580560207366943
Epoch: 34, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.514 Vali Acc: 0.550 Test Loss: 1.514 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.000075578689575
Epoch: 35, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.494 Vali Acc: 0.565 Test Loss: 1.494 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.7150468826293945
Epoch: 36, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.502 Vali Acc: 0.550 Test Loss: 1.502 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.419318199157715
Epoch: 37, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.581 Vali Acc: 0.557 Test Loss: 1.581 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.2266008853912354
Epoch: 38, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.644 Vali Acc: 0.573 Test Loss: 1.644 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572503).  Saving model ...
Epoch: 39 cost time: 1.9825499057769775
Epoch: 39, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.620 Vali Acc: 0.557 Test Loss: 1.620 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9388635158538818
Epoch: 40, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.605 Vali Acc: 0.557 Test Loss: 1.605 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.8121848106384277
Epoch: 41, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.559 Vali Acc: 0.534 Test Loss: 1.559 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.8203773498535156
Epoch: 42, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.626 Vali Acc: 0.534 Test Loss: 1.626 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.06754469871521
Epoch: 43, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.741 Vali Acc: 0.534 Test Loss: 1.741 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.1264591217041016
Epoch: 44, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.699 Vali Acc: 0.534 Test Loss: 1.699 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.431381940841675
Epoch: 45, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.624 Vali Acc: 0.580 Test Loss: 1.624 Test Acc: 0.580
Validation loss decreased (-0.572503 --> -0.580136).  Saving model ...
Epoch: 46 cost time: 2.022109270095825
Epoch: 46, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.639 Vali Acc: 0.557 Test Loss: 1.639 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.8930234909057617
Epoch: 47, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.747 Vali Acc: 0.534 Test Loss: 1.747 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.256612539291382
Epoch: 48, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.883 Vali Acc: 0.550 Test Loss: 1.883 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.44067645072937
Epoch: 49, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.920 Vali Acc: 0.527 Test Loss: 1.920 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.5975613594055176
Epoch: 50, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.881 Vali Acc: 0.534 Test Loss: 1.881 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1231173
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.0448057651519775
Epoch: 1, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.596 Vali Acc: 0.290 Test Loss: 1.596 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 2.08315372467041
Epoch: 2, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.569 Vali Acc: 0.382 Test Loss: 1.569 Test Acc: 0.382
Validation loss decreased (-0.290060 --> -0.381664).  Saving model ...
Epoch: 3 cost time: 2.531750202178955
Epoch: 3, Steps: 8 | Train Loss: 1.446 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.381664 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.1648995876312256
Epoch: 4, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.0106163024902344
Epoch: 5, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8042449951171875
Epoch: 6, Steps: 8 | Train Loss: 1.093 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.8664071559906006
Epoch: 7, Steps: 8 | Train Loss: 0.977 Vali Loss: 1.502 Vali Acc: 0.427 Test Loss: 1.502 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 2.3118247985839844
Epoch: 8, Steps: 8 | Train Loss: 0.898 Vali Loss: 1.486 Vali Acc: 0.435 Test Loss: 1.486 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 9 cost time: 2.0917398929595947
Epoch: 9, Steps: 8 | Train Loss: 0.785 Vali Loss: 1.452 Vali Acc: 0.466 Test Loss: 1.452 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 1.9148955345153809
Epoch: 10, Steps: 8 | Train Loss: 0.667 Vali Loss: 1.444 Vali Acc: 0.496 Test Loss: 1.444 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 2.1814522743225098
Epoch: 11, Steps: 8 | Train Loss: 0.583 Vali Loss: 1.398 Vali Acc: 0.511 Test Loss: 1.398 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 2.1532742977142334
Epoch: 12, Steps: 8 | Train Loss: 0.486 Vali Loss: 1.404 Vali Acc: 0.504 Test Loss: 1.404 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0747411251068115
Epoch: 13, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.8285377025604248
Epoch: 14, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.386 Vali Acc: 0.534 Test Loss: 1.386 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 15 cost time: 2.150458335876465
Epoch: 15, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.425 Vali Acc: 0.527 Test Loss: 1.425 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8941621780395508
Epoch: 16, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.370 Vali Acc: 0.557 Test Loss: 1.370 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 17 cost time: 2.37652850151062
Epoch: 17, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.364 Vali Acc: 0.557 Test Loss: 1.364 Test Acc: 0.557
Validation loss decreased (-0.557238 --> -0.557238).  Saving model ...
Epoch: 18 cost time: 1.937692642211914
Epoch: 18, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.357 Vali Acc: 0.550 Test Loss: 1.357 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1740963459014893
Epoch: 19, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.415 Vali Acc: 0.550 Test Loss: 1.415 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4333443641662598
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.432 Vali Acc: 0.550 Test Loss: 1.432 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.026181221008301
Epoch: 21, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.406 Vali Acc: 0.550 Test Loss: 1.406 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5656826496124268
Epoch: 22, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.428 Vali Acc: 0.527 Test Loss: 1.428 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.0193567276000977
Epoch: 23, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.444 Vali Acc: 0.542 Test Loss: 1.444 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.020062208175659
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.454 Vali Acc: 0.580 Test Loss: 1.454 Test Acc: 0.580
Validation loss decreased (-0.557238 --> -0.580138).  Saving model ...
Epoch: 25 cost time: 2.01576828956604
Epoch: 25, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.434 Vali Acc: 0.557 Test Loss: 1.434 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.148639678955078
Epoch: 26, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.454 Vali Acc: 0.557 Test Loss: 1.454 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9191031455993652
Epoch: 27, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.512 Vali Acc: 0.550 Test Loss: 1.512 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.04274320602417
Epoch: 28, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.467 Vali Acc: 0.557 Test Loss: 1.467 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8259541988372803
Epoch: 29, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.359 Vali Acc: 0.603 Test Loss: 1.359 Test Acc: 0.603
Validation loss decreased (-0.580138 --> -0.603040).  Saving model ...
Epoch: 30 cost time: 2.186061382293701
Epoch: 30, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.426 Vali Acc: 0.550 Test Loss: 1.426 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.996140718460083
Epoch: 31, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.494 Vali Acc: 0.527 Test Loss: 1.494 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9520606994628906
Epoch: 32, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.488 Vali Acc: 0.542 Test Loss: 1.488 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.6387453079223633
Epoch: 33, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.539 Vali Acc: 0.580 Test Loss: 1.539 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.06667423248291
Epoch: 34, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.567 Vali Acc: 0.550 Test Loss: 1.567 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7589366436004639
Epoch: 35, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.662 Vali Acc: 0.557 Test Loss: 1.662 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0156543254852295
Epoch: 36, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.706 Vali Acc: 0.542 Test Loss: 1.706 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.1037447452545166
Epoch: 37, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.797 Vali Acc: 0.527 Test Loss: 1.797 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9429347515106201
Epoch: 38, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.850 Vali Acc: 0.504 Test Loss: 1.850 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8249273300170898
Epoch: 39, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.851 Vali Acc: 0.519 Test Loss: 1.851 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 1237893
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.278355121612549
Epoch: 1, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.625 Vali Acc: 0.153 Test Loss: 1.625 Test Acc: 0.153
Validation loss decreased (inf --> -0.152656).  Saving model ...
Epoch: 2 cost time: 2.130849838256836
Epoch: 2, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.607 Vali Acc: 0.389 Test Loss: 1.607 Test Acc: 0.389
Validation loss decreased (-0.152656 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.4918324947357178
Epoch: 3, Steps: 8 | Train Loss: 1.462 Vali Loss: 1.587 Vali Acc: 0.420 Test Loss: 1.587 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.6700084209442139
Epoch: 4, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.749727487564087
Epoch: 5, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.9545657634735107
Epoch: 6, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.8829026222229004
Epoch: 7, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9153010845184326
Epoch: 8, Steps: 8 | Train Loss: 0.940 Vali Loss: 1.512 Vali Acc: 0.427 Test Loss: 1.512 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 2.0650792121887207
Epoch: 9, Steps: 8 | Train Loss: 0.842 Vali Loss: 1.503 Vali Acc: 0.450 Test Loss: 1.503 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 1.8388593196868896
Epoch: 10, Steps: 8 | Train Loss: 0.773 Vali Loss: 1.502 Vali Acc: 0.450 Test Loss: 1.502 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 2.2512829303741455
Epoch: 11, Steps: 8 | Train Loss: 0.659 Vali Loss: 1.507 Vali Acc: 0.458 Test Loss: 1.507 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 2.7179923057556152
Epoch: 12, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.485 Vali Acc: 0.473 Test Loss: 1.485 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 13 cost time: 1.7388465404510498
Epoch: 13, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.480 Vali Acc: 0.496 Test Loss: 1.480 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496168).  Saving model ...
Epoch: 14 cost time: 1.6887831687927246
Epoch: 14, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.484 Vali Acc: 0.504 Test Loss: 1.484 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 15 cost time: 2.024661064147949
Epoch: 15, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.486 Vali Acc: 0.496 Test Loss: 1.486 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0066492557525635
Epoch: 16, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.505 Vali Acc: 0.511 Test Loss: 1.505 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 17 cost time: 1.8874537944793701
Epoch: 17, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.511 Vali Acc: 0.504 Test Loss: 1.511 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7959158420562744
Epoch: 18, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.504 Vali Acc: 0.489 Test Loss: 1.504 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.192190170288086
Epoch: 19, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.515 Vali Acc: 0.504 Test Loss: 1.515 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.603872299194336
Epoch: 20, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.513 Vali Acc: 0.481 Test Loss: 1.513 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2191550731658936
Epoch: 21, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.506 Vali Acc: 0.496 Test Loss: 1.506 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2076520919799805
Epoch: 22, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.508 Vali Acc: 0.496 Test Loss: 1.508 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9942562580108643
Epoch: 23, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.472 Vali Acc: 0.504 Test Loss: 1.472 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.349071502685547
Epoch: 24, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.465 Vali Acc: 0.519 Test Loss: 1.465 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519069).  Saving model ...
Epoch: 25 cost time: 1.617727518081665
Epoch: 25, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.486 Vali Acc: 0.527 Test Loss: 1.486 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 26 cost time: 2.2846028804779053
Epoch: 26, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.460 Vali Acc: 0.519 Test Loss: 1.460 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3702051639556885
Epoch: 27, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.506 Vali Acc: 0.504 Test Loss: 1.506 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8546688556671143
Epoch: 28, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9917902946472168
Epoch: 29, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.520 Vali Acc: 0.519 Test Loss: 1.520 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.526653289794922
Epoch: 30, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.538766860961914
Epoch: 31, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.550 Vali Acc: 0.481 Test Loss: 1.550 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9882540702819824
Epoch: 32, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.555 Vali Acc: 0.496 Test Loss: 1.555 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7891476154327393
Epoch: 33, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.304123640060425
Epoch: 34, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1106996536254883
Epoch: 35, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.608 Vali Acc: 0.519 Test Loss: 1.608 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1262821
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.82699990272522
Epoch: 1, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.609 Vali Acc: 0.206 Test Loss: 1.609 Test Acc: 0.206
Validation loss decreased (inf --> -0.206091).  Saving model ...
Epoch: 2 cost time: 1.78775954246521
Epoch: 2, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.592 Vali Acc: 0.382 Test Loss: 1.592 Test Acc: 0.382
Validation loss decreased (-0.206091 --> -0.381663).  Saving model ...
Epoch: 3 cost time: 1.9697012901306152
Epoch: 3, Steps: 8 | Train Loss: 1.440 Vali Loss: 1.560 Vali Acc: 0.450 Test Loss: 1.560 Test Acc: 0.450
Validation loss decreased (-0.381663 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 2.463329792022705
Epoch: 4, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.528 Vali Acc: 0.443 Test Loss: 1.528 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4155774116516113
Epoch: 5, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.516 Vali Acc: 0.443 Test Loss: 1.516 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4117965698242188
Epoch: 6, Steps: 8 | Train Loss: 1.039 Vali Loss: 1.498 Vali Acc: 0.435 Test Loss: 1.498 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.359246015548706
Epoch: 7, Steps: 8 | Train Loss: 0.952 Vali Loss: 1.479 Vali Acc: 0.473 Test Loss: 1.479 Test Acc: 0.473
Validation loss decreased (-0.450366 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 2.5848159790039062
Epoch: 8, Steps: 8 | Train Loss: 0.827 Vali Loss: 1.463 Vali Acc: 0.481 Test Loss: 1.463 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 2.264979600906372
Epoch: 9, Steps: 8 | Train Loss: 0.739 Vali Loss: 1.449 Vali Acc: 0.473 Test Loss: 1.449 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8378684520721436
Epoch: 10, Steps: 8 | Train Loss: 0.630 Vali Loss: 1.461 Vali Acc: 0.481 Test Loss: 1.461 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 2.2229104042053223
Epoch: 11, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.429 Vali Acc: 0.489 Test Loss: 1.429 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 2.357112169265747
Epoch: 12, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.393 Vali Acc: 0.504 Test Loss: 1.393 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 13 cost time: 2.4664578437805176
Epoch: 13, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.426 Vali Acc: 0.504 Test Loss: 1.426 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9021453857421875
Epoch: 14, Steps: 8 | Train Loss: 0.300 Vali Loss: 1.369 Vali Acc: 0.519 Test Loss: 1.369 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 2.1589746475219727
Epoch: 15, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.402 Vali Acc: 0.504 Test Loss: 1.402 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0069663524627686
Epoch: 16, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.396 Vali Acc: 0.527 Test Loss: 1.396 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 17 cost time: 1.8817012310028076
Epoch: 17, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.393 Vali Acc: 0.542 Test Loss: 1.393 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 18 cost time: 2.052248477935791
Epoch: 18, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.399 Vali Acc: 0.542 Test Loss: 1.399 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4186887741088867
Epoch: 19, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.462 Vali Acc: 0.519 Test Loss: 1.462 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7808396816253662
Epoch: 20, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.409 Vali Acc: 0.534 Test Loss: 1.409 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2942726612091064
Epoch: 21, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.441 Vali Acc: 0.511 Test Loss: 1.441 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5233511924743652
Epoch: 22, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.666959762573242
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.538 Vali Acc: 0.542 Test Loss: 1.538 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.823517084121704
Epoch: 24, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.535 Vali Acc: 0.519 Test Loss: 1.535 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.950075387954712
Epoch: 25, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.554 Vali Acc: 0.504 Test Loss: 1.554 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.383549451828003
Epoch: 26, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.490 Vali Acc: 0.542 Test Loss: 1.490 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6642706394195557
Epoch: 27, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.471 Vali Acc: 0.542 Test Loss: 1.471 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1287749
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.292382717132568
Epoch: 1, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.622 Vali Acc: 0.107 Test Loss: 1.622 Test Acc: 0.107
Validation loss decreased (inf --> -0.106854).  Saving model ...
Epoch: 2 cost time: 2.733820915222168
Epoch: 2, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.607 Vali Acc: 0.092 Test Loss: 1.607 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4046714305877686
Epoch: 3, Steps: 8 | Train Loss: 1.464 Vali Loss: 1.581 Vali Acc: 0.427 Test Loss: 1.581 Test Acc: 0.427
Validation loss decreased (-0.106854 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.9115657806396484
Epoch: 4, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.559 Vali Acc: 0.420 Test Loss: 1.559 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4604153633117676
Epoch: 5, Steps: 8 | Train Loss: 1.203 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2631499767303467
Epoch: 6, Steps: 8 | Train Loss: 1.076 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3531572818756104
Epoch: 7, Steps: 8 | Train Loss: 1.019 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9900662899017334
Epoch: 8, Steps: 8 | Train Loss: 0.914 Vali Loss: 1.510 Vali Acc: 0.420 Test Loss: 1.510 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.967529535293579
Epoch: 9, Steps: 8 | Train Loss: 0.825 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0378775596618652
Epoch: 10, Steps: 8 | Train Loss: 0.702 Vali Loss: 1.509 Vali Acc: 0.420 Test Loss: 1.509 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3844313621520996
Epoch: 11, Steps: 8 | Train Loss: 0.665 Vali Loss: 1.498 Vali Acc: 0.427 Test Loss: 1.498 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 12 cost time: 2.4177262783050537
Epoch: 12, Steps: 8 | Train Loss: 0.562 Vali Loss: 1.502 Vali Acc: 0.427 Test Loss: 1.502 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2357091903686523
Epoch: 13, Steps: 8 | Train Loss: 0.485 Vali Loss: 1.512 Vali Acc: 0.435 Test Loss: 1.512 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 14 cost time: 1.676576852798462
Epoch: 14, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.504 Vali Acc: 0.450 Test Loss: 1.504 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 15 cost time: 2.140002965927124
Epoch: 15, Steps: 8 | Train Loss: 0.366 Vali Loss: 1.509 Vali Acc: 0.435 Test Loss: 1.509 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.619157552719116
Epoch: 16, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.513 Vali Acc: 0.458 Test Loss: 1.513 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458000).  Saving model ...
Epoch: 17 cost time: 2.189887762069702
Epoch: 17, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.488 Vali Acc: 0.458 Test Loss: 1.488 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 18 cost time: 2.1624302864074707
Epoch: 18, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.500 Vali Acc: 0.473 Test Loss: 1.500 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 19 cost time: 2.0455093383789062
Epoch: 19, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.518 Vali Acc: 0.450 Test Loss: 1.518 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5084309577941895
Epoch: 20, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.089804172515869
Epoch: 21, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.495 Vali Acc: 0.496 Test Loss: 1.495 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 22 cost time: 2.4788613319396973
Epoch: 22, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.528 Vali Acc: 0.458 Test Loss: 1.528 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.049490451812744
Epoch: 23, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.509 Vali Acc: 0.458 Test Loss: 1.509 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7664754390716553
Epoch: 24, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9552943706512451
Epoch: 25, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.527 Vali Acc: 0.489 Test Loss: 1.527 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.41084361076355
Epoch: 26, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.563 Vali Acc: 0.504 Test Loss: 1.563 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 27 cost time: 1.668161392211914
Epoch: 27, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.556 Vali Acc: 0.481 Test Loss: 1.556 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9667601585388184
Epoch: 28, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.553 Vali Acc: 0.489 Test Loss: 1.553 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7572829723358154
Epoch: 29, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.599 Vali Acc: 0.466 Test Loss: 1.599 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8932702541351318
Epoch: 30, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.567 Vali Acc: 0.481 Test Loss: 1.567 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.400392532348633
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.668 Vali Acc: 0.466 Test Loss: 1.668 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1163747310638428
Epoch: 32, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.655 Vali Acc: 0.458 Test Loss: 1.655 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.642025947570801
Epoch: 33, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.662 Vali Acc: 0.473 Test Loss: 1.662 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.1474854946136475
Epoch: 34, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.624 Vali Acc: 0.473 Test Loss: 1.624 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0467538833618164
Epoch: 35, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.578 Vali Acc: 0.450 Test Loss: 1.578 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.3420705795288086
Epoch: 36, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.574 Vali Acc: 0.458 Test Loss: 1.574 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 1312677
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.611891984939575
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.608 Vali Acc: 0.252 Test Loss: 1.608 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.8004975318908691
Epoch: 2, Steps: 8 | Train Loss: 1.480 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
Validation loss decreased (-0.251892 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.0386831760406494
Epoch: 3, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.9346177577972412
Epoch: 4, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.8731491565704346
Epoch: 5, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.508 Vali Acc: 0.443 Test Loss: 1.508 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.930692195892334
Epoch: 6, Steps: 8 | Train Loss: 0.781 Vali Loss: 1.476 Vali Acc: 0.450 Test Loss: 1.476 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.9165890216827393
Epoch: 7, Steps: 8 | Train Loss: 0.599 Vali Loss: 1.427 Vali Acc: 0.496 Test Loss: 1.427 Test Acc: 0.496
Validation loss decreased (-0.450367 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.809532642364502
Epoch: 8, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.400 Vali Acc: 0.527 Test Loss: 1.400 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 9 cost time: 2.194758653640747
Epoch: 9, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.923558235168457
Epoch: 10, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.415 Vali Acc: 0.519 Test Loss: 1.415 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0269408226013184
Epoch: 11, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8453657627105713
Epoch: 12, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9145004749298096
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.439 Vali Acc: 0.550 Test Loss: 1.439 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549604).  Saving model ...
Epoch: 14 cost time: 1.8287837505340576
Epoch: 14, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.489 Vali Acc: 0.542 Test Loss: 1.489 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.915764331817627
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.595763683319092
Epoch: 16, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.470 Vali Acc: 0.519 Test Loss: 1.470 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8520894050598145
Epoch: 17, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.615 Vali Acc: 0.527 Test Loss: 1.615 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.193067789077759
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.566 Vali Acc: 0.534 Test Loss: 1.566 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2957844734191895
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.504 Vali Acc: 0.534 Test Loss: 1.504 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6871323585510254
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.472 Vali Acc: 0.534 Test Loss: 1.472 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.62992525100708
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.561 Vali Acc: 0.534 Test Loss: 1.561 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.319673538208008
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.687 Vali Acc: 0.527 Test Loss: 1.687 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0420923233032227
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.663 Vali Acc: 0.527 Test Loss: 1.663 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1246949
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.101239204406738
Epoch: 1, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.598 Vali Acc: 0.382 Test Loss: 1.598 Test Acc: 0.382
Validation loss decreased (inf --> -0.381663).  Saving model ...
Epoch: 2 cost time: 2.76993465423584
Epoch: 2, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.581 Vali Acc: 0.420 Test Loss: 1.581 Test Acc: 0.420
Validation loss decreased (-0.381663 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.369549036026001
Epoch: 3, Steps: 8 | Train Loss: 1.391 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.9789655208587646
Epoch: 4, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.8887031078338623
Epoch: 5, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.553 Vali Acc: 0.435 Test Loss: 1.553 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.9879448413848877
Epoch: 6, Steps: 8 | Train Loss: 0.999 Vali Loss: 1.521 Vali Acc: 0.443 Test Loss: 1.521 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.9556608200073242
Epoch: 7, Steps: 8 | Train Loss: 0.862 Vali Loss: 1.479 Vali Acc: 0.481 Test Loss: 1.479 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.8242595195770264
Epoch: 8, Steps: 8 | Train Loss: 0.731 Vali Loss: 1.435 Vali Acc: 0.489 Test Loss: 1.435 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 2.323709726333618
Epoch: 9, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.454 Vali Acc: 0.496 Test Loss: 1.454 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 2.3053736686706543
Epoch: 10, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 11 cost time: 2.2415413856506348
Epoch: 11, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.441 Vali Acc: 0.519 Test Loss: 1.441 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 2.406482219696045
Epoch: 12, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.418 Vali Acc: 0.519 Test Loss: 1.418 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 13 cost time: 2.211836338043213
Epoch: 13, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.484 Vali Acc: 0.519 Test Loss: 1.484 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3014540672302246
Epoch: 14, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.496 Vali Acc: 0.519 Test Loss: 1.496 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.488516330718994
Epoch: 15, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.461 Vali Acc: 0.519 Test Loss: 1.461 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1919772624969482
Epoch: 16, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.543 Vali Acc: 0.519 Test Loss: 1.543 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.073000431060791
Epoch: 17, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.568 Vali Acc: 0.534 Test Loss: 1.568 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534335).  Saving model ...
Epoch: 18 cost time: 2.4564595222473145
Epoch: 18, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.586 Vali Acc: 0.519 Test Loss: 1.586 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.020000457763672
Epoch: 19, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.531 Vali Acc: 0.557 Test Loss: 1.531 Test Acc: 0.557
Validation loss decreased (-0.534335 --> -0.557237).  Saving model ...
Epoch: 20 cost time: 2.3418021202087402
Epoch: 20, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.665 Vali Acc: 0.542 Test Loss: 1.665 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5850138664245605
Epoch: 21, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.615 Vali Acc: 0.542 Test Loss: 1.615 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7863152027130127
Epoch: 22, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.545 Vali Acc: 0.573 Test Loss: 1.545 Test Acc: 0.573
Validation loss decreased (-0.557237 --> -0.572504).  Saving model ...
Epoch: 23 cost time: 2.782169818878174
Epoch: 23, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.632 Vali Acc: 0.527 Test Loss: 1.632 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.710954427719116
Epoch: 24, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.728 Vali Acc: 0.565 Test Loss: 1.728 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0424509048461914
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.10845685005188
Epoch: 26, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.595 Vali Acc: 0.534 Test Loss: 1.595 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1737723350524902
Epoch: 27, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.599 Vali Acc: 0.550 Test Loss: 1.599 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.5783560276031494
Epoch: 28, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.692 Vali Acc: 0.534 Test Loss: 1.692 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.530669689178467
Epoch: 29, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.626 Vali Acc: 0.557 Test Loss: 1.626 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1901979446411133
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.703 Vali Acc: 0.550 Test Loss: 1.703 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.150052785873413
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.831 Vali Acc: 0.534 Test Loss: 1.831 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.586268901824951
Epoch: 32, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.046 Vali Acc: 0.527 Test Loss: 2.046 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 1222949
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.046948671340942
Epoch: 1, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.606 Vali Acc: 0.244 Test Loss: 1.606 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 2.345818042755127
Epoch: 2, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.584 Vali Acc: 0.412 Test Loss: 1.584 Test Acc: 0.412
Validation loss decreased (-0.244259 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 2.3495583534240723
Epoch: 3, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.565 Vali Acc: 0.427 Test Loss: 1.565 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 2.580519914627075
Epoch: 4, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.559 Vali Acc: 0.427 Test Loss: 1.559 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 2.295600652694702
Epoch: 5, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.534 Vali Acc: 0.427 Test Loss: 1.534 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 2.410269260406494
Epoch: 6, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 2.4946374893188477
Epoch: 7, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.505 Vali Acc: 0.435 Test Loss: 1.505 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 8 cost time: 2.0423531532287598
Epoch: 8, Steps: 8 | Train Loss: 0.861 Vali Loss: 1.471 Vali Acc: 0.466 Test Loss: 1.471 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 2.304283618927002
Epoch: 9, Steps: 8 | Train Loss: 0.730 Vali Loss: 1.479 Vali Acc: 0.481 Test Loss: 1.479 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 2.2738986015319824
Epoch: 10, Steps: 8 | Train Loss: 0.633 Vali Loss: 1.430 Vali Acc: 0.489 Test Loss: 1.430 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 2.1717772483825684
Epoch: 11, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.435 Vali Acc: 0.496 Test Loss: 1.435 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 2.4514589309692383
Epoch: 12, Steps: 8 | Train Loss: 0.418 Vali Loss: 1.412 Vali Acc: 0.511 Test Loss: 1.412 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 2.3613765239715576
Epoch: 13, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.397 Vali Acc: 0.519 Test Loss: 1.397 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.8144001960754395
Epoch: 14, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.394 Vali Acc: 0.511 Test Loss: 1.394 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5896236896514893
Epoch: 15, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 16 cost time: 1.9016022682189941
Epoch: 16, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.425 Vali Acc: 0.534 Test Loss: 1.425 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 17 cost time: 2.3472440242767334
Epoch: 17, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.370 Vali Acc: 0.534 Test Loss: 1.370 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 18 cost time: 2.0236406326293945
Epoch: 18, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.401 Vali Acc: 0.542 Test Loss: 1.401 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 19 cost time: 2.2379627227783203
Epoch: 19, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.384 Vali Acc: 0.534 Test Loss: 1.384 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.791538715362549
Epoch: 20, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.322 Vali Acc: 0.565 Test Loss: 1.322 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564872).  Saving model ...
Epoch: 21 cost time: 1.964632272720337
Epoch: 21, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.389 Vali Acc: 0.534 Test Loss: 1.389 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.425257444381714
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.433 Vali Acc: 0.542 Test Loss: 1.433 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.352548599243164
Epoch: 23, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.444 Vali Acc: 0.534 Test Loss: 1.444 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.340287923812866
Epoch: 24, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.376 Vali Acc: 0.550 Test Loss: 1.376 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.259838581085205
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.392 Vali Acc: 0.565 Test Loss: 1.392 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.005741834640503
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.010371208190918
Epoch: 27, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.439 Vali Acc: 0.534 Test Loss: 1.439 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.3955090045928955
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.417 Vali Acc: 0.534 Test Loss: 1.417 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4776828289031982
Epoch: 29, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.423 Vali Acc: 0.542 Test Loss: 1.423 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3599109649658203
Epoch: 30, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.381 Vali Acc: 0.550 Test Loss: 1.381 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1225797
model size : 4.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.606189489364624
Epoch: 1, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.599 Vali Acc: 0.321 Test Loss: 1.599 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 2.255053758621216
Epoch: 2, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.576 Vali Acc: 0.443 Test Loss: 1.576 Test Acc: 0.443
Validation loss decreased (-0.320595 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 2.171588897705078
Epoch: 3, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.548 Vali Acc: 0.427 Test Loss: 1.548 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4312424659729004
Epoch: 4, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.536 Vali Acc: 0.427 Test Loss: 1.536 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9265334606170654
Epoch: 5, Steps: 8 | Train Loss: 1.175 Vali Loss: 1.518 Vali Acc: 0.427 Test Loss: 1.518 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.613940954208374
Epoch: 6, Steps: 8 | Train Loss: 1.072 Vali Loss: 1.513 Vali Acc: 0.435 Test Loss: 1.513 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7930986881256104
Epoch: 7, Steps: 8 | Train Loss: 0.969 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 2.2976160049438477
Epoch: 8, Steps: 8 | Train Loss: 0.874 Vali Loss: 1.481 Vali Acc: 0.458 Test Loss: 1.481 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 9 cost time: 1.8285813331604004
Epoch: 9, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.465 Vali Acc: 0.466 Test Loss: 1.465 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 1.7620468139648438
Epoch: 10, Steps: 8 | Train Loss: 0.675 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 1.8055856227874756
Epoch: 11, Steps: 8 | Train Loss: 0.567 Vali Loss: 1.415 Vali Acc: 0.489 Test Loss: 1.415 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 2.4069931507110596
Epoch: 12, Steps: 8 | Train Loss: 0.468 Vali Loss: 1.376 Vali Acc: 0.489 Test Loss: 1.376 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488536).  Saving model ...
Epoch: 13 cost time: 1.7997088432312012
Epoch: 13, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.418 Vali Acc: 0.496 Test Loss: 1.418 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 14 cost time: 1.8250670433044434
Epoch: 14, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.370 Vali Acc: 0.504 Test Loss: 1.370 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 15 cost time: 1.8361952304840088
Epoch: 15, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.417 Vali Acc: 0.519 Test Loss: 1.417 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 2.803238868713379
Epoch: 16, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.446 Vali Acc: 0.519 Test Loss: 1.446 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6847848892211914
Epoch: 17, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.407 Vali Acc: 0.527 Test Loss: 1.407 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 18 cost time: 2.123077630996704
Epoch: 18, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.383 Vali Acc: 0.527 Test Loss: 1.383 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 19 cost time: 1.9278621673583984
Epoch: 19, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.338 Vali Acc: 0.557 Test Loss: 1.338 Test Acc: 0.557
Validation loss decreased (-0.526704 --> -0.557239).  Saving model ...
Epoch: 20 cost time: 1.5558807849884033
Epoch: 20, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.347 Vali Acc: 0.557 Test Loss: 1.347 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7202494144439697
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.371 Vali Acc: 0.542 Test Loss: 1.371 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6435835361480713
Epoch: 22, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.402 Vali Acc: 0.542 Test Loss: 1.402 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9173567295074463
Epoch: 23, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.428 Vali Acc: 0.550 Test Loss: 1.428 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7518742084503174
Epoch: 24, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.484 Vali Acc: 0.557 Test Loss: 1.484 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5596201419830322
Epoch: 25, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7078940868377686
Epoch: 26, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.407 Vali Acc: 0.534 Test Loss: 1.407 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9054756164550781
Epoch: 27, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.337 Vali Acc: 0.565 Test Loss: 1.337 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564872).  Saving model ...
Epoch: 28 cost time: 1.747194528579712
Epoch: 28, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.411 Vali Acc: 0.557 Test Loss: 1.411 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8554446697235107
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.450 Vali Acc: 0.542 Test Loss: 1.450 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9077050685882568
Epoch: 30, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.386 Vali Acc: 0.542 Test Loss: 1.386 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4243409633636475
Epoch: 31, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.453 Vali Acc: 0.534 Test Loss: 1.453 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9394423961639404
Epoch: 32, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.620 Vali Acc: 0.565 Test Loss: 1.620 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9286975860595703
Epoch: 33, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.666 Vali Acc: 0.550 Test Loss: 1.666 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8086962699890137
Epoch: 34, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.600 Vali Acc: 0.519 Test Loss: 1.600 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.787097454071045
Epoch: 35, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.608 Vali Acc: 0.511 Test Loss: 1.608 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.829712152481079
Epoch: 36, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.642 Vali Acc: 0.534 Test Loss: 1.642 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.100374937057495
Epoch: 37, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.637 Vali Acc: 0.519 Test Loss: 1.637 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1232517
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.845192909240723
Epoch: 1, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.593 Vali Acc: 0.382 Test Loss: 1.593 Test Acc: 0.382
Validation loss decreased (inf --> -0.381663).  Saving model ...
Epoch: 2 cost time: 2.1280555725097656
Epoch: 2, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (-0.381663 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4376006126403809
Epoch: 3, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.9529213905334473
Epoch: 4, Steps: 8 | Train Loss: 1.319 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7615687847137451
Epoch: 5, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 2.0319106578826904
Epoch: 6, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.9777283668518066
Epoch: 7, Steps: 8 | Train Loss: 1.015 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.8077754974365234
Epoch: 8, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.8741559982299805
Epoch: 9, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.484 Vali Acc: 0.443 Test Loss: 1.484 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 2.126551866531372
Epoch: 10, Steps: 8 | Train Loss: 0.727 Vali Loss: 1.471 Vali Acc: 0.450 Test Loss: 1.471 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 1.4537303447723389
Epoch: 11, Steps: 8 | Train Loss: 0.617 Vali Loss: 1.460 Vali Acc: 0.458 Test Loss: 1.460 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 12 cost time: 1.8369925022125244
Epoch: 12, Steps: 8 | Train Loss: 0.536 Vali Loss: 1.461 Vali Acc: 0.466 Test Loss: 1.461 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 13 cost time: 1.9037044048309326
Epoch: 13, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.468 Vali Acc: 0.466 Test Loss: 1.468 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6973686218261719
Epoch: 14, Steps: 8 | Train Loss: 0.385 Vali Loss: 1.476 Vali Acc: 0.466 Test Loss: 1.476 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8732402324676514
Epoch: 15, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.448 Vali Acc: 0.473 Test Loss: 1.448 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 16 cost time: 2.1187868118286133
Epoch: 16, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.440 Vali Acc: 0.473 Test Loss: 1.440 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 17 cost time: 1.44325590133667
Epoch: 17, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.488 Vali Acc: 0.473 Test Loss: 1.488 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0511271953582764
Epoch: 18, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.474 Vali Acc: 0.489 Test Loss: 1.474 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 19 cost time: 1.8726036548614502
Epoch: 19, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.485 Vali Acc: 0.489 Test Loss: 1.485 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5496513843536377
Epoch: 20, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.466 Vali Acc: 0.489 Test Loss: 1.466 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 21 cost time: 1.9019098281860352
Epoch: 21, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.513 Vali Acc: 0.489 Test Loss: 1.513 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8855152130126953
Epoch: 22, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.500 Vali Acc: 0.496 Test Loss: 1.500 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 23 cost time: 1.719348430633545
Epoch: 23, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.508 Vali Acc: 0.504 Test Loss: 1.508 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 24 cost time: 1.8898797035217285
Epoch: 24, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.495 Vali Acc: 0.504 Test Loss: 1.495 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503802).  Saving model ...
Epoch: 25 cost time: 1.7036826610565186
Epoch: 25, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.545 Vali Acc: 0.496 Test Loss: 1.545 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.999424934387207
Epoch: 26, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.536 Vali Acc: 0.489 Test Loss: 1.536 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.222039222717285
Epoch: 27, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5313539505004883
Epoch: 28, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.540 Vali Acc: 0.481 Test Loss: 1.540 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6561167240142822
Epoch: 29, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.553 Vali Acc: 0.481 Test Loss: 1.553 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.4761428833007812
Epoch: 30, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.528 Vali Acc: 0.481 Test Loss: 1.528 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5613877773284912
Epoch: 31, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.551 Vali Acc: 0.489 Test Loss: 1.551 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5562069416046143
Epoch: 32, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.553 Vali Acc: 0.481 Test Loss: 1.553 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8521959781646729
Epoch: 33, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.484 Vali Acc: 0.489 Test Loss: 1.484 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.480696439743042
Epoch: 34, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.542 Vali Acc: 0.481 Test Loss: 1.542 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 1257445
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.214213609695435
Epoch: 1, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.601 Vali Acc: 0.252 Test Loss: 1.601 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 2.8604109287261963
Epoch: 2, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
Validation loss decreased (-0.251892 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 2.188636541366577
Epoch: 3, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.560 Vali Acc: 0.443 Test Loss: 1.560 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442732).  Saving model ...
Epoch: 4 cost time: 2.0723133087158203
Epoch: 4, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.526 Vali Acc: 0.435 Test Loss: 1.526 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1521668434143066
Epoch: 5, Steps: 8 | Train Loss: 1.151 Vali Loss: 1.498 Vali Acc: 0.427 Test Loss: 1.498 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5205984115600586
Epoch: 6, Steps: 8 | Train Loss: 1.023 Vali Loss: 1.476 Vali Acc: 0.443 Test Loss: 1.476 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 2.6837832927703857
Epoch: 7, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.476 Vali Acc: 0.466 Test Loss: 1.476 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 2.0876965522766113
Epoch: 8, Steps: 8 | Train Loss: 0.824 Vali Loss: 1.464 Vali Acc: 0.466 Test Loss: 1.464 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 2.081960916519165
Epoch: 9, Steps: 8 | Train Loss: 0.712 Vali Loss: 1.435 Vali Acc: 0.473 Test Loss: 1.435 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 10 cost time: 1.933495044708252
Epoch: 10, Steps: 8 | Train Loss: 0.614 Vali Loss: 1.408 Vali Acc: 0.504 Test Loss: 1.408 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 11 cost time: 2.670459270477295
Epoch: 11, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.418 Vali Acc: 0.504 Test Loss: 1.418 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8398494720458984
Epoch: 12, Steps: 8 | Train Loss: 0.438 Vali Loss: 1.393 Vali Acc: 0.519 Test Loss: 1.393 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 13 cost time: 1.8981232643127441
Epoch: 13, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.374 Vali Acc: 0.534 Test Loss: 1.374 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 2.5511887073516846
Epoch: 14, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.369 Vali Acc: 0.519 Test Loss: 1.369 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2461225986480713
Epoch: 15, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.355 Vali Acc: 0.542 Test Loss: 1.355 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 2.6203994750976562
Epoch: 16, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3137502670288086
Epoch: 17, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.400 Vali Acc: 0.527 Test Loss: 1.400 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.10675311088562
Epoch: 18, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.376 Vali Acc: 0.527 Test Loss: 1.376 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3102662563323975
Epoch: 19, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.454 Vali Acc: 0.542 Test Loss: 1.454 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.739041805267334
Epoch: 20, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.414 Vali Acc: 0.542 Test Loss: 1.414 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.786120653152466
Epoch: 21, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.394 Vali Acc: 0.550 Test Loss: 1.394 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 22 cost time: 2.674160957336426
Epoch: 22, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.453 Vali Acc: 0.534 Test Loss: 1.453 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.112638235092163
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.476 Vali Acc: 0.534 Test Loss: 1.476 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5148775577545166
Epoch: 24, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.004727602005005
Epoch: 25, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.434 Vali Acc: 0.527 Test Loss: 1.434 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4005589485168457
Epoch: 26, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.422 Vali Acc: 0.527 Test Loss: 1.422 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.017516613006592
Epoch: 27, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.485 Vali Acc: 0.519 Test Loss: 1.485 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0895791053771973
Epoch: 28, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.531 Vali Acc: 0.519 Test Loss: 1.531 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.438108444213867
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.520 Vali Acc: 0.511 Test Loss: 1.520 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.497799873352051
Epoch: 30, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.454 Vali Acc: 0.519 Test Loss: 1.454 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0325052738189697
Epoch: 31, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.459 Vali Acc: 0.527 Test Loss: 1.459 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1282373
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.147010326385498
Epoch: 1, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.623 Vali Acc: 0.191 Test Loss: 1.623 Test Acc: 0.191
Validation loss decreased (inf --> -0.190823).  Saving model ...
Epoch: 2 cost time: 2.674104928970337
Epoch: 2, Steps: 8 | Train Loss: 1.590 Vali Loss: 1.600 Vali Acc: 0.282 Test Loss: 1.600 Test Acc: 0.282
Validation loss decreased (-0.190823 --> -0.282427).  Saving model ...
Epoch: 3 cost time: 1.9503505229949951
Epoch: 3, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.572 Vali Acc: 0.481 Test Loss: 1.572 Test Acc: 0.481
Validation loss decreased (-0.282427 --> -0.480900).  Saving model ...
Epoch: 4 cost time: 2.114238739013672
Epoch: 4, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.549 Vali Acc: 0.427 Test Loss: 1.549 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.170485734939575
Epoch: 5, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.534 Vali Acc: 0.427 Test Loss: 1.534 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.218860149383545
Epoch: 6, Steps: 8 | Train Loss: 1.109 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.234018564224243
Epoch: 7, Steps: 8 | Train Loss: 0.997 Vali Loss: 1.502 Vali Acc: 0.420 Test Loss: 1.502 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.430669069290161
Epoch: 8, Steps: 8 | Train Loss: 0.938 Vali Loss: 1.486 Vali Acc: 0.420 Test Loss: 1.486 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5281786918640137
Epoch: 9, Steps: 8 | Train Loss: 0.836 Vali Loss: 1.480 Vali Acc: 0.435 Test Loss: 1.480 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1936285495758057
Epoch: 10, Steps: 8 | Train Loss: 0.761 Vali Loss: 1.484 Vali Acc: 0.427 Test Loss: 1.484 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1994271278381348
Epoch: 11, Steps: 8 | Train Loss: 0.659 Vali Loss: 1.490 Vali Acc: 0.420 Test Loss: 1.490 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.580719470977783
Epoch: 12, Steps: 8 | Train Loss: 0.590 Vali Loss: 1.488 Vali Acc: 0.443 Test Loss: 1.488 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.634946346282959
Epoch: 13, Steps: 8 | Train Loss: 0.512 Vali Loss: 1.489 Vali Acc: 0.435 Test Loss: 1.489 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 1307301
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.830333232879639
Epoch: 1, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.28922438621521
Epoch: 2, Steps: 8 | Train Loss: 1.350 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3948826789855957
Epoch: 3, Steps: 8 | Train Loss: 0.899 Vali Loss: 1.449 Vali Acc: 0.458 Test Loss: 1.449 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 2.8480331897735596
Epoch: 4, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.389 Vali Acc: 0.504 Test Loss: 1.389 Test Acc: 0.504
Validation loss decreased (-0.458001 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 2.2805299758911133
Epoch: 5, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.484 Vali Acc: 0.511 Test Loss: 1.484 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 2.47222638130188
Epoch: 6, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.322 Vali Acc: 0.534 Test Loss: 1.322 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534338).  Saving model ...
Epoch: 7 cost time: 2.329003095626831
Epoch: 7, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.717 Vali Acc: 0.527 Test Loss: 1.717 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1458795070648193
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.442 Vali Acc: 0.573 Test Loss: 1.442 Test Acc: 0.573
Validation loss decreased (-0.534338 --> -0.572505).  Saving model ...
Epoch: 9 cost time: 2.6408541202545166
Epoch: 9, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.449 Vali Acc: 0.542 Test Loss: 1.449 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.530475378036499
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.890 Vali Acc: 0.527 Test Loss: 1.890 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.976461887359619
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.193 Vali Acc: 0.519 Test Loss: 2.193 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5981204509735107
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.008 Vali Acc: 0.527 Test Loss: 2.008 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.538954973220825
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.855 Vali Acc: 0.542 Test Loss: 1.855 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4706737995147705
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.040 Vali Acc: 0.527 Test Loss: 2.040 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.603391647338867
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.380 Vali Acc: 0.519 Test Loss: 2.380 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9583942890167236
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.545 Vali Acc: 0.519 Test Loss: 2.545 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6748287677764893
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.535 Vali Acc: 0.519 Test Loss: 2.535 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5159671306610107
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.510 Vali Acc: 0.519 Test Loss: 2.510 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 4548485
model size : 17.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.967790126800537
Epoch: 1, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 3.064816474914551
Epoch: 2, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.5572125911712646
Epoch: 3, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.5888679027557373
Epoch: 4, Steps: 8 | Train Loss: 0.799 Vali Loss: 1.415 Vali Acc: 0.473 Test Loss: 1.415 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 3.63025164604187
Epoch: 5, Steps: 8 | Train Loss: 0.536 Vali Loss: 1.352 Vali Acc: 0.504 Test Loss: 1.352 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 2.80599045753479
Epoch: 6, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.385 Vali Acc: 0.519 Test Loss: 1.385 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 2.4221956729888916
Epoch: 7, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.392 Vali Acc: 0.519 Test Loss: 1.392 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7205724716186523
Epoch: 8, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.372 Vali Acc: 0.534 Test Loss: 1.372 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 2.8088033199310303
Epoch: 9, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.382 Vali Acc: 0.534 Test Loss: 1.382 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7896676063537598
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.387 Vali Acc: 0.557 Test Loss: 1.387 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 11 cost time: 2.650104284286499
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.432 Vali Acc: 0.573 Test Loss: 1.432 Test Acc: 0.573
Validation loss decreased (-0.557238 --> -0.572505).  Saving model ...
Epoch: 12 cost time: 2.6014161109924316
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.479 Vali Acc: 0.542 Test Loss: 1.479 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.783018112182617
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.492 Vali Acc: 0.565 Test Loss: 1.492 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8878684043884277
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.581 Vali Acc: 0.580 Test Loss: 1.581 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580137).  Saving model ...
Epoch: 15 cost time: 1.8235485553741455
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.701 Vali Acc: 0.542 Test Loss: 1.701 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.492771625518799
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.751 Vali Acc: 0.565 Test Loss: 1.751 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6726319789886475
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.738 Vali Acc: 0.565 Test Loss: 1.738 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.841330051422119
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.572 Vali Acc: 0.573 Test Loss: 1.572 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1764116287231445
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.536 Vali Acc: 0.588 Test Loss: 1.536 Test Acc: 0.588
Validation loss decreased (-0.580137 --> -0.587771).  Saving model ...
Epoch: 20 cost time: 2.7741076946258545
Epoch: 20, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.704 Vali Acc: 0.565 Test Loss: 1.704 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6487202644348145
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.841 Vali Acc: 0.550 Test Loss: 1.841 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.500896692276001
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.011 Vali Acc: 0.557 Test Loss: 2.011 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.28210186958313
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.675 Vali Acc: 0.557 Test Loss: 1.675 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8241965770721436
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.445 Vali Acc: 0.573 Test Loss: 1.445 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3128812313079834
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.656 Vali Acc: 0.565 Test Loss: 1.656 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.426403522491455
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.299 Vali Acc: 0.542 Test Loss: 2.299 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5387494564056396
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.573 Vali Acc: 0.542 Test Loss: 2.573 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.862657070159912
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.590 Vali Acc: 0.542 Test Loss: 2.590 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7322192192077637
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.733 Vali Acc: 0.542 Test Loss: 2.733 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 4452485
model size : 17.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.303558349609375
Epoch: 1, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.611 Vali Acc: 0.282 Test Loss: 1.611 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 3.030770778656006
Epoch: 2, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (-0.282427 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.377140998840332
Epoch: 3, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.4569878578186035
Epoch: 4, Steps: 8 | Train Loss: 0.954 Vali Loss: 1.496 Vali Acc: 0.450 Test Loss: 1.496 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 2.4972734451293945
Epoch: 5, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.444 Vali Acc: 0.489 Test Loss: 1.444 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 2.52767276763916
Epoch: 6, Steps: 8 | Train Loss: 0.462 Vali Loss: 1.379 Vali Acc: 0.496 Test Loss: 1.379 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 2.1076300144195557
Epoch: 7, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.324 Vali Acc: 0.527 Test Loss: 1.324 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.9929537773132324
Epoch: 8, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.368 Vali Acc: 0.519 Test Loss: 1.368 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8143818378448486
Epoch: 9, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5033774375915527
Epoch: 10, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.372 Vali Acc: 0.527 Test Loss: 1.372 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.59694504737854
Epoch: 11, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.351271152496338
Epoch: 12, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.422 Vali Acc: 0.519 Test Loss: 1.422 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6587400436401367
Epoch: 13, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.398 Vali Acc: 0.527 Test Loss: 1.398 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.582221031188965
Epoch: 14, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.391 Vali Acc: 0.519 Test Loss: 1.391 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.537801504135132
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.379 Vali Acc: 0.557 Test Loss: 1.379 Test Acc: 0.557
Validation loss decreased (-0.526704 --> -0.557238).  Saving model ...
Epoch: 16 cost time: 2.4870033264160156
Epoch: 16, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.387 Vali Acc: 0.557 Test Loss: 1.387 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5591351985931396
Epoch: 17, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.394 Vali Acc: 0.573 Test Loss: 1.394 Test Acc: 0.573
Validation loss decreased (-0.557238 --> -0.572505).  Saving model ...
Epoch: 18 cost time: 2.928342580795288
Epoch: 18, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.409 Vali Acc: 0.542 Test Loss: 1.409 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4394891262054443
Epoch: 19, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.414 Vali Acc: 0.534 Test Loss: 1.414 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5207910537719727
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.427 Vali Acc: 0.573 Test Loss: 1.427 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0744481086730957
Epoch: 21, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.604 Vali Acc: 0.527 Test Loss: 1.604 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5902013778686523
Epoch: 22, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.568 Vali Acc: 0.534 Test Loss: 1.568 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4449594020843506
Epoch: 23, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.554 Vali Acc: 0.534 Test Loss: 1.554 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5668463706970215
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.820 Vali Acc: 0.527 Test Loss: 1.820 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.917464017868042
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.818 Vali Acc: 0.542 Test Loss: 1.818 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.4903523921966553
Epoch: 26, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.691 Vali Acc: 0.573 Test Loss: 1.691 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5302765369415283
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.630 Vali Acc: 0.580 Test Loss: 1.630 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580136).  Saving model ...
Epoch: 28 cost time: 2.7063896656036377
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.764 Vali Acc: 0.550 Test Loss: 1.764 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3615684509277344
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.961 Vali Acc: 0.550 Test Loss: 1.961 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1626901626586914
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.063 Vali Acc: 0.542 Test Loss: 2.063 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.297234535217285
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.146 Vali Acc: 0.550 Test Loss: 2.146 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.2808594703674316
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.195 Vali Acc: 0.550 Test Loss: 2.195 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8500518798828125
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.146 Vali Acc: 0.573 Test Loss: 2.146 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.6636862754821777
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.129 Vali Acc: 0.573 Test Loss: 2.129 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.004934549331665
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.210 Vali Acc: 0.588 Test Loss: 2.210 Test Acc: 0.588
Validation loss decreased (-0.580136 --> -0.587764).  Saving model ...
Epoch: 36 cost time: 2.5036566257476807
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.408 Vali Acc: 0.573 Test Loss: 2.408 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.2519209384918213
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.549 Vali Acc: 0.565 Test Loss: 2.549 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.236793279647827
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.649 Vali Acc: 0.550 Test Loss: 2.649 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.430572032928467
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.700 Vali Acc: 0.542 Test Loss: 2.700 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.1487343311309814
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.730 Vali Acc: 0.542 Test Loss: 2.730 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.5153679847717285
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.721 Vali Acc: 0.542 Test Loss: 2.721 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.3036880493164062
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.729 Vali Acc: 0.550 Test Loss: 2.729 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.2642881870269775
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.770 Vali Acc: 0.542 Test Loss: 2.770 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.2057383060455322
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.789 Vali Acc: 0.542 Test Loss: 2.789 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.4151675701141357
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.805 Vali Acc: 0.542 Test Loss: 2.805 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 4456197
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.055396556854248
Epoch: 1, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.595 Vali Acc: 0.435 Test Loss: 1.595 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 2.288506269454956
Epoch: 2, Steps: 8 | Train Loss: 1.439 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.150411367416382
Epoch: 3, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.965524673461914
Epoch: 4, Steps: 8 | Train Loss: 0.966 Vali Loss: 1.530 Vali Acc: 0.435 Test Loss: 1.530 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 2.0427756309509277
Epoch: 5, Steps: 8 | Train Loss: 0.751 Vali Loss: 1.478 Vali Acc: 0.489 Test Loss: 1.478 Test Acc: 0.489
Validation loss decreased (-0.435099 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 2.1202802658081055
Epoch: 6, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.447 Vali Acc: 0.496 Test Loss: 1.447 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 2.790905475616455
Epoch: 7, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.440 Vali Acc: 0.511 Test Loss: 1.440 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 2.131857395172119
Epoch: 8, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.370 Vali Acc: 0.534 Test Loss: 1.370 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.9646966457366943
Epoch: 9, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.400 Vali Acc: 0.557 Test Loss: 1.400 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 10 cost time: 2.209578275680542
Epoch: 10, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1335742473602295
Epoch: 11, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.387 Vali Acc: 0.534 Test Loss: 1.387 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2073593139648438
Epoch: 12, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.343 Vali Acc: 0.557 Test Loss: 1.343 Test Acc: 0.557
Validation loss decreased (-0.557238 --> -0.557238).  Saving model ...
Epoch: 13 cost time: 2.100193977355957
Epoch: 13, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.372 Vali Acc: 0.550 Test Loss: 1.372 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1679606437683105
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.387 Vali Acc: 0.550 Test Loss: 1.387 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.869819164276123
Epoch: 15, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.362 Vali Acc: 0.573 Test Loss: 1.362 Test Acc: 0.573
Validation loss decreased (-0.557238 --> -0.572505).  Saving model ...
Epoch: 16 cost time: 2.6703097820281982
Epoch: 16, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.413 Vali Acc: 0.580 Test Loss: 1.413 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580139).  Saving model ...
Epoch: 17 cost time: 2.345114231109619
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.476 Vali Acc: 0.580 Test Loss: 1.476 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.391944169998169
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.514 Vali Acc: 0.573 Test Loss: 1.514 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.298485517501831
Epoch: 19, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.531 Vali Acc: 0.565 Test Loss: 1.531 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6274425983428955
Epoch: 20, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.632 Vali Acc: 0.534 Test Loss: 1.632 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.33341383934021
Epoch: 21, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.622 Vali Acc: 0.519 Test Loss: 1.622 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5662882328033447
Epoch: 22, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.495 Vali Acc: 0.550 Test Loss: 1.495 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2151923179626465
Epoch: 23, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.508 Vali Acc: 0.580 Test Loss: 1.508 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0635886192321777
Epoch: 24, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.654 Vali Acc: 0.542 Test Loss: 1.654 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4004645347595215
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.707 Vali Acc: 0.527 Test Loss: 1.707 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5618693828582764
Epoch: 26, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.981 Vali Acc: 0.511 Test Loss: 1.981 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 4490757
model size : 17.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.26900577545166
Epoch: 1, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.598 Vali Acc: 0.397 Test Loss: 1.598 Test Acc: 0.397
Validation loss decreased (inf --> -0.396931).  Saving model ...
Epoch: 2 cost time: 2.571678400039673
Epoch: 2, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.2604355812072754
Epoch: 3, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.8803565502166748
Epoch: 4, Steps: 8 | Train Loss: 1.017 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.476231575012207
Epoch: 5, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.502 Vali Acc: 0.427 Test Loss: 1.502 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.9006595611572266
Epoch: 6, Steps: 8 | Train Loss: 0.621 Vali Loss: 1.484 Vali Acc: 0.450 Test Loss: 1.484 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.6407454013824463
Epoch: 7, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.474 Vali Acc: 0.458 Test Loss: 1.474 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 2.1567726135253906
Epoch: 8, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.442 Vali Acc: 0.473 Test Loss: 1.442 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 2.6480202674865723
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.414 Vali Acc: 0.504 Test Loss: 1.414 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 2.4188642501831055
Epoch: 10, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.423 Vali Acc: 0.519 Test Loss: 1.423 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 2.0624897480010986
Epoch: 11, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.395 Vali Acc: 0.527 Test Loss: 1.395 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 2.967003107070923
Epoch: 12, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.361 Vali Acc: 0.534 Test Loss: 1.361 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 13 cost time: 2.4383347034454346
Epoch: 13, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.403 Vali Acc: 0.511 Test Loss: 1.403 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0285162925720215
Epoch: 14, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1678695678710938
Epoch: 15, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2316091060638428
Epoch: 16, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2112982273101807
Epoch: 17, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.412 Vali Acc: 0.519 Test Loss: 1.412 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.065439462661743
Epoch: 18, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.296539068222046
Epoch: 19, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2063236236572266
Epoch: 20, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.450 Vali Acc: 0.519 Test Loss: 1.450 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.791245698928833
Epoch: 21, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.435 Vali Acc: 0.519 Test Loss: 1.435 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3238956928253174
Epoch: 22, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.483 Vali Acc: 0.534 Test Loss: 1.483 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 4582789
model size : 17.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.679137945175171
Epoch: 1, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.637 Vali Acc: 0.137 Test Loss: 1.637 Test Acc: 0.137
Validation loss decreased (inf --> -0.137388).  Saving model ...
Epoch: 2 cost time: 1.8287646770477295
Epoch: 2, Steps: 8 | Train Loss: 1.494 Vali Loss: 1.618 Vali Acc: 0.412 Test Loss: 1.618 Test Acc: 0.412
Validation loss decreased (-0.137388 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.668856143951416
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.574 Vali Acc: 0.427 Test Loss: 1.574 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.8910109996795654
Epoch: 4, Steps: 8 | Train Loss: 0.984 Vali Loss: 1.517 Vali Acc: 0.443 Test Loss: 1.517 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 2.169240951538086
Epoch: 5, Steps: 8 | Train Loss: 0.769 Vali Loss: 1.475 Vali Acc: 0.473 Test Loss: 1.475 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.6120030879974365
Epoch: 6, Steps: 8 | Train Loss: 0.571 Vali Loss: 1.422 Vali Acc: 0.504 Test Loss: 1.422 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.9160652160644531
Epoch: 7, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.394 Vali Acc: 0.519 Test Loss: 1.394 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 2.29580020904541
Epoch: 8, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.438 Vali Acc: 0.527 Test Loss: 1.438 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 2.0984621047973633
Epoch: 9, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.431 Vali Acc: 0.527 Test Loss: 1.431 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 10 cost time: 2.2046096324920654
Epoch: 10, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.388 Vali Acc: 0.534 Test Loss: 1.388 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 1.8517978191375732
Epoch: 11, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8230783939361572
Epoch: 12, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.365 Vali Acc: 0.519 Test Loss: 1.365 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9089081287384033
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.383 Vali Acc: 0.534 Test Loss: 1.383 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 1.8752729892730713
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.375 Vali Acc: 0.534 Test Loss: 1.375 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 15 cost time: 1.7827653884887695
Epoch: 15, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.389 Vali Acc: 0.527 Test Loss: 1.389 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8951096534729004
Epoch: 16, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.422 Vali Acc: 0.542 Test Loss: 1.422 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 17 cost time: 2.121894598007202
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.454 Vali Acc: 0.542 Test Loss: 1.454 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.587256908416748
Epoch: 18, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.401 Vali Acc: 0.542 Test Loss: 1.401 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 19 cost time: 1.947399377822876
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.396 Vali Acc: 0.534 Test Loss: 1.396 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4958090782165527
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.409 Vali Acc: 0.565 Test Loss: 1.409 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564871).  Saving model ...
Epoch: 21 cost time: 2.141735076904297
Epoch: 21, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.461 Vali Acc: 0.595 Test Loss: 1.461 Test Acc: 0.595
Validation loss decreased (-0.564871 --> -0.595405).  Saving model ...
Epoch: 22 cost time: 1.8036587238311768
Epoch: 22, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.519 Vali Acc: 0.573 Test Loss: 1.519 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0496695041656494
Epoch: 23, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.473 Vali Acc: 0.573 Test Loss: 1.473 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4969654083251953
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.516 Vali Acc: 0.534 Test Loss: 1.516 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.133394479751587
Epoch: 25, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.470 Vali Acc: 0.542 Test Loss: 1.470 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.97261643409729
Epoch: 26, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.468 Vali Acc: 0.542 Test Loss: 1.468 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8454365730285645
Epoch: 27, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.455 Vali Acc: 0.550 Test Loss: 1.455 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9294309616088867
Epoch: 28, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.439 Vali Acc: 0.557 Test Loss: 1.439 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7875330448150635
Epoch: 29, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.588 Vali Acc: 0.550 Test Loss: 1.588 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.1408512592315674
Epoch: 30, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.631 Vali Acc: 0.573 Test Loss: 1.631 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0321264266967773
Epoch: 31, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.856 Vali Acc: 0.542 Test Loss: 1.856 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 4682501
model size : 17.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.924350023269653
Epoch: 1, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.617 Vali Acc: 0.168 Test Loss: 1.617 Test Acc: 0.168
Validation loss decreased (inf --> -0.167923).  Saving model ...
Epoch: 2 cost time: 1.7008471488952637
Epoch: 2, Steps: 8 | Train Loss: 1.484 Vali Loss: 1.589 Vali Acc: 0.351 Test Loss: 1.589 Test Acc: 0.351
Validation loss decreased (-0.167923 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.861311674118042
Epoch: 3, Steps: 8 | Train Loss: 1.267 Vali Loss: 1.551 Vali Acc: 0.443 Test Loss: 1.551 Test Acc: 0.443
Validation loss decreased (-0.351129 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.999159812927246
Epoch: 4, Steps: 8 | Train Loss: 1.045 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8595526218414307
Epoch: 5, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9045751094818115
Epoch: 6, Steps: 8 | Train Loss: 0.684 Vali Loss: 1.511 Vali Acc: 0.450 Test Loss: 1.511 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 2.206697940826416
Epoch: 7, Steps: 8 | Train Loss: 0.536 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.88149094581604
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 1.512 Vali Acc: 0.466 Test Loss: 1.512 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.892662525177002
Epoch: 9, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.508 Vali Acc: 0.481 Test Loss: 1.508 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.6712679862976074
Epoch: 10, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 11 cost time: 1.7459495067596436
Epoch: 11, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.488 Vali Acc: 0.489 Test Loss: 1.488 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8984918594360352
Epoch: 12, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.495 Vali Acc: 0.473 Test Loss: 1.495 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.792160987854004
Epoch: 13, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.487 Vali Acc: 0.466 Test Loss: 1.487 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8703835010528564
Epoch: 14, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.483 Vali Acc: 0.473 Test Loss: 1.483 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.009337902069092
Epoch: 15, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.490 Vali Acc: 0.496 Test Loss: 1.490 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6433637142181396
Epoch: 16, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.526 Vali Acc: 0.466 Test Loss: 1.526 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5320498943328857
Epoch: 17, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.546 Vali Acc: 0.458 Test Loss: 1.546 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3712079524993896
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.548 Vali Acc: 0.450 Test Loss: 1.548 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.766634225845337
Epoch: 19, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.551 Vali Acc: 0.450 Test Loss: 1.551 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5765233039855957
Epoch: 20, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.552 Vali Acc: 0.458 Test Loss: 1.552 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 4789893
model size : 18.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.199331998825073
Epoch: 1, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.597 Vali Acc: 0.389 Test Loss: 1.597 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.8061749935150146
Epoch: 2, Steps: 8 | Train Loss: 1.402 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.9379034042358398
Epoch: 3, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6719224452972412
Epoch: 4, Steps: 8 | Train Loss: 0.880 Vali Loss: 1.474 Vali Acc: 0.443 Test Loss: 1.474 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.9004888534545898
Epoch: 5, Steps: 8 | Train Loss: 0.606 Vali Loss: 1.388 Vali Acc: 0.489 Test Loss: 1.388 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488536).  Saving model ...
Epoch: 6 cost time: 1.3942344188690186
Epoch: 6, Steps: 8 | Train Loss: 0.415 Vali Loss: 1.311 Vali Acc: 0.504 Test Loss: 1.311 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503804).  Saving model ...
Epoch: 7 cost time: 1.5502386093139648
Epoch: 7, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.306 Vali Acc: 0.519 Test Loss: 1.306 Test Acc: 0.519
Validation loss decreased (-0.503804 --> -0.519071).  Saving model ...
Epoch: 8 cost time: 1.6012334823608398
Epoch: 8, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.373 Vali Acc: 0.519 Test Loss: 1.373 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6115634441375732
Epoch: 9, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5437448024749756
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.361 Vali Acc: 0.519 Test Loss: 1.361 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5958948135375977
Epoch: 11, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.418 Vali Acc: 0.519 Test Loss: 1.418 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8266491889953613
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.577 Vali Acc: 0.519 Test Loss: 1.577 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6123135089874268
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.638 Vali Acc: 0.519 Test Loss: 1.638 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4556071758270264
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.691 Vali Acc: 0.519 Test Loss: 1.691 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7001233100891113
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.648 Vali Acc: 0.542 Test Loss: 1.648 Test Acc: 0.542
Validation loss decreased (-0.519071 --> -0.541968).  Saving model ...
Epoch: 16 cost time: 1.8129138946533203
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2801339626312256
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.703 Vali Acc: 0.527 Test Loss: 1.703 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5291316509246826
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.825 Vali Acc: 0.519 Test Loss: 1.825 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7863237857818604
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.935 Vali Acc: 0.511 Test Loss: 1.935 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8794279098510742
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.922 Vali Acc: 0.519 Test Loss: 1.922 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4849927425384521
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.931 Vali Acc: 0.519 Test Loss: 1.931 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9440326690673828
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.886 Vali Acc: 0.527 Test Loss: 1.886 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2508814334869385
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.730 Vali Acc: 0.534 Test Loss: 1.730 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6876511573791504
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.753 Vali Acc: 0.534 Test Loss: 1.753 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.751694679260254
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.043 Vali Acc: 0.527 Test Loss: 2.043 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1274821
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.802462339401245
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.597 Vali Acc: 0.366 Test Loss: 1.597 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 1.8457634449005127
Epoch: 2, Steps: 8 | Train Loss: 1.446 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (-0.366396 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7504658699035645
Epoch: 3, Steps: 8 | Train Loss: 1.258 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.140840530395508
Epoch: 4, Steps: 8 | Train Loss: 1.086 Vali Loss: 1.518 Vali Acc: 0.427 Test Loss: 1.518 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 2.2406697273254395
Epoch: 5, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.476 Vali Acc: 0.450 Test Loss: 1.476 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.7329773902893066
Epoch: 6, Steps: 8 | Train Loss: 0.695 Vali Loss: 1.419 Vali Acc: 0.473 Test Loss: 1.419 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 2.1897964477539062
Epoch: 7, Steps: 8 | Train Loss: 0.509 Vali Loss: 1.358 Vali Acc: 0.519 Test Loss: 1.358 Test Acc: 0.519
Validation loss decreased (-0.473268 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.8629324436187744
Epoch: 8, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.328 Vali Acc: 0.519 Test Loss: 1.328 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519071).  Saving model ...
Epoch: 9 cost time: 1.7879350185394287
Epoch: 9, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.8008005619049072
Epoch: 10, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.364 Vali Acc: 0.519 Test Loss: 1.364 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2986338138580322
Epoch: 11, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.351 Vali Acc: 0.534 Test Loss: 1.351 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 12 cost time: 1.9802510738372803
Epoch: 12, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.077279567718506
Epoch: 13, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.470 Vali Acc: 0.542 Test Loss: 1.470 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541970).  Saving model ...
Epoch: 14 cost time: 1.9363434314727783
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.424 Vali Acc: 0.534 Test Loss: 1.424 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9205822944641113
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.379 Vali Acc: 0.550 Test Loss: 1.379 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549605).  Saving model ...
Epoch: 16 cost time: 2.0182554721832275
Epoch: 16, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.551 Vali Acc: 0.527 Test Loss: 1.551 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.616410255432129
Epoch: 17, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.567 Vali Acc: 0.534 Test Loss: 1.567 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9788165092468262
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.568 Vali Acc: 0.527 Test Loss: 1.568 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2028348445892334
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.595 Vali Acc: 0.519 Test Loss: 1.595 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.042625665664673
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.590 Vali Acc: 0.519 Test Loss: 1.590 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6923866271972656
Epoch: 21, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.575 Vali Acc: 0.527 Test Loss: 1.575 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5379011631011963
Epoch: 22, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.631 Vali Acc: 0.527 Test Loss: 1.631 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1082592010498047
Epoch: 23, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.656 Vali Acc: 0.511 Test Loss: 1.656 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.941493034362793
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.673 Vali Acc: 0.527 Test Loss: 1.673 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9138939380645752
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.651 Vali Acc: 0.511 Test Loss: 1.651 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1226821
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.920316696166992
Epoch: 1, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.595 Vali Acc: 0.366 Test Loss: 1.595 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 2.203751802444458
Epoch: 2, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.574 Vali Acc: 0.405 Test Loss: 1.574 Test Acc: 0.405
Validation loss decreased (-0.366396 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 2.0706796646118164
Epoch: 3, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7172205448150635
Epoch: 4, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.022700548171997
Epoch: 5, Steps: 8 | Train Loss: 1.038 Vali Loss: 1.491 Vali Acc: 0.420 Test Loss: 1.491 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.6815333366394043
Epoch: 6, Steps: 8 | Train Loss: 0.879 Vali Loss: 1.474 Vali Acc: 0.466 Test Loss: 1.474 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.7986853122711182
Epoch: 7, Steps: 8 | Train Loss: 0.702 Vali Loss: 1.431 Vali Acc: 0.489 Test Loss: 1.431 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 2.0743634700775146
Epoch: 8, Steps: 8 | Train Loss: 0.514 Vali Loss: 1.423 Vali Acc: 0.496 Test Loss: 1.423 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 2.0609586238861084
Epoch: 9, Steps: 8 | Train Loss: 0.441 Vali Loss: 1.427 Vali Acc: 0.504 Test Loss: 1.427 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.9965243339538574
Epoch: 10, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526703).  Saving model ...
Epoch: 11 cost time: 2.114124298095703
Epoch: 11, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.415 Vali Acc: 0.527 Test Loss: 1.415 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 12 cost time: 2.047522783279419
Epoch: 12, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 13 cost time: 1.83162522315979
Epoch: 13, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.425 Vali Acc: 0.527 Test Loss: 1.425 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1612026691436768
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.452 Vali Acc: 0.542 Test Loss: 1.452 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541970).  Saving model ...
Epoch: 15 cost time: 1.9181394577026367
Epoch: 15, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.463 Vali Acc: 0.542 Test Loss: 1.463 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1474452018737793
Epoch: 16, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.450 Vali Acc: 0.542 Test Loss: 1.450 Test Acc: 0.542
Validation loss decreased (-0.541970 --> -0.541970).  Saving model ...
Epoch: 17 cost time: 2.4063992500305176
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.411 Vali Acc: 0.550 Test Loss: 1.411 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549604).  Saving model ...
Epoch: 18 cost time: 2.46468448638916
Epoch: 18, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.461 Vali Acc: 0.550 Test Loss: 1.461 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9865097999572754
Epoch: 19, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.565 Vali Acc: 0.534 Test Loss: 1.565 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5186965465545654
Epoch: 20, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.583 Vali Acc: 0.519 Test Loss: 1.583 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0006210803985596
Epoch: 21, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.448 Vali Acc: 0.550 Test Loss: 1.448 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8512845039367676
Epoch: 22, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.466 Vali Acc: 0.542 Test Loss: 1.466 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1927831172943115
Epoch: 23, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.471 Vali Acc: 0.542 Test Loss: 1.471 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3956408500671387
Epoch: 24, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.520 Vali Acc: 0.550 Test Loss: 1.520 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0173935890197754
Epoch: 25, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.518 Vali Acc: 0.542 Test Loss: 1.518 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9093084335327148
Epoch: 26, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.454 Vali Acc: 0.550 Test Loss: 1.454 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.926994800567627
Epoch: 27, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.321 Vali Acc: 0.550 Test Loss: 1.321 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549605).  Saving model ...
Epoch: 28 cost time: 1.8377971649169922
Epoch: 28, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.369 Vali Acc: 0.557 Test Loss: 1.369 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557238).  Saving model ...
Epoch: 29 cost time: 1.8514726161956787
Epoch: 29, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.482 Vali Acc: 0.557 Test Loss: 1.482 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.137026786804199
Epoch: 30, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.511 Vali Acc: 0.542 Test Loss: 1.511 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.549281120300293
Epoch: 31, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.567 Vali Acc: 0.542 Test Loss: 1.567 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.093946933746338
Epoch: 32, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.527 Vali Acc: 0.550 Test Loss: 1.527 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.110962390899658
Epoch: 33, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0611042976379395
Epoch: 34, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.734 Vali Acc: 0.519 Test Loss: 1.734 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8902933597564697
Epoch: 35, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.691 Vali Acc: 0.527 Test Loss: 1.691 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.13938307762146
Epoch: 36, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.533 Vali Acc: 0.565 Test Loss: 1.533 Test Acc: 0.565
Validation loss decreased (-0.557238 --> -0.564870).  Saving model ...
Epoch: 37 cost time: 1.7138466835021973
Epoch: 37, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.727 Vali Acc: 0.550 Test Loss: 1.727 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7354483604431152
Epoch: 38, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.854 Vali Acc: 0.534 Test Loss: 1.854 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.3769543170928955
Epoch: 39, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.023 Vali Acc: 0.527 Test Loss: 2.023 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.521385908126831
Epoch: 40, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.277 Vali Acc: 0.519 Test Loss: 2.277 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.7359695434570312
Epoch: 41, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.262 Vali Acc: 0.519 Test Loss: 2.262 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.779280662536621
Epoch: 42, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.161 Vali Acc: 0.527 Test Loss: 2.161 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.189384698867798
Epoch: 43, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.105 Vali Acc: 0.550 Test Loss: 2.105 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.1640563011169434
Epoch: 44, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.321 Vali Acc: 0.542 Test Loss: 2.321 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.326833486557007
Epoch: 45, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.494 Vali Acc: 0.542 Test Loss: 2.494 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7978482246398926
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.612 Vali Acc: 0.542 Test Loss: 2.612 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1228677
model size : 4.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.7151830196380615
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.613 Vali Acc: 0.252 Test Loss: 1.613 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 2.0199644565582275
Epoch: 2, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
Validation loss decreased (-0.251892 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.8943474292755127
Epoch: 3, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.2789525985717773
Epoch: 4, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7099368572235107
Epoch: 5, Steps: 8 | Train Loss: 1.032 Vali Loss: 1.499 Vali Acc: 0.427 Test Loss: 1.499 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.5459461212158203
Epoch: 6, Steps: 8 | Train Loss: 0.841 Vali Loss: 1.463 Vali Acc: 0.473 Test Loss: 1.463 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 1.9029951095581055
Epoch: 7, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.402 Vali Acc: 0.496 Test Loss: 1.402 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.5507094860076904
Epoch: 8, Steps: 8 | Train Loss: 0.584 Vali Loss: 1.369 Vali Acc: 0.527 Test Loss: 1.369 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 9 cost time: 2.0619266033172607
Epoch: 9, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.330 Vali Acc: 0.550 Test Loss: 1.330 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549605).  Saving model ...
Epoch: 10 cost time: 1.841672658920288
Epoch: 10, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.282 Vali Acc: 0.557 Test Loss: 1.282 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 11 cost time: 1.648888349533081
Epoch: 11, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.319 Vali Acc: 0.542 Test Loss: 1.319 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7235667705535889
Epoch: 12, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.293 Vali Acc: 0.557 Test Loss: 1.293 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8854107856750488
Epoch: 13, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.288 Vali Acc: 0.557 Test Loss: 1.288 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5934407711029053
Epoch: 14, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.313 Vali Acc: 0.557 Test Loss: 1.313 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.301483631134033
Epoch: 15, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.286 Vali Acc: 0.565 Test Loss: 1.286 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564873).  Saving model ...
Epoch: 16 cost time: 1.8558464050292969
Epoch: 16, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2359416484832764
Epoch: 17, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.326 Vali Acc: 0.565 Test Loss: 1.326 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6044096946716309
Epoch: 18, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.392 Vali Acc: 0.565 Test Loss: 1.392 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4681437015533447
Epoch: 19, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.379 Vali Acc: 0.557 Test Loss: 1.379 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.257042169570923
Epoch: 20, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.398 Vali Acc: 0.573 Test Loss: 1.398 Test Acc: 0.573
Validation loss decreased (-0.564873 --> -0.572505).  Saving model ...
Epoch: 21 cost time: 1.8299589157104492
Epoch: 21, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.380 Vali Acc: 0.573 Test Loss: 1.380 Test Acc: 0.573
Validation loss decreased (-0.572505 --> -0.572505).  Saving model ...
Epoch: 22 cost time: 1.6119484901428223
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.353 Vali Acc: 0.565 Test Loss: 1.353 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8356921672821045
Epoch: 23, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.332 Vali Acc: 0.550 Test Loss: 1.332 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9227440357208252
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.327 Vali Acc: 0.557 Test Loss: 1.327 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.736604928970337
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.317 Vali Acc: 0.565 Test Loss: 1.317 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.800013780593872
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.336 Vali Acc: 0.565 Test Loss: 1.336 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.819427251815796
Epoch: 27, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9263861179351807
Epoch: 28, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.330 Vali Acc: 0.595 Test Loss: 1.330 Test Acc: 0.595
Validation loss decreased (-0.572505 --> -0.595407).  Saving model ...
Epoch: 29 cost time: 1.8653390407562256
Epoch: 29, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.550 Vali Acc: 0.588 Test Loss: 1.550 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7022311687469482
Epoch: 30, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.520 Vali Acc: 0.565 Test Loss: 1.520 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5451455116271973
Epoch: 31, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.430 Vali Acc: 0.557 Test Loss: 1.430 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5948152542114258
Epoch: 32, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.411 Vali Acc: 0.550 Test Loss: 1.411 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8373024463653564
Epoch: 33, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.333 Vali Acc: 0.580 Test Loss: 1.333 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0521597862243652
Epoch: 34, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.367 Vali Acc: 0.611 Test Loss: 1.367 Test Acc: 0.611
Validation loss decreased (-0.595407 --> -0.610673).  Saving model ...
Epoch: 35 cost time: 1.949228286743164
Epoch: 35, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.422 Vali Acc: 0.603 Test Loss: 1.422 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.799677848815918
Epoch: 36, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.448 Vali Acc: 0.588 Test Loss: 1.448 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7018983364105225
Epoch: 37, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.622 Vali Acc: 0.557 Test Loss: 1.622 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7083914279937744
Epoch: 38, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.676 Vali Acc: 0.565 Test Loss: 1.676 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.818974494934082
Epoch: 39, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.756 Vali Acc: 0.527 Test Loss: 1.756 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.8902876377105713
Epoch: 40, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.669 Vali Acc: 0.534 Test Loss: 1.669 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.8537077903747559
Epoch: 41, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.680 Vali Acc: 0.588 Test Loss: 1.680 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.7273988723754883
Epoch: 42, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.741 Vali Acc: 0.565 Test Loss: 1.741 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.6306233406066895
Epoch: 43, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.775 Vali Acc: 0.580 Test Loss: 1.775 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.655118465423584
Epoch: 44, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.807 Vali Acc: 0.550 Test Loss: 1.807 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 1245957
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.0835583209991455
Epoch: 1, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.607 Vali Acc: 0.237 Test Loss: 1.607 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.7602386474609375
Epoch: 2, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.575 Vali Acc: 0.427 Test Loss: 1.575 Test Acc: 0.427
Validation loss decreased (-0.236625 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.6096713542938232
Epoch: 3, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.552 Vali Acc: 0.427 Test Loss: 1.552 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 2.0223793983459473
Epoch: 4, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9856696128845215
Epoch: 5, Steps: 8 | Train Loss: 1.091 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0790820121765137
Epoch: 6, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.495 Vali Acc: 0.443 Test Loss: 1.495 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.737201452255249
Epoch: 7, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.473 Vali Acc: 0.458 Test Loss: 1.473 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 1.4521431922912598
Epoch: 8, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.450 Vali Acc: 0.481 Test Loss: 1.450 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.8158388137817383
Epoch: 9, Steps: 8 | Train Loss: 0.583 Vali Loss: 1.452 Vali Acc: 0.481 Test Loss: 1.452 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9801199436187744
Epoch: 10, Steps: 8 | Train Loss: 0.509 Vali Loss: 1.437 Vali Acc: 0.481 Test Loss: 1.437 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 1.544675350189209
Epoch: 11, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503802).  Saving model ...
Epoch: 12 cost time: 1.5598714351654053
Epoch: 12, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.447 Vali Acc: 0.496 Test Loss: 1.447 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3949816226959229
Epoch: 13, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.440 Vali Acc: 0.504 Test Loss: 1.440 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8735108375549316
Epoch: 14, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.7217597961425781
Epoch: 15, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.434 Vali Acc: 0.527 Test Loss: 1.434 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 16 cost time: 1.5645010471343994
Epoch: 16, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4540684223175049
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 18 cost time: 1.7415096759796143
Epoch: 18, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.415 Vali Acc: 0.534 Test Loss: 1.415 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 19 cost time: 1.4230530261993408
Epoch: 19, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.438 Vali Acc: 0.519 Test Loss: 1.438 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7310419082641602
Epoch: 20, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.437 Vali Acc: 0.519 Test Loss: 1.437 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7350716590881348
Epoch: 21, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.451 Vali Acc: 0.519 Test Loss: 1.451 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.987342119216919
Epoch: 22, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.481 Vali Acc: 0.527 Test Loss: 1.481 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4651355743408203
Epoch: 23, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.466 Vali Acc: 0.534 Test Loss: 1.466 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5118298530578613
Epoch: 24, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4129204750061035
Epoch: 25, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5710241794586182
Epoch: 26, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.481 Vali Acc: 0.519 Test Loss: 1.481 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.334489345550537
Epoch: 27, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.508 Vali Acc: 0.511 Test Loss: 1.508 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3781144618988037
Epoch: 28, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.539 Vali Acc: 0.511 Test Loss: 1.539 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1291973
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.68958592414856
Epoch: 1, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.619 Vali Acc: 0.214 Test Loss: 1.619 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.7935216426849365
Epoch: 2, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.598 Vali Acc: 0.359 Test Loss: 1.598 Test Acc: 0.359
Validation loss decreased (-0.213724 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 1.7522690296173096
Epoch: 3, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.571 Vali Acc: 0.435 Test Loss: 1.571 Test Acc: 0.435
Validation loss decreased (-0.358763 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.6307711601257324
Epoch: 4, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.561 Vali Acc: 0.443 Test Loss: 1.561 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442732).  Saving model ...
Epoch: 5 cost time: 2.0303215980529785
Epoch: 5, Steps: 8 | Train Loss: 1.015 Vali Loss: 1.530 Vali Acc: 0.443 Test Loss: 1.530 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.992713212966919
Epoch: 6, Steps: 8 | Train Loss: 0.870 Vali Loss: 1.537 Vali Acc: 0.458 Test Loss: 1.537 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.7894561290740967
Epoch: 7, Steps: 8 | Train Loss: 0.733 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 8 cost time: 2.0023252964019775
Epoch: 8, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.446 Vali Acc: 0.496 Test Loss: 1.446 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 2.5239968299865723
Epoch: 9, Steps: 8 | Train Loss: 0.501 Vali Loss: 1.455 Vali Acc: 0.504 Test Loss: 1.455 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 2.2576117515563965
Epoch: 10, Steps: 8 | Train Loss: 0.396 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 11 cost time: 1.6262059211730957
Epoch: 11, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4246840476989746
Epoch: 12, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.479 Vali Acc: 0.534 Test Loss: 1.479 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 13 cost time: 2.4160807132720947
Epoch: 13, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.473 Vali Acc: 0.534 Test Loss: 1.473 Test Acc: 0.534
Validation loss decreased (-0.534336 --> -0.534336).  Saving model ...
Epoch: 14 cost time: 2.031970500946045
Epoch: 14, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.514 Vali Acc: 0.527 Test Loss: 1.514 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7076506614685059
Epoch: 15, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.496 Vali Acc: 0.534 Test Loss: 1.496 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1128854751586914
Epoch: 16, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.503 Vali Acc: 0.542 Test Loss: 1.503 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541970).  Saving model ...
Epoch: 17 cost time: 1.8401274681091309
Epoch: 17, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.536 Vali Acc: 0.519 Test Loss: 1.536 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8234684467315674
Epoch: 18, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.571 Vali Acc: 0.519 Test Loss: 1.571 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.195767641067505
Epoch: 19, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.549 Vali Acc: 0.519 Test Loss: 1.549 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3561363220214844
Epoch: 20, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.621 Vali Acc: 0.534 Test Loss: 1.621 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4201478958129883
Epoch: 21, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.596 Vali Acc: 0.534 Test Loss: 1.596 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2902278900146484
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8867573738098145
Epoch: 23, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.699 Vali Acc: 0.527 Test Loss: 1.699 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4693362712860107
Epoch: 24, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.595 Vali Acc: 0.534 Test Loss: 1.595 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6378114223480225
Epoch: 25, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.538 Vali Acc: 0.542 Test Loss: 1.538 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9885518550872803
Epoch: 26, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.572 Vali Acc: 0.542 Test Loss: 1.572 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1341829
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.795642852783203
Epoch: 1, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.584 Vali Acc: 0.359 Test Loss: 1.584 Test Acc: 0.359
Validation loss decreased (inf --> -0.358763).  Saving model ...
Epoch: 2 cost time: 1.92685866355896
Epoch: 2, Steps: 8 | Train Loss: 1.476 Vali Loss: 1.566 Vali Acc: 0.412 Test Loss: 1.566 Test Acc: 0.412
Validation loss decreased (-0.358763 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.4617948532104492
Epoch: 3, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6272826194763184
Epoch: 4, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.500758409500122
Epoch: 5, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 2.0618088245391846
Epoch: 6, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.079169750213623
Epoch: 7, Steps: 8 | Train Loss: 0.763 Vali Loss: 1.505 Vali Acc: 0.427 Test Loss: 1.505 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 2.101548433303833
Epoch: 8, Steps: 8 | Train Loss: 0.682 Vali Loss: 1.494 Vali Acc: 0.427 Test Loss: 1.494 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.8410699367523193
Epoch: 9, Steps: 8 | Train Loss: 0.599 Vali Loss: 1.482 Vali Acc: 0.443 Test Loss: 1.482 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 1.4816458225250244
Epoch: 10, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.465 Vali Acc: 0.466 Test Loss: 1.465 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 11 cost time: 1.607330083847046
Epoch: 11, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.479 Vali Acc: 0.466 Test Loss: 1.479 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.69472074508667
Epoch: 12, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.492 Vali Acc: 0.450 Test Loss: 1.492 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4187817573547363
Epoch: 13, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.486 Vali Acc: 0.450 Test Loss: 1.486 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4844465255737305
Epoch: 14, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.474 Vali Acc: 0.473 Test Loss: 1.474 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 15 cost time: 1.970670461654663
Epoch: 15, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.490 Vali Acc: 0.458 Test Loss: 1.490 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8387370109558105
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.492 Vali Acc: 0.450 Test Loss: 1.492 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7700889110565186
Epoch: 17, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.478 Vali Acc: 0.435 Test Loss: 1.478 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.58081316947937
Epoch: 18, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.473 Vali Acc: 0.435 Test Loss: 1.473 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4877889156341553
Epoch: 19, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3816492557525635
Epoch: 20, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.497 Vali Acc: 0.450 Test Loss: 1.497 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.325650930404663
Epoch: 21, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.524 Vali Acc: 0.458 Test Loss: 1.524 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.282242774963379
Epoch: 22, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.510 Vali Acc: 0.458 Test Loss: 1.510 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.361741304397583
Epoch: 23, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.512 Vali Acc: 0.458 Test Loss: 1.512 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.010618209838867
Epoch: 24, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.515 Vali Acc: 0.466 Test Loss: 1.515 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 1395525
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.591233968734741
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.589 Vali Acc: 0.328 Test Loss: 1.589 Test Acc: 0.328
Validation loss decreased (inf --> -0.328228).  Saving model ...
Epoch: 2 cost time: 1.3988919258117676
Epoch: 2, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.328228 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4889554977416992
Epoch: 3, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.4397368431091309
Epoch: 4, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.501 Vali Acc: 0.427 Test Loss: 1.501 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.428227424621582
Epoch: 5, Steps: 8 | Train Loss: 0.976 Vali Loss: 1.464 Vali Acc: 0.443 Test Loss: 1.464 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.5034124851226807
Epoch: 6, Steps: 8 | Train Loss: 0.785 Vali Loss: 1.406 Vali Acc: 0.504 Test Loss: 1.406 Test Acc: 0.504
Validation loss decreased (-0.442733 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.4818103313446045
Epoch: 7, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.370 Vali Acc: 0.504 Test Loss: 1.370 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.6160802841186523
Epoch: 8, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.321 Vali Acc: 0.519 Test Loss: 1.321 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519071).  Saving model ...
Epoch: 9 cost time: 1.7091307640075684
Epoch: 9, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.312 Vali Acc: 0.519 Test Loss: 1.312 Test Acc: 0.519
Validation loss decreased (-0.519071 --> -0.519071).  Saving model ...
Epoch: 10 cost time: 1.5484862327575684
Epoch: 10, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.355 Vali Acc: 0.519 Test Loss: 1.355 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7849738597869873
Epoch: 11, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.284 Vali Acc: 0.519 Test Loss: 1.284 Test Acc: 0.519
Validation loss decreased (-0.519071 --> -0.519071).  Saving model ...
Epoch: 12 cost time: 1.477463960647583
Epoch: 12, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.333 Vali Acc: 0.519 Test Loss: 1.333 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7835006713867188
Epoch: 13, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.390 Vali Acc: 0.527 Test Loss: 1.390 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.6535141468048096
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.416 Vali Acc: 0.542 Test Loss: 1.416 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 15 cost time: 1.5905797481536865
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.418 Vali Acc: 0.542 Test Loss: 1.418 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6438262462615967
Epoch: 16, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8141157627105713
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.425 Vali Acc: 0.527 Test Loss: 1.425 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5533487796783447
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7331321239471436
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7011733055114746
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.473 Vali Acc: 0.542 Test Loss: 1.473 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6720871925354004
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.583 Vali Acc: 0.527 Test Loss: 1.583 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8124172687530518
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.642 Vali Acc: 0.519 Test Loss: 1.642 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8299546241760254
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.555 Vali Acc: 0.534 Test Loss: 1.555 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8386461734771729
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.631 Vali Acc: 0.519 Test Loss: 1.631 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 387557
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.579863786697388
Epoch: 1, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.610 Vali Acc: 0.191 Test Loss: 1.610 Test Acc: 0.191
Validation loss decreased (inf --> -0.190824).  Saving model ...
Epoch: 2 cost time: 1.5680644512176514
Epoch: 2, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.579 Vali Acc: 0.389 Test Loss: 1.579 Test Acc: 0.389
Validation loss decreased (-0.190824 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.58945631980896
Epoch: 3, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6336522102355957
Epoch: 4, Steps: 8 | Train Loss: 1.283 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.4948816299438477
Epoch: 5, Steps: 8 | Train Loss: 1.163 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.5311939716339111
Epoch: 6, Steps: 8 | Train Loss: 1.020 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.7887821197509766
Epoch: 7, Steps: 8 | Train Loss: 0.911 Vali Loss: 1.464 Vali Acc: 0.458 Test Loss: 1.464 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 2.030653953552246
Epoch: 8, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.422 Vali Acc: 0.496 Test Loss: 1.422 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.5855374336242676
Epoch: 9, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.399 Vali Acc: 0.504 Test Loss: 1.399 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.4739506244659424
Epoch: 10, Steps: 8 | Train Loss: 0.556 Vali Loss: 1.364 Vali Acc: 0.504 Test Loss: 1.364 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 11 cost time: 1.9355814456939697
Epoch: 11, Steps: 8 | Train Loss: 0.423 Vali Loss: 1.353 Vali Acc: 0.511 Test Loss: 1.353 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 12 cost time: 2.0743813514709473
Epoch: 12, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.311 Vali Acc: 0.534 Test Loss: 1.311 Test Acc: 0.534
Validation loss decreased (-0.511437 --> -0.534338).  Saving model ...
Epoch: 13 cost time: 1.9693777561187744
Epoch: 13, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5302307605743408
Epoch: 14, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.330 Vali Acc: 0.550 Test Loss: 1.330 Test Acc: 0.550
Validation loss decreased (-0.534338 --> -0.549605).  Saving model ...
Epoch: 15 cost time: 1.4247045516967773
Epoch: 15, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.65450119972229
Epoch: 16, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.311 Vali Acc: 0.580 Test Loss: 1.311 Test Acc: 0.580
Validation loss decreased (-0.549605 --> -0.580140).  Saving model ...
Epoch: 17 cost time: 1.7955386638641357
Epoch: 17, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.424 Vali Acc: 0.557 Test Loss: 1.424 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8470849990844727
Epoch: 18, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.399 Vali Acc: 0.580 Test Loss: 1.399 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6465001106262207
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.403 Vali Acc: 0.588 Test Loss: 1.403 Test Acc: 0.588
Validation loss decreased (-0.580140 --> -0.587772).  Saving model ...
Epoch: 20 cost time: 2.2146716117858887
Epoch: 20, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.417 Vali Acc: 0.573 Test Loss: 1.417 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6161346435546875
Epoch: 21, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.387 Vali Acc: 0.580 Test Loss: 1.387 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6619174480438232
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.414 Vali Acc: 0.588 Test Loss: 1.414 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8727500438690186
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.470 Vali Acc: 0.580 Test Loss: 1.470 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.118459701538086
Epoch: 24, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.501 Vali Acc: 0.580 Test Loss: 1.501 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6969125270843506
Epoch: 25, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.538 Vali Acc: 0.573 Test Loss: 1.538 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5114080905914307
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.537 Vali Acc: 0.580 Test Loss: 1.537 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8876025676727295
Epoch: 27, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.459 Vali Acc: 0.595 Test Loss: 1.459 Test Acc: 0.595
Validation loss decreased (-0.587772 --> -0.595405).  Saving model ...
Epoch: 28 cost time: 2.1570680141448975
Epoch: 28, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.494 Vali Acc: 0.588 Test Loss: 1.494 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.837031364440918
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.601 Vali Acc: 0.580 Test Loss: 1.601 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.830152988433838
Epoch: 30, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.586 Vali Acc: 0.580 Test Loss: 1.586 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8976175785064697
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.557 Vali Acc: 0.588 Test Loss: 1.557 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.626816749572754
Epoch: 32, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.681 Vali Acc: 0.550 Test Loss: 1.681 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5267791748046875
Epoch: 33, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.663 Vali Acc: 0.580 Test Loss: 1.663 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7246718406677246
Epoch: 34, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.495 Vali Acc: 0.580 Test Loss: 1.495 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5924837589263916
Epoch: 35, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.510 Vali Acc: 0.580 Test Loss: 1.510 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7362236976623535
Epoch: 36, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.585 Vali Acc: 0.573 Test Loss: 1.585 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.934314250946045
Epoch: 37, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.548 Vali Acc: 0.580 Test Loss: 1.548 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 363557
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.418806076049805
Epoch: 1, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.623 Vali Acc: 0.321 Test Loss: 1.623 Test Acc: 0.321
Validation loss decreased (inf --> -0.320594).  Saving model ...
Epoch: 2 cost time: 1.8478918075561523
Epoch: 2, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.605 Vali Acc: 0.412 Test Loss: 1.605 Test Acc: 0.412
Validation loss decreased (-0.320594 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.5042335987091064
Epoch: 3, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.578 Vali Acc: 0.420 Test Loss: 1.578 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.249814510345459
Epoch: 4, Steps: 8 | Train Loss: 1.297 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5205163955688477
Epoch: 5, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.73333740234375
Epoch: 6, Steps: 8 | Train Loss: 1.107 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.5849156379699707
Epoch: 7, Steps: 8 | Train Loss: 1.000 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.6011967658996582
Epoch: 8, Steps: 8 | Train Loss: 0.866 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0810019969940186
Epoch: 9, Steps: 8 | Train Loss: 0.781 Vali Loss: 1.495 Vali Acc: 0.443 Test Loss: 1.495 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 1.3825101852416992
Epoch: 10, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.460 Vali Acc: 0.496 Test Loss: 1.460 Test Acc: 0.496
Validation loss decreased (-0.442733 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 1.5946433544158936
Epoch: 11, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.441 Vali Acc: 0.496 Test Loss: 1.441 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 1.7403910160064697
Epoch: 12, Steps: 8 | Train Loss: 0.514 Vali Loss: 1.460 Vali Acc: 0.504 Test Loss: 1.460 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 13 cost time: 1.7475039958953857
Epoch: 13, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.465 Vali Acc: 0.504 Test Loss: 1.465 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.678333044052124
Epoch: 14, Steps: 8 | Train Loss: 0.379 Vali Loss: 1.471 Vali Acc: 0.504 Test Loss: 1.471 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4671828746795654
Epoch: 15, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.469 Vali Acc: 0.504 Test Loss: 1.469 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6418471336364746
Epoch: 16, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.465 Vali Acc: 0.527 Test Loss: 1.465 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 17 cost time: 1.4340770244598389
Epoch: 17, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.461 Vali Acc: 0.527 Test Loss: 1.461 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 18 cost time: 1.6600418090820312
Epoch: 18, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.483 Vali Acc: 0.511 Test Loss: 1.483 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.050959825515747
Epoch: 19, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.489 Vali Acc: 0.519 Test Loss: 1.489 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7305450439453125
Epoch: 20, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.531 Vali Acc: 0.527 Test Loss: 1.531 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8776943683624268
Epoch: 21, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.545 Vali Acc: 0.519 Test Loss: 1.545 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7988741397857666
Epoch: 22, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.569 Vali Acc: 0.519 Test Loss: 1.569 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.505845546722412
Epoch: 23, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.534 Vali Acc: 0.534 Test Loss: 1.534 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 24 cost time: 1.8312034606933594
Epoch: 24, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.553 Vali Acc: 0.534 Test Loss: 1.553 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8551855087280273
Epoch: 25, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.602 Vali Acc: 0.534 Test Loss: 1.602 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5728909969329834
Epoch: 26, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.662 Vali Acc: 0.519 Test Loss: 1.662 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6714701652526855
Epoch: 27, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.647 Vali Acc: 0.527 Test Loss: 1.647 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6763696670532227
Epoch: 28, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.623 Vali Acc: 0.534 Test Loss: 1.623 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.017296552658081
Epoch: 29, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.653 Vali Acc: 0.534 Test Loss: 1.653 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6932032108306885
Epoch: 30, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.682 Vali Acc: 0.534 Test Loss: 1.682 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.626983642578125
Epoch: 31, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.716 Vali Acc: 0.542 Test Loss: 1.716 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541968).  Saving model ...
Epoch: 32 cost time: 2.279508352279663
Epoch: 32, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.628 Vali Acc: 0.527 Test Loss: 1.628 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6744544506072998
Epoch: 33, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.730 Vali Acc: 0.527 Test Loss: 1.730 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9833714962005615
Epoch: 34, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.663 Vali Acc: 0.527 Test Loss: 1.663 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.005211591720581
Epoch: 35, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.589 Vali Acc: 0.534 Test Loss: 1.589 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5857205390930176
Epoch: 36, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.581 Vali Acc: 0.542 Test Loss: 1.581 Test Acc: 0.542
Validation loss decreased (-0.541968 --> -0.541969).  Saving model ...
Epoch: 37 cost time: 1.9295496940612793
Epoch: 37, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.777 Vali Acc: 0.542 Test Loss: 1.777 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.700906753540039
Epoch: 38, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.855 Vali Acc: 0.534 Test Loss: 1.855 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7697713375091553
Epoch: 39, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.879 Vali Acc: 0.534 Test Loss: 1.879 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7772877216339111
Epoch: 40, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.775 Vali Acc: 0.550 Test Loss: 1.775 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549601).  Saving model ...
Epoch: 41 cost time: 1.5422825813293457
Epoch: 41, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.834 Vali Acc: 0.542 Test Loss: 1.834 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6675918102264404
Epoch: 42, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.732 Vali Acc: 0.557 Test Loss: 1.732 Test Acc: 0.557
Validation loss decreased (-0.549601 --> -0.557235).  Saving model ...
Epoch: 43 cost time: 1.584805965423584
Epoch: 43, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.705 Vali Acc: 0.557 Test Loss: 1.705 Test Acc: 0.557
Validation loss decreased (-0.557235 --> -0.557235).  Saving model ...
Epoch: 44 cost time: 1.507610559463501
Epoch: 44, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.818 Vali Acc: 0.557 Test Loss: 1.818 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5223603248596191
Epoch: 45, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.868 Vali Acc: 0.557 Test Loss: 1.868 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.395089864730835
Epoch: 46, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.795 Vali Acc: 0.557 Test Loss: 1.795 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.795128345489502
Epoch: 47, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.843 Vali Acc: 0.550 Test Loss: 1.843 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.8616206645965576
Epoch: 48, Steps: 8 | Train Loss: 0.029 Vali Loss: 2.045 Vali Acc: 0.527 Test Loss: 2.045 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.6294336318969727
Epoch: 49, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.838 Vali Acc: 0.542 Test Loss: 1.838 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.5174882411956787
Epoch: 50, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.843 Vali Acc: 0.550 Test Loss: 1.843 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 364485
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.205374002456665
Epoch: 1, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.602 Vali Acc: 0.305 Test Loss: 1.602 Test Acc: 0.305
Validation loss decreased (inf --> -0.305327).  Saving model ...
Epoch: 2 cost time: 1.6755928993225098
Epoch: 2, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.584 Vali Acc: 0.412 Test Loss: 1.584 Test Acc: 0.412
Validation loss decreased (-0.305327 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.9277563095092773
Epoch: 3, Steps: 8 | Train Loss: 1.467 Vali Loss: 1.563 Vali Acc: 0.427 Test Loss: 1.563 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.553177833557129
Epoch: 4, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5409934520721436
Epoch: 5, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.559 Vali Acc: 0.420 Test Loss: 1.559 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0848817825317383
Epoch: 6, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.915262222290039
Epoch: 7, Steps: 8 | Train Loss: 1.032 Vali Loss: 1.507 Vali Acc: 0.427 Test Loss: 1.507 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.86033296585083
Epoch: 8, Steps: 8 | Train Loss: 0.944 Vali Loss: 1.492 Vali Acc: 0.435 Test Loss: 1.492 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 9 cost time: 2.0161538124084473
Epoch: 9, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.485 Vali Acc: 0.443 Test Loss: 1.485 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 2.6746928691864014
Epoch: 10, Steps: 8 | Train Loss: 0.733 Vali Loss: 1.432 Vali Acc: 0.489 Test Loss: 1.432 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 2.3413476943969727
Epoch: 11, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.397 Vali Acc: 0.511 Test Loss: 1.397 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.7859950065612793
Epoch: 12, Steps: 8 | Train Loss: 0.561 Vali Loss: 1.390 Vali Acc: 0.511 Test Loss: 1.390 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 1.7084336280822754
Epoch: 13, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.861288070678711
Epoch: 14, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.303 Vali Acc: 0.542 Test Loss: 1.303 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541972).  Saving model ...
Epoch: 15 cost time: 1.9731032848358154
Epoch: 15, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.301 Vali Acc: 0.542 Test Loss: 1.301 Test Acc: 0.542
Validation loss decreased (-0.541972 --> -0.541972).  Saving model ...
Epoch: 16 cost time: 2.3589162826538086
Epoch: 16, Steps: 8 | Train Loss: 0.308 Vali Loss: 1.290 Vali Acc: 0.565 Test Loss: 1.290 Test Acc: 0.565
Validation loss decreased (-0.541972 --> -0.564873).  Saving model ...
Epoch: 17 cost time: 2.3972384929656982
Epoch: 17, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.289 Vali Acc: 0.573 Test Loss: 1.289 Test Acc: 0.573
Validation loss decreased (-0.564873 --> -0.572506).  Saving model ...
Epoch: 18 cost time: 2.315531015396118
Epoch: 18, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.302 Vali Acc: 0.550 Test Loss: 1.302 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8932290077209473
Epoch: 19, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.243 Vali Acc: 0.565 Test Loss: 1.243 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2720956802368164
Epoch: 20, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.244 Vali Acc: 0.557 Test Loss: 1.244 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6228654384613037
Epoch: 21, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.234 Vali Acc: 0.573 Test Loss: 1.234 Test Acc: 0.573
Validation loss decreased (-0.572506 --> -0.572507).  Saving model ...
Epoch: 22 cost time: 1.713866949081421
Epoch: 22, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.255 Vali Acc: 0.565 Test Loss: 1.255 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9108197689056396
Epoch: 23, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.234 Vali Acc: 0.595 Test Loss: 1.234 Test Acc: 0.595
Validation loss decreased (-0.572507 --> -0.595408).  Saving model ...
Epoch: 24 cost time: 1.6633188724517822
Epoch: 24, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.228 Vali Acc: 0.588 Test Loss: 1.228 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.074738025665283
Epoch: 25, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.243 Vali Acc: 0.573 Test Loss: 1.243 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0599589347839355
Epoch: 26, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.310 Vali Acc: 0.588 Test Loss: 1.310 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9508016109466553
Epoch: 27, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.308 Vali Acc: 0.580 Test Loss: 1.308 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9094195365905762
Epoch: 28, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.303 Vali Acc: 0.573 Test Loss: 1.303 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8645257949829102
Epoch: 29, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.253 Vali Acc: 0.595 Test Loss: 1.253 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.447946310043335
Epoch: 30, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.237 Vali Acc: 0.588 Test Loss: 1.237 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.424301862716675
Epoch: 31, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.256 Vali Acc: 0.595 Test Loss: 1.256 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.356267213821411
Epoch: 32, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.261 Vali Acc: 0.580 Test Loss: 1.261 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.1589457988739014
Epoch: 33, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.268 Vali Acc: 0.611 Test Loss: 1.268 Test Acc: 0.611
Validation loss decreased (-0.595408 --> -0.610674).  Saving model ...
Epoch: 34 cost time: 2.0237090587615967
Epoch: 34, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.285 Vali Acc: 0.611 Test Loss: 1.285 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9262263774871826
Epoch: 35, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.293 Vali Acc: 0.611 Test Loss: 1.293 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.164186477661133
Epoch: 36, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.304 Vali Acc: 0.588 Test Loss: 1.304 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.028374671936035
Epoch: 37, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.366 Vali Acc: 0.603 Test Loss: 1.366 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8470849990844727
Epoch: 38, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.329 Vali Acc: 0.588 Test Loss: 1.329 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.136147975921631
Epoch: 39, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.339 Vali Acc: 0.595 Test Loss: 1.339 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.9754841327667236
Epoch: 40, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.388 Vali Acc: 0.580 Test Loss: 1.388 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.973632574081421
Epoch: 41, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.433 Vali Acc: 0.603 Test Loss: 1.433 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.9599275588989258
Epoch: 42, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.448 Vali Acc: 0.603 Test Loss: 1.448 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.0689966678619385
Epoch: 43, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.447 Vali Acc: 0.588 Test Loss: 1.447 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 373125
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.623501300811768
Epoch: 1, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.614 Vali Acc: 0.168 Test Loss: 1.614 Test Acc: 0.168
Validation loss decreased (inf --> -0.167923).  Saving model ...
Epoch: 2 cost time: 1.9775502681732178
Epoch: 2, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.594 Vali Acc: 0.275 Test Loss: 1.594 Test Acc: 0.275
Validation loss decreased (-0.167923 --> -0.274793).  Saving model ...
Epoch: 3 cost time: 1.757415771484375
Epoch: 3, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.573 Vali Acc: 0.405 Test Loss: 1.573 Test Acc: 0.405
Validation loss decreased (-0.274793 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 2.0532302856445312
Epoch: 4, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.558 Vali Acc: 0.412 Test Loss: 1.558 Test Acc: 0.412
Validation loss decreased (-0.404564 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 1.6476058959960938
Epoch: 5, Steps: 8 | Train Loss: 1.290 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4498980045318604
Epoch: 6, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.7296204566955566
Epoch: 7, Steps: 8 | Train Loss: 1.087 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.8035058975219727
Epoch: 8, Steps: 8 | Train Loss: 1.002 Vali Loss: 1.491 Vali Acc: 0.435 Test Loss: 1.491 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 9 cost time: 2.3668785095214844
Epoch: 9, Steps: 8 | Train Loss: 0.936 Vali Loss: 1.492 Vali Acc: 0.427 Test Loss: 1.492 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6194491386413574
Epoch: 10, Steps: 8 | Train Loss: 0.816 Vali Loss: 1.465 Vali Acc: 0.450 Test Loss: 1.465 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 2.162045478820801
Epoch: 11, Steps: 8 | Train Loss: 0.768 Vali Loss: 1.447 Vali Acc: 0.458 Test Loss: 1.447 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 12 cost time: 1.8902175426483154
Epoch: 12, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.431 Vali Acc: 0.466 Test Loss: 1.431 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465635).  Saving model ...
Epoch: 13 cost time: 1.9188258647918701
Epoch: 13, Steps: 8 | Train Loss: 0.601 Vali Loss: 1.441 Vali Acc: 0.458 Test Loss: 1.441 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7133164405822754
Epoch: 14, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.415 Vali Acc: 0.504 Test Loss: 1.415 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503803).  Saving model ...
Epoch: 15 cost time: 2.3844361305236816
Epoch: 15, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.395 Vali Acc: 0.489 Test Loss: 1.395 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8718621730804443
Epoch: 16, Steps: 8 | Train Loss: 0.402 Vali Loss: 1.383 Vali Acc: 0.527 Test Loss: 1.383 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 17 cost time: 1.8445465564727783
Epoch: 17, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.347 Vali Acc: 0.542 Test Loss: 1.347 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 18 cost time: 2.1196439266204834
Epoch: 18, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.337 Vali Acc: 0.527 Test Loss: 1.337 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0359461307525635
Epoch: 19, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.379 Vali Acc: 0.511 Test Loss: 1.379 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4129185676574707
Epoch: 20, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.381 Vali Acc: 0.534 Test Loss: 1.381 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8003525733947754
Epoch: 21, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.369 Vali Acc: 0.550 Test Loss: 1.369 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549605).  Saving model ...
Epoch: 22 cost time: 1.7994215488433838
Epoch: 22, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.339 Vali Acc: 0.557 Test Loss: 1.339 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 23 cost time: 1.3917627334594727
Epoch: 23, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.304 Vali Acc: 0.557 Test Loss: 1.304 Test Acc: 0.557
Validation loss decreased (-0.557239 --> -0.557239).  Saving model ...
Epoch: 24 cost time: 1.8381595611572266
Epoch: 24, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.338 Vali Acc: 0.519 Test Loss: 1.338 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8079476356506348
Epoch: 25, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.417 Vali Acc: 0.519 Test Loss: 1.417 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.549884557723999
Epoch: 26, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.396 Vali Acc: 0.542 Test Loss: 1.396 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5728271007537842
Epoch: 27, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.446 Vali Acc: 0.534 Test Loss: 1.446 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8974826335906982
Epoch: 28, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5909619331359863
Epoch: 29, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.337 Vali Acc: 0.534 Test Loss: 1.337 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.741741418838501
Epoch: 30, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.356 Vali Acc: 0.550 Test Loss: 1.356 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5254278182983398
Epoch: 31, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.336 Vali Acc: 0.550 Test Loss: 1.336 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.044949769973755
Epoch: 32, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.401 Vali Acc: 0.527 Test Loss: 1.401 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.70997953414917
Epoch: 33, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 396133
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.423034191131592
Epoch: 1, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.595 Vali Acc: 0.305 Test Loss: 1.595 Test Acc: 0.305
Validation loss decreased (inf --> -0.305328).  Saving model ...
Epoch: 2 cost time: 1.7094478607177734
Epoch: 2, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.577 Vali Acc: 0.427 Test Loss: 1.577 Test Acc: 0.427
Validation loss decreased (-0.305328 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.5784387588500977
Epoch: 3, Steps: 8 | Train Loss: 1.419 Vali Loss: 1.546 Vali Acc: 0.473 Test Loss: 1.546 Test Acc: 0.473
Validation loss decreased (-0.427465 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.3941090106964111
Epoch: 4, Steps: 8 | Train Loss: 1.316 Vali Loss: 1.528 Vali Acc: 0.481 Test Loss: 1.528 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.5700054168701172
Epoch: 5, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.543 Vali Acc: 0.496 Test Loss: 1.543 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 6 cost time: 1.592236042022705
Epoch: 6, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.489 Vali Acc: 0.466 Test Loss: 1.489 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.375847101211548
Epoch: 7, Steps: 8 | Train Loss: 1.017 Vali Loss: 1.463 Vali Acc: 0.481 Test Loss: 1.463 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7009198665618896
Epoch: 8, Steps: 8 | Train Loss: 0.909 Vali Loss: 1.478 Vali Acc: 0.489 Test Loss: 1.478 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7577400207519531
Epoch: 9, Steps: 8 | Train Loss: 0.837 Vali Loss: 1.487 Vali Acc: 0.489 Test Loss: 1.487 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7494561672210693
Epoch: 10, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.436 Vali Acc: 0.504 Test Loss: 1.436 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.5784013271331787
Epoch: 11, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 12 cost time: 1.5895366668701172
Epoch: 12, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.449 Vali Acc: 0.534 Test Loss: 1.449 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.952690601348877
Epoch: 13, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.420 Vali Acc: 0.565 Test Loss: 1.420 Test Acc: 0.565
Validation loss decreased (-0.534337 --> -0.564871).  Saving model ...
Epoch: 14 cost time: 1.6553661823272705
Epoch: 14, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.413 Vali Acc: 0.557 Test Loss: 1.413 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.789668083190918
Epoch: 15, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.403 Vali Acc: 0.534 Test Loss: 1.403 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5401103496551514
Epoch: 16, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.389 Vali Acc: 0.565 Test Loss: 1.389 Test Acc: 0.565
Validation loss decreased (-0.564871 --> -0.564872).  Saving model ...
Epoch: 17 cost time: 1.551382303237915
Epoch: 17, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.433 Vali Acc: 0.573 Test Loss: 1.433 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
Epoch: 18 cost time: 1.7797400951385498
Epoch: 18, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.488 Vali Acc: 0.565 Test Loss: 1.488 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.974395990371704
Epoch: 19, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.435 Vali Acc: 0.557 Test Loss: 1.435 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9462802410125732
Epoch: 20, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.428 Vali Acc: 0.573 Test Loss: 1.428 Test Acc: 0.573
Validation loss decreased (-0.572505 --> -0.572505).  Saving model ...
Epoch: 21 cost time: 1.6076443195343018
Epoch: 21, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.438 Vali Acc: 0.588 Test Loss: 1.438 Test Acc: 0.588
Validation loss decreased (-0.572505 --> -0.587772).  Saving model ...
Epoch: 22 cost time: 2.205991744995117
Epoch: 22, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.448 Vali Acc: 0.573 Test Loss: 1.448 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.55708646774292
Epoch: 23, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.479 Vali Acc: 0.580 Test Loss: 1.479 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5255954265594482
Epoch: 24, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.547 Vali Acc: 0.573 Test Loss: 1.547 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.924191951751709
Epoch: 25, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.483 Vali Acc: 0.573 Test Loss: 1.483 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8403081893920898
Epoch: 26, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.479 Vali Acc: 0.595 Test Loss: 1.479 Test Acc: 0.595
Validation loss decreased (-0.587772 --> -0.595405).  Saving model ...
Epoch: 27 cost time: 1.4664695262908936
Epoch: 27, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.463 Vali Acc: 0.595 Test Loss: 1.463 Test Acc: 0.595
Validation loss decreased (-0.595405 --> -0.595405).  Saving model ...
Epoch: 28 cost time: 1.8249459266662598
Epoch: 28, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.631 Vali Acc: 0.588 Test Loss: 1.631 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7644329071044922
Epoch: 29, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.545 Vali Acc: 0.588 Test Loss: 1.545 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8920152187347412
Epoch: 30, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.500 Vali Acc: 0.611 Test Loss: 1.500 Test Acc: 0.611
Validation loss decreased (-0.595405 --> -0.610672).  Saving model ...
Epoch: 31 cost time: 2.0347232818603516
Epoch: 31, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.437 Vali Acc: 0.603 Test Loss: 1.437 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9263980388641357
Epoch: 32, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.468 Vali Acc: 0.580 Test Loss: 1.468 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1846261024475098
Epoch: 33, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.459 Vali Acc: 0.573 Test Loss: 1.459 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0911049842834473
Epoch: 34, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.436 Vali Acc: 0.588 Test Loss: 1.436 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.131869316101074
Epoch: 35, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.482 Vali Acc: 0.580 Test Loss: 1.482 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.011667013168335
Epoch: 36, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.606 Vali Acc: 0.580 Test Loss: 1.606 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6707537174224854
Epoch: 37, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.551 Vali Acc: 0.588 Test Loss: 1.551 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7560126781463623
Epoch: 38, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.520 Vali Acc: 0.603 Test Loss: 1.520 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.422679901123047
Epoch: 39, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.579 Vali Acc: 0.603 Test Loss: 1.579 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.0432403087615967
Epoch: 40, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.557 Vali Acc: 0.588 Test Loss: 1.557 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 421061
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9169461727142334
Epoch: 1, Steps: 8 | Train Loss: 1.624 Vali Loss: 1.599 Vali Acc: 0.267 Test Loss: 1.599 Test Acc: 0.267
Validation loss decreased (inf --> -0.267160).  Saving model ...
Epoch: 2 cost time: 1.823516607284546
Epoch: 2, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.593 Vali Acc: 0.374 Test Loss: 1.593 Test Acc: 0.374
Validation loss decreased (-0.267160 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.9027979373931885
Epoch: 3, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.582 Vali Acc: 0.420 Test Loss: 1.582 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.8557257652282715
Epoch: 4, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7312912940979004
Epoch: 5, Steps: 8 | Train Loss: 1.258 Vali Loss: 1.559 Vali Acc: 0.420 Test Loss: 1.559 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4905831813812256
Epoch: 6, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.546 Vali Acc: 0.427 Test Loss: 1.546 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 7 cost time: 1.6358826160430908
Epoch: 7, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0708727836608887
Epoch: 8, Steps: 8 | Train Loss: 0.965 Vali Loss: 1.526 Vali Acc: 0.427 Test Loss: 1.526 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.6820831298828125
Epoch: 9, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.526 Vali Acc: 0.435 Test Loss: 1.526 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 10 cost time: 1.8333301544189453
Epoch: 10, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.541 Vali Acc: 0.427 Test Loss: 1.541 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6441891193389893
Epoch: 11, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.532 Vali Acc: 0.435 Test Loss: 1.532 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7206294536590576
Epoch: 12, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.510 Vali Acc: 0.435 Test Loss: 1.510 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 13 cost time: 1.931180477142334
Epoch: 13, Steps: 8 | Train Loss: 0.646 Vali Loss: 1.517 Vali Acc: 0.443 Test Loss: 1.517 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 14 cost time: 1.635359525680542
Epoch: 14, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.516 Vali Acc: 0.450 Test Loss: 1.516 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 15 cost time: 1.8556859493255615
Epoch: 15, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.507 Vali Acc: 0.481 Test Loss: 1.507 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 16 cost time: 2.5066914558410645
Epoch: 16, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.501 Vali Acc: 0.473 Test Loss: 1.501 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.191559076309204
Epoch: 17, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.515 Vali Acc: 0.481 Test Loss: 1.515 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1259665489196777
Epoch: 18, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.532 Vali Acc: 0.473 Test Loss: 1.532 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4854228496551514
Epoch: 19, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8660931587219238
Epoch: 20, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.539 Vali Acc: 0.458 Test Loss: 1.539 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.083454132080078
Epoch: 21, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.524 Vali Acc: 0.473 Test Loss: 1.524 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2460854053497314
Epoch: 22, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.528 Vali Acc: 0.458 Test Loss: 1.528 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.431140899658203
Epoch: 23, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.540 Vali Acc: 0.466 Test Loss: 1.540 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.09521484375
Epoch: 24, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.559 Vali Acc: 0.481 Test Loss: 1.559 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.56211519241333
Epoch: 25, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.552 Vali Acc: 0.473 Test Loss: 1.552 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 447909
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.515855550765991
Epoch: 1, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6002607345581055
Epoch: 2, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5794970989227295
Epoch: 3, Steps: 8 | Train Loss: 0.874 Vali Loss: 1.432 Vali Acc: 0.458 Test Loss: 1.432 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.8184528350830078
Epoch: 4, Steps: 8 | Train Loss: 0.527 Vali Loss: 1.409 Vali Acc: 0.489 Test Loss: 1.409 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.85341477394104
Epoch: 5, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.395 Vali Acc: 0.511 Test Loss: 1.395 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.9268436431884766
Epoch: 6, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.358 Vali Acc: 0.534 Test Loss: 1.358 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534338).  Saving model ...
Epoch: 7 cost time: 1.7798199653625488
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.786426067352295
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.631 Vali Acc: 0.519 Test Loss: 1.631 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.313904285430908
Epoch: 9, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.488 Vali Acc: 0.542 Test Loss: 1.488 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541970).  Saving model ...
Epoch: 10 cost time: 1.8583858013153076
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.647 Vali Acc: 0.550 Test Loss: 1.647 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549602).  Saving model ...
Epoch: 11 cost time: 1.9346492290496826
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.664 Vali Acc: 0.573 Test Loss: 1.664 Test Acc: 0.573
Validation loss decreased (-0.549602 --> -0.572502).  Saving model ...
Epoch: 12 cost time: 1.990539789199829
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.777 Vali Acc: 0.519 Test Loss: 1.777 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8073663711547852
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.118 Vali Acc: 0.527 Test Loss: 2.118 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7263202667236328
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.343 Vali Acc: 0.527 Test Loss: 2.343 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9345521926879883
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.372 Vali Acc: 0.527 Test Loss: 2.372 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.680929183959961
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.343 Vali Acc: 0.527 Test Loss: 2.343 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0020759105682373
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.438 Vali Acc: 0.527 Test Loss: 2.438 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6021196842193604
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.554 Vali Acc: 0.527 Test Loss: 2.554 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.66756272315979
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.578 Vali Acc: 0.527 Test Loss: 2.578 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.768237590789795
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.575 Vali Acc: 0.527 Test Loss: 2.575 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8950121402740479
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.527 Test Loss: 2.593 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 4539269
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.001653671264648
Epoch: 1, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.577 Vali Acc: 0.405 Test Loss: 1.577 Test Acc: 0.405
Validation loss decreased (inf --> -0.404564).  Saving model ...
Epoch: 2 cost time: 2.188932418823242
Epoch: 2, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6193602085113525
Epoch: 3, Steps: 8 | Train Loss: 1.127 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7476389408111572
Epoch: 4, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.418 Vali Acc: 0.504 Test Loss: 1.418 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.6498298645019531
Epoch: 5, Steps: 8 | Train Loss: 0.561 Vali Loss: 1.406 Vali Acc: 0.489 Test Loss: 1.406 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.928957462310791
Epoch: 6, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.310 Vali Acc: 0.527 Test Loss: 1.310 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 7 cost time: 1.6631722450256348
Epoch: 7, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.350 Vali Acc: 0.534 Test Loss: 1.350 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 8 cost time: 2.0358362197875977
Epoch: 8, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.387 Vali Acc: 0.534 Test Loss: 1.387 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.129042387008667
Epoch: 9, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.353 Vali Acc: 0.542 Test Loss: 1.353 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 10 cost time: 1.7745954990386963
Epoch: 10, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.437 Vali Acc: 0.534 Test Loss: 1.437 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9013972282409668
Epoch: 11, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.592 Vali Acc: 0.534 Test Loss: 1.592 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7156312465667725
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.498 Vali Acc: 0.534 Test Loss: 1.498 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8115754127502441
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.502 Vali Acc: 0.542 Test Loss: 1.502 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2669014930725098
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.503 Vali Acc: 0.542 Test Loss: 1.503 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9094626903533936
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.519 Vali Acc: 0.550 Test Loss: 1.519 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549603).  Saving model ...
Epoch: 16 cost time: 2.266698122024536
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.490 Vali Acc: 0.550 Test Loss: 1.490 Test Acc: 0.550
Validation loss decreased (-0.549603 --> -0.549603).  Saving model ...
Epoch: 17 cost time: 2.1028454303741455
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.561 Vali Acc: 0.534 Test Loss: 1.561 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8365974426269531
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.709 Vali Acc: 0.527 Test Loss: 1.709 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9672493934631348
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.862 Vali Acc: 0.527 Test Loss: 1.862 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7370326519012451
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.503 Vali Acc: 0.557 Test Loss: 1.503 Test Acc: 0.557
Validation loss decreased (-0.549603 --> -0.557237).  Saving model ...
Epoch: 21 cost time: 2.1519079208374023
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.772 Vali Acc: 0.542 Test Loss: 1.772 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.243278980255127
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.217 Vali Acc: 0.534 Test Loss: 2.217 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9611589908599854
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.034 Vali Acc: 0.542 Test Loss: 2.034 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9728310108184814
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.827 Vali Acc: 0.557 Test Loss: 1.827 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2419919967651367
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.875 Vali Acc: 0.573 Test Loss: 1.875 Test Acc: 0.573
Validation loss decreased (-0.557237 --> -0.572500).  Saving model ...
Epoch: 26 cost time: 2.266801357269287
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.038 Vali Acc: 0.565 Test Loss: 2.038 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.682523250579834
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.959 Vali Acc: 0.557 Test Loss: 1.959 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.850182294845581
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.934 Vali Acc: 0.550 Test Loss: 1.934 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.841090440750122
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.849 Vali Acc: 0.534 Test Loss: 1.849 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7632977962493896
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.847 Vali Acc: 0.550 Test Loss: 1.847 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2537357807159424
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.984 Vali Acc: 0.588 Test Loss: 1.984 Test Acc: 0.588
Validation loss decreased (-0.572500 --> -0.587766).  Saving model ...
Epoch: 32 cost time: 1.8696715831756592
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.086 Vali Acc: 0.557 Test Loss: 2.086 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9813497066497803
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.318 Vali Acc: 0.542 Test Loss: 2.318 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8072528839111328
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.495 Vali Acc: 0.542 Test Loss: 2.495 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7288274765014648
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.636 Vali Acc: 0.542 Test Loss: 2.636 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6441271305084229
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.712 Vali Acc: 0.534 Test Loss: 2.712 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9007644653320312
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.549 Vali Acc: 0.557 Test Loss: 2.549 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.064629316329956
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.321 Vali Acc: 0.557 Test Loss: 2.321 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6795897483825684
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.360 Vali Acc: 0.565 Test Loss: 2.360 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.129542827606201
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.427 Vali Acc: 0.550 Test Loss: 2.427 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.378901958465576
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.609 Vali Acc: 0.550 Test Loss: 2.609 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 4443269
model size : 17.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.3625311851501465
Epoch: 1, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.585 Vali Acc: 0.344 Test Loss: 1.585 Test Acc: 0.344
Validation loss decreased (inf --> -0.343496).  Saving model ...
Epoch: 2 cost time: 1.8027913570404053
Epoch: 2, Steps: 8 | Train Loss: 1.443 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.343496 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7226591110229492
Epoch: 3, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.4091615676879883
Epoch: 4, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.493 Vali Acc: 0.420 Test Loss: 1.493 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.046868085861206
Epoch: 5, Steps: 8 | Train Loss: 0.705 Vali Loss: 1.436 Vali Acc: 0.458 Test Loss: 1.436 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.3265433311462402
Epoch: 6, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.431 Vali Acc: 0.489 Test Loss: 1.431 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.5181300640106201
Epoch: 7, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.433 Vali Acc: 0.519 Test Loss: 1.433 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.3938448429107666
Epoch: 8, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.414 Vali Acc: 0.527 Test Loss: 1.414 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 1.4325785636901855
Epoch: 9, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.390 Vali Acc: 0.527 Test Loss: 1.390 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.6847474575042725
Epoch: 10, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.417 Vali Acc: 0.527 Test Loss: 1.417 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7682132720947266
Epoch: 11, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.359 Vali Acc: 0.542 Test Loss: 1.359 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 12 cost time: 1.6109545230865479
Epoch: 12, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.418 Vali Acc: 0.534 Test Loss: 1.418 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.709937572479248
Epoch: 13, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.452 Vali Acc: 0.534 Test Loss: 1.452 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8674485683441162
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.455 Vali Acc: 0.534 Test Loss: 1.455 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8834562301635742
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.412 Vali Acc: 0.534 Test Loss: 1.412 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0791962146759033
Epoch: 16, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.531 Vali Acc: 0.557 Test Loss: 1.531 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557237).  Saving model ...
Epoch: 17 cost time: 1.9731559753417969
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.482 Vali Acc: 0.550 Test Loss: 1.482 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7130053043365479
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.429 Vali Acc: 0.580 Test Loss: 1.429 Test Acc: 0.580
Validation loss decreased (-0.557237 --> -0.580138).  Saving model ...
Epoch: 19 cost time: 1.6736552715301514
Epoch: 19, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.485 Vali Acc: 0.542 Test Loss: 1.485 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9980366230010986
Epoch: 20, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.601 Vali Acc: 0.534 Test Loss: 1.601 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9155397415161133
Epoch: 21, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.669 Vali Acc: 0.550 Test Loss: 1.669 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5952303409576416
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.465 Vali Acc: 0.565 Test Loss: 1.465 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9095091819763184
Epoch: 23, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.462 Vali Acc: 0.580 Test Loss: 1.462 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4941520690917969
Epoch: 24, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.639 Vali Acc: 0.580 Test Loss: 1.639 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6464295387268066
Epoch: 25, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.874 Vali Acc: 0.550 Test Loss: 1.874 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5541961193084717
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.902 Vali Acc: 0.542 Test Loss: 1.902 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6650903224945068
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.986 Vali Acc: 0.534 Test Loss: 1.986 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7589430809020996
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.209 Vali Acc: 0.542 Test Loss: 2.209 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 4446981
model size : 17.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.162915945053101
Epoch: 1, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.620 Vali Acc: 0.229 Test Loss: 1.620 Test Acc: 0.229
Validation loss decreased (inf --> -0.228991).  Saving model ...
Epoch: 2 cost time: 1.568279504776001
Epoch: 2, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.568 Vali Acc: 0.420 Test Loss: 1.568 Test Acc: 0.420
Validation loss decreased (-0.228991 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6413817405700684
Epoch: 3, Steps: 8 | Train Loss: 1.207 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7357189655303955
Epoch: 4, Steps: 8 | Train Loss: 0.985 Vali Loss: 1.482 Vali Acc: 0.443 Test Loss: 1.482 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.4216396808624268
Epoch: 5, Steps: 8 | Train Loss: 0.750 Vali Loss: 1.423 Vali Acc: 0.481 Test Loss: 1.423 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.7075188159942627
Epoch: 6, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.347 Vali Acc: 0.504 Test Loss: 1.347 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.6749675273895264
Epoch: 7, Steps: 8 | Train Loss: 0.376 Vali Loss: 1.326 Vali Acc: 0.534 Test Loss: 1.326 Test Acc: 0.534
Validation loss decreased (-0.503803 --> -0.534338).  Saving model ...
Epoch: 8 cost time: 1.7031502723693848
Epoch: 8, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.292 Vali Acc: 0.534 Test Loss: 1.292 Test Acc: 0.534
Validation loss decreased (-0.534338 --> -0.534338).  Saving model ...
Epoch: 9 cost time: 1.7479450702667236
Epoch: 9, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.288 Vali Acc: 0.542 Test Loss: 1.288 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 10 cost time: 1.6607732772827148
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.311 Vali Acc: 0.542 Test Loss: 1.311 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8147180080413818
Epoch: 11, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.330 Vali Acc: 0.542 Test Loss: 1.330 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6520416736602783
Epoch: 12, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.312 Vali Acc: 0.573 Test Loss: 1.312 Test Acc: 0.573
Validation loss decreased (-0.541972 --> -0.572506).  Saving model ...
Epoch: 13 cost time: 1.724973440170288
Epoch: 13, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.274 Vali Acc: 0.580 Test Loss: 1.274 Test Acc: 0.580
Validation loss decreased (-0.572506 --> -0.580140).  Saving model ...
Epoch: 14 cost time: 1.5082306861877441
Epoch: 14, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.295 Vali Acc: 0.580 Test Loss: 1.295 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9720158576965332
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.356 Vali Acc: 0.542 Test Loss: 1.356 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1263604164123535
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.343 Vali Acc: 0.580 Test Loss: 1.343 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9506633281707764
Epoch: 17, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.515 Vali Acc: 0.557 Test Loss: 1.515 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7982916831970215
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.507 Vali Acc: 0.565 Test Loss: 1.507 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8847148418426514
Epoch: 19, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.475 Vali Acc: 0.557 Test Loss: 1.475 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.030944585800171
Epoch: 20, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.492 Vali Acc: 0.565 Test Loss: 1.492 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1370697021484375
Epoch: 21, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.441 Vali Acc: 0.580 Test Loss: 1.441 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7583723068237305
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.480 Vali Acc: 0.565 Test Loss: 1.480 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9747929573059082
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.771 Vali Acc: 0.550 Test Loss: 1.771 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 4481541
model size : 17.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.548932313919067
Epoch: 1, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.580 Vali Acc: 0.427 Test Loss: 1.580 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.7585699558258057
Epoch: 2, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7941725254058838
Epoch: 3, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7696592807769775
Epoch: 4, Steps: 8 | Train Loss: 1.032 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.592407464981079
Epoch: 5, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.488 Vali Acc: 0.427 Test Loss: 1.488 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.4891703128814697
Epoch: 6, Steps: 8 | Train Loss: 0.668 Vali Loss: 1.454 Vali Acc: 0.458 Test Loss: 1.454 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458001).  Saving model ...
Epoch: 7 cost time: 1.5372309684753418
Epoch: 7, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.456 Vali Acc: 0.481 Test Loss: 1.456 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.427668571472168
Epoch: 8, Steps: 8 | Train Loss: 0.418 Vali Loss: 1.424 Vali Acc: 0.504 Test Loss: 1.424 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 1.8778557777404785
Epoch: 9, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.417 Vali Acc: 0.504 Test Loss: 1.417 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.6999638080596924
Epoch: 10, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.416 Vali Acc: 0.511 Test Loss: 1.416 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 11 cost time: 1.816890001296997
Epoch: 11, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.413 Vali Acc: 0.511 Test Loss: 1.413 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.8709287643432617
Epoch: 12, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.451 Vali Acc: 0.519 Test Loss: 1.451 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 13 cost time: 1.9146695137023926
Epoch: 13, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.822960615158081
Epoch: 14, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.428 Vali Acc: 0.527 Test Loss: 1.428 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.8162486553192139
Epoch: 15, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.450 Vali Acc: 0.527 Test Loss: 1.450 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.756178855895996
Epoch: 16, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.475 Vali Acc: 0.504 Test Loss: 1.475 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9468588829040527
Epoch: 17, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.802701711654663
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.497 Vali Acc: 0.489 Test Loss: 1.497 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5038840770721436
Epoch: 19, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.470 Vali Acc: 0.511 Test Loss: 1.470 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7631752490997314
Epoch: 20, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7676401138305664
Epoch: 21, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.410 Vali Acc: 0.511 Test Loss: 1.410 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5361597537994385
Epoch: 22, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.390 Vali Acc: 0.534 Test Loss: 1.390 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 23 cost time: 1.716439962387085
Epoch: 23, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.503 Vali Acc: 0.481 Test Loss: 1.503 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.836545705795288
Epoch: 24, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.498 Vali Acc: 0.496 Test Loss: 1.498 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4766206741333008
Epoch: 25, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.391 Vali Acc: 0.534 Test Loss: 1.391 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1832287311553955
Epoch: 26, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.463 Vali Acc: 0.504 Test Loss: 1.463 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9928407669067383
Epoch: 27, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.512 Vali Acc: 0.489 Test Loss: 1.512 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6360371112823486
Epoch: 28, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.499 Vali Acc: 0.504 Test Loss: 1.499 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.877441644668579
Epoch: 29, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.476 Vali Acc: 0.511 Test Loss: 1.476 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9480650424957275
Epoch: 30, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.481 Vali Acc: 0.511 Test Loss: 1.481 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.975661039352417
Epoch: 31, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.589 Vali Acc: 0.519 Test Loss: 1.589 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7381200790405273
Epoch: 32, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.730 Vali Acc: 0.489 Test Loss: 1.730 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 4573573
model size : 17.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.541027784347534
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.578 Vali Acc: 0.374 Test Loss: 1.578 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.7385625839233398
Epoch: 2, Steps: 8 | Train Loss: 1.480 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.168358325958252
Epoch: 3, Steps: 8 | Train Loss: 1.231 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.1684861183166504
Epoch: 4, Steps: 8 | Train Loss: 0.998 Vali Loss: 1.504 Vali Acc: 0.427 Test Loss: 1.504 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.6160979270935059
Epoch: 5, Steps: 8 | Train Loss: 0.775 Vali Loss: 1.456 Vali Acc: 0.496 Test Loss: 1.456 Test Acc: 0.496
Validation loss decreased (-0.427466 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.831895112991333
Epoch: 6, Steps: 8 | Train Loss: 0.584 Vali Loss: 1.398 Vali Acc: 0.511 Test Loss: 1.398 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 2.108991861343384
Epoch: 7, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.345 Vali Acc: 0.519 Test Loss: 1.345 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519071).  Saving model ...
Epoch: 8 cost time: 1.7496516704559326
Epoch: 8, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 9 cost time: 1.8834123611450195
Epoch: 9, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.318 Vali Acc: 0.519 Test Loss: 1.318 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.598038911819458
Epoch: 10, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.319 Vali Acc: 0.527 Test Loss: 1.319 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.797858715057373
Epoch: 11, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5786707401275635
Epoch: 12, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.407 Vali Acc: 0.519 Test Loss: 1.407 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9248628616333008
Epoch: 13, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.373 Vali Acc: 0.550 Test Loss: 1.373 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549605).  Saving model ...
Epoch: 14 cost time: 1.9100792407989502
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.338 Vali Acc: 0.542 Test Loss: 1.338 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9050769805908203
Epoch: 15, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.307 Vali Acc: 0.550 Test Loss: 1.307 Test Acc: 0.550
Validation loss decreased (-0.549605 --> -0.549605).  Saving model ...
Epoch: 16 cost time: 1.6061642169952393
Epoch: 16, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8715784549713135
Epoch: 17, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.361 Vali Acc: 0.542 Test Loss: 1.361 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.926584005355835
Epoch: 18, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.341 Vali Acc: 0.542 Test Loss: 1.341 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.666013240814209
Epoch: 19, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.354 Vali Acc: 0.542 Test Loss: 1.354 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7925355434417725
Epoch: 20, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.355 Vali Acc: 0.542 Test Loss: 1.355 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7101216316223145
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.394 Vali Acc: 0.550 Test Loss: 1.394 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4332597255706787
Epoch: 22, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.410 Vali Acc: 0.580 Test Loss: 1.410 Test Acc: 0.580
Validation loss decreased (-0.549605 --> -0.580139).  Saving model ...
Epoch: 23 cost time: 1.630746841430664
Epoch: 23, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.403 Vali Acc: 0.550 Test Loss: 1.403 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9316632747650146
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.380 Vali Acc: 0.542 Test Loss: 1.380 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.840959072113037
Epoch: 25, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.388 Vali Acc: 0.534 Test Loss: 1.388 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2683348655700684
Epoch: 26, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.357 Vali Acc: 0.542 Test Loss: 1.357 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.213909864425659
Epoch: 27, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.361 Vali Acc: 0.550 Test Loss: 1.361 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9686863422393799
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.395 Vali Acc: 0.534 Test Loss: 1.395 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.2083349227905273
Epoch: 29, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.275 Vali Acc: 0.565 Test Loss: 1.275 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6855497360229492
Epoch: 30, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.357 Vali Acc: 0.565 Test Loss: 1.357 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2657506465911865
Epoch: 31, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.497 Vali Acc: 0.550 Test Loss: 1.497 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8125016689300537
Epoch: 32, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.432 Vali Acc: 0.557 Test Loss: 1.432 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 4673285
model size : 17.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.406994819641113
Epoch: 1, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.617 Vali Acc: 0.206 Test Loss: 1.617 Test Acc: 0.206
Validation loss decreased (inf --> -0.206091).  Saving model ...
Epoch: 2 cost time: 1.8602490425109863
Epoch: 2, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.590 Vali Acc: 0.443 Test Loss: 1.590 Test Acc: 0.443
Validation loss decreased (-0.206091 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.754129409790039
Epoch: 3, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.558 Vali Acc: 0.435 Test Loss: 1.558 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5457842350006104
Epoch: 4, Steps: 8 | Train Loss: 1.001 Vali Loss: 1.536 Vali Acc: 0.435 Test Loss: 1.536 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8247249126434326
Epoch: 5, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.511 Vali Acc: 0.443 Test Loss: 1.511 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.6927192211151123
Epoch: 6, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.496 Vali Acc: 0.458 Test Loss: 1.496 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.7432942390441895
Epoch: 7, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.477 Vali Acc: 0.473 Test Loss: 1.477 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.833735704421997
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.459 Vali Acc: 0.481 Test Loss: 1.459 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.7675251960754395
Epoch: 9, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.465 Vali Acc: 0.489 Test Loss: 1.465 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.6676464080810547
Epoch: 10, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.453 Vali Acc: 0.481 Test Loss: 1.453 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.614032506942749
Epoch: 11, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.452 Vali Acc: 0.481 Test Loss: 1.452 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5879971981048584
Epoch: 12, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.702326774597168
Epoch: 13, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.450 Vali Acc: 0.466 Test Loss: 1.450 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.52421236038208
Epoch: 14, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.453 Vali Acc: 0.466 Test Loss: 1.453 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7269935607910156
Epoch: 15, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.430 Vali Acc: 0.511 Test Loss: 1.430 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 16 cost time: 1.4621851444244385
Epoch: 16, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.454 Vali Acc: 0.473 Test Loss: 1.454 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4927711486816406
Epoch: 17, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.476 Vali Acc: 0.466 Test Loss: 1.476 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5395042896270752
Epoch: 18, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.476 Vali Acc: 0.466 Test Loss: 1.476 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5224101543426514
Epoch: 19, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.467 Vali Acc: 0.473 Test Loss: 1.467 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3706786632537842
Epoch: 20, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.456 Vali Acc: 0.473 Test Loss: 1.456 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6135931015014648
Epoch: 21, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.471 Vali Acc: 0.481 Test Loss: 1.471 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4836528301239014
Epoch: 22, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.483 Vali Acc: 0.489 Test Loss: 1.483 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.591702938079834
Epoch: 23, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.480 Vali Acc: 0.481 Test Loss: 1.480 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5403811931610107
Epoch: 24, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.430 Vali Acc: 0.504 Test Loss: 1.430 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5813770294189453
Epoch: 25, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 4780677
model size : 18.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5724661350250244
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.597 Vali Acc: 0.374 Test Loss: 1.597 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.6899454593658447
Epoch: 2, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5246717929840088
Epoch: 3, Steps: 8 | Train Loss: 1.180 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.492175817489624
Epoch: 4, Steps: 8 | Train Loss: 0.899 Vali Loss: 1.441 Vali Acc: 0.473 Test Loss: 1.441 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 1.7055082321166992
Epoch: 5, Steps: 8 | Train Loss: 0.624 Vali Loss: 1.409 Vali Acc: 0.481 Test Loss: 1.409 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.5292150974273682
Epoch: 6, Steps: 8 | Train Loss: 0.386 Vali Loss: 1.350 Vali Acc: 0.511 Test Loss: 1.350 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511437).  Saving model ...
Epoch: 7 cost time: 1.7083508968353271
Epoch: 7, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.409 Vali Acc: 0.519 Test Loss: 1.409 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.6822218894958496
Epoch: 8, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.433 Vali Acc: 0.519 Test Loss: 1.433 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4861836433410645
Epoch: 9, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.413 Vali Acc: 0.519 Test Loss: 1.413 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.58937406539917
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.774487018585205
Epoch: 11, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.487 Vali Acc: 0.519 Test Loss: 1.487 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5166540145874023
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.556 Vali Acc: 0.519 Test Loss: 1.556 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4245290756225586
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.593 Vali Acc: 0.519 Test Loss: 1.593 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3649539947509766
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.591 Vali Acc: 0.519 Test Loss: 1.591 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6406192779541016
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.830 Vali Acc: 0.519 Test Loss: 1.830 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2612309455871582
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.842 Vali Acc: 0.519 Test Loss: 1.842 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6109223365783691
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.751 Vali Acc: 0.527 Test Loss: 1.751 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.784571886062622
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.963 Vali Acc: 0.527 Test Loss: 1.963 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7324674129486084
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.227 Vali Acc: 0.511 Test Loss: 2.227 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.398233413696289
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.204 Vali Acc: 0.511 Test Loss: 2.204 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1270213
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.448112726211548
Epoch: 1, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.577 Vali Acc: 0.412 Test Loss: 1.577 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.7956249713897705
Epoch: 2, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.535 Vali Acc: 0.427 Test Loss: 1.535 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.8697304725646973
Epoch: 3, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.525 Vali Acc: 0.427 Test Loss: 1.525 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.5545806884765625
Epoch: 4, Steps: 8 | Train Loss: 1.093 Vali Loss: 1.504 Vali Acc: 0.435 Test Loss: 1.504 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.4600985050201416
Epoch: 5, Steps: 8 | Train Loss: 0.891 Vali Loss: 1.457 Vali Acc: 0.466 Test Loss: 1.457 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.6331729888916016
Epoch: 6, Steps: 8 | Train Loss: 0.709 Vali Loss: 1.402 Vali Acc: 0.481 Test Loss: 1.402 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 1.88258695602417
Epoch: 7, Steps: 8 | Train Loss: 0.501 Vali Loss: 1.358 Vali Acc: 0.519 Test Loss: 1.358 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.6744225025177002
Epoch: 8, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.336 Vali Acc: 0.527 Test Loss: 1.336 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 9 cost time: 1.4290292263031006
Epoch: 9, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.357 Vali Acc: 0.534 Test Loss: 1.357 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 10 cost time: 1.43849778175354
Epoch: 10, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.367 Vali Acc: 0.534 Test Loss: 1.367 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7216835021972656
Epoch: 11, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.394 Vali Acc: 0.534 Test Loss: 1.394 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4749228954315186
Epoch: 12, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.369 Vali Acc: 0.534 Test Loss: 1.369 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9435734748840332
Epoch: 13, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.399 Vali Acc: 0.534 Test Loss: 1.399 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8729133605957031
Epoch: 14, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.409 Vali Acc: 0.534 Test Loss: 1.409 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.993743658065796
Epoch: 15, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.379 Vali Acc: 0.542 Test Loss: 1.379 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.6581788063049316
Epoch: 16, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.430 Vali Acc: 0.534 Test Loss: 1.430 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7510831356048584
Epoch: 17, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.435 Vali Acc: 0.527 Test Loss: 1.435 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.387347936630249
Epoch: 18, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.497 Vali Acc: 0.534 Test Loss: 1.497 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7504997253417969
Epoch: 19, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.587 Vali Acc: 0.527 Test Loss: 1.587 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6874668598175049
Epoch: 20, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.665 Vali Acc: 0.534 Test Loss: 1.665 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8601837158203125
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.718 Vali Acc: 0.534 Test Loss: 1.718 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6256661415100098
Epoch: 22, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.723 Vali Acc: 0.527 Test Loss: 1.723 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6779861450195312
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.833 Vali Acc: 0.542 Test Loss: 1.833 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.665860652923584
Epoch: 24, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.882 Vali Acc: 0.534 Test Loss: 1.882 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9074349403381348
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.790 Vali Acc: 0.542 Test Loss: 1.790 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1222213
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.863337516784668
Epoch: 1, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.597 Vali Acc: 0.435 Test Loss: 1.597 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 1.6335852146148682
Epoch: 2, Steps: 8 | Train Loss: 1.492 Vali Loss: 1.567 Vali Acc: 0.420 Test Loss: 1.567 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1874430179595947
Epoch: 3, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2188327312469482
Epoch: 4, Steps: 8 | Train Loss: 1.191 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5643539428710938
Epoch: 5, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4092278480529785
Epoch: 6, Steps: 8 | Train Loss: 0.884 Vali Loss: 1.483 Vali Acc: 0.443 Test Loss: 1.483 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.7315475940704346
Epoch: 7, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.448 Vali Acc: 0.466 Test Loss: 1.448 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.5179028511047363
Epoch: 8, Steps: 8 | Train Loss: 0.552 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
Validation loss decreased (-0.465634 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.5947215557098389
Epoch: 9, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.385 Vali Acc: 0.519 Test Loss: 1.385 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.5055341720581055
Epoch: 10, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.441 Vali Acc: 0.511 Test Loss: 1.441 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9374065399169922
Epoch: 11, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.382 Vali Acc: 0.519 Test Loss: 1.382 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 1.4968645572662354
Epoch: 12, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6536643505096436
Epoch: 13, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.483 Vali Acc: 0.519 Test Loss: 1.483 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4730937480926514
Epoch: 14, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.3476011753082275
Epoch: 15, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.492 Vali Acc: 0.527 Test Loss: 1.492 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8569555282592773
Epoch: 16, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7979381084442139
Epoch: 17, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.479 Vali Acc: 0.527 Test Loss: 1.479 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8015782833099365
Epoch: 18, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.507 Vali Acc: 0.527 Test Loss: 1.507 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6031923294067383
Epoch: 19, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.597 Vali Acc: 0.519 Test Loss: 1.597 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5379719734191895
Epoch: 20, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.583 Vali Acc: 0.527 Test Loss: 1.583 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.585378646850586
Epoch: 21, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.589 Vali Acc: 0.527 Test Loss: 1.589 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.859041452407837
Epoch: 22, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.594 Vali Acc: 0.527 Test Loss: 1.594 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5556025505065918
Epoch: 23, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.521 Vali Acc: 0.542 Test Loss: 1.521 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541970).  Saving model ...
Epoch: 24 cost time: 1.3577895164489746
Epoch: 24, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.560 Vali Acc: 0.542 Test Loss: 1.560 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5394246578216553
Epoch: 25, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.683 Vali Acc: 0.519 Test Loss: 1.683 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4395077228546143
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.605 Vali Acc: 0.527 Test Loss: 1.605 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.620288610458374
Epoch: 27, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.537 Vali Acc: 0.542 Test Loss: 1.537 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4675946235656738
Epoch: 28, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.561 Vali Acc: 0.542 Test Loss: 1.561 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5418503284454346
Epoch: 29, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.522 Vali Acc: 0.550 Test Loss: 1.522 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549603).  Saving model ...
Epoch: 30 cost time: 1.511164903640747
Epoch: 30, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.545 Vali Acc: 0.542 Test Loss: 1.545 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.879310131072998
Epoch: 31, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.656 Vali Acc: 0.550 Test Loss: 1.656 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3900103569030762
Epoch: 32, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.650 Vali Acc: 0.550 Test Loss: 1.650 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5046584606170654
Epoch: 33, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.659 Vali Acc: 0.565 Test Loss: 1.659 Test Acc: 0.565
Validation loss decreased (-0.549603 --> -0.564869).  Saving model ...
Epoch: 34 cost time: 1.4129376411437988
Epoch: 34, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.708 Vali Acc: 0.542 Test Loss: 1.708 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9618151187896729
Epoch: 35, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.788 Vali Acc: 0.550 Test Loss: 1.788 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5512893199920654
Epoch: 36, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.817 Vali Acc: 0.527 Test Loss: 1.817 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5946094989776611
Epoch: 37, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.843 Vali Acc: 0.527 Test Loss: 1.843 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4668869972229004
Epoch: 38, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.111 Vali Acc: 0.519 Test Loss: 2.111 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.020146369934082
Epoch: 39, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.831 Vali Acc: 0.519 Test Loss: 2.831 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8606443405151367
Epoch: 40, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.943 Vali Acc: 0.519 Test Loss: 2.943 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8430259227752686
Epoch: 41, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.527 Vali Acc: 0.534 Test Loss: 2.527 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4550187587738037
Epoch: 42, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.268 Vali Acc: 0.557 Test Loss: 2.268 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.5802757740020752
Epoch: 43, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.351 Vali Acc: 0.557 Test Loss: 2.351 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1224069
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.931982755661011
Epoch: 1, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.626 Vali Acc: 0.214 Test Loss: 1.626 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.4431860446929932
Epoch: 2, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.599 Vali Acc: 0.382 Test Loss: 1.599 Test Acc: 0.382
Validation loss decreased (-0.213724 --> -0.381663).  Saving model ...
Epoch: 3 cost time: 1.6765029430389404
Epoch: 3, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.582 Vali Acc: 0.420 Test Loss: 1.582 Test Acc: 0.420
Validation loss decreased (-0.381663 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.8356547355651855
Epoch: 4, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.4642529487609863
Epoch: 5, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4475555419921875
Epoch: 6, Steps: 8 | Train Loss: 0.866 Vali Loss: 1.511 Vali Acc: 0.443 Test Loss: 1.511 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.6265578269958496
Epoch: 7, Steps: 8 | Train Loss: 0.731 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.3153834342956543
Epoch: 8, Steps: 8 | Train Loss: 0.590 Vali Loss: 1.382 Vali Acc: 0.496 Test Loss: 1.382 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.534254550933838
Epoch: 9, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.350 Vali Acc: 0.527 Test Loss: 1.350 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.798753261566162
Epoch: 10, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.5111699104309082
Epoch: 11, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.274 Vali Acc: 0.542 Test Loss: 1.274 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541972).  Saving model ...
Epoch: 12 cost time: 1.3061723709106445
Epoch: 12, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.306 Vali Acc: 0.534 Test Loss: 1.306 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.46708345413208
Epoch: 13, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.297 Vali Acc: 0.565 Test Loss: 1.297 Test Acc: 0.565
Validation loss decreased (-0.541972 --> -0.564873).  Saving model ...
Epoch: 14 cost time: 1.9256563186645508
Epoch: 14, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.274 Vali Acc: 0.542 Test Loss: 1.274 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8927361965179443
Epoch: 15, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.271 Vali Acc: 0.534 Test Loss: 1.271 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.631664514541626
Epoch: 16, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.305 Vali Acc: 0.534 Test Loss: 1.305 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4407172203063965
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.314 Vali Acc: 0.542 Test Loss: 1.314 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7728021144866943
Epoch: 18, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.313 Vali Acc: 0.550 Test Loss: 1.313 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0736067295074463
Epoch: 19, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.308 Vali Acc: 0.542 Test Loss: 1.308 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8538916110992432
Epoch: 20, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.285 Vali Acc: 0.550 Test Loss: 1.285 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7926850318908691
Epoch: 21, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.244 Vali Acc: 0.565 Test Loss: 1.244 Test Acc: 0.565
Validation loss decreased (-0.564873 --> -0.564873).  Saving model ...
Epoch: 22 cost time: 1.9093992710113525
Epoch: 22, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.269 Vali Acc: 0.557 Test Loss: 1.269 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7291409969329834
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.297 Vali Acc: 0.565 Test Loss: 1.297 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1146223545074463
Epoch: 24, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.227 Vali Acc: 0.595 Test Loss: 1.227 Test Acc: 0.595
Validation loss decreased (-0.564873 --> -0.595408).  Saving model ...
Epoch: 25 cost time: 1.7168912887573242
Epoch: 25, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.277 Vali Acc: 0.588 Test Loss: 1.277 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4943873882293701
Epoch: 26, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.278 Vali Acc: 0.542 Test Loss: 1.278 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6259934902191162
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.283 Vali Acc: 0.557 Test Loss: 1.283 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6993005275726318
Epoch: 28, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.340 Vali Acc: 0.588 Test Loss: 1.340 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.571018934249878
Epoch: 29, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.335 Vali Acc: 0.573 Test Loss: 1.335 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8762731552124023
Epoch: 30, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.370 Vali Acc: 0.595 Test Loss: 1.370 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.751155138015747
Epoch: 31, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.409 Vali Acc: 0.580 Test Loss: 1.409 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.87953519821167
Epoch: 32, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.453 Vali Acc: 0.580 Test Loss: 1.453 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8022658824920654
Epoch: 33, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.438 Vali Acc: 0.565 Test Loss: 1.438 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.753861665725708
Epoch: 34, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.431 Vali Acc: 0.542 Test Loss: 1.431 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 1241349
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.641021490097046
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.600 Vali Acc: 0.366 Test Loss: 1.600 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 2.446282386779785
Epoch: 2, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.581 Vali Acc: 0.443 Test Loss: 1.581 Test Acc: 0.443
Validation loss decreased (-0.366396 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.9895930290222168
Epoch: 3, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.566 Vali Acc: 0.427 Test Loss: 1.566 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.797551155090332
Epoch: 4, Steps: 8 | Train Loss: 1.215 Vali Loss: 1.542 Vali Acc: 0.427 Test Loss: 1.542 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1030478477478027
Epoch: 5, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8975050449371338
Epoch: 6, Steps: 8 | Train Loss: 0.958 Vali Loss: 1.503 Vali Acc: 0.443 Test Loss: 1.503 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.7490925788879395
Epoch: 7, Steps: 8 | Train Loss: 0.824 Vali Loss: 1.488 Vali Acc: 0.458 Test Loss: 1.488 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 2.170185089111328
Epoch: 8, Steps: 8 | Train Loss: 0.680 Vali Loss: 1.460 Vali Acc: 0.466 Test Loss: 1.460 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 2.5136053562164307
Epoch: 9, Steps: 8 | Train Loss: 0.585 Vali Loss: 1.441 Vali Acc: 0.496 Test Loss: 1.441 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.8929319381713867
Epoch: 10, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.441 Vali Acc: 0.496 Test Loss: 1.441 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2377936840057373
Epoch: 11, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.425 Vali Acc: 0.504 Test Loss: 1.425 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 2.05187726020813
Epoch: 12, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.390 Vali Acc: 0.496 Test Loss: 1.390 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3150100708007812
Epoch: 13, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.9942560195922852
Epoch: 14, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.374 Vali Acc: 0.534 Test Loss: 1.374 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 15 cost time: 2.578758955001831
Epoch: 15, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.356 Vali Acc: 0.534 Test Loss: 1.356 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534338).  Saving model ...
Epoch: 16 cost time: 2.4289417266845703
Epoch: 16, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.369 Vali Acc: 0.511 Test Loss: 1.369 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.162705659866333
Epoch: 17, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.394 Vali Acc: 0.511 Test Loss: 1.394 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.067995548248291
Epoch: 18, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.437 Vali Acc: 0.511 Test Loss: 1.437 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1795706748962402
Epoch: 19, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4056174755096436
Epoch: 20, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.406 Vali Acc: 0.519 Test Loss: 1.406 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9246528148651123
Epoch: 21, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0392723083496094
Epoch: 22, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.466 Vali Acc: 0.519 Test Loss: 1.466 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0716495513916016
Epoch: 23, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.434 Vali Acc: 0.527 Test Loss: 1.434 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2879395484924316
Epoch: 24, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.985701084136963
Epoch: 25, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.459 Vali Acc: 0.519 Test Loss: 1.459 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1287365
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.1853272914886475
Epoch: 1, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.625 Vali Acc: 0.160 Test Loss: 1.625 Test Acc: 0.160
Validation loss decreased (inf --> -0.160289).  Saving model ...
Epoch: 2 cost time: 1.5300090312957764
Epoch: 2, Steps: 8 | Train Loss: 1.510 Vali Loss: 1.607 Vali Acc: 0.321 Test Loss: 1.607 Test Acc: 0.321
Validation loss decreased (-0.160289 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.427018165588379
Epoch: 3, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.578 Vali Acc: 0.450 Test Loss: 1.578 Test Acc: 0.450
Validation loss decreased (-0.320595 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.3350517749786377
Epoch: 4, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.555 Vali Acc: 0.435 Test Loss: 1.555 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4900438785552979
Epoch: 5, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.523 Vali Acc: 0.466 Test Loss: 1.523 Test Acc: 0.466
Validation loss decreased (-0.450366 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 2.016869306564331
Epoch: 6, Steps: 8 | Train Loss: 0.864 Vali Loss: 1.502 Vali Acc: 0.481 Test Loss: 1.502 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 1.412485122680664
Epoch: 7, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.500 Vali Acc: 0.489 Test Loss: 1.500 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.9665179252624512
Epoch: 8, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.455 Vali Acc: 0.511 Test Loss: 1.455 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 2.0128767490386963
Epoch: 9, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.414 Vali Acc: 0.511 Test Loss: 1.414 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.6150319576263428
Epoch: 10, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.457 Vali Acc: 0.527 Test Loss: 1.457 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 11 cost time: 1.7595982551574707
Epoch: 11, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.489 Vali Acc: 0.527 Test Loss: 1.489 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4718973636627197
Epoch: 12, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.441 Vali Acc: 0.534 Test Loss: 1.441 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.7944297790527344
Epoch: 13, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.453 Vali Acc: 0.534 Test Loss: 1.453 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7704100608825684
Epoch: 14, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.562 Vali Acc: 0.527 Test Loss: 1.562 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4701101779937744
Epoch: 15, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.552 Vali Acc: 0.519 Test Loss: 1.552 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6185023784637451
Epoch: 16, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0674960613250732
Epoch: 17, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.477 Vali Acc: 0.542 Test Loss: 1.477 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 18 cost time: 1.5250749588012695
Epoch: 18, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.531 Vali Acc: 0.527 Test Loss: 1.531 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5398547649383545
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.544564962387085
Epoch: 20, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.513 Vali Acc: 0.527 Test Loss: 1.513 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.425635814666748
Epoch: 21, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.518 Vali Acc: 0.519 Test Loss: 1.518 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.875783920288086
Epoch: 22, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.557 Vali Acc: 0.511 Test Loss: 1.557 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9712693691253662
Epoch: 23, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.552 Vali Acc: 0.527 Test Loss: 1.552 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2553637027740479
Epoch: 24, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.555 Vali Acc: 0.527 Test Loss: 1.555 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.620643138885498
Epoch: 25, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.575 Vali Acc: 0.519 Test Loss: 1.575 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7623536586761475
Epoch: 26, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.527 Vali Acc: 0.542 Test Loss: 1.527 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6315553188323975
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.518 Vali Acc: 0.542 Test Loss: 1.518 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1337221
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.686375617980957
Epoch: 1, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.593 Vali Acc: 0.389 Test Loss: 1.593 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.917815923690796
Epoch: 2, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.583 Vali Acc: 0.427 Test Loss: 1.583 Test Acc: 0.427
Validation loss decreased (-0.389297 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.9583220481872559
Epoch: 3, Steps: 8 | Train Loss: 1.382 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5211591720581055
Epoch: 4, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9184041023254395
Epoch: 5, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7001681327819824
Epoch: 6, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.189614772796631
Epoch: 7, Steps: 8 | Train Loss: 0.791 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.9137587547302246
Epoch: 8, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.494 Vali Acc: 0.443 Test Loss: 1.494 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.630565881729126
Epoch: 9, Steps: 8 | Train Loss: 0.620 Vali Loss: 1.516 Vali Acc: 0.435 Test Loss: 1.516 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.254396915435791
Epoch: 10, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.506 Vali Acc: 0.443 Test Loss: 1.506 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9024035930633545
Epoch: 11, Steps: 8 | Train Loss: 0.452 Vali Loss: 1.501 Vali Acc: 0.443 Test Loss: 1.501 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9730861186981201
Epoch: 12, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.463 Vali Acc: 0.473 Test Loss: 1.463 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 13 cost time: 2.1923115253448486
Epoch: 13, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.463 Vali Acc: 0.473 Test Loss: 1.463 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7253024578094482
Epoch: 14, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6193034648895264
Epoch: 15, Steps: 8 | Train Loss: 0.296 Vali Loss: 1.477 Vali Acc: 0.466 Test Loss: 1.477 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3364980220794678
Epoch: 16, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.464 Vali Acc: 0.481 Test Loss: 1.464 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 17 cost time: 1.7609615325927734
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.491 Vali Acc: 0.473 Test Loss: 1.491 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.034985303878784
Epoch: 18, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.499 Vali Acc: 0.458 Test Loss: 1.499 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6178107261657715
Epoch: 19, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.513 Vali Acc: 0.466 Test Loss: 1.513 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6485536098480225
Epoch: 20, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.513 Vali Acc: 0.458 Test Loss: 1.513 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4570984840393066
Epoch: 21, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.544 Vali Acc: 0.450 Test Loss: 1.544 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5273866653442383
Epoch: 22, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.542 Vali Acc: 0.450 Test Loss: 1.542 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7124907970428467
Epoch: 23, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.546 Vali Acc: 0.450 Test Loss: 1.546 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9863269329071045
Epoch: 24, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.542 Vali Acc: 0.458 Test Loss: 1.542 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8915815353393555
Epoch: 25, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.516 Vali Acc: 0.450 Test Loss: 1.516 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4802987575531006
Epoch: 26, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.531 Vali Acc: 0.450 Test Loss: 1.531 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 1390917
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.988168954849243
Epoch: 1, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.567 Vali Acc: 0.412 Test Loss: 1.567 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.7367539405822754
Epoch: 2, Steps: 8 | Train Loss: 1.478 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6181213855743408
Epoch: 3, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.547 Vali Acc: 0.420 Test Loss: 1.547 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9140634536743164
Epoch: 4, Steps: 8 | Train Loss: 1.188 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7979176044464111
Epoch: 5, Steps: 8 | Train Loss: 0.992 Vali Loss: 1.486 Vali Acc: 0.427 Test Loss: 1.486 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.6545281410217285
Epoch: 6, Steps: 8 | Train Loss: 0.804 Vali Loss: 1.435 Vali Acc: 0.473 Test Loss: 1.435 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 1.778398036956787
Epoch: 7, Steps: 8 | Train Loss: 0.636 Vali Loss: 1.410 Vali Acc: 0.489 Test Loss: 1.410 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 8 cost time: 1.9355432987213135
Epoch: 8, Steps: 8 | Train Loss: 0.450 Vali Loss: 1.375 Vali Acc: 0.511 Test Loss: 1.375 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511437).  Saving model ...
Epoch: 9 cost time: 2.1331655979156494
Epoch: 9, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.357 Vali Acc: 0.519 Test Loss: 1.357 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.774543046951294
Epoch: 10, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.381 Vali Acc: 0.519 Test Loss: 1.381 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5732505321502686
Epoch: 11, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.384 Vali Acc: 0.519 Test Loss: 1.384 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5966122150421143
Epoch: 12, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.384 Vali Acc: 0.519 Test Loss: 1.384 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7817776203155518
Epoch: 13, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.409 Vali Acc: 0.519 Test Loss: 1.409 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3880643844604492
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6687240600585938
Epoch: 15, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.450 Vali Acc: 0.527 Test Loss: 1.450 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 16 cost time: 1.743772029876709
Epoch: 16, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.439 Vali Acc: 0.527 Test Loss: 1.439 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 17 cost time: 1.865835189819336
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.473 Vali Acc: 0.542 Test Loss: 1.473 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541970).  Saving model ...
Epoch: 18 cost time: 1.910304307937622
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549604).  Saving model ...
Epoch: 19 cost time: 2.2361457347869873
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.500 Vali Acc: 0.542 Test Loss: 1.500 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.871506929397583
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.603 Vali Acc: 0.542 Test Loss: 1.603 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.218780040740967
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.615 Vali Acc: 0.527 Test Loss: 1.615 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1391634941101074
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.576 Vali Acc: 0.534 Test Loss: 1.576 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.072650671005249
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.560 Vali Acc: 0.565 Test Loss: 1.560 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564870).  Saving model ...
Epoch: 24 cost time: 1.9858925342559814
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.670 Vali Acc: 0.565 Test Loss: 1.670 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9626460075378418
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.735 Vali Acc: 0.550 Test Loss: 1.735 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7372779846191406
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.773 Vali Acc: 0.550 Test Loss: 1.773 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0178582668304443
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.739 Vali Acc: 0.550 Test Loss: 1.739 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1062541007995605
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.779 Vali Acc: 0.557 Test Loss: 1.779 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7921266555786133
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.902 Vali Acc: 0.557 Test Loss: 1.902 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7247815132141113
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.993 Vali Acc: 0.550 Test Loss: 1.993 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9228322505950928
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.038 Vali Acc: 0.542 Test Loss: 2.038 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8496546745300293
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.013 Vali Acc: 0.550 Test Loss: 2.013 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.790510654449463
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.000 Vali Acc: 0.550 Test Loss: 2.000 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 385253
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.404706239700317
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.631 Vali Acc: 0.214 Test Loss: 1.631 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.934999704360962
Epoch: 2, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.607 Vali Acc: 0.427 Test Loss: 1.607 Test Acc: 0.427
Validation loss decreased (-0.213724 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.652679443359375
Epoch: 3, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.592 Vali Acc: 0.420 Test Loss: 1.592 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8254404067993164
Epoch: 4, Steps: 8 | Train Loss: 1.303 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7623848915100098
Epoch: 5, Steps: 8 | Train Loss: 1.181 Vali Loss: 1.548 Vali Acc: 0.443 Test Loss: 1.548 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.8391697406768799
Epoch: 6, Steps: 8 | Train Loss: 1.049 Vali Loss: 1.520 Vali Acc: 0.466 Test Loss: 1.520 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.7525067329406738
Epoch: 7, Steps: 8 | Train Loss: 0.886 Vali Loss: 1.491 Vali Acc: 0.481 Test Loss: 1.491 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.6243038177490234
Epoch: 8, Steps: 8 | Train Loss: 0.791 Vali Loss: 1.509 Vali Acc: 0.450 Test Loss: 1.509 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4669909477233887
Epoch: 9, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.451 Vali Acc: 0.504 Test Loss: 1.451 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.5207335948944092
Epoch: 10, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.387 Vali Acc: 0.534 Test Loss: 1.387 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 1.6960387229919434
Epoch: 11, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8737061023712158
Epoch: 12, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.391 Vali Acc: 0.511 Test Loss: 1.391 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9825990200042725
Epoch: 13, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.404 Vali Acc: 0.519 Test Loss: 1.404 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.908463478088379
Epoch: 14, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.425 Vali Acc: 0.527 Test Loss: 1.425 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4697716236114502
Epoch: 15, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.444 Vali Acc: 0.519 Test Loss: 1.444 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.420287847518921
Epoch: 16, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.413 Vali Acc: 0.550 Test Loss: 1.413 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 17 cost time: 1.8115134239196777
Epoch: 17, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549604).  Saving model ...
Epoch: 18 cost time: 2.04189395904541
Epoch: 18, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.477 Vali Acc: 0.557 Test Loss: 1.477 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557237).  Saving model ...
Epoch: 19 cost time: 1.6890308856964111
Epoch: 19, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.445 Vali Acc: 0.550 Test Loss: 1.445 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9097533226013184
Epoch: 20, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.424 Vali Acc: 0.565 Test Loss: 1.424 Test Acc: 0.565
Validation loss decreased (-0.557237 --> -0.564871).  Saving model ...
Epoch: 21 cost time: 1.9496023654937744
Epoch: 21, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.512 Vali Acc: 0.542 Test Loss: 1.512 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4964640140533447
Epoch: 22, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.522 Vali Acc: 0.542 Test Loss: 1.522 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2323782444000244
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.520 Vali Acc: 0.557 Test Loss: 1.520 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8408911228179932
Epoch: 24, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.636 Vali Acc: 0.550 Test Loss: 1.636 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.824493169784546
Epoch: 25, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.458 Vali Acc: 0.573 Test Loss: 1.458 Test Acc: 0.573
Validation loss decreased (-0.564871 --> -0.572505).  Saving model ...
Epoch: 26 cost time: 2.107053756713867
Epoch: 26, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.491 Vali Acc: 0.573 Test Loss: 1.491 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.501298427581787
Epoch: 27, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.496 Vali Acc: 0.550 Test Loss: 1.496 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.107545852661133
Epoch: 28, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.493 Vali Acc: 0.542 Test Loss: 1.493 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8189506530761719
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.517 Vali Acc: 0.565 Test Loss: 1.517 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7275810241699219
Epoch: 30, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.548 Vali Acc: 0.565 Test Loss: 1.548 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8437786102294922
Epoch: 31, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.598 Vali Acc: 0.557 Test Loss: 1.598 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.797236680984497
Epoch: 32, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.683 Vali Acc: 0.580 Test Loss: 1.683 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580136).  Saving model ...
Epoch: 33 cost time: 2.3156895637512207
Epoch: 33, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.636 Vali Acc: 0.588 Test Loss: 1.636 Test Acc: 0.588
Validation loss decreased (-0.580136 --> -0.587770).  Saving model ...
Epoch: 34 cost time: 1.9510788917541504
Epoch: 34, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.699 Vali Acc: 0.580 Test Loss: 1.699 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.442049503326416
Epoch: 35, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.797 Vali Acc: 0.534 Test Loss: 1.797 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.716567039489746
Epoch: 36, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.781 Vali Acc: 0.595 Test Loss: 1.781 Test Acc: 0.595
Validation loss decreased (-0.587770 --> -0.595402).  Saving model ...
Epoch: 37 cost time: 1.886934757232666
Epoch: 37, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.770 Vali Acc: 0.557 Test Loss: 1.770 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8548295497894287
Epoch: 38, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.768 Vali Acc: 0.588 Test Loss: 1.768 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9090068340301514
Epoch: 39, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.639 Vali Acc: 0.603 Test Loss: 1.639 Test Acc: 0.603
Validation loss decreased (-0.595402 --> -0.603037).  Saving model ...
Epoch: 40 cost time: 1.9534459114074707
Epoch: 40, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.685 Vali Acc: 0.580 Test Loss: 1.685 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6923279762268066
Epoch: 41, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.806 Vali Acc: 0.550 Test Loss: 1.806 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.0115108489990234
Epoch: 42, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.814 Vali Acc: 0.550 Test Loss: 1.814 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9067680835723877
Epoch: 43, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.830 Vali Acc: 0.550 Test Loss: 1.830 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.787654161453247
Epoch: 44, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.955 Vali Acc: 0.557 Test Loss: 1.955 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.9221076965332031
Epoch: 45, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.023 Vali Acc: 0.550 Test Loss: 2.023 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3776357173919678
Epoch: 46, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.369 Vali Acc: 0.542 Test Loss: 2.369 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.748124599456787
Epoch: 47, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.772 Vali Acc: 0.527 Test Loss: 2.772 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.9291834831237793
Epoch: 48, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.490 Vali Acc: 0.542 Test Loss: 2.490 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.024308443069458
Epoch: 49, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.318 Vali Acc: 0.542 Test Loss: 2.318 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 361253
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.023406267166138
Epoch: 1, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.606 Vali Acc: 0.374 Test Loss: 1.606 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.644355058670044
Epoch: 2, Steps: 8 | Train Loss: 1.548 Vali Loss: 1.595 Vali Acc: 0.420 Test Loss: 1.595 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.8093581199645996
Epoch: 3, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.977522850036621
Epoch: 4, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.990492820739746
Epoch: 5, Steps: 8 | Train Loss: 1.216 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8877887725830078
Epoch: 6, Steps: 8 | Train Loss: 1.121 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.9289419651031494
Epoch: 7, Steps: 8 | Train Loss: 0.999 Vali Loss: 1.482 Vali Acc: 0.427 Test Loss: 1.482 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 2.1871018409729004
Epoch: 8, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.465 Vali Acc: 0.435 Test Loss: 1.465 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 9 cost time: 1.359177827835083
Epoch: 9, Steps: 8 | Train Loss: 0.803 Vali Loss: 1.471 Vali Acc: 0.458 Test Loss: 1.471 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 10 cost time: 1.957491397857666
Epoch: 10, Steps: 8 | Train Loss: 0.702 Vali Loss: 1.425 Vali Acc: 0.473 Test Loss: 1.425 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 2.1427600383758545
Epoch: 11, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.364 Vali Acc: 0.504 Test Loss: 1.364 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.808753490447998
Epoch: 12, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.376 Vali Acc: 0.504 Test Loss: 1.376 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.726248025894165
Epoch: 13, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.389 Vali Acc: 0.504 Test Loss: 1.389 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.61474609375
Epoch: 14, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.300 Vali Acc: 0.519 Test Loss: 1.300 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519071).  Saving model ...
Epoch: 15 cost time: 1.941932201385498
Epoch: 15, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.361 Vali Acc: 0.504 Test Loss: 1.361 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8914358615875244
Epoch: 16, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.324 Vali Acc: 0.519 Test Loss: 1.324 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5008876323699951
Epoch: 17, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.374 Vali Acc: 0.511 Test Loss: 1.374 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0729124546051025
Epoch: 18, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.415 Vali Acc: 0.519 Test Loss: 1.415 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.233581066131592
Epoch: 19, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.305 Vali Acc: 0.534 Test Loss: 1.305 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534338).  Saving model ...
Epoch: 20 cost time: 1.595628261566162
Epoch: 20, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.345 Vali Acc: 0.534 Test Loss: 1.345 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.591522455215454
Epoch: 21, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.360 Vali Acc: 0.527 Test Loss: 1.360 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5522892475128174
Epoch: 22, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.289 Vali Acc: 0.542 Test Loss: 1.289 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 23 cost time: 1.860267162322998
Epoch: 23, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.307 Vali Acc: 0.534 Test Loss: 1.307 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.762319564819336
Epoch: 24, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.354 Vali Acc: 0.527 Test Loss: 1.354 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7822418212890625
Epoch: 25, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.303 Vali Acc: 0.534 Test Loss: 1.303 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5050280094146729
Epoch: 26, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.316 Vali Acc: 0.534 Test Loss: 1.316 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7680237293243408
Epoch: 27, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.325 Vali Acc: 0.534 Test Loss: 1.325 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8390345573425293
Epoch: 28, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.363 Vali Acc: 0.542 Test Loss: 1.363 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8732631206512451
Epoch: 29, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.286 Vali Acc: 0.557 Test Loss: 1.286 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557239).  Saving model ...
Epoch: 30 cost time: 1.7239084243774414
Epoch: 30, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.314 Vali Acc: 0.550 Test Loss: 1.314 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9420948028564453
Epoch: 31, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5729517936706543
Epoch: 32, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.374 Vali Acc: 0.557 Test Loss: 1.374 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7144827842712402
Epoch: 33, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.329 Vali Acc: 0.550 Test Loss: 1.329 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5724096298217773
Epoch: 34, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.239 Vali Acc: 0.565 Test Loss: 1.239 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564873).  Saving model ...
Epoch: 35 cost time: 1.5870685577392578
Epoch: 35, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.272 Vali Acc: 0.557 Test Loss: 1.272 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7421207427978516
Epoch: 36, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.398 Vali Acc: 0.565 Test Loss: 1.398 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9302234649658203
Epoch: 37, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.496 Vali Acc: 0.557 Test Loss: 1.496 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6542792320251465
Epoch: 38, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.386 Vali Acc: 0.580 Test Loss: 1.386 Test Acc: 0.580
Validation loss decreased (-0.564873 --> -0.580139).  Saving model ...
Epoch: 39 cost time: 1.810250997543335
Epoch: 39, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.348 Vali Acc: 0.573 Test Loss: 1.348 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8619461059570312
Epoch: 40, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.343 Vali Acc: 0.580 Test Loss: 1.343 Test Acc: 0.580
Validation loss decreased (-0.580139 --> -0.580139).  Saving model ...
Epoch: 41 cost time: 1.71437668800354
Epoch: 41, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.417 Vali Acc: 0.550 Test Loss: 1.417 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6200273036956787
Epoch: 42, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.401 Vali Acc: 0.573 Test Loss: 1.401 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.989267110824585
Epoch: 43, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.422 Vali Acc: 0.557 Test Loss: 1.422 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.3688228130340576
Epoch: 44, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.292 Vali Acc: 0.573 Test Loss: 1.292 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.306886911392212
Epoch: 45, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.282 Vali Acc: 0.565 Test Loss: 1.282 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.9702441692352295
Epoch: 46, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.304 Vali Acc: 0.565 Test Loss: 1.304 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6701042652130127
Epoch: 47, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.325 Vali Acc: 0.595 Test Loss: 1.325 Test Acc: 0.595
Validation loss decreased (-0.580139 --> -0.595407).  Saving model ...
Epoch: 48 cost time: 1.5435290336608887
Epoch: 48, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.530 Vali Acc: 0.565 Test Loss: 1.530 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.602506160736084
Epoch: 49, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.531 Vali Acc: 0.588 Test Loss: 1.531 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.024763584136963
Epoch: 50, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.516 Vali Acc: 0.565 Test Loss: 1.516 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 362181
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.556299686431885
Epoch: 1, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.614 Vali Acc: 0.252 Test Loss: 1.614 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 2.2160747051239014
Epoch: 2, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.591 Vali Acc: 0.389 Test Loss: 1.591 Test Acc: 0.389
Validation loss decreased (-0.251892 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.696241855621338
Epoch: 3, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.564 Vali Acc: 0.435 Test Loss: 1.564 Test Acc: 0.435
Validation loss decreased (-0.389297 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.6395268440246582
Epoch: 4, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4662301540374756
Epoch: 5, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.529 Vali Acc: 0.427 Test Loss: 1.529 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6657435894012451
Epoch: 6, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.513 Vali Acc: 0.427 Test Loss: 1.513 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0936830043792725
Epoch: 7, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.507 Vali Acc: 0.427 Test Loss: 1.507 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.809046745300293
Epoch: 8, Steps: 8 | Train Loss: 0.930 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.5395772457122803
Epoch: 9, Steps: 8 | Train Loss: 0.815 Vali Loss: 1.449 Vali Acc: 0.466 Test Loss: 1.449 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 2.0468177795410156
Epoch: 10, Steps: 8 | Train Loss: 0.707 Vali Loss: 1.452 Vali Acc: 0.481 Test Loss: 1.452 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 1.7248320579528809
Epoch: 11, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.429 Vali Acc: 0.489 Test Loss: 1.429 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 1.5580992698669434
Epoch: 12, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
Validation loss decreased (-0.488535 --> -0.526704).  Saving model ...
Epoch: 13 cost time: 1.5971174240112305
Epoch: 13, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.359 Vali Acc: 0.534 Test Loss: 1.359 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 14 cost time: 2.0779619216918945
Epoch: 14, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.378 Vali Acc: 0.519 Test Loss: 1.378 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.75675630569458
Epoch: 15, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.341 Vali Acc: 0.534 Test Loss: 1.341 Test Acc: 0.534
Validation loss decreased (-0.534338 --> -0.534338).  Saving model ...
Epoch: 16 cost time: 2.231508731842041
Epoch: 16, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.334 Vali Acc: 0.542 Test Loss: 1.334 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 17 cost time: 1.7337167263031006
Epoch: 17, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.305 Vali Acc: 0.557 Test Loss: 1.305 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557239).  Saving model ...
Epoch: 18 cost time: 1.9531090259552002
Epoch: 18, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.314 Vali Acc: 0.542 Test Loss: 1.314 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6974775791168213
Epoch: 19, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.353 Vali Acc: 0.565 Test Loss: 1.353 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564872).  Saving model ...
Epoch: 20 cost time: 1.7417564392089844
Epoch: 20, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.350 Vali Acc: 0.557 Test Loss: 1.350 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6077208518981934
Epoch: 21, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.338 Vali Acc: 0.557 Test Loss: 1.338 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4548060894012451
Epoch: 22, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.355 Vali Acc: 0.557 Test Loss: 1.355 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9684302806854248
Epoch: 23, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.345 Vali Acc: 0.573 Test Loss: 1.345 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572506).  Saving model ...
Epoch: 24 cost time: 1.7787737846374512
Epoch: 24, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.345 Vali Acc: 0.611 Test Loss: 1.345 Test Acc: 0.611
Validation loss decreased (-0.572506 --> -0.610674).  Saving model ...
Epoch: 25 cost time: 1.712615966796875
Epoch: 25, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.411 Vali Acc: 0.626 Test Loss: 1.411 Test Acc: 0.626
Validation loss decreased (-0.610674 --> -0.625940).  Saving model ...
Epoch: 26 cost time: 1.3200585842132568
Epoch: 26, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.347 Vali Acc: 0.580 Test Loss: 1.347 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.456120491027832
Epoch: 27, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.349 Vali Acc: 0.557 Test Loss: 1.349 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8470408916473389
Epoch: 28, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.379 Vali Acc: 0.595 Test Loss: 1.379 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.560805320739746
Epoch: 29, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.394 Vali Acc: 0.565 Test Loss: 1.394 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9834949970245361
Epoch: 30, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.365 Vali Acc: 0.565 Test Loss: 1.365 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.314927101135254
Epoch: 31, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.397 Vali Acc: 0.611 Test Loss: 1.397 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.644930124282837
Epoch: 32, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.393 Vali Acc: 0.611 Test Loss: 1.393 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5112767219543457
Epoch: 33, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.360 Vali Acc: 0.595 Test Loss: 1.360 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6783366203308105
Epoch: 34, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.398 Vali Acc: 0.611 Test Loss: 1.398 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4844889640808105
Epoch: 35, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.356 Vali Acc: 0.603 Test Loss: 1.356 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 370821
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.432605743408203
Epoch: 1, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.601 Vali Acc: 0.198 Test Loss: 1.601 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 1.8178374767303467
Epoch: 2, Steps: 8 | Train Loss: 1.539 Vali Loss: 1.581 Vali Acc: 0.336 Test Loss: 1.581 Test Acc: 0.336
Validation loss decreased (-0.198457 --> -0.335862).  Saving model ...
Epoch: 3 cost time: 1.4230616092681885
Epoch: 3, Steps: 8 | Train Loss: 1.459 Vali Loss: 1.558 Vali Acc: 0.435 Test Loss: 1.558 Test Acc: 0.435
Validation loss decreased (-0.335862 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.5297987461090088
Epoch: 4, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4414756298065186
Epoch: 5, Steps: 8 | Train Loss: 1.234 Vali Loss: 1.511 Vali Acc: 0.435 Test Loss: 1.511 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.6711337566375732
Epoch: 6, Steps: 8 | Train Loss: 1.126 Vali Loss: 1.505 Vali Acc: 0.435 Test Loss: 1.505 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 1.683018445968628
Epoch: 7, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.504 Vali Acc: 0.443 Test Loss: 1.504 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.873028039932251
Epoch: 8, Steps: 8 | Train Loss: 0.929 Vali Loss: 1.491 Vali Acc: 0.443 Test Loss: 1.491 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.5872728824615479
Epoch: 9, Steps: 8 | Train Loss: 0.880 Vali Loss: 1.475 Vali Acc: 0.443 Test Loss: 1.475 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 1.9364347457885742
Epoch: 10, Steps: 8 | Train Loss: 0.786 Vali Loss: 1.459 Vali Acc: 0.466 Test Loss: 1.459 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 11 cost time: 1.7518465518951416
Epoch: 11, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.446 Vali Acc: 0.481 Test Loss: 1.446 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 1.672856330871582
Epoch: 12, Steps: 8 | Train Loss: 0.651 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 13 cost time: 2.0669870376586914
Epoch: 13, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.398 Vali Acc: 0.496 Test Loss: 1.398 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 14 cost time: 1.6262648105621338
Epoch: 14, Steps: 8 | Train Loss: 0.507 Vali Loss: 1.415 Vali Acc: 0.511 Test Loss: 1.415 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 15 cost time: 1.6151604652404785
Epoch: 15, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.403 Vali Acc: 0.504 Test Loss: 1.403 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6672582626342773
Epoch: 16, Steps: 8 | Train Loss: 0.388 Vali Loss: 1.393 Vali Acc: 0.496 Test Loss: 1.393 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7091355323791504
Epoch: 17, Steps: 8 | Train Loss: 0.362 Vali Loss: 1.386 Vali Acc: 0.504 Test Loss: 1.386 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.622145652770996
Epoch: 18, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.386 Vali Acc: 0.511 Test Loss: 1.386 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511437).  Saving model ...
Epoch: 19 cost time: 1.549529790878296
Epoch: 19, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.383 Vali Acc: 0.496 Test Loss: 1.383 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7067632675170898
Epoch: 20, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.388 Vali Acc: 0.504 Test Loss: 1.388 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6065549850463867
Epoch: 21, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.337 Vali Acc: 0.565 Test Loss: 1.337 Test Acc: 0.565
Validation loss decreased (-0.511437 --> -0.564872).  Saving model ...
Epoch: 22 cost time: 1.6393051147460938
Epoch: 22, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.362 Vali Acc: 0.527 Test Loss: 1.362 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4433295726776123
Epoch: 23, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.390 Vali Acc: 0.511 Test Loss: 1.390 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9876086711883545
Epoch: 24, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.403 Vali Acc: 0.511 Test Loss: 1.403 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8640563488006592
Epoch: 25, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.419 Vali Acc: 0.504 Test Loss: 1.419 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6670663356781006
Epoch: 26, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.379 Vali Acc: 0.519 Test Loss: 1.379 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7342231273651123
Epoch: 27, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.411 Vali Acc: 0.496 Test Loss: 1.411 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8285863399505615
Epoch: 28, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.421 Vali Acc: 0.511 Test Loss: 1.421 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.678602695465088
Epoch: 29, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8466417789459229
Epoch: 30, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.424 Vali Acc: 0.519 Test Loss: 1.424 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0070531368255615
Epoch: 31, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.427 Vali Acc: 0.534 Test Loss: 1.427 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 393829
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.1313560009002686
Epoch: 1, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.624 Vali Acc: 0.168 Test Loss: 1.624 Test Acc: 0.168
Validation loss decreased (inf --> -0.167923).  Saving model ...
Epoch: 2 cost time: 1.7866795063018799
Epoch: 2, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.613 Vali Acc: 0.237 Test Loss: 1.613 Test Acc: 0.237
Validation loss decreased (-0.167923 --> -0.236625).  Saving model ...
Epoch: 3 cost time: 1.8097081184387207
Epoch: 3, Steps: 8 | Train Loss: 1.462 Vali Loss: 1.598 Vali Acc: 0.305 Test Loss: 1.598 Test Acc: 0.305
Validation loss decreased (-0.236625 --> -0.305328).  Saving model ...
Epoch: 4 cost time: 1.831693410873413
Epoch: 4, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.585 Vali Acc: 0.397 Test Loss: 1.585 Test Acc: 0.397
Validation loss decreased (-0.305328 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 2.0453076362609863
Epoch: 5, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.558 Vali Acc: 0.458 Test Loss: 1.558 Test Acc: 0.458
Validation loss decreased (-0.396931 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.8623228073120117
Epoch: 6, Steps: 8 | Train Loss: 1.105 Vali Loss: 1.521 Vali Acc: 0.450 Test Loss: 1.521 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8044395446777344
Epoch: 7, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.498 Vali Acc: 0.489 Test Loss: 1.498 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.406848430633545
Epoch: 8, Steps: 8 | Train Loss: 0.900 Vali Loss: 1.482 Vali Acc: 0.496 Test Loss: 1.482 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 9 cost time: 1.9923202991485596
Epoch: 9, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.467 Vali Acc: 0.496 Test Loss: 1.467 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 2.223930835723877
Epoch: 10, Steps: 8 | Train Loss: 0.720 Vali Loss: 1.463 Vali Acc: 0.504 Test Loss: 1.463 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.743603229522705
Epoch: 11, Steps: 8 | Train Loss: 0.633 Vali Loss: 1.428 Vali Acc: 0.519 Test Loss: 1.428 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 1.5762560367584229
Epoch: 12, Steps: 8 | Train Loss: 0.583 Vali Loss: 1.439 Vali Acc: 0.504 Test Loss: 1.439 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8583323955535889
Epoch: 13, Steps: 8 | Train Loss: 0.493 Vali Loss: 1.467 Vali Acc: 0.504 Test Loss: 1.467 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9639384746551514
Epoch: 14, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.417 Vali Acc: 0.504 Test Loss: 1.417 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1605663299560547
Epoch: 15, Steps: 8 | Train Loss: 0.358 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.616138219833374
Epoch: 16, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.366 Vali Acc: 0.511 Test Loss: 1.366 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7164926528930664
Epoch: 17, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.387 Vali Acc: 0.519 Test Loss: 1.387 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 18 cost time: 1.6783208847045898
Epoch: 18, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 19 cost time: 2.3116254806518555
Epoch: 19, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.396 Vali Acc: 0.519 Test Loss: 1.396 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3404948711395264
Epoch: 20, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.385 Vali Acc: 0.542 Test Loss: 1.385 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 21 cost time: 1.9033374786376953
Epoch: 21, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.386 Vali Acc: 0.527 Test Loss: 1.386 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7604317665100098
Epoch: 22, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.461 Vali Acc: 0.542 Test Loss: 1.461 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8767359256744385
Epoch: 23, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.374 Vali Acc: 0.534 Test Loss: 1.374 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7438502311706543
Epoch: 24, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5703680515289307
Epoch: 25, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.405 Vali Acc: 0.542 Test Loss: 1.405 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0323619842529297
Epoch: 26, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.496 Vali Acc: 0.511 Test Loss: 1.496 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.215604305267334
Epoch: 27, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1474368572235107
Epoch: 28, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.431 Vali Acc: 0.534 Test Loss: 1.431 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4752354621887207
Epoch: 29, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.375 Vali Acc: 0.527 Test Loss: 1.375 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7415637969970703
Epoch: 30, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.390 Vali Acc: 0.527 Test Loss: 1.390 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 418757
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.522704839706421
Epoch: 1, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.597 Vali Acc: 0.237 Test Loss: 1.597 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.9279239177703857
Epoch: 2, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.590 Vali Acc: 0.351 Test Loss: 1.590 Test Acc: 0.351
Validation loss decreased (-0.236625 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.8101694583892822
Epoch: 3, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.579 Vali Acc: 0.412 Test Loss: 1.579 Test Acc: 0.412
Validation loss decreased (-0.351129 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 2.19293212890625
Epoch: 4, Steps: 8 | Train Loss: 1.363 Vali Loss: 1.568 Vali Acc: 0.420 Test Loss: 1.568 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.084099531173706
Epoch: 5, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.558 Vali Acc: 0.427 Test Loss: 1.558 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 2.0856680870056152
Epoch: 6, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.545 Vali Acc: 0.427 Test Loss: 1.545 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427465).  Saving model ...
Epoch: 7 cost time: 1.7556583881378174
Epoch: 7, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2352023124694824
Epoch: 8, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.527 Vali Acc: 0.427 Test Loss: 1.527 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 2.009653091430664
Epoch: 9, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8780262470245361
Epoch: 10, Steps: 8 | Train Loss: 0.805 Vali Loss: 1.500 Vali Acc: 0.435 Test Loss: 1.500 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 11 cost time: 2.550572395324707
Epoch: 11, Steps: 8 | Train Loss: 0.755 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442733).  Saving model ...
Epoch: 12 cost time: 1.9735825061798096
Epoch: 12, Steps: 8 | Train Loss: 0.689 Vali Loss: 1.500 Vali Acc: 0.450 Test Loss: 1.500 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 13 cost time: 1.9376115798950195
Epoch: 13, Steps: 8 | Train Loss: 0.620 Vali Loss: 1.476 Vali Acc: 0.458 Test Loss: 1.476 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 14 cost time: 2.099353790283203
Epoch: 14, Steps: 8 | Train Loss: 0.520 Vali Loss: 1.464 Vali Acc: 0.458 Test Loss: 1.464 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 15 cost time: 2.4071645736694336
Epoch: 15, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.474 Vali Acc: 0.458 Test Loss: 1.474 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1115846633911133
Epoch: 16, Steps: 8 | Train Loss: 0.465 Vali Loss: 1.457 Vali Acc: 0.466 Test Loss: 1.457 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 17 cost time: 1.7868895530700684
Epoch: 17, Steps: 8 | Train Loss: 0.421 Vali Loss: 1.458 Vali Acc: 0.458 Test Loss: 1.458 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0065643787384033
Epoch: 18, Steps: 8 | Train Loss: 0.412 Vali Loss: 1.480 Vali Acc: 0.458 Test Loss: 1.480 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.03891658782959
Epoch: 19, Steps: 8 | Train Loss: 0.360 Vali Loss: 1.467 Vali Acc: 0.458 Test Loss: 1.467 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8939290046691895
Epoch: 20, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.437 Vali Acc: 0.489 Test Loss: 1.437 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 21 cost time: 1.6323843002319336
Epoch: 21, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.442 Vali Acc: 0.466 Test Loss: 1.442 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8423993587493896
Epoch: 22, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.455 Vali Acc: 0.466 Test Loss: 1.455 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9688763618469238
Epoch: 23, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.469 Vali Acc: 0.473 Test Loss: 1.469 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.843879222869873
Epoch: 24, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.480 Vali Acc: 0.466 Test Loss: 1.480 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.072740077972412
Epoch: 25, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.438 Vali Acc: 0.473 Test Loss: 1.438 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0823302268981934
Epoch: 26, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.479 Vali Acc: 0.466 Test Loss: 1.479 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.051987409591675
Epoch: 27, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.486 Vali Acc: 0.450 Test Loss: 1.486 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7343149185180664
Epoch: 28, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.463 Vali Acc: 0.473 Test Loss: 1.463 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8669819831848145
Epoch: 29, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.496 Vali Acc: 0.450 Test Loss: 1.496 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9748897552490234
Epoch: 30, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.486 Vali Acc: 0.458 Test Loss: 1.486 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 445605
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.8319902420043945
Epoch: 1, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.552 Vali Acc: 0.435 Test Loss: 1.552 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 1.9555418491363525
Epoch: 2, Steps: 8 | Train Loss: 1.012 Vali Loss: 1.328 Vali Acc: 0.565 Test Loss: 1.328 Test Acc: 0.565
Validation loss decreased (-0.435099 --> -0.564872).  Saving model ...
Epoch: 3 cost time: 1.7463703155517578
Epoch: 3, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.322 Vali Acc: 0.534 Test Loss: 1.322 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.571021318435669
Epoch: 4, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.145 Vali Acc: 0.611 Test Loss: 1.145 Test Acc: 0.611
Validation loss decreased (-0.564872 --> -0.610676).  Saving model ...
Epoch: 5 cost time: 1.598792552947998
Epoch: 5, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.437 Vali Acc: 0.565 Test Loss: 1.437 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7325150966644287
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.791 Vali Acc: 0.550 Test Loss: 1.791 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5837290287017822
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.363 Vali Acc: 0.588 Test Loss: 1.363 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3774008750915527
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.565 Test Loss: 1.690 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6854863166809082
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.959 Vali Acc: 0.542 Test Loss: 1.959 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8784914016723633
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.670 Vali Acc: 0.573 Test Loss: 1.670 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.732811450958252
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.485 Vali Acc: 0.595 Test Loss: 1.485 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.037282943725586
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.913 Vali Acc: 0.550 Test Loss: 1.913 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8167130947113037
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.380 Vali Acc: 0.527 Test Loss: 2.380 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.988680362701416
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.682 Vali Acc: 0.557 Test Loss: 2.682 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 3991813
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.522491693496704
Epoch: 1, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.571 Vali Acc: 0.397 Test Loss: 1.571 Test Acc: 0.397
Validation loss decreased (inf --> -0.396931).  Saving model ...
Epoch: 2 cost time: 1.7559866905212402
Epoch: 2, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.466 Vali Acc: 0.496 Test Loss: 1.466 Test Acc: 0.496
Validation loss decreased (-0.396931 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 1.9524729251861572
Epoch: 3, Steps: 8 | Train Loss: 0.566 Vali Loss: 1.336 Vali Acc: 0.542 Test Loss: 1.336 Test Acc: 0.542
Validation loss decreased (-0.496169 --> -0.541971).  Saving model ...
Epoch: 4 cost time: 1.650390386581421
Epoch: 4, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.389 Vali Acc: 0.534 Test Loss: 1.389 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0148401260375977
Epoch: 5, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.569 Vali Acc: 0.542 Test Loss: 1.569 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8622708320617676
Epoch: 6, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.772 Vali Acc: 0.519 Test Loss: 1.772 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1331090927124023
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.224 Vali Acc: 0.603 Test Loss: 1.224 Test Acc: 0.603
Validation loss decreased (-0.541971 --> -0.603041).  Saving model ...
Epoch: 8 cost time: 1.862666130065918
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.669 Vali Acc: 0.550 Test Loss: 1.669 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5250403881072998
Epoch: 9, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.009 Vali Acc: 0.519 Test Loss: 2.009 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6213006973266602
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.746 Vali Acc: 0.542 Test Loss: 1.746 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2595279216766357
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.306 Vali Acc: 0.534 Test Loss: 2.306 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3668909072875977
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.121 Vali Acc: 0.534 Test Loss: 2.121 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5970172882080078
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.918 Vali Acc: 0.542 Test Loss: 1.918 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7950448989868164
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.563 Vali Acc: 0.534 Test Loss: 2.563 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9559454917907715
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.108 Vali Acc: 0.534 Test Loss: 2.108 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0277767181396484
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.986 Vali Acc: 0.534 Test Loss: 1.986 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6603398323059082
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 3.532 Vali Acc: 0.519 Test Loss: 3.532 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 3799813
model size : 14.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.832834959030151
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.576 Vali Acc: 0.427 Test Loss: 1.576 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.3689618110656738
Epoch: 2, Steps: 8 | Train Loss: 1.256 Vali Loss: 1.542 Vali Acc: 0.450 Test Loss: 1.542 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 2.011321544647217
Epoch: 3, Steps: 8 | Train Loss: 0.735 Vali Loss: 1.457 Vali Acc: 0.481 Test Loss: 1.457 Test Acc: 0.481
Validation loss decreased (-0.450366 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 2.279858350753784
Epoch: 4, Steps: 8 | Train Loss: 0.389 Vali Loss: 1.415 Vali Acc: 0.519 Test Loss: 1.415 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 2.1199722290039062
Epoch: 5, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.412 Vali Acc: 0.519 Test Loss: 1.412 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.5547339916229248
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.538 Vali Acc: 0.519 Test Loss: 1.538 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6480953693389893
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.582 Vali Acc: 0.527 Test Loss: 1.582 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526702).  Saving model ...
Epoch: 8 cost time: 2.143143892288208
Epoch: 8, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.639 Vali Acc: 0.534 Test Loss: 1.639 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534335).  Saving model ...
Epoch: 9 cost time: 1.352720022201538
Epoch: 9, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.599759817123413
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.650 Vali Acc: 0.534 Test Loss: 1.650 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8826804161071777
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.739 Vali Acc: 0.527 Test Loss: 1.739 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5620760917663574
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.830 Vali Acc: 0.519 Test Loss: 1.830 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6652562618255615
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.683 Vali Acc: 0.519 Test Loss: 1.683 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7096142768859863
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.519 Vali Acc: 0.519 Test Loss: 1.519 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6542541980743408
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.558 Vali Acc: 0.527 Test Loss: 1.558 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9037964344024658
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.561 Vali Acc: 0.534 Test Loss: 1.561 Test Acc: 0.534
Validation loss decreased (-0.534335 --> -0.534336).  Saving model ...
Epoch: 17 cost time: 1.50217866897583
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.579 Vali Acc: 0.542 Test Loss: 1.579 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 18 cost time: 1.5267548561096191
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.419 Vali Acc: 0.550 Test Loss: 1.419 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549604).  Saving model ...
Epoch: 19 cost time: 1.7045867443084717
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.829 Vali Acc: 0.527 Test Loss: 1.829 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.031055212020874
Epoch: 20, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.804 Vali Acc: 0.527 Test Loss: 1.804 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3235728740692139
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.644 Vali Acc: 0.519 Test Loss: 1.644 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6813318729400635
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.733 Vali Acc: 0.527 Test Loss: 1.733 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4742329120635986
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.047 Vali Acc: 0.527 Test Loss: 2.047 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8080642223358154
Epoch: 24, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.998 Vali Acc: 0.519 Test Loss: 1.998 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9000766277313232
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.696 Vali Acc: 0.542 Test Loss: 1.696 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.812504768371582
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.043 Vali Acc: 0.534 Test Loss: 2.043 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4539668560028076
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.206 Vali Acc: 0.550 Test Loss: 2.206 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.015105962753296
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.234 Vali Acc: 0.550 Test Loss: 2.234 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 3814917
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.982393503189087
Epoch: 1, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.594 Vali Acc: 0.344 Test Loss: 1.594 Test Acc: 0.344
Validation loss decreased (inf --> -0.343496).  Saving model ...
Epoch: 2 cost time: 1.339869499206543
Epoch: 2, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.515 Vali Acc: 0.443 Test Loss: 1.515 Test Acc: 0.443
Validation loss decreased (-0.343496 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.546558141708374
Epoch: 3, Steps: 8 | Train Loss: 0.799 Vali Loss: 1.402 Vali Acc: 0.542 Test Loss: 1.402 Test Acc: 0.542
Validation loss decreased (-0.442733 --> -0.541971).  Saving model ...
Epoch: 4 cost time: 1.4103493690490723
Epoch: 4, Steps: 8 | Train Loss: 0.450 Vali Loss: 1.343 Vali Acc: 0.519 Test Loss: 1.343 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9305078983306885
Epoch: 5, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.288 Vali Acc: 0.527 Test Loss: 1.288 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.601210355758667
Epoch: 6, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.279 Vali Acc: 0.519 Test Loss: 1.279 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7461795806884766
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5120575428009033
Epoch: 8, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.375 Vali Acc: 0.557 Test Loss: 1.375 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557238).  Saving model ...
Epoch: 9 cost time: 1.5321505069732666
Epoch: 9, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.351 Vali Acc: 0.550 Test Loss: 1.351 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6949501037597656
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.479 Vali Acc: 0.550 Test Loss: 1.479 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5966110229492188
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.678131103515625
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.595 Vali Acc: 0.557 Test Loss: 1.595 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6944735050201416
Epoch: 13, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.502 Vali Acc: 0.557 Test Loss: 1.502 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.46718168258667
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.401 Vali Acc: 0.573 Test Loss: 1.401 Test Acc: 0.573
Validation loss decreased (-0.557238 --> -0.572505).  Saving model ...
Epoch: 15 cost time: 1.503774642944336
Epoch: 15, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.416 Vali Acc: 0.603 Test Loss: 1.416 Test Acc: 0.603
Validation loss decreased (-0.572505 --> -0.603039).  Saving model ...
Epoch: 16 cost time: 1.4673476219177246
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.646 Vali Acc: 0.527 Test Loss: 1.646 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9397790431976318
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.459 Vali Acc: 0.565 Test Loss: 1.459 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5029702186584473
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.551 Vali Acc: 0.550 Test Loss: 1.551 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5831117630004883
Epoch: 19, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.508 Vali Acc: 0.550 Test Loss: 1.508 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8110411167144775
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.361 Vali Acc: 0.588 Test Loss: 1.361 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.630403995513916
Epoch: 21, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.259 Vali Acc: 0.580 Test Loss: 1.259 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3557803630828857
Epoch: 22, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.224 Vali Acc: 0.588 Test Loss: 1.224 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.472109079360962
Epoch: 23, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.267 Vali Acc: 0.588 Test Loss: 1.267 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4749624729156494
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.325 Vali Acc: 0.588 Test Loss: 1.325 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7129364013671875
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.511 Vali Acc: 0.557 Test Loss: 1.511 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 3876357
model size : 14.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7772884368896484
Epoch: 1, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.587 Vali Acc: 0.321 Test Loss: 1.587 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 1.3996686935424805
Epoch: 2, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.558 Vali Acc: 0.458 Test Loss: 1.558 Test Acc: 0.458
Validation loss decreased (-0.320595 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.553450107574463
Epoch: 3, Steps: 8 | Train Loss: 0.911 Vali Loss: 1.525 Vali Acc: 0.473 Test Loss: 1.525 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.4725451469421387
Epoch: 4, Steps: 8 | Train Loss: 0.566 Vali Loss: 1.459 Vali Acc: 0.481 Test Loss: 1.459 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.4249813556671143
Epoch: 5, Steps: 8 | Train Loss: 0.364 Vali Loss: 1.406 Vali Acc: 0.504 Test Loss: 1.406 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 1.402395248413086
Epoch: 6, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 7 cost time: 1.342392921447754
Epoch: 7, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.396 Vali Acc: 0.519 Test Loss: 1.396 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4639501571655273
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8618652820587158
Epoch: 9, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.48880934715271
Epoch: 10, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.356 Vali Acc: 0.542 Test Loss: 1.356 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 11 cost time: 1.6058721542358398
Epoch: 11, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.432 Vali Acc: 0.504 Test Loss: 1.432 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5406546592712402
Epoch: 12, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.402 Vali Acc: 0.519 Test Loss: 1.402 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.37501859664917
Epoch: 13, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.379 Vali Acc: 0.542 Test Loss: 1.379 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6065316200256348
Epoch: 14, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.486 Vali Acc: 0.565 Test Loss: 1.486 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564871).  Saving model ...
Epoch: 15 cost time: 1.7714993953704834
Epoch: 15, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4551167488098145
Epoch: 16, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.486 Vali Acc: 0.527 Test Loss: 1.486 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7050952911376953
Epoch: 17, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.517 Vali Acc: 0.534 Test Loss: 1.517 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3589744567871094
Epoch: 18, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.466 Vali Acc: 0.534 Test Loss: 1.466 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5017261505126953
Epoch: 19, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.415 Vali Acc: 0.527 Test Loss: 1.415 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.669783592224121
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.323 Vali Acc: 0.550 Test Loss: 1.323 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6118488311767578
Epoch: 21, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.373 Vali Acc: 0.557 Test Loss: 1.373 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4573068618774414
Epoch: 22, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.306 Vali Acc: 0.565 Test Loss: 1.306 Test Acc: 0.565
Validation loss decreased (-0.564871 --> -0.564872).  Saving model ...
Epoch: 23 cost time: 1.4221346378326416
Epoch: 23, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.408 Vali Acc: 0.511 Test Loss: 1.408 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0422403812408447
Epoch: 24, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.369 Vali Acc: 0.511 Test Loss: 1.369 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6110546588897705
Epoch: 25, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.331 Vali Acc: 0.542 Test Loss: 1.331 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8152790069580078
Epoch: 26, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.468 Vali Acc: 0.519 Test Loss: 1.468 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4686317443847656
Epoch: 27, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.363 Vali Acc: 0.580 Test Loss: 1.363 Test Acc: 0.580
Validation loss decreased (-0.564872 --> -0.580139).  Saving model ...
Epoch: 28 cost time: 1.662139654159546
Epoch: 28, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.443 Vali Acc: 0.534 Test Loss: 1.443 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0722033977508545
Epoch: 29, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.315 Vali Acc: 0.565 Test Loss: 1.315 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6698529720306396
Epoch: 30, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.627 Vali Acc: 0.519 Test Loss: 1.627 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.916222095489502
Epoch: 31, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.774 Vali Acc: 0.519 Test Loss: 1.774 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5647847652435303
Epoch: 32, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.543 Vali Acc: 0.557 Test Loss: 1.543 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7122704982757568
Epoch: 33, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.796 Vali Acc: 0.534 Test Loss: 1.796 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.695446252822876
Epoch: 34, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.711 Vali Acc: 0.542 Test Loss: 1.711 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0536980628967285
Epoch: 35, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.501 Vali Acc: 0.603 Test Loss: 1.501 Test Acc: 0.603
Validation loss decreased (-0.580139 --> -0.603038).  Saving model ...
Epoch: 36 cost time: 1.7364706993103027
Epoch: 36, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.616 Vali Acc: 0.550 Test Loss: 1.616 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3250186443328857
Epoch: 37, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.704 Vali Acc: 0.542 Test Loss: 1.704 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.9037375450134277
Epoch: 38, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.604 Vali Acc: 0.542 Test Loss: 1.604 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7310736179351807
Epoch: 39, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.448 Vali Acc: 0.573 Test Loss: 1.448 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3642313480377197
Epoch: 40, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.453 Vali Acc: 0.595 Test Loss: 1.453 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.6760344505310059
Epoch: 41, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.870 Vali Acc: 0.519 Test Loss: 1.870 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3461172580718994
Epoch: 42, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.036 Vali Acc: 0.557 Test Loss: 2.036 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.470247507095337
Epoch: 43, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.684 Vali Acc: 0.641 Test Loss: 1.684 Test Acc: 0.641
Validation loss decreased (-0.603038 --> -0.641205).  Saving model ...
Epoch: 44 cost time: 1.6011488437652588
Epoch: 44, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.623 Vali Acc: 0.603 Test Loss: 1.623 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4259977340698242
Epoch: 45, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.501 Vali Acc: 0.603 Test Loss: 1.501 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3508081436157227
Epoch: 46, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.427 Vali Acc: 0.588 Test Loss: 1.427 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.220231533050537
Epoch: 47, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.495 Vali Acc: 0.618 Test Loss: 1.495 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4059383869171143
Epoch: 48, Steps: 8 | Train Loss: 0.036 Vali Loss: 2.138 Vali Acc: 0.511 Test Loss: 2.138 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.6554462909698486
Epoch: 49, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.976 Vali Acc: 0.412 Test Loss: 1.976 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3814020156860352
Epoch: 50, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.722 Vali Acc: 0.557 Test Loss: 1.722 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 4060421
model size : 15.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.507129907608032
Epoch: 1, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.570 Vali Acc: 0.351 Test Loss: 1.570 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.5989892482757568
Epoch: 2, Steps: 8 | Train Loss: 1.231 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
Validation loss decreased (-0.351129 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.5268385410308838
Epoch: 3, Steps: 8 | Train Loss: 0.804 Vali Loss: 1.472 Vali Acc: 0.511 Test Loss: 1.472 Test Acc: 0.511
Validation loss decreased (-0.465634 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.7410216331481934
Epoch: 4, Steps: 8 | Train Loss: 0.467 Vali Loss: 1.422 Vali Acc: 0.511 Test Loss: 1.422 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.7972331047058105
Epoch: 5, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.460 Vali Acc: 0.504 Test Loss: 1.460 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.573817491531372
Epoch: 6, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.466 Vali Acc: 0.519 Test Loss: 1.466 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.6744043827056885
Epoch: 7, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.7687907218933105
Epoch: 8, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.542 Vali Acc: 0.527 Test Loss: 1.542 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.034428119659424
Epoch: 9, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.575 Vali Acc: 0.527 Test Loss: 1.575 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7050418853759766
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.715 Vali Acc: 0.527 Test Loss: 1.715 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9276413917541504
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.514 Vali Acc: 0.565 Test Loss: 1.514 Test Acc: 0.565
Validation loss decreased (-0.526703 --> -0.564870).  Saving model ...
Epoch: 12 cost time: 1.9428684711456299
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.588 Vali Acc: 0.557 Test Loss: 1.588 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8928642272949219
Epoch: 13, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.743 Vali Acc: 0.557 Test Loss: 1.743 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2772271633148193
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.701 Vali Acc: 0.542 Test Loss: 1.701 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6809747219085693
Epoch: 15, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.586 Vali Acc: 0.550 Test Loss: 1.586 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7035319805145264
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.732 Vali Acc: 0.550 Test Loss: 1.732 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0213840007781982
Epoch: 17, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.679 Vali Acc: 0.542 Test Loss: 1.679 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9593238830566406
Epoch: 18, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.492 Vali Acc: 0.527 Test Loss: 1.492 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4969141483306885
Epoch: 19, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.525 Vali Acc: 0.534 Test Loss: 1.525 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.656473159790039
Epoch: 20, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.449 Vali Acc: 0.550 Test Loss: 1.449 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4998993873596191
Epoch: 21, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.363 Vali Acc: 0.534 Test Loss: 1.363 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 4259845
model size : 16.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.565878629684448
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.587 Vali Acc: 0.267 Test Loss: 1.587 Test Acc: 0.267
Validation loss decreased (inf --> -0.267160).  Saving model ...
Epoch: 2 cost time: 1.6639792919158936
Epoch: 2, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.537 Vali Acc: 0.427 Test Loss: 1.537 Test Acc: 0.427
Validation loss decreased (-0.267160 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.9101214408874512
Epoch: 3, Steps: 8 | Train Loss: 0.835 Vali Loss: 1.476 Vali Acc: 0.504 Test Loss: 1.476 Test Acc: 0.504
Validation loss decreased (-0.427466 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 2.072796583175659
Epoch: 4, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.448 Vali Acc: 0.504 Test Loss: 1.448 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503802).  Saving model ...
Epoch: 5 cost time: 1.6857080459594727
Epoch: 5, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.416 Vali Acc: 0.504 Test Loss: 1.416 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 2.400733232498169
Epoch: 6, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0729997158050537
Epoch: 7, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.409 Vali Acc: 0.496 Test Loss: 1.409 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8715465068817139
Epoch: 8, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 2.4462730884552
Epoch: 9, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.429 Vali Acc: 0.496 Test Loss: 1.429 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6537387371063232
Epoch: 10, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.459 Vali Acc: 0.496 Test Loss: 1.459 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4673962593078613
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.439 Vali Acc: 0.511 Test Loss: 1.439 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9011387825012207
Epoch: 12, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.386 Vali Acc: 0.519 Test Loss: 1.386 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 13 cost time: 2.1437461376190186
Epoch: 13, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.463 Vali Acc: 0.511 Test Loss: 1.463 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7222270965576172
Epoch: 14, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.440 Vali Acc: 0.496 Test Loss: 1.440 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.81150221824646
Epoch: 15, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.432 Vali Acc: 0.496 Test Loss: 1.432 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7957711219787598
Epoch: 16, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.405 Vali Acc: 0.496 Test Loss: 1.405 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.763608694076538
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.415 Vali Acc: 0.496 Test Loss: 1.415 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.650665044784546
Epoch: 18, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.426 Vali Acc: 0.489 Test Loss: 1.426 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.512176275253296
Epoch: 19, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.437 Vali Acc: 0.504 Test Loss: 1.437 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7435591220855713
Epoch: 20, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.466 Vali Acc: 0.466 Test Loss: 1.466 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1288442611694336
Epoch: 21, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.522 Vali Acc: 0.466 Test Loss: 1.522 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.599364995956421
Epoch: 22, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.517 Vali Acc: 0.481 Test Loss: 1.517 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 4482309
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.9097888469696045
Epoch: 1, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.565 Vali Acc: 0.427 Test Loss: 1.565 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.7373390197753906
Epoch: 2, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.490 Vali Acc: 0.473 Test Loss: 1.490 Test Acc: 0.473
Validation loss decreased (-0.427465 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.8955936431884766
Epoch: 3, Steps: 8 | Train Loss: 0.591 Vali Loss: 1.303 Vali Acc: 0.519 Test Loss: 1.303 Test Acc: 0.519
Validation loss decreased (-0.473268 --> -0.519071).  Saving model ...
Epoch: 4 cost time: 1.713252067565918
Epoch: 4, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.232 Vali Acc: 0.542 Test Loss: 1.232 Test Acc: 0.542
Validation loss decreased (-0.519071 --> -0.541972).  Saving model ...
Epoch: 5 cost time: 1.9105002880096436
Epoch: 5, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.530 Vali Acc: 0.527 Test Loss: 1.530 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5862164497375488
Epoch: 6, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.637 Vali Acc: 0.527 Test Loss: 1.637 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7130913734436035
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.314 Vali Acc: 0.580 Test Loss: 1.314 Test Acc: 0.580
Validation loss decreased (-0.541972 --> -0.580140).  Saving model ...
Epoch: 8 cost time: 2.073418617248535
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.764 Vali Acc: 0.527 Test Loss: 1.764 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.543386697769165
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.907 Vali Acc: 0.519 Test Loss: 1.907 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8536088466644287
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.701 Vali Acc: 0.557 Test Loss: 1.701 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9804985523223877
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.807 Vali Acc: 0.550 Test Loss: 1.807 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4102230072021484
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.802 Vali Acc: 0.550 Test Loss: 1.802 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7694196701049805
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.771 Vali Acc: 0.557 Test Loss: 1.771 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0187530517578125
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.789 Vali Acc: 0.550 Test Loss: 1.789 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.972748041152954
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.676 Vali Acc: 0.588 Test Loss: 1.676 Test Acc: 0.588
Validation loss decreased (-0.580140 --> -0.587769).  Saving model ...
Epoch: 16 cost time: 1.7497994899749756
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.565 Test Loss: 1.789 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.236720323562622
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.966 Vali Acc: 0.565 Test Loss: 1.966 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1109957695007324
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.171 Vali Acc: 0.542 Test Loss: 2.171 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8113579750061035
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.159 Vali Acc: 0.534 Test Loss: 2.159 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.731553316116333
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.128 Vali Acc: 0.534 Test Loss: 2.128 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9841182231903076
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.131 Vali Acc: 0.557 Test Loss: 2.131 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2434709072113037
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.557 Test Loss: 2.136 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0074679851531982
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.072 Vali Acc: 0.565 Test Loss: 2.072 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.033815622329712
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.115 Vali Acc: 0.565 Test Loss: 2.115 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.831925630569458
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.138 Vali Acc: 0.565 Test Loss: 2.138 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1209477
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9637396335601807
Epoch: 1, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.614 Vali Acc: 0.321 Test Loss: 1.614 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 1.3258047103881836
Epoch: 2, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.540 Vali Acc: 0.450 Test Loss: 1.540 Test Acc: 0.450
Validation loss decreased (-0.320595 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.6585547924041748
Epoch: 3, Steps: 8 | Train Loss: 0.881 Vali Loss: 1.432 Vali Acc: 0.489 Test Loss: 1.432 Test Acc: 0.489
Validation loss decreased (-0.450366 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.6150000095367432
Epoch: 4, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.328 Vali Acc: 0.534 Test Loss: 1.328 Test Acc: 0.534
Validation loss decreased (-0.488535 --> -0.534338).  Saving model ...
Epoch: 5 cost time: 1.3811111450195312
Epoch: 5, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.276 Vali Acc: 0.519 Test Loss: 1.276 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7794907093048096
Epoch: 6, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.376 Vali Acc: 0.519 Test Loss: 1.376 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7784106731414795
Epoch: 7, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4022743701934814
Epoch: 8, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.405 Vali Acc: 0.511 Test Loss: 1.405 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6648907661437988
Epoch: 9, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.482 Vali Acc: 0.511 Test Loss: 1.482 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.312983751296997
Epoch: 10, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.430 Vali Acc: 0.534 Test Loss: 1.430 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3485825061798096
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.478 Vali Acc: 0.511 Test Loss: 1.478 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.926290512084961
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.530 Vali Acc: 0.527 Test Loss: 1.530 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7349886894226074
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.727 Vali Acc: 0.527 Test Loss: 1.727 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.338881492614746
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.605 Vali Acc: 0.527 Test Loss: 1.605 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1113477
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.55626106262207
Epoch: 1, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.7734460830688477
Epoch: 2, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.569 Vali Acc: 0.427 Test Loss: 1.569 Test Acc: 0.427
Validation loss decreased (-0.259526 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.5154857635498047
Epoch: 3, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.528 Vali Acc: 0.443 Test Loss: 1.528 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.7909703254699707
Epoch: 4, Steps: 8 | Train Loss: 0.702 Vali Loss: 1.408 Vali Acc: 0.504 Test Loss: 1.408 Test Acc: 0.504
Validation loss decreased (-0.442733 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.490560531616211
Epoch: 5, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.319 Vali Acc: 0.519 Test Loss: 1.319 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519071).  Saving model ...
Epoch: 6 cost time: 1.378293752670288
Epoch: 6, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 7 cost time: 1.7141425609588623
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.660682201385498
Epoch: 8, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5944476127624512
Epoch: 9, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.512 Vali Acc: 0.519 Test Loss: 1.512 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5249545574188232
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6112213134765625
Epoch: 11, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.461 Vali Acc: 0.527 Test Loss: 1.461 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7920012474060059
Epoch: 12, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.435 Vali Acc: 0.534 Test Loss: 1.435 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.8910129070281982
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.548 Vali Acc: 0.527 Test Loss: 1.548 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7366609573364258
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.589 Vali Acc: 0.527 Test Loss: 1.589 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3788704872131348
Epoch: 15, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.911849021911621
Epoch: 16, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9140455722808838
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.437 Vali Acc: 0.534 Test Loss: 1.437 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8979322910308838
Epoch: 18, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.462 Vali Acc: 0.534 Test Loss: 1.462 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8153624534606934
Epoch: 19, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.577 Vali Acc: 0.519 Test Loss: 1.577 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1727654933929443
Epoch: 20, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.450 Vali Acc: 0.519 Test Loss: 1.450 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8831229209899902
Epoch: 21, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.322 Vali Acc: 0.580 Test Loss: 1.322 Test Acc: 0.580
Validation loss decreased (-0.534337 --> -0.580139).  Saving model ...
Epoch: 22 cost time: 2.2109792232513428
Epoch: 22, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.338 Vali Acc: 0.565 Test Loss: 1.338 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.246396780014038
Epoch: 23, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.544 Vali Acc: 0.527 Test Loss: 1.544 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6102919578552246
Epoch: 24, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.585 Vali Acc: 0.519 Test Loss: 1.585 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3703174591064453
Epoch: 25, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.393 Vali Acc: 0.534 Test Loss: 1.393 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9629566669464111
Epoch: 26, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.562 Vali Acc: 0.519 Test Loss: 1.562 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.857973575592041
Epoch: 27, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.471 Vali Acc: 0.550 Test Loss: 1.471 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.190305471420288
Epoch: 28, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.279 Vali Acc: 0.573 Test Loss: 1.279 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.375906229019165
Epoch: 29, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.419 Vali Acc: 0.580 Test Loss: 1.419 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.882199764251709
Epoch: 30, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.525 Vali Acc: 0.565 Test Loss: 1.525 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6211638450622559
Epoch: 31, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.443 Vali Acc: 0.573 Test Loss: 1.443 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1121029
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.209344863891602
Epoch: 1, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.619 Vali Acc: 0.290 Test Loss: 1.619 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.5235586166381836
Epoch: 2, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.590 Vali Acc: 0.450 Test Loss: 1.590 Test Acc: 0.450
Validation loss decreased (-0.290060 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.3148059844970703
Epoch: 3, Steps: 8 | Train Loss: 1.130 Vali Loss: 1.527 Vali Acc: 0.511 Test Loss: 1.527 Test Acc: 0.511
Validation loss decreased (-0.450366 --> -0.511435).  Saving model ...
Epoch: 4 cost time: 1.3734965324401855
Epoch: 4, Steps: 8 | Train Loss: 0.784 Vali Loss: 1.427 Vali Acc: 0.557 Test Loss: 1.427 Test Acc: 0.557
Validation loss decreased (-0.511435 --> -0.557238).  Saving model ...
Epoch: 5 cost time: 1.4456968307495117
Epoch: 5, Steps: 8 | Train Loss: 0.528 Vali Loss: 1.364 Vali Acc: 0.565 Test Loss: 1.364 Test Acc: 0.565
Validation loss decreased (-0.557238 --> -0.564872).  Saving model ...
Epoch: 6 cost time: 1.5537238121032715
Epoch: 6, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.353 Vali Acc: 0.550 Test Loss: 1.353 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6252789497375488
Epoch: 7, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.337 Vali Acc: 0.557 Test Loss: 1.337 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0361881256103516
Epoch: 8, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5235705375671387
Epoch: 9, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.421 Vali Acc: 0.588 Test Loss: 1.421 Test Acc: 0.588
Validation loss decreased (-0.564872 --> -0.587772).  Saving model ...
Epoch: 10 cost time: 2.1567022800445557
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.423 Vali Acc: 0.550 Test Loss: 1.423 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7258403301239014
Epoch: 11, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.442 Vali Acc: 0.550 Test Loss: 1.442 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5412182807922363
Epoch: 12, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.520 Vali Acc: 0.550 Test Loss: 1.520 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.62678861618042
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.671 Vali Acc: 0.542 Test Loss: 1.671 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7992422580718994
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.592 Vali Acc: 0.557 Test Loss: 1.592 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4878535270690918
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.494 Vali Acc: 0.588 Test Loss: 1.494 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6517469882965088
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.453 Vali Acc: 0.588 Test Loss: 1.453 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6846473217010498
Epoch: 17, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.823 Vali Acc: 0.534 Test Loss: 1.823 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8378584384918213
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.507 Vali Acc: 0.588 Test Loss: 1.507 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5620625019073486
Epoch: 19, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.578 Vali Acc: 0.588 Test Loss: 1.578 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1151749
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.692704439163208
Epoch: 1, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.640 Vali Acc: 0.206 Test Loss: 1.640 Test Acc: 0.206
Validation loss decreased (inf --> -0.206090).  Saving model ...
Epoch: 2 cost time: 1.5058279037475586
Epoch: 2, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.604 Vali Acc: 0.443 Test Loss: 1.604 Test Acc: 0.443
Validation loss decreased (-0.206090 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.5550601482391357
Epoch: 3, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.549 Vali Acc: 0.550 Test Loss: 1.549 Test Acc: 0.550
Validation loss decreased (-0.442732 --> -0.549603).  Saving model ...
Epoch: 4 cost time: 1.8532745838165283
Epoch: 4, Steps: 8 | Train Loss: 0.866 Vali Loss: 1.476 Vali Acc: 0.542 Test Loss: 1.476 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.106266498565674
Epoch: 5, Steps: 8 | Train Loss: 0.638 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5609147548675537
Epoch: 6, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5047178268432617
Epoch: 7, Steps: 8 | Train Loss: 0.349 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.728912591934204
Epoch: 8, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7071588039398193
Epoch: 9, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.313 Vali Acc: 0.519 Test Loss: 1.313 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6596870422363281
Epoch: 10, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.366 Vali Acc: 0.519 Test Loss: 1.366 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8681910037994385
Epoch: 11, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7767441272735596
Epoch: 12, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.411 Vali Acc: 0.557 Test Loss: 1.411 Test Acc: 0.557
Validation loss decreased (-0.549603 --> -0.557238).  Saving model ...
Epoch: 13 cost time: 2.1315250396728516
Epoch: 13, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.386 Vali Acc: 0.527 Test Loss: 1.386 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.854778528213501
Epoch: 14, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.399 Vali Acc: 0.519 Test Loss: 1.399 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3640918731689453
Epoch: 15, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.376 Vali Acc: 0.519 Test Loss: 1.376 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5491688251495361
Epoch: 16, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.338 Vali Acc: 0.534 Test Loss: 1.338 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9119210243225098
Epoch: 17, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.418 Vali Acc: 0.534 Test Loss: 1.418 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5518455505371094
Epoch: 18, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5339789390563965
Epoch: 19, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.424 Vali Acc: 0.519 Test Loss: 1.424 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.702195405960083
Epoch: 20, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.405 Vali Acc: 0.519 Test Loss: 1.405 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.69688081741333
Epoch: 21, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.350 Vali Acc: 0.519 Test Loss: 1.350 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.577437400817871
Epoch: 22, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.391 Vali Acc: 0.519 Test Loss: 1.391 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 1243781
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.960971117019653
Epoch: 1, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.616 Vali Acc: 0.160 Test Loss: 1.616 Test Acc: 0.160
Validation loss decreased (inf --> -0.160289).  Saving model ...
Epoch: 2 cost time: 1.574051856994629
Epoch: 2, Steps: 8 | Train Loss: 1.475 Vali Loss: 1.566 Vali Acc: 0.282 Test Loss: 1.566 Test Acc: 0.282
Validation loss decreased (-0.160289 --> -0.282427).  Saving model ...
Epoch: 3 cost time: 1.8412058353424072
Epoch: 3, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.467 Vali Acc: 0.481 Test Loss: 1.467 Test Acc: 0.481
Validation loss decreased (-0.282427 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.4819695949554443
Epoch: 4, Steps: 8 | Train Loss: 0.809 Vali Loss: 1.393 Vali Acc: 0.542 Test Loss: 1.393 Test Acc: 0.542
Validation loss decreased (-0.480901 --> -0.541971).  Saving model ...
Epoch: 5 cost time: 1.8731708526611328
Epoch: 5, Steps: 8 | Train Loss: 0.536 Vali Loss: 1.355 Vali Acc: 0.557 Test Loss: 1.355 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557238).  Saving model ...
Epoch: 6 cost time: 1.4489693641662598
Epoch: 6, Steps: 8 | Train Loss: 0.366 Vali Loss: 1.283 Vali Acc: 0.557 Test Loss: 1.283 Test Acc: 0.557
Validation loss decreased (-0.557238 --> -0.557239).  Saving model ...
Epoch: 7 cost time: 1.7353510856628418
Epoch: 7, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.285 Vali Acc: 0.580 Test Loss: 1.285 Test Acc: 0.580
Validation loss decreased (-0.557239 --> -0.580140).  Saving model ...
Epoch: 8 cost time: 1.9659857749938965
Epoch: 8, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.414 Vali Acc: 0.573 Test Loss: 1.414 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.052125930786133
Epoch: 9, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.446 Vali Acc: 0.580 Test Loss: 1.446 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3349511623382568
Epoch: 10, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.451 Vali Acc: 0.557 Test Loss: 1.451 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4071803092956543
Epoch: 11, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.355 Vali Acc: 0.588 Test Loss: 1.355 Test Acc: 0.588
Validation loss decreased (-0.580140 --> -0.587773).  Saving model ...
Epoch: 12 cost time: 1.7687528133392334
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.320 Vali Acc: 0.565 Test Loss: 1.320 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7503221035003662
Epoch: 13, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.415 Vali Acc: 0.580 Test Loss: 1.415 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.443390130996704
Epoch: 14, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.287 Vali Acc: 0.573 Test Loss: 1.287 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5875887870788574
Epoch: 15, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.287 Vali Acc: 0.588 Test Loss: 1.287 Test Acc: 0.588
Validation loss decreased (-0.587773 --> -0.587773).  Saving model ...
Epoch: 16 cost time: 1.4057672023773193
Epoch: 16, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.256 Vali Acc: 0.588 Test Loss: 1.256 Test Acc: 0.588
Validation loss decreased (-0.587773 --> -0.587774).  Saving model ...
Epoch: 17 cost time: 1.6540205478668213
Epoch: 17, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.267 Vali Acc: 0.573 Test Loss: 1.267 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5619988441467285
Epoch: 18, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2252154350280762
Epoch: 19, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.402 Vali Acc: 0.550 Test Loss: 1.402 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2922520637512207
Epoch: 20, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.444 Vali Acc: 0.557 Test Loss: 1.444 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5697417259216309
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.274 Vali Acc: 0.588 Test Loss: 1.274 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5126566886901855
Epoch: 22, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.267 Vali Acc: 0.580 Test Loss: 1.267 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4981184005737305
Epoch: 23, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.338 Vali Acc: 0.588 Test Loss: 1.338 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9019403457641602
Epoch: 24, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.427 Vali Acc: 0.618 Test Loss: 1.427 Test Acc: 0.618
Validation loss decreased (-0.587774 --> -0.618306).  Saving model ...
Epoch: 25 cost time: 1.6855885982513428
Epoch: 25, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.556 Vali Acc: 0.611 Test Loss: 1.556 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3563556671142578
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.565 Vali Acc: 0.573 Test Loss: 1.565 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3697490692138672
Epoch: 27, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.499 Vali Acc: 0.573 Test Loss: 1.499 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.450427770614624
Epoch: 28, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.482 Vali Acc: 0.573 Test Loss: 1.482 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.734619379043579
Epoch: 29, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.349 Vali Acc: 0.595 Test Loss: 1.349 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6580877304077148
Epoch: 30, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.270 Vali Acc: 0.595 Test Loss: 1.270 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.384873628616333
Epoch: 31, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.339 Vali Acc: 0.580 Test Loss: 1.339 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.161604404449463
Epoch: 32, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.287 Vali Acc: 0.580 Test Loss: 1.287 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6151998043060303
Epoch: 33, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.366 Vali Acc: 0.618 Test Loss: 1.366 Test Acc: 0.618
Validation loss decreased (-0.618306 --> -0.618307).  Saving model ...
Epoch: 34 cost time: 1.3111460208892822
Epoch: 34, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.484 Vali Acc: 0.595 Test Loss: 1.484 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6750786304473877
Epoch: 35, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.363 Vali Acc: 0.588 Test Loss: 1.363 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7149202823638916
Epoch: 36, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.426 Vali Acc: 0.588 Test Loss: 1.426 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6687097549438477
Epoch: 37, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.468 Vali Acc: 0.603 Test Loss: 1.468 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4870059490203857
Epoch: 38, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.439 Vali Acc: 0.611 Test Loss: 1.439 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2948601245880127
Epoch: 39, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.503 Vali Acc: 0.588 Test Loss: 1.503 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.5735962390899658
Epoch: 40, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.862 Vali Acc: 0.542 Test Loss: 1.862 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.1631886959075928
Epoch: 41, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.785 Vali Acc: 0.557 Test Loss: 1.785 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.671731948852539
Epoch: 42, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.588 Vali Acc: 0.595 Test Loss: 1.588 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4318063259124756
Epoch: 43, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.513 Vali Acc: 0.542 Test Loss: 1.513 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 1343493
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.960940837860107
Epoch: 1, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.593 Vali Acc: 0.351 Test Loss: 1.593 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.4199693202972412
Epoch: 2, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.570 Vali Acc: 0.427 Test Loss: 1.570 Test Acc: 0.427
Validation loss decreased (-0.351129 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.4354557991027832
Epoch: 3, Steps: 8 | Train Loss: 1.086 Vali Loss: 1.571 Vali Acc: 0.450 Test Loss: 1.571 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.3028175830841064
Epoch: 4, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.549 Vali Acc: 0.473 Test Loss: 1.549 Test Acc: 0.473
Validation loss decreased (-0.450366 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.715214490890503
Epoch: 5, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.531 Vali Acc: 0.489 Test Loss: 1.531 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 1.525184154510498
Epoch: 6, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.502 Vali Acc: 0.489 Test Loss: 1.502 Test Acc: 0.489
Validation loss decreased (-0.488534 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.3951196670532227
Epoch: 7, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.456 Vali Acc: 0.511 Test Loss: 1.456 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.7264518737792969
Epoch: 8, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.442 Vali Acc: 0.511 Test Loss: 1.442 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.6582703590393066
Epoch: 9, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.508 Vali Acc: 0.504 Test Loss: 1.508 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7364826202392578
Epoch: 10, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.489 Vali Acc: 0.489 Test Loss: 1.489 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8667099475860596
Epoch: 11, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.463 Vali Acc: 0.511 Test Loss: 1.463 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.642979621887207
Epoch: 12, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.418 Vali Acc: 0.511 Test Loss: 1.418 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 1.6412577629089355
Epoch: 13, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.444 Vali Acc: 0.504 Test Loss: 1.444 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6704013347625732
Epoch: 14, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.424 Vali Acc: 0.519 Test Loss: 1.424 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.8207688331604004
Epoch: 15, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.401 Vali Acc: 0.511 Test Loss: 1.401 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0988757610321045
Epoch: 16, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.411 Vali Acc: 0.511 Test Loss: 1.411 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9897692203521729
Epoch: 17, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7342519760131836
Epoch: 18, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.481 Vali Acc: 0.458 Test Loss: 1.481 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6749961376190186
Epoch: 19, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.509 Vali Acc: 0.458 Test Loss: 1.509 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8265526294708252
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.497 Vali Acc: 0.443 Test Loss: 1.497 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9507055282592773
Epoch: 21, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.555 Vali Acc: 0.450 Test Loss: 1.555 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.641409158706665
Epoch: 22, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.549 Vali Acc: 0.481 Test Loss: 1.549 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8498196601867676
Epoch: 23, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.517 Vali Acc: 0.466 Test Loss: 1.517 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8691353797912598
Epoch: 24, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.523 Vali Acc: 0.481 Test Loss: 1.523 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1454725
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7339823246002197
Epoch: 1, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.605 Vali Acc: 0.328 Test Loss: 1.605 Test Acc: 0.328
Validation loss decreased (inf --> -0.328228).  Saving model ...
Epoch: 2 cost time: 1.461385726928711
Epoch: 2, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.328228 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7145729064941406
Epoch: 3, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.425 Vali Acc: 0.481 Test Loss: 1.425 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.8368029594421387
Epoch: 4, Steps: 8 | Train Loss: 0.573 Vali Loss: 1.338 Vali Acc: 0.511 Test Loss: 1.338 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 1.4967732429504395
Epoch: 5, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526705).  Saving model ...
Epoch: 6 cost time: 1.5457005500793457
Epoch: 6, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.299 Vali Acc: 0.527 Test Loss: 1.299 Test Acc: 0.527
Validation loss decreased (-0.526705 --> -0.526705).  Saving model ...
Epoch: 7 cost time: 1.6768081188201904
Epoch: 7, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.447 Vali Acc: 0.527 Test Loss: 1.447 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0394928455352783
Epoch: 8, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.653 Vali Acc: 0.527 Test Loss: 1.653 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5535619258880615
Epoch: 9, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5067813396453857
Epoch: 10, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.701 Vali Acc: 0.527 Test Loss: 1.701 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5648713111877441
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7789349555969238
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8740954399108887
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.480 Vali Acc: 0.527 Test Loss: 1.480 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5888798236846924
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.460 Vali Acc: 0.527 Test Loss: 1.460 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.808133602142334
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.672 Vali Acc: 0.527 Test Loss: 1.672 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8961400985717773
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.857 Vali Acc: 0.527 Test Loss: 1.857 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 408133
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.117001533508301
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.590 Vali Acc: 0.336 Test Loss: 1.590 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.546952247619629
Epoch: 2, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.546 Vali Acc: 0.435 Test Loss: 1.546 Test Acc: 0.435
Validation loss decreased (-0.335862 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.3705103397369385
Epoch: 3, Steps: 8 | Train Loss: 1.164 Vali Loss: 1.500 Vali Acc: 0.443 Test Loss: 1.500 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.2075378894805908
Epoch: 4, Steps: 8 | Train Loss: 0.892 Vali Loss: 1.400 Vali Acc: 0.489 Test Loss: 1.400 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.2196228504180908
Epoch: 5, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.346 Vali Acc: 0.511 Test Loss: 1.346 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.3860876560211182
Epoch: 6, Steps: 8 | Train Loss: 0.438 Vali Loss: 1.317 Vali Acc: 0.504 Test Loss: 1.317 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2985215187072754
Epoch: 7, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.255 Vali Acc: 0.527 Test Loss: 1.255 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526705).  Saving model ...
Epoch: 8 cost time: 1.317441701889038
Epoch: 8, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.387 Vali Acc: 0.519 Test Loss: 1.387 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2379834651947021
Epoch: 9, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.462 Vali Acc: 0.519 Test Loss: 1.462 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4915533065795898
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.538 Vali Acc: 0.519 Test Loss: 1.538 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.304041862487793
Epoch: 11, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.518 Vali Acc: 0.519 Test Loss: 1.518 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2174255847930908
Epoch: 12, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.422 Vali Acc: 0.527 Test Loss: 1.422 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2468814849853516
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.480 Vali Acc: 0.542 Test Loss: 1.480 Test Acc: 0.542
Validation loss decreased (-0.526705 --> -0.541970).  Saving model ...
Epoch: 14 cost time: 1.5176255702972412
Epoch: 14, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.630 Vali Acc: 0.519 Test Loss: 1.630 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.373060941696167
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.703 Vali Acc: 0.519 Test Loss: 1.703 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4018487930297852
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.511 Vali Acc: 0.519 Test Loss: 1.511 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.383765459060669
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4882454872131348
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.47975492477417
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.727 Vali Acc: 0.519 Test Loss: 1.727 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4377505779266357
Epoch: 20, Steps: 8 | Train Loss: 0.036 Vali Loss: 2.017 Vali Acc: 0.519 Test Loss: 2.017 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9205076694488525
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.852 Vali Acc: 0.534 Test Loss: 1.852 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4314067363739014
Epoch: 22, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.772 Vali Acc: 0.534 Test Loss: 1.772 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3069188594818115
Epoch: 23, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.787 Vali Acc: 0.519 Test Loss: 1.787 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 360133
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.295145273208618
Epoch: 1, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.608 Vali Acc: 0.298 Test Loss: 1.608 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.7773997783660889
Epoch: 2, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.570 Vali Acc: 0.344 Test Loss: 1.570 Test Acc: 0.344
Validation loss decreased (-0.297694 --> -0.343496).  Saving model ...
Epoch: 3 cost time: 1.6533405780792236
Epoch: 3, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.526 Vali Acc: 0.412 Test Loss: 1.526 Test Acc: 0.412
Validation loss decreased (-0.343496 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.3836045265197754
Epoch: 4, Steps: 8 | Train Loss: 1.071 Vali Loss: 1.501 Vali Acc: 0.450 Test Loss: 1.501 Test Acc: 0.450
Validation loss decreased (-0.412198 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.6314682960510254
Epoch: 5, Steps: 8 | Train Loss: 0.811 Vali Loss: 1.437 Vali Acc: 0.481 Test Loss: 1.437 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.6154768466949463
Epoch: 6, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.368 Vali Acc: 0.519 Test Loss: 1.368 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.8288919925689697
Epoch: 7, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.401 Vali Acc: 0.466 Test Loss: 1.401 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9898731708526611
Epoch: 8, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.442 Vali Acc: 0.496 Test Loss: 1.442 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5419957637786865
Epoch: 9, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.412 Vali Acc: 0.511 Test Loss: 1.412 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5777292251586914
Epoch: 10, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.491 Vali Acc: 0.519 Test Loss: 1.491 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4239799976348877
Epoch: 11, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.558 Vali Acc: 0.519 Test Loss: 1.558 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.468883991241455
Epoch: 12, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.447 Vali Acc: 0.519 Test Loss: 1.447 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.449997901916504
Epoch: 13, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.505 Vali Acc: 0.534 Test Loss: 1.505 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534336).  Saving model ...
Epoch: 14 cost time: 1.1422429084777832
Epoch: 14, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.525 Vali Acc: 0.534 Test Loss: 1.525 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4687035083770752
Epoch: 15, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.716 Vali Acc: 0.511 Test Loss: 1.716 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.513188123703003
Epoch: 16, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.427 Vali Acc: 0.519 Test Loss: 1.427 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.738271713256836
Epoch: 17, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.388 Vali Acc: 0.542 Test Loss: 1.388 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541971).  Saving model ...
Epoch: 18 cost time: 1.708343505859375
Epoch: 18, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.398 Vali Acc: 0.527 Test Loss: 1.398 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6325199604034424
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.396 Vali Acc: 0.542 Test Loss: 1.396 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9766128063201904
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.340 Vali Acc: 0.565 Test Loss: 1.340 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564872).  Saving model ...
Epoch: 21 cost time: 1.345654010772705
Epoch: 21, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.403 Vali Acc: 0.573 Test Loss: 1.403 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
Epoch: 22 cost time: 2.003634452819824
Epoch: 22, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.495 Vali Acc: 0.557 Test Loss: 1.495 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6391379833221436
Epoch: 23, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.544 Vali Acc: 0.542 Test Loss: 1.544 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7448322772979736
Epoch: 24, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9471807479858398
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.490 Vali Acc: 0.542 Test Loss: 1.490 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.673670768737793
Epoch: 26, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.449 Vali Acc: 0.550 Test Loss: 1.449 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6893887519836426
Epoch: 27, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.471 Vali Acc: 0.550 Test Loss: 1.471 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.759854793548584
Epoch: 28, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.478 Vali Acc: 0.534 Test Loss: 1.478 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7059047222137451
Epoch: 29, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.629 Vali Acc: 0.519 Test Loss: 1.629 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.320582866668701
Epoch: 30, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.536 Vali Acc: 0.542 Test Loss: 1.536 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6577930450439453
Epoch: 31, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.591 Vali Acc: 0.573 Test Loss: 1.591 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 363909
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.291724920272827
Epoch: 1, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.608 Vali Acc: 0.191 Test Loss: 1.608 Test Acc: 0.191
Validation loss decreased (inf --> -0.190824).  Saving model ...
Epoch: 2 cost time: 1.6508407592773438
Epoch: 2, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.564 Vali Acc: 0.282 Test Loss: 1.564 Test Acc: 0.282
Validation loss decreased (-0.190824 --> -0.282427).  Saving model ...
Epoch: 3 cost time: 1.7219963073730469
Epoch: 3, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.524 Vali Acc: 0.389 Test Loss: 1.524 Test Acc: 0.389
Validation loss decreased (-0.282427 --> -0.389298).  Saving model ...
Epoch: 4 cost time: 1.5709209442138672
Epoch: 4, Steps: 8 | Train Loss: 1.086 Vali Loss: 1.497 Vali Acc: 0.412 Test Loss: 1.497 Test Acc: 0.412
Validation loss decreased (-0.389298 --> -0.412199).  Saving model ...
Epoch: 5 cost time: 1.9114151000976562
Epoch: 5, Steps: 8 | Train Loss: 0.886 Vali Loss: 1.449 Vali Acc: 0.481 Test Loss: 1.449 Test Acc: 0.481
Validation loss decreased (-0.412199 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.5631976127624512
Epoch: 6, Steps: 8 | Train Loss: 0.694 Vali Loss: 1.369 Vali Acc: 0.542 Test Loss: 1.369 Test Acc: 0.542
Validation loss decreased (-0.480902 --> -0.541971).  Saving model ...
Epoch: 7 cost time: 1.610107421875
Epoch: 7, Steps: 8 | Train Loss: 0.528 Vali Loss: 1.300 Vali Acc: 0.573 Test Loss: 1.300 Test Acc: 0.573
Validation loss decreased (-0.541971 --> -0.572506).  Saving model ...
Epoch: 8 cost time: 1.1326370239257812
Epoch: 8, Steps: 8 | Train Loss: 0.399 Vali Loss: 1.259 Vali Acc: 0.519 Test Loss: 1.259 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7177271842956543
Epoch: 9, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.286 Vali Acc: 0.534 Test Loss: 1.286 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4270434379577637
Epoch: 10, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.241 Vali Acc: 0.542 Test Loss: 1.241 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7732229232788086
Epoch: 11, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.220 Vali Acc: 0.542 Test Loss: 1.220 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.376370906829834
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.284 Vali Acc: 0.527 Test Loss: 1.284 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.352649450302124
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.287 Vali Acc: 0.542 Test Loss: 1.287 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.287006139755249
Epoch: 14, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.234 Vali Acc: 0.534 Test Loss: 1.234 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4467124938964844
Epoch: 15, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5817146301269531
Epoch: 16, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.325 Vali Acc: 0.542 Test Loss: 1.325 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.553992748260498
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.280 Vali Acc: 0.550 Test Loss: 1.280 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 379269
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.488390922546387
Epoch: 1, Steps: 8 | Train Loss: 1.689 Vali Loss: 1.606 Vali Acc: 0.198 Test Loss: 1.606 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 1.4563007354736328
Epoch: 2, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.575 Vali Acc: 0.313 Test Loss: 1.575 Test Acc: 0.313
Validation loss decreased (-0.198457 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.3293919563293457
Epoch: 3, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.552 Vali Acc: 0.435 Test Loss: 1.552 Test Acc: 0.435
Validation loss decreased (-0.312961 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.37380051612854
Epoch: 4, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.526 Vali Acc: 0.489 Test Loss: 1.526 Test Acc: 0.489
Validation loss decreased (-0.435099 --> -0.488534).  Saving model ...
Epoch: 5 cost time: 1.5398173332214355
Epoch: 5, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.496 Vali Acc: 0.481 Test Loss: 1.496 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3468387126922607
Epoch: 6, Steps: 8 | Train Loss: 0.699 Vali Loss: 1.478 Vali Acc: 0.496 Test Loss: 1.478 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496168).  Saving model ...
Epoch: 7 cost time: 1.6271088123321533
Epoch: 7, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.436 Vali Acc: 0.504 Test Loss: 1.436 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 1.3249297142028809
Epoch: 8, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.394 Vali Acc: 0.534 Test Loss: 1.394 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.3804140090942383
Epoch: 9, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3089613914489746
Epoch: 10, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.377 Vali Acc: 0.519 Test Loss: 1.377 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4513750076293945
Epoch: 11, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.350 Vali Acc: 0.519 Test Loss: 1.350 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.712921380996704
Epoch: 12, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.342 Vali Acc: 0.519 Test Loss: 1.342 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3943374156951904
Epoch: 13, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.356 Vali Acc: 0.519 Test Loss: 1.356 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3597559928894043
Epoch: 14, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.332 Vali Acc: 0.519 Test Loss: 1.332 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.724074125289917
Epoch: 15, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.340 Vali Acc: 0.519 Test Loss: 1.340 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3648490905761719
Epoch: 16, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.335 Vali Acc: 0.542 Test Loss: 1.335 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 17 cost time: 1.526977777481079
Epoch: 17, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.305 Vali Acc: 0.519 Test Loss: 1.305 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6523549556732178
Epoch: 18, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.304149866104126
Epoch: 19, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.422 Vali Acc: 0.519 Test Loss: 1.422 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.531590461730957
Epoch: 20, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.346 Vali Acc: 0.542 Test Loss: 1.346 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6243185997009277
Epoch: 21, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.360 Vali Acc: 0.527 Test Loss: 1.360 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5981714725494385
Epoch: 22, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5738716125488281
Epoch: 23, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.402 Vali Acc: 0.519 Test Loss: 1.402 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1765012741088867
Epoch: 24, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.400 Vali Acc: 0.504 Test Loss: 1.400 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6464204788208008
Epoch: 25, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.351 Vali Acc: 0.519 Test Loss: 1.351 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3986141681671143
Epoch: 26, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.330 Vali Acc: 0.527 Test Loss: 1.330 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 425285
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.369081497192383
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.556 Vali Acc: 0.328 Test Loss: 1.556 Test Acc: 0.328
Validation loss decreased (inf --> -0.328229).  Saving model ...
Epoch: 2 cost time: 1.341510534286499
Epoch: 2, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.518 Vali Acc: 0.389 Test Loss: 1.518 Test Acc: 0.389
Validation loss decreased (-0.328229 --> -0.389298).  Saving model ...
Epoch: 3 cost time: 1.2005970478057861
Epoch: 3, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.479 Vali Acc: 0.427 Test Loss: 1.479 Test Acc: 0.427
Validation loss decreased (-0.389298 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.6058549880981445
Epoch: 4, Steps: 8 | Train Loss: 1.034 Vali Loss: 1.448 Vali Acc: 0.450 Test Loss: 1.448 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.2620747089385986
Epoch: 5, Steps: 8 | Train Loss: 0.779 Vali Loss: 1.416 Vali Acc: 0.466 Test Loss: 1.416 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465635).  Saving model ...
Epoch: 6 cost time: 1.7104308605194092
Epoch: 6, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.416 Vali Acc: 0.489 Test Loss: 1.416 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.4161148071289062
Epoch: 7, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.448 Vali Acc: 0.504 Test Loss: 1.448 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 1.332653284072876
Epoch: 8, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.465 Vali Acc: 0.504 Test Loss: 1.465 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9427435398101807
Epoch: 9, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.407 Vali Acc: 0.519 Test Loss: 1.407 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.2331125736236572
Epoch: 10, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.396 Vali Acc: 0.519 Test Loss: 1.396 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.40049409866333
Epoch: 11, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.400 Vali Acc: 0.511 Test Loss: 1.400 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.611698865890503
Epoch: 12, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.378 Vali Acc: 0.511 Test Loss: 1.378 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5605621337890625
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.454 Vali Acc: 0.511 Test Loss: 1.454 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.470454454421997
Epoch: 14, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.450 Vali Acc: 0.511 Test Loss: 1.450 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8356285095214844
Epoch: 15, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.375 Vali Acc: 0.511 Test Loss: 1.375 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8899519443511963
Epoch: 16, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.318 Vali Acc: 0.519 Test Loss: 1.318 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519071).  Saving model ...
Epoch: 17 cost time: 1.6236724853515625
Epoch: 17, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.349 Vali Acc: 0.519 Test Loss: 1.349 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5986428260803223
Epoch: 18, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.366 Vali Acc: 0.519 Test Loss: 1.366 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.530062198638916
Epoch: 19, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.403 Vali Acc: 0.534 Test Loss: 1.403 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534337).  Saving model ...
Epoch: 20 cost time: 1.5193290710449219
Epoch: 20, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.903379201889038
Epoch: 21, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.563 Vali Acc: 0.511 Test Loss: 1.563 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.604851245880127
Epoch: 22, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.421 Vali Acc: 0.511 Test Loss: 1.421 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.646256923675537
Epoch: 23, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6795527935028076
Epoch: 24, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.378 Vali Acc: 0.534 Test Loss: 1.378 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 25 cost time: 1.5533761978149414
Epoch: 25, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.447 Vali Acc: 0.534 Test Loss: 1.447 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.584913969039917
Epoch: 26, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.525 Vali Acc: 0.519 Test Loss: 1.525 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6415815353393555
Epoch: 27, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.496 Vali Acc: 0.511 Test Loss: 1.496 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3612229824066162
Epoch: 28, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.398 Vali Acc: 0.550 Test Loss: 1.398 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 29 cost time: 1.3940348625183105
Epoch: 29, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.477 Vali Acc: 0.542 Test Loss: 1.477 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4011688232421875
Epoch: 30, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.426 Vali Acc: 0.527 Test Loss: 1.426 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5093472003936768
Epoch: 31, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.444 Vali Acc: 0.511 Test Loss: 1.444 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6172940731048584
Epoch: 32, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.284 Vali Acc: 0.534 Test Loss: 1.284 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2701010704040527
Epoch: 33, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.376 Vali Acc: 0.557 Test Loss: 1.376 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557238).  Saving model ...
Epoch: 34 cost time: 1.1654846668243408
Epoch: 34, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.405 Vali Acc: 0.534 Test Loss: 1.405 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3034369945526123
Epoch: 35, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.389 Vali Acc: 0.557 Test Loss: 1.389 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6526281833648682
Epoch: 36, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.324 Vali Acc: 0.557 Test Loss: 1.324 Test Acc: 0.557
Validation loss decreased (-0.557238 --> -0.557239).  Saving model ...
Epoch: 37 cost time: 1.2221860885620117
Epoch: 37, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.330 Vali Acc: 0.557 Test Loss: 1.330 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3097608089447021
Epoch: 38, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.292 Vali Acc: 0.542 Test Loss: 1.292 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3908956050872803
Epoch: 39, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.393 Vali Acc: 0.573 Test Loss: 1.393 Test Acc: 0.573
Validation loss decreased (-0.557239 --> -0.572505).  Saving model ...
Epoch: 40 cost time: 1.4666616916656494
Epoch: 40, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.390 Vali Acc: 0.557 Test Loss: 1.390 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3686301708221436
Epoch: 41, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.437 Vali Acc: 0.557 Test Loss: 1.437 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5326461791992188
Epoch: 42, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.359 Vali Acc: 0.557 Test Loss: 1.359 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4714972972869873
Epoch: 43, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.351 Vali Acc: 0.542 Test Loss: 1.351 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.568145990371704
Epoch: 44, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.489 Vali Acc: 0.557 Test Loss: 1.489 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3250231742858887
Epoch: 45, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.464 Vali Acc: 0.565 Test Loss: 1.464 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.383918285369873
Epoch: 46, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.360 Vali Acc: 0.550 Test Loss: 1.360 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3328864574432373
Epoch: 47, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.386 Vali Acc: 0.542 Test Loss: 1.386 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3574399948120117
Epoch: 48, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.432 Vali Acc: 0.534 Test Loss: 1.432 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2849178314208984
Epoch: 49, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.613 Vali Acc: 0.542 Test Loss: 1.613 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 475141
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.329984188079834
Epoch: 1, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.620 Vali Acc: 0.122 Test Loss: 1.620 Test Acc: 0.122
Validation loss decreased (inf --> -0.122121).  Saving model ...
Epoch: 2 cost time: 1.3634579181671143
Epoch: 2, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.605 Vali Acc: 0.237 Test Loss: 1.605 Test Acc: 0.237
Validation loss decreased (-0.122121 --> -0.236625).  Saving model ...
Epoch: 3 cost time: 1.138432502746582
Epoch: 3, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.593 Vali Acc: 0.328 Test Loss: 1.593 Test Acc: 0.328
Validation loss decreased (-0.236625 --> -0.328228).  Saving model ...
Epoch: 4 cost time: 1.1640493869781494
Epoch: 4, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.575 Vali Acc: 0.412 Test Loss: 1.575 Test Acc: 0.412
Validation loss decreased (-0.328228 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 1.3516809940338135
Epoch: 5, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.535 Vali Acc: 0.473 Test Loss: 1.535 Test Acc: 0.473
Validation loss decreased (-0.412198 --> -0.473267).  Saving model ...
Epoch: 6 cost time: 1.4070491790771484
Epoch: 6, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.509 Vali Acc: 0.511 Test Loss: 1.509 Test Acc: 0.511
Validation loss decreased (-0.473267 --> -0.511435).  Saving model ...
Epoch: 7 cost time: 1.2712221145629883
Epoch: 7, Steps: 8 | Train Loss: 0.626 Vali Loss: 1.472 Vali Acc: 0.496 Test Loss: 1.472 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5043230056762695
Epoch: 8, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.492 Vali Acc: 0.511 Test Loss: 1.492 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511435).  Saving model ...
Epoch: 9 cost time: 1.2463581562042236
Epoch: 9, Steps: 8 | Train Loss: 0.462 Vali Loss: 1.453 Vali Acc: 0.511 Test Loss: 1.453 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.4704110622406006
Epoch: 10, Steps: 8 | Train Loss: 0.379 Vali Loss: 1.424 Vali Acc: 0.519 Test Loss: 1.424 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.1888604164123535
Epoch: 11, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 1.2636828422546387
Epoch: 12, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0597195625305176
Epoch: 13, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.434 Vali Acc: 0.519 Test Loss: 1.434 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3489093780517578
Epoch: 14, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.411 Vali Acc: 0.519 Test Loss: 1.411 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1554605960845947
Epoch: 15, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1456012725830078
Epoch: 16, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.430 Vali Acc: 0.504 Test Loss: 1.430 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4977185726165771
Epoch: 17, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.444 Vali Acc: 0.519 Test Loss: 1.444 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3798823356628418
Epoch: 18, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.423 Vali Acc: 0.519 Test Loss: 1.423 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5517511367797852
Epoch: 19, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.430 Vali Acc: 0.511 Test Loss: 1.430 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3189952373504639
Epoch: 20, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.478391408920288
Epoch: 21, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.415 Vali Acc: 0.504 Test Loss: 1.415 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 530757
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6186532974243164
Epoch: 1, Steps: 8 | Train Loss: 1.665 Vali Loss: 1.592 Vali Acc: 0.374 Test Loss: 1.592 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.5396125316619873
Epoch: 2, Steps: 8 | Train Loss: 1.473 Vali Loss: 1.545 Vali Acc: 0.405 Test Loss: 1.545 Test Acc: 0.405
Validation loss decreased (-0.374030 --> -0.404565).  Saving model ...
Epoch: 3 cost time: 1.7370538711547852
Epoch: 3, Steps: 8 | Train Loss: 1.254 Vali Loss: 1.486 Vali Acc: 0.412 Test Loss: 1.486 Test Acc: 0.412
Validation loss decreased (-0.404565 --> -0.412199).  Saving model ...
Epoch: 4 cost time: 1.273632526397705
Epoch: 4, Steps: 8 | Train Loss: 0.969 Vali Loss: 1.396 Vali Acc: 0.466 Test Loss: 1.396 Test Acc: 0.466
Validation loss decreased (-0.412199 --> -0.465635).  Saving model ...
Epoch: 5 cost time: 1.3217308521270752
Epoch: 5, Steps: 8 | Train Loss: 0.697 Vali Loss: 1.319 Vali Acc: 0.481 Test Loss: 1.319 Test Acc: 0.481
Validation loss decreased (-0.465635 --> -0.480903).  Saving model ...
Epoch: 6 cost time: 1.621805191040039
Epoch: 6, Steps: 8 | Train Loss: 0.492 Vali Loss: 1.353 Vali Acc: 0.473 Test Loss: 1.353 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4445626735687256
Epoch: 7, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.310 Vali Acc: 0.527 Test Loss: 1.310 Test Acc: 0.527
Validation loss decreased (-0.480903 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.6513514518737793
Epoch: 8, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.353 Vali Acc: 0.527 Test Loss: 1.353 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8165152072906494
Epoch: 9, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.391 Vali Acc: 0.527 Test Loss: 1.391 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4904837608337402
Epoch: 10, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.463 Vali Acc: 0.527 Test Loss: 1.463 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4238052368164062
Epoch: 11, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4409899711608887
Epoch: 12, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5667221546173096
Epoch: 13, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.508 Vali Acc: 0.519 Test Loss: 1.508 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9721543788909912
Epoch: 14, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.536 Vali Acc: 0.534 Test Loss: 1.536 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534336).  Saving model ...
Epoch: 15 cost time: 1.1698064804077148
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.523 Vali Acc: 0.527 Test Loss: 1.523 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4341130256652832
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.637 Vali Acc: 0.519 Test Loss: 1.637 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5664892196655273
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.547 Vali Acc: 0.519 Test Loss: 1.547 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7029838562011719
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.373 Vali Acc: 0.542 Test Loss: 1.373 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541971).  Saving model ...
Epoch: 19 cost time: 1.2208952903747559
Epoch: 19, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.622 Vali Acc: 0.527 Test Loss: 1.622 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.522620439529419
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.765 Vali Acc: 0.527 Test Loss: 1.765 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4179878234863281
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.978 Vali Acc: 0.534 Test Loss: 1.978 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5334455966949463
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.890 Vali Acc: 0.534 Test Loss: 1.890 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.323178768157959
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.865 Vali Acc: 0.527 Test Loss: 1.865 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4946281909942627
Epoch: 24, Steps: 8 | Train Loss: 0.034 Vali Loss: 2.046 Vali Acc: 0.519 Test Loss: 2.046 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3282604217529297
Epoch: 25, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.005 Vali Acc: 0.519 Test Loss: 2.005 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6559250354766846
Epoch: 26, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.878 Vali Acc: 0.511 Test Loss: 1.878 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4605598449707031
Epoch: 27, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.906 Vali Acc: 0.511 Test Loss: 1.906 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4940176010131836
Epoch: 28, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.995 Vali Acc: 0.519 Test Loss: 1.995 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 154917
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.78074312210083
Epoch: 1, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.584 Vali Acc: 0.313 Test Loss: 1.584 Test Acc: 0.313
Validation loss decreased (inf --> -0.312961).  Saving model ...
Epoch: 2 cost time: 1.5655832290649414
Epoch: 2, Steps: 8 | Train Loss: 1.520 Vali Loss: 1.543 Vali Acc: 0.420 Test Loss: 1.543 Test Acc: 0.420
Validation loss decreased (-0.312961 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4511237144470215
Epoch: 3, Steps: 8 | Train Loss: 1.324 Vali Loss: 1.491 Vali Acc: 0.427 Test Loss: 1.491 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.2977354526519775
Epoch: 4, Steps: 8 | Train Loss: 1.195 Vali Loss: 1.445 Vali Acc: 0.435 Test Loss: 1.445 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.6717517375946045
Epoch: 5, Steps: 8 | Train Loss: 1.020 Vali Loss: 1.403 Vali Acc: 0.481 Test Loss: 1.403 Test Acc: 0.481
Validation loss decreased (-0.435100 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.2555439472198486
Epoch: 6, Steps: 8 | Train Loss: 0.788 Vali Loss: 1.376 Vali Acc: 0.481 Test Loss: 1.376 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 1.3302028179168701
Epoch: 7, Steps: 8 | Train Loss: 0.642 Vali Loss: 1.359 Vali Acc: 0.481 Test Loss: 1.359 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 8 cost time: 1.2683079242706299
Epoch: 8, Steps: 8 | Train Loss: 0.508 Vali Loss: 1.319 Vali Acc: 0.519 Test Loss: 1.319 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519071).  Saving model ...
Epoch: 9 cost time: 1.3742644786834717
Epoch: 9, Steps: 8 | Train Loss: 0.370 Vali Loss: 1.301 Vali Acc: 0.542 Test Loss: 1.301 Test Acc: 0.542
Validation loss decreased (-0.519071 --> -0.541972).  Saving model ...
Epoch: 10 cost time: 1.5026047229766846
Epoch: 10, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.321 Vali Acc: 0.534 Test Loss: 1.321 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3405249118804932
Epoch: 11, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.330 Vali Acc: 0.534 Test Loss: 1.330 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3197822570800781
Epoch: 12, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.375 Vali Acc: 0.527 Test Loss: 1.375 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.422727346420288
Epoch: 13, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.345 Vali Acc: 0.519 Test Loss: 1.345 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.38458251953125
Epoch: 14, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.360 Vali Acc: 0.527 Test Loss: 1.360 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1491518020629883
Epoch: 15, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.451 Vali Acc: 0.534 Test Loss: 1.451 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3562862873077393
Epoch: 16, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.472 Vali Acc: 0.519 Test Loss: 1.472 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5089902877807617
Epoch: 17, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4539265632629395
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.531 Vali Acc: 0.519 Test Loss: 1.531 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.394399642944336
Epoch: 19, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.420 Vali Acc: 0.557 Test Loss: 1.420 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557238).  Saving model ...
Epoch: 20 cost time: 1.5393624305725098
Epoch: 20, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.474 Vali Acc: 0.534 Test Loss: 1.474 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.532576322555542
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5308210849761963
Epoch: 22, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.466 Vali Acc: 0.519 Test Loss: 1.466 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6518480777740479
Epoch: 23, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.469 Vali Acc: 0.519 Test Loss: 1.469 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6527390480041504
Epoch: 24, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.400 Vali Acc: 0.542 Test Loss: 1.400 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3854954242706299
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.376 Vali Acc: 0.542 Test Loss: 1.376 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3769805431365967
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.639 Vali Acc: 0.527 Test Loss: 1.639 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.79966139793396
Epoch: 27, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.469 Vali Acc: 0.534 Test Loss: 1.469 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4123542308807373
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.292771577835083
Epoch: 29, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.641 Vali Acc: 0.519 Test Loss: 1.641 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 130917
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.4618144035339355
Epoch: 1, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.594 Vali Acc: 0.221 Test Loss: 1.594 Test Acc: 0.221
Validation loss decreased (inf --> -0.221358).  Saving model ...
Epoch: 2 cost time: 1.865849494934082
Epoch: 2, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.571 Vali Acc: 0.313 Test Loss: 1.571 Test Acc: 0.313
Validation loss decreased (-0.221358 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.638916015625
Epoch: 3, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
Validation loss decreased (-0.312961 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.8092989921569824
Epoch: 4, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.502 Vali Acc: 0.443 Test Loss: 1.502 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.8965532779693604
Epoch: 5, Steps: 8 | Train Loss: 1.129 Vali Loss: 1.479 Vali Acc: 0.458 Test Loss: 1.479 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.2816331386566162
Epoch: 6, Steps: 8 | Train Loss: 0.933 Vali Loss: 1.471 Vali Acc: 0.458 Test Loss: 1.471 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458001).  Saving model ...
Epoch: 7 cost time: 1.3149337768554688
Epoch: 7, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.444 Vali Acc: 0.473 Test Loss: 1.444 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.2603909969329834
Epoch: 8, Steps: 8 | Train Loss: 0.696 Vali Loss: 1.401 Vali Acc: 0.489 Test Loss: 1.401 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 9 cost time: 1.5172348022460938
Epoch: 9, Steps: 8 | Train Loss: 0.570 Vali Loss: 1.383 Vali Acc: 0.481 Test Loss: 1.383 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8262302875518799
Epoch: 10, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.392 Vali Acc: 0.481 Test Loss: 1.392 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6010127067565918
Epoch: 11, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.335 Vali Acc: 0.504 Test Loss: 1.335 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.474480390548706
Epoch: 12, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.389 Vali Acc: 0.511 Test Loss: 1.389 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 1.3767120838165283
Epoch: 13, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.388 Vali Acc: 0.496 Test Loss: 1.388 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9491221904754639
Epoch: 14, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.420 Vali Acc: 0.511 Test Loss: 1.420 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.834265947341919
Epoch: 15, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.436 Vali Acc: 0.519 Test Loss: 1.436 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 1.6098480224609375
Epoch: 16, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 17 cost time: 1.9225544929504395
Epoch: 17, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.549199104309082
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.495 Vali Acc: 0.519 Test Loss: 1.495 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.560349464416504
Epoch: 19, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.486 Vali Acc: 0.519 Test Loss: 1.486 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3911616802215576
Epoch: 20, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.750427007675171
Epoch: 21, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.465 Vali Acc: 0.519 Test Loss: 1.465 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5835041999816895
Epoch: 22, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.494 Vali Acc: 0.519 Test Loss: 1.494 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8167715072631836
Epoch: 23, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.719 Vali Acc: 0.519 Test Loss: 1.719 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.671489953994751
Epoch: 24, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.621 Vali Acc: 0.519 Test Loss: 1.621 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6667416095733643
Epoch: 25, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
Validation loss decreased (-0.526703 --> -0.549604).  Saving model ...
Epoch: 26 cost time: 1.7406704425811768
Epoch: 26, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6349403858184814
Epoch: 27, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.705 Vali Acc: 0.519 Test Loss: 1.705 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5792815685272217
Epoch: 28, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6417300701141357
Epoch: 29, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.537 Vali Acc: 0.527 Test Loss: 1.537 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.652498722076416
Epoch: 30, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.499 Vali Acc: 0.519 Test Loss: 1.499 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.413722276687622
Epoch: 31, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.483 Vali Acc: 0.534 Test Loss: 1.483 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.349963903427124
Epoch: 32, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.510 Vali Acc: 0.534 Test Loss: 1.510 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7219867706298828
Epoch: 33, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.513 Vali Acc: 0.534 Test Loss: 1.513 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7442948818206787
Epoch: 34, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.555 Vali Acc: 0.527 Test Loss: 1.555 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.042304754257202
Epoch: 35, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.596 Vali Acc: 0.527 Test Loss: 1.596 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 132805
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7897768020629883
Epoch: 1, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.626 Vali Acc: 0.267 Test Loss: 1.626 Test Acc: 0.267
Validation loss decreased (inf --> -0.267159).  Saving model ...
Epoch: 2 cost time: 1.532879114151001
Epoch: 2, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.602 Vali Acc: 0.321 Test Loss: 1.602 Test Acc: 0.321
Validation loss decreased (-0.267159 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.9266760349273682
Epoch: 3, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.570 Vali Acc: 0.366 Test Loss: 1.570 Test Acc: 0.366
Validation loss decreased (-0.320595 --> -0.366397).  Saving model ...
Epoch: 4 cost time: 1.5642435550689697
Epoch: 4, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
Validation loss decreased (-0.366397 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.6754837036132812
Epoch: 5, Steps: 8 | Train Loss: 1.101 Vali Loss: 1.553 Vali Acc: 0.435 Test Loss: 1.553 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.6571722030639648
Epoch: 6, Steps: 8 | Train Loss: 0.988 Vali Loss: 1.529 Vali Acc: 0.450 Test Loss: 1.529 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450366).  Saving model ...
Epoch: 7 cost time: 1.5199546813964844
Epoch: 7, Steps: 8 | Train Loss: 0.825 Vali Loss: 1.462 Vali Acc: 0.458 Test Loss: 1.462 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 1.6986815929412842
Epoch: 8, Steps: 8 | Train Loss: 0.708 Vali Loss: 1.448 Vali Acc: 0.473 Test Loss: 1.448 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 1.5976719856262207
Epoch: 9, Steps: 8 | Train Loss: 0.600 Vali Loss: 1.408 Vali Acc: 0.534 Test Loss: 1.408 Test Acc: 0.534
Validation loss decreased (-0.473268 --> -0.534337).  Saving model ...
Epoch: 10 cost time: 1.3117237091064453
Epoch: 10, Steps: 8 | Train Loss: 0.499 Vali Loss: 1.350 Vali Acc: 0.511 Test Loss: 1.350 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0214591026306152
Epoch: 11, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.363 Vali Acc: 0.504 Test Loss: 1.363 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9566304683685303
Epoch: 12, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.368 Vali Acc: 0.504 Test Loss: 1.368 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6176526546478271
Epoch: 13, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.349 Vali Acc: 0.527 Test Loss: 1.349 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5563724040985107
Epoch: 14, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.307 Vali Acc: 0.542 Test Loss: 1.307 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541972).  Saving model ...
Epoch: 15 cost time: 1.609375
Epoch: 15, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.315 Vali Acc: 0.542 Test Loss: 1.315 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8578636646270752
Epoch: 16, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.355 Vali Acc: 0.534 Test Loss: 1.355 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.589216947555542
Epoch: 17, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.364 Vali Acc: 0.534 Test Loss: 1.364 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9732975959777832
Epoch: 18, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.378 Vali Acc: 0.542 Test Loss: 1.378 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7764387130737305
Epoch: 19, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.368 Vali Acc: 0.542 Test Loss: 1.368 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9509272575378418
Epoch: 20, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.440 Vali Acc: 0.557 Test Loss: 1.440 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557238).  Saving model ...
Epoch: 21 cost time: 2.087252616882324
Epoch: 21, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.329 Vali Acc: 0.580 Test Loss: 1.329 Test Acc: 0.580
Validation loss decreased (-0.557238 --> -0.580139).  Saving model ...
Epoch: 22 cost time: 1.6751906871795654
Epoch: 22, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.287 Vali Acc: 0.557 Test Loss: 1.287 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.861457109451294
Epoch: 23, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.342 Vali Acc: 0.557 Test Loss: 1.342 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8733859062194824
Epoch: 24, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.510 Vali Acc: 0.542 Test Loss: 1.510 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.029686212539673
Epoch: 25, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.382 Vali Acc: 0.550 Test Loss: 1.382 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.23945689201355
Epoch: 26, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.379 Vali Acc: 0.542 Test Loss: 1.379 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.204409122467041
Epoch: 27, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.307 Vali Acc: 0.580 Test Loss: 1.307 Test Acc: 0.580
Validation loss decreased (-0.580139 --> -0.580140).  Saving model ...
Epoch: 28 cost time: 2.031275749206543
Epoch: 28, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.325 Vali Acc: 0.588 Test Loss: 1.325 Test Acc: 0.588
Validation loss decreased (-0.580140 --> -0.587773).  Saving model ...
Epoch: 29 cost time: 1.776688575744629
Epoch: 29, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.250 Vali Acc: 0.603 Test Loss: 1.250 Test Acc: 0.603
Validation loss decreased (-0.587773 --> -0.603041).  Saving model ...
Epoch: 30 cost time: 1.5709428787231445
Epoch: 30, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.367 Vali Acc: 0.565 Test Loss: 1.367 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.029557466506958
Epoch: 31, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.387 Vali Acc: 0.573 Test Loss: 1.387 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3586399555206299
Epoch: 32, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.342 Vali Acc: 0.557 Test Loss: 1.342 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9114580154418945
Epoch: 33, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.328 Vali Acc: 0.557 Test Loss: 1.328 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2442519664764404
Epoch: 34, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.446 Vali Acc: 0.573 Test Loss: 1.446 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2570178508758545
Epoch: 35, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.485 Vali Acc: 0.595 Test Loss: 1.485 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.59859037399292
Epoch: 36, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.475 Vali Acc: 0.588 Test Loss: 1.475 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5441515445709229
Epoch: 37, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.421 Vali Acc: 0.588 Test Loss: 1.421 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.5524868965148926
Epoch: 38, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.342 Vali Acc: 0.595 Test Loss: 1.342 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7324292659759521
Epoch: 39, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.303 Vali Acc: 0.588 Test Loss: 1.303 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 140485
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.350897789001465
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.661 Vali Acc: 0.206 Test Loss: 1.661 Test Acc: 0.206
Validation loss decreased (inf --> -0.206090).  Saving model ...
Epoch: 2 cost time: 1.3237707614898682
Epoch: 2, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.652 Vali Acc: 0.328 Test Loss: 1.652 Test Acc: 0.328
Validation loss decreased (-0.206090 --> -0.328228).  Saving model ...
Epoch: 3 cost time: 1.4749209880828857
Epoch: 3, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.646 Vali Acc: 0.374 Test Loss: 1.646 Test Acc: 0.374
Validation loss decreased (-0.328228 --> -0.374029).  Saving model ...
Epoch: 4 cost time: 1.7789111137390137
Epoch: 4, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.614 Vali Acc: 0.450 Test Loss: 1.614 Test Acc: 0.450
Validation loss decreased (-0.374029 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.3707726001739502
Epoch: 5, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.597 Vali Acc: 0.458 Test Loss: 1.597 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.457999).  Saving model ...
Epoch: 6 cost time: 1.350900411605835
Epoch: 6, Steps: 8 | Train Loss: 1.005 Vali Loss: 1.564 Vali Acc: 0.435 Test Loss: 1.564 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.20835280418396
Epoch: 7, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.525 Vali Acc: 0.466 Test Loss: 1.525 Test Acc: 0.466
Validation loss decreased (-0.457999 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.1939985752105713
Epoch: 8, Steps: 8 | Train Loss: 0.767 Vali Loss: 1.503 Vali Acc: 0.481 Test Loss: 1.503 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.3749284744262695
Epoch: 9, Steps: 8 | Train Loss: 0.650 Vali Loss: 1.487 Vali Acc: 0.481 Test Loss: 1.487 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.3376104831695557
Epoch: 10, Steps: 8 | Train Loss: 0.574 Vali Loss: 1.458 Vali Acc: 0.511 Test Loss: 1.458 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 11 cost time: 1.4233715534210205
Epoch: 11, Steps: 8 | Train Loss: 0.540 Vali Loss: 1.481 Vali Acc: 0.511 Test Loss: 1.481 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3510768413543701
Epoch: 12, Steps: 8 | Train Loss: 0.488 Vali Loss: 1.459 Vali Acc: 0.489 Test Loss: 1.459 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1820335388183594
Epoch: 13, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.446 Vali Acc: 0.519 Test Loss: 1.446 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.325145959854126
Epoch: 14, Steps: 8 | Train Loss: 0.395 Vali Loss: 1.402 Vali Acc: 0.519 Test Loss: 1.402 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.2300238609313965
Epoch: 15, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.418 Vali Acc: 0.504 Test Loss: 1.418 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6104185581207275
Epoch: 16, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.459 Vali Acc: 0.534 Test Loss: 1.459 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 17 cost time: 1.438427448272705
Epoch: 17, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.415 Vali Acc: 0.511 Test Loss: 1.415 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1302037239074707
Epoch: 18, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.403 Vali Acc: 0.527 Test Loss: 1.403 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.261850118637085
Epoch: 19, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.375 Vali Acc: 0.527 Test Loss: 1.375 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.392702579498291
Epoch: 20, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.369 Vali Acc: 0.519 Test Loss: 1.369 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.476928949356079
Epoch: 21, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1681125164031982
Epoch: 22, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4266667366027832
Epoch: 23, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3745534420013428
Epoch: 24, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.427 Vali Acc: 0.527 Test Loss: 1.427 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5489022731781006
Epoch: 25, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2140026092529297
Epoch: 26, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 163493
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.499173879623413
Epoch: 1, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.603 Vali Acc: 0.290 Test Loss: 1.603 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.2259399890899658
Epoch: 2, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.588 Vali Acc: 0.336 Test Loss: 1.588 Test Acc: 0.336
Validation loss decreased (-0.290060 --> -0.335862).  Saving model ...
Epoch: 3 cost time: 1.398848056793213
Epoch: 3, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.567 Vali Acc: 0.374 Test Loss: 1.567 Test Acc: 0.374
Validation loss decreased (-0.335862 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 1.3544490337371826
Epoch: 4, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.558 Vali Acc: 0.382 Test Loss: 1.558 Test Acc: 0.382
Validation loss decreased (-0.374030 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 1.1345088481903076
Epoch: 5, Steps: 8 | Train Loss: 1.113 Vali Loss: 1.537 Vali Acc: 0.405 Test Loss: 1.537 Test Acc: 0.405
Validation loss decreased (-0.381664 --> -0.404565).  Saving model ...
Epoch: 6 cost time: 1.3278355598449707
Epoch: 6, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.530 Vali Acc: 0.435 Test Loss: 1.530 Test Acc: 0.435
Validation loss decreased (-0.404565 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 1.0490069389343262
Epoch: 7, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.452 Vali Acc: 0.466 Test Loss: 1.452 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.4533586502075195
Epoch: 8, Steps: 8 | Train Loss: 0.695 Vali Loss: 1.431 Vali Acc: 0.481 Test Loss: 1.431 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.0495495796203613
Epoch: 9, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.401 Vali Acc: 0.496 Test Loss: 1.401 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.2574889659881592
Epoch: 10, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.416029691696167
Epoch: 11, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.353 Vali Acc: 0.534 Test Loss: 1.353 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 12 cost time: 1.4208135604858398
Epoch: 12, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.336 Vali Acc: 0.511 Test Loss: 1.336 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.54660964012146
Epoch: 13, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.316 Vali Acc: 0.542 Test Loss: 1.316 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 14 cost time: 1.169677495956421
Epoch: 14, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.289 Vali Acc: 0.534 Test Loss: 1.289 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3587229251861572
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.286 Vali Acc: 0.550 Test Loss: 1.286 Test Acc: 0.550
Validation loss decreased (-0.541972 --> -0.549605).  Saving model ...
Epoch: 16 cost time: 1.4540812969207764
Epoch: 16, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.317 Vali Acc: 0.557 Test Loss: 1.317 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 17 cost time: 1.3555686473846436
Epoch: 17, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.352 Vali Acc: 0.534 Test Loss: 1.352 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.557342767715454
Epoch: 18, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.357 Vali Acc: 0.550 Test Loss: 1.357 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7416234016418457
Epoch: 19, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.353 Vali Acc: 0.550 Test Loss: 1.353 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8449389934539795
Epoch: 20, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.339 Vali Acc: 0.573 Test Loss: 1.339 Test Acc: 0.573
Validation loss decreased (-0.557239 --> -0.572506).  Saving model ...
Epoch: 21 cost time: 1.53717041015625
Epoch: 21, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.312 Vali Acc: 0.565 Test Loss: 1.312 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4096293449401855
Epoch: 22, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.299 Vali Acc: 0.565 Test Loss: 1.299 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4842665195465088
Epoch: 23, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.302 Vali Acc: 0.565 Test Loss: 1.302 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5883548259735107
Epoch: 24, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.302 Vali Acc: 0.611 Test Loss: 1.302 Test Acc: 0.611
Validation loss decreased (-0.572506 --> -0.610674).  Saving model ...
Epoch: 25 cost time: 1.2725224494934082
Epoch: 25, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.357 Vali Acc: 0.573 Test Loss: 1.357 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.234619140625
Epoch: 26, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.347 Vali Acc: 0.557 Test Loss: 1.347 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.404956579208374
Epoch: 27, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3111121654510498
Epoch: 28, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.442 Vali Acc: 0.565 Test Loss: 1.442 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4312057495117188
Epoch: 29, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.371 Vali Acc: 0.580 Test Loss: 1.371 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.371347427368164
Epoch: 30, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.414 Vali Acc: 0.573 Test Loss: 1.414 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4153077602386475
Epoch: 31, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.362 Vali Acc: 0.580 Test Loss: 1.362 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4097297191619873
Epoch: 32, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.394 Vali Acc: 0.588 Test Loss: 1.394 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4651134014129639
Epoch: 33, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.340 Vali Acc: 0.557 Test Loss: 1.340 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4019355773925781
Epoch: 34, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.377 Vali Acc: 0.534 Test Loss: 1.377 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 188421
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5700790882110596
Epoch: 1, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.600 Vali Acc: 0.176 Test Loss: 1.600 Test Acc: 0.176
Validation loss decreased (inf --> -0.175557).  Saving model ...
Epoch: 2 cost time: 1.2234177589416504
Epoch: 2, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.580 Vali Acc: 0.298 Test Loss: 1.580 Test Acc: 0.298
Validation loss decreased (-0.175557 --> -0.297694).  Saving model ...
Epoch: 3 cost time: 1.333632230758667
Epoch: 3, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.566 Vali Acc: 0.328 Test Loss: 1.566 Test Acc: 0.328
Validation loss decreased (-0.297694 --> -0.328229).  Saving model ...
Epoch: 4 cost time: 1.4643385410308838
Epoch: 4, Steps: 8 | Train Loss: 1.142 Vali Loss: 1.559 Vali Acc: 0.374 Test Loss: 1.559 Test Acc: 0.374
Validation loss decreased (-0.328229 --> -0.374030).  Saving model ...
Epoch: 5 cost time: 1.1450259685516357
Epoch: 5, Steps: 8 | Train Loss: 0.989 Vali Loss: 1.546 Vali Acc: 0.435 Test Loss: 1.546 Test Acc: 0.435
Validation loss decreased (-0.374030 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.3401801586151123
Epoch: 6, Steps: 8 | Train Loss: 0.889 Vali Loss: 1.527 Vali Acc: 0.427 Test Loss: 1.527 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3510849475860596
Epoch: 7, Steps: 8 | Train Loss: 0.755 Vali Loss: 1.501 Vali Acc: 0.450 Test Loss: 1.501 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.489530324935913
Epoch: 8, Steps: 8 | Train Loss: 0.695 Vali Loss: 1.505 Vali Acc: 0.466 Test Loss: 1.505 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.4050066471099854
Epoch: 9, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.486 Vali Acc: 0.473 Test Loss: 1.486 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 10 cost time: 1.2370376586914062
Epoch: 10, Steps: 8 | Train Loss: 0.564 Vali Loss: 1.461 Vali Acc: 0.504 Test Loss: 1.461 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.1839876174926758
Epoch: 11, Steps: 8 | Train Loss: 0.538 Vali Loss: 1.494 Vali Acc: 0.481 Test Loss: 1.494 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3278489112854004
Epoch: 12, Steps: 8 | Train Loss: 0.451 Vali Loss: 1.462 Vali Acc: 0.496 Test Loss: 1.462 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3187930583953857
Epoch: 13, Steps: 8 | Train Loss: 0.441 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 14 cost time: 1.530897855758667
Epoch: 14, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.459 Vali Acc: 0.496 Test Loss: 1.459 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.551447868347168
Epoch: 15, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.430 Vali Acc: 0.511 Test Loss: 1.430 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3634066581726074
Epoch: 16, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.439 Vali Acc: 0.511 Test Loss: 1.439 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3638052940368652
Epoch: 17, Steps: 8 | Train Loss: 0.348 Vali Loss: 1.460 Vali Acc: 0.511 Test Loss: 1.460 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6499567031860352
Epoch: 18, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.441 Vali Acc: 0.519 Test Loss: 1.441 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519070).  Saving model ...
Epoch: 19 cost time: 1.4157154560089111
Epoch: 19, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.431 Vali Acc: 0.511 Test Loss: 1.431 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.049257278442383
Epoch: 20, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.402 Vali Acc: 0.519 Test Loss: 1.402 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 21 cost time: 1.1847600936889648
Epoch: 21, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.422 Vali Acc: 0.511 Test Loss: 1.422 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.536557674407959
Epoch: 22, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.423 Vali Acc: 0.504 Test Loss: 1.423 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7114489078521729
Epoch: 23, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.649498701095581
Epoch: 24, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.446 Vali Acc: 0.489 Test Loss: 1.446 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.752164363861084
Epoch: 25, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.430 Vali Acc: 0.519 Test Loss: 1.430 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.487426996231079
Epoch: 26, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.421 Vali Acc: 0.511 Test Loss: 1.421 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.580775499343872
Epoch: 27, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6342546939849854
Epoch: 28, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.446 Vali Acc: 0.504 Test Loss: 1.446 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4895012378692627
Epoch: 29, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.451 Vali Acc: 0.504 Test Loss: 1.451 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.500525951385498
Epoch: 30, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.421 Vali Acc: 0.481 Test Loss: 1.421 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 216229
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.971505880355835
Epoch: 1, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.568 Vali Acc: 0.427 Test Loss: 1.568 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 2.0809414386749268
Epoch: 2, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6939566135406494
Epoch: 3, Steps: 8 | Train Loss: 1.301 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9772436618804932
Epoch: 4, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.34260630607605
Epoch: 5, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.477 Vali Acc: 0.443 Test Loss: 1.477 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 2.1192922592163086
Epoch: 6, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.450 Vali Acc: 0.443 Test Loss: 1.450 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442734).  Saving model ...
Epoch: 7 cost time: 1.7852330207824707
Epoch: 7, Steps: 8 | Train Loss: 0.582 Vali Loss: 1.417 Vali Acc: 0.496 Test Loss: 1.417 Test Acc: 0.496
Validation loss decreased (-0.442734 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.7544047832489014
Epoch: 8, Steps: 8 | Train Loss: 0.454 Vali Loss: 1.378 Vali Acc: 0.496 Test Loss: 1.378 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 2.09281587600708
Epoch: 9, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.379 Vali Acc: 0.504 Test Loss: 1.379 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.6768038272857666
Epoch: 10, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.344 Vali Acc: 0.527 Test Loss: 1.344 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 2.169562578201294
Epoch: 11, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.435 Vali Acc: 0.519 Test Loss: 1.435 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7346961498260498
Epoch: 12, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.507 Vali Acc: 0.519 Test Loss: 1.507 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.111495018005371
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.323 Vali Acc: 0.527 Test Loss: 1.323 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 2.281355381011963
Epoch: 14, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.396 Vali Acc: 0.527 Test Loss: 1.396 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9714775085449219
Epoch: 15, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.473 Vali Acc: 0.519 Test Loss: 1.473 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5525884628295898
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.522 Vali Acc: 0.527 Test Loss: 1.522 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.296586275100708
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.453 Vali Acc: 0.527 Test Loss: 1.453 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1352908611297607
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.451 Vali Acc: 0.527 Test Loss: 1.451 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1100122928619385
Epoch: 19, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1215131282806396
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.668 Vali Acc: 0.527 Test Loss: 1.668 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0151796340942383
Epoch: 21, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.728 Vali Acc: 0.519 Test Loss: 1.728 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8984503746032715
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.666 Vali Acc: 0.550 Test Loss: 1.666 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549602).  Saving model ...
Epoch: 23 cost time: 2.1768181324005127
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.686 Vali Acc: 0.527 Test Loss: 1.686 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8818771839141846
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.731 Vali Acc: 0.527 Test Loss: 1.731 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.026819944381714
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.807 Vali Acc: 0.527 Test Loss: 1.807 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2255725860595703
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.736 Vali Acc: 0.527 Test Loss: 1.736 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.206322193145752
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.740 Vali Acc: 0.527 Test Loss: 1.740 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1781976222991943
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.783 Vali Acc: 0.527 Test Loss: 1.783 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.198141574859619
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.874 Vali Acc: 0.527 Test Loss: 1.874 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.87138032913208
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.974 Vali Acc: 0.527 Test Loss: 1.974 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.14064621925354
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.067 Vali Acc: 0.527 Test Loss: 2.067 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7218804359436035
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.135 Vali Acc: 0.527 Test Loss: 2.135 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 698597
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.134239435195923
Epoch: 1, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.583 Vali Acc: 0.412 Test Loss: 1.583 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 2.186455249786377
Epoch: 2, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.136591911315918
Epoch: 3, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8694958686828613
Epoch: 4, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1917827129364014
Epoch: 5, Steps: 8 | Train Loss: 1.126 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 2.225036859512329
Epoch: 6, Steps: 8 | Train Loss: 1.026 Vali Loss: 1.492 Vali Acc: 0.420 Test Loss: 1.492 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.967315673828125
Epoch: 7, Steps: 8 | Train Loss: 0.879 Vali Loss: 1.456 Vali Acc: 0.450 Test Loss: 1.456 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 2.534364700317383
Epoch: 8, Steps: 8 | Train Loss: 0.746 Vali Loss: 1.454 Vali Acc: 0.466 Test Loss: 1.454 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.7200610637664795
Epoch: 9, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.438 Vali Acc: 0.504 Test Loss: 1.438 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.7308740615844727
Epoch: 10, Steps: 8 | Train Loss: 0.543 Vali Loss: 1.431 Vali Acc: 0.481 Test Loss: 1.431 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9842147827148438
Epoch: 11, Steps: 8 | Train Loss: 0.405 Vali Loss: 1.393 Vali Acc: 0.504 Test Loss: 1.393 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.794412612915039
Epoch: 12, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.410 Vali Acc: 0.504 Test Loss: 1.410 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9101974964141846
Epoch: 13, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.376 Vali Acc: 0.527 Test Loss: 1.376 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.782271385192871
Epoch: 14, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.386 Vali Acc: 0.542 Test Loss: 1.386 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 15 cost time: 1.933086633682251
Epoch: 15, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.422 Vali Acc: 0.527 Test Loss: 1.422 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4720067977905273
Epoch: 16, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8716602325439453
Epoch: 17, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.405 Vali Acc: 0.542 Test Loss: 1.405 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5436673164367676
Epoch: 18, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.366 Vali Acc: 0.550 Test Loss: 1.366 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549605).  Saving model ...
Epoch: 19 cost time: 2.4952635765075684
Epoch: 19, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.196967601776123
Epoch: 20, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.419 Vali Acc: 0.550 Test Loss: 1.419 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.513007402420044
Epoch: 21, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7249906063079834
Epoch: 22, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.535 Vali Acc: 0.527 Test Loss: 1.535 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7216455936431885
Epoch: 23, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.479 Vali Acc: 0.550 Test Loss: 1.479 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2840871810913086
Epoch: 24, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.344 Vali Acc: 0.565 Test Loss: 1.344 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564872).  Saving model ...
Epoch: 25 cost time: 1.8358049392700195
Epoch: 25, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.392 Vali Acc: 0.565 Test Loss: 1.392 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3121485710144043
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.571 Vali Acc: 0.573 Test Loss: 1.571 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572503).  Saving model ...
Epoch: 27 cost time: 1.8176169395446777
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.609 Vali Acc: 0.550 Test Loss: 1.609 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7331624031066895
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.549 Vali Acc: 0.542 Test Loss: 1.549 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0281307697296143
Epoch: 29, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.476 Vali Acc: 0.557 Test Loss: 1.476 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.5119168758392334
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.509 Vali Acc: 0.557 Test Loss: 1.509 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.953284502029419
Epoch: 31, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.576 Vali Acc: 0.557 Test Loss: 1.576 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.3413169384002686
Epoch: 32, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.644 Vali Acc: 0.542 Test Loss: 1.644 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.2287943363189697
Epoch: 33, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.576 Vali Acc: 0.550 Test Loss: 1.576 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.3162941932678223
Epoch: 34, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.544 Vali Acc: 0.550 Test Loss: 1.544 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.4034106731414795
Epoch: 35, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.565 Vali Acc: 0.542 Test Loss: 1.565 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.2918996810913086
Epoch: 36, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.687 Vali Acc: 0.534 Test Loss: 1.687 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 674597
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.8022613525390625
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.599 Vali Acc: 0.244 Test Loss: 1.599 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 1.6007165908813477
Epoch: 2, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (-0.244259 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.0319275856018066
Epoch: 3, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.0839545726776123
Epoch: 4, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.692028284072876
Epoch: 5, Steps: 8 | Train Loss: 1.177 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8907890319824219
Epoch: 6, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 2.092603921890259
Epoch: 7, Steps: 8 | Train Loss: 0.969 Vali Loss: 1.499 Vali Acc: 0.420 Test Loss: 1.499 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.6919732093811035
Epoch: 8, Steps: 8 | Train Loss: 0.854 Vali Loss: 1.468 Vali Acc: 0.443 Test Loss: 1.468 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 2.0081939697265625
Epoch: 9, Steps: 8 | Train Loss: 0.736 Vali Loss: 1.453 Vali Acc: 0.443 Test Loss: 1.453 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442734).  Saving model ...
Epoch: 10 cost time: 1.9395616054534912
Epoch: 10, Steps: 8 | Train Loss: 0.629 Vali Loss: 1.425 Vali Acc: 0.466 Test Loss: 1.425 Test Acc: 0.466
Validation loss decreased (-0.442734 --> -0.465635).  Saving model ...
Epoch: 11 cost time: 1.9211978912353516
Epoch: 11, Steps: 8 | Train Loss: 0.540 Vali Loss: 1.385 Vali Acc: 0.504 Test Loss: 1.385 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 2.1017398834228516
Epoch: 12, Steps: 8 | Train Loss: 0.438 Vali Loss: 1.401 Vali Acc: 0.504 Test Loss: 1.401 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0372390747070312
Epoch: 13, Steps: 8 | Train Loss: 0.349 Vali Loss: 1.377 Vali Acc: 0.511 Test Loss: 1.377 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 14 cost time: 2.1303551197052
Epoch: 14, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3682234287261963
Epoch: 15, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.331 Vali Acc: 0.519 Test Loss: 1.331 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519071).  Saving model ...
Epoch: 16 cost time: 2.2727465629577637
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.310 Vali Acc: 0.527 Test Loss: 1.310 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 17 cost time: 1.84840989112854
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.335 Vali Acc: 0.527 Test Loss: 1.335 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9312183856964111
Epoch: 18, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8441929817199707
Epoch: 19, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.325 Vali Acc: 0.534 Test Loss: 1.325 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 20 cost time: 2.1045327186584473
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.333 Vali Acc: 0.534 Test Loss: 1.333 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3658134937286377
Epoch: 21, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.323 Vali Acc: 0.511 Test Loss: 1.323 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6206140518188477
Epoch: 22, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.297 Vali Acc: 0.519 Test Loss: 1.297 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1018271446228027
Epoch: 23, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.268 Vali Acc: 0.534 Test Loss: 1.268 Test Acc: 0.534
Validation loss decreased (-0.534338 --> -0.534338).  Saving model ...
Epoch: 24 cost time: 1.9185423851013184
Epoch: 24, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.358 Vali Acc: 0.504 Test Loss: 1.358 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6342494487762451
Epoch: 25, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.306 Vali Acc: 0.527 Test Loss: 1.306 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0821802616119385
Epoch: 26, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.291 Vali Acc: 0.542 Test Loss: 1.291 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 27 cost time: 1.8477482795715332
Epoch: 27, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.281 Vali Acc: 0.527 Test Loss: 1.281 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9399902820587158
Epoch: 28, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.325 Vali Acc: 0.504 Test Loss: 1.325 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7548210620880127
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.333 Vali Acc: 0.519 Test Loss: 1.333 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.811765432357788
Epoch: 30, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8957431316375732
Epoch: 31, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.319 Vali Acc: 0.534 Test Loss: 1.319 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0552237033843994
Epoch: 32, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.096601724624634
Epoch: 33, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7614085674285889
Epoch: 34, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.340 Vali Acc: 0.511 Test Loss: 1.340 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.1005442142486572
Epoch: 35, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.390 Vali Acc: 0.527 Test Loss: 1.390 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7053627967834473
Epoch: 36, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.389 Vali Acc: 0.519 Test Loss: 1.389 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 677445
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.6418397426605225
Epoch: 1, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.624 Vali Acc: 0.122 Test Loss: 1.624 Test Acc: 0.122
Validation loss decreased (inf --> -0.122121).  Saving model ...
Epoch: 2 cost time: 2.147791862487793
Epoch: 2, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.591 Vali Acc: 0.359 Test Loss: 1.591 Test Acc: 0.359
Validation loss decreased (-0.122121 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 1.8004481792449951
Epoch: 3, Steps: 8 | Train Loss: 1.464 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.358763 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.9721825122833252
Epoch: 4, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7103195190429688
Epoch: 5, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 2.632995367050171
Epoch: 6, Steps: 8 | Train Loss: 1.140 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.5210323333740234
Epoch: 7, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.494 Vali Acc: 0.427 Test Loss: 1.494 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.6628227233886719
Epoch: 8, Steps: 8 | Train Loss: 0.907 Vali Loss: 1.477 Vali Acc: 0.450 Test Loss: 1.477 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 2.147831678390503
Epoch: 9, Steps: 8 | Train Loss: 0.818 Vali Loss: 1.467 Vali Acc: 0.450 Test Loss: 1.467 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 2.1746714115142822
Epoch: 10, Steps: 8 | Train Loss: 0.729 Vali Loss: 1.437 Vali Acc: 0.481 Test Loss: 1.437 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 1.8032090663909912
Epoch: 11, Steps: 8 | Train Loss: 0.613 Vali Loss: 1.409 Vali Acc: 0.489 Test Loss: 1.409 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488536).  Saving model ...
Epoch: 12 cost time: 1.459160327911377
Epoch: 12, Steps: 8 | Train Loss: 0.506 Vali Loss: 1.401 Vali Acc: 0.496 Test Loss: 1.401 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 13 cost time: 1.867779016494751
Epoch: 13, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.385 Vali Acc: 0.504 Test Loss: 1.385 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 14 cost time: 2.005971908569336
Epoch: 14, Steps: 8 | Train Loss: 0.367 Vali Loss: 1.309 Vali Acc: 0.519 Test Loss: 1.309 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519071).  Saving model ...
Epoch: 15 cost time: 1.756425380706787
Epoch: 15, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.342 Vali Acc: 0.519 Test Loss: 1.342 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7641668319702148
Epoch: 16, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.342 Vali Acc: 0.519 Test Loss: 1.342 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5546326637268066
Epoch: 17, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.344 Vali Acc: 0.527 Test Loss: 1.344 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 18 cost time: 1.6411702632904053
Epoch: 18, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.306 Vali Acc: 0.573 Test Loss: 1.306 Test Acc: 0.573
Validation loss decreased (-0.526704 --> -0.572506).  Saving model ...
Epoch: 19 cost time: 1.6220848560333252
Epoch: 19, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.319 Vali Acc: 0.573 Test Loss: 1.319 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0378518104553223
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.346 Vali Acc: 0.573 Test Loss: 1.346 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5918834209442139
Epoch: 21, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.375 Vali Acc: 0.565 Test Loss: 1.375 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5139594078063965
Epoch: 22, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.417 Vali Acc: 0.565 Test Loss: 1.417 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1856000423431396
Epoch: 23, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.314 Vali Acc: 0.550 Test Loss: 1.314 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.867199420928955
Epoch: 24, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.321 Vali Acc: 0.595 Test Loss: 1.321 Test Acc: 0.595
Validation loss decreased (-0.572506 --> -0.595407).  Saving model ...
Epoch: 25 cost time: 1.5151464939117432
Epoch: 25, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.344 Vali Acc: 0.565 Test Loss: 1.344 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9409282207489014
Epoch: 26, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.390 Vali Acc: 0.557 Test Loss: 1.390 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9859213829040527
Epoch: 27, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.485 Vali Acc: 0.557 Test Loss: 1.485 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9732613563537598
Epoch: 28, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.423 Vali Acc: 0.573 Test Loss: 1.423 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.628293514251709
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.467 Vali Acc: 0.557 Test Loss: 1.467 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7267863750457764
Epoch: 30, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.365 Vali Acc: 0.588 Test Loss: 1.365 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8069612979888916
Epoch: 31, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.368 Vali Acc: 0.618 Test Loss: 1.368 Test Acc: 0.618
Validation loss decreased (-0.595407 --> -0.618307).  Saving model ...
Epoch: 32 cost time: 1.7975656986236572
Epoch: 32, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.278 Vali Acc: 0.611 Test Loss: 1.278 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7026357650756836
Epoch: 33, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.349 Vali Acc: 0.565 Test Loss: 1.349 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7755932807922363
Epoch: 34, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.369 Vali Acc: 0.557 Test Loss: 1.369 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9296085834503174
Epoch: 35, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.410 Vali Acc: 0.557 Test Loss: 1.410 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8000388145446777
Epoch: 36, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.471 Vali Acc: 0.580 Test Loss: 1.471 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7945778369903564
Epoch: 37, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.468 Vali Acc: 0.588 Test Loss: 1.468 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.702253818511963
Epoch: 38, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.468 Vali Acc: 0.580 Test Loss: 1.468 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5178742408752441
Epoch: 39, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.539 Vali Acc: 0.580 Test Loss: 1.539 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1750540733337402
Epoch: 40, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.613 Vali Acc: 0.573 Test Loss: 1.613 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7675085067749023
Epoch: 41, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.515 Vali Acc: 0.595 Test Loss: 1.515 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 684165
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.0586631298065186
Epoch: 1, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.593 Vali Acc: 0.389 Test Loss: 1.593 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.8304431438446045
Epoch: 2, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.898622751235962
Epoch: 3, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.066802740097046
Epoch: 4, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7862606048583984
Epoch: 5, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8864407539367676
Epoch: 6, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4649758338928223
Epoch: 7, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.016294240951538
Epoch: 8, Steps: 8 | Train Loss: 0.974 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.091010332107544
Epoch: 9, Steps: 8 | Train Loss: 0.891 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 10 cost time: 1.9190821647644043
Epoch: 10, Steps: 8 | Train Loss: 0.826 Vali Loss: 1.509 Vali Acc: 0.435 Test Loss: 1.509 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 11 cost time: 1.5702903270721436
Epoch: 11, Steps: 8 | Train Loss: 0.732 Vali Loss: 1.501 Vali Acc: 0.435 Test Loss: 1.501 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 12 cost time: 1.7243735790252686
Epoch: 12, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.504 Vali Acc: 0.435 Test Loss: 1.504 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5442087650299072
Epoch: 13, Steps: 8 | Train Loss: 0.567 Vali Loss: 1.509 Vali Acc: 0.443 Test Loss: 1.509 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 14 cost time: 1.902916669845581
Epoch: 14, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.514 Vali Acc: 0.443 Test Loss: 1.514 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.014300584793091
Epoch: 15, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.473 Vali Acc: 0.466 Test Loss: 1.473 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 16 cost time: 1.5637309551239014
Epoch: 16, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.472 Vali Acc: 0.481 Test Loss: 1.472 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 17 cost time: 1.6146845817565918
Epoch: 17, Steps: 8 | Train Loss: 0.355 Vali Loss: 1.473 Vali Acc: 0.481 Test Loss: 1.473 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.041428804397583
Epoch: 18, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.518 Vali Acc: 0.473 Test Loss: 1.518 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8019404411315918
Epoch: 19, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.510 Vali Acc: 0.473 Test Loss: 1.510 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7424428462982178
Epoch: 20, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.471 Vali Acc: 0.489 Test Loss: 1.471 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 21 cost time: 1.8628523349761963
Epoch: 21, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.513 Vali Acc: 0.504 Test Loss: 1.513 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 22 cost time: 1.6210048198699951
Epoch: 22, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.474 Vali Acc: 0.504 Test Loss: 1.474 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503802).  Saving model ...
Epoch: 23 cost time: 1.7816166877746582
Epoch: 23, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.506 Vali Acc: 0.496 Test Loss: 1.506 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9663162231445312
Epoch: 24, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.483 Vali Acc: 0.511 Test Loss: 1.483 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 25 cost time: 1.8469982147216797
Epoch: 25, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.518 Vali Acc: 0.504 Test Loss: 1.518 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7003107070922852
Epoch: 26, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.565 Vali Acc: 0.466 Test Loss: 1.565 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.640854835510254
Epoch: 27, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.580 Vali Acc: 0.466 Test Loss: 1.580 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8346729278564453
Epoch: 28, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.590 Vali Acc: 0.458 Test Loss: 1.590 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.80338716506958
Epoch: 29, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.549 Vali Acc: 0.458 Test Loss: 1.549 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7904982566833496
Epoch: 30, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 31 cost time: 1.592771053314209
Epoch: 31, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.545 Vali Acc: 0.466 Test Loss: 1.545 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9685359001159668
Epoch: 32, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.542 Vali Acc: 0.473 Test Loss: 1.542 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.49922513961792
Epoch: 33, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.576 Vali Acc: 0.450 Test Loss: 1.576 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.899477243423462
Epoch: 34, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.547 Vali Acc: 0.473 Test Loss: 1.547 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.871932029724121
Epoch: 35, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.557 Vali Acc: 0.496 Test Loss: 1.557 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.664492130279541
Epoch: 36, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.540 Vali Acc: 0.496 Test Loss: 1.540 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.9966497421264648
Epoch: 37, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.504 Vali Acc: 0.489 Test Loss: 1.504 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.0106003284454346
Epoch: 38, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7505300045013428
Epoch: 39, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.599 Vali Acc: 0.473 Test Loss: 1.599 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.8887791633605957
Epoch: 40, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.615 Vali Acc: 0.473 Test Loss: 1.615 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 709093
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.171637058258057
Epoch: 1, Steps: 8 | Train Loss: 1.697 Vali Loss: 1.634 Vali Acc: 0.183 Test Loss: 1.634 Test Acc: 0.183
Validation loss decreased (inf --> -0.183190).  Saving model ...
Epoch: 2 cost time: 1.9696989059448242
Epoch: 2, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.609 Vali Acc: 0.313 Test Loss: 1.609 Test Acc: 0.313
Validation loss decreased (-0.183190 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.4932243824005127
Epoch: 3, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.575 Vali Acc: 0.443 Test Loss: 1.575 Test Acc: 0.443
Validation loss decreased (-0.312961 --> -0.442732).  Saving model ...
Epoch: 4 cost time: 2.0000498294830322
Epoch: 4, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.538 Vali Acc: 0.427 Test Loss: 1.538 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7949042320251465
Epoch: 5, Steps: 8 | Train Loss: 1.171 Vali Loss: 1.506 Vali Acc: 0.435 Test Loss: 1.506 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7742419242858887
Epoch: 6, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.495 Vali Acc: 0.435 Test Loss: 1.495 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4664208889007568
Epoch: 7, Steps: 8 | Train Loss: 0.981 Vali Loss: 1.481 Vali Acc: 0.435 Test Loss: 1.481 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8919072151184082
Epoch: 8, Steps: 8 | Train Loss: 0.891 Vali Loss: 1.488 Vali Acc: 0.435 Test Loss: 1.488 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8062219619750977
Epoch: 9, Steps: 8 | Train Loss: 0.784 Vali Loss: 1.498 Vali Acc: 0.450 Test Loss: 1.498 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 1.4829785823822021
Epoch: 10, Steps: 8 | Train Loss: 0.682 Vali Loss: 1.467 Vali Acc: 0.481 Test Loss: 1.467 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 1.6690969467163086
Epoch: 11, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.444 Vali Acc: 0.496 Test Loss: 1.444 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 1.8099310398101807
Epoch: 12, Steps: 8 | Train Loss: 0.488 Vali Loss: 1.437 Vali Acc: 0.504 Test Loss: 1.437 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 13 cost time: 1.6779754161834717
Epoch: 13, Steps: 8 | Train Loss: 0.399 Vali Loss: 1.435 Vali Acc: 0.534 Test Loss: 1.435 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 1.6967313289642334
Epoch: 14, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.434 Vali Acc: 0.534 Test Loss: 1.434 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 15 cost time: 1.9389829635620117
Epoch: 15, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.435 Vali Acc: 0.534 Test Loss: 1.435 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.229656457901001
Epoch: 16, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7545559406280518
Epoch: 17, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.446 Vali Acc: 0.534 Test Loss: 1.446 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9034926891326904
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.624661922454834
Epoch: 19, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.493 Vali Acc: 0.504 Test Loss: 1.493 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7456111907958984
Epoch: 20, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.501 Vali Acc: 0.550 Test Loss: 1.501 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549603).  Saving model ...
Epoch: 21 cost time: 1.505911111831665
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.478 Vali Acc: 0.534 Test Loss: 1.478 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6664385795593262
Epoch: 22, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.499 Vali Acc: 0.527 Test Loss: 1.499 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7786216735839844
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.489 Vali Acc: 0.519 Test Loss: 1.489 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6442930698394775
Epoch: 24, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.512 Vali Acc: 0.550 Test Loss: 1.512 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5079517364501953
Epoch: 25, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.533 Vali Acc: 0.550 Test Loss: 1.533 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8963687419891357
Epoch: 26, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.494 Vali Acc: 0.550 Test Loss: 1.494 Test Acc: 0.550
Validation loss decreased (-0.549603 --> -0.549603).  Saving model ...
Epoch: 27 cost time: 1.9013514518737793
Epoch: 27, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.509 Vali Acc: 0.534 Test Loss: 1.509 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4633922576904297
Epoch: 28, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.529 Vali Acc: 0.519 Test Loss: 1.529 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7573223114013672
Epoch: 29, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.544 Vali Acc: 0.527 Test Loss: 1.544 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9408044815063477
Epoch: 30, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.604 Vali Acc: 0.519 Test Loss: 1.604 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9974822998046875
Epoch: 31, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.733 Vali Acc: 0.527 Test Loss: 1.733 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4089882373809814
Epoch: 32, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.639 Vali Acc: 0.519 Test Loss: 1.639 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7753932476043701
Epoch: 33, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.516 Vali Acc: 0.527 Test Loss: 1.516 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8785886764526367
Epoch: 34, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.516 Vali Acc: 0.519 Test Loss: 1.516 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9544003009796143
Epoch: 35, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.571 Vali Acc: 0.550 Test Loss: 1.571 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9126718044281006
Epoch: 36, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.520 Vali Acc: 0.519 Test Loss: 1.520 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 734021
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.26209568977356
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.599 Vali Acc: 0.183 Test Loss: 1.599 Test Acc: 0.183
Validation loss decreased (inf --> -0.183190).  Saving model ...
Epoch: 2 cost time: 1.6570770740509033
Epoch: 2, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.582 Vali Acc: 0.397 Test Loss: 1.582 Test Acc: 0.397
Validation loss decreased (-0.183190 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.6279196739196777
Epoch: 3, Steps: 8 | Train Loss: 1.458 Vali Loss: 1.555 Vali Acc: 0.420 Test Loss: 1.555 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.8052749633789062
Epoch: 4, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.6250839233398438
Epoch: 5, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.687650203704834
Epoch: 6, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.8765218257904053
Epoch: 7, Steps: 8 | Train Loss: 1.022 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.9848670959472656
Epoch: 8, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.5868980884552002
Epoch: 9, Steps: 8 | Train Loss: 0.872 Vali Loss: 1.505 Vali Acc: 0.427 Test Loss: 1.505 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 10 cost time: 1.7477633953094482
Epoch: 10, Steps: 8 | Train Loss: 0.790 Vali Loss: 1.506 Vali Acc: 0.420 Test Loss: 1.506 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6301586627960205
Epoch: 11, Steps: 8 | Train Loss: 0.722 Vali Loss: 1.504 Vali Acc: 0.427 Test Loss: 1.504 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 12 cost time: 1.4116840362548828
Epoch: 12, Steps: 8 | Train Loss: 0.678 Vali Loss: 1.508 Vali Acc: 0.458 Test Loss: 1.508 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 13 cost time: 1.9009242057800293
Epoch: 13, Steps: 8 | Train Loss: 0.612 Vali Loss: 1.530 Vali Acc: 0.443 Test Loss: 1.530 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9114205837249756
Epoch: 14, Steps: 8 | Train Loss: 0.557 Vali Loss: 1.527 Vali Acc: 0.443 Test Loss: 1.527 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4733741283416748
Epoch: 15, Steps: 8 | Train Loss: 0.460 Vali Loss: 1.509 Vali Acc: 0.450 Test Loss: 1.509 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3911030292510986
Epoch: 16, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.517 Vali Acc: 0.473 Test Loss: 1.517 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 17 cost time: 1.5258166790008545
Epoch: 17, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.495 Vali Acc: 0.458 Test Loss: 1.495 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.143908977508545
Epoch: 18, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.482 Vali Acc: 0.473 Test Loss: 1.482 Test Acc: 0.473
Validation loss decreased (-0.473267 --> -0.473268).  Saving model ...
Epoch: 19 cost time: 1.7695317268371582
Epoch: 19, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.512 Vali Acc: 0.481 Test Loss: 1.512 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 20 cost time: 1.63234281539917
Epoch: 20, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.505 Vali Acc: 0.466 Test Loss: 1.505 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5810835361480713
Epoch: 21, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.575 Vali Acc: 0.458 Test Loss: 1.575 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.912773609161377
Epoch: 22, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.581 Vali Acc: 0.458 Test Loss: 1.581 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5136234760284424
Epoch: 23, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.581 Vali Acc: 0.450 Test Loss: 1.581 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8185184001922607
Epoch: 24, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.595 Vali Acc: 0.458 Test Loss: 1.595 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6481242179870605
Epoch: 25, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.586 Vali Acc: 0.450 Test Loss: 1.586 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4669067859649658
Epoch: 26, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.607 Vali Acc: 0.427 Test Loss: 1.607 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7478306293487549
Epoch: 27, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.571 Vali Acc: 0.450 Test Loss: 1.571 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.44702410697937
Epoch: 28, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.573 Vali Acc: 0.443 Test Loss: 1.573 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.834223747253418
Epoch: 29, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.555 Vali Acc: 0.458 Test Loss: 1.555 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 758949
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4759037494659424
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6689670085906982
Epoch: 2, Steps: 8 | Train Loss: 1.437 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.745678424835205
Epoch: 3, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7664790153503418
Epoch: 4, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.510 Vali Acc: 0.420 Test Loss: 1.510 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5323083400726318
Epoch: 5, Steps: 8 | Train Loss: 0.978 Vali Loss: 1.461 Vali Acc: 0.427 Test Loss: 1.461 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.2149231433868408
Epoch: 6, Steps: 8 | Train Loss: 0.796 Vali Loss: 1.451 Vali Acc: 0.466 Test Loss: 1.451 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.7074189186096191
Epoch: 7, Steps: 8 | Train Loss: 0.614 Vali Loss: 1.427 Vali Acc: 0.489 Test Loss: 1.427 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.7838196754455566
Epoch: 8, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.393 Vali Acc: 0.496 Test Loss: 1.393 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.491675615310669
Epoch: 9, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.361 Vali Acc: 0.511 Test Loss: 1.361 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511437).  Saving model ...
Epoch: 10 cost time: 1.5282933712005615
Epoch: 10, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.381 Vali Acc: 0.511 Test Loss: 1.381 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.637589931488037
Epoch: 11, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 1.867924690246582
Epoch: 12, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.726860761642456
Epoch: 13, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7052979469299316
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.502 Vali Acc: 0.519 Test Loss: 1.502 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.425675868988037
Epoch: 15, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.463 Vali Acc: 0.527 Test Loss: 1.463 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.765352725982666
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.612 Vali Acc: 0.519 Test Loss: 1.612 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4181602001190186
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.686 Vali Acc: 0.519 Test Loss: 1.686 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.582834243774414
Epoch: 18, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.606 Vali Acc: 0.519 Test Loss: 1.606 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9593706130981445
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.588 Vali Acc: 0.519 Test Loss: 1.588 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6061623096466064
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.645 Vali Acc: 0.519 Test Loss: 1.645 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5997490882873535
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.720 Vali Acc: 0.519 Test Loss: 1.720 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 693221
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9675073623657227
Epoch: 1, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.608 Vali Acc: 0.290 Test Loss: 1.608 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.5763790607452393
Epoch: 2, Steps: 8 | Train Loss: 1.501 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
Validation loss decreased (-0.290060 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.80440092086792
Epoch: 3, Steps: 8 | Train Loss: 1.366 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.8914763927459717
Epoch: 4, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.567 Vali Acc: 0.420 Test Loss: 1.567 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8560974597930908
Epoch: 5, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.6452436447143555
Epoch: 6, Steps: 8 | Train Loss: 1.014 Vali Loss: 1.511 Vali Acc: 0.450 Test Loss: 1.511 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 2.0347180366516113
Epoch: 7, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.517 Vali Acc: 0.466 Test Loss: 1.517 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.700422763824463
Epoch: 8, Steps: 8 | Train Loss: 0.770 Vali Loss: 1.488 Vali Acc: 0.481 Test Loss: 1.488 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.7001185417175293
Epoch: 9, Steps: 8 | Train Loss: 0.624 Vali Loss: 1.468 Vali Acc: 0.496 Test Loss: 1.468 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.6015937328338623
Epoch: 10, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.451 Vali Acc: 0.504 Test Loss: 1.451 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.569124460220337
Epoch: 11, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.452 Vali Acc: 0.511 Test Loss: 1.452 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.4701347351074219
Epoch: 12, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.483 Vali Acc: 0.511 Test Loss: 1.483 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.517378330230713
Epoch: 13, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.423 Vali Acc: 0.511 Test Loss: 1.423 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 2.272026538848877
Epoch: 14, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.485 Vali Acc: 0.511 Test Loss: 1.485 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8533802032470703
Epoch: 15, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.489 Vali Acc: 0.519 Test Loss: 1.489 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 16 cost time: 1.598797082901001
Epoch: 16, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.487 Vali Acc: 0.511 Test Loss: 1.487 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6773555278778076
Epoch: 17, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.523 Vali Acc: 0.519 Test Loss: 1.523 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.041593551635742
Epoch: 18, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.530 Vali Acc: 0.542 Test Loss: 1.530 Test Acc: 0.542
Validation loss decreased (-0.519069 --> -0.541969).  Saving model ...
Epoch: 19 cost time: 2.095475435256958
Epoch: 19, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.535 Vali Acc: 0.527 Test Loss: 1.535 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.502495527267456
Epoch: 20, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.566 Vali Acc: 0.519 Test Loss: 1.566 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9255871772766113
Epoch: 21, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.521 Vali Acc: 0.527 Test Loss: 1.521 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.125014543533325
Epoch: 22, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.550 Vali Acc: 0.542 Test Loss: 1.550 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4718379974365234
Epoch: 23, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.559 Vali Acc: 0.527 Test Loss: 1.559 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.881676435470581
Epoch: 24, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.538 Vali Acc: 0.527 Test Loss: 1.538 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1885592937469482
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.595 Vali Acc: 0.542 Test Loss: 1.595 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.244832992553711
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.723 Vali Acc: 0.527 Test Loss: 1.723 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2707462310791016
Epoch: 27, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.668 Vali Acc: 0.527 Test Loss: 1.668 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9208612442016602
Epoch: 28, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.581 Vali Acc: 0.534 Test Loss: 1.581 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 669221
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.9347922801971436
Epoch: 1, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.598 Vali Acc: 0.267 Test Loss: 1.598 Test Acc: 0.267
Validation loss decreased (inf --> -0.267160).  Saving model ...
Epoch: 2 cost time: 1.6101570129394531
Epoch: 2, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.558 Vali Acc: 0.412 Test Loss: 1.558 Test Acc: 0.412
Validation loss decreased (-0.267160 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.5649309158325195
Epoch: 3, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.290079116821289
Epoch: 4, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8529324531555176
Epoch: 5, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6936051845550537
Epoch: 6, Steps: 8 | Train Loss: 1.112 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.733978509902954
Epoch: 7, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.501 Vali Acc: 0.420 Test Loss: 1.501 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.8802642822265625
Epoch: 8, Steps: 8 | Train Loss: 0.886 Vali Loss: 1.484 Vali Acc: 0.420 Test Loss: 1.484 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 2.0530059337615967
Epoch: 9, Steps: 8 | Train Loss: 0.765 Vali Loss: 1.474 Vali Acc: 0.427 Test Loss: 1.474 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 10 cost time: 2.1373448371887207
Epoch: 10, Steps: 8 | Train Loss: 0.659 Vali Loss: 1.441 Vali Acc: 0.450 Test Loss: 1.441 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 2.5678703784942627
Epoch: 11, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.441 Vali Acc: 0.481 Test Loss: 1.441 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 2.19026517868042
Epoch: 12, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.483 Vali Acc: 0.466 Test Loss: 1.483 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7985751628875732
Epoch: 13, Steps: 8 | Train Loss: 0.399 Vali Loss: 1.490 Vali Acc: 0.473 Test Loss: 1.490 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.044480800628662
Epoch: 14, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.415 Vali Acc: 0.511 Test Loss: 1.415 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511436).  Saving model ...
Epoch: 15 cost time: 1.9191627502441406
Epoch: 15, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.451 Vali Acc: 0.504 Test Loss: 1.451 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9665634632110596
Epoch: 16, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.474 Vali Acc: 0.504 Test Loss: 1.474 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2979910373687744
Epoch: 17, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.499 Vali Acc: 0.519 Test Loss: 1.499 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 18 cost time: 1.6255261898040771
Epoch: 18, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 19 cost time: 2.239332437515259
Epoch: 19, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.449 Vali Acc: 0.519 Test Loss: 1.449 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8597731590270996
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.427 Vali Acc: 0.519 Test Loss: 1.427 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7272698879241943
Epoch: 21, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 22 cost time: 1.6029162406921387
Epoch: 22, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.506 Vali Acc: 0.527 Test Loss: 1.506 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.721015214920044
Epoch: 23, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.185732126235962
Epoch: 24, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.494 Vali Acc: 0.527 Test Loss: 1.494 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.969365119934082
Epoch: 25, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.507 Vali Acc: 0.534 Test Loss: 1.507 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 26 cost time: 1.6630263328552246
Epoch: 26, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.510 Vali Acc: 0.534 Test Loss: 1.510 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.846085548400879
Epoch: 27, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.446 Vali Acc: 0.550 Test Loss: 1.446 Test Acc: 0.550
Validation loss decreased (-0.534336 --> -0.549604).  Saving model ...
Epoch: 28 cost time: 2.1543216705322266
Epoch: 28, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.516 Vali Acc: 0.534 Test Loss: 1.516 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.554640531539917
Epoch: 29, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.542 Vali Acc: 0.527 Test Loss: 1.542 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1238651275634766
Epoch: 30, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.487 Vali Acc: 0.534 Test Loss: 1.487 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.137584686279297
Epoch: 31, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.491 Vali Acc: 0.534 Test Loss: 1.491 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9268677234649658
Epoch: 32, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.517 Vali Acc: 0.534 Test Loss: 1.517 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6429848670959473
Epoch: 33, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.556 Vali Acc: 0.550 Test Loss: 1.556 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.2182557582855225
Epoch: 34, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.580 Vali Acc: 0.550 Test Loss: 1.580 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7435967922210693
Epoch: 35, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.578 Vali Acc: 0.550 Test Loss: 1.578 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.1468873023986816
Epoch: 36, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.562 Vali Acc: 0.550 Test Loss: 1.562 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.004382610321045
Epoch: 37, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.618 Vali Acc: 0.534 Test Loss: 1.618 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 672069
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.605036735534668
Epoch: 1, Steps: 8 | Train Loss: 1.641 Vali Loss: 1.610 Vali Acc: 0.168 Test Loss: 1.610 Test Acc: 0.168
Validation loss decreased (inf --> -0.167923).  Saving model ...
Epoch: 2 cost time: 1.9044418334960938
Epoch: 2, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.570 Vali Acc: 0.397 Test Loss: 1.570 Test Acc: 0.397
Validation loss decreased (-0.167923 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.4840049743652344
Epoch: 3, Steps: 8 | Train Loss: 1.454 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.8336894512176514
Epoch: 4, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7528479099273682
Epoch: 5, Steps: 8 | Train Loss: 1.205 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5827515125274658
Epoch: 6, Steps: 8 | Train Loss: 1.129 Vali Loss: 1.480 Vali Acc: 0.420 Test Loss: 1.480 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 7 cost time: 1.9411091804504395
Epoch: 7, Steps: 8 | Train Loss: 1.028 Vali Loss: 1.473 Vali Acc: 0.420 Test Loss: 1.473 Test Acc: 0.420
Validation loss decreased (-0.419833 --> -0.419833).  Saving model ...
Epoch: 8 cost time: 1.9470150470733643
Epoch: 8, Steps: 8 | Train Loss: 0.917 Vali Loss: 1.490 Vali Acc: 0.427 Test Loss: 1.490 Test Acc: 0.427
Validation loss decreased (-0.419833 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.5879428386688232
Epoch: 9, Steps: 8 | Train Loss: 0.850 Vali Loss: 1.438 Vali Acc: 0.443 Test Loss: 1.438 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442734).  Saving model ...
Epoch: 10 cost time: 1.9421656131744385
Epoch: 10, Steps: 8 | Train Loss: 0.729 Vali Loss: 1.414 Vali Acc: 0.458 Test Loss: 1.414 Test Acc: 0.458
Validation loss decreased (-0.442734 --> -0.458001).  Saving model ...
Epoch: 11 cost time: 1.9079844951629639
Epoch: 11, Steps: 8 | Train Loss: 0.674 Vali Loss: 1.420 Vali Acc: 0.458 Test Loss: 1.420 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0973453521728516
Epoch: 12, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.387 Vali Acc: 0.496 Test Loss: 1.387 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 13 cost time: 1.5759994983673096
Epoch: 13, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.358 Vali Acc: 0.519 Test Loss: 1.358 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.6065373420715332
Epoch: 14, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.339 Vali Acc: 0.527 Test Loss: 1.339 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 15 cost time: 1.8436436653137207
Epoch: 15, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.338 Vali Acc: 0.542 Test Loss: 1.338 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.9126107692718506
Epoch: 16, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.291 Vali Acc: 0.565 Test Loss: 1.291 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564873).  Saving model ...
Epoch: 17 cost time: 1.5560197830200195
Epoch: 17, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.332 Vali Acc: 0.534 Test Loss: 1.332 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.871232509613037
Epoch: 18, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.329 Vali Acc: 0.557 Test Loss: 1.329 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0596258640289307
Epoch: 19, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.351 Vali Acc: 0.550 Test Loss: 1.351 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.147719383239746
Epoch: 20, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.388 Vali Acc: 0.565 Test Loss: 1.388 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.06462025642395
Epoch: 21, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.367 Vali Acc: 0.557 Test Loss: 1.367 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7847959995269775
Epoch: 22, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.369 Vali Acc: 0.557 Test Loss: 1.369 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7889015674591064
Epoch: 23, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.365 Vali Acc: 0.557 Test Loss: 1.365 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7576448917388916
Epoch: 24, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.376 Vali Acc: 0.565 Test Loss: 1.376 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6768124103546143
Epoch: 25, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.361 Vali Acc: 0.557 Test Loss: 1.361 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1686148643493652
Epoch: 26, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.383 Vali Acc: 0.588 Test Loss: 1.383 Test Acc: 0.588
Validation loss decreased (-0.564873 --> -0.587772).  Saving model ...
Epoch: 27 cost time: 1.7397139072418213
Epoch: 27, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.469 Vali Acc: 0.550 Test Loss: 1.469 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.117751121520996
Epoch: 28, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.182410717010498
Epoch: 29, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.395 Vali Acc: 0.580 Test Loss: 1.395 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3592522144317627
Epoch: 30, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.487 Vali Acc: 0.580 Test Loss: 1.487 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5558977127075195
Epoch: 31, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.571 Vali Acc: 0.573 Test Loss: 1.571 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.9887690544128418
Epoch: 32, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.490 Vali Acc: 0.557 Test Loss: 1.490 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9838461875915527
Epoch: 33, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.423 Vali Acc: 0.565 Test Loss: 1.423 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7190437316894531
Epoch: 34, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.385 Vali Acc: 0.565 Test Loss: 1.385 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.8758823871612549
Epoch: 35, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.374 Vali Acc: 0.588 Test Loss: 1.374 Test Acc: 0.588
Validation loss decreased (-0.587772 --> -0.587773).  Saving model ...
Epoch: 36 cost time: 2.267725944519043
Epoch: 36, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.414 Vali Acc: 0.603 Test Loss: 1.414 Test Acc: 0.603
Validation loss decreased (-0.587773 --> -0.603039).  Saving model ...
Epoch: 37 cost time: 1.7247462272644043
Epoch: 37, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.410 Vali Acc: 0.588 Test Loss: 1.410 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.942798376083374
Epoch: 38, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.430 Vali Acc: 0.573 Test Loss: 1.430 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.195143938064575
Epoch: 39, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.510 Vali Acc: 0.565 Test Loss: 1.510 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.0328891277313232
Epoch: 40, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.717817783355713
Epoch: 41, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.443 Vali Acc: 0.542 Test Loss: 1.443 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6768052577972412
Epoch: 42, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.522 Vali Acc: 0.557 Test Loss: 1.522 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.1495041847229004
Epoch: 43, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.481 Vali Acc: 0.557 Test Loss: 1.481 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.5903375148773193
Epoch: 44, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.555 Vali Acc: 0.550 Test Loss: 1.555 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.050276756286621
Epoch: 45, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.600 Vali Acc: 0.534 Test Loss: 1.600 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.892543077468872
Epoch: 46, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.663 Vali Acc: 0.573 Test Loss: 1.663 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 678789
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.052243947982788
Epoch: 1, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.599 Vali Acc: 0.290 Test Loss: 1.599 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.7877731323242188
Epoch: 2, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.577 Vali Acc: 0.427 Test Loss: 1.577 Test Acc: 0.427
Validation loss decreased (-0.290060 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 2.0637238025665283
Epoch: 3, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7776679992675781
Epoch: 4, Steps: 8 | Train Loss: 1.337 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7254722118377686
Epoch: 5, Steps: 8 | Train Loss: 1.202 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7012488842010498
Epoch: 6, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.517874002456665
Epoch: 7, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.805222749710083
Epoch: 8, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6789336204528809
Epoch: 9, Steps: 8 | Train Loss: 0.859 Vali Loss: 1.504 Vali Acc: 0.435 Test Loss: 1.504 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 10 cost time: 1.5876002311706543
Epoch: 10, Steps: 8 | Train Loss: 0.802 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 11 cost time: 1.6973826885223389
Epoch: 11, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.515 Vali Acc: 0.443 Test Loss: 1.515 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.506709098815918
Epoch: 12, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.491 Vali Acc: 0.443 Test Loss: 1.491 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 13 cost time: 1.8829362392425537
Epoch: 13, Steps: 8 | Train Loss: 0.547 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 14 cost time: 1.6250805854797363
Epoch: 14, Steps: 8 | Train Loss: 0.492 Vali Loss: 1.479 Vali Acc: 0.450 Test Loss: 1.479 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3889551162719727
Epoch: 15, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.475 Vali Acc: 0.458 Test Loss: 1.475 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 16 cost time: 1.582080602645874
Epoch: 16, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.474 Vali Acc: 0.473 Test Loss: 1.474 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 17 cost time: 1.569493293762207
Epoch: 17, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.501 Vali Acc: 0.473 Test Loss: 1.501 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.514423131942749
Epoch: 18, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.504 Vali Acc: 0.496 Test Loss: 1.504 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496168).  Saving model ...
Epoch: 19 cost time: 1.7310690879821777
Epoch: 19, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.532 Vali Acc: 0.458 Test Loss: 1.532 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6476998329162598
Epoch: 20, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.522 Vali Acc: 0.496 Test Loss: 1.522 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3598239421844482
Epoch: 21, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.575 Vali Acc: 0.466 Test Loss: 1.575 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5786762237548828
Epoch: 22, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.570 Vali Acc: 0.450 Test Loss: 1.570 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9579894542694092
Epoch: 23, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.513 Vali Acc: 0.489 Test Loss: 1.513 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.977590560913086
Epoch: 24, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.535 Vali Acc: 0.473 Test Loss: 1.535 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8021860122680664
Epoch: 25, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.512 Vali Acc: 0.511 Test Loss: 1.512 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511435).  Saving model ...
Epoch: 26 cost time: 1.6283323764801025
Epoch: 26, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.551 Vali Acc: 0.496 Test Loss: 1.551 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4626121520996094
Epoch: 27, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.598 Vali Acc: 0.450 Test Loss: 1.598 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7885041236877441
Epoch: 28, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.586 Vali Acc: 0.473 Test Loss: 1.586 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.937619686126709
Epoch: 29, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7280621528625488
Epoch: 30, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.560 Vali Acc: 0.481 Test Loss: 1.560 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7942688465118408
Epoch: 31, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.545 Vali Acc: 0.458 Test Loss: 1.545 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4400756359100342
Epoch: 32, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.524 Vali Acc: 0.496 Test Loss: 1.524 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6097171306610107
Epoch: 33, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.600 Vali Acc: 0.489 Test Loss: 1.600 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0273287296295166
Epoch: 34, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.576 Vali Acc: 0.489 Test Loss: 1.576 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8216087818145752
Epoch: 35, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.591 Vali Acc: 0.473 Test Loss: 1.591 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 703717
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.719969749450684
Epoch: 1, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.604 Vali Acc: 0.191 Test Loss: 1.604 Test Acc: 0.191
Validation loss decreased (inf --> -0.190824).  Saving model ...
Epoch: 2 cost time: 1.5395212173461914
Epoch: 2, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.573 Vali Acc: 0.344 Test Loss: 1.573 Test Acc: 0.344
Validation loss decreased (-0.190824 --> -0.343496).  Saving model ...
Epoch: 3 cost time: 1.4566619396209717
Epoch: 3, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.537 Vali Acc: 0.427 Test Loss: 1.537 Test Acc: 0.427
Validation loss decreased (-0.343496 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.9401566982269287
Epoch: 4, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.517 Vali Acc: 0.427 Test Loss: 1.517 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 2.0816104412078857
Epoch: 5, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.512 Vali Acc: 0.427 Test Loss: 1.512 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.3134756088256836
Epoch: 6, Steps: 8 | Train Loss: 1.059 Vali Loss: 1.523 Vali Acc: 0.427 Test Loss: 1.523 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6324129104614258
Epoch: 7, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.517 Vali Acc: 0.427 Test Loss: 1.517 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8186123371124268
Epoch: 8, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.503 Vali Acc: 0.458 Test Loss: 1.503 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 9 cost time: 1.6374704837799072
Epoch: 9, Steps: 8 | Train Loss: 0.743 Vali Loss: 1.486 Vali Acc: 0.481 Test Loss: 1.486 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.6681406497955322
Epoch: 10, Steps: 8 | Train Loss: 0.656 Vali Loss: 1.472 Vali Acc: 0.496 Test Loss: 1.472 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 11 cost time: 1.596447467803955
Epoch: 11, Steps: 8 | Train Loss: 0.541 Vali Loss: 1.473 Vali Acc: 0.489 Test Loss: 1.473 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8636412620544434
Epoch: 12, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.466 Vali Acc: 0.504 Test Loss: 1.466 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 13 cost time: 1.674072027206421
Epoch: 13, Steps: 8 | Train Loss: 0.396 Vali Loss: 1.480 Vali Acc: 0.527 Test Loss: 1.480 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 14 cost time: 1.661315679550171
Epoch: 14, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.475 Vali Acc: 0.527 Test Loss: 1.475 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.5549213886260986
Epoch: 15, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.469 Vali Acc: 0.504 Test Loss: 1.469 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8186795711517334
Epoch: 16, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.464 Vali Acc: 0.511 Test Loss: 1.464 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5884974002838135
Epoch: 17, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.476 Vali Acc: 0.542 Test Loss: 1.476 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541970).  Saving model ...
Epoch: 18 cost time: 1.595703363418579
Epoch: 18, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.466 Vali Acc: 0.534 Test Loss: 1.466 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8033828735351562
Epoch: 19, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.554 Vali Acc: 0.542 Test Loss: 1.554 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.496351957321167
Epoch: 20, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.480 Vali Acc: 0.557 Test Loss: 1.480 Test Acc: 0.557
Validation loss decreased (-0.541970 --> -0.557237).  Saving model ...
Epoch: 21 cost time: 1.824629306793213
Epoch: 21, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.472 Vali Acc: 0.542 Test Loss: 1.472 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.663910150527954
Epoch: 22, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.496 Vali Acc: 0.542 Test Loss: 1.496 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4030046463012695
Epoch: 23, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.644 Vali Acc: 0.542 Test Loss: 1.644 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3886549472808838
Epoch: 24, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.591 Vali Acc: 0.527 Test Loss: 1.591 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0799126625061035
Epoch: 25, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8205533027648926
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.637 Vali Acc: 0.534 Test Loss: 1.637 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5783023834228516
Epoch: 27, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.619 Vali Acc: 0.527 Test Loss: 1.619 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4597337245941162
Epoch: 28, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.545 Vali Acc: 0.527 Test Loss: 1.545 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5445446968078613
Epoch: 29, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.542 Vali Acc: 0.550 Test Loss: 1.542 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.951890230178833
Epoch: 30, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.585 Vali Acc: 0.542 Test Loss: 1.585 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 728645
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.210507392883301
Epoch: 1, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.620 Vali Acc: 0.160 Test Loss: 1.620 Test Acc: 0.160
Validation loss decreased (inf --> -0.160289).  Saving model ...
Epoch: 2 cost time: 1.5249500274658203
Epoch: 2, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.597 Vali Acc: 0.221 Test Loss: 1.597 Test Acc: 0.221
Validation loss decreased (-0.160289 --> -0.221358).  Saving model ...
Epoch: 3 cost time: 1.5369043350219727
Epoch: 3, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.566 Vali Acc: 0.466 Test Loss: 1.566 Test Acc: 0.466
Validation loss decreased (-0.221358 --> -0.465633).  Saving model ...
Epoch: 4 cost time: 1.9603490829467773
Epoch: 4, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.000171422958374
Epoch: 5, Steps: 8 | Train Loss: 1.223 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9586529731750488
Epoch: 6, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2096025943756104
Epoch: 7, Steps: 8 | Train Loss: 1.057 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6844298839569092
Epoch: 8, Steps: 8 | Train Loss: 0.982 Vali Loss: 1.497 Vali Acc: 0.420 Test Loss: 1.497 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6633892059326172
Epoch: 9, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.480 Vali Acc: 0.420 Test Loss: 1.480 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.025094985961914
Epoch: 10, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.493 Vali Acc: 0.420 Test Loss: 1.493 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4089877605438232
Epoch: 11, Steps: 8 | Train Loss: 0.706 Vali Loss: 1.469 Vali Acc: 0.435 Test Loss: 1.469 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9039034843444824
Epoch: 12, Steps: 8 | Train Loss: 0.599 Vali Loss: 1.455 Vali Acc: 0.450 Test Loss: 1.455 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9217464923858643
Epoch: 13, Steps: 8 | Train Loss: 0.517 Vali Loss: 1.448 Vali Acc: 0.458 Test Loss: 1.448 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 753573
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.653191804885864
Epoch: 1, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.664224624633789
Epoch: 2, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.670574426651001
Epoch: 3, Steps: 8 | Train Loss: 0.862 Vali Loss: 1.458 Vali Acc: 0.458 Test Loss: 1.458 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.5759997367858887
Epoch: 4, Steps: 8 | Train Loss: 0.508 Vali Loss: 1.463 Vali Acc: 0.496 Test Loss: 1.463 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.4686143398284912
Epoch: 5, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.491 Vali Acc: 0.511 Test Loss: 1.491 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511435).  Saving model ...
Epoch: 6 cost time: 1.5571274757385254
Epoch: 6, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.384 Vali Acc: 0.534 Test Loss: 1.384 Test Acc: 0.534
Validation loss decreased (-0.511435 --> -0.534337).  Saving model ...
Epoch: 7 cost time: 1.7306618690490723
Epoch: 7, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8660149574279785
Epoch: 8, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.513 Vali Acc: 0.542 Test Loss: 1.513 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 9 cost time: 1.805551528930664
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.606 Vali Acc: 0.542 Test Loss: 1.606 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5311479568481445
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.736 Vali Acc: 0.527 Test Loss: 1.736 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6031358242034912
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.799 Vali Acc: 0.542 Test Loss: 1.799 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6960487365722656
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.892 Vali Acc: 0.534 Test Loss: 1.892 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.571692705154419
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.016 Vali Acc: 0.519 Test Loss: 2.016 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5984694957733154
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.385 Vali Acc: 0.527 Test Loss: 2.385 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.524998426437378
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.265 Vali Acc: 0.527 Test Loss: 2.265 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3973908424377441
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.144 Vali Acc: 0.519 Test Loss: 2.144 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.426354169845581
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.201 Vali Acc: 0.511 Test Loss: 2.201 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8035593032836914
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.395 Vali Acc: 0.511 Test Loss: 2.395 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2517893
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.119028091430664
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.560 Vali Acc: 0.412 Test Loss: 1.560 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.7085154056549072
Epoch: 2, Steps: 8 | Train Loss: 1.389 Vali Loss: 1.500 Vali Acc: 0.427 Test Loss: 1.500 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.4362444877624512
Epoch: 3, Steps: 8 | Train Loss: 1.133 Vali Loss: 1.473 Vali Acc: 0.427 Test Loss: 1.473 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.6753015518188477
Epoch: 4, Steps: 8 | Train Loss: 0.813 Vali Loss: 1.400 Vali Acc: 0.489 Test Loss: 1.400 Test Acc: 0.489
Validation loss decreased (-0.427466 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.6373612880706787
Epoch: 5, Steps: 8 | Train Loss: 0.550 Vali Loss: 1.383 Vali Acc: 0.496 Test Loss: 1.383 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.7605526447296143
Epoch: 6, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.309 Vali Acc: 0.534 Test Loss: 1.309 Test Acc: 0.534
Validation loss decreased (-0.496169 --> -0.534338).  Saving model ...
Epoch: 7 cost time: 1.6847732067108154
Epoch: 7, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.370 Vali Acc: 0.534 Test Loss: 1.370 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5805716514587402
Epoch: 8, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.409 Vali Acc: 0.534 Test Loss: 1.409 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9220507144927979
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.261 Vali Acc: 0.557 Test Loss: 1.261 Test Acc: 0.557
Validation loss decreased (-0.534338 --> -0.557239).  Saving model ...
Epoch: 10 cost time: 1.8810598850250244
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.322 Vali Acc: 0.557 Test Loss: 1.322 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4810998439788818
Epoch: 11, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.399 Vali Acc: 0.557 Test Loss: 1.399 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3984794616699219
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.479 Vali Acc: 0.565 Test Loss: 1.479 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564871).  Saving model ...
Epoch: 13 cost time: 1.3728673458099365
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.498 Vali Acc: 0.565 Test Loss: 1.498 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4665398597717285
Epoch: 14, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.471 Vali Acc: 0.565 Test Loss: 1.471 Test Acc: 0.565
Validation loss decreased (-0.564871 --> -0.564871).  Saving model ...
Epoch: 15 cost time: 1.4535236358642578
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.894 Vali Acc: 0.534 Test Loss: 1.894 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7147715091705322
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.818 Vali Acc: 0.534 Test Loss: 1.818 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4211437702178955
Epoch: 17, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.572 Vali Acc: 0.557 Test Loss: 1.572 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4121129512786865
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.622 Vali Acc: 0.550 Test Loss: 1.622 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8680660724639893
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.819 Vali Acc: 0.534 Test Loss: 1.819 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3224003314971924
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.868 Vali Acc: 0.542 Test Loss: 1.868 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.700507402420044
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.468 Vali Acc: 0.519 Test Loss: 2.468 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8383984565734863
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.975 Vali Acc: 0.527 Test Loss: 1.975 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6396160125732422
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.546 Vali Acc: 0.603 Test Loss: 1.546 Test Acc: 0.603
Validation loss decreased (-0.564871 --> -0.603038).  Saving model ...
Epoch: 24 cost time: 1.505908727645874
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.731 Vali Acc: 0.580 Test Loss: 1.731 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4692859649658203
Epoch: 25, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.746 Vali Acc: 0.565 Test Loss: 1.746 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.595952033996582
Epoch: 26, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.567 Vali Acc: 0.557 Test Loss: 1.567 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6492838859558105
Epoch: 27, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.773 Vali Acc: 0.557 Test Loss: 1.773 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8612663745880127
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.357 Vali Acc: 0.527 Test Loss: 2.357 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8806462287902832
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.953 Vali Acc: 0.534 Test Loss: 1.953 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5985913276672363
Epoch: 30, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.048 Vali Acc: 0.550 Test Loss: 2.048 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5903832912445068
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.590 Vali Acc: 0.542 Test Loss: 2.590 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8561983108520508
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.534 Vali Acc: 0.542 Test Loss: 2.534 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8734452724456787
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.519 Vali Acc: 0.527 Test Loss: 2.519 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 2421893
model size : 9.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.460875034332275
Epoch: 1, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.742236614227295
Epoch: 2, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.567 Vali Acc: 0.420 Test Loss: 1.567 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.528989553451538
Epoch: 3, Steps: 8 | Train Loss: 1.223 Vali Loss: 1.555 Vali Acc: 0.420 Test Loss: 1.555 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7130308151245117
Epoch: 4, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.4077813625335693
Epoch: 5, Steps: 8 | Train Loss: 0.744 Vali Loss: 1.480 Vali Acc: 0.450 Test Loss: 1.480 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 2.1340126991271973
Epoch: 6, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.468 Vali Acc: 0.481 Test Loss: 1.468 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 1.8783202171325684
Epoch: 7, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.416 Vali Acc: 0.504 Test Loss: 1.416 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.8609774112701416
Epoch: 8, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.440 Vali Acc: 0.511 Test Loss: 1.440 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.5924396514892578
Epoch: 9, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.442 Vali Acc: 0.519 Test Loss: 1.442 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.4987547397613525
Epoch: 10, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.463 Vali Acc: 0.519 Test Loss: 1.463 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.07432222366333
Epoch: 11, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.456 Vali Acc: 0.519 Test Loss: 1.456 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.973348617553711
Epoch: 12, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.419 Vali Acc: 0.527 Test Loss: 1.419 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 13 cost time: 1.5259826183319092
Epoch: 13, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6155648231506348
Epoch: 14, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0967800617218018
Epoch: 15, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6313800811767578
Epoch: 16, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.566 Vali Acc: 0.534 Test Loss: 1.566 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534335).  Saving model ...
Epoch: 17 cost time: 1.6150281429290771
Epoch: 17, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.620110034942627
Epoch: 18, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.506 Vali Acc: 0.511 Test Loss: 1.506 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6354484558105469
Epoch: 19, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.740 Vali Acc: 0.519 Test Loss: 1.740 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.944674015045166
Epoch: 20, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.675 Vali Acc: 0.511 Test Loss: 1.675 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.697707176208496
Epoch: 21, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.467 Vali Acc: 0.534 Test Loss: 1.467 Test Acc: 0.534
Validation loss decreased (-0.534335 --> -0.534336).  Saving model ...
Epoch: 22 cost time: 1.8248348236083984
Epoch: 22, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.482 Vali Acc: 0.534 Test Loss: 1.482 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.012739658355713
Epoch: 23, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.697 Vali Acc: 0.534 Test Loss: 1.697 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7146878242492676
Epoch: 24, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.686 Vali Acc: 0.534 Test Loss: 1.686 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8001298904418945
Epoch: 25, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.622 Vali Acc: 0.519 Test Loss: 1.622 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0832009315490723
Epoch: 26, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.688 Vali Acc: 0.527 Test Loss: 1.688 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3614792823791504
Epoch: 27, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.909 Vali Acc: 0.542 Test Loss: 1.909 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541966).  Saving model ...
Epoch: 28 cost time: 2.0160491466522217
Epoch: 28, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.897 Vali Acc: 0.534 Test Loss: 1.897 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6790270805358887
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.715 Vali Acc: 0.534 Test Loss: 1.715 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8677666187286377
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.765 Vali Acc: 0.527 Test Loss: 1.765 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.703847885131836
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.957 Vali Acc: 0.550 Test Loss: 1.957 Test Acc: 0.550
Validation loss decreased (-0.541966 --> -0.549599).  Saving model ...
Epoch: 32 cost time: 1.669703722000122
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.131 Vali Acc: 0.550 Test Loss: 2.131 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6756937503814697
Epoch: 33, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.074 Vali Acc: 0.542 Test Loss: 2.074 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9261159896850586
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.073 Vali Acc: 0.550 Test Loss: 2.073 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6777057647705078
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.140 Vali Acc: 0.542 Test Loss: 2.140 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.760594129562378
Epoch: 36, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.088 Vali Acc: 0.527 Test Loss: 2.088 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5558643341064453
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.949 Vali Acc: 0.557 Test Loss: 1.949 Test Acc: 0.557
Validation loss decreased (-0.549599 --> -0.557232).  Saving model ...
Epoch: 38 cost time: 1.781710147857666
Epoch: 38, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.045 Vali Acc: 0.550 Test Loss: 2.045 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8223390579223633
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.199 Vali Acc: 0.542 Test Loss: 2.199 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7238426208496094
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.419 Vali Acc: 0.534 Test Loss: 2.419 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7956702709197998
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.532 Vali Acc: 0.534 Test Loss: 2.532 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6765193939208984
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.586 Vali Acc: 0.542 Test Loss: 2.586 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.899043083190918
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.634 Vali Acc: 0.542 Test Loss: 2.634 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9412448406219482
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.695 Vali Acc: 0.542 Test Loss: 2.695 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8225417137145996
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.765 Vali Acc: 0.534 Test Loss: 2.765 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6835367679595947
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.823 Vali Acc: 0.542 Test Loss: 2.823 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.8943455219268799
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.933 Vali Acc: 0.534 Test Loss: 2.933 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 2425605
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.774806022644043
Epoch: 1, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.594 Vali Acc: 0.412 Test Loss: 1.594 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.3612756729125977
Epoch: 2, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7210414409637451
Epoch: 3, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4022629261016846
Epoch: 4, Steps: 8 | Train Loss: 1.011 Vali Loss: 1.521 Vali Acc: 0.427 Test Loss: 1.521 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.4846899509429932
Epoch: 5, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.467 Vali Acc: 0.489 Test Loss: 1.467 Test Acc: 0.489
Validation loss decreased (-0.427466 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 1.439237356185913
Epoch: 6, Steps: 8 | Train Loss: 0.558 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.6052660942077637
Epoch: 7, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.426 Vali Acc: 0.504 Test Loss: 1.426 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.5537669658660889
Epoch: 8, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.340 Vali Acc: 0.534 Test Loss: 1.340 Test Acc: 0.534
Validation loss decreased (-0.503803 --> -0.534338).  Saving model ...
Epoch: 9 cost time: 1.5615129470825195
Epoch: 9, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.346 Vali Acc: 0.527 Test Loss: 1.346 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.602628231048584
Epoch: 10, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0023152828216553
Epoch: 11, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.440 Vali Acc: 0.534 Test Loss: 1.440 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6637952327728271
Epoch: 12, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.427 Vali Acc: 0.534 Test Loss: 1.427 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4303700923919678
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.430 Vali Acc: 0.550 Test Loss: 1.430 Test Acc: 0.550
Validation loss decreased (-0.534338 --> -0.549604).  Saving model ...
Epoch: 14 cost time: 1.5432040691375732
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.469 Vali Acc: 0.534 Test Loss: 1.469 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3730566501617432
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.399 Vali Acc: 0.550 Test Loss: 1.399 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549604).  Saving model ...
Epoch: 16 cost time: 1.8421087265014648
Epoch: 16, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.454 Vali Acc: 0.550 Test Loss: 1.454 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.541294813156128
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9983413219451904
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.649 Vali Acc: 0.519 Test Loss: 1.649 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5258450508117676
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.786 Vali Acc: 0.527 Test Loss: 1.786 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.595890760421753
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.618 Vali Acc: 0.527 Test Loss: 1.618 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5811502933502197
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.606 Vali Acc: 0.534 Test Loss: 1.606 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.663358449935913
Epoch: 22, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.491 Vali Acc: 0.542 Test Loss: 1.491 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5084197521209717
Epoch: 23, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.468 Vali Acc: 0.557 Test Loss: 1.468 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557237).  Saving model ...
Epoch: 24 cost time: 1.5548079013824463
Epoch: 24, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.523 Vali Acc: 0.527 Test Loss: 1.523 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6996192932128906
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.549 Vali Acc: 0.534 Test Loss: 1.549 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.62125825881958
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.527 Vali Acc: 0.550 Test Loss: 1.527 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7158727645874023
Epoch: 27, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.763 Vali Acc: 0.565 Test Loss: 1.763 Test Acc: 0.565
Validation loss decreased (-0.557237 --> -0.564868).  Saving model ...
Epoch: 28 cost time: 1.509385108947754
Epoch: 28, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.843 Vali Acc: 0.557 Test Loss: 1.843 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5650076866149902
Epoch: 29, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.719 Vali Acc: 0.534 Test Loss: 1.719 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.747054100036621
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.606 Vali Acc: 0.550 Test Loss: 1.606 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.883021354675293
Epoch: 31, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.691 Vali Acc: 0.542 Test Loss: 1.691 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.90086030960083
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.928 Vali Acc: 0.534 Test Loss: 1.928 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7854523658752441
Epoch: 33, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.906 Vali Acc: 0.534 Test Loss: 1.906 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7620437145233154
Epoch: 34, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.887 Vali Acc: 0.534 Test Loss: 1.887 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.502485990524292
Epoch: 35, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.976 Vali Acc: 0.565 Test Loss: 1.976 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.822913646697998
Epoch: 36, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.321 Vali Acc: 0.565 Test Loss: 2.321 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.575880527496338
Epoch: 37, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.754 Vali Acc: 0.534 Test Loss: 2.754 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2460165
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.526465892791748
Epoch: 1, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.589 Vali Acc: 0.313 Test Loss: 1.589 Test Acc: 0.313
Validation loss decreased (inf --> -0.312961).  Saving model ...
Epoch: 2 cost time: 1.5752077102661133
Epoch: 2, Steps: 8 | Train Loss: 1.465 Vali Loss: 1.547 Vali Acc: 0.420 Test Loss: 1.547 Test Acc: 0.420
Validation loss decreased (-0.312961 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7520477771759033
Epoch: 3, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.444021463394165
Epoch: 4, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.4285171031951904
Epoch: 5, Steps: 8 | Train Loss: 0.862 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8426485061645508
Epoch: 6, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.488 Vali Acc: 0.420 Test Loss: 1.488 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.4057397842407227
Epoch: 7, Steps: 8 | Train Loss: 0.561 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.3793535232543945
Epoch: 8, Steps: 8 | Train Loss: 0.462 Vali Loss: 1.472 Vali Acc: 0.473 Test Loss: 1.472 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 1.2324740886688232
Epoch: 9, Steps: 8 | Train Loss: 0.358 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6078708171844482
Epoch: 10, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.508 Vali Acc: 0.466 Test Loss: 1.508 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.945688009262085
Epoch: 11, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.488 Vali Acc: 0.489 Test Loss: 1.488 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 1.528777837753296
Epoch: 12, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.463 Vali Acc: 0.519 Test Loss: 1.463 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519069).  Saving model ...
Epoch: 13 cost time: 1.5369203090667725
Epoch: 13, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.525 Vali Acc: 0.519 Test Loss: 1.525 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4690327644348145
Epoch: 14, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.545 Vali Acc: 0.511 Test Loss: 1.545 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9139173030853271
Epoch: 15, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.480 Vali Acc: 0.519 Test Loss: 1.480 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6008906364440918
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.456 Vali Acc: 0.519 Test Loss: 1.456 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 17 cost time: 1.3707890510559082
Epoch: 17, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.493 Vali Acc: 0.519 Test Loss: 1.493 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.348184585571289
Epoch: 18, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.503 Vali Acc: 0.534 Test Loss: 1.503 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534336).  Saving model ...
Epoch: 19 cost time: 1.5635721683502197
Epoch: 19, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
Validation loss decreased (-0.534336 --> -0.534336).  Saving model ...
Epoch: 20 cost time: 1.5220060348510742
Epoch: 20, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.458 Vali Acc: 0.542 Test Loss: 1.458 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541970).  Saving model ...
Epoch: 21 cost time: 1.674619436264038
Epoch: 21, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.513 Vali Acc: 0.550 Test Loss: 1.513 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549603).  Saving model ...
Epoch: 22 cost time: 1.6137394905090332
Epoch: 22, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.505 Vali Acc: 0.550 Test Loss: 1.505 Test Acc: 0.550
Validation loss decreased (-0.549603 --> -0.549603).  Saving model ...
Epoch: 23 cost time: 1.3057365417480469
Epoch: 23, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.558 Vali Acc: 0.504 Test Loss: 1.558 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.764988899230957
Epoch: 24, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4112217426300049
Epoch: 25, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.527 Vali Acc: 0.527 Test Loss: 1.527 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9039175510406494
Epoch: 26, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.512 Vali Acc: 0.527 Test Loss: 1.512 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4373788833618164
Epoch: 27, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5830111503601074
Epoch: 28, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8239026069641113
Epoch: 29, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.2281484603881836
Epoch: 30, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.501 Vali Acc: 0.550 Test Loss: 1.501 Test Acc: 0.550
Validation loss decreased (-0.549603 --> -0.549603).  Saving model ...
Epoch: 31 cost time: 1.5087342262268066
Epoch: 31, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.653 Vali Acc: 0.519 Test Loss: 1.653 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.483025312423706
Epoch: 32, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.662 Vali Acc: 0.511 Test Loss: 1.662 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.661848545074463
Epoch: 33, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.569 Vali Acc: 0.519 Test Loss: 1.569 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7759976387023926
Epoch: 34, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.511 Vali Acc: 0.481 Test Loss: 1.511 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.927307367324829
Epoch: 35, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.699042797088623
Epoch: 36, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6009366512298584
Epoch: 37, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.545 Vali Acc: 0.496 Test Loss: 1.545 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5931661128997803
Epoch: 38, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.610 Vali Acc: 0.496 Test Loss: 1.610 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5843071937561035
Epoch: 39, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.561 Vali Acc: 0.504 Test Loss: 1.561 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.0438103675842285
Epoch: 40, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.565 Vali Acc: 0.542 Test Loss: 1.565 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2552197
model size : 9.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.61216402053833
Epoch: 1, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.591 Vali Acc: 0.450 Test Loss: 1.591 Test Acc: 0.450
Validation loss decreased (inf --> -0.450366).  Saving model ...
Epoch: 2 cost time: 1.9725961685180664
Epoch: 2, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8552055358886719
Epoch: 3, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.540 Vali Acc: 0.427 Test Loss: 1.540 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5269463062286377
Epoch: 4, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.678208827972412
Epoch: 5, Steps: 8 | Train Loss: 0.770 Vali Loss: 1.501 Vali Acc: 0.458 Test Loss: 1.501 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.630188226699829
Epoch: 6, Steps: 8 | Train Loss: 0.586 Vali Loss: 1.465 Vali Acc: 0.511 Test Loss: 1.465 Test Acc: 0.511
Validation loss decreased (-0.458000 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.5331408977508545
Epoch: 7, Steps: 8 | Train Loss: 0.427 Vali Loss: 1.441 Vali Acc: 0.519 Test Loss: 1.441 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.7215752601623535
Epoch: 8, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.424 Vali Acc: 0.527 Test Loss: 1.424 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 1.4199349880218506
Epoch: 9, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.406 Vali Acc: 0.542 Test Loss: 1.406 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541971).  Saving model ...
Epoch: 10 cost time: 1.4678456783294678
Epoch: 10, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.444 Vali Acc: 0.534 Test Loss: 1.444 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.572798728942871
Epoch: 11, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.485 Vali Acc: 0.534 Test Loss: 1.485 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5591135025024414
Epoch: 12, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.439 Vali Acc: 0.542 Test Loss: 1.439 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9717683792114258
Epoch: 13, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.462 Vali Acc: 0.557 Test Loss: 1.462 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557237).  Saving model ...
Epoch: 14 cost time: 1.5240776538848877
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.477 Vali Acc: 0.557 Test Loss: 1.477 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7183723449707031
Epoch: 15, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.636 Vali Acc: 0.557 Test Loss: 1.636 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5799767971038818
Epoch: 16, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.596 Vali Acc: 0.542 Test Loss: 1.596 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.026852607727051
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.541 Vali Acc: 0.550 Test Loss: 1.541 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.480485200881958
Epoch: 18, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.516 Vali Acc: 0.550 Test Loss: 1.516 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4352197647094727
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.537 Vali Acc: 0.550 Test Loss: 1.537 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.716639757156372
Epoch: 20, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.556 Vali Acc: 0.550 Test Loss: 1.556 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7937846183776855
Epoch: 21, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.500 Vali Acc: 0.550 Test Loss: 1.500 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0140721797943115
Epoch: 22, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.532 Vali Acc: 0.542 Test Loss: 1.532 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4538943767547607
Epoch: 23, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.573 Vali Acc: 0.534 Test Loss: 1.573 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 2651909
model size : 10.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.011107444763184
Epoch: 1, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.580 Vali Acc: 0.351 Test Loss: 1.580 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.9186718463897705
Epoch: 2, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (-0.351129 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7797877788543701
Epoch: 3, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.1995019912719727
Epoch: 4, Steps: 8 | Train Loss: 1.016 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7440345287322998
Epoch: 5, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.7207908630371094
Epoch: 6, Steps: 8 | Train Loss: 0.682 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.586695909500122
Epoch: 7, Steps: 8 | Train Loss: 0.515 Vali Loss: 1.507 Vali Acc: 0.427 Test Loss: 1.507 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.7300317287445068
Epoch: 8, Steps: 8 | Train Loss: 0.430 Vali Loss: 1.497 Vali Acc: 0.458 Test Loss: 1.497 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 9 cost time: 2.5158965587615967
Epoch: 9, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.504 Vali Acc: 0.458 Test Loss: 1.504 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5828399658203125
Epoch: 10, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.480 Vali Acc: 0.473 Test Loss: 1.480 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 1.8470284938812256
Epoch: 11, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.513 Vali Acc: 0.458 Test Loss: 1.513 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7192356586456299
Epoch: 12, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.519 Vali Acc: 0.458 Test Loss: 1.519 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2310433387756348
Epoch: 13, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.557 Vali Acc: 0.450 Test Loss: 1.557 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7368500232696533
Epoch: 14, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.547 Vali Acc: 0.450 Test Loss: 1.547 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7755308151245117
Epoch: 15, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.541 Vali Acc: 0.450 Test Loss: 1.541 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6810765266418457
Epoch: 16, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7590773105621338
Epoch: 17, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.483 Vali Acc: 0.481 Test Loss: 1.483 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 18 cost time: 2.0617876052856445
Epoch: 18, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.501 Vali Acc: 0.473 Test Loss: 1.501 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6503231525421143
Epoch: 19, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.541 Vali Acc: 0.458 Test Loss: 1.541 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6616709232330322
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.578 Vali Acc: 0.458 Test Loss: 1.578 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0386595726013184
Epoch: 21, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.593 Vali Acc: 0.473 Test Loss: 1.593 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2524325847625732
Epoch: 22, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.614 Vali Acc: 0.458 Test Loss: 1.614 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.678222417831421
Epoch: 23, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.606 Vali Acc: 0.458 Test Loss: 1.606 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.886173963546753
Epoch: 24, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.540 Vali Acc: 0.481 Test Loss: 1.540 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.753631353378296
Epoch: 25, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.616 Vali Acc: 0.466 Test Loss: 1.616 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8386051654815674
Epoch: 26, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.650 Vali Acc: 0.466 Test Loss: 1.650 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3350789546966553
Epoch: 27, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.592 Vali Acc: 0.473 Test Loss: 1.592 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 2759301
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.37480092048645
Epoch: 1, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6236279010772705
Epoch: 2, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.937196969985962
Epoch: 3, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.9071600437164307
Epoch: 4, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.455 Vali Acc: 0.450 Test Loss: 1.455 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.8837494850158691
Epoch: 5, Steps: 8 | Train Loss: 0.619 Vali Loss: 1.385 Vali Acc: 0.466 Test Loss: 1.385 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465635).  Saving model ...
Epoch: 6 cost time: 2.0333423614501953
Epoch: 6, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.359 Vali Acc: 0.519 Test Loss: 1.359 Test Acc: 0.519
Validation loss decreased (-0.465635 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.6477630138397217
Epoch: 7, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.6883957386016846
Epoch: 8, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5428881645202637
Epoch: 9, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.337 Vali Acc: 0.534 Test Loss: 1.337 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 10 cost time: 1.841371774673462
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.285 Vali Acc: 0.542 Test Loss: 1.285 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 11 cost time: 1.7993004322052002
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.608 Vali Acc: 0.527 Test Loss: 1.608 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1464791297912598
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.652 Vali Acc: 0.527 Test Loss: 1.652 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8266258239746094
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.485 Vali Acc: 0.534 Test Loss: 1.485 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3097681999206543
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.501 Vali Acc: 0.534 Test Loss: 1.501 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0158681869506836
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.671 Vali Acc: 0.527 Test Loss: 1.671 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.020143985748291
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.855 Vali Acc: 0.527 Test Loss: 1.855 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0402259826660156
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.982 Vali Acc: 0.527 Test Loss: 1.982 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8384718894958496
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.035 Vali Acc: 0.527 Test Loss: 2.035 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7358319759368896
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.998 Vali Acc: 0.527 Test Loss: 1.998 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5292134284973145
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.022 Vali Acc: 0.527 Test Loss: 2.022 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 751045
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.023715972900391
Epoch: 1, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.606 Vali Acc: 0.382 Test Loss: 1.606 Test Acc: 0.382
Validation loss decreased (inf --> -0.381663).  Saving model ...
Epoch: 2 cost time: 1.6118853092193604
Epoch: 2, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
Validation loss decreased (-0.381663 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6136560440063477
Epoch: 3, Steps: 8 | Train Loss: 1.279 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7886278629302979
Epoch: 4, Steps: 8 | Train Loss: 1.140 Vali Loss: 1.543 Vali Acc: 0.420 Test Loss: 1.543 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.2324397563934326
Epoch: 5, Steps: 8 | Train Loss: 0.923 Vali Loss: 1.463 Vali Acc: 0.435 Test Loss: 1.463 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.2909624576568604
Epoch: 6, Steps: 8 | Train Loss: 0.734 Vali Loss: 1.390 Vali Acc: 0.496 Test Loss: 1.390 Test Acc: 0.496
Validation loss decreased (-0.435100 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.4973750114440918
Epoch: 7, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.418 Vali Acc: 0.481 Test Loss: 1.418 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.702103853225708
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 1.375 Vali Acc: 0.496 Test Loss: 1.375 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.344390630722046
Epoch: 9, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.362797737121582
Epoch: 10, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.331 Vali Acc: 0.527 Test Loss: 1.331 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.3776371479034424
Epoch: 11, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.395 Vali Acc: 0.519 Test Loss: 1.395 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.587935209274292
Epoch: 12, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.427 Vali Acc: 0.519 Test Loss: 1.427 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.667504072189331
Epoch: 13, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.425 Vali Acc: 0.527 Test Loss: 1.425 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2645063400268555
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.399 Vali Acc: 0.542 Test Loss: 1.399 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 15 cost time: 1.306668758392334
Epoch: 15, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.388 Vali Acc: 0.542 Test Loss: 1.388 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.4100561141967773
Epoch: 16, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3339974880218506
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.481 Vali Acc: 0.527 Test Loss: 1.481 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6783182621002197
Epoch: 18, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.424 Vali Acc: 0.542 Test Loss: 1.424 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.44899582862854
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.446 Vali Acc: 0.542 Test Loss: 1.446 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5438950061798096
Epoch: 20, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.419621229171753
Epoch: 21, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.479 Vali Acc: 0.557 Test Loss: 1.479 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557237).  Saving model ...
Epoch: 22 cost time: 1.7823302745819092
Epoch: 22, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.498 Vali Acc: 0.550 Test Loss: 1.498 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7059276103973389
Epoch: 23, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.576 Vali Acc: 0.557 Test Loss: 1.576 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6833953857421875
Epoch: 24, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.571 Vali Acc: 0.534 Test Loss: 1.571 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5097787380218506
Epoch: 25, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.474 Vali Acc: 0.527 Test Loss: 1.474 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.811333179473877
Epoch: 26, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.571 Vali Acc: 0.527 Test Loss: 1.571 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8914952278137207
Epoch: 27, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.765 Vali Acc: 0.519 Test Loss: 1.765 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9538562297821045
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.745 Vali Acc: 0.527 Test Loss: 1.745 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7128400802612305
Epoch: 29, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.671 Vali Acc: 0.519 Test Loss: 1.671 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7415947914123535
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.625 Vali Acc: 0.527 Test Loss: 1.625 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8376882076263428
Epoch: 31, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.896 Vali Acc: 0.519 Test Loss: 1.896 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 703045
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.393540382385254
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.600 Vali Acc: 0.443 Test Loss: 1.600 Test Acc: 0.443
Validation loss decreased (inf --> -0.442732).  Saving model ...
Epoch: 2 cost time: 1.4289004802703857
Epoch: 2, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.563 Vali Acc: 0.420 Test Loss: 1.563 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4373996257781982
Epoch: 3, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5889918804168701
Epoch: 4, Steps: 8 | Train Loss: 1.160 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5488102436065674
Epoch: 5, Steps: 8 | Train Loss: 0.990 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6462054252624512
Epoch: 6, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.470 Vali Acc: 0.427 Test Loss: 1.470 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2853310108184814
Epoch: 7, Steps: 8 | Train Loss: 0.701 Vali Loss: 1.454 Vali Acc: 0.473 Test Loss: 1.454 Test Acc: 0.473
Validation loss decreased (-0.442732 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.630814552307129
Epoch: 8, Steps: 8 | Train Loss: 0.561 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 2.001281499862671
Epoch: 9, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.424 Vali Acc: 0.489 Test Loss: 1.424 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4557209014892578
Epoch: 10, Steps: 8 | Train Loss: 0.349 Vali Loss: 1.430 Vali Acc: 0.489 Test Loss: 1.430 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7546043395996094
Epoch: 11, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.439 Vali Acc: 0.496 Test Loss: 1.439 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 1.559607744216919
Epoch: 12, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526703).  Saving model ...
Epoch: 13 cost time: 1.4510056972503662
Epoch: 13, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.5850811004638672
Epoch: 14, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.438 Vali Acc: 0.534 Test Loss: 1.438 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 15 cost time: 1.3156225681304932
Epoch: 15, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6043074131011963
Epoch: 16, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.522 Vali Acc: 0.511 Test Loss: 1.522 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3868932723999023
Epoch: 17, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.441 Vali Acc: 0.534 Test Loss: 1.441 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3928091526031494
Epoch: 18, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.463 Vali Acc: 0.527 Test Loss: 1.463 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1031789779663086
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.429 Vali Acc: 0.534 Test Loss: 1.429 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 20 cost time: 1.459578037261963
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.468 Vali Acc: 0.527 Test Loss: 1.468 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6721088886260986
Epoch: 21, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.417 Vali Acc: 0.534 Test Loss: 1.417 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 22 cost time: 1.4766459465026855
Epoch: 22, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.372 Vali Acc: 0.542 Test Loss: 1.372 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 23 cost time: 1.7873005867004395
Epoch: 23, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8247885704040527
Epoch: 24, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4539878368377686
Epoch: 25, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.513 Vali Acc: 0.527 Test Loss: 1.513 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4270222187042236
Epoch: 26, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.488 Vali Acc: 0.527 Test Loss: 1.488 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5357797145843506
Epoch: 27, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.465 Vali Acc: 0.550 Test Loss: 1.465 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 28 cost time: 1.4493927955627441
Epoch: 28, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.440 Vali Acc: 0.550 Test Loss: 1.440 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549604).  Saving model ...
Epoch: 29 cost time: 1.1903111934661865
Epoch: 29, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.462 Vali Acc: 0.534 Test Loss: 1.462 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7714409828186035
Epoch: 30, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.466 Vali Acc: 0.550 Test Loss: 1.466 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6579954624176025
Epoch: 31, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.491 Vali Acc: 0.534 Test Loss: 1.491 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.1129183769226074
Epoch: 32, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.477 Vali Acc: 0.534 Test Loss: 1.477 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.903346061706543
Epoch: 33, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.416 Vali Acc: 0.542 Test Loss: 1.416 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4759023189544678
Epoch: 34, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.459 Vali Acc: 0.550 Test Loss: 1.459 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.6589634418487549
Epoch: 35, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.600 Vali Acc: 0.542 Test Loss: 1.600 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.550110101699829
Epoch: 36, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.744 Vali Acc: 0.550 Test Loss: 1.744 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3929779529571533
Epoch: 37, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.789 Vali Acc: 0.542 Test Loss: 1.789 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6143689155578613
Epoch: 38, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.695 Vali Acc: 0.557 Test Loss: 1.695 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557235).  Saving model ...
Epoch: 39 cost time: 1.2075684070587158
Epoch: 39, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.621 Vali Acc: 0.557 Test Loss: 1.621 Test Acc: 0.557
Validation loss decreased (-0.557235 --> -0.557236).  Saving model ...
Epoch: 40 cost time: 1.5637259483337402
Epoch: 40, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.631 Vali Acc: 0.542 Test Loss: 1.631 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.604135513305664
Epoch: 41, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.671 Vali Acc: 0.542 Test Loss: 1.671 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9981050491333008
Epoch: 42, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.710 Vali Acc: 0.550 Test Loss: 1.710 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4473035335540771
Epoch: 43, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.848 Vali Acc: 0.550 Test Loss: 1.848 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4492712020874023
Epoch: 44, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.956 Vali Acc: 0.550 Test Loss: 1.956 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6836395263671875
Epoch: 45, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.868 Vali Acc: 0.557 Test Loss: 1.868 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5216360092163086
Epoch: 46, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.831 Vali Acc: 0.557 Test Loss: 1.831 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.4769892692565918
Epoch: 47, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.093 Vali Acc: 0.534 Test Loss: 2.093 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.274214744567871
Epoch: 48, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.421 Vali Acc: 0.534 Test Loss: 2.421 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.6700944900512695
Epoch: 49, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.575 Vali Acc: 0.550 Test Loss: 2.575 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 704901
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.2426183223724365
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.592 Vali Acc: 0.366 Test Loss: 1.592 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 1.7522168159484863
Epoch: 2, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.543 Vali Acc: 0.420 Test Loss: 1.543 Test Acc: 0.420
Validation loss decreased (-0.366396 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.564422845840454
Epoch: 3, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.3960182666778564
Epoch: 4, Steps: 8 | Train Loss: 1.204 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.6574437618255615
Epoch: 5, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.494 Vali Acc: 0.420 Test Loss: 1.494 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4417901039123535
Epoch: 6, Steps: 8 | Train Loss: 0.925 Vali Loss: 1.445 Vali Acc: 0.443 Test Loss: 1.445 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442734).  Saving model ...
Epoch: 7 cost time: 1.4843132495880127
Epoch: 7, Steps: 8 | Train Loss: 0.730 Vali Loss: 1.412 Vali Acc: 0.443 Test Loss: 1.412 Test Acc: 0.443
Validation loss decreased (-0.442734 --> -0.442734).  Saving model ...
Epoch: 8 cost time: 1.3719890117645264
Epoch: 8, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.357 Vali Acc: 0.496 Test Loss: 1.357 Test Acc: 0.496
Validation loss decreased (-0.442734 --> -0.496170).  Saving model ...
Epoch: 9 cost time: 1.4239366054534912
Epoch: 9, Steps: 8 | Train Loss: 0.476 Vali Loss: 1.329 Vali Acc: 0.511 Test Loss: 1.329 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511437).  Saving model ...
Epoch: 10 cost time: 1.3923430442810059
Epoch: 10, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.486661434173584
Epoch: 11, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.286 Vali Acc: 0.550 Test Loss: 1.286 Test Acc: 0.550
Validation loss decreased (-0.519070 --> -0.549605).  Saving model ...
Epoch: 12 cost time: 1.5070080757141113
Epoch: 12, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.279 Vali Acc: 0.550 Test Loss: 1.279 Test Acc: 0.550
Validation loss decreased (-0.549605 --> -0.549606).  Saving model ...
Epoch: 13 cost time: 1.4546482563018799
Epoch: 13, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.319 Vali Acc: 0.550 Test Loss: 1.319 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3579521179199219
Epoch: 14, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.344 Vali Acc: 0.534 Test Loss: 1.344 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4662799835205078
Epoch: 15, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.727501392364502
Epoch: 16, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.336 Vali Acc: 0.527 Test Loss: 1.336 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4662847518920898
Epoch: 17, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.307 Vali Acc: 0.557 Test Loss: 1.307 Test Acc: 0.557
Validation loss decreased (-0.549606 --> -0.557239).  Saving model ...
Epoch: 18 cost time: 1.5022499561309814
Epoch: 18, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.296 Vali Acc: 0.565 Test Loss: 1.296 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564873).  Saving model ...
Epoch: 19 cost time: 1.3670778274536133
Epoch: 19, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.324 Vali Acc: 0.542 Test Loss: 1.324 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6482667922973633
Epoch: 20, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.386 Vali Acc: 0.519 Test Loss: 1.386 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5324969291687012
Epoch: 21, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8028457164764404
Epoch: 22, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.270 Vali Acc: 0.557 Test Loss: 1.270 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4663527011871338
Epoch: 23, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.299 Vali Acc: 0.550 Test Loss: 1.299 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6227788925170898
Epoch: 24, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.219 Vali Acc: 0.626 Test Loss: 1.219 Test Acc: 0.626
Validation loss decreased (-0.564873 --> -0.625942).  Saving model ...
Epoch: 25 cost time: 1.8232479095458984
Epoch: 25, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.296 Vali Acc: 0.603 Test Loss: 1.296 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.71229887008667
Epoch: 26, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.367 Vali Acc: 0.565 Test Loss: 1.367 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6248598098754883
Epoch: 27, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.426 Vali Acc: 0.542 Test Loss: 1.426 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6454284191131592
Epoch: 28, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.447 Vali Acc: 0.550 Test Loss: 1.447 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9026460647583008
Epoch: 29, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.433 Vali Acc: 0.557 Test Loss: 1.433 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7329082489013672
Epoch: 30, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.456 Vali Acc: 0.573 Test Loss: 1.456 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.2459166049957275
Epoch: 31, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.434 Vali Acc: 0.580 Test Loss: 1.434 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.372607946395874
Epoch: 32, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.471 Vali Acc: 0.603 Test Loss: 1.471 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4808337688446045
Epoch: 33, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.468 Vali Acc: 0.542 Test Loss: 1.468 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6229424476623535
Epoch: 34, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.505 Vali Acc: 0.588 Test Loss: 1.505 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 722181
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4465439319610596
Epoch: 1, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.597 Vali Acc: 0.290 Test Loss: 1.597 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.5109448432922363
Epoch: 2, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.569 Vali Acc: 0.412 Test Loss: 1.569 Test Acc: 0.412
Validation loss decreased (-0.290060 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.7724089622497559
Epoch: 3, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6817090511322021
Epoch: 4, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.490527868270874
Epoch: 5, Steps: 8 | Train Loss: 1.045 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.5023295879364014
Epoch: 6, Steps: 8 | Train Loss: 0.924 Vali Loss: 1.517 Vali Acc: 0.435 Test Loss: 1.517 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 1.7801997661590576
Epoch: 7, Steps: 8 | Train Loss: 0.845 Vali Loss: 1.487 Vali Acc: 0.443 Test Loss: 1.487 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.5867211818695068
Epoch: 8, Steps: 8 | Train Loss: 0.725 Vali Loss: 1.466 Vali Acc: 0.466 Test Loss: 1.466 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.9050869941711426
Epoch: 9, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.449 Vali Acc: 0.481 Test Loss: 1.449 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 1.7747204303741455
Epoch: 10, Steps: 8 | Train Loss: 0.513 Vali Loss: 1.451 Vali Acc: 0.496 Test Loss: 1.451 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 1.4938774108886719
Epoch: 11, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.438 Vali Acc: 0.496 Test Loss: 1.438 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 1.6851768493652344
Epoch: 12, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.424 Vali Acc: 0.504 Test Loss: 1.424 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 13 cost time: 1.9325313568115234
Epoch: 13, Steps: 8 | Train Loss: 0.314 Vali Loss: 1.406 Vali Acc: 0.511 Test Loss: 1.406 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 2.0633351802825928
Epoch: 14, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.425 Vali Acc: 0.519 Test Loss: 1.425 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.4232385158538818
Epoch: 15, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.454 Vali Acc: 0.511 Test Loss: 1.454 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8190772533416748
Epoch: 16, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 17 cost time: 1.8211712837219238
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.439 Vali Acc: 0.527 Test Loss: 1.439 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0497241020202637
Epoch: 18, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6333303451538086
Epoch: 19, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.493 Vali Acc: 0.519 Test Loss: 1.493 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8652760982513428
Epoch: 20, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.528 Vali Acc: 0.519 Test Loss: 1.528 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9991416931152344
Epoch: 21, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.469 Vali Acc: 0.519 Test Loss: 1.469 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.545304775238037
Epoch: 22, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 23 cost time: 1.636518955230713
Epoch: 23, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.435 Vali Acc: 0.519 Test Loss: 1.435 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9856414794921875
Epoch: 24, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.852442741394043
Epoch: 25, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5942342281341553
Epoch: 26, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.492 Vali Acc: 0.511 Test Loss: 1.492 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9097726345062256
Epoch: 27, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.502 Vali Acc: 0.511 Test Loss: 1.502 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7124407291412354
Epoch: 28, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.538 Vali Acc: 0.504 Test Loss: 1.538 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8236443996429443
Epoch: 29, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.490 Vali Acc: 0.496 Test Loss: 1.490 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7071278095245361
Epoch: 30, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.509 Vali Acc: 0.489 Test Loss: 1.509 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6338286399841309
Epoch: 31, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8370170593261719
Epoch: 32, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.434 Vali Acc: 0.511 Test Loss: 1.434 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 768197
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.1614344120025635
Epoch: 1, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.597 Vali Acc: 0.282 Test Loss: 1.597 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 1.5887784957885742
Epoch: 2, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
Validation loss decreased (-0.282427 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.389063835144043
Epoch: 3, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.558 Vali Acc: 0.427 Test Loss: 1.558 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.5538337230682373
Epoch: 4, Steps: 8 | Train Loss: 1.161 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5250065326690674
Epoch: 5, Steps: 8 | Train Loss: 1.005 Vali Loss: 1.523 Vali Acc: 0.427 Test Loss: 1.523 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.356191873550415
Epoch: 6, Steps: 8 | Train Loss: 0.869 Vali Loss: 1.478 Vali Acc: 0.458 Test Loss: 1.478 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.7815415859222412
Epoch: 7, Steps: 8 | Train Loss: 0.699 Vali Loss: 1.456 Vali Acc: 0.481 Test Loss: 1.456 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.2872393131256104
Epoch: 8, Steps: 8 | Train Loss: 0.598 Vali Loss: 1.408 Vali Acc: 0.511 Test Loss: 1.408 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.4927353858947754
Epoch: 9, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.368 Vali Acc: 0.519 Test Loss: 1.368 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.5758299827575684
Epoch: 10, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.356 Vali Acc: 0.511 Test Loss: 1.356 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8505628108978271
Epoch: 11, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.323 Vali Acc: 0.527 Test Loss: 1.323 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 1.2307653427124023
Epoch: 12, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.351 Vali Acc: 0.534 Test Loss: 1.351 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 13 cost time: 1.4827208518981934
Epoch: 13, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.369 Vali Acc: 0.527 Test Loss: 1.369 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5160210132598877
Epoch: 14, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.350 Vali Acc: 0.527 Test Loss: 1.350 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6401538848876953
Epoch: 15, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.330 Vali Acc: 0.534 Test Loss: 1.330 Test Acc: 0.534
Validation loss decreased (-0.534338 --> -0.534338).  Saving model ...
Epoch: 16 cost time: 1.842463731765747
Epoch: 16, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.335 Vali Acc: 0.527 Test Loss: 1.335 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3980388641357422
Epoch: 17, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.415 Vali Acc: 0.527 Test Loss: 1.415 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9727797508239746
Epoch: 18, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5492818355560303
Epoch: 19, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.348 Vali Acc: 0.557 Test Loss: 1.348 Test Acc: 0.557
Validation loss decreased (-0.534338 --> -0.557238).  Saving model ...
Epoch: 20 cost time: 1.3397960662841797
Epoch: 20, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.527904748916626
Epoch: 21, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.391 Vali Acc: 0.542 Test Loss: 1.391 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3432865142822266
Epoch: 22, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.452 Vali Acc: 0.534 Test Loss: 1.452 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5704493522644043
Epoch: 23, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.491 Vali Acc: 0.542 Test Loss: 1.491 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6936116218566895
Epoch: 24, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8176941871643066
Epoch: 25, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8468737602233887
Epoch: 26, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.483 Vali Acc: 0.542 Test Loss: 1.483 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6304445266723633
Epoch: 27, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.483 Vali Acc: 0.542 Test Loss: 1.483 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5417232513427734
Epoch: 28, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.432 Vali Acc: 0.542 Test Loss: 1.432 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.54472017288208
Epoch: 29, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.458 Vali Acc: 0.527 Test Loss: 1.458 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 818053
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.376075506210327
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.614 Vali Acc: 0.176 Test Loss: 1.614 Test Acc: 0.176
Validation loss decreased (inf --> -0.175556).  Saving model ...
Epoch: 2 cost time: 1.535905361175537
Epoch: 2, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.597 Vali Acc: 0.405 Test Loss: 1.597 Test Acc: 0.405
Validation loss decreased (-0.175556 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 1.5319514274597168
Epoch: 3, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6695005893707275
Epoch: 4, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.2486398220062256
Epoch: 5, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4320504665374756
Epoch: 6, Steps: 8 | Train Loss: 0.955 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.761481761932373
Epoch: 7, Steps: 8 | Train Loss: 0.820 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.8812830448150635
Epoch: 8, Steps: 8 | Train Loss: 0.699 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.304079294204712
Epoch: 9, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.490 Vali Acc: 0.473 Test Loss: 1.490 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 10 cost time: 1.4377148151397705
Epoch: 10, Steps: 8 | Train Loss: 0.537 Vali Loss: 1.496 Vali Acc: 0.489 Test Loss: 1.496 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 1.6719396114349365
Epoch: 11, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.489 Vali Acc: 0.489 Test Loss: 1.489 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 1.660545825958252
Epoch: 12, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.509 Vali Acc: 0.473 Test Loss: 1.509 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.487612247467041
Epoch: 13, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.510 Vali Acc: 0.473 Test Loss: 1.510 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7935972213745117
Epoch: 14, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.517 Vali Acc: 0.458 Test Loss: 1.517 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3753197193145752
Epoch: 15, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.517 Vali Acc: 0.473 Test Loss: 1.517 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.753284215927124
Epoch: 16, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.521 Vali Acc: 0.473 Test Loss: 1.521 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9151806831359863
Epoch: 17, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.524 Vali Acc: 0.473 Test Loss: 1.524 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4259729385375977
Epoch: 18, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.543 Vali Acc: 0.466 Test Loss: 1.543 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4312748908996582
Epoch: 19, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.554 Vali Acc: 0.458 Test Loss: 1.554 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4670250415802002
Epoch: 20, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.564 Vali Acc: 0.450 Test Loss: 1.564 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5122261047363281
Epoch: 21, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.578 Vali Acc: 0.443 Test Loss: 1.578 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 871749
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.236505746841431
Epoch: 1, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.594 Vali Acc: 0.366 Test Loss: 1.594 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 1.4452283382415771
Epoch: 2, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (-0.366396 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4420289993286133
Epoch: 3, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.549959421157837
Epoch: 4, Steps: 8 | Train Loss: 1.163 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.272613763809204
Epoch: 5, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.478 Vali Acc: 0.450 Test Loss: 1.478 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.6180927753448486
Epoch: 6, Steps: 8 | Train Loss: 0.786 Vali Loss: 1.415 Vali Acc: 0.496 Test Loss: 1.415 Test Acc: 0.496
Validation loss decreased (-0.450367 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.3906517028808594
Epoch: 7, Steps: 8 | Train Loss: 0.625 Vali Loss: 1.385 Vali Acc: 0.557 Test Loss: 1.385 Test Acc: 0.557
Validation loss decreased (-0.496169 --> -0.557238).  Saving model ...
Epoch: 8 cost time: 1.4809224605560303
Epoch: 8, Steps: 8 | Train Loss: 0.469 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1072897911071777
Epoch: 9, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.345 Vali Acc: 0.519 Test Loss: 1.345 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0709617137908936
Epoch: 10, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.276 Vali Acc: 0.580 Test Loss: 1.276 Test Acc: 0.580
Validation loss decreased (-0.557238 --> -0.580140).  Saving model ...
Epoch: 11 cost time: 1.6580116748809814
Epoch: 11, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.285 Vali Acc: 0.557 Test Loss: 1.285 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4269993305206299
Epoch: 12, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.379 Vali Acc: 0.557 Test Loss: 1.379 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9703660011291504
Epoch: 13, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.422 Vali Acc: 0.542 Test Loss: 1.422 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6597342491149902
Epoch: 14, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.343 Vali Acc: 0.557 Test Loss: 1.343 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3638124465942383
Epoch: 15, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.350 Vali Acc: 0.557 Test Loss: 1.350 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3677959442138672
Epoch: 16, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.355 Vali Acc: 0.565 Test Loss: 1.355 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8134424686431885
Epoch: 17, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.384 Vali Acc: 0.550 Test Loss: 1.384 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8301591873168945
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.384 Vali Acc: 0.557 Test Loss: 1.384 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8976771831512451
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.473 Vali Acc: 0.565 Test Loss: 1.473 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.519608974456787
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.480 Vali Acc: 0.550 Test Loss: 1.480 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 248549
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.729161500930786
Epoch: 1, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.605 Vali Acc: 0.206 Test Loss: 1.605 Test Acc: 0.206
Validation loss decreased (inf --> -0.206091).  Saving model ...
Epoch: 2 cost time: 1.906895637512207
Epoch: 2, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.561 Vali Acc: 0.412 Test Loss: 1.561 Test Acc: 0.412
Validation loss decreased (-0.206091 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.9697926044464111
Epoch: 3, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.4918649196624756
Epoch: 4, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5424981117248535
Epoch: 5, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.506 Vali Acc: 0.420 Test Loss: 1.506 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.592761754989624
Epoch: 6, Steps: 8 | Train Loss: 1.028 Vali Loss: 1.471 Vali Acc: 0.435 Test Loss: 1.471 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 1.5830707550048828
Epoch: 7, Steps: 8 | Train Loss: 0.892 Vali Loss: 1.452 Vali Acc: 0.450 Test Loss: 1.452 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.4497666358947754
Epoch: 8, Steps: 8 | Train Loss: 0.765 Vali Loss: 1.430 Vali Acc: 0.458 Test Loss: 1.430 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 2.057988166809082
Epoch: 9, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.375 Vali Acc: 0.473 Test Loss: 1.375 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473269).  Saving model ...
Epoch: 10 cost time: 1.4739913940429688
Epoch: 10, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.340 Vali Acc: 0.481 Test Loss: 1.340 Test Acc: 0.481
Validation loss decreased (-0.473269 --> -0.480903).  Saving model ...
Epoch: 11 cost time: 1.4343159198760986
Epoch: 11, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.312 Vali Acc: 0.519 Test Loss: 1.312 Test Acc: 0.519
Validation loss decreased (-0.480903 --> -0.519071).  Saving model ...
Epoch: 12 cost time: 1.6356852054595947
Epoch: 12, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.280 Vali Acc: 0.534 Test Loss: 1.280 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534338).  Saving model ...
Epoch: 13 cost time: 1.6194651126861572
Epoch: 13, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.349 Vali Acc: 0.527 Test Loss: 1.349 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8879551887512207
Epoch: 14, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.315 Vali Acc: 0.534 Test Loss: 1.315 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.806119441986084
Epoch: 15, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.373 Vali Acc: 0.542 Test Loss: 1.373 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.4123740196228027
Epoch: 16, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6340315341949463
Epoch: 17, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.406 Vali Acc: 0.527 Test Loss: 1.406 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.964818000793457
Epoch: 18, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.344 Vali Acc: 0.542 Test Loss: 1.344 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 19 cost time: 1.3646421432495117
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.403 Vali Acc: 0.534 Test Loss: 1.403 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7190911769866943
Epoch: 20, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.436 Vali Acc: 0.534 Test Loss: 1.436 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6449201107025146
Epoch: 21, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.471 Vali Acc: 0.534 Test Loss: 1.471 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5761182308197021
Epoch: 22, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.430 Vali Acc: 0.542 Test Loss: 1.430 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3983259201049805
Epoch: 23, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.505 Vali Acc: 0.565 Test Loss: 1.505 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564870).  Saving model ...
Epoch: 24 cost time: 1.4626715183258057
Epoch: 24, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.484 Vali Acc: 0.557 Test Loss: 1.484 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.478423833847046
Epoch: 25, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.557 Vali Acc: 0.557 Test Loss: 1.557 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.823822021484375
Epoch: 26, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.560 Vali Acc: 0.542 Test Loss: 1.560 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9100370407104492
Epoch: 27, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.522 Vali Acc: 0.550 Test Loss: 1.522 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7771308422088623
Epoch: 28, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.519 Vali Acc: 0.542 Test Loss: 1.519 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8336491584777832
Epoch: 29, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.616 Vali Acc: 0.534 Test Loss: 1.616 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.561366081237793
Epoch: 30, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.755 Vali Acc: 0.550 Test Loss: 1.755 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7941009998321533
Epoch: 31, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.695 Vali Acc: 0.550 Test Loss: 1.695 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.0080387592315674
Epoch: 32, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.622 Vali Acc: 0.557 Test Loss: 1.622 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.610079050064087
Epoch: 33, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.619 Vali Acc: 0.573 Test Loss: 1.619 Test Acc: 0.573
Validation loss decreased (-0.564870 --> -0.572503).  Saving model ...
Epoch: 34 cost time: 1.4688739776611328
Epoch: 34, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.731 Vali Acc: 0.557 Test Loss: 1.731 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4455442428588867
Epoch: 35, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.824 Vali Acc: 0.534 Test Loss: 1.824 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.982635498046875
Epoch: 36, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.875 Vali Acc: 0.557 Test Loss: 1.875 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.684518575668335
Epoch: 37, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.804 Vali Acc: 0.557 Test Loss: 1.804 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6488113403320312
Epoch: 38, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.774 Vali Acc: 0.565 Test Loss: 1.774 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6431939601898193
Epoch: 39, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.864 Vali Acc: 0.550 Test Loss: 1.864 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.5272276401519775
Epoch: 40, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.846 Vali Acc: 0.550 Test Loss: 1.846 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.591080904006958
Epoch: 41, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.749 Vali Acc: 0.557 Test Loss: 1.749 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.6090235710144043
Epoch: 42, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.650 Vali Acc: 0.557 Test Loss: 1.650 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4105761051177979
Epoch: 43, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.736 Vali Acc: 0.565 Test Loss: 1.736 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 224549
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.608688592910767
Epoch: 1, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.622 Vali Acc: 0.237 Test Loss: 1.622 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.8261854648590088
Epoch: 2, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.599 Vali Acc: 0.412 Test Loss: 1.599 Test Acc: 0.412
Validation loss decreased (-0.236625 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.7243671417236328
Epoch: 3, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.580 Vali Acc: 0.420 Test Loss: 1.580 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.2777040004730225
Epoch: 4, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7423710823059082
Epoch: 5, Steps: 8 | Train Loss: 1.220 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.6904714107513428
Epoch: 6, Steps: 8 | Train Loss: 1.109 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.6498386859893799
Epoch: 7, Steps: 8 | Train Loss: 0.990 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.7565467357635498
Epoch: 8, Steps: 8 | Train Loss: 0.907 Vali Loss: 1.497 Vali Acc: 0.435 Test Loss: 1.497 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 9 cost time: 1.8308868408203125
Epoch: 9, Steps: 8 | Train Loss: 0.793 Vali Loss: 1.465 Vali Acc: 0.466 Test Loss: 1.465 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 1.8549432754516602
Epoch: 10, Steps: 8 | Train Loss: 0.713 Vali Loss: 1.475 Vali Acc: 0.473 Test Loss: 1.475 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 1.7116570472717285
Epoch: 11, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.442 Vali Acc: 0.496 Test Loss: 1.442 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 1.6367909908294678
Epoch: 12, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.404 Vali Acc: 0.504 Test Loss: 1.404 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 13 cost time: 1.6649789810180664
Epoch: 13, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.369 Vali Acc: 0.511 Test Loss: 1.369 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 14 cost time: 1.546717882156372
Epoch: 14, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.427 Vali Acc: 0.504 Test Loss: 1.427 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.810840129852295
Epoch: 15, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.398 Vali Acc: 0.527 Test Loss: 1.398 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526704).  Saving model ...
Epoch: 16 cost time: 1.5341651439666748
Epoch: 16, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.429 Vali Acc: 0.511 Test Loss: 1.429 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8377552032470703
Epoch: 17, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.353 Vali Acc: 0.527 Test Loss: 1.353 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 18 cost time: 1.6348047256469727
Epoch: 18, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7510547637939453
Epoch: 19, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.410 Vali Acc: 0.534 Test Loss: 1.410 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 20 cost time: 1.5227646827697754
Epoch: 20, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.487 Vali Acc: 0.511 Test Loss: 1.487 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6403398513793945
Epoch: 21, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.421 Vali Acc: 0.519 Test Loss: 1.421 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.833400011062622
Epoch: 22, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.400 Vali Acc: 0.557 Test Loss: 1.400 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 23 cost time: 2.066237449645996
Epoch: 23, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6071128845214844
Epoch: 24, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.467 Vali Acc: 0.519 Test Loss: 1.467 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6200587749481201
Epoch: 25, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.439 Vali Acc: 0.550 Test Loss: 1.439 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5669357776641846
Epoch: 26, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.466 Vali Acc: 0.557 Test Loss: 1.466 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6459219455718994
Epoch: 27, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.467 Vali Acc: 0.557 Test Loss: 1.467 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.628490924835205
Epoch: 28, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.476 Vali Acc: 0.527 Test Loss: 1.476 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.65240478515625
Epoch: 29, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.466 Vali Acc: 0.534 Test Loss: 1.466 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6975274085998535
Epoch: 30, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.458 Vali Acc: 0.527 Test Loss: 1.458 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8703174591064453
Epoch: 31, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.481 Vali Acc: 0.534 Test Loss: 1.481 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.770728349685669
Epoch: 32, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.491 Vali Acc: 0.527 Test Loss: 1.491 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 225477
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.892483949661255
Epoch: 1, Steps: 8 | Train Loss: 1.631 Vali Loss: 1.610 Vali Acc: 0.214 Test Loss: 1.610 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.2926602363586426
Epoch: 2, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.582 Vali Acc: 0.344 Test Loss: 1.582 Test Acc: 0.344
Validation loss decreased (-0.213724 --> -0.343496).  Saving model ...
Epoch: 3 cost time: 1.269286870956421
Epoch: 3, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.343496 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5031225681304932
Epoch: 4, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.731196641921997
Epoch: 5, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.489 Vali Acc: 0.420 Test Loss: 1.489 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.5987446308135986
Epoch: 6, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.483 Vali Acc: 0.427 Test Loss: 1.483 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.5174424648284912
Epoch: 7, Steps: 8 | Train Loss: 1.041 Vali Loss: 1.465 Vali Acc: 0.435 Test Loss: 1.465 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 8 cost time: 1.4019498825073242
Epoch: 8, Steps: 8 | Train Loss: 0.967 Vali Loss: 1.446 Vali Acc: 0.458 Test Loss: 1.446 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 1.753631830215454
Epoch: 9, Steps: 8 | Train Loss: 0.846 Vali Loss: 1.426 Vali Acc: 0.481 Test Loss: 1.426 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 1.656339168548584
Epoch: 10, Steps: 8 | Train Loss: 0.761 Vali Loss: 1.420 Vali Acc: 0.489 Test Loss: 1.420 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 1.308671236038208
Epoch: 11, Steps: 8 | Train Loss: 0.630 Vali Loss: 1.365 Vali Acc: 0.511 Test Loss: 1.365 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511437).  Saving model ...
Epoch: 12 cost time: 1.4947936534881592
Epoch: 12, Steps: 8 | Train Loss: 0.565 Vali Loss: 1.359 Vali Acc: 0.511 Test Loss: 1.359 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511437).  Saving model ...
Epoch: 13 cost time: 1.4927842617034912
Epoch: 13, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.338 Vali Acc: 0.519 Test Loss: 1.338 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519071).  Saving model ...
Epoch: 14 cost time: 1.6154460906982422
Epoch: 14, Steps: 8 | Train Loss: 0.388 Vali Loss: 1.334 Vali Acc: 0.534 Test Loss: 1.334 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534338).  Saving model ...
Epoch: 15 cost time: 1.375439167022705
Epoch: 15, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.316 Vali Acc: 0.550 Test Loss: 1.316 Test Acc: 0.550
Validation loss decreased (-0.534338 --> -0.549605).  Saving model ...
Epoch: 16 cost time: 1.5510821342468262
Epoch: 16, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.340 Vali Acc: 0.542 Test Loss: 1.340 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.599672794342041
Epoch: 17, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.317 Vali Acc: 0.573 Test Loss: 1.317 Test Acc: 0.573
Validation loss decreased (-0.549605 --> -0.572506).  Saving model ...
Epoch: 18 cost time: 1.4943337440490723
Epoch: 18, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.350 Vali Acc: 0.557 Test Loss: 1.350 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7388503551483154
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.413 Vali Acc: 0.527 Test Loss: 1.413 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5512018203735352
Epoch: 20, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4811768531799316
Epoch: 21, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.338 Vali Acc: 0.580 Test Loss: 1.338 Test Acc: 0.580
Validation loss decreased (-0.572506 --> -0.580139).  Saving model ...
Epoch: 22 cost time: 1.501542091369629
Epoch: 22, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.394 Vali Acc: 0.542 Test Loss: 1.394 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3009436130523682
Epoch: 23, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.475 Vali Acc: 0.542 Test Loss: 1.475 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3610358238220215
Epoch: 24, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.418 Vali Acc: 0.557 Test Loss: 1.418 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3867182731628418
Epoch: 25, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.366 Vali Acc: 0.573 Test Loss: 1.366 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.500636100769043
Epoch: 26, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.434 Vali Acc: 0.565 Test Loss: 1.434 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.484426498413086
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.469 Vali Acc: 0.534 Test Loss: 1.469 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3410353660583496
Epoch: 28, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.445 Vali Acc: 0.550 Test Loss: 1.445 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4021329879760742
Epoch: 29, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.412 Vali Acc: 0.565 Test Loss: 1.412 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.51542067527771
Epoch: 30, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.395 Vali Acc: 0.580 Test Loss: 1.395 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8715260028839111
Epoch: 31, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.463 Vali Acc: 0.542 Test Loss: 1.463 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 234117
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.614968299865723
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.596 Vali Acc: 0.191 Test Loss: 1.596 Test Acc: 0.191
Validation loss decreased (inf --> -0.190824).  Saving model ...
Epoch: 2 cost time: 1.6394262313842773
Epoch: 2, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.579 Vali Acc: 0.382 Test Loss: 1.579 Test Acc: 0.382
Validation loss decreased (-0.190824 --> -0.381664).  Saving model ...
Epoch: 3 cost time: 1.4555928707122803
Epoch: 3, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
Validation loss decreased (-0.381664 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5520081520080566
Epoch: 4, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.8966052532196045
Epoch: 5, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.3667876720428467
Epoch: 6, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.515 Vali Acc: 0.435 Test Loss: 1.515 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 1.4923322200775146
Epoch: 7, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.494 Vali Acc: 0.435 Test Loss: 1.494 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435100).  Saving model ...
Epoch: 8 cost time: 1.5464508533477783
Epoch: 8, Steps: 8 | Train Loss: 0.975 Vali Loss: 1.490 Vali Acc: 0.443 Test Loss: 1.490 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.3973331451416016
Epoch: 9, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.473 Vali Acc: 0.443 Test Loss: 1.473 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 1.6788079738616943
Epoch: 10, Steps: 8 | Train Loss: 0.804 Vali Loss: 1.469 Vali Acc: 0.450 Test Loss: 1.469 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 1.4586389064788818
Epoch: 11, Steps: 8 | Train Loss: 0.744 Vali Loss: 1.466 Vali Acc: 0.450 Test Loss: 1.466 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450367).  Saving model ...
Epoch: 12 cost time: 1.1750507354736328
Epoch: 12, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.448 Vali Acc: 0.473 Test Loss: 1.448 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 13 cost time: 1.404871940612793
Epoch: 13, Steps: 8 | Train Loss: 0.559 Vali Loss: 1.402 Vali Acc: 0.511 Test Loss: 1.402 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 1.8892779350280762
Epoch: 14, Steps: 8 | Train Loss: 0.528 Vali Loss: 1.416 Vali Acc: 0.496 Test Loss: 1.416 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9222612380981445
Epoch: 15, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.412 Vali Acc: 0.511 Test Loss: 1.412 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.408884048461914
Epoch: 16, Steps: 8 | Train Loss: 0.433 Vali Loss: 1.403 Vali Acc: 0.519 Test Loss: 1.403 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 17 cost time: 1.4692363739013672
Epoch: 17, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.408 Vali Acc: 0.489 Test Loss: 1.408 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6234900951385498
Epoch: 18, Steps: 8 | Train Loss: 0.358 Vali Loss: 1.417 Vali Acc: 0.511 Test Loss: 1.417 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8949167728424072
Epoch: 19, Steps: 8 | Train Loss: 0.357 Vali Loss: 1.415 Vali Acc: 0.489 Test Loss: 1.415 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.015839099884033
Epoch: 20, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.426 Vali Acc: 0.496 Test Loss: 1.426 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5960423946380615
Epoch: 21, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.428 Vali Acc: 0.489 Test Loss: 1.428 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5533661842346191
Epoch: 22, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.438 Vali Acc: 0.511 Test Loss: 1.438 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3287200927734375
Epoch: 23, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0864462852478027
Epoch: 24, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.455 Vali Acc: 0.504 Test Loss: 1.455 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8808305263519287
Epoch: 25, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.469 Vali Acc: 0.511 Test Loss: 1.469 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8143854141235352
Epoch: 26, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 257125
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.070313215255737
Epoch: 1, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.642 Vali Acc: 0.153 Test Loss: 1.642 Test Acc: 0.153
Validation loss decreased (inf --> -0.152655).  Saving model ...
Epoch: 2 cost time: 1.5201339721679688
Epoch: 2, Steps: 8 | Train Loss: 1.560 Vali Loss: 1.624 Vali Acc: 0.244 Test Loss: 1.624 Test Acc: 0.244
Validation loss decreased (-0.152655 --> -0.244259).  Saving model ...
Epoch: 3 cost time: 1.5305113792419434
Epoch: 3, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.605 Vali Acc: 0.313 Test Loss: 1.605 Test Acc: 0.313
Validation loss decreased (-0.244259 --> -0.312961).  Saving model ...
Epoch: 4 cost time: 1.2259540557861328
Epoch: 4, Steps: 8 | Train Loss: 1.318 Vali Loss: 1.599 Vali Acc: 0.450 Test Loss: 1.599 Test Acc: 0.450
Validation loss decreased (-0.312961 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.6722331047058105
Epoch: 5, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.578 Vali Acc: 0.458 Test Loss: 1.578 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.457999).  Saving model ...
Epoch: 6 cost time: 1.8963959217071533
Epoch: 6, Steps: 8 | Train Loss: 1.063 Vali Loss: 1.547 Vali Acc: 0.466 Test Loss: 1.547 Test Acc: 0.466
Validation loss decreased (-0.457999 --> -0.465633).  Saving model ...
Epoch: 7 cost time: 2.470479726791382
Epoch: 7, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.514 Vali Acc: 0.473 Test Loss: 1.514 Test Acc: 0.473
Validation loss decreased (-0.465633 --> -0.473267).  Saving model ...
Epoch: 8 cost time: 1.5430238246917725
Epoch: 8, Steps: 8 | Train Loss: 0.899 Vali Loss: 1.523 Vali Acc: 0.473 Test Loss: 1.523 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5417518615722656
Epoch: 9, Steps: 8 | Train Loss: 0.782 Vali Loss: 1.493 Vali Acc: 0.481 Test Loss: 1.493 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.5201947689056396
Epoch: 10, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.479 Vali Acc: 0.481 Test Loss: 1.479 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 1.9632256031036377
Epoch: 11, Steps: 8 | Train Loss: 0.618 Vali Loss: 1.490 Vali Acc: 0.496 Test Loss: 1.490 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 12 cost time: 1.8977952003479004
Epoch: 12, Steps: 8 | Train Loss: 0.570 Vali Loss: 1.478 Vali Acc: 0.504 Test Loss: 1.478 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 13 cost time: 2.1826770305633545
Epoch: 13, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.435 Vali Acc: 0.511 Test Loss: 1.435 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 1.668853998184204
Epoch: 14, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.446 Vali Acc: 0.519 Test Loss: 1.446 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.4489490985870361
Epoch: 15, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 2.001298427581787
Epoch: 16, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.527 Vali Acc: 0.519 Test Loss: 1.527 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9051053524017334
Epoch: 17, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.536 Vali Acc: 0.519 Test Loss: 1.536 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9685814380645752
Epoch: 18, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.418 Vali Acc: 0.527 Test Loss: 1.418 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 19 cost time: 1.4072325229644775
Epoch: 19, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 20 cost time: 1.8435516357421875
Epoch: 20, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.438 Vali Acc: 0.504 Test Loss: 1.438 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.61409330368042
Epoch: 21, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.469 Vali Acc: 0.519 Test Loss: 1.469 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8522720336914062
Epoch: 22, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0963215827941895
Epoch: 23, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.444 Vali Acc: 0.519 Test Loss: 1.444 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5209791660308838
Epoch: 24, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.496 Vali Acc: 0.519 Test Loss: 1.496 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8788318634033203
Epoch: 25, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.516 Vali Acc: 0.519 Test Loss: 1.516 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5214135646820068
Epoch: 26, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.497 Vali Acc: 0.542 Test Loss: 1.497 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541970).  Saving model ...
Epoch: 27 cost time: 1.8347675800323486
Epoch: 27, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.454 Vali Acc: 0.542 Test Loss: 1.454 Test Acc: 0.542
Validation loss decreased (-0.541970 --> -0.541970).  Saving model ...
Epoch: 28 cost time: 1.710947036743164
Epoch: 28, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.494 Vali Acc: 0.519 Test Loss: 1.494 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9752089977264404
Epoch: 29, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.535 Vali Acc: 0.534 Test Loss: 1.535 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7160377502441406
Epoch: 30, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.478 Vali Acc: 0.519 Test Loss: 1.478 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.917330265045166
Epoch: 31, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.519 Vali Acc: 0.519 Test Loss: 1.519 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.033511161804199
Epoch: 32, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.621 Vali Acc: 0.542 Test Loss: 1.621 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5681893825531006
Epoch: 33, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.544 Vali Acc: 0.534 Test Loss: 1.544 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.932328224182129
Epoch: 34, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.467 Vali Acc: 0.511 Test Loss: 1.467 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5532748699188232
Epoch: 35, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.468 Vali Acc: 0.519 Test Loss: 1.468 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7892282009124756
Epoch: 36, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.465 Vali Acc: 0.550 Test Loss: 1.465 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549604).  Saving model ...
Epoch: 37 cost time: 1.8452274799346924
Epoch: 37, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.489 Vali Acc: 0.550 Test Loss: 1.489 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5171241760253906
Epoch: 38, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.494 Vali Acc: 0.550 Test Loss: 1.494 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.73455810546875
Epoch: 39, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.496 Vali Acc: 0.542 Test Loss: 1.496 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5402209758758545
Epoch: 40, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.505 Vali Acc: 0.519 Test Loss: 1.505 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7939326763153076
Epoch: 41, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.624 Vali Acc: 0.534 Test Loss: 1.624 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.545398473739624
Epoch: 42, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.601 Vali Acc: 0.542 Test Loss: 1.601 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.6240639686584473
Epoch: 43, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.620 Vali Acc: 0.557 Test Loss: 1.620 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557236).  Saving model ...
Epoch: 44 cost time: 1.9932641983032227
Epoch: 44, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.685 Vali Acc: 0.534 Test Loss: 1.685 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.939640998840332
Epoch: 45, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.602 Vali Acc: 0.550 Test Loss: 1.602 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7461392879486084
Epoch: 46, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.595 Vali Acc: 0.542 Test Loss: 1.595 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7624549865722656
Epoch: 47, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.604 Vali Acc: 0.542 Test Loss: 1.604 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.0646450519561768
Epoch: 48, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.651 Vali Acc: 0.527 Test Loss: 1.651 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.572183609008789
Epoch: 49, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.681 Vali Acc: 0.527 Test Loss: 1.681 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.1464250087738037
Epoch: 50, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.713 Vali Acc: 0.534 Test Loss: 1.713 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 282053
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.330654144287109
Epoch: 1, Steps: 8 | Train Loss: 1.651 Vali Loss: 1.634 Vali Acc: 0.168 Test Loss: 1.634 Test Acc: 0.168
Validation loss decreased (inf --> -0.167923).  Saving model ...
Epoch: 2 cost time: 1.4102776050567627
Epoch: 2, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.619 Vali Acc: 0.191 Test Loss: 1.619 Test Acc: 0.191
Validation loss decreased (-0.167923 --> -0.190824).  Saving model ...
Epoch: 3 cost time: 1.421072244644165
Epoch: 3, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.602 Vali Acc: 0.374 Test Loss: 1.602 Test Acc: 0.374
Validation loss decreased (-0.190824 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 1.2915499210357666
Epoch: 4, Steps: 8 | Train Loss: 1.360 Vali Loss: 1.582 Vali Acc: 0.450 Test Loss: 1.582 Test Acc: 0.450
Validation loss decreased (-0.374030 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.7017121315002441
Epoch: 5, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.561 Vali Acc: 0.427 Test Loss: 1.561 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.528393268585205
Epoch: 6, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.544 Vali Acc: 0.427 Test Loss: 1.544 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5443909168243408
Epoch: 7, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3419432640075684
Epoch: 8, Steps: 8 | Train Loss: 0.971 Vali Loss: 1.506 Vali Acc: 0.435 Test Loss: 1.506 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7871730327606201
Epoch: 9, Steps: 8 | Train Loss: 0.885 Vali Loss: 1.514 Vali Acc: 0.427 Test Loss: 1.514 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4576423168182373
Epoch: 10, Steps: 8 | Train Loss: 0.837 Vali Loss: 1.505 Vali Acc: 0.435 Test Loss: 1.505 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5585458278656006
Epoch: 11, Steps: 8 | Train Loss: 0.732 Vali Loss: 1.494 Vali Acc: 0.435 Test Loss: 1.494 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.505781888961792
Epoch: 12, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.496 Vali Acc: 0.435 Test Loss: 1.496 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5134925842285156
Epoch: 13, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.468 Vali Acc: 0.443 Test Loss: 1.468 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4584875106811523
Epoch: 14, Steps: 8 | Train Loss: 0.572 Vali Loss: 1.473 Vali Acc: 0.466 Test Loss: 1.473 Test Acc: 0.466
Validation loss decreased (-0.450366 --> -0.465634).  Saving model ...
Epoch: 15 cost time: 1.2921175956726074
Epoch: 15, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.466 Vali Acc: 0.473 Test Loss: 1.466 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 16 cost time: 1.5340967178344727
Epoch: 16, Steps: 8 | Train Loss: 0.481 Vali Loss: 1.483 Vali Acc: 0.473 Test Loss: 1.483 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6542997360229492
Epoch: 17, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.454 Vali Acc: 0.473 Test Loss: 1.454 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 18 cost time: 1.734947919845581
Epoch: 18, Steps: 8 | Train Loss: 0.398 Vali Loss: 1.494 Vali Acc: 0.458 Test Loss: 1.494 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3339476585388184
Epoch: 19, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6795904636383057
Epoch: 20, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.479 Vali Acc: 0.481 Test Loss: 1.479 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 21 cost time: 1.587679386138916
Epoch: 21, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.446 Vali Acc: 0.489 Test Loss: 1.446 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 22 cost time: 1.3018639087677002
Epoch: 22, Steps: 8 | Train Loss: 0.317 Vali Loss: 1.457 Vali Acc: 0.473 Test Loss: 1.457 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5484898090362549
Epoch: 23, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.471 Vali Acc: 0.466 Test Loss: 1.471 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6276113986968994
Epoch: 24, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.442 Vali Acc: 0.481 Test Loss: 1.442 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4346342086791992
Epoch: 25, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4508485794067383
Epoch: 26, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.487 Vali Acc: 0.473 Test Loss: 1.487 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5280389785766602
Epoch: 27, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.499 Vali Acc: 0.458 Test Loss: 1.499 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5185668468475342
Epoch: 28, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.488 Vali Acc: 0.473 Test Loss: 1.488 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4813010692596436
Epoch: 29, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5165677070617676
Epoch: 30, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4972736835479736
Epoch: 31, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.508 Vali Acc: 0.473 Test Loss: 1.508 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 308901
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.932575702667236
Epoch: 1, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.9180762767791748
Epoch: 2, Steps: 8 | Train Loss: 1.293 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.678755521774292
Epoch: 3, Steps: 8 | Train Loss: 0.953 Vali Loss: 1.476 Vali Acc: 0.435 Test Loss: 1.476 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.6748175621032715
Epoch: 4, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.469 Vali Acc: 0.466 Test Loss: 1.469 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.8303501605987549
Epoch: 5, Steps: 8 | Train Loss: 0.286 Vali Loss: 1.469 Vali Acc: 0.519 Test Loss: 1.469 Test Acc: 0.519
Validation loss decreased (-0.465634 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 2.2008354663848877
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.519 Vali Acc: 0.519 Test Loss: 1.519 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0883853435516357
Epoch: 7, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.4299297332763672
Epoch: 8, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6651527881622314
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.602 Vali Acc: 0.527 Test Loss: 1.602 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6057345867156982
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.897 Vali Acc: 0.527 Test Loss: 1.897 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.483231544494629
Epoch: 11, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.148 Vali Acc: 0.519 Test Loss: 2.148 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9174928665161133
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.816 Vali Acc: 0.527 Test Loss: 1.816 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.528540849685669
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.527 Test Loss: 1.827 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8645260334014893
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.956 Vali Acc: 0.527 Test Loss: 1.956 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.898056983947754
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.222 Vali Acc: 0.527 Test Loss: 2.222 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.243324041366577
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.331 Vali Acc: 0.527 Test Loss: 2.331 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0369107723236084
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.335 Vali Acc: 0.527 Test Loss: 2.335 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2508677
model size : 9.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.415988206863403
Epoch: 1, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.977853775024414
Epoch: 2, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.831862449645996
Epoch: 3, Steps: 8 | Train Loss: 1.099 Vali Loss: 1.500 Vali Acc: 0.420 Test Loss: 1.500 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7917406558990479
Epoch: 4, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.407 Vali Acc: 0.450 Test Loss: 1.407 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450368).  Saving model ...
Epoch: 5 cost time: 1.8879063129425049
Epoch: 5, Steps: 8 | Train Loss: 0.512 Vali Loss: 1.395 Vali Acc: 0.489 Test Loss: 1.395 Test Acc: 0.489
Validation loss decreased (-0.450368 --> -0.488536).  Saving model ...
Epoch: 6 cost time: 2.049663782119751
Epoch: 6, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.398 Vali Acc: 0.496 Test Loss: 1.398 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.6813175678253174
Epoch: 7, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.269 Vali Acc: 0.542 Test Loss: 1.269 Test Acc: 0.542
Validation loss decreased (-0.496169 --> -0.541972).  Saving model ...
Epoch: 8 cost time: 1.5510039329528809
Epoch: 8, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9366722106933594
Epoch: 9, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.360 Vali Acc: 0.550 Test Loss: 1.360 Test Acc: 0.550
Validation loss decreased (-0.541972 --> -0.549605).  Saving model ...
Epoch: 10 cost time: 2.1512396335601807
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.461 Vali Acc: 0.542 Test Loss: 1.461 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0264475345611572
Epoch: 11, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.491 Vali Acc: 0.557 Test Loss: 1.491 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557237).  Saving model ...
Epoch: 12 cost time: 2.1047210693359375
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.507 Vali Acc: 0.550 Test Loss: 1.507 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9145920276641846
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.406 Vali Acc: 0.580 Test Loss: 1.406 Test Acc: 0.580
Validation loss decreased (-0.557237 --> -0.580139).  Saving model ...
Epoch: 14 cost time: 1.8829944133758545
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.389 Vali Acc: 0.588 Test Loss: 1.389 Test Acc: 0.588
Validation loss decreased (-0.580139 --> -0.587772).  Saving model ...
Epoch: 15 cost time: 1.9377543926239014
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.812 Vali Acc: 0.519 Test Loss: 1.812 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.933091163635254
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.714 Vali Acc: 0.550 Test Loss: 1.714 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8013525009155273
Epoch: 17, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.563 Vali Acc: 0.542 Test Loss: 1.563 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.046797037124634
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.709 Vali Acc: 0.542 Test Loss: 1.709 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7699968814849854
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.825 Vali Acc: 0.550 Test Loss: 1.825 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.869361400604248
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.058 Vali Acc: 0.519 Test Loss: 2.058 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0165488719940186
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.895 Vali Acc: 0.534 Test Loss: 1.895 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9556739330291748
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.435 Vali Acc: 0.595 Test Loss: 1.435 Test Acc: 0.595
Validation loss decreased (-0.587772 --> -0.595406).  Saving model ...
Epoch: 23 cost time: 1.8156380653381348
Epoch: 23, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.846 Vali Acc: 0.542 Test Loss: 1.846 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8244996070861816
Epoch: 24, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.813 Vali Acc: 0.557 Test Loss: 1.813 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6925196647644043
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.826 Vali Acc: 0.565 Test Loss: 1.826 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.951685905456543
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.021 Vali Acc: 0.557 Test Loss: 2.021 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7074673175811768
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.202 Vali Acc: 0.557 Test Loss: 2.202 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1797895431518555
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.172 Vali Acc: 0.557 Test Loss: 2.172 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.2774505615234375
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.307 Vali Acc: 0.588 Test Loss: 2.307 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3022475242614746
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.309 Vali Acc: 0.580 Test Loss: 2.309 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.991248607635498
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.374 Vali Acc: 0.573 Test Loss: 2.374 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.798710584640503
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.565 Vali Acc: 0.542 Test Loss: 2.565 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 2412677
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9459822177886963
Epoch: 1, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.592 Vali Acc: 0.305 Test Loss: 1.592 Test Acc: 0.305
Validation loss decreased (inf --> -0.305328).  Saving model ...
Epoch: 2 cost time: 2.0172548294067383
Epoch: 2, Steps: 8 | Train Loss: 1.450 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
Validation loss decreased (-0.305328 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5209338665008545
Epoch: 3, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5191681385040283
Epoch: 4, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.464 Vali Acc: 0.420 Test Loss: 1.464 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 5 cost time: 1.5120341777801514
Epoch: 5, Steps: 8 | Train Loss: 0.738 Vali Loss: 1.437 Vali Acc: 0.473 Test Loss: 1.437 Test Acc: 0.473
Validation loss decreased (-0.419833 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.5274124145507812
Epoch: 6, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.412 Vali Acc: 0.489 Test Loss: 1.412 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.3549222946166992
Epoch: 7, Steps: 8 | Train Loss: 0.352 Vali Loss: 1.416 Vali Acc: 0.489 Test Loss: 1.416 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6248538494110107
Epoch: 8, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
Validation loss decreased (-0.488535 --> -0.526704).  Saving model ...
Epoch: 9 cost time: 1.5546391010284424
Epoch: 9, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.633486270904541
Epoch: 10, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.363 Vali Acc: 0.527 Test Loss: 1.363 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.9011285305023193
Epoch: 11, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.407 Vali Acc: 0.534 Test Loss: 1.407 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 12 cost time: 2.2173378467559814
Epoch: 12, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.358 Vali Acc: 0.527 Test Loss: 1.358 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7133018970489502
Epoch: 13, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.355 Vali Acc: 0.534 Test Loss: 1.355 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534338).  Saving model ...
Epoch: 14 cost time: 1.7029578685760498
Epoch: 14, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.379 Vali Acc: 0.542 Test Loss: 1.379 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 15 cost time: 1.7426912784576416
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.380 Vali Acc: 0.542 Test Loss: 1.380 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9315590858459473
Epoch: 16, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.533 Vali Acc: 0.527 Test Loss: 1.533 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.193779230117798
Epoch: 17, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.468 Vali Acc: 0.534 Test Loss: 1.468 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9113264083862305
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.373 Vali Acc: 0.550 Test Loss: 1.373 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549605).  Saving model ...
Epoch: 19 cost time: 1.636218547821045
Epoch: 19, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.388 Vali Acc: 0.550 Test Loss: 1.388 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5771582126617432
Epoch: 20, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.381 Vali Acc: 0.542 Test Loss: 1.381 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9665892124176025
Epoch: 21, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.459 Vali Acc: 0.565 Test Loss: 1.459 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564871).  Saving model ...
Epoch: 22 cost time: 1.7050764560699463
Epoch: 22, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.498 Vali Acc: 0.565 Test Loss: 1.498 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7799413204193115
Epoch: 23, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.556 Vali Acc: 0.550 Test Loss: 1.556 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6821329593658447
Epoch: 24, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.534 Vali Acc: 0.542 Test Loss: 1.534 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9195225238800049
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.661 Vali Acc: 0.565 Test Loss: 1.661 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8108761310577393
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.715 Vali Acc: 0.542 Test Loss: 1.715 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6972954273223877
Epoch: 27, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.675 Vali Acc: 0.573 Test Loss: 1.675 Test Acc: 0.573
Validation loss decreased (-0.564871 --> -0.572502).  Saving model ...
Epoch: 28 cost time: 1.5906643867492676
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.649 Vali Acc: 0.573 Test Loss: 1.649 Test Acc: 0.573
Validation loss decreased (-0.572502 --> -0.572503).  Saving model ...
Epoch: 29 cost time: 1.385019302368164
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.789 Vali Acc: 0.588 Test Loss: 1.789 Test Acc: 0.588
Validation loss decreased (-0.572503 --> -0.587768).  Saving model ...
Epoch: 30 cost time: 1.626946210861206
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.823 Vali Acc: 0.588 Test Loss: 1.823 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8660049438476562
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.904 Vali Acc: 0.580 Test Loss: 1.904 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6249864101409912
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.996 Vali Acc: 0.580 Test Loss: 1.996 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.0266451835632324
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.097 Vali Acc: 0.557 Test Loss: 2.097 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7735002040863037
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.245 Vali Acc: 0.557 Test Loss: 2.245 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8471548557281494
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.330 Vali Acc: 0.550 Test Loss: 2.330 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.6562833786010742
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.247 Vali Acc: 0.595 Test Loss: 2.247 Test Acc: 0.595
Validation loss decreased (-0.587768 --> -0.595397).  Saving model ...
Epoch: 37 cost time: 1.6738495826721191
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.233 Vali Acc: 0.595 Test Loss: 2.233 Test Acc: 0.595
Validation loss decreased (-0.595397 --> -0.595398).  Saving model ...
Epoch: 38 cost time: 2.0419294834136963
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.294 Vali Acc: 0.595 Test Loss: 2.294 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.979381799697876
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.314 Vali Acc: 0.565 Test Loss: 2.314 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6765015125274658
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.412 Vali Acc: 0.557 Test Loss: 2.412 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5373797416687012
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.557 Test Loss: 2.448 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9649600982666016
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.474 Vali Acc: 0.565 Test Loss: 2.474 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.21230411529541
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.535 Vali Acc: 0.565 Test Loss: 2.535 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.773313283920288
Epoch: 44, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.608 Vali Acc: 0.573 Test Loss: 2.608 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.6112442016601562
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.678 Vali Acc: 0.580 Test Loss: 2.678 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.953188419342041
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.565 Test Loss: 2.661 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.7525920867919922
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.763 Vali Acc: 0.565 Test Loss: 2.763 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 2416389
model size : 9.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7797298431396484
Epoch: 1, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.617 Vali Acc: 0.183 Test Loss: 1.617 Test Acc: 0.183
Validation loss decreased (inf --> -0.183190).  Saving model ...
Epoch: 2 cost time: 1.5192415714263916
Epoch: 2, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (-0.183190 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.9241104125976562
Epoch: 3, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.0118470191955566
Epoch: 4, Steps: 8 | Train Loss: 0.995 Vali Loss: 1.517 Vali Acc: 0.427 Test Loss: 1.517 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.6271297931671143
Epoch: 5, Steps: 8 | Train Loss: 0.755 Vali Loss: 1.454 Vali Acc: 0.496 Test Loss: 1.454 Test Acc: 0.496
Validation loss decreased (-0.427466 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.7126026153564453
Epoch: 6, Steps: 8 | Train Loss: 0.552 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 7 cost time: 1.743096113204956
Epoch: 7, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.008718490600586
Epoch: 8, Steps: 8 | Train Loss: 0.286 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0201265811920166
Epoch: 9, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.328 Vali Acc: 0.542 Test Loss: 1.328 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 10 cost time: 1.7447848320007324
Epoch: 10, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.291 Vali Acc: 0.557 Test Loss: 1.291 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557239).  Saving model ...
Epoch: 11 cost time: 1.5306565761566162
Epoch: 11, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.344 Vali Acc: 0.542 Test Loss: 1.344 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7016968727111816
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.407 Vali Acc: 0.542 Test Loss: 1.407 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9629907608032227
Epoch: 13, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.401 Vali Acc: 0.534 Test Loss: 1.401 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7852399349212646
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.328 Vali Acc: 0.580 Test Loss: 1.328 Test Acc: 0.580
Validation loss decreased (-0.557239 --> -0.580139).  Saving model ...
Epoch: 15 cost time: 1.491100788116455
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.467 Vali Acc: 0.542 Test Loss: 1.467 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5895802974700928
Epoch: 16, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.551 Vali Acc: 0.550 Test Loss: 1.551 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7200629711151123
Epoch: 17, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.561 Vali Acc: 0.603 Test Loss: 1.561 Test Acc: 0.603
Validation loss decreased (-0.580139 --> -0.603038).  Saving model ...
Epoch: 18 cost time: 1.723050594329834
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.568 Vali Acc: 0.573 Test Loss: 1.568 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3623647689819336
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.596 Vali Acc: 0.550 Test Loss: 1.596 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9159445762634277
Epoch: 20, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.527 Vali Acc: 0.550 Test Loss: 1.527 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1414830684661865
Epoch: 21, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.522 Vali Acc: 0.550 Test Loss: 1.522 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.655961513519287
Epoch: 22, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.473 Vali Acc: 0.565 Test Loss: 1.473 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8759915828704834
Epoch: 23, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.651 Vali Acc: 0.573 Test Loss: 1.651 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.822641372680664
Epoch: 24, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.921 Vali Acc: 0.527 Test Loss: 1.921 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5984899997711182
Epoch: 25, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.919 Vali Acc: 0.527 Test Loss: 1.919 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5318527221679688
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.734 Vali Acc: 0.588 Test Loss: 1.734 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.744636058807373
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.590 Vali Acc: 0.588 Test Loss: 1.590 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 2450949
model size : 9.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.252256870269775
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.586 Vali Acc: 0.412 Test Loss: 1.586 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.589428424835205
Epoch: 2, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.600999116897583
Epoch: 3, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.878328561782837
Epoch: 4, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.8112010955810547
Epoch: 5, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.083793878555298
Epoch: 6, Steps: 8 | Train Loss: 0.672 Vali Loss: 1.506 Vali Acc: 0.450 Test Loss: 1.506 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.5486812591552734
Epoch: 7, Steps: 8 | Train Loss: 0.547 Vali Loss: 1.485 Vali Acc: 0.466 Test Loss: 1.485 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.579218864440918
Epoch: 8, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 1.3705382347106934
Epoch: 9, Steps: 8 | Train Loss: 0.352 Vali Loss: 1.490 Vali Acc: 0.489 Test Loss: 1.490 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.7418885231018066
Epoch: 10, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.549 Vali Acc: 0.473 Test Loss: 1.549 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6435251235961914
Epoch: 11, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5907132625579834
Epoch: 12, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.408 Vali Acc: 0.519 Test Loss: 1.408 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 13 cost time: 1.9408502578735352
Epoch: 13, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.452 Vali Acc: 0.519 Test Loss: 1.452 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8327176570892334
Epoch: 14, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.468 Vali Acc: 0.519 Test Loss: 1.468 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4355859756469727
Epoch: 15, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.436 Vali Acc: 0.519 Test Loss: 1.436 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4603142738342285
Epoch: 16, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.447 Vali Acc: 0.519 Test Loss: 1.447 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.227715253829956
Epoch: 17, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.449 Vali Acc: 0.519 Test Loss: 1.449 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5311083793640137
Epoch: 18, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.495 Vali Acc: 0.519 Test Loss: 1.495 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8298249244689941
Epoch: 19, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.523 Vali Acc: 0.496 Test Loss: 1.523 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5277481079101562
Epoch: 20, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.494 Vali Acc: 0.519 Test Loss: 1.494 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.632829189300537
Epoch: 21, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9233818054199219
Epoch: 22, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.451 Vali Acc: 0.527 Test Loss: 1.451 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 23 cost time: 1.5297386646270752
Epoch: 23, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7361977100372314
Epoch: 24, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.470 Vali Acc: 0.519 Test Loss: 1.470 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.676933765411377
Epoch: 25, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.502 Vali Acc: 0.504 Test Loss: 1.502 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6108152866363525
Epoch: 26, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.434 Vali Acc: 0.534 Test Loss: 1.434 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 27 cost time: 1.6949589252471924
Epoch: 27, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.359 Vali Acc: 0.565 Test Loss: 1.359 Test Acc: 0.565
Validation loss decreased (-0.534337 --> -0.564872).  Saving model ...
Epoch: 28 cost time: 1.7975785732269287
Epoch: 28, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.405 Vali Acc: 0.565 Test Loss: 1.405 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4281041622161865
Epoch: 29, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.441 Vali Acc: 0.550 Test Loss: 1.441 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4323325157165527
Epoch: 30, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.499 Vali Acc: 0.519 Test Loss: 1.499 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5210769176483154
Epoch: 31, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.561 Vali Acc: 0.527 Test Loss: 1.561 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7342545986175537
Epoch: 32, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.482 Vali Acc: 0.519 Test Loss: 1.482 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.586716890335083
Epoch: 33, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.419191598892212
Epoch: 34, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.507 Vali Acc: 0.504 Test Loss: 1.507 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.8727257251739502
Epoch: 35, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.488 Vali Acc: 0.527 Test Loss: 1.488 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7784037590026855
Epoch: 36, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.525 Vali Acc: 0.496 Test Loss: 1.525 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.466973066329956
Epoch: 37, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.413 Vali Acc: 0.511 Test Loss: 1.413 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2542981
model size : 9.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9000015258789062
Epoch: 1, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.615 Vali Acc: 0.252 Test Loss: 1.615 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.656235694885254
Epoch: 2, Steps: 8 | Train Loss: 1.460 Vali Loss: 1.563 Vali Acc: 0.435 Test Loss: 1.563 Test Acc: 0.435
Validation loss decreased (-0.251892 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.5578744411468506
Epoch: 3, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.525 Vali Acc: 0.427 Test Loss: 1.525 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9598171710968018
Epoch: 4, Steps: 8 | Train Loss: 0.945 Vali Loss: 1.488 Vali Acc: 0.443 Test Loss: 1.488 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.5264313220977783
Epoch: 5, Steps: 8 | Train Loss: 0.738 Vali Loss: 1.467 Vali Acc: 0.489 Test Loss: 1.467 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 1.5053431987762451
Epoch: 6, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.423 Vali Acc: 0.519 Test Loss: 1.423 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.7514281272888184
Epoch: 7, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.371 Vali Acc: 0.534 Test Loss: 1.371 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 8 cost time: 1.4379520416259766
Epoch: 8, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.365 Vali Acc: 0.534 Test Loss: 1.365 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.3197259902954102
Epoch: 9, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.319 Vali Acc: 0.534 Test Loss: 1.319 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534338).  Saving model ...
Epoch: 10 cost time: 1.6110355854034424
Epoch: 10, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.362 Vali Acc: 0.542 Test Loss: 1.362 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 11 cost time: 1.6649456024169922
Epoch: 11, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.394 Vali Acc: 0.534 Test Loss: 1.394 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.634171485900879
Epoch: 12, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.385 Vali Acc: 0.550 Test Loss: 1.385 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 13 cost time: 1.3904945850372314
Epoch: 13, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.402 Vali Acc: 0.534 Test Loss: 1.402 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6909000873565674
Epoch: 14, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.377 Vali Acc: 0.550 Test Loss: 1.377 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549605).  Saving model ...
Epoch: 15 cost time: 1.4200167655944824
Epoch: 15, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.409 Vali Acc: 0.542 Test Loss: 1.409 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5581505298614502
Epoch: 16, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.389 Vali Acc: 0.573 Test Loss: 1.389 Test Acc: 0.573
Validation loss decreased (-0.549605 --> -0.572505).  Saving model ...
Epoch: 17 cost time: 1.8014850616455078
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.869246006011963
Epoch: 18, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.458 Vali Acc: 0.519 Test Loss: 1.458 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6850104331970215
Epoch: 19, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.410 Vali Acc: 0.519 Test Loss: 1.410 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6903202533721924
Epoch: 20, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5416524410247803
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.448 Vali Acc: 0.542 Test Loss: 1.448 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.790825366973877
Epoch: 22, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.573 Vali Acc: 0.534 Test Loss: 1.573 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6134438514709473
Epoch: 23, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.576 Vali Acc: 0.534 Test Loss: 1.576 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8325772285461426
Epoch: 24, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.418 Vali Acc: 0.542 Test Loss: 1.418 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3672480583190918
Epoch: 25, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.416 Vali Acc: 0.550 Test Loss: 1.416 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7952923774719238
Epoch: 26, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.536 Vali Acc: 0.573 Test Loss: 1.536 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2642693
model size : 10.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9883675575256348
Epoch: 1, Steps: 8 | Train Loss: 1.590 Vali Loss: 1.597 Vali Acc: 0.382 Test Loss: 1.597 Test Acc: 0.382
Validation loss decreased (inf --> -0.381663).  Saving model ...
Epoch: 2 cost time: 1.71368408203125
Epoch: 2, Steps: 8 | Train Loss: 1.436 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
Validation loss decreased (-0.381663 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.808717966079712
Epoch: 3, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.543 Vali Acc: 0.420 Test Loss: 1.543 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.7604081630706787
Epoch: 4, Steps: 8 | Train Loss: 1.039 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.0953867435455322
Epoch: 5, Steps: 8 | Train Loss: 0.809 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.556638479232788
Epoch: 6, Steps: 8 | Train Loss: 0.684 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.840252161026001
Epoch: 7, Steps: 8 | Train Loss: 0.565 Vali Loss: 1.494 Vali Acc: 0.443 Test Loss: 1.494 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 2.006638526916504
Epoch: 8, Steps: 8 | Train Loss: 0.445 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450366).  Saving model ...
Epoch: 9 cost time: 2.3362598419189453
Epoch: 9, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.523 Vali Acc: 0.458 Test Loss: 1.523 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 10 cost time: 1.5609898567199707
Epoch: 10, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.474 Vali Acc: 0.458 Test Loss: 1.474 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458001).  Saving model ...
Epoch: 11 cost time: 1.7156577110290527
Epoch: 11, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.509 Vali Acc: 0.450 Test Loss: 1.509 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0969226360321045
Epoch: 12, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.488 Vali Acc: 0.450 Test Loss: 1.488 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.600684642791748
Epoch: 13, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.498 Vali Acc: 0.466 Test Loss: 1.498 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 14 cost time: 1.9900524616241455
Epoch: 14, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.541 Vali Acc: 0.450 Test Loss: 1.541 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8646202087402344
Epoch: 15, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.560 Vali Acc: 0.458 Test Loss: 1.560 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1586179733276367
Epoch: 16, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.585 Vali Acc: 0.450 Test Loss: 1.585 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7209157943725586
Epoch: 17, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.593 Vali Acc: 0.450 Test Loss: 1.593 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0432119369506836
Epoch: 18, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.585 Vali Acc: 0.450 Test Loss: 1.585 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8198959827423096
Epoch: 19, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.565 Vali Acc: 0.458 Test Loss: 1.565 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7525417804718018
Epoch: 20, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.506 Vali Acc: 0.458 Test Loss: 1.506 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.001365900039673
Epoch: 21, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.555 Vali Acc: 0.450 Test Loss: 1.555 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.095767021179199
Epoch: 22, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.518 Vali Acc: 0.450 Test Loss: 1.518 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7983217239379883
Epoch: 23, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.488 Vali Acc: 0.458 Test Loss: 1.488 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 2750085
model size : 10.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.557309865951538
Epoch: 1, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.567 Vali Acc: 0.427 Test Loss: 1.567 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.7721025943756104
Epoch: 2, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.568793535232544
Epoch: 3, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7681598663330078
Epoch: 4, Steps: 8 | Train Loss: 0.839 Vali Loss: 1.429 Vali Acc: 0.427 Test Loss: 1.429 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427467).  Saving model ...
Epoch: 5 cost time: 1.5060455799102783
Epoch: 5, Steps: 8 | Train Loss: 0.625 Vali Loss: 1.363 Vali Acc: 0.489 Test Loss: 1.363 Test Acc: 0.489
Validation loss decreased (-0.427467 --> -0.488536).  Saving model ...
Epoch: 6 cost time: 1.5326247215270996
Epoch: 6, Steps: 8 | Train Loss: 0.386 Vali Loss: 1.341 Vali Acc: 0.511 Test Loss: 1.341 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511437).  Saving model ...
Epoch: 7 cost time: 1.740271806716919
Epoch: 7, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.310 Vali Acc: 0.527 Test Loss: 1.310 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.5031991004943848
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.295 Vali Acc: 0.527 Test Loss: 1.295 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526705).  Saving model ...
Epoch: 9 cost time: 1.5935208797454834
Epoch: 9, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.336 Vali Acc: 0.527 Test Loss: 1.336 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6211605072021484
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9907190799713135
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.277 Vali Acc: 0.519 Test Loss: 1.277 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7774379253387451
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.400 Vali Acc: 0.519 Test Loss: 1.400 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4968984127044678
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.421 Vali Acc: 0.519 Test Loss: 1.421 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6554052829742432
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.520 Vali Acc: 0.542 Test Loss: 1.520 Test Acc: 0.542
Validation loss decreased (-0.526705 --> -0.541970).  Saving model ...
Epoch: 15 cost time: 1.666405439376831
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.583 Vali Acc: 0.550 Test Loss: 1.583 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549602).  Saving model ...
Epoch: 16 cost time: 1.5782639980316162
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.717 Vali Acc: 0.527 Test Loss: 1.717 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7475602626800537
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.882 Vali Acc: 0.519 Test Loss: 1.882 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9355275630950928
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.956 Vali Acc: 0.519 Test Loss: 1.956 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.886518955230713
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.887 Vali Acc: 0.519 Test Loss: 1.887 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5130279064178467
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.854 Vali Acc: 0.519 Test Loss: 1.854 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5650606155395508
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.880 Vali Acc: 0.519 Test Loss: 1.880 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9135253429412842
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.002 Vali Acc: 0.511 Test Loss: 2.002 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7683184146881104
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.092 Vali Acc: 0.511 Test Loss: 2.092 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0333821773529053
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.103 Vali Acc: 0.511 Test Loss: 2.103 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.860905408859253
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.184 Vali Acc: 0.511 Test Loss: 2.184 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 746437
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8777287006378174
Epoch: 1, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.588 Vali Acc: 0.397 Test Loss: 1.588 Test Acc: 0.397
Validation loss decreased (inf --> -0.396931).  Saving model ...
Epoch: 2 cost time: 2.1168124675750732
Epoch: 2, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5395267009735107
Epoch: 3, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.65053391456604
Epoch: 4, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.512 Vali Acc: 0.427 Test Loss: 1.512 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.5072946548461914
Epoch: 5, Steps: 8 | Train Loss: 0.904 Vali Loss: 1.475 Vali Acc: 0.443 Test Loss: 1.475 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.780961513519287
Epoch: 6, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.411 Vali Acc: 0.489 Test Loss: 1.411 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488536).  Saving model ...
Epoch: 7 cost time: 1.8294262886047363
Epoch: 7, Steps: 8 | Train Loss: 0.598 Vali Loss: 1.423 Vali Acc: 0.489 Test Loss: 1.423 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9155919551849365
Epoch: 8, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.362 Vali Acc: 0.527 Test Loss: 1.362 Test Acc: 0.527
Validation loss decreased (-0.488536 --> -0.526704).  Saving model ...
Epoch: 9 cost time: 1.7217488288879395
Epoch: 9, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.405 Vali Acc: 0.534 Test Loss: 1.405 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 10 cost time: 1.6459887027740479
Epoch: 10, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.378 Vali Acc: 0.557 Test Loss: 1.378 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 11 cost time: 1.5556004047393799
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.412 Vali Acc: 0.557 Test Loss: 1.412 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.724332332611084
Epoch: 12, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7394530773162842
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.439 Vali Acc: 0.542 Test Loss: 1.439 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8942592144012451
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.389 Vali Acc: 0.542 Test Loss: 1.389 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7449283599853516
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.449 Vali Acc: 0.557 Test Loss: 1.449 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8072776794433594
Epoch: 16, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.508 Vali Acc: 0.550 Test Loss: 1.508 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8697528839111328
Epoch: 17, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.516 Vali Acc: 0.534 Test Loss: 1.516 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.541581392288208
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.576 Vali Acc: 0.542 Test Loss: 1.576 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4510786533355713
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.548 Vali Acc: 0.542 Test Loss: 1.548 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5855073928833008
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.588 Vali Acc: 0.534 Test Loss: 1.588 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 698437
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.392783880233765
Epoch: 1, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.585 Vali Acc: 0.359 Test Loss: 1.585 Test Acc: 0.359
Validation loss decreased (inf --> -0.358763).  Saving model ...
Epoch: 2 cost time: 1.4955496788024902
Epoch: 2, Steps: 8 | Train Loss: 1.462 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.358763 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.3344783782958984
Epoch: 3, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5787971019744873
Epoch: 4, Steps: 8 | Train Loss: 1.166 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5608086585998535
Epoch: 5, Steps: 8 | Train Loss: 1.027 Vali Loss: 1.485 Vali Acc: 0.420 Test Loss: 1.485 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.726771354675293
Epoch: 6, Steps: 8 | Train Loss: 0.847 Vali Loss: 1.465 Vali Acc: 0.443 Test Loss: 1.465 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.408904790878296
Epoch: 7, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.435 Vali Acc: 0.458 Test Loss: 1.435 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 1.8644816875457764
Epoch: 8, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.397 Vali Acc: 0.473 Test Loss: 1.397 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 1.788257360458374
Epoch: 9, Steps: 8 | Train Loss: 0.454 Vali Loss: 1.404 Vali Acc: 0.481 Test Loss: 1.404 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 1.4044876098632812
Epoch: 10, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.360 Vali Acc: 0.519 Test Loss: 1.360 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.2515511512756348
Epoch: 11, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.352 Vali Acc: 0.527 Test Loss: 1.352 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 1.2469820976257324
Epoch: 12, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.346 Vali Acc: 0.519 Test Loss: 1.346 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4775543212890625
Epoch: 13, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.389 Vali Acc: 0.527 Test Loss: 1.389 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8307795524597168
Epoch: 14, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.331 Vali Acc: 0.527 Test Loss: 1.331 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 15 cost time: 1.4036352634429932
Epoch: 15, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.318 Vali Acc: 0.527 Test Loss: 1.318 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 16 cost time: 1.467958927154541
Epoch: 16, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3765509128570557
Epoch: 17, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.263838529586792
Epoch: 18, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3714838027954102
Epoch: 19, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.439 Vali Acc: 0.519 Test Loss: 1.439 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2840142250061035
Epoch: 20, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3459455966949463
Epoch: 21, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.338 Vali Acc: 0.534 Test Loss: 1.338 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 22 cost time: 1.3890538215637207
Epoch: 22, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5242984294891357
Epoch: 23, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.363 Vali Acc: 0.542 Test Loss: 1.363 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 24 cost time: 1.6061136722564697
Epoch: 24, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.444 Vali Acc: 0.519 Test Loss: 1.444 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4991302490234375
Epoch: 25, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5113072395324707
Epoch: 26, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5985970497131348
Epoch: 27, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.449 Vali Acc: 0.534 Test Loss: 1.449 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7698044776916504
Epoch: 28, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.604 Vali Acc: 0.534 Test Loss: 1.604 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7082552909851074
Epoch: 29, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.548 Vali Acc: 0.527 Test Loss: 1.548 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3016681671142578
Epoch: 30, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7470920085906982
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.473 Vali Acc: 0.542 Test Loss: 1.473 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6411614418029785
Epoch: 32, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.536 Vali Acc: 0.542 Test Loss: 1.536 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4082517623901367
Epoch: 33, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.635 Vali Acc: 0.534 Test Loss: 1.635 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 700293
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.619537115097046
Epoch: 1, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.591 Vali Acc: 0.389 Test Loss: 1.591 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.659209966659546
Epoch: 2, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4851229190826416
Epoch: 3, Steps: 8 | Train Loss: 1.327 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5955262184143066
Epoch: 4, Steps: 8 | Train Loss: 1.184 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4056897163391113
Epoch: 5, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.533 Vali Acc: 0.427 Test Loss: 1.533 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.6869182586669922
Epoch: 6, Steps: 8 | Train Loss: 0.899 Vali Loss: 1.504 Vali Acc: 0.435 Test Loss: 1.504 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 1.6664631366729736
Epoch: 7, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.462 Vali Acc: 0.458 Test Loss: 1.462 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 1.898313283920288
Epoch: 8, Steps: 8 | Train Loss: 0.625 Vali Loss: 1.404 Vali Acc: 0.496 Test Loss: 1.404 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.68489408493042
Epoch: 9, Steps: 8 | Train Loss: 0.501 Vali Loss: 1.387 Vali Acc: 0.504 Test Loss: 1.387 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.6128084659576416
Epoch: 10, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.328 Vali Acc: 0.534 Test Loss: 1.328 Test Acc: 0.534
Validation loss decreased (-0.503803 --> -0.534338).  Saving model ...
Epoch: 11 cost time: 1.812375783920288
Epoch: 11, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7781662940979004
Epoch: 12, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.327 Vali Acc: 0.534 Test Loss: 1.327 Test Acc: 0.534
Validation loss decreased (-0.534338 --> -0.534338).  Saving model ...
Epoch: 13 cost time: 1.5011065006256104
Epoch: 13, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.314 Vali Acc: 0.542 Test Loss: 1.314 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 14 cost time: 1.5982894897460938
Epoch: 14, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.296 Vali Acc: 0.542 Test Loss: 1.296 Test Acc: 0.542
Validation loss decreased (-0.541972 --> -0.541972).  Saving model ...
Epoch: 15 cost time: 1.8070859909057617
Epoch: 15, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.331 Vali Acc: 0.534 Test Loss: 1.331 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0044095516204834
Epoch: 16, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.360 Vali Acc: 0.534 Test Loss: 1.360 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.907390832901001
Epoch: 17, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.364 Vali Acc: 0.542 Test Loss: 1.364 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8710050582885742
Epoch: 18, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.362 Vali Acc: 0.542 Test Loss: 1.362 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9737212657928467
Epoch: 19, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.365 Vali Acc: 0.542 Test Loss: 1.365 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.601515293121338
Epoch: 20, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.364 Vali Acc: 0.550 Test Loss: 1.364 Test Acc: 0.550
Validation loss decreased (-0.541972 --> -0.549605).  Saving model ...
Epoch: 21 cost time: 1.479365587234497
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.381 Vali Acc: 0.542 Test Loss: 1.381 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.468773365020752
Epoch: 22, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.377 Vali Acc: 0.542 Test Loss: 1.377 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3764235973358154
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.314 Vali Acc: 0.557 Test Loss: 1.314 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 24 cost time: 1.510941743850708
Epoch: 24, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.353 Vali Acc: 0.550 Test Loss: 1.353 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.763380765914917
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.367 Vali Acc: 0.588 Test Loss: 1.367 Test Acc: 0.588
Validation loss decreased (-0.557239 --> -0.587773).  Saving model ...
Epoch: 26 cost time: 1.5152702331542969
Epoch: 26, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.353 Vali Acc: 0.588 Test Loss: 1.353 Test Acc: 0.588
Validation loss decreased (-0.587773 --> -0.587773).  Saving model ...
Epoch: 27 cost time: 1.7757291793823242
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.402 Vali Acc: 0.580 Test Loss: 1.402 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8297009468078613
Epoch: 28, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.399 Vali Acc: 0.573 Test Loss: 1.399 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7512845993041992
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.533 Vali Acc: 0.550 Test Loss: 1.533 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8194377422332764
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.573 Vali Acc: 0.557 Test Loss: 1.573 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7587921619415283
Epoch: 31, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.527 Vali Acc: 0.550 Test Loss: 1.527 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5470051765441895
Epoch: 32, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.540 Vali Acc: 0.580 Test Loss: 1.540 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7664039134979248
Epoch: 33, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.464 Vali Acc: 0.580 Test Loss: 1.464 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7043602466583252
Epoch: 34, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.418 Vali Acc: 0.573 Test Loss: 1.418 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6504971981048584
Epoch: 35, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.405 Vali Acc: 0.573 Test Loss: 1.405 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.567866563796997
Epoch: 36, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.491 Vali Acc: 0.588 Test Loss: 1.491 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 717573
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.117825508117676
Epoch: 1, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.600 Vali Acc: 0.351 Test Loss: 1.600 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.5748472213745117
Epoch: 2, Steps: 8 | Train Loss: 1.484 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (-0.351129 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.9404613971710205
Epoch: 3, Steps: 8 | Train Loss: 1.336 Vali Loss: 1.569 Vali Acc: 0.420 Test Loss: 1.569 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.553177833557129
Epoch: 4, Steps: 8 | Train Loss: 1.191 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.3514471054077148
Epoch: 5, Steps: 8 | Train Loss: 1.050 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.595780849456787
Epoch: 6, Steps: 8 | Train Loss: 0.920 Vali Loss: 1.503 Vali Acc: 0.427 Test Loss: 1.503 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.6308939456939697
Epoch: 7, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.465 Vali Acc: 0.443 Test Loss: 1.465 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.5030417442321777
Epoch: 8, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.438 Vali Acc: 0.481 Test Loss: 1.438 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.5029091835021973
Epoch: 9, Steps: 8 | Train Loss: 0.550 Vali Loss: 1.434 Vali Acc: 0.489 Test Loss: 1.434 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.2744395732879639
Epoch: 10, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.430 Vali Acc: 0.496 Test Loss: 1.430 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 1.5055007934570312
Epoch: 11, Steps: 8 | Train Loss: 0.394 Vali Loss: 1.406 Vali Acc: 0.496 Test Loss: 1.406 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 1.5370724201202393
Epoch: 12, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.420 Vali Acc: 0.496 Test Loss: 1.420 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.435927152633667
Epoch: 13, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.375 Vali Acc: 0.496 Test Loss: 1.375 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 14 cost time: 1.3594887256622314
Epoch: 14, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.368 Vali Acc: 0.511 Test Loss: 1.368 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511437).  Saving model ...
Epoch: 15 cost time: 1.387695074081421
Epoch: 15, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.386 Vali Acc: 0.519 Test Loss: 1.386 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 1.3258421421051025
Epoch: 16, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.395 Vali Acc: 0.519 Test Loss: 1.395 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5951471328735352
Epoch: 17, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.380 Vali Acc: 0.519 Test Loss: 1.380 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 18 cost time: 1.4190733432769775
Epoch: 18, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.401 Vali Acc: 0.519 Test Loss: 1.401 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3961265087127686
Epoch: 19, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.406 Vali Acc: 0.511 Test Loss: 1.406 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2936983108520508
Epoch: 20, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.428 Vali Acc: 0.519 Test Loss: 1.428 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7049007415771484
Epoch: 21, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 22 cost time: 1.876859188079834
Epoch: 22, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 23 cost time: 1.5994391441345215
Epoch: 23, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6087653636932373
Epoch: 24, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.421 Vali Acc: 0.519 Test Loss: 1.421 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6899168491363525
Epoch: 25, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.437 Vali Acc: 0.519 Test Loss: 1.437 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5935840606689453
Epoch: 26, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.436 Vali Acc: 0.519 Test Loss: 1.436 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.760087490081787
Epoch: 27, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4591362476348877
Epoch: 28, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.434903860092163
Epoch: 29, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.446 Vali Acc: 0.527 Test Loss: 1.446 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.828104019165039
Epoch: 30, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.478 Vali Acc: 0.504 Test Loss: 1.478 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7926161289215088
Epoch: 31, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.430 Vali Acc: 0.527 Test Loss: 1.430 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4998962879180908
Epoch: 32, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 763589
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.86588191986084
Epoch: 1, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.623 Vali Acc: 0.237 Test Loss: 1.623 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.68086838722229
Epoch: 2, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.591 Vali Acc: 0.374 Test Loss: 1.591 Test Acc: 0.374
Validation loss decreased (-0.236625 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.4652063846588135
Epoch: 3, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.551 Vali Acc: 0.450 Test Loss: 1.551 Test Acc: 0.450
Validation loss decreased (-0.374030 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.496478796005249
Epoch: 4, Steps: 8 | Train Loss: 1.173 Vali Loss: 1.513 Vali Acc: 0.443 Test Loss: 1.513 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.493619441986084
Epoch: 5, Steps: 8 | Train Loss: 1.023 Vali Loss: 1.489 Vali Acc: 0.443 Test Loss: 1.489 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6808252334594727
Epoch: 6, Steps: 8 | Train Loss: 0.881 Vali Loss: 1.452 Vali Acc: 0.473 Test Loss: 1.452 Test Acc: 0.473
Validation loss decreased (-0.450366 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 1.8229479789733887
Epoch: 7, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.421 Vali Acc: 0.504 Test Loss: 1.421 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.4092381000518799
Epoch: 8, Steps: 8 | Train Loss: 0.614 Vali Loss: 1.406 Vali Acc: 0.511 Test Loss: 1.406 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.4663586616516113
Epoch: 9, Steps: 8 | Train Loss: 0.500 Vali Loss: 1.415 Vali Acc: 0.542 Test Loss: 1.415 Test Acc: 0.542
Validation loss decreased (-0.511436 --> -0.541971).  Saving model ...
Epoch: 10 cost time: 1.7497313022613525
Epoch: 10, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.383 Vali Acc: 0.542 Test Loss: 1.383 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 11 cost time: 1.8118808269500732
Epoch: 11, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.357 Vali Acc: 0.534 Test Loss: 1.357 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8518946170806885
Epoch: 12, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.372 Vali Acc: 0.542 Test Loss: 1.372 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 13 cost time: 1.454239845275879
Epoch: 13, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.351 Vali Acc: 0.550 Test Loss: 1.351 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549605).  Saving model ...
Epoch: 14 cost time: 1.683197259902954
Epoch: 14, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.352 Vali Acc: 0.542 Test Loss: 1.352 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.84505295753479
Epoch: 15, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.340 Vali Acc: 0.557 Test Loss: 1.340 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 16 cost time: 1.5581421852111816
Epoch: 16, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.359 Vali Acc: 0.557 Test Loss: 1.359 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7617719173431396
Epoch: 17, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.370 Vali Acc: 0.557 Test Loss: 1.370 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6582067012786865
Epoch: 18, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.390 Vali Acc: 0.550 Test Loss: 1.390 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7805593013763428
Epoch: 19, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.371 Vali Acc: 0.557 Test Loss: 1.371 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4178571701049805
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.379 Vali Acc: 0.550 Test Loss: 1.379 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4342660903930664
Epoch: 21, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.340 Vali Acc: 0.550 Test Loss: 1.340 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3119325637817383
Epoch: 22, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.365 Vali Acc: 0.519 Test Loss: 1.365 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3604786396026611
Epoch: 23, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.357499122619629
Epoch: 24, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.474 Vali Acc: 0.550 Test Loss: 1.474 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4134917259216309
Epoch: 25, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.457 Vali Acc: 0.550 Test Loss: 1.457 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 813445
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.293834209442139
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.597 Vali Acc: 0.267 Test Loss: 1.597 Test Acc: 0.267
Validation loss decreased (inf --> -0.267160).  Saving model ...
Epoch: 2 cost time: 1.710477590560913
Epoch: 2, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.580 Vali Acc: 0.389 Test Loss: 1.580 Test Acc: 0.389
Validation loss decreased (-0.267160 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.6022515296936035
Epoch: 3, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.557 Vali Acc: 0.427 Test Loss: 1.557 Test Acc: 0.427
Validation loss decreased (-0.389297 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.3562943935394287
Epoch: 4, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5011937618255615
Epoch: 5, Steps: 8 | Train Loss: 1.121 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6569721698760986
Epoch: 6, Steps: 8 | Train Loss: 0.972 Vali Loss: 1.507 Vali Acc: 0.420 Test Loss: 1.507 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3932709693908691
Epoch: 7, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.504 Vali Acc: 0.420 Test Loss: 1.504 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.759187936782837
Epoch: 8, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.482 Vali Acc: 0.427 Test Loss: 1.482 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.3738176822662354
Epoch: 9, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.455 Vali Acc: 0.450 Test Loss: 1.455 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 1.5414927005767822
Epoch: 10, Steps: 8 | Train Loss: 0.533 Vali Loss: 1.452 Vali Acc: 0.473 Test Loss: 1.452 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 1.4243104457855225
Epoch: 11, Steps: 8 | Train Loss: 0.515 Vali Loss: 1.477 Vali Acc: 0.466 Test Loss: 1.477 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8633835315704346
Epoch: 12, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.437 Vali Acc: 0.473 Test Loss: 1.437 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 13 cost time: 1.3660194873809814
Epoch: 13, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.434 Vali Acc: 0.466 Test Loss: 1.434 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2848396301269531
Epoch: 14, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.451 Vali Acc: 0.466 Test Loss: 1.451 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3806471824645996
Epoch: 15, Steps: 8 | Train Loss: 0.312 Vali Loss: 1.469 Vali Acc: 0.458 Test Loss: 1.469 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.342195987701416
Epoch: 16, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.483 Vali Acc: 0.450 Test Loss: 1.483 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4519603252410889
Epoch: 17, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.476 Vali Acc: 0.458 Test Loss: 1.476 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3012363910675049
Epoch: 18, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.502 Vali Acc: 0.450 Test Loss: 1.502 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3851478099822998
Epoch: 19, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.512 Vali Acc: 0.443 Test Loss: 1.512 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5362858772277832
Epoch: 20, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.499 Vali Acc: 0.458 Test Loss: 1.499 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.627854347229004
Epoch: 21, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.475 Vali Acc: 0.473 Test Loss: 1.475 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4548757076263428
Epoch: 22, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.503 Vali Acc: 0.450 Test Loss: 1.503 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 867141
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.076206922531128
Epoch: 1, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.586 Vali Acc: 0.397 Test Loss: 1.586 Test Acc: 0.397
Validation loss decreased (inf --> -0.396931).  Saving model ...
Epoch: 2 cost time: 1.5165584087371826
Epoch: 2, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.8026692867279053
Epoch: 3, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5773499011993408
Epoch: 4, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.571225643157959
Epoch: 5, Steps: 8 | Train Loss: 0.997 Vali Loss: 1.470 Vali Acc: 0.427 Test Loss: 1.470 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.8468892574310303
Epoch: 6, Steps: 8 | Train Loss: 0.800 Vali Loss: 1.416 Vali Acc: 0.427 Test Loss: 1.416 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427467).  Saving model ...
Epoch: 7 cost time: 1.5874884128570557
Epoch: 7, Steps: 8 | Train Loss: 0.627 Vali Loss: 1.345 Vali Acc: 0.481 Test Loss: 1.345 Test Acc: 0.481
Validation loss decreased (-0.427467 --> -0.480903).  Saving model ...
Epoch: 8 cost time: 1.7127914428710938
Epoch: 8, Steps: 8 | Train Loss: 0.452 Vali Loss: 1.355 Vali Acc: 0.496 Test Loss: 1.355 Test Acc: 0.496
Validation loss decreased (-0.480903 --> -0.496170).  Saving model ...
Epoch: 9 cost time: 1.2520570755004883
Epoch: 9, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.297 Vali Acc: 0.511 Test Loss: 1.297 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511437).  Saving model ...
Epoch: 10 cost time: 1.5169076919555664
Epoch: 10, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.287 Vali Acc: 0.527 Test Loss: 1.287 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526705).  Saving model ...
Epoch: 11 cost time: 1.5945374965667725
Epoch: 11, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
Validation loss decreased (-0.526705 --> -0.526705).  Saving model ...
Epoch: 12 cost time: 1.557774305343628
Epoch: 12, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5147161483764648
Epoch: 13, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.362 Vali Acc: 0.527 Test Loss: 1.362 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5556087493896484
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.282 Vali Acc: 0.527 Test Loss: 1.282 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6661131381988525
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7576332092285156
Epoch: 16, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5973613262176514
Epoch: 17, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8759591579437256
Epoch: 18, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.435 Vali Acc: 0.534 Test Loss: 1.435 Test Acc: 0.534
Validation loss decreased (-0.526705 --> -0.534337).  Saving model ...
Epoch: 19 cost time: 1.3331210613250732
Epoch: 19, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6313376426696777
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.456 Vali Acc: 0.550 Test Loss: 1.456 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 21 cost time: 1.6257710456848145
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.443 Vali Acc: 0.550 Test Loss: 1.443 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549604).  Saving model ...
Epoch: 22 cost time: 1.827031135559082
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549604).  Saving model ...
Epoch: 23 cost time: 2.225132465362549
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.757 Vali Acc: 0.519 Test Loss: 1.757 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4965929985046387
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.867 Vali Acc: 0.527 Test Loss: 1.867 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.406510829925537
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.809 Vali Acc: 0.527 Test Loss: 1.809 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.874002456665039
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.718 Vali Acc: 0.527 Test Loss: 1.718 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.761733055114746
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.768 Vali Acc: 0.527 Test Loss: 1.768 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.332092523574829
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.769 Vali Acc: 0.534 Test Loss: 1.769 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8356530666351318
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.603 Vali Acc: 0.550 Test Loss: 1.603 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9554519653320312
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.614 Vali Acc: 0.550 Test Loss: 1.614 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4647586345672607
Epoch: 31, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.726 Vali Acc: 0.534 Test Loss: 1.726 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.832751989364624
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.893 Vali Acc: 0.534 Test Loss: 1.893 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 246245
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7808830738067627
Epoch: 1, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.629 Vali Acc: 0.145 Test Loss: 1.629 Test Acc: 0.145
Validation loss decreased (inf --> -0.145022).  Saving model ...
Epoch: 2 cost time: 1.7943148612976074
Epoch: 2, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.589 Vali Acc: 0.389 Test Loss: 1.589 Test Acc: 0.389
Validation loss decreased (-0.145022 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.558910608291626
Epoch: 3, Steps: 8 | Train Loss: 1.407 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6473195552825928
Epoch: 4, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.6230816841125488
Epoch: 5, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8420305252075195
Epoch: 6, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.507 Vali Acc: 0.450 Test Loss: 1.507 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.4677491188049316
Epoch: 7, Steps: 8 | Train Loss: 0.913 Vali Loss: 1.493 Vali Acc: 0.489 Test Loss: 1.493 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.7681748867034912
Epoch: 8, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.481 Vali Acc: 0.496 Test Loss: 1.481 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 9 cost time: 1.9334962368011475
Epoch: 9, Steps: 8 | Train Loss: 0.656 Vali Loss: 1.463 Vali Acc: 0.496 Test Loss: 1.463 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.412017822265625
Epoch: 10, Steps: 8 | Train Loss: 0.513 Vali Loss: 1.441 Vali Acc: 0.519 Test Loss: 1.441 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.4796805381774902
Epoch: 11, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 1.6009466648101807
Epoch: 12, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5263314247131348
Epoch: 13, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.439 Vali Acc: 0.534 Test Loss: 1.439 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 1.3660888671875
Epoch: 14, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.533 Vali Acc: 0.534 Test Loss: 1.533 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7108204364776611
Epoch: 15, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.514 Vali Acc: 0.534 Test Loss: 1.514 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.033902645111084
Epoch: 16, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.561 Vali Acc: 0.534 Test Loss: 1.561 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.364696979522705
Epoch: 17, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.574 Vali Acc: 0.534 Test Loss: 1.574 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4624271392822266
Epoch: 18, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.591 Vali Acc: 0.534 Test Loss: 1.591 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.444652795791626
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6256914138793945
Epoch: 20, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.640 Vali Acc: 0.542 Test Loss: 1.640 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541968).  Saving model ...
Epoch: 21 cost time: 1.5623607635498047
Epoch: 21, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.639 Vali Acc: 0.534 Test Loss: 1.639 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5220026969909668
Epoch: 22, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.710 Vali Acc: 0.534 Test Loss: 1.710 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.965653419494629
Epoch: 23, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.748 Vali Acc: 0.534 Test Loss: 1.748 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.686204433441162
Epoch: 24, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.749 Vali Acc: 0.542 Test Loss: 1.749 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4604253768920898
Epoch: 25, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.790 Vali Acc: 0.542 Test Loss: 1.790 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6478502750396729
Epoch: 26, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.811 Vali Acc: 0.542 Test Loss: 1.811 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7350966930389404
Epoch: 27, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.922 Vali Acc: 0.542 Test Loss: 1.922 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4370276927947998
Epoch: 28, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.936 Vali Acc: 0.542 Test Loss: 1.936 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4103050231933594
Epoch: 29, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.904 Vali Acc: 0.542 Test Loss: 1.904 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.477710485458374
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.827 Vali Acc: 0.542 Test Loss: 1.827 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 222245
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.002967834472656
Epoch: 1, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.588 Vali Acc: 0.382 Test Loss: 1.588 Test Acc: 0.382
Validation loss decreased (inf --> -0.381664).  Saving model ...
Epoch: 2 cost time: 1.4271743297576904
Epoch: 2, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.570 Vali Acc: 0.435 Test Loss: 1.570 Test Acc: 0.435
Validation loss decreased (-0.381664 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.888035774230957
Epoch: 3, Steps: 8 | Train Loss: 1.419 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9620823860168457
Epoch: 4, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8410465717315674
Epoch: 5, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7301971912384033
Epoch: 6, Steps: 8 | Train Loss: 1.094 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5781011581420898
Epoch: 7, Steps: 8 | Train Loss: 0.980 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.489823579788208
Epoch: 8, Steps: 8 | Train Loss: 0.872 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8096623420715332
Epoch: 9, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.520 Vali Acc: 0.435 Test Loss: 1.520 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 10 cost time: 1.3301339149475098
Epoch: 10, Steps: 8 | Train Loss: 0.670 Vali Loss: 1.503 Vali Acc: 0.450 Test Loss: 1.503 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 1.4565577507019043
Epoch: 11, Steps: 8 | Train Loss: 0.584 Vali Loss: 1.486 Vali Acc: 0.473 Test Loss: 1.486 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 12 cost time: 1.4907069206237793
Epoch: 12, Steps: 8 | Train Loss: 0.529 Vali Loss: 1.471 Vali Acc: 0.481 Test Loss: 1.471 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 13 cost time: 1.7245385646820068
Epoch: 13, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.468 Vali Acc: 0.496 Test Loss: 1.468 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 14 cost time: 1.6212973594665527
Epoch: 14, Steps: 8 | Train Loss: 0.357 Vali Loss: 1.491 Vali Acc: 0.496 Test Loss: 1.491 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9271607398986816
Epoch: 15, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519069).  Saving model ...
Epoch: 16 cost time: 1.4242889881134033
Epoch: 16, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.505 Vali Acc: 0.511 Test Loss: 1.505 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5724053382873535
Epoch: 17, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.453 Vali Acc: 0.519 Test Loss: 1.453 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 18 cost time: 1.6842420101165771
Epoch: 18, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.500 Vali Acc: 0.519 Test Loss: 1.500 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4153814315795898
Epoch: 19, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.520 Vali Acc: 0.519 Test Loss: 1.520 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.56181001663208
Epoch: 20, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.563 Vali Acc: 0.519 Test Loss: 1.563 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5248069763183594
Epoch: 21, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.564 Vali Acc: 0.519 Test Loss: 1.564 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5926628112792969
Epoch: 22, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 23 cost time: 1.7833828926086426
Epoch: 23, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.471 Vali Acc: 0.519 Test Loss: 1.471 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3519353866577148
Epoch: 24, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.590 Vali Acc: 0.527 Test Loss: 1.590 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.803589105606079
Epoch: 25, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.594 Vali Acc: 0.519 Test Loss: 1.594 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5101361274719238
Epoch: 26, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.582 Vali Acc: 0.527 Test Loss: 1.582 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6484816074371338
Epoch: 27, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.722926139831543
Epoch: 28, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.538 Vali Acc: 0.519 Test Loss: 1.538 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.726393699645996
Epoch: 29, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.582 Vali Acc: 0.519 Test Loss: 1.582 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5170133113861084
Epoch: 30, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.615 Vali Acc: 0.519 Test Loss: 1.615 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7249042987823486
Epoch: 31, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.620 Vali Acc: 0.519 Test Loss: 1.620 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8771567344665527
Epoch: 32, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.683 Vali Acc: 0.527 Test Loss: 1.683 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 223173
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.610429525375366
Epoch: 1, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.587 Vali Acc: 0.351 Test Loss: 1.587 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.922800064086914
Epoch: 2, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.569 Vali Acc: 0.420 Test Loss: 1.569 Test Acc: 0.420
Validation loss decreased (-0.351129 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.2568118572235107
Epoch: 3, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6828477382659912
Epoch: 4, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7389838695526123
Epoch: 5, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8481478691101074
Epoch: 6, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.495 Vali Acc: 0.420 Test Loss: 1.495 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.9060618877410889
Epoch: 7, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.483 Vali Acc: 0.427 Test Loss: 1.483 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 2.0084035396575928
Epoch: 8, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.467 Vali Acc: 0.435 Test Loss: 1.467 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 9 cost time: 1.881638526916504
Epoch: 9, Steps: 8 | Train Loss: 0.861 Vali Loss: 1.462 Vali Acc: 0.458 Test Loss: 1.462 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 10 cost time: 2.208253860473633
Epoch: 10, Steps: 8 | Train Loss: 0.763 Vali Loss: 1.433 Vali Acc: 0.473 Test Loss: 1.433 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 1.9232070446014404
Epoch: 11, Steps: 8 | Train Loss: 0.646 Vali Loss: 1.385 Vali Acc: 0.489 Test Loss: 1.385 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 12 cost time: 2.0024192333221436
Epoch: 12, Steps: 8 | Train Loss: 0.529 Vali Loss: 1.378 Vali Acc: 0.496 Test Loss: 1.378 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 13 cost time: 2.2244462966918945
Epoch: 13, Steps: 8 | Train Loss: 0.478 Vali Loss: 1.360 Vali Acc: 0.496 Test Loss: 1.360 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496170).  Saving model ...
Epoch: 14 cost time: 2.2430098056793213
Epoch: 14, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.341 Vali Acc: 0.511 Test Loss: 1.341 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511437).  Saving model ...
Epoch: 15 cost time: 1.6638550758361816
Epoch: 15, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.282 Vali Acc: 0.534 Test Loss: 1.282 Test Acc: 0.534
Validation loss decreased (-0.511437 --> -0.534338).  Saving model ...
Epoch: 16 cost time: 1.7636747360229492
Epoch: 16, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.353 Vali Acc: 0.534 Test Loss: 1.353 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8095736503601074
Epoch: 17, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.328 Vali Acc: 0.527 Test Loss: 1.328 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8247544765472412
Epoch: 18, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.345 Vali Acc: 0.534 Test Loss: 1.345 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6059675216674805
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.348 Vali Acc: 0.534 Test Loss: 1.348 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8775577545166016
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.346 Vali Acc: 0.527 Test Loss: 1.346 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.374454975128174
Epoch: 21, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.343 Vali Acc: 0.527 Test Loss: 1.343 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.605470895767212
Epoch: 22, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.357 Vali Acc: 0.534 Test Loss: 1.357 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7172672748565674
Epoch: 23, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.361 Vali Acc: 0.542 Test Loss: 1.361 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 24 cost time: 1.8343536853790283
Epoch: 24, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1263885498046875
Epoch: 25, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.429 Vali Acc: 0.550 Test Loss: 1.429 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 26 cost time: 1.9326527118682861
Epoch: 26, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.420 Vali Acc: 0.542 Test Loss: 1.420 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.971435785293579
Epoch: 27, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.404 Vali Acc: 0.542 Test Loss: 1.404 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.044504404067993
Epoch: 28, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.381 Vali Acc: 0.534 Test Loss: 1.381 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.025437116622925
Epoch: 29, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.484 Vali Acc: 0.534 Test Loss: 1.484 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.366713047027588
Epoch: 30, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8755145072937012
Epoch: 31, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.382 Vali Acc: 0.542 Test Loss: 1.382 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5851233005523682
Epoch: 32, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.312 Vali Acc: 0.550 Test Loss: 1.312 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549605).  Saving model ...
Epoch: 33 cost time: 1.8077154159545898
Epoch: 33, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.374 Vali Acc: 0.542 Test Loss: 1.374 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5613439083099365
Epoch: 34, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.432 Vali Acc: 0.542 Test Loss: 1.432 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9183449745178223
Epoch: 35, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.512 Vali Acc: 0.527 Test Loss: 1.512 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.825810432434082
Epoch: 36, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7628257274627686
Epoch: 37, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.413 Vali Acc: 0.527 Test Loss: 1.413 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.3642146587371826
Epoch: 38, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.376 Vali Acc: 0.542 Test Loss: 1.376 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.9390244483947754
Epoch: 39, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.493 Vali Acc: 0.542 Test Loss: 1.493 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6237120628356934
Epoch: 40, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.606 Vali Acc: 0.534 Test Loss: 1.606 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.1473278999328613
Epoch: 41, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.590 Vali Acc: 0.519 Test Loss: 1.590 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.721327543258667
Epoch: 42, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.467 Vali Acc: 0.565 Test Loss: 1.467 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564871).  Saving model ...
Epoch: 43 cost time: 1.860368251800537
Epoch: 43, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.447 Vali Acc: 0.534 Test Loss: 1.447 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9969511032104492
Epoch: 44, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.473 Vali Acc: 0.550 Test Loss: 1.473 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.6559860706329346
Epoch: 45, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.457 Vali Acc: 0.550 Test Loss: 1.457 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.1329381465911865
Epoch: 46, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.433 Vali Acc: 0.534 Test Loss: 1.433 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.2395942211151123
Epoch: 47, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.450 Vali Acc: 0.534 Test Loss: 1.450 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.8137779235839844
Epoch: 48, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.435 Vali Acc: 0.550 Test Loss: 1.435 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.6148815155029297
Epoch: 49, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.526 Vali Acc: 0.534 Test Loss: 1.526 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.275757312774658
Epoch: 50, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.455 Vali Acc: 0.542 Test Loss: 1.455 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 231813
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.99497127532959
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.591 Vali Acc: 0.374 Test Loss: 1.591 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.6312408447265625
Epoch: 2, Steps: 8 | Train Loss: 1.536 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5035631656646729
Epoch: 3, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.3876466751098633
Epoch: 4, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5223143100738525
Epoch: 5, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.5316758155822754
Epoch: 6, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6927556991577148
Epoch: 7, Steps: 8 | Train Loss: 1.089 Vali Loss: 1.501 Vali Acc: 0.420 Test Loss: 1.501 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.9770052433013916
Epoch: 8, Steps: 8 | Train Loss: 1.037 Vali Loss: 1.474 Vali Acc: 0.420 Test Loss: 1.474 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 9 cost time: 1.4318444728851318
Epoch: 9, Steps: 8 | Train Loss: 0.928 Vali Loss: 1.477 Vali Acc: 0.420 Test Loss: 1.477 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5564610958099365
Epoch: 10, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.461 Vali Acc: 0.443 Test Loss: 1.461 Test Acc: 0.443
Validation loss decreased (-0.419833 --> -0.442733).  Saving model ...
Epoch: 11 cost time: 1.524411678314209
Epoch: 11, Steps: 8 | Train Loss: 0.722 Vali Loss: 1.457 Vali Acc: 0.450 Test Loss: 1.457 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 12 cost time: 1.3707401752471924
Epoch: 12, Steps: 8 | Train Loss: 0.652 Vali Loss: 1.450 Vali Acc: 0.473 Test Loss: 1.450 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 13 cost time: 2.0406365394592285
Epoch: 13, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.450 Vali Acc: 0.458 Test Loss: 1.450 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4615728855133057
Epoch: 14, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.419 Vali Acc: 0.473 Test Loss: 1.419 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 15 cost time: 1.4531974792480469
Epoch: 15, Steps: 8 | Train Loss: 0.497 Vali Loss: 1.439 Vali Acc: 0.466 Test Loss: 1.439 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4894249439239502
Epoch: 16, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 17 cost time: 2.0919063091278076
Epoch: 17, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.386 Vali Acc: 0.511 Test Loss: 1.386 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511437).  Saving model ...
Epoch: 18 cost time: 1.832268476486206
Epoch: 18, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.387 Vali Acc: 0.496 Test Loss: 1.387 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.380768060684204
Epoch: 19, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.362 Vali Acc: 0.542 Test Loss: 1.362 Test Acc: 0.542
Validation loss decreased (-0.511437 --> -0.541971).  Saving model ...
Epoch: 20 cost time: 1.2405993938446045
Epoch: 20, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.418 Vali Acc: 0.511 Test Loss: 1.418 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8747327327728271
Epoch: 21, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.431 Vali Acc: 0.511 Test Loss: 1.431 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6133265495300293
Epoch: 22, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.432 Vali Acc: 0.511 Test Loss: 1.432 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6037495136260986
Epoch: 23, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.188735008239746
Epoch: 24, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5280966758728027
Epoch: 25, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.448 Vali Acc: 0.504 Test Loss: 1.448 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.562873363494873
Epoch: 26, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.457 Vali Acc: 0.527 Test Loss: 1.457 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5459561347961426
Epoch: 27, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.428 Vali Acc: 0.534 Test Loss: 1.428 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7348201274871826
Epoch: 28, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1204869747161865
Epoch: 29, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.430 Vali Acc: 0.511 Test Loss: 1.430 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 254821
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.493625164031982
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.607 Vali Acc: 0.191 Test Loss: 1.607 Test Acc: 0.191
Validation loss decreased (inf --> -0.190824).  Saving model ...
Epoch: 2 cost time: 1.70914888381958
Epoch: 2, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.584 Vali Acc: 0.366 Test Loss: 1.584 Test Acc: 0.366
Validation loss decreased (-0.190824 --> -0.366396).  Saving model ...
Epoch: 3 cost time: 1.3870291709899902
Epoch: 3, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.560 Vali Acc: 0.466 Test Loss: 1.560 Test Acc: 0.466
Validation loss decreased (-0.366396 --> -0.465633).  Saving model ...
Epoch: 4 cost time: 1.5856280326843262
Epoch: 4, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.535 Vali Acc: 0.481 Test Loss: 1.535 Test Acc: 0.481
Validation loss decreased (-0.465633 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.543485164642334
Epoch: 5, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.514 Vali Acc: 0.450 Test Loss: 1.514 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5688087940216064
Epoch: 6, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.486 Vali Acc: 0.473 Test Loss: 1.486 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.338778018951416
Epoch: 7, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.459 Vali Acc: 0.473 Test Loss: 1.459 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6149945259094238
Epoch: 8, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.450 Vali Acc: 0.496 Test Loss: 1.450 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.692568302154541
Epoch: 9, Steps: 8 | Train Loss: 0.782 Vali Loss: 1.437 Vali Acc: 0.511 Test Loss: 1.437 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.4394729137420654
Epoch: 10, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.400 Vali Acc: 0.519 Test Loss: 1.400 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.3910574913024902
Epoch: 11, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.398 Vali Acc: 0.534 Test Loss: 1.398 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 12 cost time: 2.0425992012023926
Epoch: 12, Steps: 8 | Train Loss: 0.558 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4382686614990234
Epoch: 13, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.373 Vali Acc: 0.534 Test Loss: 1.373 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 1.469991683959961
Epoch: 14, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.366 Vali Acc: 0.534 Test Loss: 1.366 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 15 cost time: 1.8312325477600098
Epoch: 15, Steps: 8 | Train Loss: 0.366 Vali Loss: 1.357 Vali Acc: 0.542 Test Loss: 1.357 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.8589131832122803
Epoch: 16, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.353 Vali Acc: 0.542 Test Loss: 1.353 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 17 cost time: 1.2187530994415283
Epoch: 17, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.391 Vali Acc: 0.542 Test Loss: 1.391 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6237633228302002
Epoch: 18, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.361 Vali Acc: 0.534 Test Loss: 1.361 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0378613471984863
Epoch: 19, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.358 Vali Acc: 0.542 Test Loss: 1.358 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9406375885009766
Epoch: 20, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.378 Vali Acc: 0.550 Test Loss: 1.378 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549605).  Saving model ...
Epoch: 21 cost time: 1.5010292530059814
Epoch: 21, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.388 Vali Acc: 0.534 Test Loss: 1.388 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7912931442260742
Epoch: 22, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.366 Vali Acc: 0.542 Test Loss: 1.366 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8470675945281982
Epoch: 23, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.396 Vali Acc: 0.550 Test Loss: 1.396 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5452792644500732
Epoch: 24, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.357 Vali Acc: 0.573 Test Loss: 1.357 Test Acc: 0.573
Validation loss decreased (-0.549605 --> -0.572506).  Saving model ...
Epoch: 25 cost time: 1.8390295505523682
Epoch: 25, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.399 Vali Acc: 0.542 Test Loss: 1.399 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.608468770980835
Epoch: 26, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.430 Vali Acc: 0.550 Test Loss: 1.430 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.515106201171875
Epoch: 27, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.388 Vali Acc: 0.557 Test Loss: 1.388 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6042180061340332
Epoch: 28, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.366 Vali Acc: 0.542 Test Loss: 1.366 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8359010219573975
Epoch: 29, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.435 Vali Acc: 0.550 Test Loss: 1.435 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.648334264755249
Epoch: 30, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.438 Vali Acc: 0.534 Test Loss: 1.438 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5417954921722412
Epoch: 31, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.477 Vali Acc: 0.534 Test Loss: 1.477 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5012967586517334
Epoch: 32, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.229137659072876
Epoch: 33, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.453 Vali Acc: 0.534 Test Loss: 1.453 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7011113166809082
Epoch: 34, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.433 Vali Acc: 0.534 Test Loss: 1.433 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 279749
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.742067575454712
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.597 Vali Acc: 0.374 Test Loss: 1.597 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.7120513916015625
Epoch: 2, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.583 Vali Acc: 0.412 Test Loss: 1.583 Test Acc: 0.412
Validation loss decreased (-0.374030 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.619171142578125
Epoch: 3, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.567 Vali Acc: 0.412 Test Loss: 1.567 Test Acc: 0.412
Validation loss decreased (-0.412198 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.4979267120361328
Epoch: 4, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5802876949310303
Epoch: 5, Steps: 8 | Train Loss: 1.235 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.5583255290985107
Epoch: 6, Steps: 8 | Train Loss: 1.108 Vali Loss: 1.524 Vali Acc: 0.427 Test Loss: 1.524 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.561445713043213
Epoch: 7, Steps: 8 | Train Loss: 1.041 Vali Loss: 1.514 Vali Acc: 0.427 Test Loss: 1.514 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.6537652015686035
Epoch: 8, Steps: 8 | Train Loss: 0.944 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.509023666381836
Epoch: 9, Steps: 8 | Train Loss: 0.859 Vali Loss: 1.523 Vali Acc: 0.427 Test Loss: 1.523 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8541553020477295
Epoch: 10, Steps: 8 | Train Loss: 0.827 Vali Loss: 1.503 Vali Acc: 0.443 Test Loss: 1.503 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 11 cost time: 1.8179173469543457
Epoch: 11, Steps: 8 | Train Loss: 0.756 Vali Loss: 1.507 Vali Acc: 0.458 Test Loss: 1.507 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 1.553739309310913
Epoch: 12, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.515 Vali Acc: 0.450 Test Loss: 1.515 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3607573509216309
Epoch: 13, Steps: 8 | Train Loss: 0.670 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7800116539001465
Epoch: 14, Steps: 8 | Train Loss: 0.564 Vali Loss: 1.486 Vali Acc: 0.450 Test Loss: 1.486 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6219723224639893
Epoch: 15, Steps: 8 | Train Loss: 0.466 Vali Loss: 1.502 Vali Acc: 0.450 Test Loss: 1.502 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7484853267669678
Epoch: 16, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.477 Vali Acc: 0.458 Test Loss: 1.477 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 17 cost time: 1.5172274112701416
Epoch: 17, Steps: 8 | Train Loss: 0.402 Vali Loss: 1.480 Vali Acc: 0.466 Test Loss: 1.480 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 18 cost time: 1.6104350090026855
Epoch: 18, Steps: 8 | Train Loss: 0.370 Vali Loss: 1.489 Vali Acc: 0.473 Test Loss: 1.489 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 19 cost time: 1.5592055320739746
Epoch: 19, Steps: 8 | Train Loss: 0.403 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.348268747329712
Epoch: 20, Steps: 8 | Train Loss: 0.374 Vali Loss: 1.490 Vali Acc: 0.458 Test Loss: 1.490 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.691131830215454
Epoch: 21, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.508 Vali Acc: 0.458 Test Loss: 1.508 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7093963623046875
Epoch: 22, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.515 Vali Acc: 0.466 Test Loss: 1.515 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6345889568328857
Epoch: 23, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.516 Vali Acc: 0.450 Test Loss: 1.516 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6388936042785645
Epoch: 24, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.539 Vali Acc: 0.450 Test Loss: 1.539 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8875951766967773
Epoch: 25, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.553 Vali Acc: 0.450 Test Loss: 1.553 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8965811729431152
Epoch: 26, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.500 Vali Acc: 0.458 Test Loss: 1.500 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5637316703796387
Epoch: 27, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.527 Vali Acc: 0.473 Test Loss: 1.527 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.457348346710205
Epoch: 28, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.536 Vali Acc: 0.450 Test Loss: 1.536 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 306597
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7679550647735596
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4465172290802002
Epoch: 2, Steps: 8 | Train Loss: 0.940 Vali Loss: 1.341 Vali Acc: 0.565 Test Loss: 1.341 Test Acc: 0.565
Validation loss decreased (-0.419832 --> -0.564872).  Saving model ...
Epoch: 3 cost time: 1.577782392501831
Epoch: 3, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.338 Vali Acc: 0.511 Test Loss: 1.338 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8746404647827148
Epoch: 4, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.451 Vali Acc: 0.550 Test Loss: 1.451 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.522390604019165
Epoch: 5, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.532 Vali Acc: 0.588 Test Loss: 1.532 Test Acc: 0.588
Validation loss decreased (-0.564872 --> -0.587771).  Saving model ...
Epoch: 6 cost time: 1.6797544956207275
Epoch: 6, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.859 Vali Acc: 0.550 Test Loss: 1.859 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6959316730499268
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.946 Vali Acc: 0.565 Test Loss: 1.946 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7422633171081543
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.993 Vali Acc: 0.573 Test Loss: 1.993 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5355315208435059
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.173 Vali Acc: 0.542 Test Loss: 2.173 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5494709014892578
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.323 Vali Acc: 0.534 Test Loss: 2.323 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6928558349609375
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.529 Vali Acc: 0.542 Test Loss: 2.529 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.697389841079712
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.531 Vali Acc: 0.542 Test Loss: 2.531 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.769376277923584
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.555 Vali Acc: 0.550 Test Loss: 2.555 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4998993873596191
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.511 Vali Acc: 0.527 Test Loss: 2.511 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.633223056793213
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.700 Vali Acc: 0.527 Test Loss: 2.700 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 2375941
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.427348852157593
Epoch: 1, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.524 Vali Acc: 0.412 Test Loss: 1.524 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.7488477230072021
Epoch: 2, Steps: 8 | Train Loss: 1.228 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
Validation loss decreased (-0.412198 --> -0.526704).  Saving model ...
Epoch: 3 cost time: 1.3833706378936768
Epoch: 3, Steps: 8 | Train Loss: 0.635 Vali Loss: 1.209 Vali Acc: 0.573 Test Loss: 1.209 Test Acc: 0.573
Validation loss decreased (-0.526704 --> -0.572507).  Saving model ...
Epoch: 4 cost time: 1.4377827644348145
Epoch: 4, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.395 Vali Acc: 0.504 Test Loss: 1.395 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.185142755508423
Epoch: 5, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.254 Vali Acc: 0.534 Test Loss: 1.254 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9934487342834473
Epoch: 6, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7772221565246582
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.632 Vali Acc: 0.527 Test Loss: 1.632 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3525831699371338
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.764 Vali Acc: 0.519 Test Loss: 1.764 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.600663185119629
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.620 Vali Acc: 0.534 Test Loss: 1.620 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9119737148284912
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.787 Vali Acc: 0.534 Test Loss: 1.787 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9723093509674072
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.972 Vali Acc: 0.519 Test Loss: 1.972 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5011579990386963
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.515 Vali Acc: 0.557 Test Loss: 1.515 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8665063381195068
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.394 Vali Acc: 0.557 Test Loss: 1.394 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2183941
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.604736328125
Epoch: 1, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.578 Vali Acc: 0.420 Test Loss: 1.578 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.9035332202911377
Epoch: 2, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.480 Vali Acc: 0.435 Test Loss: 1.480 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.7522680759429932
Epoch: 3, Steps: 8 | Train Loss: 0.765 Vali Loss: 1.336 Vali Acc: 0.511 Test Loss: 1.336 Test Acc: 0.511
Validation loss decreased (-0.435100 --> -0.511437).  Saving model ...
Epoch: 4 cost time: 1.6425285339355469
Epoch: 4, Steps: 8 | Train Loss: 0.399 Vali Loss: 1.268 Vali Acc: 0.527 Test Loss: 1.268 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526705).  Saving model ...
Epoch: 5 cost time: 1.4891388416290283
Epoch: 5, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
Validation loss decreased (-0.526705 --> -0.526705).  Saving model ...
Epoch: 6 cost time: 1.8912107944488525
Epoch: 6, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.425 Vali Acc: 0.519 Test Loss: 1.425 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7376458644866943
Epoch: 7, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.350 Vali Acc: 0.527 Test Loss: 1.350 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3894639015197754
Epoch: 8, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7622721195220947
Epoch: 9, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.451 Vali Acc: 0.550 Test Loss: 1.451 Test Acc: 0.550
Validation loss decreased (-0.526705 --> -0.549604).  Saving model ...
Epoch: 10 cost time: 2.0480308532714844
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.460 Vali Acc: 0.534 Test Loss: 1.460 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7139089107513428
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.676 Vali Acc: 0.519 Test Loss: 1.676 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.138322591781616
Epoch: 12, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.474 Vali Acc: 0.542 Test Loss: 1.474 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5670058727264404
Epoch: 13, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.379 Vali Acc: 0.565 Test Loss: 1.379 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564872).  Saving model ...
Epoch: 14 cost time: 1.623061180114746
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.723 Vali Acc: 0.557 Test Loss: 1.723 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8267438411712646
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.478 Vali Acc: 0.550 Test Loss: 1.478 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5256695747375488
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.820 Vali Acc: 0.519 Test Loss: 1.820 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.784280776977539
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.613 Vali Acc: 0.519 Test Loss: 1.613 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8949975967407227
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.209 Vali Acc: 0.603 Test Loss: 1.209 Test Acc: 0.603
Validation loss decreased (-0.564872 --> -0.603041).  Saving model ...
Epoch: 19 cost time: 1.4515659809112549
Epoch: 19, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.386 Vali Acc: 0.565 Test Loss: 1.386 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.469019889831543
Epoch: 20, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.569 Vali Acc: 0.534 Test Loss: 1.569 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0538525581359863
Epoch: 21, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.665 Vali Acc: 0.557 Test Loss: 1.665 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1807515621185303
Epoch: 22, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.358 Vali Acc: 0.550 Test Loss: 1.358 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6269047260284424
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.454 Vali Acc: 0.580 Test Loss: 1.454 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7308859825134277
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.494 Vali Acc: 0.573 Test Loss: 1.494 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0991787910461426
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.628 Vali Acc: 0.565 Test Loss: 1.628 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.578261375427246
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.495 Vali Acc: 0.557 Test Loss: 1.495 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.491595983505249
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.413 Vali Acc: 0.588 Test Loss: 1.413 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.873246669769287
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.468 Vali Acc: 0.588 Test Loss: 1.468 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 2199045
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5891571044921875
Epoch: 1, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.635 Vali Acc: 0.344 Test Loss: 1.635 Test Acc: 0.344
Validation loss decreased (inf --> -0.343495).  Saving model ...
Epoch: 2 cost time: 1.3401954174041748
Epoch: 2, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.582 Vali Acc: 0.420 Test Loss: 1.582 Test Acc: 0.420
Validation loss decreased (-0.343495 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2824060916900635
Epoch: 3, Steps: 8 | Train Loss: 0.755 Vali Loss: 1.461 Vali Acc: 0.504 Test Loss: 1.461 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.5962021350860596
Epoch: 4, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.361 Vali Acc: 0.527 Test Loss: 1.361 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 1.5844635963439941
Epoch: 5, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.328 Vali Acc: 0.557 Test Loss: 1.328 Test Acc: 0.557
Validation loss decreased (-0.526704 --> -0.557239).  Saving model ...
Epoch: 6 cost time: 1.1764237880706787
Epoch: 6, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.396 Vali Acc: 0.527 Test Loss: 1.396 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5116429328918457
Epoch: 7, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.583 Vali Acc: 0.519 Test Loss: 1.583 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7052898406982422
Epoch: 8, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.485 Vali Acc: 0.550 Test Loss: 1.485 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4836571216583252
Epoch: 9, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.446 Vali Acc: 0.573 Test Loss: 1.446 Test Acc: 0.573
Validation loss decreased (-0.557239 --> -0.572505).  Saving model ...
Epoch: 10 cost time: 1.2951598167419434
Epoch: 10, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.456 Vali Acc: 0.557 Test Loss: 1.456 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3091468811035156
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.473 Vali Acc: 0.573 Test Loss: 1.473 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4172084331512451
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.440 Vali Acc: 0.580 Test Loss: 1.440 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580138).  Saving model ...
Epoch: 13 cost time: 1.4976530075073242
Epoch: 13, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.384 Vali Acc: 0.565 Test Loss: 1.384 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3942677974700928
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.513 Vali Acc: 0.565 Test Loss: 1.513 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5854809284210205
Epoch: 15, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.629 Vali Acc: 0.588 Test Loss: 1.629 Test Acc: 0.588
Validation loss decreased (-0.580138 --> -0.587770).  Saving model ...
Epoch: 16 cost time: 1.4120874404907227
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.483 Vali Acc: 0.580 Test Loss: 1.483 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4603171348571777
Epoch: 17, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.523 Vali Acc: 0.580 Test Loss: 1.523 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3268530368804932
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.428 Vali Acc: 0.550 Test Loss: 1.428 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5760698318481445
Epoch: 19, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.460 Vali Acc: 0.565 Test Loss: 1.460 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3464469909667969
Epoch: 20, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.089 Vali Acc: 0.542 Test Loss: 2.089 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7835674285888672
Epoch: 21, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.712 Vali Acc: 0.542 Test Loss: 1.712 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.668269395828247
Epoch: 22, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.599 Vali Acc: 0.565 Test Loss: 1.599 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.589073657989502
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.630 Vali Acc: 0.496 Test Loss: 1.630 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7823295593261719
Epoch: 24, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.011 Vali Acc: 0.527 Test Loss: 2.011 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4561398029327393
Epoch: 25, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.549 Vali Acc: 0.565 Test Loss: 1.549 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 2260485
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.102487564086914
Epoch: 1, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.598 Vali Acc: 0.237 Test Loss: 1.598 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.70481276512146
Epoch: 2, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.548 Vali Acc: 0.435 Test Loss: 1.548 Test Acc: 0.435
Validation loss decreased (-0.236625 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.7076992988586426
Epoch: 3, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.510 Vali Acc: 0.534 Test Loss: 1.510 Test Acc: 0.534
Validation loss decreased (-0.435099 --> -0.534336).  Saving model ...
Epoch: 4 cost time: 1.705449104309082
Epoch: 4, Steps: 8 | Train Loss: 0.600 Vali Loss: 1.458 Vali Acc: 0.550 Test Loss: 1.458 Test Acc: 0.550
Validation loss decreased (-0.534336 --> -0.549604).  Saving model ...
Epoch: 5 cost time: 1.9221875667572021
Epoch: 5, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.403 Vali Acc: 0.511 Test Loss: 1.403 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7358806133270264
Epoch: 6, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.443 Vali Acc: 0.504 Test Loss: 1.443 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.664644718170166
Epoch: 7, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.383 Vali Acc: 0.534 Test Loss: 1.383 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.800328254699707
Epoch: 8, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.361 Vali Acc: 0.519 Test Loss: 1.361 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9150822162628174
Epoch: 9, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.458 Vali Acc: 0.519 Test Loss: 1.458 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4412808418273926
Epoch: 10, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.476 Vali Acc: 0.519 Test Loss: 1.476 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5236079692840576
Epoch: 11, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.430 Vali Acc: 0.527 Test Loss: 1.430 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6946814060211182
Epoch: 12, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.418330430984497
Epoch: 13, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.388 Vali Acc: 0.519 Test Loss: 1.388 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.636465072631836
Epoch: 14, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.388 Vali Acc: 0.519 Test Loss: 1.388 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2444549
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.661921977996826
Epoch: 1, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.599 Vali Acc: 0.244 Test Loss: 1.599 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 1.5600061416625977
Epoch: 2, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.546 Vali Acc: 0.427 Test Loss: 1.546 Test Acc: 0.427
Validation loss decreased (-0.244259 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.6771769523620605
Epoch: 3, Steps: 8 | Train Loss: 0.852 Vali Loss: 1.491 Vali Acc: 0.496 Test Loss: 1.491 Test Acc: 0.496
Validation loss decreased (-0.427465 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.5280735492706299
Epoch: 4, Steps: 8 | Train Loss: 0.500 Vali Loss: 1.394 Vali Acc: 0.519 Test Loss: 1.394 Test Acc: 0.519
Validation loss decreased (-0.496168 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 1.626955270767212
Epoch: 5, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.415 Vali Acc: 0.534 Test Loss: 1.415 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 1.3657617568969727
Epoch: 6, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4384045600891113
Epoch: 7, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.454 Vali Acc: 0.550 Test Loss: 1.454 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 8 cost time: 1.5866689682006836
Epoch: 8, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.480 Vali Acc: 0.542 Test Loss: 1.480 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.553368091583252
Epoch: 9, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.536 Vali Acc: 0.550 Test Loss: 1.536 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6843035221099854
Epoch: 10, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.455 Vali Acc: 0.565 Test Loss: 1.455 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564871).  Saving model ...
Epoch: 11 cost time: 1.3164844512939453
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.490 Vali Acc: 0.573 Test Loss: 1.490 Test Acc: 0.573
Validation loss decreased (-0.564871 --> -0.572504).  Saving model ...
Epoch: 12 cost time: 1.5887603759765625
Epoch: 12, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.500 Vali Acc: 0.573 Test Loss: 1.500 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.529303789138794
Epoch: 13, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.670 Vali Acc: 0.565 Test Loss: 1.670 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.631305456161499
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.532 Vali Acc: 0.565 Test Loss: 1.532 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6999762058258057
Epoch: 15, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.451 Vali Acc: 0.573 Test Loss: 1.451 Test Acc: 0.573
Validation loss decreased (-0.572504 --> -0.572505).  Saving model ...
Epoch: 16 cost time: 1.6581764221191406
Epoch: 16, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.410 Vali Acc: 0.565 Test Loss: 1.410 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7651457786560059
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.409 Vali Acc: 0.565 Test Loss: 1.409 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7029948234558105
Epoch: 18, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.469 Vali Acc: 0.557 Test Loss: 1.469 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8312716484069824
Epoch: 19, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.532 Vali Acc: 0.580 Test Loss: 1.532 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580137).  Saving model ...
Epoch: 20 cost time: 2.001075029373169
Epoch: 20, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.577 Vali Acc: 0.573 Test Loss: 1.577 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7583491802215576
Epoch: 21, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.613 Vali Acc: 0.588 Test Loss: 1.613 Test Acc: 0.588
Validation loss decreased (-0.580137 --> -0.587770).  Saving model ...
Epoch: 22 cost time: 1.7368812561035156
Epoch: 22, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.541 Vali Acc: 0.565 Test Loss: 1.541 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5716264247894287
Epoch: 23, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.449 Vali Acc: 0.557 Test Loss: 1.449 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5352866649627686
Epoch: 24, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.489 Vali Acc: 0.542 Test Loss: 1.489 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7544105052947998
Epoch: 25, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.543 Vali Acc: 0.542 Test Loss: 1.543 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8656699657440186
Epoch: 26, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.398 Vali Acc: 0.550 Test Loss: 1.398 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.728581190109253
Epoch: 27, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.359 Vali Acc: 0.557 Test Loss: 1.359 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7021632194519043
Epoch: 28, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.349 Vali Acc: 0.557 Test Loss: 1.349 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4394845962524414
Epoch: 29, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.298 Vali Acc: 0.557 Test Loss: 1.298 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3938496112823486
Epoch: 30, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.420 Vali Acc: 0.557 Test Loss: 1.420 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.474663496017456
Epoch: 31, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.593 Vali Acc: 0.550 Test Loss: 1.593 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 2643973
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.9758429527282715
Epoch: 1, Steps: 8 | Train Loss: 1.665 Vali Loss: 1.593 Vali Acc: 0.229 Test Loss: 1.593 Test Acc: 0.229
Validation loss decreased (inf --> -0.228992).  Saving model ...
Epoch: 2 cost time: 1.858949899673462
Epoch: 2, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
Validation loss decreased (-0.228992 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 1.7874112129211426
Epoch: 3, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.478 Vali Acc: 0.466 Test Loss: 1.478 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7349727153778076
Epoch: 4, Steps: 8 | Train Loss: 0.631 Vali Loss: 1.453 Vali Acc: 0.489 Test Loss: 1.453 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.7723190784454346
Epoch: 5, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.439 Vali Acc: 0.489 Test Loss: 1.439 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 2.0394463539123535
Epoch: 6, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.456 Vali Acc: 0.489 Test Loss: 1.456 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8533480167388916
Epoch: 7, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.440 Vali Acc: 0.496 Test Loss: 1.440 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.7064707279205322
Epoch: 8, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.452 Vali Acc: 0.489 Test Loss: 1.452 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.622938632965088
Epoch: 9, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.441 Vali Acc: 0.504 Test Loss: 1.441 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.6541216373443604
Epoch: 10, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.530 Vali Acc: 0.504 Test Loss: 1.530 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7580413818359375
Epoch: 11, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 12 cost time: 1.7338194847106934
Epoch: 12, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.483 Vali Acc: 0.504 Test Loss: 1.483 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8939614295959473
Epoch: 13, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.466 Vali Acc: 0.489 Test Loss: 1.466 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3792839050292969
Epoch: 14, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.466 Vali Acc: 0.481 Test Loss: 1.466 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.048229455947876
Epoch: 15, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.457 Vali Acc: 0.489 Test Loss: 1.457 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.84824538230896
Epoch: 16, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7575416564941406
Epoch: 17, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.403 Vali Acc: 0.496 Test Loss: 1.403 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5857245922088623
Epoch: 18, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.434 Vali Acc: 0.481 Test Loss: 1.434 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.623185157775879
Epoch: 19, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.515 Vali Acc: 0.450 Test Loss: 1.515 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9209215641021729
Epoch: 20, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.516 Vali Acc: 0.466 Test Loss: 1.516 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1218349933624268
Epoch: 21, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.481 Vali Acc: 0.496 Test Loss: 1.481 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2866437
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5943243503570557
Epoch: 1, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.570 Vali Acc: 0.412 Test Loss: 1.570 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.4003262519836426
Epoch: 2, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.456 Vali Acc: 0.473 Test Loss: 1.456 Test Acc: 0.473
Validation loss decreased (-0.412198 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.3288707733154297
Epoch: 3, Steps: 8 | Train Loss: 0.563 Vali Loss: 1.266 Vali Acc: 0.511 Test Loss: 1.266 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511438).  Saving model ...
Epoch: 4 cost time: 1.2859671115875244
Epoch: 4, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.416 Vali Acc: 0.534 Test Loss: 1.416 Test Acc: 0.534
Validation loss decreased (-0.511438 --> -0.534337).  Saving model ...
Epoch: 5 cost time: 1.602283239364624
Epoch: 5, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.339 Vali Acc: 0.527 Test Loss: 1.339 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5962469577789307
Epoch: 6, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.587 Vali Acc: 0.527 Test Loss: 1.587 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4761462211608887
Epoch: 7, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.397 Vali Acc: 0.557 Test Loss: 1.397 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 8 cost time: 1.4576597213745117
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.278 Vali Acc: 0.580 Test Loss: 1.278 Test Acc: 0.580
Validation loss decreased (-0.557238 --> -0.580140).  Saving model ...
Epoch: 9 cost time: 1.5565578937530518
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.579 Vali Acc: 0.534 Test Loss: 1.579 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.631744384765625
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.924 Vali Acc: 0.542 Test Loss: 1.924 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6374120712280273
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.809 Vali Acc: 0.542 Test Loss: 1.809 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.373056411743164
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.789 Vali Acc: 0.542 Test Loss: 1.789 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3578603267669678
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.904 Vali Acc: 0.534 Test Loss: 1.904 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6010768413543701
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.015 Vali Acc: 0.534 Test Loss: 2.015 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.33516526222229
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.013 Vali Acc: 0.534 Test Loss: 2.013 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.304861068725586
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.058 Vali Acc: 0.534 Test Loss: 2.058 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4108405113220215
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.115 Vali Acc: 0.534 Test Loss: 2.115 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7515995502471924
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.074 Vali Acc: 0.534 Test Loss: 2.074 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 794757
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.2286999225616455
Epoch: 1, Steps: 8 | Train Loss: 1.696 Vali Loss: 1.578 Vali Acc: 0.359 Test Loss: 1.578 Test Acc: 0.359
Validation loss decreased (inf --> -0.358763).  Saving model ...
Epoch: 2 cost time: 1.4269657135009766
Epoch: 2, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.494 Vali Acc: 0.427 Test Loss: 1.494 Test Acc: 0.427
Validation loss decreased (-0.358763 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 2.271597146987915
Epoch: 3, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.390 Vali Acc: 0.481 Test Loss: 1.390 Test Acc: 0.481
Validation loss decreased (-0.427466 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.4796273708343506
Epoch: 4, Steps: 8 | Train Loss: 0.573 Vali Loss: 1.363 Vali Acc: 0.489 Test Loss: 1.363 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.7547259330749512
Epoch: 5, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.184 Vali Acc: 0.557 Test Loss: 1.184 Test Acc: 0.557
Validation loss decreased (-0.488536 --> -0.557240).  Saving model ...
Epoch: 6 cost time: 1.8214735984802246
Epoch: 6, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.441 Vali Acc: 0.511 Test Loss: 1.441 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7151761054992676
Epoch: 7, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.287 Vali Acc: 0.557 Test Loss: 1.287 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5913126468658447
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.475 Vali Acc: 0.527 Test Loss: 1.475 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1969377994537354
Epoch: 9, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.479 Vali Acc: 0.542 Test Loss: 1.479 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.588991403579712
Epoch: 10, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.358 Vali Acc: 0.573 Test Loss: 1.358 Test Acc: 0.573
Validation loss decreased (-0.557240 --> -0.572506).  Saving model ...
Epoch: 11 cost time: 2.1630587577819824
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.419 Vali Acc: 0.573 Test Loss: 1.419 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5843393802642822
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.879 Vali Acc: 0.542 Test Loss: 1.879 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6723086833953857
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.825 Vali Acc: 0.519 Test Loss: 1.825 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.659214973449707
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.560 Vali Acc: 0.557 Test Loss: 1.560 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4979274272918701
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.963 Vali Acc: 0.534 Test Loss: 1.963 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5610332489013672
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.804 Vali Acc: 0.542 Test Loss: 1.804 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5484857559204102
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.832 Vali Acc: 0.542 Test Loss: 1.832 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9908688068389893
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.911 Vali Acc: 0.534 Test Loss: 1.911 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4704492092132568
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.138 Vali Acc: 0.527 Test Loss: 2.138 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7977294921875
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.923 Vali Acc: 0.542 Test Loss: 1.923 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 698757
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6265509128570557
Epoch: 1, Steps: 8 | Train Loss: 1.660 Vali Loss: 1.571 Vali Acc: 0.328 Test Loss: 1.571 Test Acc: 0.328
Validation loss decreased (inf --> -0.328229).  Saving model ...
Epoch: 2 cost time: 1.1875877380371094
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.544 Vali Acc: 0.427 Test Loss: 1.544 Test Acc: 0.427
Validation loss decreased (-0.328229 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.1191391944885254
Epoch: 3, Steps: 8 | Train Loss: 1.053 Vali Loss: 1.496 Vali Acc: 0.443 Test Loss: 1.496 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.5401532649993896
Epoch: 4, Steps: 8 | Train Loss: 0.721 Vali Loss: 1.414 Vali Acc: 0.534 Test Loss: 1.414 Test Acc: 0.534
Validation loss decreased (-0.442733 --> -0.534337).  Saving model ...
Epoch: 5 cost time: 1.2242343425750732
Epoch: 5, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4914188385009766
Epoch: 6, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2361538410186768
Epoch: 7, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2304394245147705
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5208635330200195
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.420 Vali Acc: 0.527 Test Loss: 1.420 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1866443157196045
Epoch: 10, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.414 Vali Acc: 0.534 Test Loss: 1.414 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3676140308380127
Epoch: 11, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3922805786132812
Epoch: 12, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.348 Vali Acc: 0.542 Test Loss: 1.348 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 13 cost time: 1.4473166465759277
Epoch: 13, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.389 Vali Acc: 0.542 Test Loss: 1.389 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.270660638809204
Epoch: 14, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.437 Vali Acc: 0.534 Test Loss: 1.437 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.341773509979248
Epoch: 15, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2945189476013184
Epoch: 16, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8136131763458252
Epoch: 17, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.469 Vali Acc: 0.534 Test Loss: 1.469 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.717592716217041
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.500 Vali Acc: 0.534 Test Loss: 1.500 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4260151386260986
Epoch: 19, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.448 Vali Acc: 0.542 Test Loss: 1.448 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.458655834197998
Epoch: 20, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.504 Vali Acc: 0.534 Test Loss: 1.504 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6377882957458496
Epoch: 21, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.536 Vali Acc: 0.527 Test Loss: 1.536 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3570291996002197
Epoch: 22, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.458 Vali Acc: 0.565 Test Loss: 1.458 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564871).  Saving model ...
Epoch: 23 cost time: 1.387033224105835
Epoch: 23, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.736 Vali Acc: 0.534 Test Loss: 1.736 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3050777912139893
Epoch: 24, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.554 Vali Acc: 0.519 Test Loss: 1.554 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4774348735809326
Epoch: 25, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.308 Vali Acc: 0.542 Test Loss: 1.308 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6777691841125488
Epoch: 26, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.297 Vali Acc: 0.542 Test Loss: 1.297 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4778053760528564
Epoch: 27, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.362 Vali Acc: 0.542 Test Loss: 1.362 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.413407325744629
Epoch: 28, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.400 Vali Acc: 0.527 Test Loss: 1.400 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.611785650253296
Epoch: 29, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.437 Vali Acc: 0.557 Test Loss: 1.437 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.410386085510254
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.539 Vali Acc: 0.550 Test Loss: 1.539 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1582858562469482
Epoch: 31, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.697 Vali Acc: 0.534 Test Loss: 1.697 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4614927768707275
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.970 Vali Acc: 0.527 Test Loss: 1.970 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 706309
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.694002389907837
Epoch: 1, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.574 Vali Acc: 0.313 Test Loss: 1.574 Test Acc: 0.313
Validation loss decreased (inf --> -0.312961).  Saving model ...
Epoch: 2 cost time: 1.7393982410430908
Epoch: 2, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.541 Vali Acc: 0.450 Test Loss: 1.541 Test Acc: 0.450
Validation loss decreased (-0.312961 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.3286895751953125
Epoch: 3, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.492 Vali Acc: 0.481 Test Loss: 1.492 Test Acc: 0.481
Validation loss decreased (-0.450366 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.195587158203125
Epoch: 4, Steps: 8 | Train Loss: 0.751 Vali Loss: 1.382 Vali Acc: 0.527 Test Loss: 1.382 Test Acc: 0.527
Validation loss decreased (-0.480901 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 1.5354726314544678
Epoch: 5, Steps: 8 | Train Loss: 0.536 Vali Loss: 1.297 Vali Acc: 0.511 Test Loss: 1.297 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8181638717651367
Epoch: 6, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.329 Vali Acc: 0.511 Test Loss: 1.329 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8088414669036865
Epoch: 7, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.268 Vali Acc: 0.519 Test Loss: 1.268 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5668041706085205
Epoch: 8, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.331 Vali Acc: 0.519 Test Loss: 1.331 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.88981032371521
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.339 Vali Acc: 0.527 Test Loss: 1.339 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.5607118606567383
Epoch: 10, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.275 Vali Acc: 0.527 Test Loss: 1.275 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526705).  Saving model ...
Epoch: 11 cost time: 1.5013048648834229
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.274 Vali Acc: 0.550 Test Loss: 1.274 Test Acc: 0.550
Validation loss decreased (-0.526705 --> -0.549606).  Saving model ...
Epoch: 12 cost time: 1.680818796157837
Epoch: 12, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.328 Vali Acc: 0.550 Test Loss: 1.328 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6046960353851318
Epoch: 13, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.435 Vali Acc: 0.534 Test Loss: 1.435 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3076484203338623
Epoch: 14, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3798789978027344
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.482 Vali Acc: 0.527 Test Loss: 1.482 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7150073051452637
Epoch: 16, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.457 Vali Acc: 0.542 Test Loss: 1.457 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0567445755004883
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.374 Vali Acc: 0.550 Test Loss: 1.374 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3434772491455078
Epoch: 18, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.447 Vali Acc: 0.557 Test Loss: 1.447 Test Acc: 0.557
Validation loss decreased (-0.549606 --> -0.557237).  Saving model ...
Epoch: 19 cost time: 1.4294695854187012
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.429 Vali Acc: 0.534 Test Loss: 1.429 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.606837272644043
Epoch: 20, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.317 Vali Acc: 0.595 Test Loss: 1.317 Test Acc: 0.595
Validation loss decreased (-0.557237 --> -0.595407).  Saving model ...
Epoch: 21 cost time: 1.7027688026428223
Epoch: 21, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.296 Vali Acc: 0.595 Test Loss: 1.296 Test Acc: 0.595
Validation loss decreased (-0.595407 --> -0.595407).  Saving model ...
Epoch: 22 cost time: 1.4832813739776611
Epoch: 22, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.583 Vali Acc: 0.542 Test Loss: 1.583 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.29927396774292
Epoch: 23, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.433 Vali Acc: 0.595 Test Loss: 1.433 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7015180587768555
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.457 Vali Acc: 0.565 Test Loss: 1.457 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.746070384979248
Epoch: 25, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.486 Vali Acc: 0.557 Test Loss: 1.486 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3941776752471924
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.421 Vali Acc: 0.573 Test Loss: 1.421 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7489118576049805
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.302 Vali Acc: 0.588 Test Loss: 1.302 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4677412509918213
Epoch: 28, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.277 Vali Acc: 0.603 Test Loss: 1.277 Test Acc: 0.603
Validation loss decreased (-0.595407 --> -0.603041).  Saving model ...
Epoch: 29 cost time: 1.2629339694976807
Epoch: 29, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.398 Vali Acc: 0.557 Test Loss: 1.398 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7111258506774902
Epoch: 30, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.277 Vali Acc: 0.580 Test Loss: 1.277 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6186442375183105
Epoch: 31, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.231 Vali Acc: 0.550 Test Loss: 1.231 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.811075210571289
Epoch: 32, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.198 Vali Acc: 0.557 Test Loss: 1.198 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0274174213409424
Epoch: 33, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.715 Vali Acc: 0.557 Test Loss: 1.715 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.430285930633545
Epoch: 34, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.428 Vali Acc: 0.550 Test Loss: 1.428 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7118406295776367
Epoch: 35, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.333 Vali Acc: 0.580 Test Loss: 1.333 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.459944486618042
Epoch: 36, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.592 Vali Acc: 0.565 Test Loss: 1.592 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.6789817810058594
Epoch: 37, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.970 Vali Acc: 0.573 Test Loss: 1.970 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3737010955810547
Epoch: 38, Steps: 8 | Train Loss: 0.042 Vali Loss: 2.216 Vali Acc: 0.542 Test Loss: 2.216 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 737029
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.84018611907959
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.617 Vali Acc: 0.229 Test Loss: 1.617 Test Acc: 0.229
Validation loss decreased (inf --> -0.228991).  Saving model ...
Epoch: 2 cost time: 1.906627893447876
Epoch: 2, Steps: 8 | Train Loss: 1.429 Vali Loss: 1.574 Vali Acc: 0.412 Test Loss: 1.574 Test Acc: 0.412
Validation loss decreased (-0.228991 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.6449790000915527
Epoch: 3, Steps: 8 | Train Loss: 1.142 Vali Loss: 1.541 Vali Acc: 0.427 Test Loss: 1.541 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.3848154544830322
Epoch: 4, Steps: 8 | Train Loss: 0.843 Vali Loss: 1.488 Vali Acc: 0.443 Test Loss: 1.488 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.4837708473205566
Epoch: 5, Steps: 8 | Train Loss: 0.656 Vali Loss: 1.424 Vali Acc: 0.466 Test Loss: 1.424 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465635).  Saving model ...
Epoch: 6 cost time: 1.6596839427947998
Epoch: 6, Steps: 8 | Train Loss: 0.481 Vali Loss: 1.412 Vali Acc: 0.489 Test Loss: 1.412 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.8401129245758057
Epoch: 7, Steps: 8 | Train Loss: 0.367 Vali Loss: 1.398 Vali Acc: 0.511 Test Loss: 1.398 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.8234972953796387
Epoch: 8, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 1.8166718482971191
Epoch: 9, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.582435131072998
Epoch: 10, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.9877269268035889
Epoch: 11, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.422 Vali Acc: 0.527 Test Loss: 1.422 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.571871042251587
Epoch: 12, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3321034908294678
Epoch: 13, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5334722995758057
Epoch: 14, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.394 Vali Acc: 0.519 Test Loss: 1.394 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4614841938018799
Epoch: 15, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6538231372833252
Epoch: 16, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.689377784729004
Epoch: 17, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.453 Vali Acc: 0.519 Test Loss: 1.453 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.579627513885498
Epoch: 18, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.460 Vali Acc: 0.527 Test Loss: 1.460 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.479694128036499
Epoch: 19, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.493 Vali Acc: 0.527 Test Loss: 1.493 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5496220588684082
Epoch: 20, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.465 Vali Acc: 0.527 Test Loss: 1.465 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 829061
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.564303398132324
Epoch: 1, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.571 Vali Acc: 0.382 Test Loss: 1.571 Test Acc: 0.382
Validation loss decreased (inf --> -0.381664).  Saving model ...
Epoch: 2 cost time: 1.5690712928771973
Epoch: 2, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.551 Vali Acc: 0.397 Test Loss: 1.551 Test Acc: 0.397
Validation loss decreased (-0.381664 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.5891528129577637
Epoch: 3, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.507 Vali Acc: 0.427 Test Loss: 1.507 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.3986475467681885
Epoch: 4, Steps: 8 | Train Loss: 0.786 Vali Loss: 1.460 Vali Acc: 0.481 Test Loss: 1.460 Test Acc: 0.481
Validation loss decreased (-0.427466 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.5773799419403076
Epoch: 5, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.425 Vali Acc: 0.519 Test Loss: 1.425 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.5541770458221436
Epoch: 6, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.7238848209381104
Epoch: 7, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.391 Vali Acc: 0.511 Test Loss: 1.391 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.586665391921997
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.372 Vali Acc: 0.519 Test Loss: 1.372 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.845203161239624
Epoch: 9, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.400 Vali Acc: 0.534 Test Loss: 1.400 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 10 cost time: 1.7401738166809082
Epoch: 10, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.476 Vali Acc: 0.573 Test Loss: 1.476 Test Acc: 0.573
Validation loss decreased (-0.534337 --> -0.572504).  Saving model ...
Epoch: 11 cost time: 1.3988478183746338
Epoch: 11, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.482 Vali Acc: 0.550 Test Loss: 1.482 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8700783252716064
Epoch: 12, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8271815776824951
Epoch: 13, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.447 Vali Acc: 0.527 Test Loss: 1.447 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8057448863983154
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.499 Vali Acc: 0.534 Test Loss: 1.499 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.740025520324707
Epoch: 15, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.428 Vali Acc: 0.557 Test Loss: 1.428 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3142962455749512
Epoch: 16, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.509 Vali Acc: 0.565 Test Loss: 1.509 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6268091201782227
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.502 Vali Acc: 0.519 Test Loss: 1.502 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5569953918457031
Epoch: 18, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.485 Vali Acc: 0.534 Test Loss: 1.485 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7627737522125244
Epoch: 19, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.608 Vali Acc: 0.557 Test Loss: 1.608 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4051575660705566
Epoch: 20, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.475 Vali Acc: 0.542 Test Loss: 1.475 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 928773
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.957136392593384
Epoch: 1, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.599 Vali Acc: 0.328 Test Loss: 1.599 Test Acc: 0.328
Validation loss decreased (inf --> -0.328228).  Saving model ...
Epoch: 2 cost time: 1.3330154418945312
Epoch: 2, Steps: 8 | Train Loss: 1.416 Vali Loss: 1.589 Vali Acc: 0.420 Test Loss: 1.589 Test Acc: 0.420
Validation loss decreased (-0.328228 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.0740854740142822
Epoch: 3, Steps: 8 | Train Loss: 1.078 Vali Loss: 1.578 Vali Acc: 0.435 Test Loss: 1.578 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.1722989082336426
Epoch: 4, Steps: 8 | Train Loss: 0.837 Vali Loss: 1.533 Vali Acc: 0.443 Test Loss: 1.533 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.524406909942627
Epoch: 5, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.506 Vali Acc: 0.466 Test Loss: 1.506 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.1836090087890625
Epoch: 6, Steps: 8 | Train Loss: 0.475 Vali Loss: 1.494 Vali Acc: 0.481 Test Loss: 1.494 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 1.5964155197143555
Epoch: 7, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.488 Vali Acc: 0.489 Test Loss: 1.488 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.1834819316864014
Epoch: 8, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.439 Vali Acc: 0.496 Test Loss: 1.439 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.14821195602417
Epoch: 9, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.421 Vali Acc: 0.519 Test Loss: 1.421 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.5137314796447754
Epoch: 10, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.452 Vali Acc: 0.496 Test Loss: 1.452 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4442226886749268
Epoch: 11, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.464 Vali Acc: 0.481 Test Loss: 1.464 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2978179454803467
Epoch: 12, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.456 Vali Acc: 0.496 Test Loss: 1.456 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.501523733139038
Epoch: 13, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.444 Vali Acc: 0.504 Test Loss: 1.444 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4116621017456055
Epoch: 14, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.424 Vali Acc: 0.504 Test Loss: 1.424 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1335248947143555
Epoch: 15, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.433 Vali Acc: 0.496 Test Loss: 1.433 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2429609298706055
Epoch: 16, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.468 Vali Acc: 0.504 Test Loss: 1.468 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7433223724365234
Epoch: 17, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.459 Vali Acc: 0.496 Test Loss: 1.459 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4872305393218994
Epoch: 18, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.481 Vali Acc: 0.473 Test Loss: 1.481 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.137789011001587
Epoch: 19, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.479 Vali Acc: 0.466 Test Loss: 1.479 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1040005
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.536976337432861
Epoch: 1, Steps: 8 | Train Loss: 1.661 Vali Loss: 1.580 Vali Acc: 0.389 Test Loss: 1.580 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.4228134155273438
Epoch: 2, Steps: 8 | Train Loss: 1.392 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.3501002788543701
Epoch: 3, Steps: 8 | Train Loss: 0.966 Vali Loss: 1.413 Vali Acc: 0.473 Test Loss: 1.413 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.368163824081421
Epoch: 4, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.250 Vali Acc: 0.557 Test Loss: 1.250 Test Acc: 0.557
Validation loss decreased (-0.473268 --> -0.557239).  Saving model ...
Epoch: 5 cost time: 1.4810075759887695
Epoch: 5, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.349 Vali Acc: 0.504 Test Loss: 1.349 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5168380737304688
Epoch: 6, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.413 Vali Acc: 0.519 Test Loss: 1.413 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5430574417114258
Epoch: 7, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.287 Vali Acc: 0.519 Test Loss: 1.287 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4471449851989746
Epoch: 8, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.287 Vali Acc: 0.527 Test Loss: 1.287 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7620844841003418
Epoch: 9, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3692855834960938
Epoch: 10, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.376 Vali Acc: 0.534 Test Loss: 1.376 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2030432224273682
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.355 Vali Acc: 0.534 Test Loss: 1.355 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3230957984924316
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.530 Vali Acc: 0.519 Test Loss: 1.530 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3575234413146973
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.487 Vali Acc: 0.527 Test Loss: 1.487 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4794971942901611
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.429 Vali Acc: 0.550 Test Loss: 1.429 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 299077
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.77271032333374
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.634 Vali Acc: 0.389 Test Loss: 1.634 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.7725505828857422
Epoch: 2, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.602 Vali Acc: 0.412 Test Loss: 1.602 Test Acc: 0.412
Validation loss decreased (-0.389297 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.4110372066497803
Epoch: 3, Steps: 8 | Train Loss: 1.146 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6675829887390137
Epoch: 4, Steps: 8 | Train Loss: 0.851 Vali Loss: 1.477 Vali Acc: 0.450 Test Loss: 1.477 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.722050428390503
Epoch: 5, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 1.3597874641418457
Epoch: 6, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.480 Vali Acc: 0.504 Test Loss: 1.480 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 1.446315050125122
Epoch: 7, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.516 Vali Acc: 0.504 Test Loss: 1.516 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6212875843048096
Epoch: 8, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.582 Vali Acc: 0.511 Test Loss: 1.582 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 9 cost time: 1.3660287857055664
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.609 Vali Acc: 0.519 Test Loss: 1.609 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519068).  Saving model ...
Epoch: 10 cost time: 1.449368953704834
Epoch: 10, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.711 Vali Acc: 0.519 Test Loss: 1.711 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6881275177001953
Epoch: 11, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.904 Vali Acc: 0.519 Test Loss: 1.904 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5825271606445312
Epoch: 12, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.912 Vali Acc: 0.519 Test Loss: 1.912 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7192881107330322
Epoch: 13, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.778 Vali Acc: 0.519 Test Loss: 1.778 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.091569662094116
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.804 Vali Acc: 0.519 Test Loss: 1.804 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.437727451324463
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.708 Vali Acc: 0.519 Test Loss: 1.708 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5411770343780518
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.977 Vali Acc: 0.519 Test Loss: 1.977 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.165510654449463
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.908 Vali Acc: 0.519 Test Loss: 1.908 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.731128454208374
Epoch: 18, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.838 Vali Acc: 0.519 Test Loss: 1.838 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4206836223602295
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.922 Vali Acc: 0.519 Test Loss: 1.922 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 251077
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.329628229141235
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.621 Vali Acc: 0.252 Test Loss: 1.621 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.6777355670928955
Epoch: 2, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
Validation loss decreased (-0.251892 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.883361577987671
Epoch: 3, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.525 Vali Acc: 0.427 Test Loss: 1.525 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.7141649723052979
Epoch: 4, Steps: 8 | Train Loss: 0.995 Vali Loss: 1.454 Vali Acc: 0.466 Test Loss: 1.454 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.7233529090881348
Epoch: 5, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.396 Vali Acc: 0.496 Test Loss: 1.396 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.888024091720581
Epoch: 6, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.391 Vali Acc: 0.504 Test Loss: 1.391 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.5172011852264404
Epoch: 7, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.345 Vali Acc: 0.511 Test Loss: 1.345 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 8 cost time: 1.8254485130310059
Epoch: 8, Steps: 8 | Train Loss: 0.300 Vali Loss: 1.325 Vali Acc: 0.511 Test Loss: 1.325 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511437).  Saving model ...
Epoch: 9 cost time: 1.6465201377868652
Epoch: 9, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.315 Vali Acc: 0.519 Test Loss: 1.315 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519071).  Saving model ...
Epoch: 10 cost time: 1.66978120803833
Epoch: 10, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.404 Vali Acc: 0.519 Test Loss: 1.404 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6807584762573242
Epoch: 11, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.375 Vali Acc: 0.519 Test Loss: 1.375 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5791559219360352
Epoch: 12, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.407 Vali Acc: 0.519 Test Loss: 1.407 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9873640537261963
Epoch: 13, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6318027973175049
Epoch: 14, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.918403148651123
Epoch: 15, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.383 Vali Acc: 0.527 Test Loss: 1.383 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 16 cost time: 1.5410997867584229
Epoch: 16, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7920682430267334
Epoch: 17, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.441 Vali Acc: 0.519 Test Loss: 1.441 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9377593994140625
Epoch: 18, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.456 Vali Acc: 0.519 Test Loss: 1.456 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.182366371154785
Epoch: 19, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.447 Vali Acc: 0.527 Test Loss: 1.447 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6357800960540771
Epoch: 20, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.375 Vali Acc: 0.534 Test Loss: 1.375 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 21 cost time: 1.606891393661499
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9365689754486084
Epoch: 22, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8043344020843506
Epoch: 23, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.384 Vali Acc: 0.534 Test Loss: 1.384 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4903907775878906
Epoch: 24, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.583 Vali Acc: 0.511 Test Loss: 1.583 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7764050960540771
Epoch: 25, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.585 Vali Acc: 0.519 Test Loss: 1.585 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7790510654449463
Epoch: 26, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.523 Vali Acc: 0.542 Test Loss: 1.523 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 27 cost time: 1.4173061847686768
Epoch: 27, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4449584484100342
Epoch: 28, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.463 Vali Acc: 0.527 Test Loss: 1.463 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0689616203308105
Epoch: 29, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.441 Vali Acc: 0.550 Test Loss: 1.441 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549604).  Saving model ...
Epoch: 30 cost time: 1.5678932666778564
Epoch: 30, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9970831871032715
Epoch: 31, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8122820854187012
Epoch: 32, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.518 Vali Acc: 0.527 Test Loss: 1.518 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.545501947402954
Epoch: 33, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.571 Vali Acc: 0.550 Test Loss: 1.571 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.0451014041900635
Epoch: 34, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.454 Vali Acc: 0.534 Test Loss: 1.454 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.811861515045166
Epoch: 35, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.372 Vali Acc: 0.542 Test Loss: 1.372 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7563483715057373
Epoch: 36, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.492 Vali Acc: 0.534 Test Loss: 1.492 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6576952934265137
Epoch: 37, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.534 Vali Acc: 0.534 Test Loss: 1.534 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7507424354553223
Epoch: 38, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.097160577774048
Epoch: 39, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.314 Vali Acc: 0.565 Test Loss: 1.314 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564872).  Saving model ...
Epoch: 40 cost time: 1.6331958770751953
Epoch: 40, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.376 Vali Acc: 0.550 Test Loss: 1.376 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6535844802856445
Epoch: 41, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.465 Vali Acc: 0.527 Test Loss: 1.465 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5665655136108398
Epoch: 42, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.506 Vali Acc: 0.542 Test Loss: 1.506 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.8341703414916992
Epoch: 43, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.565 Vali Acc: 0.527 Test Loss: 1.565 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6368656158447266
Epoch: 44, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.562 Vali Acc: 0.511 Test Loss: 1.562 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.5491087436676025
Epoch: 45, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.467 Vali Acc: 0.511 Test Loss: 1.467 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4455952644348145
Epoch: 46, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.494 Vali Acc: 0.519 Test Loss: 1.494 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.051743507385254
Epoch: 47, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.547 Vali Acc: 0.527 Test Loss: 1.547 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.9567325115203857
Epoch: 48, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.581 Vali Acc: 0.527 Test Loss: 1.581 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.7858021259307861
Epoch: 49, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.597 Vali Acc: 0.527 Test Loss: 1.597 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 254853
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.43856954574585
Epoch: 1, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.607 Vali Acc: 0.244 Test Loss: 1.607 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 1.5979764461517334
Epoch: 2, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.560 Vali Acc: 0.405 Test Loss: 1.560 Test Acc: 0.405
Validation loss decreased (-0.244259 --> -0.404565).  Saving model ...
Epoch: 3 cost time: 1.6108930110931396
Epoch: 3, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.522 Vali Acc: 0.443 Test Loss: 1.522 Test Acc: 0.443
Validation loss decreased (-0.404565 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.521249771118164
Epoch: 4, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.495 Vali Acc: 0.450 Test Loss: 1.495 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.521345853805542
Epoch: 5, Steps: 8 | Train Loss: 0.854 Vali Loss: 1.457 Vali Acc: 0.481 Test Loss: 1.457 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.3975481986999512
Epoch: 6, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.415 Vali Acc: 0.496 Test Loss: 1.415 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.6990463733673096
Epoch: 7, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.4761652946472168
Epoch: 8, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6992616653442383
Epoch: 9, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.392 Vali Acc: 0.511 Test Loss: 1.392 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3349609375
Epoch: 10, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.343 Vali Acc: 0.527 Test Loss: 1.343 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.355654001235962
Epoch: 11, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.408 Vali Acc: 0.542 Test Loss: 1.408 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 12 cost time: 1.6668925285339355
Epoch: 12, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.420 Vali Acc: 0.527 Test Loss: 1.420 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6817471981048584
Epoch: 13, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.413 Vali Acc: 0.542 Test Loss: 1.413 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3462121486663818
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.516 Vali Acc: 0.527 Test Loss: 1.516 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6153054237365723
Epoch: 15, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549605).  Saving model ...
Epoch: 16 cost time: 1.5557067394256592
Epoch: 16, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.440 Vali Acc: 0.542 Test Loss: 1.440 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.577815294265747
Epoch: 17, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.376 Vali Acc: 0.557 Test Loss: 1.376 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557238).  Saving model ...
Epoch: 18 cost time: 1.611736536026001
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.621 Vali Acc: 0.519 Test Loss: 1.621 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.440260887145996
Epoch: 19, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.434 Vali Acc: 0.542 Test Loss: 1.434 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.571638822555542
Epoch: 20, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.629 Vali Acc: 0.542 Test Loss: 1.629 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8338568210601807
Epoch: 21, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.498 Vali Acc: 0.542 Test Loss: 1.498 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6009955406188965
Epoch: 22, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.600 Vali Acc: 0.542 Test Loss: 1.600 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5190327167510986
Epoch: 23, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.422 Vali Acc: 0.542 Test Loss: 1.422 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.794245958328247
Epoch: 24, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.360 Vali Acc: 0.550 Test Loss: 1.360 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6011028289794922
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.399 Vali Acc: 0.542 Test Loss: 1.399 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8048934936523438
Epoch: 26, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.542 Vali Acc: 0.565 Test Loss: 1.542 Test Acc: 0.565
Validation loss decreased (-0.557238 --> -0.564870).  Saving model ...
Epoch: 27 cost time: 1.7090973854064941
Epoch: 27, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.471 Vali Acc: 0.550 Test Loss: 1.471 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8315935134887695
Epoch: 28, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.411 Vali Acc: 0.580 Test Loss: 1.411 Test Acc: 0.580
Validation loss decreased (-0.564870 --> -0.580139).  Saving model ...
Epoch: 29 cost time: 1.613236427307129
Epoch: 29, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.572 Vali Acc: 0.542 Test Loss: 1.572 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4585545063018799
Epoch: 30, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.534 Vali Acc: 0.527 Test Loss: 1.534 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.679107666015625
Epoch: 31, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.527 Vali Acc: 0.542 Test Loss: 1.527 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.535268783569336
Epoch: 32, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.630 Vali Acc: 0.511 Test Loss: 1.630 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1930913925170898
Epoch: 33, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.649 Vali Acc: 0.557 Test Loss: 1.649 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9063076972961426
Epoch: 34, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.428 Vali Acc: 0.573 Test Loss: 1.428 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4864342212677002
Epoch: 35, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.414 Vali Acc: 0.542 Test Loss: 1.414 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.517197847366333
Epoch: 36, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.575 Vali Acc: 0.527 Test Loss: 1.575 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4440598487854004
Epoch: 37, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.346 Vali Acc: 0.611 Test Loss: 1.346 Test Acc: 0.611
Validation loss decreased (-0.580139 --> -0.610674).  Saving model ...
Epoch: 38 cost time: 1.7491774559020996
Epoch: 38, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.339 Vali Acc: 0.603 Test Loss: 1.339 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4863097667694092
Epoch: 39, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.688 Vali Acc: 0.565 Test Loss: 1.688 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7478830814361572
Epoch: 40, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.479 Vali Acc: 0.611 Test Loss: 1.479 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7576894760131836
Epoch: 41, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.415 Vali Acc: 0.611 Test Loss: 1.415 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.483647108078003
Epoch: 42, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.537 Vali Acc: 0.580 Test Loss: 1.537 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4830327033996582
Epoch: 43, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.535 Vali Acc: 0.550 Test Loss: 1.535 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5534005165100098
Epoch: 44, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.644 Vali Acc: 0.557 Test Loss: 1.644 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.6966073513031006
Epoch: 45, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.535 Vali Acc: 0.542 Test Loss: 1.535 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6148102283477783
Epoch: 46, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.482 Vali Acc: 0.565 Test Loss: 1.482 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.6649179458618164
Epoch: 47, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.639 Vali Acc: 0.603 Test Loss: 1.639 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 270213
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.008244037628174
Epoch: 1, Steps: 8 | Train Loss: 1.687 Vali Loss: 1.568 Vali Acc: 0.298 Test Loss: 1.568 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.592775821685791
Epoch: 2, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.541 Vali Acc: 0.397 Test Loss: 1.541 Test Acc: 0.397
Validation loss decreased (-0.297694 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.6807923316955566
Epoch: 3, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.504 Vali Acc: 0.443 Test Loss: 1.504 Test Acc: 0.443
Validation loss decreased (-0.396931 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.4415009021759033
Epoch: 4, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.472 Vali Acc: 0.466 Test Loss: 1.472 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.7156164646148682
Epoch: 5, Steps: 8 | Train Loss: 0.937 Vali Loss: 1.445 Vali Acc: 0.496 Test Loss: 1.445 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.5283117294311523
Epoch: 6, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.457 Vali Acc: 0.489 Test Loss: 1.457 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.193734884262085
Epoch: 7, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 0.982628583908081
Epoch: 8, Steps: 8 | Train Loss: 0.487 Vali Loss: 1.409 Vali Acc: 0.504 Test Loss: 1.409 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 1.240610122680664
Epoch: 9, Steps: 8 | Train Loss: 0.403 Vali Loss: 1.399 Vali Acc: 0.511 Test Loss: 1.399 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.6557185649871826
Epoch: 10, Steps: 8 | Train Loss: 0.350 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.290208101272583
Epoch: 11, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.363 Vali Acc: 0.527 Test Loss: 1.363 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 1.5953378677368164
Epoch: 12, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 13 cost time: 1.2690503597259521
Epoch: 13, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.387 Vali Acc: 0.519 Test Loss: 1.387 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3691205978393555
Epoch: 14, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.420 Vali Acc: 0.511 Test Loss: 1.420 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8256821632385254
Epoch: 15, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.434 Vali Acc: 0.504 Test Loss: 1.434 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4556739330291748
Epoch: 16, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4558823108673096
Epoch: 17, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4377617835998535
Epoch: 18, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.456 Vali Acc: 0.519 Test Loss: 1.456 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7092514038085938
Epoch: 19, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.389155387878418
Epoch: 20, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.452 Vali Acc: 0.511 Test Loss: 1.452 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4016931056976318
Epoch: 21, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1724703311920166
Epoch: 22, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.400 Vali Acc: 0.527 Test Loss: 1.400 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 316229
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7360050678253174
Epoch: 1, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.569 Vali Acc: 0.298 Test Loss: 1.569 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.441584825515747
Epoch: 2, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.533 Vali Acc: 0.351 Test Loss: 1.533 Test Acc: 0.351
Validation loss decreased (-0.297694 --> -0.351130).  Saving model ...
Epoch: 3 cost time: 1.729356050491333
Epoch: 3, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.484 Vali Acc: 0.443 Test Loss: 1.484 Test Acc: 0.443
Validation loss decreased (-0.351130 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.5150930881500244
Epoch: 4, Steps: 8 | Train Loss: 0.985 Vali Loss: 1.462 Vali Acc: 0.450 Test Loss: 1.462 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.3470814228057861
Epoch: 5, Steps: 8 | Train Loss: 0.784 Vali Loss: 1.435 Vali Acc: 0.481 Test Loss: 1.435 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.7405998706817627
Epoch: 6, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.424 Vali Acc: 0.496 Test Loss: 1.424 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.527944564819336
Epoch: 7, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.443 Vali Acc: 0.504 Test Loss: 1.443 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 1.7201054096221924
Epoch: 8, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.388 Vali Acc: 0.519 Test Loss: 1.388 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.568850040435791
Epoch: 9, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.366 Vali Acc: 0.527 Test Loss: 1.366 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.1891748905181885
Epoch: 10, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.366 Vali Acc: 0.511 Test Loss: 1.366 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3930063247680664
Epoch: 11, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.353 Vali Acc: 0.519 Test Loss: 1.353 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.351032018661499
Epoch: 12, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.654067039489746
Epoch: 13, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.425 Vali Acc: 0.519 Test Loss: 1.425 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.214320182800293
Epoch: 14, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.457 Vali Acc: 0.519 Test Loss: 1.457 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2117905616760254
Epoch: 15, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.379 Vali Acc: 0.511 Test Loss: 1.379 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.389082908630371
Epoch: 16, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.423 Vali Acc: 0.519 Test Loss: 1.423 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6715898513793945
Epoch: 17, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.458 Vali Acc: 0.527 Test Loss: 1.458 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4751887321472168
Epoch: 18, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.430 Vali Acc: 0.519 Test Loss: 1.430 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2677288055419922
Epoch: 19, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.431 Vali Acc: 0.534 Test Loss: 1.431 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 20 cost time: 1.6389803886413574
Epoch: 20, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.404 Vali Acc: 0.542 Test Loss: 1.404 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 21 cost time: 1.3530421257019043
Epoch: 21, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.385 Vali Acc: 0.565 Test Loss: 1.385 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564872).  Saving model ...
Epoch: 22 cost time: 1.8717575073242188
Epoch: 22, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.496 Vali Acc: 0.557 Test Loss: 1.496 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5315141677856445
Epoch: 23, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.447 Vali Acc: 0.557 Test Loss: 1.447 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4880907535552979
Epoch: 24, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.549 Vali Acc: 0.511 Test Loss: 1.549 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4016506671905518
Epoch: 25, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8168158531188965
Epoch: 26, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.561 Vali Acc: 0.527 Test Loss: 1.561 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.539830207824707
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.489 Vali Acc: 0.542 Test Loss: 1.489 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.528080701828003
Epoch: 28, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4627108573913574
Epoch: 29, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2829811573028564
Epoch: 30, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.444 Vali Acc: 0.511 Test Loss: 1.444 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.457198143005371
Epoch: 31, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.420 Vali Acc: 0.550 Test Loss: 1.420 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 366085
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.989084005355835
Epoch: 1, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.622 Vali Acc: 0.168 Test Loss: 1.622 Test Acc: 0.168
Validation loss decreased (inf --> -0.167923).  Saving model ...
Epoch: 2 cost time: 1.1847007274627686
Epoch: 2, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.611 Vali Acc: 0.267 Test Loss: 1.611 Test Acc: 0.267
Validation loss decreased (-0.167923 --> -0.267159).  Saving model ...
Epoch: 3 cost time: 1.212477684020996
Epoch: 3, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.598 Vali Acc: 0.405 Test Loss: 1.598 Test Acc: 0.405
Validation loss decreased (-0.267159 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 1.5841670036315918
Epoch: 4, Steps: 8 | Train Loss: 1.108 Vali Loss: 1.580 Vali Acc: 0.458 Test Loss: 1.580 Test Acc: 0.458
Validation loss decreased (-0.404564 --> -0.457999).  Saving model ...
Epoch: 5 cost time: 1.3740675449371338
Epoch: 5, Steps: 8 | Train Loss: 0.896 Vali Loss: 1.549 Vali Acc: 0.450 Test Loss: 1.549 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1120223999023438
Epoch: 6, Steps: 8 | Train Loss: 0.678 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
Validation loss decreased (-0.457999 --> -0.488534).  Saving model ...
Epoch: 7 cost time: 1.2831707000732422
Epoch: 7, Steps: 8 | Train Loss: 0.547 Vali Loss: 1.519 Vali Acc: 0.511 Test Loss: 1.519 Test Acc: 0.511
Validation loss decreased (-0.488534 --> -0.511435).  Saving model ...
Epoch: 8 cost time: 1.5184245109558105
Epoch: 8, Steps: 8 | Train Loss: 0.499 Vali Loss: 1.498 Vali Acc: 0.511 Test Loss: 1.498 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511435).  Saving model ...
Epoch: 9 cost time: 1.4573113918304443
Epoch: 9, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.477 Vali Acc: 0.504 Test Loss: 1.477 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.476518154144287
Epoch: 10, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.443 Vali Acc: 0.504 Test Loss: 1.443 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2660887241363525
Epoch: 11, Steps: 8 | Train Loss: 0.348 Vali Loss: 1.449 Vali Acc: 0.489 Test Loss: 1.449 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1742572784423828
Epoch: 12, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.447 Vali Acc: 0.519 Test Loss: 1.447 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519069).  Saving model ...
Epoch: 13 cost time: 1.327946424484253
Epoch: 13, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.448 Vali Acc: 0.511 Test Loss: 1.448 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5490906238555908
Epoch: 14, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.454 Vali Acc: 0.511 Test Loss: 1.454 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6378934383392334
Epoch: 15, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.411 Vali Acc: 0.511 Test Loss: 1.411 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4228174686431885
Epoch: 16, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.393 Vali Acc: 0.527 Test Loss: 1.393 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526704).  Saving model ...
Epoch: 17 cost time: 1.6405572891235352
Epoch: 17, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.451 Vali Acc: 0.511 Test Loss: 1.451 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2757582664489746
Epoch: 18, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.476 Vali Acc: 0.511 Test Loss: 1.476 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5361032485961914
Epoch: 19, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.506 Vali Acc: 0.489 Test Loss: 1.506 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3397812843322754
Epoch: 20, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.455 Vali Acc: 0.496 Test Loss: 1.455 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3124024868011475
Epoch: 21, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.433 Vali Acc: 0.519 Test Loss: 1.433 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1557703018188477
Epoch: 22, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.083390235900879
Epoch: 23, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.472 Vali Acc: 0.489 Test Loss: 1.472 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.205671787261963
Epoch: 24, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.488 Vali Acc: 0.504 Test Loss: 1.488 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.634885549545288
Epoch: 25, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.517 Vali Acc: 0.489 Test Loss: 1.517 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2226858139038086
Epoch: 26, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.524 Vali Acc: 0.504 Test Loss: 1.524 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 421701
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.148689270019531
Epoch: 1, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.600 Vali Acc: 0.282 Test Loss: 1.600 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 1.524855375289917
Epoch: 2, Steps: 8 | Train Loss: 1.436 Vali Loss: 1.527 Vali Acc: 0.450 Test Loss: 1.527 Test Acc: 0.450
Validation loss decreased (-0.282427 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.2246124744415283
Epoch: 3, Steps: 8 | Train Loss: 1.216 Vali Loss: 1.478 Vali Acc: 0.450 Test Loss: 1.478 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.5873141288757324
Epoch: 4, Steps: 8 | Train Loss: 0.944 Vali Loss: 1.396 Vali Acc: 0.511 Test Loss: 1.396 Test Acc: 0.511
Validation loss decreased (-0.450367 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.9775476455688477
Epoch: 5, Steps: 8 | Train Loss: 0.713 Vali Loss: 1.309 Vali Acc: 0.573 Test Loss: 1.309 Test Acc: 0.573
Validation loss decreased (-0.511436 --> -0.572506).  Saving model ...
Epoch: 6 cost time: 0.9795784950256348
Epoch: 6, Steps: 8 | Train Loss: 0.494 Vali Loss: 1.261 Vali Acc: 0.534 Test Loss: 1.261 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4273090362548828
Epoch: 7, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.269 Vali Acc: 0.542 Test Loss: 1.269 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7964966297149658
Epoch: 8, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.264 Vali Acc: 0.534 Test Loss: 1.264 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.725419521331787
Epoch: 9, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.196 Vali Acc: 0.565 Test Loss: 1.196 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1743154525756836
Epoch: 10, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.201 Vali Acc: 0.573 Test Loss: 1.201 Test Acc: 0.573
Validation loss decreased (-0.572506 --> -0.572507).  Saving model ...
Epoch: 11 cost time: 1.4104676246643066
Epoch: 11, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.301 Vali Acc: 0.534 Test Loss: 1.301 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9292898178100586
Epoch: 12, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.208 Vali Acc: 0.573 Test Loss: 1.208 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5115296840667725
Epoch: 13, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.128 Vali Acc: 0.603 Test Loss: 1.128 Test Acc: 0.603
Validation loss decreased (-0.572507 --> -0.603042).  Saving model ...
Epoch: 14 cost time: 1.3461670875549316
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.138 Vali Acc: 0.618 Test Loss: 1.138 Test Acc: 0.618
Validation loss decreased (-0.603042 --> -0.618309).  Saving model ...
Epoch: 15 cost time: 1.4276809692382812
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.324 Vali Acc: 0.565 Test Loss: 1.324 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3961968421936035
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.430 Vali Acc: 0.557 Test Loss: 1.430 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2468979358673096
Epoch: 17, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.295 Vali Acc: 0.573 Test Loss: 1.295 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2359521389007568
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.287 Vali Acc: 0.557 Test Loss: 1.287 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3808503150939941
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.291 Vali Acc: 0.550 Test Loss: 1.291 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2838034629821777
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.316 Vali Acc: 0.527 Test Loss: 1.316 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3465101718902588
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.739 Vali Acc: 0.519 Test Loss: 1.739 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2039883136749268
Epoch: 22, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.790 Vali Acc: 0.519 Test Loss: 1.790 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2766225337982178
Epoch: 23, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.551 Vali Acc: 0.542 Test Loss: 1.551 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1583666801452637
Epoch: 24, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.446 Vali Acc: 0.557 Test Loss: 1.446 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 124965
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.657653570175171
Epoch: 1, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.577 Vali Acc: 0.282 Test Loss: 1.577 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 1.0696725845336914
Epoch: 2, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.547 Vali Acc: 0.389 Test Loss: 1.547 Test Acc: 0.389
Validation loss decreased (-0.282427 --> -0.389298).  Saving model ...
Epoch: 3 cost time: 1.0515649318695068
Epoch: 3, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.526 Vali Acc: 0.435 Test Loss: 1.526 Test Acc: 0.435
Validation loss decreased (-0.389298 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.3564112186431885
Epoch: 4, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.484 Vali Acc: 0.427 Test Loss: 1.484 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2571806907653809
Epoch: 5, Steps: 8 | Train Loss: 0.940 Vali Loss: 1.409 Vali Acc: 0.435 Test Loss: 1.409 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.024975061416626
Epoch: 6, Steps: 8 | Train Loss: 0.741 Vali Loss: 1.346 Vali Acc: 0.458 Test Loss: 1.346 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458002).  Saving model ...
Epoch: 7 cost time: 1.0236132144927979
Epoch: 7, Steps: 8 | Train Loss: 0.589 Vali Loss: 1.368 Vali Acc: 0.473 Test Loss: 1.368 Test Acc: 0.473
Validation loss decreased (-0.458002 --> -0.473269).  Saving model ...
Epoch: 8 cost time: 1.158914566040039
Epoch: 8, Steps: 8 | Train Loss: 0.471 Vali Loss: 1.316 Vali Acc: 0.504 Test Loss: 1.316 Test Acc: 0.504
Validation loss decreased (-0.473269 --> -0.503804).  Saving model ...
Epoch: 9 cost time: 1.0187032222747803
Epoch: 9, Steps: 8 | Train Loss: 0.362 Vali Loss: 1.335 Vali Acc: 0.504 Test Loss: 1.335 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.228849172592163
Epoch: 10, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.382 Vali Acc: 0.504 Test Loss: 1.382 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.223456621170044
Epoch: 11, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.327 Vali Acc: 0.519 Test Loss: 1.327 Test Acc: 0.519
Validation loss decreased (-0.503804 --> -0.519071).  Saving model ...
Epoch: 12 cost time: 1.1309914588928223
Epoch: 12, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.394 Vali Acc: 0.519 Test Loss: 1.394 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1203951835632324
Epoch: 13, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4214553833007812
Epoch: 14, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.449 Vali Acc: 0.519 Test Loss: 1.449 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.402275562286377
Epoch: 15, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.482 Vali Acc: 0.519 Test Loss: 1.482 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2638444900512695
Epoch: 16, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.137908935546875
Epoch: 17, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.471 Vali Acc: 0.519 Test Loss: 1.471 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0601155757904053
Epoch: 18, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.559 Vali Acc: 0.519 Test Loss: 1.559 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1659998893737793
Epoch: 19, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.533 Vali Acc: 0.519 Test Loss: 1.533 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.271108627319336
Epoch: 20, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.554 Vali Acc: 0.519 Test Loss: 1.554 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.357234239578247
Epoch: 21, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.612 Vali Acc: 0.519 Test Loss: 1.612 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 100965
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.361090660095215
Epoch: 1, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.617 Vali Acc: 0.321 Test Loss: 1.617 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 1.4509358406066895
Epoch: 2, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.601 Vali Acc: 0.412 Test Loss: 1.601 Test Acc: 0.412
Validation loss decreased (-0.320595 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.3078806400299072
Epoch: 3, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.592 Vali Acc: 0.420 Test Loss: 1.592 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.570979356765747
Epoch: 4, Steps: 8 | Train Loss: 1.237 Vali Loss: 1.587 Vali Acc: 0.435 Test Loss: 1.587 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.290743112564087
Epoch: 5, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.591 Vali Acc: 0.443 Test Loss: 1.591 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442732).  Saving model ...
Epoch: 6 cost time: 1.5192711353302002
Epoch: 6, Steps: 8 | Train Loss: 0.937 Vali Loss: 1.547 Vali Acc: 0.450 Test Loss: 1.547 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450366).  Saving model ...
Epoch: 7 cost time: 1.4809744358062744
Epoch: 7, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.518 Vali Acc: 0.450 Test Loss: 1.518 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.3347327709197998
Epoch: 8, Steps: 8 | Train Loss: 0.662 Vali Loss: 1.478 Vali Acc: 0.466 Test Loss: 1.478 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.386518955230713
Epoch: 9, Steps: 8 | Train Loss: 0.558 Vali Loss: 1.447 Vali Acc: 0.504 Test Loss: 1.447 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.5750408172607422
Epoch: 10, Steps: 8 | Train Loss: 0.476 Vali Loss: 1.469 Vali Acc: 0.496 Test Loss: 1.469 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.581944227218628
Epoch: 11, Steps: 8 | Train Loss: 0.386 Vali Loss: 1.512 Vali Acc: 0.481 Test Loss: 1.512 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.432368278503418
Epoch: 12, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4684057235717773
Epoch: 13, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.525 Vali Acc: 0.519 Test Loss: 1.525 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 14 cost time: 1.6001029014587402
Epoch: 14, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.552 Vali Acc: 0.511 Test Loss: 1.552 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.510378122329712
Epoch: 15, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.567 Vali Acc: 0.519 Test Loss: 1.567 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2304315567016602
Epoch: 16, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.516 Vali Acc: 0.519 Test Loss: 1.516 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 17 cost time: 1.2062342166900635
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.648 Vali Acc: 0.511 Test Loss: 1.648 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.478989601135254
Epoch: 18, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.602 Vali Acc: 0.511 Test Loss: 1.602 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5349445343017578
Epoch: 19, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.504 Vali Acc: 0.519 Test Loss: 1.504 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 20 cost time: 1.4181156158447266
Epoch: 20, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.552 Vali Acc: 0.519 Test Loss: 1.552 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3139159679412842
Epoch: 21, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.744 Vali Acc: 0.519 Test Loss: 1.744 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2978529930114746
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.557 Vali Acc: 0.527 Test Loss: 1.557 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 23 cost time: 1.3130509853363037
Epoch: 23, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.531 Vali Acc: 0.519 Test Loss: 1.531 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6485772132873535
Epoch: 24, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.644 Vali Acc: 0.519 Test Loss: 1.644 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3028209209442139
Epoch: 25, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.610 Vali Acc: 0.519 Test Loss: 1.610 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4500796794891357
Epoch: 26, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.644 Vali Acc: 0.519 Test Loss: 1.644 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3564305305480957
Epoch: 27, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.536 Vali Acc: 0.519 Test Loss: 1.536 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4284987449645996
Epoch: 28, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.518 Vali Acc: 0.527 Test Loss: 1.518 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526702).  Saving model ...
Epoch: 29 cost time: 1.4015436172485352
Epoch: 29, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5727369785308838
Epoch: 30, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.805 Vali Acc: 0.519 Test Loss: 1.805 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3916189670562744
Epoch: 31, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.589 Vali Acc: 0.527 Test Loss: 1.589 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3023731708526611
Epoch: 32, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.513 Vali Acc: 0.527 Test Loss: 1.513 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526702).  Saving model ...
Epoch: 33 cost time: 1.5600414276123047
Epoch: 33, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.546 Vali Acc: 0.527 Test Loss: 1.546 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3359129428863525
Epoch: 34, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.639 Vali Acc: 0.519 Test Loss: 1.639 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.606903076171875
Epoch: 35, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.705 Vali Acc: 0.519 Test Loss: 1.705 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.407818078994751
Epoch: 36, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.734 Vali Acc: 0.527 Test Loss: 1.734 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.347485065460205
Epoch: 37, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.631 Vali Acc: 0.527 Test Loss: 1.631 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4908804893493652
Epoch: 38, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.731 Vali Acc: 0.519 Test Loss: 1.731 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6470842361450195
Epoch: 39, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.810 Vali Acc: 0.519 Test Loss: 1.810 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2501661777496338
Epoch: 40, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.651 Vali Acc: 0.519 Test Loss: 1.651 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3779072761535645
Epoch: 41, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.746 Vali Acc: 0.519 Test Loss: 1.746 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.36857271194458
Epoch: 42, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.665 Vali Acc: 0.519 Test Loss: 1.665 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 102853
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4760661125183105
Epoch: 1, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.661 Vali Acc: 0.198 Test Loss: 1.661 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 0.9832417964935303
Epoch: 2, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.633 Vali Acc: 0.244 Test Loss: 1.633 Test Acc: 0.244
Validation loss decreased (-0.198457 --> -0.244258).  Saving model ...
Epoch: 3 cost time: 1.0077052116394043
Epoch: 3, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.602 Vali Acc: 0.351 Test Loss: 1.602 Test Acc: 0.351
Validation loss decreased (-0.244258 --> -0.351129).  Saving model ...
Epoch: 4 cost time: 1.0770599842071533
Epoch: 4, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.573 Vali Acc: 0.397 Test Loss: 1.573 Test Acc: 0.397
Validation loss decreased (-0.351129 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 1.4726965427398682
Epoch: 5, Steps: 8 | Train Loss: 1.094 Vali Loss: 1.533 Vali Acc: 0.435 Test Loss: 1.533 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.3448641300201416
Epoch: 6, Steps: 8 | Train Loss: 0.941 Vali Loss: 1.482 Vali Acc: 0.427 Test Loss: 1.482 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2015607357025146
Epoch: 7, Steps: 8 | Train Loss: 0.813 Vali Loss: 1.447 Vali Acc: 0.458 Test Loss: 1.447 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 1.5775525569915771
Epoch: 8, Steps: 8 | Train Loss: 0.691 Vali Loss: 1.419 Vali Acc: 0.450 Test Loss: 1.419 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2278742790222168
Epoch: 9, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.395 Vali Acc: 0.511 Test Loss: 1.395 Test Acc: 0.511
Validation loss decreased (-0.458001 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.1827929019927979
Epoch: 10, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.336 Vali Acc: 0.527 Test Loss: 1.336 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.4460361003875732
Epoch: 11, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.338 Vali Acc: 0.527 Test Loss: 1.338 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1658082008361816
Epoch: 12, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.364 Vali Acc: 0.519 Test Loss: 1.364 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.259824514389038
Epoch: 13, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.328 Vali Acc: 0.519 Test Loss: 1.328 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3529295921325684
Epoch: 14, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.320 Vali Acc: 0.511 Test Loss: 1.320 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2049450874328613
Epoch: 15, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.287 Vali Acc: 0.527 Test Loss: 1.287 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526705).  Saving model ...
Epoch: 16 cost time: 1.070786714553833
Epoch: 16, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.332 Vali Acc: 0.519 Test Loss: 1.332 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4102449417114258
Epoch: 17, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.351 Vali Acc: 0.527 Test Loss: 1.351 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5576388835906982
Epoch: 18, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.300 Vali Acc: 0.519 Test Loss: 1.300 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.46238374710083
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.404 Vali Acc: 0.534 Test Loss: 1.404 Test Acc: 0.534
Validation loss decreased (-0.526705 --> -0.534337).  Saving model ...
Epoch: 20 cost time: 1.499131441116333
Epoch: 20, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.236 Vali Acc: 0.511 Test Loss: 1.236 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.290065050125122
Epoch: 21, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.280 Vali Acc: 0.511 Test Loss: 1.280 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3947994709014893
Epoch: 22, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.412 Vali Acc: 0.519 Test Loss: 1.412 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5012180805206299
Epoch: 23, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.394 Vali Acc: 0.519 Test Loss: 1.394 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5605196952819824
Epoch: 24, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.404 Vali Acc: 0.519 Test Loss: 1.404 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1906778812408447
Epoch: 25, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3512251377105713
Epoch: 26, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.325 Vali Acc: 0.519 Test Loss: 1.325 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7452421188354492
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.423 Vali Acc: 0.504 Test Loss: 1.423 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2622864246368408
Epoch: 28, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.252 Vali Acc: 0.519 Test Loss: 1.252 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3829574584960938
Epoch: 29, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.372 Vali Acc: 0.527 Test Loss: 1.372 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 110533
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9709830284118652
Epoch: 1, Steps: 8 | Train Loss: 1.585 Vali Loss: 1.638 Vali Acc: 0.214 Test Loss: 1.638 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.3677337169647217
Epoch: 2, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.634 Vali Acc: 0.260 Test Loss: 1.634 Test Acc: 0.260
Validation loss decreased (-0.213724 --> -0.259526).  Saving model ...
Epoch: 3 cost time: 1.246772289276123
Epoch: 3, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.616 Vali Acc: 0.389 Test Loss: 1.616 Test Acc: 0.389
Validation loss decreased (-0.259526 --> -0.389297).  Saving model ...
Epoch: 4 cost time: 1.1431243419647217
Epoch: 4, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.595 Vali Acc: 0.435 Test Loss: 1.595 Test Acc: 0.435
Validation loss decreased (-0.389297 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.153294563293457
Epoch: 5, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.584 Vali Acc: 0.435 Test Loss: 1.584 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.26180100440979
Epoch: 6, Steps: 8 | Train Loss: 0.927 Vali Loss: 1.541 Vali Acc: 0.511 Test Loss: 1.541 Test Acc: 0.511
Validation loss decreased (-0.435099 --> -0.511435).  Saving model ...
Epoch: 7 cost time: 1.164766550064087
Epoch: 7, Steps: 8 | Train Loss: 0.821 Vali Loss: 1.508 Vali Acc: 0.496 Test Loss: 1.508 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3899998664855957
Epoch: 8, Steps: 8 | Train Loss: 0.747 Vali Loss: 1.463 Vali Acc: 0.511 Test Loss: 1.463 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.3126909732818604
Epoch: 9, Steps: 8 | Train Loss: 0.668 Vali Loss: 1.460 Vali Acc: 0.542 Test Loss: 1.460 Test Acc: 0.542
Validation loss decreased (-0.511436 --> -0.541970).  Saving model ...
Epoch: 10 cost time: 1.092897891998291
Epoch: 10, Steps: 8 | Train Loss: 0.543 Vali Loss: 1.420 Vali Acc: 0.542 Test Loss: 1.420 Test Acc: 0.542
Validation loss decreased (-0.541970 --> -0.541971).  Saving model ...
Epoch: 11 cost time: 1.3709981441497803
Epoch: 11, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.387 Vali Acc: 0.557 Test Loss: 1.387 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557238).  Saving model ...
Epoch: 12 cost time: 1.3147151470184326
Epoch: 12, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.385 Vali Acc: 0.534 Test Loss: 1.385 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2819316387176514
Epoch: 13, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.404 Vali Acc: 0.534 Test Loss: 1.404 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.158311128616333
Epoch: 14, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.398 Vali Acc: 0.527 Test Loss: 1.398 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2555170059204102
Epoch: 15, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.347 Vali Acc: 0.527 Test Loss: 1.347 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2355258464813232
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.362 Vali Acc: 0.534 Test Loss: 1.362 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2918288707733154
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.353 Vali Acc: 0.527 Test Loss: 1.353 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3501865863800049
Epoch: 18, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.409 Vali Acc: 0.542 Test Loss: 1.409 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2468175888061523
Epoch: 19, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.336 Vali Acc: 0.542 Test Loss: 1.336 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.193690299987793
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.366 Vali Acc: 0.534 Test Loss: 1.366 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1884775161743164
Epoch: 21, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.330 Vali Acc: 0.542 Test Loss: 1.330 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 133541
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7074508666992188
Epoch: 1, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.638 Vali Acc: 0.344 Test Loss: 1.638 Test Acc: 0.344
Validation loss decreased (inf --> -0.343495).  Saving model ...
Epoch: 2 cost time: 0.8086447715759277
Epoch: 2, Steps: 8 | Train Loss: 1.492 Vali Loss: 1.646 Vali Acc: 0.351 Test Loss: 1.646 Test Acc: 0.351
Validation loss decreased (-0.343495 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.0450148582458496
Epoch: 3, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.621 Vali Acc: 0.359 Test Loss: 1.621 Test Acc: 0.359
Validation loss decreased (-0.351129 --> -0.358762).  Saving model ...
Epoch: 4 cost time: 0.9874916076660156
Epoch: 4, Steps: 8 | Train Loss: 1.220 Vali Loss: 1.579 Vali Acc: 0.427 Test Loss: 1.579 Test Acc: 0.427
Validation loss decreased (-0.358762 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.0007872581481934
Epoch: 5, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.530 Vali Acc: 0.481 Test Loss: 1.530 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 0.9691410064697266
Epoch: 6, Steps: 8 | Train Loss: 0.899 Vali Loss: 1.500 Vali Acc: 0.466 Test Loss: 1.500 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.119091272354126
Epoch: 7, Steps: 8 | Train Loss: 0.787 Vali Loss: 1.459 Vali Acc: 0.473 Test Loss: 1.459 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.919654369354248
Epoch: 8, Steps: 8 | Train Loss: 0.671 Vali Loss: 1.471 Vali Acc: 0.466 Test Loss: 1.471 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0146090984344482
Epoch: 9, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.495 Vali Acc: 0.504 Test Loss: 1.495 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.0733802318572998
Epoch: 10, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.421 Vali Acc: 0.542 Test Loss: 1.421 Test Acc: 0.542
Validation loss decreased (-0.503802 --> -0.541971).  Saving model ...
Epoch: 11 cost time: 0.89457106590271
Epoch: 11, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.405 Vali Acc: 0.565 Test Loss: 1.405 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564871).  Saving model ...
Epoch: 12 cost time: 1.0983350276947021
Epoch: 12, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.389 Vali Acc: 0.519 Test Loss: 1.389 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1636159420013428
Epoch: 13, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.379 Vali Acc: 0.511 Test Loss: 1.379 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.30230712890625
Epoch: 14, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.386 Vali Acc: 0.511 Test Loss: 1.386 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.386310338973999
Epoch: 15, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2548272609710693
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.381 Vali Acc: 0.519 Test Loss: 1.381 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1499907970428467
Epoch: 17, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.419 Vali Acc: 0.534 Test Loss: 1.419 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1878938674926758
Epoch: 18, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.388 Vali Acc: 0.519 Test Loss: 1.388 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1518175601959229
Epoch: 19, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0886061191558838
Epoch: 20, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.372 Vali Acc: 0.519 Test Loss: 1.372 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.089045524597168
Epoch: 21, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.390 Vali Acc: 0.519 Test Loss: 1.390 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 158469
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.121094465255737
Epoch: 1, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.587 Vali Acc: 0.237 Test Loss: 1.587 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.780576229095459
Epoch: 2, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.581 Vali Acc: 0.252 Test Loss: 1.581 Test Acc: 0.252
Validation loss decreased (-0.236625 --> -0.251893).  Saving model ...
Epoch: 3 cost time: 1.51849365234375
Epoch: 3, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.572 Vali Acc: 0.374 Test Loss: 1.572 Test Acc: 0.374
Validation loss decreased (-0.251893 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 1.6499078273773193
Epoch: 4, Steps: 8 | Train Loss: 1.237 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.6918597221374512
Epoch: 5, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.545 Vali Acc: 0.427 Test Loss: 1.545 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 1.97068452835083
Epoch: 6, Steps: 8 | Train Loss: 0.957 Vali Loss: 1.545 Vali Acc: 0.473 Test Loss: 1.545 Test Acc: 0.473
Validation loss decreased (-0.427465 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 2.0644984245300293
Epoch: 7, Steps: 8 | Train Loss: 0.839 Vali Loss: 1.516 Vali Acc: 0.496 Test Loss: 1.516 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 1.3022949695587158
Epoch: 8, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.513 Vali Acc: 0.496 Test Loss: 1.513 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496168).  Saving model ...
Epoch: 9 cost time: 1.6605241298675537
Epoch: 9, Steps: 8 | Train Loss: 0.652 Vali Loss: 1.508 Vali Acc: 0.496 Test Loss: 1.508 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496168).  Saving model ...
Epoch: 10 cost time: 1.5695507526397705
Epoch: 10, Steps: 8 | Train Loss: 0.550 Vali Loss: 1.498 Vali Acc: 0.504 Test Loss: 1.498 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.6770014762878418
Epoch: 11, Steps: 8 | Train Loss: 0.545 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 12 cost time: 2.1845693588256836
Epoch: 12, Steps: 8 | Train Loss: 0.494 Vali Loss: 1.460 Vali Acc: 0.534 Test Loss: 1.460 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.4108829498291016
Epoch: 13, Steps: 8 | Train Loss: 0.430 Vali Loss: 1.461 Vali Acc: 0.519 Test Loss: 1.461 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9943866729736328
Epoch: 14, Steps: 8 | Train Loss: 0.433 Vali Loss: 1.466 Vali Acc: 0.519 Test Loss: 1.466 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6228172779083252
Epoch: 15, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.450 Vali Acc: 0.504 Test Loss: 1.450 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4792442321777344
Epoch: 16, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.451 Vali Acc: 0.504 Test Loss: 1.451 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5724456310272217
Epoch: 17, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6181902885437012
Epoch: 18, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.419 Vali Acc: 0.527 Test Loss: 1.419 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.305570125579834
Epoch: 19, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.417 Vali Acc: 0.519 Test Loss: 1.417 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7758758068084717
Epoch: 20, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.430 Vali Acc: 0.527 Test Loss: 1.430 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.966912031173706
Epoch: 21, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5748987197875977
Epoch: 22, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.460 Vali Acc: 0.519 Test Loss: 1.460 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 186277
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.876552104949951
Epoch: 1, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.0511765480041504
Epoch: 2, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.9087789058685303
Epoch: 3, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.593 Vali Acc: 0.420 Test Loss: 1.593 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0719056129455566
Epoch: 4, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.525 Vali Acc: 0.427 Test Loss: 1.525 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 2.1926345825195312
Epoch: 5, Steps: 8 | Train Loss: 1.015 Vali Loss: 1.494 Vali Acc: 0.443 Test Loss: 1.494 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.8140850067138672
Epoch: 6, Steps: 8 | Train Loss: 0.839 Vali Loss: 1.509 Vali Acc: 0.443 Test Loss: 1.509 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7259635925292969
Epoch: 7, Steps: 8 | Train Loss: 0.678 Vali Loss: 1.457 Vali Acc: 0.489 Test Loss: 1.457 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.5880320072174072
Epoch: 8, Steps: 8 | Train Loss: 0.516 Vali Loss: 1.452 Vali Acc: 0.504 Test Loss: 1.452 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 9 cost time: 1.6191296577453613
Epoch: 9, Steps: 8 | Train Loss: 0.398 Vali Loss: 1.473 Vali Acc: 0.504 Test Loss: 1.473 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7055952548980713
Epoch: 10, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.496 Vali Acc: 0.504 Test Loss: 1.496 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8234412670135498
Epoch: 11, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.377 Vali Acc: 0.534 Test Loss: 1.377 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534337).  Saving model ...
Epoch: 12 cost time: 1.7128236293792725
Epoch: 12, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.588 Vali Acc: 0.519 Test Loss: 1.588 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6303174495697021
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.533 Vali Acc: 0.519 Test Loss: 1.533 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8546435832977295
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.539 Vali Acc: 0.527 Test Loss: 1.539 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1685776710510254
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.521 Vali Acc: 0.527 Test Loss: 1.521 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.464700698852539
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.587 Vali Acc: 0.527 Test Loss: 1.587 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.48661470413208
Epoch: 17, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.583 Vali Acc: 0.527 Test Loss: 1.583 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.650463581085205
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.585 Vali Acc: 0.542 Test Loss: 1.585 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541969).  Saving model ...
Epoch: 19 cost time: 1.4400389194488525
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.670 Vali Acc: 0.534 Test Loss: 1.670 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6028046607971191
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.589 Vali Acc: 0.527 Test Loss: 1.589 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5078380107879639
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.610 Vali Acc: 0.527 Test Loss: 1.610 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7292628288269043
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.867 Vali Acc: 0.519 Test Loss: 1.867 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9363269805908203
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.900 Vali Acc: 0.519 Test Loss: 1.900 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7025840282440186
Epoch: 24, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.713 Vali Acc: 0.534 Test Loss: 1.713 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7821955680847168
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.701 Vali Acc: 0.534 Test Loss: 1.701 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7877202033996582
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.772 Vali Acc: 0.534 Test Loss: 1.772 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.259774923324585
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.933 Vali Acc: 0.527 Test Loss: 1.933 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.841465950012207
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.084 Vali Acc: 0.527 Test Loss: 2.084 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 421733
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.389782667160034
Epoch: 1, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.568 Vali Acc: 0.420 Test Loss: 1.568 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6506390571594238
Epoch: 2, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5645062923431396
Epoch: 3, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.317479133605957
Epoch: 4, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7740778923034668
Epoch: 5, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.3837237358093262
Epoch: 6, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.515 Vali Acc: 0.427 Test Loss: 1.515 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.4337289333343506
Epoch: 7, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.483 Vali Acc: 0.458 Test Loss: 1.483 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 1.4180717468261719
Epoch: 8, Steps: 8 | Train Loss: 0.856 Vali Loss: 1.427 Vali Acc: 0.466 Test Loss: 1.427 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465635).  Saving model ...
Epoch: 9 cost time: 1.6765563488006592
Epoch: 9, Steps: 8 | Train Loss: 0.727 Vali Loss: 1.380 Vali Acc: 0.489 Test Loss: 1.380 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488536).  Saving model ...
Epoch: 10 cost time: 1.621335744857788
Epoch: 10, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.4964940547943115
Epoch: 11, Steps: 8 | Train Loss: 0.543 Vali Loss: 1.480 Vali Acc: 0.489 Test Loss: 1.480 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.059068202972412
Epoch: 12, Steps: 8 | Train Loss: 0.402 Vali Loss: 1.392 Vali Acc: 0.511 Test Loss: 1.392 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 1.5605881214141846
Epoch: 13, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.386 Vali Acc: 0.519 Test Loss: 1.386 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.4287731647491455
Epoch: 14, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.396 Vali Acc: 0.527 Test Loss: 1.396 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 15 cost time: 1.6318469047546387
Epoch: 15, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 16 cost time: 1.6314704418182373
Epoch: 16, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.461 Vali Acc: 0.527 Test Loss: 1.461 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.416252613067627
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5731279850006104
Epoch: 18, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.493 Vali Acc: 0.527 Test Loss: 1.493 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6137311458587646
Epoch: 19, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.494 Vali Acc: 0.527 Test Loss: 1.494 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2267799377441406
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.407 Vali Acc: 0.534 Test Loss: 1.407 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 21 cost time: 1.531742811203003
Epoch: 21, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.462 Vali Acc: 0.534 Test Loss: 1.462 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2353122234344482
Epoch: 22, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.498 Vali Acc: 0.534 Test Loss: 1.498 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2129273414611816
Epoch: 23, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6953251361846924
Epoch: 24, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.566 Vali Acc: 0.527 Test Loss: 1.566 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4558494091033936
Epoch: 25, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.469 Vali Acc: 0.550 Test Loss: 1.469 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 26 cost time: 1.3005752563476562
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.526 Vali Acc: 0.527 Test Loss: 1.526 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5002310276031494
Epoch: 27, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.639 Vali Acc: 0.527 Test Loss: 1.639 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7770686149597168
Epoch: 28, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.667 Vali Acc: 0.534 Test Loss: 1.667 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8927433490753174
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.675 Vali Acc: 0.534 Test Loss: 1.675 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.520864486694336
Epoch: 30, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.706 Vali Acc: 0.527 Test Loss: 1.706 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4344708919525146
Epoch: 31, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.704 Vali Acc: 0.527 Test Loss: 1.704 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6237332820892334
Epoch: 32, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.694 Vali Acc: 0.565 Test Loss: 1.694 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564869).  Saving model ...
Epoch: 33 cost time: 1.4917752742767334
Epoch: 33, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.688 Vali Acc: 0.534 Test Loss: 1.688 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4277331829071045
Epoch: 34, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.772 Vali Acc: 0.527 Test Loss: 1.772 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7072641849517822
Epoch: 35, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.718 Vali Acc: 0.527 Test Loss: 1.718 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4529492855072021
Epoch: 36, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.692 Vali Acc: 0.527 Test Loss: 1.692 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7038521766662598
Epoch: 37, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.592 Vali Acc: 0.527 Test Loss: 1.592 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3494617938995361
Epoch: 38, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.575 Vali Acc: 0.527 Test Loss: 1.575 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5281689167022705
Epoch: 39, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.620 Vali Acc: 0.527 Test Loss: 1.620 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.5993952751159668
Epoch: 40, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.608 Vali Acc: 0.534 Test Loss: 1.608 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6716394424438477
Epoch: 41, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.691 Vali Acc: 0.534 Test Loss: 1.691 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.7270853519439697
Epoch: 42, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.757 Vali Acc: 0.527 Test Loss: 1.757 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 397733
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.222031831741333
Epoch: 1, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.584 Vali Acc: 0.374 Test Loss: 1.584 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 0.9983763694763184
Epoch: 2, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.7646892070770264
Epoch: 3, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1364340782165527
Epoch: 4, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9590685367584229
Epoch: 5, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.587 Vali Acc: 0.420 Test Loss: 1.587 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8009953498840332
Epoch: 6, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 0.8199141025543213
Epoch: 7, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.1740658283233643
Epoch: 8, Steps: 8 | Train Loss: 0.921 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 0.8386659622192383
Epoch: 9, Steps: 8 | Train Loss: 0.806 Vali Loss: 1.511 Vali Acc: 0.443 Test Loss: 1.511 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 1.1682446002960205
Epoch: 10, Steps: 8 | Train Loss: 0.720 Vali Loss: 1.507 Vali Acc: 0.450 Test Loss: 1.507 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 0.9458882808685303
Epoch: 11, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.466 Vali Acc: 0.489 Test Loss: 1.466 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 0.8604905605316162
Epoch: 12, Steps: 8 | Train Loss: 0.563 Vali Loss: 1.499 Vali Acc: 0.466 Test Loss: 1.499 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7458157539367676
Epoch: 13, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.487 Vali Acc: 0.481 Test Loss: 1.487 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7261648178100586
Epoch: 14, Steps: 8 | Train Loss: 0.385 Vali Loss: 1.464 Vali Acc: 0.496 Test Loss: 1.464 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 15 cost time: 0.8317813873291016
Epoch: 15, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.469 Vali Acc: 0.496 Test Loss: 1.469 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9194262027740479
Epoch: 16, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.468 Vali Acc: 0.504 Test Loss: 1.468 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 17 cost time: 0.9699797630310059
Epoch: 17, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519070).  Saving model ...
Epoch: 18 cost time: 0.7821822166442871
Epoch: 18, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.505 Vali Acc: 0.504 Test Loss: 1.505 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8489093780517578
Epoch: 19, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.444 Vali Acc: 0.519 Test Loss: 1.444 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8001916408538818
Epoch: 20, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.461 Vali Acc: 0.519 Test Loss: 1.461 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0675418376922607
Epoch: 21, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.416 Vali Acc: 0.511 Test Loss: 1.416 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9328594207763672
Epoch: 22, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.491 Vali Acc: 0.519 Test Loss: 1.491 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6805353164672852
Epoch: 23, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.532 Vali Acc: 0.519 Test Loss: 1.532 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8753447532653809
Epoch: 24, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9805805683135986
Epoch: 25, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.547 Vali Acc: 0.519 Test Loss: 1.547 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.720383882522583
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.445 Vali Acc: 0.511 Test Loss: 1.445 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6469264030456543
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.492 Vali Acc: 0.511 Test Loss: 1.492 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 400581
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.1416373252868652
Epoch: 1, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.606 Vali Acc: 0.374 Test Loss: 1.606 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 0.7045185565948486
Epoch: 2, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.6572775840759277
Epoch: 3, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 0.9567930698394775
Epoch: 4, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9321746826171875
Epoch: 5, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9549710750579834
Epoch: 6, Steps: 8 | Train Loss: 1.146 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8653855323791504
Epoch: 7, Steps: 8 | Train Loss: 1.064 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 0.9015634059906006
Epoch: 8, Steps: 8 | Train Loss: 0.975 Vali Loss: 1.490 Vali Acc: 0.427 Test Loss: 1.490 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 0.8465263843536377
Epoch: 9, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.488 Vali Acc: 0.435 Test Loss: 1.488 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 10 cost time: 1.0118350982666016
Epoch: 10, Steps: 8 | Train Loss: 0.784 Vali Loss: 1.470 Vali Acc: 0.473 Test Loss: 1.470 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 0.8419032096862793
Epoch: 11, Steps: 8 | Train Loss: 0.698 Vali Loss: 1.436 Vali Acc: 0.481 Test Loss: 1.436 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 0.8476102352142334
Epoch: 12, Steps: 8 | Train Loss: 0.589 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 13 cost time: 0.9447002410888672
Epoch: 13, Steps: 8 | Train Loss: 0.499 Vali Loss: 1.417 Vali Acc: 0.511 Test Loss: 1.417 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 0.9671473503112793
Epoch: 14, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.382 Vali Acc: 0.519 Test Loss: 1.382 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.274695873260498
Epoch: 15, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.389 Vali Acc: 0.534 Test Loss: 1.389 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 16 cost time: 1.0361895561218262
Epoch: 16, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.413 Vali Acc: 0.550 Test Loss: 1.413 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 17 cost time: 1.2479286193847656
Epoch: 17, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.367 Vali Acc: 0.542 Test Loss: 1.367 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8379611968994141
Epoch: 18, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.319 Vali Acc: 0.550 Test Loss: 1.319 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549605).  Saving model ...
Epoch: 19 cost time: 0.920025110244751
Epoch: 19, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.323 Vali Acc: 0.565 Test Loss: 1.323 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564872).  Saving model ...
Epoch: 20 cost time: 0.9646797180175781
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.198 Vali Acc: 0.611 Test Loss: 1.198 Test Acc: 0.611
Validation loss decreased (-0.564872 --> -0.610675).  Saving model ...
Epoch: 21 cost time: 1.065758228302002
Epoch: 21, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.296 Vali Acc: 0.565 Test Loss: 1.296 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4527990818023682
Epoch: 22, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.311 Vali Acc: 0.565 Test Loss: 1.311 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2116491794586182
Epoch: 23, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.382 Vali Acc: 0.550 Test Loss: 1.382 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4991774559020996
Epoch: 24, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.373 Vali Acc: 0.550 Test Loss: 1.373 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3865125179290771
Epoch: 25, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.389 Vali Acc: 0.557 Test Loss: 1.389 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1245079040527344
Epoch: 26, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.278 Vali Acc: 0.603 Test Loss: 1.278 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1820135116577148
Epoch: 27, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.283 Vali Acc: 0.595 Test Loss: 1.283 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.72601318359375
Epoch: 28, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.369 Vali Acc: 0.565 Test Loss: 1.369 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.321847677230835
Epoch: 29, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.299 Vali Acc: 0.565 Test Loss: 1.299 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3862059116363525
Epoch: 30, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.255 Vali Acc: 0.565 Test Loss: 1.255 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 407301
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.148810863494873
Epoch: 1, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.604 Vali Acc: 0.260 Test Loss: 1.604 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.1187388896942139
Epoch: 2, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.567 Vali Acc: 0.420 Test Loss: 1.567 Test Acc: 0.420
Validation loss decreased (-0.259526 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.308112621307373
Epoch: 3, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.1188580989837646
Epoch: 4, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.0370965003967285
Epoch: 5, Steps: 8 | Train Loss: 1.234 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0775275230407715
Epoch: 6, Steps: 8 | Train Loss: 1.164 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.005807638168335
Epoch: 7, Steps: 8 | Train Loss: 1.077 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1523096561431885
Epoch: 8, Steps: 8 | Train Loss: 1.012 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1659317016601562
Epoch: 9, Steps: 8 | Train Loss: 0.901 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.000952959060669
Epoch: 10, Steps: 8 | Train Loss: 0.853 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.34086012840271
Epoch: 11, Steps: 8 | Train Loss: 0.746 Vali Loss: 1.523 Vali Acc: 0.427 Test Loss: 1.523 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 12 cost time: 1.113219976425171
Epoch: 12, Steps: 8 | Train Loss: 0.680 Vali Loss: 1.546 Vali Acc: 0.427 Test Loss: 1.546 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1521778106689453
Epoch: 13, Steps: 8 | Train Loss: 0.615 Vali Loss: 1.547 Vali Acc: 0.427 Test Loss: 1.547 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3153045177459717
Epoch: 14, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.541 Vali Acc: 0.435 Test Loss: 1.541 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 15 cost time: 1.1485979557037354
Epoch: 15, Steps: 8 | Train Loss: 0.445 Vali Loss: 1.528 Vali Acc: 0.450 Test Loss: 1.528 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450366).  Saving model ...
Epoch: 16 cost time: 1.3388221263885498
Epoch: 16, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.565 Vali Acc: 0.450 Test Loss: 1.565 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3055081367492676
Epoch: 17, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.509 Vali Acc: 0.458 Test Loss: 1.509 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 18 cost time: 1.1532998085021973
Epoch: 18, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.514 Vali Acc: 0.458 Test Loss: 1.514 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.11552095413208
Epoch: 19, Steps: 8 | Train Loss: 0.245 Vali Loss: 1.492 Vali Acc: 0.481 Test Loss: 1.492 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 20 cost time: 1.0726923942565918
Epoch: 20, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.511 Vali Acc: 0.489 Test Loss: 1.511 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 21 cost time: 1.0102531909942627
Epoch: 21, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.628 Vali Acc: 0.443 Test Loss: 1.628 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2168920040130615
Epoch: 22, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.579 Vali Acc: 0.466 Test Loss: 1.579 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9879412651062012
Epoch: 23, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.577 Vali Acc: 0.466 Test Loss: 1.577 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0125718116760254
Epoch: 24, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.648 Vali Acc: 0.458 Test Loss: 1.648 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0708255767822266
Epoch: 25, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.646 Vali Acc: 0.458 Test Loss: 1.646 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7994441986083984
Epoch: 26, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.642 Vali Acc: 0.458 Test Loss: 1.642 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8726599216461182
Epoch: 27, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.610 Vali Acc: 0.466 Test Loss: 1.610 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8900632858276367
Epoch: 28, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.612 Vali Acc: 0.473 Test Loss: 1.612 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7436842918395996
Epoch: 29, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.590 Vali Acc: 0.473 Test Loss: 1.590 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0591740608215332
Epoch: 30, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.575 Vali Acc: 0.489 Test Loss: 1.575 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 432229
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2728476524353027
Epoch: 1, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.604 Vali Acc: 0.260 Test Loss: 1.604 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 0.880079984664917
Epoch: 2, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.584 Vali Acc: 0.405 Test Loss: 1.584 Test Acc: 0.405
Validation loss decreased (-0.259526 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 0.8260214328765869
Epoch: 3, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.551 Vali Acc: 0.412 Test Loss: 1.551 Test Acc: 0.412
Validation loss decreased (-0.404564 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.2635877132415771
Epoch: 4, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.527 Vali Acc: 0.412 Test Loss: 1.527 Test Acc: 0.412
Validation loss decreased (-0.412198 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 1.2667067050933838
Epoch: 5, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.528 Vali Acc: 0.427 Test Loss: 1.528 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.0437090396881104
Epoch: 6, Steps: 8 | Train Loss: 1.067 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0047252178192139
Epoch: 7, Steps: 8 | Train Loss: 0.951 Vali Loss: 1.543 Vali Acc: 0.427 Test Loss: 1.543 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0117521286010742
Epoch: 8, Steps: 8 | Train Loss: 0.865 Vali Loss: 1.493 Vali Acc: 0.450 Test Loss: 1.493 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 1.248502254486084
Epoch: 9, Steps: 8 | Train Loss: 0.768 Vali Loss: 1.501 Vali Acc: 0.481 Test Loss: 1.501 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.3744616508483887
Epoch: 10, Steps: 8 | Train Loss: 0.691 Vali Loss: 1.475 Vali Acc: 0.489 Test Loss: 1.475 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 1.5449275970458984
Epoch: 11, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.513 Vali Acc: 0.496 Test Loss: 1.513 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 12 cost time: 1.365849256515503
Epoch: 12, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.460 Vali Acc: 0.527 Test Loss: 1.460 Test Acc: 0.527
Validation loss decreased (-0.496168 --> -0.526703).  Saving model ...
Epoch: 13 cost time: 1.2430977821350098
Epoch: 13, Steps: 8 | Train Loss: 0.435 Vali Loss: 1.500 Vali Acc: 0.519 Test Loss: 1.500 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4389994144439697
Epoch: 14, Steps: 8 | Train Loss: 0.362 Vali Loss: 1.503 Vali Acc: 0.511 Test Loss: 1.503 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5222458839416504
Epoch: 15, Steps: 8 | Train Loss: 0.308 Vali Loss: 1.486 Vali Acc: 0.519 Test Loss: 1.486 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2701339721679688
Epoch: 16, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.517 Vali Acc: 0.511 Test Loss: 1.517 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4616920948028564
Epoch: 17, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.508 Vali Acc: 0.511 Test Loss: 1.508 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3575499057769775
Epoch: 18, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.503 Vali Acc: 0.534 Test Loss: 1.503 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 19 cost time: 1.306443214416504
Epoch: 19, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.576 Vali Acc: 0.511 Test Loss: 1.576 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4763681888580322
Epoch: 20, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4518237113952637
Epoch: 21, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.657 Vali Acc: 0.534 Test Loss: 1.657 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6300761699676514
Epoch: 22, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.653 Vali Acc: 0.527 Test Loss: 1.653 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3134541511535645
Epoch: 23, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.656 Vali Acc: 0.519 Test Loss: 1.656 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6186270713806152
Epoch: 24, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.645 Vali Acc: 0.504 Test Loss: 1.645 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2787492275238037
Epoch: 25, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.606 Vali Acc: 0.519 Test Loss: 1.606 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3237404823303223
Epoch: 26, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.596 Vali Acc: 0.527 Test Loss: 1.596 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5573084354400635
Epoch: 27, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.596 Vali Acc: 0.527 Test Loss: 1.596 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0481021404266357
Epoch: 28, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.632 Vali Acc: 0.511 Test Loss: 1.632 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 457157
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3269081115722656
Epoch: 1, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.604 Vali Acc: 0.191 Test Loss: 1.604 Test Acc: 0.191
Validation loss decreased (inf --> -0.190824).  Saving model ...
Epoch: 2 cost time: 1.350553274154663
Epoch: 2, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.586 Vali Acc: 0.443 Test Loss: 1.586 Test Acc: 0.443
Validation loss decreased (-0.190824 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.1943449974060059
Epoch: 3, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1891705989837646
Epoch: 4, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.548 Vali Acc: 0.420 Test Loss: 1.548 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4872064590454102
Epoch: 5, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4565751552581787
Epoch: 6, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0753307342529297
Epoch: 7, Steps: 8 | Train Loss: 1.037 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1489436626434326
Epoch: 8, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8744103908538818
Epoch: 9, Steps: 8 | Train Loss: 0.904 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7834551334381104
Epoch: 10, Steps: 8 | Train Loss: 0.826 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9929907321929932
Epoch: 11, Steps: 8 | Train Loss: 0.737 Vali Loss: 1.509 Vali Acc: 0.420 Test Loss: 1.509 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.078064203262329
Epoch: 12, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 482085
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.669830083847046
Epoch: 1, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0961859226226807
Epoch: 2, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.3742730617523193
Epoch: 3, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.593 Vali Acc: 0.420 Test Loss: 1.593 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1717379093170166
Epoch: 4, Steps: 8 | Train Loss: 1.172 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.166351318359375
Epoch: 5, Steps: 8 | Train Loss: 1.007 Vali Loss: 1.491 Vali Acc: 0.435 Test Loss: 1.491 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.2982265949249268
Epoch: 6, Steps: 8 | Train Loss: 0.843 Vali Loss: 1.473 Vali Acc: 0.435 Test Loss: 1.473 Test Acc: 0.435
Validation loss decreased (-0.435100 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 1.458587408065796
Epoch: 7, Steps: 8 | Train Loss: 0.683 Vali Loss: 1.467 Vali Acc: 0.466 Test Loss: 1.467 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.2375900745391846
Epoch: 8, Steps: 8 | Train Loss: 0.525 Vali Loss: 1.427 Vali Acc: 0.504 Test Loss: 1.427 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 1.2598893642425537
Epoch: 9, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.456 Vali Acc: 0.504 Test Loss: 1.456 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1795058250427246
Epoch: 10, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.399 Vali Acc: 0.519 Test Loss: 1.399 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.14418363571167
Epoch: 11, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1705849170684814
Epoch: 12, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1620590686798096
Epoch: 13, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3160426616668701
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.523 Vali Acc: 0.527 Test Loss: 1.523 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526702).  Saving model ...
Epoch: 15 cost time: 1.2758314609527588
Epoch: 15, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.580 Vali Acc: 0.527 Test Loss: 1.580 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3127949237823486
Epoch: 16, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.621 Vali Acc: 0.527 Test Loss: 1.621 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.436033010482788
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.604 Vali Acc: 0.527 Test Loss: 1.604 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.307880163192749
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.593 Vali Acc: 0.542 Test Loss: 1.593 Test Acc: 0.542
Validation loss decreased (-0.526702 --> -0.541969).  Saving model ...
Epoch: 19 cost time: 1.4287936687469482
Epoch: 19, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.554 Vali Acc: 0.557 Test Loss: 1.554 Test Acc: 0.557
Validation loss decreased (-0.541969 --> -0.557236).  Saving model ...
Epoch: 20 cost time: 1.2987308502197266
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.673 Vali Acc: 0.542 Test Loss: 1.673 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.161625623703003
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.828 Vali Acc: 0.542 Test Loss: 1.828 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.320814609527588
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.765 Vali Acc: 0.542 Test Loss: 1.765 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3836696147918701
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.771 Vali Acc: 0.550 Test Loss: 1.771 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8547205924987793
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.850 Vali Acc: 0.542 Test Loss: 1.850 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2183642387390137
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.916 Vali Acc: 0.557 Test Loss: 1.916 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.124375820159912
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.863 Vali Acc: 0.557 Test Loss: 1.863 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.478625774383545
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.844 Vali Acc: 0.542 Test Loss: 1.844 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.58797025680542
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.949 Vali Acc: 0.527 Test Loss: 1.949 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2937641143798828
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.089 Vali Acc: 0.542 Test Loss: 2.089 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 416357
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.705387830734253
Epoch: 1, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.569 Vali Acc: 0.420 Test Loss: 1.569 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.5148060321807861
Epoch: 2, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.9638636112213135
Epoch: 3, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6663553714752197
Epoch: 4, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.2850825786590576
Epoch: 5, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.331958532333374
Epoch: 6, Steps: 8 | Train Loss: 1.039 Vali Loss: 1.480 Vali Acc: 0.443 Test Loss: 1.480 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.121185302734375
Epoch: 7, Steps: 8 | Train Loss: 0.926 Vali Loss: 1.457 Vali Acc: 0.458 Test Loss: 1.457 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 1.4626498222351074
Epoch: 8, Steps: 8 | Train Loss: 0.779 Vali Loss: 1.418 Vali Acc: 0.473 Test Loss: 1.418 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 1.2204184532165527
Epoch: 9, Steps: 8 | Train Loss: 0.715 Vali Loss: 1.441 Vali Acc: 0.473 Test Loss: 1.441 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1855862140655518
Epoch: 10, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.366 Vali Acc: 0.481 Test Loss: 1.366 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 1.451843500137329
Epoch: 11, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.366 Vali Acc: 0.511 Test Loss: 1.366 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511437).  Saving model ...
Epoch: 12 cost time: 1.5632705688476562
Epoch: 12, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.363 Vali Acc: 0.511 Test Loss: 1.363 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511437).  Saving model ...
Epoch: 13 cost time: 1.3266921043395996
Epoch: 13, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.348 Vali Acc: 0.527 Test Loss: 1.348 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.3893094062805176
Epoch: 14, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6155121326446533
Epoch: 15, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4179985523223877
Epoch: 16, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3746871948242188
Epoch: 17, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.46785569190979
Epoch: 18, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.339 Vali Acc: 0.534 Test Loss: 1.339 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 19 cost time: 1.2163870334625244
Epoch: 19, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.326 Vali Acc: 0.534 Test Loss: 1.326 Test Acc: 0.534
Validation loss decreased (-0.534338 --> -0.534338).  Saving model ...
Epoch: 20 cost time: 1.307605504989624
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6163041591644287
Epoch: 21, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.423 Vali Acc: 0.519 Test Loss: 1.423 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1836223602294922
Epoch: 22, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.420 Vali Acc: 0.519 Test Loss: 1.420 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.051046371459961
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2193100452423096
Epoch: 24, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.399 Vali Acc: 0.519 Test Loss: 1.399 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.266495704650879
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.465 Vali Acc: 0.527 Test Loss: 1.465 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3821368217468262
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.549 Vali Acc: 0.534 Test Loss: 1.549 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.38441801071167
Epoch: 27, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.554 Vali Acc: 0.527 Test Loss: 1.554 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.890399694442749
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.476 Vali Acc: 0.527 Test Loss: 1.476 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.410066843032837
Epoch: 29, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.550 Vali Acc: 0.519 Test Loss: 1.550 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 392357
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2334539890289307
Epoch: 1, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.548 Vali Acc: 0.420 Test Loss: 1.548 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.382126808166504
Epoch: 2, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1458947658538818
Epoch: 3, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.629246711730957
Epoch: 4, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.610469102859497
Epoch: 5, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1870849132537842
Epoch: 6, Steps: 8 | Train Loss: 1.128 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3569893836975098
Epoch: 7, Steps: 8 | Train Loss: 1.043 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6404826641082764
Epoch: 8, Steps: 8 | Train Loss: 0.906 Vali Loss: 1.495 Vali Acc: 0.420 Test Loss: 1.495 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.6412038803100586
Epoch: 9, Steps: 8 | Train Loss: 0.813 Vali Loss: 1.478 Vali Acc: 0.427 Test Loss: 1.478 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 10 cost time: 0.9184939861297607
Epoch: 10, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.474 Vali Acc: 0.420 Test Loss: 1.474 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7547328472137451
Epoch: 11, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.462 Vali Acc: 0.427 Test Loss: 1.462 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 12 cost time: 0.9234969615936279
Epoch: 12, Steps: 8 | Train Loss: 0.494 Vali Loss: 1.463 Vali Acc: 0.466 Test Loss: 1.463 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465634).  Saving model ...
Epoch: 13 cost time: 0.7862896919250488
Epoch: 13, Steps: 8 | Train Loss: 0.514 Vali Loss: 1.497 Vali Acc: 0.466 Test Loss: 1.497 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.777111291885376
Epoch: 14, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.395 Vali Acc: 0.519 Test Loss: 1.395 Test Acc: 0.519
Validation loss decreased (-0.465634 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.0907273292541504
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.397 Vali Acc: 0.519 Test Loss: 1.397 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9211597442626953
Epoch: 16, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.458 Vali Acc: 0.511 Test Loss: 1.458 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0777606964111328
Epoch: 17, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.419 Vali Acc: 0.534 Test Loss: 1.419 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 18 cost time: 0.9186263084411621
Epoch: 18, Steps: 8 | Train Loss: 0.314 Vali Loss: 1.506 Vali Acc: 0.496 Test Loss: 1.506 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9249801635742188
Epoch: 19, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.486 Vali Acc: 0.504 Test Loss: 1.486 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7075424194335938
Epoch: 20, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.389 Vali Acc: 0.542 Test Loss: 1.389 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 21 cost time: 0.824664831161499
Epoch: 21, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.375 Vali Acc: 0.542 Test Loss: 1.375 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 22 cost time: 1.0630335807800293
Epoch: 22, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.553 Vali Acc: 0.504 Test Loss: 1.553 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0730259418487549
Epoch: 23, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.496 Vali Acc: 0.519 Test Loss: 1.496 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3386383056640625
Epoch: 24, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.396 Vali Acc: 0.542 Test Loss: 1.396 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2102384567260742
Epoch: 25, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.347 Vali Acc: 0.573 Test Loss: 1.347 Test Acc: 0.573
Validation loss decreased (-0.541971 --> -0.572506).  Saving model ...
Epoch: 26 cost time: 0.7129387855529785
Epoch: 26, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.451 Vali Acc: 0.542 Test Loss: 1.451 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9982030391693115
Epoch: 27, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.406 Vali Acc: 0.557 Test Loss: 1.406 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9244277477264404
Epoch: 28, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.466 Vali Acc: 0.534 Test Loss: 1.466 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8613669872283936
Epoch: 29, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.520 Vali Acc: 0.557 Test Loss: 1.520 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9316520690917969
Epoch: 30, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.538 Vali Acc: 0.534 Test Loss: 1.538 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7989718914031982
Epoch: 31, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.524 Vali Acc: 0.542 Test Loss: 1.524 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7859251499176025
Epoch: 32, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.443 Vali Acc: 0.565 Test Loss: 1.443 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8461267948150635
Epoch: 33, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.438 Vali Acc: 0.565 Test Loss: 1.438 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8983070850372314
Epoch: 34, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.461 Vali Acc: 0.565 Test Loss: 1.461 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6472063064575195
Epoch: 35, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.495 Vali Acc: 0.557 Test Loss: 1.495 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 395205
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2339463233947754
Epoch: 1, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.548 Vali Acc: 0.420 Test Loss: 1.548 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.8269920349121094
Epoch: 2, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.7904608249664307
Epoch: 3, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 0.7910432815551758
Epoch: 4, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.0379116535186768
Epoch: 5, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.91855788230896
Epoch: 6, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.4092788696289062
Epoch: 7, Steps: 8 | Train Loss: 1.022 Vali Loss: 1.497 Vali Acc: 0.420 Test Loss: 1.497 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.4761745929718018
Epoch: 8, Steps: 8 | Train Loss: 0.925 Vali Loss: 1.491 Vali Acc: 0.435 Test Loss: 1.491 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 9 cost time: 1.2396080493927002
Epoch: 9, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.473 Vali Acc: 0.458 Test Loss: 1.473 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 10 cost time: 1.2435240745544434
Epoch: 10, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.476 Vali Acc: 0.458 Test Loss: 1.476 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0551483631134033
Epoch: 11, Steps: 8 | Train Loss: 0.649 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 12 cost time: 1.2838191986083984
Epoch: 12, Steps: 8 | Train Loss: 0.558 Vali Loss: 1.473 Vali Acc: 0.458 Test Loss: 1.473 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1584806442260742
Epoch: 13, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.461 Vali Acc: 0.489 Test Loss: 1.461 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 14 cost time: 1.5047965049743652
Epoch: 14, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.424 Vali Acc: 0.489 Test Loss: 1.424 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 15 cost time: 1.4217796325683594
Epoch: 15, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.440 Vali Acc: 0.504 Test Loss: 1.440 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 16 cost time: 1.5942668914794922
Epoch: 16, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 17 cost time: 1.4593329429626465
Epoch: 17, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 18 cost time: 1.1747019290924072
Epoch: 18, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.486 Vali Acc: 0.519 Test Loss: 1.486 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.513855218887329
Epoch: 19, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.486 Vali Acc: 0.519 Test Loss: 1.486 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2600886821746826
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.531 Vali Acc: 0.519 Test Loss: 1.531 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5398499965667725
Epoch: 21, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.574 Vali Acc: 0.519 Test Loss: 1.574 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7120604515075684
Epoch: 22, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.608 Vali Acc: 0.519 Test Loss: 1.608 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3000507354736328
Epoch: 23, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.644 Vali Acc: 0.527 Test Loss: 1.644 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.532930850982666
Epoch: 24, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.677 Vali Acc: 0.527 Test Loss: 1.677 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2892529964447021
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.658 Vali Acc: 0.519 Test Loss: 1.658 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4355947971343994
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.686 Vali Acc: 0.511 Test Loss: 1.686 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5594115257263184
Epoch: 27, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.650 Vali Acc: 0.504 Test Loss: 1.650 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 401925
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3651883602142334
Epoch: 1, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.565 Vali Acc: 0.435 Test Loss: 1.565 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 1.28092360496521
Epoch: 2, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.540 Vali Acc: 0.427 Test Loss: 1.540 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5321540832519531
Epoch: 3, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.014352798461914
Epoch: 4, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.751593828201294
Epoch: 5, Steps: 8 | Train Loss: 1.189 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.816894769668579
Epoch: 6, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4699761867523193
Epoch: 7, Steps: 8 | Train Loss: 1.051 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5672078132629395
Epoch: 8, Steps: 8 | Train Loss: 0.960 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5848827362060547
Epoch: 9, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.516 Vali Acc: 0.427 Test Loss: 1.516 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3543541431427002
Epoch: 10, Steps: 8 | Train Loss: 0.816 Vali Loss: 1.511 Vali Acc: 0.435 Test Loss: 1.511 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 11 cost time: 1.6288118362426758
Epoch: 11, Steps: 8 | Train Loss: 0.732 Vali Loss: 1.485 Vali Acc: 0.427 Test Loss: 1.485 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7254829406738281
Epoch: 12, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.528 Vali Acc: 0.427 Test Loss: 1.528 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3179633617401123
Epoch: 13, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.503 Vali Acc: 0.435 Test Loss: 1.503 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 14 cost time: 1.2014780044555664
Epoch: 14, Steps: 8 | Train Loss: 0.493 Vali Loss: 1.502 Vali Acc: 0.450 Test Loss: 1.502 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 15 cost time: 1.3646397590637207
Epoch: 15, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.528 Vali Acc: 0.443 Test Loss: 1.528 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3337039947509766
Epoch: 16, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.525 Vali Acc: 0.443 Test Loss: 1.525 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2030830383300781
Epoch: 17, Steps: 8 | Train Loss: 0.362 Vali Loss: 1.548 Vali Acc: 0.450 Test Loss: 1.548 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.409031867980957
Epoch: 18, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8637452125549316
Epoch: 19, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.543 Vali Acc: 0.450 Test Loss: 1.543 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7932469844818115
Epoch: 20, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.575 Vali Acc: 0.466 Test Loss: 1.575 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465633).  Saving model ...
Epoch: 21 cost time: 1.4733591079711914
Epoch: 21, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.609 Vali Acc: 0.450 Test Loss: 1.609 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3988001346588135
Epoch: 22, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.647 Vali Acc: 0.450 Test Loss: 1.647 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7567012310028076
Epoch: 23, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.601 Vali Acc: 0.466 Test Loss: 1.601 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.86378812789917
Epoch: 24, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.598 Vali Acc: 0.458 Test Loss: 1.598 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4788899421691895
Epoch: 25, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.644 Vali Acc: 0.450 Test Loss: 1.644 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.519066333770752
Epoch: 26, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.635 Vali Acc: 0.450 Test Loss: 1.635 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5750854015350342
Epoch: 27, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.687 Vali Acc: 0.450 Test Loss: 1.687 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6691508293151855
Epoch: 28, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.640 Vali Acc: 0.466 Test Loss: 1.640 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3853888511657715
Epoch: 29, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.579 Vali Acc: 0.481 Test Loss: 1.579 Test Acc: 0.481
Validation loss decreased (-0.465633 --> -0.480900).  Saving model ...
Epoch: 30 cost time: 1.512594223022461
Epoch: 30, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.591 Vali Acc: 0.496 Test Loss: 1.591 Test Acc: 0.496
Validation loss decreased (-0.480900 --> -0.496167).  Saving model ...
Epoch: 31 cost time: 1.8731098175048828
Epoch: 31, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.674938678741455
Epoch: 32, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.670 Vali Acc: 0.473 Test Loss: 1.670 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9301939010620117
Epoch: 33, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.671 Vali Acc: 0.466 Test Loss: 1.671 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.1515421867370605
Epoch: 34, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.639 Vali Acc: 0.473 Test Loss: 1.639 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9151952266693115
Epoch: 35, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7009921073913574
Epoch: 36, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.645 Vali Acc: 0.481 Test Loss: 1.645 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.653228521347046
Epoch: 37, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.666 Vali Acc: 0.473 Test Loss: 1.666 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.8526241779327393
Epoch: 38, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.627 Vali Acc: 0.489 Test Loss: 1.627 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.0282418727874756
Epoch: 39, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.655 Vali Acc: 0.466 Test Loss: 1.655 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4196054935455322
Epoch: 40, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.658 Vali Acc: 0.443 Test Loss: 1.658 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 426853
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.261537075042725
Epoch: 1, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.571 Vali Acc: 0.244 Test Loss: 1.571 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 2.0464093685150146
Epoch: 2, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.541 Vali Acc: 0.405 Test Loss: 1.541 Test Acc: 0.405
Validation loss decreased (-0.244259 --> -0.404565).  Saving model ...
Epoch: 3 cost time: 1.5289335250854492
Epoch: 3, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (-0.404565 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.800976276397705
Epoch: 4, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.509 Vali Acc: 0.420 Test Loss: 1.509 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.78721022605896
Epoch: 5, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.486 Vali Acc: 0.420 Test Loss: 1.486 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4663105010986328
Epoch: 6, Steps: 8 | Train Loss: 1.084 Vali Loss: 1.480 Vali Acc: 0.420 Test Loss: 1.480 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 7 cost time: 1.7947864532470703
Epoch: 7, Steps: 8 | Train Loss: 0.971 Vali Loss: 1.475 Vali Acc: 0.420 Test Loss: 1.475 Test Acc: 0.420
Validation loss decreased (-0.419833 --> -0.419833).  Saving model ...
Epoch: 8 cost time: 2.1313531398773193
Epoch: 8, Steps: 8 | Train Loss: 0.868 Vali Loss: 1.452 Vali Acc: 0.458 Test Loss: 1.452 Test Acc: 0.458
Validation loss decreased (-0.419833 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 1.9431309700012207
Epoch: 9, Steps: 8 | Train Loss: 0.787 Vali Loss: 1.441 Vali Acc: 0.481 Test Loss: 1.441 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 1.5820393562316895
Epoch: 10, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.445 Vali Acc: 0.481 Test Loss: 1.445 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.46560001373291
Epoch: 11, Steps: 8 | Train Loss: 0.619 Vali Loss: 1.443 Vali Acc: 0.489 Test Loss: 1.443 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 1.7477867603302002
Epoch: 12, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.447 Vali Acc: 0.496 Test Loss: 1.447 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 13 cost time: 1.5779523849487305
Epoch: 13, Steps: 8 | Train Loss: 0.444 Vali Loss: 1.424 Vali Acc: 0.511 Test Loss: 1.424 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 1.5651049613952637
Epoch: 14, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.412 Vali Acc: 0.504 Test Loss: 1.412 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9096975326538086
Epoch: 15, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.932960033416748
Epoch: 16, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.406 Vali Acc: 0.534 Test Loss: 1.406 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534337).  Saving model ...
Epoch: 17 cost time: 1.9720289707183838
Epoch: 17, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8896825313568115
Epoch: 18, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.442 Vali Acc: 0.534 Test Loss: 1.442 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7117128372192383
Epoch: 19, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.463 Vali Acc: 0.527 Test Loss: 1.463 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9729046821594238
Epoch: 20, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.423 Vali Acc: 0.534 Test Loss: 1.423 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2571799755096436
Epoch: 21, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.437 Vali Acc: 0.527 Test Loss: 1.437 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8663010597229004
Epoch: 22, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.618 Vali Acc: 0.534 Test Loss: 1.618 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9189951419830322
Epoch: 23, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.560 Vali Acc: 0.527 Test Loss: 1.560 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.542168140411377
Epoch: 24, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.534 Vali Acc: 0.527 Test Loss: 1.534 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.987900733947754
Epoch: 25, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.486 Vali Acc: 0.534 Test Loss: 1.486 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6536269187927246
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.511 Vali Acc: 0.534 Test Loss: 1.511 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 451781
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5867910385131836
Epoch: 1, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.598 Vali Acc: 0.206 Test Loss: 1.598 Test Acc: 0.206
Validation loss decreased (inf --> -0.206091).  Saving model ...
Epoch: 2 cost time: 1.455836534500122
Epoch: 2, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.567 Vali Acc: 0.412 Test Loss: 1.567 Test Acc: 0.412
Validation loss decreased (-0.206091 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.6206529140472412
Epoch: 3, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5280883312225342
Epoch: 4, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5384862422943115
Epoch: 5, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4401435852050781
Epoch: 6, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9319453239440918
Epoch: 7, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.013773202896118
Epoch: 8, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.7381577491760254
Epoch: 9, Steps: 8 | Train Loss: 0.870 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6136393547058105
Epoch: 10, Steps: 8 | Train Loss: 0.802 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8506669998168945
Epoch: 11, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.496 Vali Acc: 0.420 Test Loss: 1.496 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 12 cost time: 1.7626841068267822
Epoch: 12, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.502 Vali Acc: 0.435 Test Loss: 1.502 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 13 cost time: 1.3364598751068115
Epoch: 13, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.520 Vali Acc: 0.435 Test Loss: 1.520 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8865642547607422
Epoch: 14, Steps: 8 | Train Loss: 0.536 Vali Loss: 1.496 Vali Acc: 0.435 Test Loss: 1.496 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435100).  Saving model ...
Epoch: 15 cost time: 1.4034523963928223
Epoch: 15, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.504 Vali Acc: 0.443 Test Loss: 1.504 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442733).  Saving model ...
Epoch: 16 cost time: 1.6062812805175781
Epoch: 16, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.506 Vali Acc: 0.443 Test Loss: 1.506 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9224920272827148
Epoch: 17, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.520 Vali Acc: 0.458 Test Loss: 1.520 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 18 cost time: 1.4671199321746826
Epoch: 18, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.535 Vali Acc: 0.458 Test Loss: 1.535 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1050968170166016
Epoch: 19, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.506 Vali Acc: 0.473 Test Loss: 1.506 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 20 cost time: 1.517516851425171
Epoch: 20, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.552 Vali Acc: 0.458 Test Loss: 1.552 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.622640609741211
Epoch: 21, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.523 Vali Acc: 0.466 Test Loss: 1.523 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0146324634552
Epoch: 22, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.513 Vali Acc: 0.473 Test Loss: 1.513 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7519500255584717
Epoch: 23, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.577 Vali Acc: 0.481 Test Loss: 1.577 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480900).  Saving model ...
Epoch: 24 cost time: 1.748765230178833
Epoch: 24, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.559 Vali Acc: 0.466 Test Loss: 1.559 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6372168064117432
Epoch: 25, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.579 Vali Acc: 0.443 Test Loss: 1.579 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.906067132949829
Epoch: 26, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.570 Vali Acc: 0.435 Test Loss: 1.570 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6587977409362793
Epoch: 27, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.554 Vali Acc: 0.458 Test Loss: 1.554 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4134070873260498
Epoch: 28, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.559 Vali Acc: 0.473 Test Loss: 1.559 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5860397815704346
Epoch: 29, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.531 Vali Acc: 0.466 Test Loss: 1.531 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4749672412872314
Epoch: 30, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.538 Vali Acc: 0.473 Test Loss: 1.538 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8412792682647705
Epoch: 31, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.585 Vali Acc: 0.450 Test Loss: 1.585 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4338195323944092
Epoch: 32, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.564 Vali Acc: 0.473 Test Loss: 1.564 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6281800270080566
Epoch: 33, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.553 Vali Acc: 0.473 Test Loss: 1.553 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 476709
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.243950605392456
Epoch: 1, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.555 Vali Acc: 0.420 Test Loss: 1.555 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2213704586029053
Epoch: 2, Steps: 8 | Train Loss: 1.314 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5596601963043213
Epoch: 3, Steps: 8 | Train Loss: 0.957 Vali Loss: 1.475 Vali Acc: 0.435 Test Loss: 1.475 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.47017240524292
Epoch: 4, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.477 Vali Acc: 0.458 Test Loss: 1.477 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 1.606438398361206
Epoch: 5, Steps: 8 | Train Loss: 0.357 Vali Loss: 1.622 Vali Acc: 0.504 Test Loss: 1.622 Test Acc: 0.504
Validation loss decreased (-0.458000 --> -0.503801).  Saving model ...
Epoch: 6 cost time: 1.6155037879943848
Epoch: 6, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.307 Vali Acc: 0.534 Test Loss: 1.307 Test Acc: 0.534
Validation loss decreased (-0.503801 --> -0.534338).  Saving model ...
Epoch: 7 cost time: 1.6400246620178223
Epoch: 7, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.626 Vali Acc: 0.519 Test Loss: 1.626 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5342493057250977
Epoch: 8, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.738 Vali Acc: 0.519 Test Loss: 1.738 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5949270725250244
Epoch: 9, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.417 Vali Acc: 0.534 Test Loss: 1.417 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3044514656066895
Epoch: 10, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.785 Vali Acc: 0.519 Test Loss: 1.785 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6324779987335205
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.958 Vali Acc: 0.519 Test Loss: 1.958 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3296844959259033
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.948 Vali Acc: 0.527 Test Loss: 1.948 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.561095952987671
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.204 Vali Acc: 0.511 Test Loss: 2.204 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.389326810836792
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.227 Vali Acc: 0.511 Test Loss: 2.227 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.566697120666504
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.296 Vali Acc: 0.527 Test Loss: 2.296 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5868511199951172
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.307 Vali Acc: 0.519 Test Loss: 2.307 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1502597
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.0726563930511475
Epoch: 1, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.578 Vali Acc: 0.420 Test Loss: 1.578 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2495160102844238
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.584 Vali Acc: 0.420 Test Loss: 1.584 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4404289722442627
Epoch: 3, Steps: 8 | Train Loss: 1.133 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.3680739402770996
Epoch: 4, Steps: 8 | Train Loss: 0.866 Vali Loss: 1.437 Vali Acc: 0.466 Test Loss: 1.437 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.7988381385803223
Epoch: 5, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.462 Vali Acc: 0.473 Test Loss: 1.462 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.3954265117645264
Epoch: 6, Steps: 8 | Train Loss: 0.388 Vali Loss: 1.452 Vali Acc: 0.504 Test Loss: 1.452 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 1.206191062927246
Epoch: 7, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.427 Vali Acc: 0.527 Test Loss: 1.427 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.705881118774414
Epoch: 8, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.848156213760376
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.329 Vali Acc: 0.542 Test Loss: 1.329 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541971).  Saving model ...
Epoch: 10 cost time: 1.7209885120391846
Epoch: 10, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.470 Vali Acc: 0.542 Test Loss: 1.470 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.642531156539917
Epoch: 11, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.566 Vali Acc: 0.542 Test Loss: 1.566 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.563758134841919
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.800 Vali Acc: 0.527 Test Loss: 1.800 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6552329063415527
Epoch: 13, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.783 Vali Acc: 0.527 Test Loss: 1.783 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6181459426879883
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.658 Vali Acc: 0.534 Test Loss: 1.658 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7191905975341797
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.647 Vali Acc: 0.534 Test Loss: 1.647 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3952231407165527
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.641 Vali Acc: 0.534 Test Loss: 1.641 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4005951881408691
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.604 Vali Acc: 0.527 Test Loss: 1.604 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.684316873550415
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.964 Vali Acc: 0.534 Test Loss: 1.964 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.482311725616455
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 2.008 Vali Acc: 0.511 Test Loss: 2.008 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1406597
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3686418533325195
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.565 Vali Acc: 0.427 Test Loss: 1.565 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.497206449508667
Epoch: 2, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5307385921478271
Epoch: 3, Steps: 8 | Train Loss: 1.215 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3819875717163086
Epoch: 4, Steps: 8 | Train Loss: 0.985 Vali Loss: 1.507 Vali Acc: 0.435 Test Loss: 1.507 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.462402105331421
Epoch: 5, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.493 Vali Acc: 0.443 Test Loss: 1.493 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.393979787826538
Epoch: 6, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.495 Vali Acc: 0.466 Test Loss: 1.495 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.4537937641143799
Epoch: 7, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.450 Vali Acc: 0.504 Test Loss: 1.450 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 1.4801063537597656
Epoch: 8, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.536 Vali Acc: 0.504 Test Loss: 1.536 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.719106674194336
Epoch: 9, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.438 Vali Acc: 0.534 Test Loss: 1.438 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534337).  Saving model ...
Epoch: 10 cost time: 1.389538049697876
Epoch: 10, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4062609672546387
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.465 Vali Acc: 0.534 Test Loss: 1.465 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.662029504776001
Epoch: 12, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.547 Vali Acc: 0.534 Test Loss: 1.547 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.372349739074707
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.588 Vali Acc: 0.534 Test Loss: 1.588 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2076427936553955
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.552 Vali Acc: 0.527 Test Loss: 1.552 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6679112911224365
Epoch: 15, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.417 Vali Acc: 0.542 Test Loss: 1.417 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.7152459621429443
Epoch: 16, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.587 Vali Acc: 0.519 Test Loss: 1.587 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3406968116760254
Epoch: 17, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.747 Vali Acc: 0.527 Test Loss: 1.747 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.552924633026123
Epoch: 18, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.667 Vali Acc: 0.534 Test Loss: 1.667 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7423229217529297
Epoch: 19, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.588 Vali Acc: 0.534 Test Loss: 1.588 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7151317596435547
Epoch: 20, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.633 Vali Acc: 0.519 Test Loss: 1.633 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6396567821502686
Epoch: 21, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.656 Vali Acc: 0.534 Test Loss: 1.656 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6690127849578857
Epoch: 22, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.760 Vali Acc: 0.527 Test Loss: 1.760 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.925191879272461
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.798 Vali Acc: 0.527 Test Loss: 1.798 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.519176721572876
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.642 Vali Acc: 0.557 Test Loss: 1.642 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557235).  Saving model ...
Epoch: 25 cost time: 1.5310754776000977
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.545 Vali Acc: 0.557 Test Loss: 1.545 Test Acc: 0.557
Validation loss decreased (-0.557235 --> -0.557236).  Saving model ...
Epoch: 26 cost time: 1.6080586910247803
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.611 Vali Acc: 0.527 Test Loss: 1.611 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5140480995178223
Epoch: 27, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.703 Vali Acc: 0.534 Test Loss: 1.703 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8715639114379883
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.684 Vali Acc: 0.550 Test Loss: 1.684 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8434722423553467
Epoch: 29, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.835 Vali Acc: 0.534 Test Loss: 1.835 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7795891761779785
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.126 Vali Acc: 0.534 Test Loss: 2.126 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.67911958694458
Epoch: 31, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.951 Vali Acc: 0.580 Test Loss: 1.951 Test Acc: 0.580
Validation loss decreased (-0.557236 --> -0.580133).  Saving model ...
Epoch: 32 cost time: 2.035686731338501
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.879 Vali Acc: 0.573 Test Loss: 1.879 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.86739182472229
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.999 Vali Acc: 0.550 Test Loss: 1.999 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5930263996124268
Epoch: 34, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.414 Vali Acc: 0.534 Test Loss: 2.414 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4638292789459229
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.636 Vali Acc: 0.542 Test Loss: 2.636 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6246421337127686
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.729 Vali Acc: 0.534 Test Loss: 2.729 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4788293838500977
Epoch: 37, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.759 Vali Acc: 0.527 Test Loss: 2.759 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.574397325515747
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.681 Vali Acc: 0.519 Test Loss: 2.681 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7349295616149902
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.640 Vali Acc: 0.527 Test Loss: 2.640 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.833617925643921
Epoch: 40, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.626 Vali Acc: 0.519 Test Loss: 2.626 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7544457912445068
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.710 Vali Acc: 0.527 Test Loss: 2.710 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1410309
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7897255420684814
Epoch: 1, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.559 Vali Acc: 0.420 Test Loss: 1.559 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.054560899734497
Epoch: 2, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6522867679595947
Epoch: 3, Steps: 8 | Train Loss: 1.164 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6166315078735352
Epoch: 4, Steps: 8 | Train Loss: 0.924 Vali Loss: 1.490 Vali Acc: 0.427 Test Loss: 1.490 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.5045514106750488
Epoch: 5, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.456 Vali Acc: 0.458 Test Loss: 1.456 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.7239749431610107
Epoch: 6, Steps: 8 | Train Loss: 0.548 Vali Loss: 1.427 Vali Acc: 0.489 Test Loss: 1.427 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.822831392288208
Epoch: 7, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.420 Vali Acc: 0.496 Test Loss: 1.420 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 2.0362789630889893
Epoch: 8, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.341 Vali Acc: 0.550 Test Loss: 1.341 Test Acc: 0.550
Validation loss decreased (-0.496169 --> -0.549605).  Saving model ...
Epoch: 9 cost time: 1.8208837509155273
Epoch: 9, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.438 Vali Acc: 0.534 Test Loss: 1.438 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.123368978500366
Epoch: 10, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.349 Vali Acc: 0.550 Test Loss: 1.349 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0427398681640625
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.322 Vali Acc: 0.542 Test Loss: 1.322 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.446855068206787
Epoch: 12, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.360 Vali Acc: 0.550 Test Loss: 1.360 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6900899410247803
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.422 Vali Acc: 0.542 Test Loss: 1.422 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6994662284851074
Epoch: 14, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.497 Vali Acc: 0.542 Test Loss: 1.497 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9185657501220703
Epoch: 15, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.526 Vali Acc: 0.534 Test Loss: 1.526 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7326586246490479
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.443 Vali Acc: 0.550 Test Loss: 1.443 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8063921928405762
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.460 Vali Acc: 0.573 Test Loss: 1.460 Test Acc: 0.573
Validation loss decreased (-0.549605 --> -0.572504).  Saving model ...
Epoch: 18 cost time: 1.6458609104156494
Epoch: 18, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.508 Vali Acc: 0.542 Test Loss: 1.508 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7191526889801025
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.558 Vali Acc: 0.534 Test Loss: 1.558 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.751868724822998
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.727 Vali Acc: 0.542 Test Loss: 1.727 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6038339138031006
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.682 Vali Acc: 0.534 Test Loss: 1.682 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8190958499908447
Epoch: 22, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.477 Vali Acc: 0.565 Test Loss: 1.477 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7845642566680908
Epoch: 23, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.451 Vali Acc: 0.573 Test Loss: 1.451 Test Acc: 0.573
Validation loss decreased (-0.572504 --> -0.572505).  Saving model ...
Epoch: 24 cost time: 1.8512511253356934
Epoch: 24, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.510 Vali Acc: 0.534 Test Loss: 1.510 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.957766056060791
Epoch: 25, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.456 Vali Acc: 0.565 Test Loss: 1.456 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7010769844055176
Epoch: 26, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.632 Vali Acc: 0.557 Test Loss: 1.632 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9583539962768555
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 2.030 Vali Acc: 0.511 Test Loss: 2.030 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.200270891189575
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.968 Vali Acc: 0.527 Test Loss: 1.968 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.154938220977783
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.926 Vali Acc: 0.527 Test Loss: 1.926 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8099329471588135
Epoch: 30, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.811 Vali Acc: 0.527 Test Loss: 1.811 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7184388637542725
Epoch: 31, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.826 Vali Acc: 0.557 Test Loss: 1.826 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7779440879821777
Epoch: 32, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.738 Vali Acc: 0.550 Test Loss: 1.738 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.706817865371704
Epoch: 33, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.843 Vali Acc: 0.542 Test Loss: 1.843 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 1444869
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.12676739692688
Epoch: 1, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.599 Vali Acc: 0.420 Test Loss: 1.599 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.546205997467041
Epoch: 2, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7149038314819336
Epoch: 3, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.569 Vali Acc: 0.420 Test Loss: 1.569 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0347304344177246
Epoch: 4, Steps: 8 | Train Loss: 1.079 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.7129647731781006
Epoch: 5, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 2.0098440647125244
Epoch: 6, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.9646790027618408
Epoch: 7, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.522 Vali Acc: 0.427 Test Loss: 1.522 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.8131484985351562
Epoch: 8, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.556 Vali Acc: 0.435 Test Loss: 1.556 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 9 cost time: 1.9773478507995605
Epoch: 9, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.501 Vali Acc: 0.458 Test Loss: 1.501 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458000).  Saving model ...
Epoch: 10 cost time: 1.8751168251037598
Epoch: 10, Steps: 8 | Train Loss: 0.296 Vali Loss: 1.517 Vali Acc: 0.473 Test Loss: 1.517 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 11 cost time: 1.9959561824798584
Epoch: 11, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.608 Vali Acc: 0.458 Test Loss: 1.608 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8951213359832764
Epoch: 12, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.457 Vali Acc: 0.534 Test Loss: 1.457 Test Acc: 0.534
Validation loss decreased (-0.473267 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.5264523029327393
Epoch: 13, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.482 Vali Acc: 0.511 Test Loss: 1.482 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9000811576843262
Epoch: 14, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.518 Vali Acc: 0.496 Test Loss: 1.518 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.831106185913086
Epoch: 15, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.546 Vali Acc: 0.496 Test Loss: 1.546 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7364237308502197
Epoch: 16, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.483 Vali Acc: 0.504 Test Loss: 1.483 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7272107601165771
Epoch: 17, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.439 Vali Acc: 0.519 Test Loss: 1.439 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6956329345703125
Epoch: 18, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.542 Vali Acc: 0.489 Test Loss: 1.542 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.549504280090332
Epoch: 19, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.522 Vali Acc: 0.496 Test Loss: 1.522 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8084816932678223
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.461 Vali Acc: 0.511 Test Loss: 1.461 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6049981117248535
Epoch: 21, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.701185703277588
Epoch: 22, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.462 Vali Acc: 0.519 Test Loss: 1.462 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1536901
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9570353031158447
Epoch: 1, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.592 Vali Acc: 0.374 Test Loss: 1.592 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.556992530822754
Epoch: 2, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4829926490783691
Epoch: 3, Steps: 8 | Train Loss: 1.181 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 2.2190067768096924
Epoch: 4, Steps: 8 | Train Loss: 0.981 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5844924449920654
Epoch: 5, Steps: 8 | Train Loss: 0.749 Vali Loss: 1.484 Vali Acc: 0.450 Test Loss: 1.484 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.5625760555267334
Epoch: 6, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.459 Vali Acc: 0.481 Test Loss: 1.459 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 2.050149917602539
Epoch: 7, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.423 Vali Acc: 0.511 Test Loss: 1.423 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.8668267726898193
Epoch: 8, Steps: 8 | Train Loss: 0.317 Vali Loss: 1.383 Vali Acc: 0.534 Test Loss: 1.383 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.6780004501342773
Epoch: 9, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.401 Vali Acc: 0.527 Test Loss: 1.401 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5910320281982422
Epoch: 10, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.360 Vali Acc: 0.534 Test Loss: 1.360 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534338).  Saving model ...
Epoch: 11 cost time: 2.066342353820801
Epoch: 11, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.405 Vali Acc: 0.534 Test Loss: 1.405 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5881447792053223
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.378 Vali Acc: 0.534 Test Loss: 1.378 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5231890678405762
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.366 Vali Acc: 0.565 Test Loss: 1.366 Test Acc: 0.565
Validation loss decreased (-0.534338 --> -0.564872).  Saving model ...
Epoch: 14 cost time: 1.5276031494140625
Epoch: 14, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.373 Vali Acc: 0.573 Test Loss: 1.373 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
Epoch: 15 cost time: 1.7766544818878174
Epoch: 15, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.493 Vali Acc: 0.557 Test Loss: 1.493 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6034166812896729
Epoch: 16, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.465 Vali Acc: 0.542 Test Loss: 1.465 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8720803260803223
Epoch: 17, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.344 Vali Acc: 0.565 Test Loss: 1.344 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5425083637237549
Epoch: 18, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.380 Vali Acc: 0.550 Test Loss: 1.380 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5847322940826416
Epoch: 19, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.403 Vali Acc: 0.557 Test Loss: 1.403 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.111527681350708
Epoch: 20, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.421 Vali Acc: 0.565 Test Loss: 1.421 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.580925703048706
Epoch: 21, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.421 Vali Acc: 0.557 Test Loss: 1.421 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6285533905029297
Epoch: 22, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.449 Vali Acc: 0.565 Test Loss: 1.449 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.000864267349243
Epoch: 23, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.465 Vali Acc: 0.588 Test Loss: 1.465 Test Acc: 0.588
Validation loss decreased (-0.572505 --> -0.587772).  Saving model ...
Epoch: 24 cost time: 1.7626895904541016
Epoch: 24, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.447 Vali Acc: 0.573 Test Loss: 1.447 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3992869853973389
Epoch: 25, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.642 Vali Acc: 0.542 Test Loss: 1.642 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7172119617462158
Epoch: 26, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.735 Vali Acc: 0.534 Test Loss: 1.735 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9240336418151855
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.654 Vali Acc: 0.542 Test Loss: 1.654 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.666327953338623
Epoch: 28, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.634 Vali Acc: 0.527 Test Loss: 1.634 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5824244022369385
Epoch: 29, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.594 Vali Acc: 0.527 Test Loss: 1.594 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7568223476409912
Epoch: 30, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9061989784240723
Epoch: 31, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.590 Vali Acc: 0.557 Test Loss: 1.590 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9502434730529785
Epoch: 32, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.625 Vali Acc: 0.573 Test Loss: 1.625 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7002732753753662
Epoch: 33, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.650 Vali Acc: 0.550 Test Loss: 1.650 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1636613
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.301549196243286
Epoch: 1, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.591 Vali Acc: 0.336 Test Loss: 1.591 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.7879724502563477
Epoch: 2, Steps: 8 | Train Loss: 1.437 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.335862 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.613112449645996
Epoch: 3, Steps: 8 | Train Loss: 1.204 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6622402667999268
Epoch: 4, Steps: 8 | Train Loss: 1.034 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7573273181915283
Epoch: 5, Steps: 8 | Train Loss: 0.800 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.7349827289581299
Epoch: 6, Steps: 8 | Train Loss: 0.688 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.635563850402832
Epoch: 7, Steps: 8 | Train Loss: 0.543 Vali Loss: 1.514 Vali Acc: 0.435 Test Loss: 1.514 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 8 cost time: 1.8156671524047852
Epoch: 8, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.551 Vali Acc: 0.450 Test Loss: 1.551 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450366).  Saving model ...
Epoch: 9 cost time: 1.5486364364624023
Epoch: 9, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.541 Vali Acc: 0.458 Test Loss: 1.541 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 10 cost time: 1.6508560180664062
Epoch: 10, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.516 Vali Acc: 0.466 Test Loss: 1.516 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 11 cost time: 1.8413403034210205
Epoch: 11, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.559 Vali Acc: 0.458 Test Loss: 1.559 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2302939891815186
Epoch: 12, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.540 Vali Acc: 0.466 Test Loss: 1.540 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6535253524780273
Epoch: 13, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.554 Vali Acc: 0.458 Test Loss: 1.554 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9575059413909912
Epoch: 14, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.568 Vali Acc: 0.458 Test Loss: 1.568 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3286752700805664
Epoch: 15, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.545 Vali Acc: 0.473 Test Loss: 1.545 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 16 cost time: 1.665341854095459
Epoch: 16, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.572 Vali Acc: 0.458 Test Loss: 1.572 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0163702964782715
Epoch: 17, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.553 Vali Acc: 0.473 Test Loss: 1.553 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0086143016815186
Epoch: 18, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.583 Vali Acc: 0.458 Test Loss: 1.583 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.663224697113037
Epoch: 19, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.580 Vali Acc: 0.458 Test Loss: 1.580 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8980791568756104
Epoch: 20, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.541 Vali Acc: 0.473 Test Loss: 1.541 Test Acc: 0.473
Validation loss decreased (-0.473267 --> -0.473267).  Saving model ...
Epoch: 21 cost time: 1.8345508575439453
Epoch: 21, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.557 Vali Acc: 0.466 Test Loss: 1.557 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8316242694854736
Epoch: 22, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.539 Vali Acc: 0.481 Test Loss: 1.539 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 23 cost time: 1.5151314735412598
Epoch: 23, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.566 Vali Acc: 0.473 Test Loss: 1.566 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7358217239379883
Epoch: 24, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.616 Vali Acc: 0.466 Test Loss: 1.616 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7873730659484863
Epoch: 25, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.597 Vali Acc: 0.458 Test Loss: 1.597 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.638169288635254
Epoch: 26, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.560 Vali Acc: 0.466 Test Loss: 1.560 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.871408462524414
Epoch: 27, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.572 Vali Acc: 0.473 Test Loss: 1.572 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0278990268707275
Epoch: 28, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.528 Vali Acc: 0.489 Test Loss: 1.528 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488534).  Saving model ...
Epoch: 29 cost time: 1.7757384777069092
Epoch: 29, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.550 Vali Acc: 0.481 Test Loss: 1.550 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8365705013275146
Epoch: 30, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.583 Vali Acc: 0.458 Test Loss: 1.583 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5586557388305664
Epoch: 31, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.577 Vali Acc: 0.458 Test Loss: 1.577 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7388198375701904
Epoch: 32, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0843868255615234
Epoch: 33, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.523 Vali Acc: 0.481 Test Loss: 1.523 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9013488292694092
Epoch: 34, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.556 Vali Acc: 0.473 Test Loss: 1.556 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9183499813079834
Epoch: 35, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.572 Vali Acc: 0.458 Test Loss: 1.572 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.8117377758026123
Epoch: 36, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.556 Vali Acc: 0.435 Test Loss: 1.556 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.8552849292755127
Epoch: 37, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.554 Vali Acc: 0.443 Test Loss: 1.554 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.616267204284668
Epoch: 38, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.568 Vali Acc: 0.458 Test Loss: 1.568 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 1744005
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.173115253448486
Epoch: 1, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.3778691291809082
Epoch: 2, Steps: 8 | Train Loss: 1.420 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.663407802581787
Epoch: 3, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.528 Vali Acc: 0.427 Test Loss: 1.528 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.5884251594543457
Epoch: 4, Steps: 8 | Train Loss: 0.913 Vali Loss: 1.457 Vali Acc: 0.450 Test Loss: 1.457 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.770176887512207
Epoch: 5, Steps: 8 | Train Loss: 0.661 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.409353494644165
Epoch: 6, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.381 Vali Acc: 0.496 Test Loss: 1.381 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.389725923538208
Epoch: 7, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.323 Vali Acc: 0.527 Test Loss: 1.323 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.65757155418396
Epoch: 8, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.407 Vali Acc: 0.519 Test Loss: 1.407 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3559556007385254
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.384 Vali Acc: 0.519 Test Loss: 1.384 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7040045261383057
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.368 Vali Acc: 0.519 Test Loss: 1.368 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3529083728790283
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.405 Vali Acc: 0.550 Test Loss: 1.405 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549604).  Saving model ...
Epoch: 12 cost time: 1.6667821407318115
Epoch: 12, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.570 Vali Acc: 0.534 Test Loss: 1.570 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6201074123382568
Epoch: 13, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.607 Vali Acc: 0.519 Test Loss: 1.607 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.509281873703003
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.691 Vali Acc: 0.527 Test Loss: 1.691 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0437960624694824
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.763 Vali Acc: 0.519 Test Loss: 1.763 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.575598955154419
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.803 Vali Acc: 0.519 Test Loss: 1.803 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6654767990112305
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.875 Vali Acc: 0.534 Test Loss: 1.875 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7799725532531738
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.765 Vali Acc: 0.519 Test Loss: 1.765 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4238262176513672
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.880 Vali Acc: 0.511 Test Loss: 1.880 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6106698513031006
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.201 Vali Acc: 0.519 Test Loss: 2.201 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7842950820922852
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.269 Vali Acc: 0.519 Test Loss: 2.269 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 489157
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.524391412734985
Epoch: 1, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.576 Vali Acc: 0.389 Test Loss: 1.576 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.9853720664978027
Epoch: 2, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.547 Vali Acc: 0.420 Test Loss: 1.547 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4308748245239258
Epoch: 3, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5917119979858398
Epoch: 4, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 2.000366449356079
Epoch: 5, Steps: 8 | Train Loss: 0.929 Vali Loss: 1.478 Vali Acc: 0.427 Test Loss: 1.478 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.6043481826782227
Epoch: 6, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.405 Vali Acc: 0.466 Test Loss: 1.405 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465635).  Saving model ...
Epoch: 7 cost time: 1.4914155006408691
Epoch: 7, Steps: 8 | Train Loss: 0.563 Vali Loss: 1.383 Vali Acc: 0.496 Test Loss: 1.383 Test Acc: 0.496
Validation loss decreased (-0.465635 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.6197521686553955
Epoch: 8, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.463 Vali Acc: 0.481 Test Loss: 1.463 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4019684791564941
Epoch: 9, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.6069281101226807
Epoch: 10, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.461 Vali Acc: 0.519 Test Loss: 1.461 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7289454936981201
Epoch: 11, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.523 Vali Acc: 0.519 Test Loss: 1.523 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4284813404083252
Epoch: 12, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.357 Vali Acc: 0.534 Test Loss: 1.357 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 13 cost time: 1.6819515228271484
Epoch: 13, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5174016952514648
Epoch: 14, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.520 Vali Acc: 0.519 Test Loss: 1.520 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7391347885131836
Epoch: 15, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8204574584960938
Epoch: 16, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.430 Vali Acc: 0.534 Test Loss: 1.430 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8321943283081055
Epoch: 17, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.465 Vali Acc: 0.519 Test Loss: 1.465 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.909912109375
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.533 Vali Acc: 0.519 Test Loss: 1.533 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6882388591766357
Epoch: 19, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.633 Vali Acc: 0.519 Test Loss: 1.633 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7000091075897217
Epoch: 20, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.681 Vali Acc: 0.519 Test Loss: 1.681 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5579109191894531
Epoch: 21, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.606 Vali Acc: 0.534 Test Loss: 1.606 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4146525859832764
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.640 Vali Acc: 0.534 Test Loss: 1.640 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 441157
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.26524806022644
Epoch: 1, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.595 Vali Acc: 0.336 Test Loss: 1.595 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.2707171440124512
Epoch: 2, Steps: 8 | Train Loss: 1.474 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.335862 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.8906712532043457
Epoch: 3, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5441193580627441
Epoch: 4, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.4898524284362793
Epoch: 5, Steps: 8 | Train Loss: 1.027 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.7266654968261719
Epoch: 6, Steps: 8 | Train Loss: 0.892 Vali Loss: 1.498 Vali Acc: 0.427 Test Loss: 1.498 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.3808989524841309
Epoch: 7, Steps: 8 | Train Loss: 0.734 Vali Loss: 1.457 Vali Acc: 0.443 Test Loss: 1.457 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442734).  Saving model ...
Epoch: 8 cost time: 1.542375087738037
Epoch: 8, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.460 Vali Acc: 0.435 Test Loss: 1.460 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.811610221862793
Epoch: 9, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
Validation loss decreased (-0.442734 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.816258192062378
Epoch: 10, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.454 Vali Acc: 0.496 Test Loss: 1.454 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 1.5008666515350342
Epoch: 11, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.464 Vali Acc: 0.496 Test Loss: 1.464 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4372997283935547
Epoch: 12, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.458 Vali Acc: 0.511 Test Loss: 1.458 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 1.6152558326721191
Epoch: 13, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.473 Vali Acc: 0.519 Test Loss: 1.473 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 14 cost time: 1.6425228118896484
Epoch: 14, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.465 Vali Acc: 0.511 Test Loss: 1.465 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5464162826538086
Epoch: 15, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7834460735321045
Epoch: 16, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.510 Vali Acc: 0.527 Test Loss: 1.510 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 17 cost time: 1.5098490715026855
Epoch: 17, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.559 Vali Acc: 0.519 Test Loss: 1.559 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4943950176239014
Epoch: 18, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.563 Vali Acc: 0.519 Test Loss: 1.563 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.359342336654663
Epoch: 19, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5813572406768799
Epoch: 20, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.561 Vali Acc: 0.527 Test Loss: 1.561 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.685894250869751
Epoch: 21, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.617 Vali Acc: 0.550 Test Loss: 1.617 Test Acc: 0.550
Validation loss decreased (-0.526702 --> -0.549602).  Saving model ...
Epoch: 22 cost time: 1.2522664070129395
Epoch: 22, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.605 Vali Acc: 0.527 Test Loss: 1.605 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.50533127784729
Epoch: 23, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.552 Vali Acc: 0.527 Test Loss: 1.552 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9469151496887207
Epoch: 24, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.487 Vali Acc: 0.527 Test Loss: 1.487 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2981090545654297
Epoch: 25, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.474 Vali Acc: 0.527 Test Loss: 1.474 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3011035919189453
Epoch: 26, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.518 Vali Acc: 0.534 Test Loss: 1.518 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.760075330734253
Epoch: 27, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.576 Vali Acc: 0.527 Test Loss: 1.576 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4164080619812012
Epoch: 28, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.606 Vali Acc: 0.527 Test Loss: 1.606 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2929608821868896
Epoch: 29, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.743 Vali Acc: 0.519 Test Loss: 1.743 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6938838958740234
Epoch: 30, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.788 Vali Acc: 0.519 Test Loss: 1.788 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.691586971282959
Epoch: 31, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.768 Vali Acc: 0.519 Test Loss: 1.768 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 443013
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7445569038391113
Epoch: 1, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.591 Vali Acc: 0.420 Test Loss: 1.591 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5579040050506592
Epoch: 2, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4957656860351562
Epoch: 3, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.4480056762695312
Epoch: 4, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.708935260772705
Epoch: 5, Steps: 8 | Train Loss: 1.062 Vali Loss: 1.503 Vali Acc: 0.420 Test Loss: 1.503 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.4007344245910645
Epoch: 6, Steps: 8 | Train Loss: 0.910 Vali Loss: 1.465 Vali Acc: 0.435 Test Loss: 1.465 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 1.768904447555542
Epoch: 7, Steps: 8 | Train Loss: 0.785 Vali Loss: 1.444 Vali Acc: 0.450 Test Loss: 1.444 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.2196800708770752
Epoch: 8, Steps: 8 | Train Loss: 0.652 Vali Loss: 1.424 Vali Acc: 0.481 Test Loss: 1.424 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.4259114265441895
Epoch: 9, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.379 Vali Acc: 0.496 Test Loss: 1.379 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.713109016418457
Epoch: 10, Steps: 8 | Train Loss: 0.399 Vali Loss: 1.303 Vali Acc: 0.519 Test Loss: 1.303 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519071).  Saving model ...
Epoch: 11 cost time: 1.5004019737243652
Epoch: 11, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.302 Vali Acc: 0.527 Test Loss: 1.302 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526705).  Saving model ...
Epoch: 12 cost time: 1.5111098289489746
Epoch: 12, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.311 Vali Acc: 0.534 Test Loss: 1.311 Test Acc: 0.534
Validation loss decreased (-0.526705 --> -0.534338).  Saving model ...
Epoch: 13 cost time: 1.6158950328826904
Epoch: 13, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4798052310943604
Epoch: 14, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.273 Vali Acc: 0.557 Test Loss: 1.273 Test Acc: 0.557
Validation loss decreased (-0.534338 --> -0.557239).  Saving model ...
Epoch: 15 cost time: 1.4716825485229492
Epoch: 15, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4364206790924072
Epoch: 16, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.322 Vali Acc: 0.565 Test Loss: 1.322 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564872).  Saving model ...
Epoch: 17 cost time: 1.1958205699920654
Epoch: 17, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.348 Vali Acc: 0.542 Test Loss: 1.348 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5889863967895508
Epoch: 18, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.362 Vali Acc: 0.542 Test Loss: 1.362 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3689537048339844
Epoch: 19, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.317 Vali Acc: 0.542 Test Loss: 1.317 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8716936111450195
Epoch: 20, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.305 Vali Acc: 0.565 Test Loss: 1.305 Test Acc: 0.565
Validation loss decreased (-0.564872 --> -0.564872).  Saving model ...
Epoch: 21 cost time: 1.464294672012329
Epoch: 21, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.338 Vali Acc: 0.534 Test Loss: 1.338 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7125277519226074
Epoch: 22, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.410 Vali Acc: 0.534 Test Loss: 1.410 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8399274349212646
Epoch: 23, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.303 Vali Acc: 0.542 Test Loss: 1.303 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4774894714355469
Epoch: 24, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.329 Vali Acc: 0.542 Test Loss: 1.329 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.355423927307129
Epoch: 25, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.407 Vali Acc: 0.542 Test Loss: 1.407 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.674612045288086
Epoch: 26, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.430 Vali Acc: 0.542 Test Loss: 1.430 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7544565200805664
Epoch: 27, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.446 Vali Acc: 0.542 Test Loss: 1.446 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4171388149261475
Epoch: 28, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.466 Vali Acc: 0.542 Test Loss: 1.466 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.441901445388794
Epoch: 29, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.382 Vali Acc: 0.557 Test Loss: 1.382 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5952987670898438
Epoch: 30, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.367 Vali Acc: 0.573 Test Loss: 1.367 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
Epoch: 31 cost time: 1.6747047901153564
Epoch: 31, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.409 Vali Acc: 0.557 Test Loss: 1.409 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3330409526824951
Epoch: 32, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3765854835510254
Epoch: 33, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.481 Vali Acc: 0.542 Test Loss: 1.481 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8402471542358398
Epoch: 34, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.396 Vali Acc: 0.573 Test Loss: 1.396 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.662170171737671
Epoch: 35, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.498 Vali Acc: 0.565 Test Loss: 1.498 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1757538318634033
Epoch: 36, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.591 Vali Acc: 0.557 Test Loss: 1.591 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5123794078826904
Epoch: 37, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.755 Vali Acc: 0.542 Test Loss: 1.755 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2589960098266602
Epoch: 38, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.545 Vali Acc: 0.565 Test Loss: 1.545 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2567920684814453
Epoch: 39, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.473 Vali Acc: 0.573 Test Loss: 1.473 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.121049404144287
Epoch: 40, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.535 Vali Acc: 0.565 Test Loss: 1.535 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 460293
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3783655166625977
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.562 Vali Acc: 0.427 Test Loss: 1.562 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.183945655822754
Epoch: 2, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4636366367340088
Epoch: 3, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3104681968688965
Epoch: 4, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1810500621795654
Epoch: 5, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.40110182762146
Epoch: 6, Steps: 8 | Train Loss: 0.947 Vali Loss: 1.502 Vali Acc: 0.420 Test Loss: 1.502 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4603707790374756
Epoch: 7, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.487 Vali Acc: 0.427 Test Loss: 1.487 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.0679538249969482
Epoch: 8, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.491 Vali Acc: 0.427 Test Loss: 1.491 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2941255569458008
Epoch: 9, Steps: 8 | Train Loss: 0.615 Vali Loss: 1.463 Vali Acc: 0.450 Test Loss: 1.463 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 1.2205989360809326
Epoch: 10, Steps: 8 | Train Loss: 0.557 Vali Loss: 1.445 Vali Acc: 0.473 Test Loss: 1.445 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 1.5742292404174805
Epoch: 11, Steps: 8 | Train Loss: 0.450 Vali Loss: 1.445 Vali Acc: 0.481 Test Loss: 1.445 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 1.1509857177734375
Epoch: 12, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 13 cost time: 1.376657485961914
Epoch: 13, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.447 Vali Acc: 0.489 Test Loss: 1.447 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3076658248901367
Epoch: 14, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 15 cost time: 1.4139752388000488
Epoch: 15, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526704).  Saving model ...
Epoch: 16 cost time: 1.2831289768218994
Epoch: 16, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.491 Vali Acc: 0.504 Test Loss: 1.491 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6203701496124268
Epoch: 17, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.535 Vali Acc: 0.481 Test Loss: 1.535 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3665859699249268
Epoch: 18, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.500 Vali Acc: 0.489 Test Loss: 1.500 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2544901371002197
Epoch: 19, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.38679838180542
Epoch: 20, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.536 Vali Acc: 0.481 Test Loss: 1.536 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4962306022644043
Epoch: 21, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.497 Vali Acc: 0.504 Test Loss: 1.497 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.245448112487793
Epoch: 22, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.481 Vali Acc: 0.519 Test Loss: 1.481 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0480341911315918
Epoch: 23, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.500 Vali Acc: 0.511 Test Loss: 1.500 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3546452522277832
Epoch: 24, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.514 Vali Acc: 0.504 Test Loss: 1.514 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4338009357452393
Epoch: 25, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.558 Vali Acc: 0.496 Test Loss: 1.558 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 506309
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.05993127822876
Epoch: 1, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.627 Vali Acc: 0.198 Test Loss: 1.627 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 1.4343395233154297
Epoch: 2, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.588 Vali Acc: 0.420 Test Loss: 1.588 Test Acc: 0.420
Validation loss decreased (-0.198457 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.4348669052124023
Epoch: 3, Steps: 8 | Train Loss: 1.370 Vali Loss: 1.545 Vali Acc: 0.435 Test Loss: 1.545 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.4394304752349854
Epoch: 4, Steps: 8 | Train Loss: 1.177 Vali Loss: 1.524 Vali Acc: 0.427 Test Loss: 1.524 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5704731941223145
Epoch: 5, Steps: 8 | Train Loss: 1.039 Vali Loss: 1.539 Vali Acc: 0.435 Test Loss: 1.539 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.2868683338165283
Epoch: 6, Steps: 8 | Train Loss: 0.911 Vali Loss: 1.523 Vali Acc: 0.443 Test Loss: 1.523 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.489267349243164
Epoch: 7, Steps: 8 | Train Loss: 0.772 Vali Loss: 1.485 Vali Acc: 0.473 Test Loss: 1.485 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.4205272197723389
Epoch: 8, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.469 Vali Acc: 0.511 Test Loss: 1.469 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.4961299896240234
Epoch: 9, Steps: 8 | Train Loss: 0.542 Vali Loss: 1.464 Vali Acc: 0.511 Test Loss: 1.464 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.266324758529663
Epoch: 10, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 11 cost time: 1.338042974472046
Epoch: 11, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.392 Vali Acc: 0.542 Test Loss: 1.392 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541971).  Saving model ...
Epoch: 12 cost time: 1.3098955154418945
Epoch: 12, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.426 Vali Acc: 0.550 Test Loss: 1.426 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 13 cost time: 1.2737326622009277
Epoch: 13, Steps: 8 | Train Loss: 0.300 Vali Loss: 1.490 Vali Acc: 0.534 Test Loss: 1.490 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4051058292388916
Epoch: 14, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.422 Vali Acc: 0.542 Test Loss: 1.422 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3509712219238281
Epoch: 15, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.433 Vali Acc: 0.542 Test Loss: 1.433 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.620443344116211
Epoch: 16, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.455 Vali Acc: 0.542 Test Loss: 1.455 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3599298000335693
Epoch: 17, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.515 Vali Acc: 0.534 Test Loss: 1.515 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3571290969848633
Epoch: 18, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.516 Vali Acc: 0.527 Test Loss: 1.516 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4846415519714355
Epoch: 19, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.538 Vali Acc: 0.542 Test Loss: 1.538 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5203204154968262
Epoch: 20, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.593 Vali Acc: 0.534 Test Loss: 1.593 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.332505702972412
Epoch: 21, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.590 Vali Acc: 0.527 Test Loss: 1.590 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.595304012298584
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.574 Vali Acc: 0.534 Test Loss: 1.574 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 556165
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.19659161567688
Epoch: 1, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.603 Vali Acc: 0.191 Test Loss: 1.603 Test Acc: 0.191
Validation loss decreased (inf --> -0.190824).  Saving model ...
Epoch: 2 cost time: 1.6945524215698242
Epoch: 2, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.581 Vali Acc: 0.443 Test Loss: 1.581 Test Acc: 0.443
Validation loss decreased (-0.190824 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.863053321838379
Epoch: 3, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.028083562850952
Epoch: 4, Steps: 8 | Train Loss: 1.230 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2875826358795166
Epoch: 5, Steps: 8 | Train Loss: 1.072 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.852698564529419
Epoch: 6, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.503 Vali Acc: 0.427 Test Loss: 1.503 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8265204429626465
Epoch: 7, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.499 Vali Acc: 0.427 Test Loss: 1.499 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0644495487213135
Epoch: 8, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.500 Vali Acc: 0.420 Test Loss: 1.500 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8195877075195312
Epoch: 9, Steps: 8 | Train Loss: 0.647 Vali Loss: 1.488 Vali Acc: 0.420 Test Loss: 1.488 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4414775371551514
Epoch: 10, Steps: 8 | Train Loss: 0.556 Vali Loss: 1.491 Vali Acc: 0.435 Test Loss: 1.491 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4948484897613525
Epoch: 11, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.502 Vali Acc: 0.427 Test Loss: 1.502 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.17307186126709
Epoch: 12, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.483 Vali Acc: 0.450 Test Loss: 1.483 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450367).  Saving model ...
Epoch: 13 cost time: 1.8700854778289795
Epoch: 13, Steps: 8 | Train Loss: 0.368 Vali Loss: 1.474 Vali Acc: 0.450 Test Loss: 1.474 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450367).  Saving model ...
Epoch: 14 cost time: 1.6387255191802979
Epoch: 14, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.501 Vali Acc: 0.450 Test Loss: 1.501 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7362961769104004
Epoch: 15, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.506 Vali Acc: 0.450 Test Loss: 1.506 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1047439575195312
Epoch: 16, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.492 Vali Acc: 0.450 Test Loss: 1.492 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.795426368713379
Epoch: 17, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.498 Vali Acc: 0.450 Test Loss: 1.498 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8921160697937012
Epoch: 18, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.509 Vali Acc: 0.450 Test Loss: 1.509 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.71596360206604
Epoch: 19, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.515 Vali Acc: 0.466 Test Loss: 1.515 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 20 cost time: 1.7736260890960693
Epoch: 20, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.540 Vali Acc: 0.466 Test Loss: 1.540 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8872871398925781
Epoch: 21, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.525 Vali Acc: 0.481 Test Loss: 1.525 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 22 cost time: 2.0802559852600098
Epoch: 22, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.581 Vali Acc: 0.458 Test Loss: 1.581 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8318264484405518
Epoch: 23, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.560 Vali Acc: 0.458 Test Loss: 1.560 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1542046070098877
Epoch: 24, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.538 Vali Acc: 0.466 Test Loss: 1.538 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1438651084899902
Epoch: 25, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.542 Vali Acc: 0.458 Test Loss: 1.542 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.048241138458252
Epoch: 26, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.559 Vali Acc: 0.458 Test Loss: 1.559 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6565680503845215
Epoch: 27, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.543 Vali Acc: 0.458 Test Loss: 1.543 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7525379657745361
Epoch: 28, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.559 Vali Acc: 0.450 Test Loss: 1.559 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.082324266433716
Epoch: 29, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.607 Vali Acc: 0.450 Test Loss: 1.607 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6429157257080078
Epoch: 30, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.624 Vali Acc: 0.458 Test Loss: 1.624 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4850356578826904
Epoch: 31, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.593 Vali Acc: 0.450 Test Loss: 1.593 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 609861
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.959029197692871
Epoch: 1, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.554 Vali Acc: 0.412 Test Loss: 1.554 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.157942771911621
Epoch: 2, Steps: 8 | Train Loss: 1.445 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6656839847564697
Epoch: 3, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3688764572143555
Epoch: 4, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.511 Vali Acc: 0.427 Test Loss: 1.511 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.152118444442749
Epoch: 5, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.460 Vali Acc: 0.435 Test Loss: 1.460 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.4411661624908447
Epoch: 6, Steps: 8 | Train Loss: 0.827 Vali Loss: 1.449 Vali Acc: 0.443 Test Loss: 1.449 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442734).  Saving model ...
Epoch: 7 cost time: 1.688962459564209
Epoch: 7, Steps: 8 | Train Loss: 0.650 Vali Loss: 1.435 Vali Acc: 0.466 Test Loss: 1.435 Test Acc: 0.466
Validation loss decreased (-0.442734 --> -0.465635).  Saving model ...
Epoch: 8 cost time: 1.272174596786499
Epoch: 8, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.400 Vali Acc: 0.504 Test Loss: 1.400 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 1.4002857208251953
Epoch: 9, Steps: 8 | Train Loss: 0.364 Vali Loss: 1.389 Vali Acc: 0.511 Test Loss: 1.389 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.360440969467163
Epoch: 10, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.434 Vali Acc: 0.519 Test Loss: 1.434 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.4403173923492432
Epoch: 11, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.349 Vali Acc: 0.519 Test Loss: 1.349 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 1.3045854568481445
Epoch: 12, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.449 Vali Acc: 0.519 Test Loss: 1.449 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1524972915649414
Epoch: 13, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.400 Vali Acc: 0.527 Test Loss: 1.400 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.609062671661377
Epoch: 14, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.420 Vali Acc: 0.519 Test Loss: 1.420 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2583506107330322
Epoch: 15, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.527 Vali Acc: 0.519 Test Loss: 1.527 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1787962913513184
Epoch: 16, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.476 Vali Acc: 0.519 Test Loss: 1.476 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0002834796905518
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3374028205871582
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.476 Vali Acc: 0.527 Test Loss: 1.476 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2753663063049316
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.571 Vali Acc: 0.527 Test Loss: 1.571 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1442954540252686
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.526 Vali Acc: 0.534 Test Loss: 1.526 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534336).  Saving model ...
Epoch: 21 cost time: 1.1892235279083252
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.546 Vali Acc: 0.534 Test Loss: 1.546 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.340019941329956
Epoch: 22, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.630 Vali Acc: 0.519 Test Loss: 1.630 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.415440559387207
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.722 Vali Acc: 0.519 Test Loss: 1.722 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4391486644744873
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.765 Vali Acc: 0.527 Test Loss: 1.765 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3992068767547607
Epoch: 25, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.738 Vali Acc: 0.527 Test Loss: 1.738 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1815097332000732
Epoch: 26, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.806 Vali Acc: 0.519 Test Loss: 1.806 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3093109130859375
Epoch: 27, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.743 Vali Acc: 0.511 Test Loss: 1.743 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6414923667907715
Epoch: 28, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.649 Vali Acc: 0.527 Test Loss: 1.649 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0798001289367676
Epoch: 29, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.736 Vali Acc: 0.527 Test Loss: 1.736 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7389795780181885
Epoch: 30, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.818 Vali Acc: 0.519 Test Loss: 1.818 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 179045
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.903132677078247
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.577 Vali Acc: 0.366 Test Loss: 1.577 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 1.5715949535369873
Epoch: 2, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
Validation loss decreased (-0.366396 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6230103969573975
Epoch: 3, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.6952550411224365
Epoch: 4, Steps: 8 | Train Loss: 1.279 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.49188232421875
Epoch: 5, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.496 Vali Acc: 0.420 Test Loss: 1.496 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.8340096473693848
Epoch: 6, Steps: 8 | Train Loss: 1.051 Vali Loss: 1.479 Vali Acc: 0.427 Test Loss: 1.479 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.4849748611450195
Epoch: 7, Steps: 8 | Train Loss: 0.929 Vali Loss: 1.441 Vali Acc: 0.435 Test Loss: 1.441 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 8 cost time: 1.5248525142669678
Epoch: 8, Steps: 8 | Train Loss: 0.803 Vali Loss: 1.434 Vali Acc: 0.450 Test Loss: 1.434 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 1.5067188739776611
Epoch: 9, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.407 Vali Acc: 0.473 Test Loss: 1.407 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 10 cost time: 1.5848066806793213
Epoch: 10, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.396 Vali Acc: 0.489 Test Loss: 1.396 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 11 cost time: 1.324291706085205
Epoch: 11, Steps: 8 | Train Loss: 0.452 Vali Loss: 1.373 Vali Acc: 0.511 Test Loss: 1.373 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511437).  Saving model ...
Epoch: 12 cost time: 1.4994864463806152
Epoch: 12, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.415 Vali Acc: 0.504 Test Loss: 1.415 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.634455680847168
Epoch: 13, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.3491432666778564
Epoch: 14, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.367 Vali Acc: 0.527 Test Loss: 1.367 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 15 cost time: 1.8042922019958496
Epoch: 15, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4825177192687988
Epoch: 16, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6176133155822754
Epoch: 17, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 18 cost time: 1.3940300941467285
Epoch: 18, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4709644317626953
Epoch: 19, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.542 Vali Acc: 0.527 Test Loss: 1.542 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7632884979248047
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.488 Vali Acc: 0.542 Test Loss: 1.488 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 21 cost time: 1.8279945850372314
Epoch: 21, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.482 Vali Acc: 0.542 Test Loss: 1.482 Test Acc: 0.542
Validation loss decreased (-0.541970 --> -0.541970).  Saving model ...
Epoch: 22 cost time: 1.657470941543579
Epoch: 22, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.516 Vali Acc: 0.542 Test Loss: 1.516 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3117656707763672
Epoch: 23, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.539 Vali Acc: 0.542 Test Loss: 1.539 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6283576488494873
Epoch: 24, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.507 Vali Acc: 0.542 Test Loss: 1.507 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.045900821685791
Epoch: 25, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.525 Vali Acc: 0.542 Test Loss: 1.525 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4950852394104004
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.566 Vali Acc: 0.542 Test Loss: 1.566 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8718500137329102
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.552 Vali Acc: 0.542 Test Loss: 1.552 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.603057622909546
Epoch: 28, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.634 Vali Acc: 0.542 Test Loss: 1.634 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3742024898529053
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.721 Vali Acc: 0.542 Test Loss: 1.721 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4204378128051758
Epoch: 30, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.861 Vali Acc: 0.542 Test Loss: 1.861 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6110413074493408
Epoch: 31, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.783 Vali Acc: 0.550 Test Loss: 1.783 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549600).  Saving model ...
Epoch: 32 cost time: 1.2219226360321045
Epoch: 32, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.654 Vali Acc: 0.550 Test Loss: 1.654 Test Acc: 0.550
Validation loss decreased (-0.549600 --> -0.549602).  Saving model ...
Epoch: 33 cost time: 1.3007457256317139
Epoch: 33, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.667 Vali Acc: 0.542 Test Loss: 1.667 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1513988971710205
Epoch: 34, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.872 Vali Acc: 0.550 Test Loss: 1.872 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3789560794830322
Epoch: 35, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.684 Vali Acc: 0.550 Test Loss: 1.684 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3217363357543945
Epoch: 36, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.625 Vali Acc: 0.550 Test Loss: 1.625 Test Acc: 0.550
Validation loss decreased (-0.549602 --> -0.549602).  Saving model ...
Epoch: 37 cost time: 1.193483591079712
Epoch: 37, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.728 Vali Acc: 0.550 Test Loss: 1.728 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6277720928192139
Epoch: 38, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.809 Vali Acc: 0.542 Test Loss: 1.809 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7692174911499023
Epoch: 39, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.746 Vali Acc: 0.542 Test Loss: 1.746 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.433328628540039
Epoch: 40, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.841 Vali Acc: 0.550 Test Loss: 1.841 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4111824035644531
Epoch: 41, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.838 Vali Acc: 0.542 Test Loss: 1.838 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4413177967071533
Epoch: 42, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.841 Vali Acc: 0.550 Test Loss: 1.841 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.574979305267334
Epoch: 43, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.837 Vali Acc: 0.550 Test Loss: 1.837 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.5583622455596924
Epoch: 44, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.985 Vali Acc: 0.542 Test Loss: 1.985 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.5438868999481201
Epoch: 45, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.978 Vali Acc: 0.534 Test Loss: 1.978 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4199326038360596
Epoch: 46, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.028 Vali Acc: 0.534 Test Loss: 2.028 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 155045
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.08447265625
Epoch: 1, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.597 Vali Acc: 0.260 Test Loss: 1.597 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.237823486328125
Epoch: 2, Steps: 8 | Train Loss: 1.514 Vali Loss: 1.563 Vali Acc: 0.412 Test Loss: 1.563 Test Acc: 0.412
Validation loss decreased (-0.259526 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.4260096549987793
Epoch: 3, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.2130601406097412
Epoch: 4, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3210992813110352
Epoch: 5, Steps: 8 | Train Loss: 1.219 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1326103210449219
Epoch: 6, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.200277328491211
Epoch: 7, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.7612922191619873
Epoch: 8, Steps: 8 | Train Loss: 0.920 Vali Loss: 1.479 Vali Acc: 0.443 Test Loss: 1.479 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.4485671520233154
Epoch: 9, Steps: 8 | Train Loss: 0.817 Vali Loss: 1.460 Vali Acc: 0.450 Test Loss: 1.460 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 1.2496306896209717
Epoch: 10, Steps: 8 | Train Loss: 0.722 Vali Loss: 1.446 Vali Acc: 0.458 Test Loss: 1.446 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 11 cost time: 1.1454484462738037
Epoch: 11, Steps: 8 | Train Loss: 0.586 Vali Loss: 1.417 Vali Acc: 0.496 Test Loss: 1.417 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 1.3186547756195068
Epoch: 12, Steps: 8 | Train Loss: 0.531 Vali Loss: 1.427 Vali Acc: 0.504 Test Loss: 1.427 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 13 cost time: 1.2369797229766846
Epoch: 13, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.368 Vali Acc: 0.504 Test Loss: 1.368 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 14 cost time: 1.4992549419403076
Epoch: 14, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.408 Vali Acc: 0.519 Test Loss: 1.408 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.3741538524627686
Epoch: 15, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.332 Vali Acc: 0.542 Test Loss: 1.332 Test Acc: 0.542
Validation loss decreased (-0.519070 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.3064496517181396
Epoch: 16, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0402908325195312
Epoch: 17, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.375 Vali Acc: 0.534 Test Loss: 1.375 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3277723789215088
Epoch: 18, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.366 Vali Acc: 0.542 Test Loss: 1.366 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3334674835205078
Epoch: 19, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.393 Vali Acc: 0.534 Test Loss: 1.393 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2642369270324707
Epoch: 20, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.392 Vali Acc: 0.534 Test Loss: 1.392 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3052542209625244
Epoch: 21, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.434 Vali Acc: 0.534 Test Loss: 1.434 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3129034042358398
Epoch: 22, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.418 Vali Acc: 0.542 Test Loss: 1.418 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1818466186523438
Epoch: 23, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.410 Vali Acc: 0.550 Test Loss: 1.410 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 24 cost time: 1.1725513935089111
Epoch: 24, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.426 Vali Acc: 0.534 Test Loss: 1.426 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3910422325134277
Epoch: 25, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.397 Vali Acc: 0.542 Test Loss: 1.397 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3567352294921875
Epoch: 26, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.407 Vali Acc: 0.542 Test Loss: 1.407 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.540463924407959
Epoch: 27, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.436 Vali Acc: 0.542 Test Loss: 1.436 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3550264835357666
Epoch: 28, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.456 Vali Acc: 0.550 Test Loss: 1.456 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.466381311416626
Epoch: 29, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.423 Vali Acc: 0.542 Test Loss: 1.423 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6945888996124268
Epoch: 30, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.497 Vali Acc: 0.565 Test Loss: 1.497 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564871).  Saving model ...
Epoch: 31 cost time: 1.3746528625488281
Epoch: 31, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.532 Vali Acc: 0.527 Test Loss: 1.532 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3626773357391357
Epoch: 32, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.429715633392334
Epoch: 33, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.476 Vali Acc: 0.519 Test Loss: 1.476 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4100925922393799
Epoch: 34, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.518 Vali Acc: 0.542 Test Loss: 1.518 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.514958381652832
Epoch: 35, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.528 Vali Acc: 0.557 Test Loss: 1.528 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6962461471557617
Epoch: 36, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.457 Vali Acc: 0.534 Test Loss: 1.457 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4948439598083496
Epoch: 37, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.457 Vali Acc: 0.542 Test Loss: 1.457 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1499583721160889
Epoch: 38, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.527 Vali Acc: 0.557 Test Loss: 1.527 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1417336463928223
Epoch: 39, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.570 Vali Acc: 0.534 Test Loss: 1.570 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.425215244293213
Epoch: 40, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.577 Vali Acc: 0.534 Test Loss: 1.577 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 155973
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.003467798233032
Epoch: 1, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.604 Vali Acc: 0.260 Test Loss: 1.604 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.824984073638916
Epoch: 2, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.575 Vali Acc: 0.435 Test Loss: 1.575 Test Acc: 0.435
Validation loss decreased (-0.259526 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.6923179626464844
Epoch: 3, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8720548152923584
Epoch: 4, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4230701923370361
Epoch: 5, Steps: 8 | Train Loss: 1.204 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.558135986328125
Epoch: 6, Steps: 8 | Train Loss: 1.126 Vali Loss: 1.509 Vali Acc: 0.427 Test Loss: 1.509 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9778351783752441
Epoch: 7, Steps: 8 | Train Loss: 1.002 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6195178031921387
Epoch: 8, Steps: 8 | Train Loss: 0.923 Vali Loss: 1.474 Vali Acc: 0.450 Test Loss: 1.474 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 1.4642231464385986
Epoch: 9, Steps: 8 | Train Loss: 0.813 Vali Loss: 1.451 Vali Acc: 0.473 Test Loss: 1.451 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 10 cost time: 1.4203262329101562
Epoch: 10, Steps: 8 | Train Loss: 0.707 Vali Loss: 1.434 Vali Acc: 0.504 Test Loss: 1.434 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.3385796546936035
Epoch: 11, Steps: 8 | Train Loss: 0.642 Vali Loss: 1.403 Vali Acc: 0.511 Test Loss: 1.403 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.4527671337127686
Epoch: 12, Steps: 8 | Train Loss: 0.543 Vali Loss: 1.394 Vali Acc: 0.504 Test Loss: 1.394 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5711987018585205
Epoch: 13, Steps: 8 | Train Loss: 0.457 Vali Loss: 1.395 Vali Acc: 0.519 Test Loss: 1.395 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.6614787578582764
Epoch: 14, Steps: 8 | Train Loss: 0.418 Vali Loss: 1.377 Vali Acc: 0.519 Test Loss: 1.377 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.6573350429534912
Epoch: 15, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.257 Vali Acc: 0.580 Test Loss: 1.257 Test Acc: 0.580
Validation loss decreased (-0.519070 --> -0.580140).  Saving model ...
Epoch: 16 cost time: 1.3122828006744385
Epoch: 16, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.318 Vali Acc: 0.550 Test Loss: 1.318 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5221240520477295
Epoch: 17, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.317 Vali Acc: 0.550 Test Loss: 1.317 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8143067359924316
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.294 Vali Acc: 0.565 Test Loss: 1.294 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5900623798370361
Epoch: 19, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.324 Vali Acc: 0.550 Test Loss: 1.324 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7329959869384766
Epoch: 20, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.296 Vali Acc: 0.565 Test Loss: 1.296 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6270971298217773
Epoch: 21, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.318 Vali Acc: 0.565 Test Loss: 1.318 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4573726654052734
Epoch: 22, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.348 Vali Acc: 0.565 Test Loss: 1.348 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.870044469833374
Epoch: 23, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.333 Vali Acc: 0.565 Test Loss: 1.333 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8578040599822998
Epoch: 24, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.325 Vali Acc: 0.565 Test Loss: 1.325 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5185179710388184
Epoch: 25, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.354 Vali Acc: 0.550 Test Loss: 1.354 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 164613
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2997491359710693
Epoch: 1, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.589 Vali Acc: 0.397 Test Loss: 1.589 Test Acc: 0.397
Validation loss decreased (inf --> -0.396931).  Saving model ...
Epoch: 2 cost time: 1.39129638671875
Epoch: 2, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.567 Vali Acc: 0.443 Test Loss: 1.567 Test Acc: 0.443
Validation loss decreased (-0.396931 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.3112876415252686
Epoch: 3, Steps: 8 | Train Loss: 1.465 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.330256700515747
Epoch: 4, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4186103343963623
Epoch: 5, Steps: 8 | Train Loss: 1.275 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.329723596572876
Epoch: 6, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2236511707305908
Epoch: 7, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.502 Vali Acc: 0.420 Test Loss: 1.502 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3037059307098389
Epoch: 8, Steps: 8 | Train Loss: 0.995 Vali Loss: 1.494 Vali Acc: 0.420 Test Loss: 1.494 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.412381887435913
Epoch: 9, Steps: 8 | Train Loss: 0.914 Vali Loss: 1.487 Vali Acc: 0.435 Test Loss: 1.487 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.280240774154663
Epoch: 10, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.481 Vali Acc: 0.450 Test Loss: 1.481 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 1.454772710800171
Epoch: 11, Steps: 8 | Train Loss: 0.764 Vali Loss: 1.458 Vali Acc: 0.458 Test Loss: 1.458 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 12 cost time: 1.0790610313415527
Epoch: 12, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.456 Vali Acc: 0.450 Test Loss: 1.456 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.222771167755127
Epoch: 13, Steps: 8 | Train Loss: 0.642 Vali Loss: 1.452 Vali Acc: 0.466 Test Loss: 1.452 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 14 cost time: 1.3114471435546875
Epoch: 14, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.451 Vali Acc: 0.473 Test Loss: 1.451 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 15 cost time: 1.1868579387664795
Epoch: 15, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.431 Vali Acc: 0.466 Test Loss: 1.431 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1007061004638672
Epoch: 16, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.420 Vali Acc: 0.466 Test Loss: 1.420 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.494446039199829
Epoch: 17, Steps: 8 | Train Loss: 0.471 Vali Loss: 1.405 Vali Acc: 0.481 Test Loss: 1.405 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 18 cost time: 1.3162672519683838
Epoch: 18, Steps: 8 | Train Loss: 0.425 Vali Loss: 1.453 Vali Acc: 0.489 Test Loss: 1.453 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 19 cost time: 1.3246033191680908
Epoch: 19, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.460 Vali Acc: 0.489 Test Loss: 1.460 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0738224983215332
Epoch: 20, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.442 Vali Acc: 0.489 Test Loss: 1.442 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 21 cost time: 0.9930384159088135
Epoch: 21, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.434 Vali Acc: 0.481 Test Loss: 1.434 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1488776206970215
Epoch: 22, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.448 Vali Acc: 0.496 Test Loss: 1.448 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 23 cost time: 1.1785316467285156
Epoch: 23, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.431 Vali Acc: 0.511 Test Loss: 1.431 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 24 cost time: 1.104966163635254
Epoch: 24, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.425 Vali Acc: 0.489 Test Loss: 1.425 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.285707950592041
Epoch: 25, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.410 Vali Acc: 0.534 Test Loss: 1.410 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534337).  Saving model ...
Epoch: 26 cost time: 1.2870469093322754
Epoch: 26, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.461 Vali Acc: 0.519 Test Loss: 1.461 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1251189708709717
Epoch: 27, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2073750495910645
Epoch: 28, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.461 Vali Acc: 0.527 Test Loss: 1.461 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7016291618347168
Epoch: 29, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4229819774627686
Epoch: 30, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.471 Vali Acc: 0.511 Test Loss: 1.471 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2620549201965332
Epoch: 31, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.499 Vali Acc: 0.496 Test Loss: 1.499 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3056085109710693
Epoch: 32, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.460 Vali Acc: 0.511 Test Loss: 1.460 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.63161039352417
Epoch: 33, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.449 Vali Acc: 0.511 Test Loss: 1.449 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4970762729644775
Epoch: 34, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.412 Vali Acc: 0.534 Test Loss: 1.412 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4194045066833496
Epoch: 35, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.484 Vali Acc: 0.511 Test Loss: 1.484 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 187621
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4059839248657227
Epoch: 1, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.626 Vali Acc: 0.183 Test Loss: 1.626 Test Acc: 0.183
Validation loss decreased (inf --> -0.183190).  Saving model ...
Epoch: 2 cost time: 1.3910553455352783
Epoch: 2, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.607 Vali Acc: 0.221 Test Loss: 1.607 Test Acc: 0.221
Validation loss decreased (-0.183190 --> -0.221358).  Saving model ...
Epoch: 3 cost time: 1.1186397075653076
Epoch: 3, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.586 Vali Acc: 0.336 Test Loss: 1.586 Test Acc: 0.336
Validation loss decreased (-0.221358 --> -0.335862).  Saving model ...
Epoch: 4 cost time: 1.1829917430877686
Epoch: 4, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.335862 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.517885684967041
Epoch: 5, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.62349271774292
Epoch: 6, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.503 Vali Acc: 0.435 Test Loss: 1.503 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 1.385551929473877
Epoch: 7, Steps: 8 | Train Loss: 1.002 Vali Loss: 1.491 Vali Acc: 0.450 Test Loss: 1.491 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.2557544708251953
Epoch: 8, Steps: 8 | Train Loss: 0.901 Vali Loss: 1.491 Vali Acc: 0.450 Test Loss: 1.491 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 1.4960331916809082
Epoch: 9, Steps: 8 | Train Loss: 0.839 Vali Loss: 1.469 Vali Acc: 0.481 Test Loss: 1.469 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.4549763202667236
Epoch: 10, Steps: 8 | Train Loss: 0.725 Vali Loss: 1.466 Vali Acc: 0.481 Test Loss: 1.466 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 1.4829332828521729
Epoch: 11, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.470 Vali Acc: 0.489 Test Loss: 1.470 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 12 cost time: 1.5233490467071533
Epoch: 12, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.469 Vali Acc: 0.496 Test Loss: 1.469 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 13 cost time: 1.3903543949127197
Epoch: 13, Steps: 8 | Train Loss: 0.527 Vali Loss: 1.436 Vali Acc: 0.504 Test Loss: 1.436 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 14 cost time: 1.3200547695159912
Epoch: 14, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.452 Vali Acc: 0.511 Test Loss: 1.452 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 15 cost time: 1.4292035102844238
Epoch: 15, Steps: 8 | Train Loss: 0.452 Vali Loss: 1.494 Vali Acc: 0.511 Test Loss: 1.494 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3159589767456055
Epoch: 16, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.446 Vali Acc: 0.527 Test Loss: 1.446 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 17 cost time: 1.8164818286895752
Epoch: 17, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.413 Vali Acc: 0.519 Test Loss: 1.413 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5320067405700684
Epoch: 18, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.444 Vali Acc: 0.519 Test Loss: 1.444 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.431635856628418
Epoch: 19, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.453 Vali Acc: 0.519 Test Loss: 1.453 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2954223155975342
Epoch: 20, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6636428833007812
Epoch: 21, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6739096641540527
Epoch: 22, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.276207685470581
Epoch: 23, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.476872205734253
Epoch: 24, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.486053228378296
Epoch: 25, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.511 Vali Acc: 0.504 Test Loss: 1.511 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4006998538970947
Epoch: 26, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.536 Vali Acc: 0.511 Test Loss: 1.536 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 212549
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3203673362731934
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.632 Vali Acc: 0.115 Test Loss: 1.632 Test Acc: 0.115
Validation loss decreased (inf --> -0.114487).  Saving model ...
Epoch: 2 cost time: 1.3800199031829834
Epoch: 2, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.608 Vali Acc: 0.260 Test Loss: 1.608 Test Acc: 0.260
Validation loss decreased (-0.114487 --> -0.259526).  Saving model ...
Epoch: 3 cost time: 1.42891263961792
Epoch: 3, Steps: 8 | Train Loss: 1.445 Vali Loss: 1.585 Vali Acc: 0.405 Test Loss: 1.585 Test Acc: 0.405
Validation loss decreased (-0.259526 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 1.4491138458251953
Epoch: 4, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.569 Vali Acc: 0.427 Test Loss: 1.569 Test Acc: 0.427
Validation loss decreased (-0.404564 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.3361461162567139
Epoch: 5, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.546 Vali Acc: 0.427 Test Loss: 1.546 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 1.211923360824585
Epoch: 6, Steps: 8 | Train Loss: 1.161 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2782657146453857
Epoch: 7, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1688933372497559
Epoch: 8, Steps: 8 | Train Loss: 0.983 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4288575649261475
Epoch: 9, Steps: 8 | Train Loss: 0.928 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.430917501449585
Epoch: 10, Steps: 8 | Train Loss: 0.865 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1584115028381348
Epoch: 11, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.521 Vali Acc: 0.427 Test Loss: 1.521 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 12 cost time: 1.1504595279693604
Epoch: 12, Steps: 8 | Train Loss: 0.712 Vali Loss: 1.514 Vali Acc: 0.443 Test Loss: 1.514 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 13 cost time: 1.189227819442749
Epoch: 13, Steps: 8 | Train Loss: 0.687 Vali Loss: 1.511 Vali Acc: 0.458 Test Loss: 1.511 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 14 cost time: 1.4599602222442627
Epoch: 14, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.497 Vali Acc: 0.466 Test Loss: 1.497 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 15 cost time: 1.4878287315368652
Epoch: 15, Steps: 8 | Train Loss: 0.562 Vali Loss: 1.523 Vali Acc: 0.450 Test Loss: 1.523 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.161585807800293
Epoch: 16, Steps: 8 | Train Loss: 0.542 Vali Loss: 1.518 Vali Acc: 0.466 Test Loss: 1.518 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6832761764526367
Epoch: 17, Steps: 8 | Train Loss: 0.511 Vali Loss: 1.540 Vali Acc: 0.458 Test Loss: 1.540 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.684739589691162
Epoch: 18, Steps: 8 | Train Loss: 0.444 Vali Loss: 1.504 Vali Acc: 0.458 Test Loss: 1.504 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3757398128509521
Epoch: 19, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488534).  Saving model ...
Epoch: 20 cost time: 1.1855530738830566
Epoch: 20, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.507 Vali Acc: 0.489 Test Loss: 1.507 Test Acc: 0.489
Validation loss decreased (-0.488534 --> -0.488535).  Saving model ...
Epoch: 21 cost time: 1.277867078781128
Epoch: 21, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.531 Vali Acc: 0.473 Test Loss: 1.531 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4418668746948242
Epoch: 22, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.488 Vali Acc: 0.496 Test Loss: 1.488 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 23 cost time: 1.5182106494903564
Epoch: 23, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.520 Vali Acc: 0.473 Test Loss: 1.520 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3994405269622803
Epoch: 24, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.545 Vali Acc: 0.466 Test Loss: 1.545 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1749777793884277
Epoch: 25, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.549 Vali Acc: 0.473 Test Loss: 1.549 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.711338996887207
Epoch: 26, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.549 Vali Acc: 0.466 Test Loss: 1.549 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2981679439544678
Epoch: 27, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.575 Vali Acc: 0.458 Test Loss: 1.575 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1471376419067383
Epoch: 28, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.544 Vali Acc: 0.458 Test Loss: 1.544 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.286083459854126
Epoch: 29, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.526 Vali Acc: 0.458 Test Loss: 1.526 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2820169925689697
Epoch: 30, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.567 Vali Acc: 0.466 Test Loss: 1.567 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.173802137374878
Epoch: 31, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.572 Vali Acc: 0.458 Test Loss: 1.572 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4309310913085938
Epoch: 32, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.588 Vali Acc: 0.458 Test Loss: 1.588 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 239397
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6677029132843018
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.511 Vali Acc: 0.427 Test Loss: 1.511 Test Acc: 0.427
Validation loss decreased (inf --> -0.427466).  Saving model ...
Epoch: 2 cost time: 1.3254735469818115
Epoch: 2, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.567 Vali Acc: 0.420 Test Loss: 1.567 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4758946895599365
Epoch: 3, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.464 Vali Acc: 0.435 Test Loss: 1.464 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.4606430530548096
Epoch: 4, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.378 Vali Acc: 0.473 Test Loss: 1.378 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473269).  Saving model ...
Epoch: 5 cost time: 1.2777159214019775
Epoch: 5, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.515 Vali Acc: 0.519 Test Loss: 1.515 Test Acc: 0.519
Validation loss decreased (-0.473269 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.3359596729278564
Epoch: 6, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.507 Vali Acc: 0.511 Test Loss: 1.507 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5351853370666504
Epoch: 7, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.512 Vali Acc: 0.542 Test Loss: 1.512 Test Acc: 0.542
Validation loss decreased (-0.519069 --> -0.541970).  Saving model ...
Epoch: 8 cost time: 1.6480250358581543
Epoch: 8, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.774 Vali Acc: 0.527 Test Loss: 1.774 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1982197761535645
Epoch: 9, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.384 Vali Acc: 0.550 Test Loss: 1.384 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549604).  Saving model ...
Epoch: 10 cost time: 1.2618687152862549
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.750 Vali Acc: 0.565 Test Loss: 1.750 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564868).  Saving model ...
Epoch: 11 cost time: 1.7974886894226074
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.868 Vali Acc: 0.550 Test Loss: 1.868 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.588453769683838
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.630 Vali Acc: 0.542 Test Loss: 1.630 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3872487545013428
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.900 Vali Acc: 0.527 Test Loss: 1.900 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4101150035858154
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.380 Vali Acc: 0.527 Test Loss: 2.380 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.750584363937378
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.548 Vali Acc: 0.527 Test Loss: 2.548 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6674797534942627
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.166 Vali Acc: 0.527 Test Loss: 2.166 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4438018798828125
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.152 Vali Acc: 0.542 Test Loss: 2.152 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.513401746749878
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.195 Vali Acc: 0.534 Test Loss: 2.195 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3055424690246582
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.340 Vali Acc: 0.519 Test Loss: 2.340 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4482417106628418
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.654 Vali Acc: 0.527 Test Loss: 2.654 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1493381
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7355926036834717
Epoch: 1, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6647617816925049
Epoch: 2, Steps: 8 | Train Loss: 1.370 Vali Loss: 1.643 Vali Acc: 0.420 Test Loss: 1.643 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3813221454620361
Epoch: 3, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.4235873222351074
Epoch: 4, Steps: 8 | Train Loss: 0.846 Vali Loss: 1.447 Vali Acc: 0.443 Test Loss: 1.447 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442734).  Saving model ...
Epoch: 5 cost time: 1.5208168029785156
Epoch: 5, Steps: 8 | Train Loss: 0.624 Vali Loss: 1.490 Vali Acc: 0.443 Test Loss: 1.490 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.109368085861206
Epoch: 6, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.421 Vali Acc: 0.496 Test Loss: 1.421 Test Acc: 0.496
Validation loss decreased (-0.442734 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.4048211574554443
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.497 Vali Acc: 0.534 Test Loss: 1.497 Test Acc: 0.534
Validation loss decreased (-0.496169 --> -0.534336).  Saving model ...
Epoch: 8 cost time: 1.4316282272338867
Epoch: 8, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.457 Vali Acc: 0.527 Test Loss: 1.457 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4290387630462646
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.438 Vali Acc: 0.527 Test Loss: 1.438 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2859609127044678
Epoch: 10, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.399 Vali Acc: 0.534 Test Loss: 1.399 Test Acc: 0.534
Validation loss decreased (-0.534336 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 1.2854256629943848
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.526 Vali Acc: 0.527 Test Loss: 1.526 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6145219802856445
Epoch: 12, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6838946342468262
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.609 Vali Acc: 0.511 Test Loss: 1.609 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6678862571716309
Epoch: 14, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.782 Vali Acc: 0.519 Test Loss: 1.782 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7121577262878418
Epoch: 15, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.682 Vali Acc: 0.534 Test Loss: 1.682 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4567596912384033
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.849 Vali Acc: 0.527 Test Loss: 1.849 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.49776029586792
Epoch: 17, Steps: 8 | Train Loss: 0.031 Vali Loss: 2.036 Vali Acc: 0.519 Test Loss: 2.036 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2516047954559326
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.795 Vali Acc: 0.519 Test Loss: 1.795 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4002723693847656
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.626 Vali Acc: 0.527 Test Loss: 1.626 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4909563064575195
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.570 Vali Acc: 0.511 Test Loss: 1.570 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1397381
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4146342277526855
Epoch: 1, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.559 Vali Acc: 0.420 Test Loss: 1.559 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.253666877746582
Epoch: 2, Steps: 8 | Train Loss: 1.446 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.3300845623016357
Epoch: 3, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.2098462581634521
Epoch: 4, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.499 Vali Acc: 0.427 Test Loss: 1.499 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.6314904689788818
Epoch: 5, Steps: 8 | Train Loss: 0.744 Vali Loss: 1.454 Vali Acc: 0.435 Test Loss: 1.454 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.430328130722046
Epoch: 6, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.426 Vali Acc: 0.481 Test Loss: 1.426 Test Acc: 0.481
Validation loss decreased (-0.435100 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 1.3498625755310059
Epoch: 7, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.419 Vali Acc: 0.511 Test Loss: 1.419 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.7183935642242432
Epoch: 8, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.450 Vali Acc: 0.504 Test Loss: 1.450 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6056733131408691
Epoch: 9, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 10 cost time: 1.4477858543395996
Epoch: 10, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.0985538959503174
Epoch: 11, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.469 Vali Acc: 0.534 Test Loss: 1.469 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534336).  Saving model ...
Epoch: 12 cost time: 1.3435821533203125
Epoch: 12, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.361 Vali Acc: 0.550 Test Loss: 1.361 Test Acc: 0.550
Validation loss decreased (-0.534336 --> -0.549605).  Saving model ...
Epoch: 13 cost time: 1.2808387279510498
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4281551837921143
Epoch: 14, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.383 Vali Acc: 0.534 Test Loss: 1.383 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3938746452331543
Epoch: 15, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.280 Vali Acc: 0.542 Test Loss: 1.280 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4075336456298828
Epoch: 16, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.417 Vali Acc: 0.534 Test Loss: 1.417 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5606355667114258
Epoch: 17, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.526 Vali Acc: 0.542 Test Loss: 1.526 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4664814472198486
Epoch: 18, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.524 Vali Acc: 0.557 Test Loss: 1.524 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557237).  Saving model ...
Epoch: 19 cost time: 1.556065559387207
Epoch: 19, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.576 Vali Acc: 0.542 Test Loss: 1.576 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2252306938171387
Epoch: 20, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.583 Vali Acc: 0.542 Test Loss: 1.583 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.539613962173462
Epoch: 21, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.545 Vali Acc: 0.550 Test Loss: 1.545 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2750937938690186
Epoch: 22, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.579 Vali Acc: 0.557 Test Loss: 1.579 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4283838272094727
Epoch: 23, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.903 Vali Acc: 0.542 Test Loss: 1.903 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4191622734069824
Epoch: 24, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.691 Vali Acc: 0.557 Test Loss: 1.691 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2679383754730225
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.644 Vali Acc: 0.557 Test Loss: 1.644 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.222665786743164
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.825 Vali Acc: 0.588 Test Loss: 1.825 Test Acc: 0.588
Validation loss decreased (-0.557237 --> -0.587768).  Saving model ...
Epoch: 27 cost time: 1.2864782810211182
Epoch: 27, Steps: 8 | Train Loss: 0.024 Vali Loss: 2.214 Vali Acc: 0.527 Test Loss: 2.214 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5504803657531738
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.651 Vali Acc: 0.588 Test Loss: 1.651 Test Acc: 0.588
Validation loss decreased (-0.587768 --> -0.587770).  Saving model ...
Epoch: 29 cost time: 1.4014382362365723
Epoch: 29, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.847 Vali Acc: 0.565 Test Loss: 1.847 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3249497413635254
Epoch: 30, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.820 Vali Acc: 0.595 Test Loss: 1.820 Test Acc: 0.595
Validation loss decreased (-0.587770 --> -0.595402).  Saving model ...
Epoch: 31 cost time: 1.4080817699432373
Epoch: 31, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.884 Vali Acc: 0.573 Test Loss: 1.884 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.600158929824829
Epoch: 32, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.984 Vali Acc: 0.565 Test Loss: 1.984 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5488691329956055
Epoch: 33, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.837 Vali Acc: 0.557 Test Loss: 1.837 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2470741271972656
Epoch: 34, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.857 Vali Acc: 0.557 Test Loss: 1.857 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6606147289276123
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.081 Vali Acc: 0.550 Test Loss: 2.081 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4007487297058105
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.357 Vali Acc: 0.557 Test Loss: 2.357 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.522519588470459
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.549 Vali Acc: 0.557 Test Loss: 2.549 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2354552745819092
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.608 Vali Acc: 0.565 Test Loss: 2.608 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2049283981323242
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.665 Vali Acc: 0.557 Test Loss: 2.665 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4071426391601562
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.738 Vali Acc: 0.550 Test Loss: 2.738 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 1401093
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.404930830001831
Epoch: 1, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.578 Vali Acc: 0.412 Test Loss: 1.578 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.5911297798156738
Epoch: 2, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.7251884937286377
Epoch: 3, Steps: 8 | Train Loss: 1.207 Vali Loss: 1.569 Vali Acc: 0.420 Test Loss: 1.569 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.303847074508667
Epoch: 4, Steps: 8 | Train Loss: 0.988 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.4076480865478516
Epoch: 5, Steps: 8 | Train Loss: 0.724 Vali Loss: 1.487 Vali Acc: 0.481 Test Loss: 1.487 Test Acc: 0.481
Validation loss decreased (-0.427466 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.3626413345336914
Epoch: 6, Steps: 8 | Train Loss: 0.565 Vali Loss: 1.442 Vali Acc: 0.489 Test Loss: 1.442 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.5838630199432373
Epoch: 7, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.424 Vali Acc: 0.504 Test Loss: 1.424 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.6351344585418701
Epoch: 8, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.417 Vali Acc: 0.519 Test Loss: 1.417 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.4118797779083252
Epoch: 9, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.498 Vali Acc: 0.519 Test Loss: 1.498 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3604354858398438
Epoch: 10, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.476 Vali Acc: 0.519 Test Loss: 1.476 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.312239170074463
Epoch: 11, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.359 Vali Acc: 0.534 Test Loss: 1.359 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534338).  Saving model ...
Epoch: 12 cost time: 1.5870912075042725
Epoch: 12, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.447 Vali Acc: 0.534 Test Loss: 1.447 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4540183544158936
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.486 Vali Acc: 0.534 Test Loss: 1.486 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4166371822357178
Epoch: 14, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.600 Vali Acc: 0.527 Test Loss: 1.600 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9981694221496582
Epoch: 15, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.461 Vali Acc: 0.557 Test Loss: 1.461 Test Acc: 0.557
Validation loss decreased (-0.534338 --> -0.557237).  Saving model ...
Epoch: 16 cost time: 1.371049404144287
Epoch: 16, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.448 Vali Acc: 0.557 Test Loss: 1.448 Test Acc: 0.557
Validation loss decreased (-0.557237 --> -0.557237).  Saving model ...
Epoch: 17 cost time: 1.5194785594940186
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.477 Vali Acc: 0.550 Test Loss: 1.477 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6205170154571533
Epoch: 18, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.630 Vali Acc: 0.534 Test Loss: 1.630 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7137722969055176
Epoch: 19, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.675 Vali Acc: 0.542 Test Loss: 1.675 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5366101264953613
Epoch: 20, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.530714511871338
Epoch: 21, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.601 Vali Acc: 0.534 Test Loss: 1.601 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5626182556152344
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.519 Vali Acc: 0.511 Test Loss: 1.519 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6077842712402344
Epoch: 23, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.568 Vali Acc: 0.511 Test Loss: 1.568 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4792301654815674
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.810 Vali Acc: 0.527 Test Loss: 1.810 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.285752534866333
Epoch: 25, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.750 Vali Acc: 0.534 Test Loss: 1.750 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4223051071166992
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.653 Vali Acc: 0.550 Test Loss: 1.653 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 1435653
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7221736907958984
Epoch: 1, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.9112319946289062
Epoch: 2, Steps: 8 | Train Loss: 1.474 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.3655116558074951
Epoch: 3, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3997023105621338
Epoch: 4, Steps: 8 | Train Loss: 1.071 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3253402709960938
Epoch: 5, Steps: 8 | Train Loss: 0.852 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.5096533298492432
Epoch: 6, Steps: 8 | Train Loss: 0.700 Vali Loss: 1.494 Vali Acc: 0.435 Test Loss: 1.494 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 1.2132229804992676
Epoch: 7, Steps: 8 | Train Loss: 0.607 Vali Loss: 1.532 Vali Acc: 0.466 Test Loss: 1.532 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.4017307758331299
Epoch: 8, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 9 cost time: 1.2974083423614502
Epoch: 9, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.523 Vali Acc: 0.481 Test Loss: 1.523 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.461869478225708
Epoch: 10, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.526 Vali Acc: 0.481 Test Loss: 1.526 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5137641429901123
Epoch: 11, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.539 Vali Acc: 0.489 Test Loss: 1.539 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488534).  Saving model ...
Epoch: 12 cost time: 1.6363391876220703
Epoch: 12, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.478 Vali Acc: 0.519 Test Loss: 1.478 Test Acc: 0.519
Validation loss decreased (-0.488534 --> -0.519069).  Saving model ...
Epoch: 13 cost time: 1.5059814453125
Epoch: 13, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.480 Vali Acc: 0.519 Test Loss: 1.480 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.40028977394104
Epoch: 14, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.484 Vali Acc: 0.519 Test Loss: 1.484 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5552144050598145
Epoch: 15, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.503 Vali Acc: 0.511 Test Loss: 1.503 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.594939947128296
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.475 Vali Acc: 0.519 Test Loss: 1.475 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 17 cost time: 1.4593822956085205
Epoch: 17, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.500 Vali Acc: 0.496 Test Loss: 1.500 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.417022466659546
Epoch: 18, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.470 Vali Acc: 0.519 Test Loss: 1.470 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 19 cost time: 1.6104116439819336
Epoch: 19, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.508 Vali Acc: 0.504 Test Loss: 1.508 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3655002117156982
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.493 Vali Acc: 0.519 Test Loss: 1.493 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4770362377166748
Epoch: 21, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4871387481689453
Epoch: 22, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.539 Vali Acc: 0.519 Test Loss: 1.539 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5312693119049072
Epoch: 23, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.501 Vali Acc: 0.519 Test Loss: 1.501 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3366315364837646
Epoch: 24, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.405 Vali Acc: 0.534 Test Loss: 1.405 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534337).  Saving model ...
Epoch: 25 cost time: 1.3956098556518555
Epoch: 25, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.451 Vali Acc: 0.511 Test Loss: 1.451 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.504371166229248
Epoch: 26, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.529 Vali Acc: 0.504 Test Loss: 1.529 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3136048316955566
Epoch: 27, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.549 Vali Acc: 0.511 Test Loss: 1.549 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2490742206573486
Epoch: 28, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.415 Vali Acc: 0.519 Test Loss: 1.415 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4890539646148682
Epoch: 29, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.445 Vali Acc: 0.527 Test Loss: 1.445 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4931864738464355
Epoch: 30, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3921754360198975
Epoch: 31, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.485 Vali Acc: 0.534 Test Loss: 1.485 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4887399673461914
Epoch: 32, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.626 Vali Acc: 0.504 Test Loss: 1.626 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6236340999603271
Epoch: 33, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.483 Vali Acc: 0.527 Test Loss: 1.483 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2787401676177979
Epoch: 34, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.470 Vali Acc: 0.534 Test Loss: 1.470 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1527685
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5258395671844482
Epoch: 1, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.584 Vali Acc: 0.412 Test Loss: 1.584 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.6806180477142334
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1273760795593262
Epoch: 3, Steps: 8 | Train Loss: 1.164 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.1267306804656982
Epoch: 4, Steps: 8 | Train Loss: 0.961 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.164353609085083
Epoch: 5, Steps: 8 | Train Loss: 0.766 Vali Loss: 1.478 Vali Acc: 0.473 Test Loss: 1.478 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.2124712467193604
Epoch: 6, Steps: 8 | Train Loss: 0.569 Vali Loss: 1.450 Vali Acc: 0.496 Test Loss: 1.450 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.5385940074920654
Epoch: 7, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.411 Vali Acc: 0.504 Test Loss: 1.411 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.155470371246338
Epoch: 8, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.390 Vali Acc: 0.527 Test Loss: 1.390 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 9 cost time: 1.058262825012207
Epoch: 9, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.398 Vali Acc: 0.550 Test Loss: 1.398 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549604).  Saving model ...
Epoch: 10 cost time: 1.2369813919067383
Epoch: 10, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.406 Vali Acc: 0.534 Test Loss: 1.406 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4957013130187988
Epoch: 11, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.347 Vali Acc: 0.580 Test Loss: 1.347 Test Acc: 0.580
Validation loss decreased (-0.549604 --> -0.580139).  Saving model ...
Epoch: 12 cost time: 1.473139762878418
Epoch: 12, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.339 Vali Acc: 0.565 Test Loss: 1.339 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3293631076812744
Epoch: 13, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.420 Vali Acc: 0.573 Test Loss: 1.420 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2768213748931885
Epoch: 14, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.465 Vali Acc: 0.573 Test Loss: 1.465 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.289539098739624
Epoch: 15, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.443 Vali Acc: 0.573 Test Loss: 1.443 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6264255046844482
Epoch: 16, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.451 Vali Acc: 0.542 Test Loss: 1.451 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0470848083496094
Epoch: 17, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.408 Vali Acc: 0.573 Test Loss: 1.408 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4161291122436523
Epoch: 18, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.402 Vali Acc: 0.573 Test Loss: 1.402 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3730072975158691
Epoch: 19, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.502 Vali Acc: 0.565 Test Loss: 1.502 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2578833103179932
Epoch: 20, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.518 Vali Acc: 0.565 Test Loss: 1.518 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.518897294998169
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.469 Vali Acc: 0.550 Test Loss: 1.469 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1627397
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3220930099487305
Epoch: 1, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.605 Vali Acc: 0.229 Test Loss: 1.605 Test Acc: 0.229
Validation loss decreased (inf --> -0.228992).  Saving model ...
Epoch: 2 cost time: 1.5784907341003418
Epoch: 2, Steps: 8 | Train Loss: 1.460 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
Validation loss decreased (-0.228992 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6784803867340088
Epoch: 3, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5088613033294678
Epoch: 4, Steps: 8 | Train Loss: 1.065 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4634087085723877
Epoch: 5, Steps: 8 | Train Loss: 0.884 Vali Loss: 1.548 Vali Acc: 0.420 Test Loss: 1.548 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3833270072937012
Epoch: 6, Steps: 8 | Train Loss: 0.729 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5776317119598389
Epoch: 7, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.4885525703430176
Epoch: 8, Steps: 8 | Train Loss: 0.435 Vali Loss: 1.539 Vali Acc: 0.427 Test Loss: 1.539 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.321533441543579
Epoch: 9, Steps: 8 | Train Loss: 0.405 Vali Loss: 1.566 Vali Acc: 0.443 Test Loss: 1.566 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442732).  Saving model ...
Epoch: 10 cost time: 1.6818406581878662
Epoch: 10, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.585 Vali Acc: 0.443 Test Loss: 1.585 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3950557708740234
Epoch: 11, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.530 Vali Acc: 0.458 Test Loss: 1.530 Test Acc: 0.458
Validation loss decreased (-0.442732 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 1.4698786735534668
Epoch: 12, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.561 Vali Acc: 0.466 Test Loss: 1.561 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465633).  Saving model ...
Epoch: 13 cost time: 1.3293676376342773
Epoch: 13, Steps: 8 | Train Loss: 0.348 Vali Loss: 1.585 Vali Acc: 0.450 Test Loss: 1.585 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5366356372833252
Epoch: 14, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.546 Vali Acc: 0.450 Test Loss: 1.546 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4357504844665527
Epoch: 15, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.552 Vali Acc: 0.450 Test Loss: 1.552 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4009487628936768
Epoch: 16, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.584 Vali Acc: 0.450 Test Loss: 1.584 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2242085933685303
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.623 Vali Acc: 0.450 Test Loss: 1.623 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2199320793151855
Epoch: 18, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.598 Vali Acc: 0.450 Test Loss: 1.598 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.396608829498291
Epoch: 19, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.543 Vali Acc: 0.458 Test Loss: 1.543 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3917348384857178
Epoch: 20, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.569 Vali Acc: 0.458 Test Loss: 1.569 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.336575984954834
Epoch: 21, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.596 Vali Acc: 0.458 Test Loss: 1.596 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.277872085571289
Epoch: 22, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.585 Vali Acc: 0.458 Test Loss: 1.585 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 1734789
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.432243585586548
Epoch: 1, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2138481140136719
Epoch: 2, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.599 Vali Acc: 0.420 Test Loss: 1.599 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4554400444030762
Epoch: 3, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1888914108276367
Epoch: 4, Steps: 8 | Train Loss: 0.921 Vali Loss: 1.418 Vali Acc: 0.443 Test Loss: 1.418 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442734).  Saving model ...
Epoch: 5 cost time: 1.0931527614593506
Epoch: 5, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.456 Vali Acc: 0.450 Test Loss: 1.456 Test Acc: 0.450
Validation loss decreased (-0.442734 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.6066973209381104
Epoch: 6, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.345 Vali Acc: 0.504 Test Loss: 1.345 Test Acc: 0.504
Validation loss decreased (-0.450367 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.6610095500946045
Epoch: 7, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.368664026260376
Epoch: 8, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.395 Vali Acc: 0.534 Test Loss: 1.395 Test Acc: 0.534
Validation loss decreased (-0.503803 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.2217786312103271
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 10 cost time: 1.2628779411315918
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.523 Vali Acc: 0.519 Test Loss: 1.523 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0567021369934082
Epoch: 11, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.631 Vali Acc: 0.519 Test Loss: 1.631 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.290886402130127
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.571 Vali Acc: 0.542 Test Loss: 1.571 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1825358867645264
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.647 Vali Acc: 0.534 Test Loss: 1.647 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2469520568847656
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.737 Vali Acc: 0.527 Test Loss: 1.737 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.31553316116333
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.889 Vali Acc: 0.527 Test Loss: 1.889 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2771275043487549
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.646 Vali Acc: 0.550 Test Loss: 1.646 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.51651930809021
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.704 Vali Acc: 0.534 Test Loss: 1.704 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4279108047485352
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.092 Vali Acc: 0.534 Test Loss: 2.092 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4006550312042236
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.069 Vali Acc: 0.534 Test Loss: 2.069 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 484549
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.0166003704071045
Epoch: 1, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.563 Vali Acc: 0.420 Test Loss: 1.563 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.203247308731079
Epoch: 2, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.270803689956665
Epoch: 3, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2253873348236084
Epoch: 4, Steps: 8 | Train Loss: 1.094 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.1839873790740967
Epoch: 5, Steps: 8 | Train Loss: 0.889 Vali Loss: 1.486 Vali Acc: 0.420 Test Loss: 1.486 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.1962931156158447
Epoch: 6, Steps: 8 | Train Loss: 0.720 Vali Loss: 1.448 Vali Acc: 0.466 Test Loss: 1.448 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.300482988357544
Epoch: 7, Steps: 8 | Train Loss: 0.540 Vali Loss: 1.458 Vali Acc: 0.496 Test Loss: 1.458 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.099761724472046
Epoch: 8, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.459 Vali Acc: 0.504 Test Loss: 1.459 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 9 cost time: 1.4476289749145508
Epoch: 9, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.497 Vali Acc: 0.496 Test Loss: 1.497 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.508788824081421
Epoch: 10, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.502 Vali Acc: 0.519 Test Loss: 1.502 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 11 cost time: 1.2062833309173584
Epoch: 11, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.394 Vali Acc: 0.534 Test Loss: 1.394 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534337).  Saving model ...
Epoch: 12 cost time: 1.3520021438598633
Epoch: 12, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.501 Vali Acc: 0.527 Test Loss: 1.501 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.489372968673706
Epoch: 13, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.466 Vali Acc: 0.534 Test Loss: 1.466 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7439510822296143
Epoch: 14, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.500 Vali Acc: 0.534 Test Loss: 1.500 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.664564609527588
Epoch: 15, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.426 Vali Acc: 0.557 Test Loss: 1.426 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 16 cost time: 1.384950876235962
Epoch: 16, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.458 Vali Acc: 0.573 Test Loss: 1.458 Test Acc: 0.573
Validation loss decreased (-0.557238 --> -0.572505).  Saving model ...
Epoch: 17 cost time: 1.267853021621704
Epoch: 17, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.609 Vali Acc: 0.534 Test Loss: 1.609 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.774031162261963
Epoch: 18, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.586 Vali Acc: 0.534 Test Loss: 1.586 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.527230978012085
Epoch: 19, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.472 Vali Acc: 0.565 Test Loss: 1.472 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.39042067527771
Epoch: 20, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.616 Vali Acc: 0.542 Test Loss: 1.616 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5997588634490967
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.642 Vali Acc: 0.542 Test Loss: 1.642 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3297317028045654
Epoch: 22, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.659 Vali Acc: 0.542 Test Loss: 1.659 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3885548114776611
Epoch: 23, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.741 Vali Acc: 0.550 Test Loss: 1.741 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4367177486419678
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.784 Vali Acc: 0.550 Test Loss: 1.784 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5035765171051025
Epoch: 25, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.736 Vali Acc: 0.550 Test Loss: 1.736 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.480607271194458
Epoch: 26, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.766 Vali Acc: 0.519 Test Loss: 1.766 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 436549
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9625585079193115
Epoch: 1, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6959760189056396
Epoch: 2, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2129955291748047
Epoch: 3, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.118947982788086
Epoch: 4, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7258317470550537
Epoch: 5, Steps: 8 | Train Loss: 1.009 Vali Loss: 1.507 Vali Acc: 0.420 Test Loss: 1.507 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.516753911972046
Epoch: 6, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.464 Vali Acc: 0.427 Test Loss: 1.464 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.4384684562683105
Epoch: 7, Steps: 8 | Train Loss: 0.674 Vali Loss: 1.500 Vali Acc: 0.420 Test Loss: 1.500 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3688504695892334
Epoch: 8, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.470 Vali Acc: 0.473 Test Loss: 1.470 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 1.6691575050354004
Epoch: 9, Steps: 8 | Train Loss: 0.459 Vali Loss: 1.467 Vali Acc: 0.489 Test Loss: 1.467 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.5991904735565186
Epoch: 10, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.486 Vali Acc: 0.496 Test Loss: 1.486 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 11 cost time: 1.3729884624481201
Epoch: 11, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.444 Vali Acc: 0.504 Test Loss: 1.444 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 12 cost time: 1.3331758975982666
Epoch: 12, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.502 Vali Acc: 0.511 Test Loss: 1.502 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 13 cost time: 1.5599009990692139
Epoch: 13, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.428 Vali Acc: 0.519 Test Loss: 1.428 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.3322052955627441
Epoch: 14, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3485102653503418
Epoch: 15, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.561 Vali Acc: 0.511 Test Loss: 1.561 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3938987255096436
Epoch: 16, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.459 Vali Acc: 0.534 Test Loss: 1.459 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 17 cost time: 1.295579195022583
Epoch: 17, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4148855209350586
Epoch: 18, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.602 Vali Acc: 0.527 Test Loss: 1.602 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3451192378997803
Epoch: 19, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.562 Vali Acc: 0.519 Test Loss: 1.562 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2576484680175781
Epoch: 20, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.519 Vali Acc: 0.511 Test Loss: 1.519 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4958724975585938
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4493463039398193
Epoch: 22, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.551 Vali Acc: 0.527 Test Loss: 1.551 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7180883884429932
Epoch: 23, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.685 Vali Acc: 0.511 Test Loss: 1.685 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4123616218566895
Epoch: 24, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.595 Vali Acc: 0.519 Test Loss: 1.595 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2911512851715088
Epoch: 25, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.586 Vali Acc: 0.519 Test Loss: 1.586 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3239340782165527
Epoch: 26, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.634 Vali Acc: 0.527 Test Loss: 1.634 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 438405
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3331050872802734
Epoch: 1, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.589 Vali Acc: 0.412 Test Loss: 1.589 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.3430001735687256
Epoch: 2, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1221578121185303
Epoch: 3, Steps: 8 | Train Loss: 1.363 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.1376338005065918
Epoch: 4, Steps: 8 | Train Loss: 1.191 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.320624589920044
Epoch: 5, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.486 Vali Acc: 0.427 Test Loss: 1.486 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.2141754627227783
Epoch: 6, Steps: 8 | Train Loss: 0.910 Vali Loss: 1.453 Vali Acc: 0.443 Test Loss: 1.453 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442734).  Saving model ...
Epoch: 7 cost time: 1.1423661708831787
Epoch: 7, Steps: 8 | Train Loss: 0.756 Vali Loss: 1.433 Vali Acc: 0.481 Test Loss: 1.433 Test Acc: 0.481
Validation loss decreased (-0.442734 --> -0.480902).  Saving model ...
Epoch: 8 cost time: 1.1884515285491943
Epoch: 8, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.349 Vali Acc: 0.504 Test Loss: 1.349 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 1.6811752319335938
Epoch: 9, Steps: 8 | Train Loss: 0.530 Vali Loss: 1.346 Vali Acc: 0.511 Test Loss: 1.346 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 10 cost time: 1.4440417289733887
Epoch: 10, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.279 Vali Acc: 0.511 Test Loss: 1.279 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511438).  Saving model ...
Epoch: 11 cost time: 1.2970967292785645
Epoch: 11, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.293 Vali Acc: 0.542 Test Loss: 1.293 Test Acc: 0.542
Validation loss decreased (-0.511438 --> -0.541972).  Saving model ...
Epoch: 12 cost time: 1.3377492427825928
Epoch: 12, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.322 Vali Acc: 0.527 Test Loss: 1.322 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3322534561157227
Epoch: 13, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.273 Vali Acc: 0.550 Test Loss: 1.273 Test Acc: 0.550
Validation loss decreased (-0.541972 --> -0.549606).  Saving model ...
Epoch: 14 cost time: 1.171994686126709
Epoch: 14, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
Validation loss decreased (-0.549606 --> -0.549606).  Saving model ...
Epoch: 15 cost time: 1.3217988014221191
Epoch: 15, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.273 Vali Acc: 0.565 Test Loss: 1.273 Test Acc: 0.565
Validation loss decreased (-0.549606 --> -0.564873).  Saving model ...
Epoch: 16 cost time: 1.6203317642211914
Epoch: 16, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.239 Vali Acc: 0.557 Test Loss: 1.239 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2187018394470215
Epoch: 17, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.265 Vali Acc: 0.542 Test Loss: 1.265 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3772644996643066
Epoch: 18, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.250 Vali Acc: 0.534 Test Loss: 1.250 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.243908166885376
Epoch: 19, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.293 Vali Acc: 0.534 Test Loss: 1.293 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5608305931091309
Epoch: 20, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.277 Vali Acc: 0.557 Test Loss: 1.277 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4208412170410156
Epoch: 21, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.277 Vali Acc: 0.550 Test Loss: 1.277 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2187998294830322
Epoch: 22, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.313 Vali Acc: 0.534 Test Loss: 1.313 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2260081768035889
Epoch: 23, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.350 Vali Acc: 0.550 Test Loss: 1.350 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3653385639190674
Epoch: 24, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.368 Vali Acc: 0.557 Test Loss: 1.368 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1531519889831543
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.407 Vali Acc: 0.550 Test Loss: 1.407 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 455685
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2886452674865723
Epoch: 1, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.594 Vali Acc: 0.244 Test Loss: 1.594 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 1.2167768478393555
Epoch: 2, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.244259 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4375779628753662
Epoch: 3, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.3368220329284668
Epoch: 4, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.5655241012573242
Epoch: 5, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1791038513183594
Epoch: 6, Steps: 8 | Train Loss: 0.995 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2437880039215088
Epoch: 7, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.511 Vali Acc: 0.427 Test Loss: 1.511 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.6640479564666748
Epoch: 8, Steps: 8 | Train Loss: 0.738 Vali Loss: 1.509 Vali Acc: 0.427 Test Loss: 1.509 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.7898139953613281
Epoch: 9, Steps: 8 | Train Loss: 0.643 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2930707931518555
Epoch: 10, Steps: 8 | Train Loss: 0.537 Vali Loss: 1.525 Vali Acc: 0.427 Test Loss: 1.525 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4575684070587158
Epoch: 11, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.496 Vali Acc: 0.443 Test Loss: 1.496 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 12 cost time: 1.2384357452392578
Epoch: 12, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.540 Vali Acc: 0.458 Test Loss: 1.540 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 13 cost time: 1.1886470317840576
Epoch: 13, Steps: 8 | Train Loss: 0.370 Vali Loss: 1.527 Vali Acc: 0.473 Test Loss: 1.527 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 14 cost time: 1.1726596355438232
Epoch: 14, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.548 Vali Acc: 0.458 Test Loss: 1.548 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.426823377609253
Epoch: 15, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.522 Vali Acc: 0.496 Test Loss: 1.522 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 16 cost time: 1.5051321983337402
Epoch: 16, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.579 Vali Acc: 0.481 Test Loss: 1.579 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4698233604431152
Epoch: 17, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3777525424957275
Epoch: 18, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.527 Vali Acc: 0.504 Test Loss: 1.527 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 19 cost time: 1.4502570629119873
Epoch: 19, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526702).  Saving model ...
Epoch: 20 cost time: 1.3172061443328857
Epoch: 20, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.570 Vali Acc: 0.519 Test Loss: 1.570 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1702566146850586
Epoch: 21, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.551 Vali Acc: 0.527 Test Loss: 1.551 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7726860046386719
Epoch: 22, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.600 Vali Acc: 0.489 Test Loss: 1.600 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3875908851623535
Epoch: 23, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.582 Vali Acc: 0.504 Test Loss: 1.582 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.450078010559082
Epoch: 24, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.584 Vali Acc: 0.519 Test Loss: 1.584 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2444398403167725
Epoch: 25, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.598 Vali Acc: 0.466 Test Loss: 1.598 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.276573896408081
Epoch: 26, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.607 Vali Acc: 0.481 Test Loss: 1.607 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5630111694335938
Epoch: 27, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.598 Vali Acc: 0.504 Test Loss: 1.598 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.563582420349121
Epoch: 28, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.628 Vali Acc: 0.481 Test Loss: 1.628 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1942901611328125
Epoch: 29, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.588 Vali Acc: 0.511 Test Loss: 1.588 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 501701
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5542640686035156
Epoch: 1, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.598 Vali Acc: 0.260 Test Loss: 1.598 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.4991462230682373
Epoch: 2, Steps: 8 | Train Loss: 1.507 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
Validation loss decreased (-0.259526 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2316837310791016
Epoch: 3, Steps: 8 | Train Loss: 1.303 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.2824211120605469
Epoch: 4, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.4663825035095215
Epoch: 5, Steps: 8 | Train Loss: 0.987 Vali Loss: 1.521 Vali Acc: 0.427 Test Loss: 1.521 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.484081506729126
Epoch: 6, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.483 Vali Acc: 0.458 Test Loss: 1.483 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.400477647781372
Epoch: 7, Steps: 8 | Train Loss: 0.728 Vali Loss: 1.473 Vali Acc: 0.489 Test Loss: 1.473 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.224409580230713
Epoch: 8, Steps: 8 | Train Loss: 0.631 Vali Loss: 1.439 Vali Acc: 0.511 Test Loss: 1.439 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.441206693649292
Epoch: 9, Steps: 8 | Train Loss: 0.515 Vali Loss: 1.451 Vali Acc: 0.511 Test Loss: 1.451 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7129273414611816
Epoch: 10, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.452 Vali Acc: 0.519 Test Loss: 1.452 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 11 cost time: 1.640777349472046
Epoch: 11, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 1.3848092555999756
Epoch: 12, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.454 Vali Acc: 0.519 Test Loss: 1.454 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5430593490600586
Epoch: 13, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.436 Vali Acc: 0.519 Test Loss: 1.436 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.503699779510498
Epoch: 14, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.475 Vali Acc: 0.527 Test Loss: 1.475 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.09541916847229
Epoch: 15, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.498 Vali Acc: 0.519 Test Loss: 1.498 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4843413829803467
Epoch: 16, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3842525482177734
Epoch: 17, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 18 cost time: 1.073798656463623
Epoch: 18, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.497 Vali Acc: 0.519 Test Loss: 1.497 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6875970363616943
Epoch: 19, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.580 Vali Acc: 0.519 Test Loss: 1.580 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.304616928100586
Epoch: 20, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.530 Vali Acc: 0.534 Test Loss: 1.530 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 21 cost time: 1.25172758102417
Epoch: 21, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.482 Vali Acc: 0.519 Test Loss: 1.482 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1572182178497314
Epoch: 22, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.492 Vali Acc: 0.511 Test Loss: 1.492 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6636378765106201
Epoch: 23, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.482 Vali Acc: 0.511 Test Loss: 1.482 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5648822784423828
Epoch: 24, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.524 Vali Acc: 0.519 Test Loss: 1.524 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3830070495605469
Epoch: 25, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.502 Vali Acc: 0.519 Test Loss: 1.502 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6593832969665527
Epoch: 26, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.498 Vali Acc: 0.511 Test Loss: 1.498 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.680891513824463
Epoch: 27, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.540 Vali Acc: 0.519 Test Loss: 1.540 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3274612426757812
Epoch: 28, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.531 Vali Acc: 0.519 Test Loss: 1.531 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.315762996673584
Epoch: 29, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.533 Vali Acc: 0.511 Test Loss: 1.533 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3852555751800537
Epoch: 30, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 551557
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.003159284591675
Epoch: 1, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.647 Vali Acc: 0.160 Test Loss: 1.647 Test Acc: 0.160
Validation loss decreased (inf --> -0.160289).  Saving model ...
Epoch: 2 cost time: 1.1980724334716797
Epoch: 2, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.610 Vali Acc: 0.214 Test Loss: 1.610 Test Acc: 0.214
Validation loss decreased (-0.160289 --> -0.213724).  Saving model ...
Epoch: 3 cost time: 1.318735122680664
Epoch: 3, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.578 Vali Acc: 0.420 Test Loss: 1.578 Test Acc: 0.420
Validation loss decreased (-0.213724 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.2363648414611816
Epoch: 4, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.1490066051483154
Epoch: 5, Steps: 8 | Train Loss: 1.106 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.7242534160614014
Epoch: 6, Steps: 8 | Train Loss: 0.932 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.1851017475128174
Epoch: 7, Steps: 8 | Train Loss: 0.861 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.1207287311553955
Epoch: 8, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.3684148788452148
Epoch: 9, Steps: 8 | Train Loss: 0.656 Vali Loss: 1.529 Vali Acc: 0.427 Test Loss: 1.529 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 10 cost time: 1.3792006969451904
Epoch: 10, Steps: 8 | Train Loss: 0.585 Vali Loss: 1.510 Vali Acc: 0.435 Test Loss: 1.510 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 11 cost time: 1.2737441062927246
Epoch: 11, Steps: 8 | Train Loss: 0.507 Vali Loss: 1.496 Vali Acc: 0.458 Test Loss: 1.496 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 1.3874225616455078
Epoch: 12, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.502 Vali Acc: 0.450 Test Loss: 1.502 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1547017097473145
Epoch: 13, Steps: 8 | Train Loss: 0.421 Vali Loss: 1.506 Vali Acc: 0.450 Test Loss: 1.506 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.241513729095459
Epoch: 14, Steps: 8 | Train Loss: 0.350 Vali Loss: 1.524 Vali Acc: 0.458 Test Loss: 1.524 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4797961711883545
Epoch: 15, Steps: 8 | Train Loss: 0.378 Vali Loss: 1.521 Vali Acc: 0.466 Test Loss: 1.521 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 16 cost time: 1.1655471324920654
Epoch: 16, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.547 Vali Acc: 0.450 Test Loss: 1.547 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4230880737304688
Epoch: 17, Steps: 8 | Train Loss: 0.355 Vali Loss: 1.554 Vali Acc: 0.450 Test Loss: 1.554 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2292706966400146
Epoch: 18, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.536 Vali Acc: 0.450 Test Loss: 1.536 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3311212062835693
Epoch: 19, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.560 Vali Acc: 0.466 Test Loss: 1.560 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5560829639434814
Epoch: 20, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.549 Vali Acc: 0.458 Test Loss: 1.549 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3073220252990723
Epoch: 21, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.573 Vali Acc: 0.450 Test Loss: 1.573 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.098799228668213
Epoch: 22, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.534 Vali Acc: 0.450 Test Loss: 1.534 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4657526016235352
Epoch: 23, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.552 Vali Acc: 0.450 Test Loss: 1.552 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.715580701828003
Epoch: 24, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.565 Vali Acc: 0.450 Test Loss: 1.565 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2704603672027588
Epoch: 25, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.568 Vali Acc: 0.450 Test Loss: 1.568 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 605253
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9888291358947754
Epoch: 1, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4753189086914062
Epoch: 2, Steps: 8 | Train Loss: 1.459 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5418858528137207
Epoch: 3, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2039718627929688
Epoch: 4, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.530 Vali Acc: 0.420 Test Loss: 1.530 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 0.9599850177764893
Epoch: 5, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.464 Vali Acc: 0.427 Test Loss: 1.464 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.2412405014038086
Epoch: 6, Steps: 8 | Train Loss: 0.797 Vali Loss: 1.436 Vali Acc: 0.435 Test Loss: 1.436 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 1.1907365322113037
Epoch: 7, Steps: 8 | Train Loss: 0.623 Vali Loss: 1.398 Vali Acc: 0.489 Test Loss: 1.398 Test Acc: 0.489
Validation loss decreased (-0.435100 --> -0.488536).  Saving model ...
Epoch: 8 cost time: 1.284132480621338
Epoch: 8, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.384 Vali Acc: 0.504 Test Loss: 1.384 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 1.4289944171905518
Epoch: 9, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.332 Vali Acc: 0.534 Test Loss: 1.332 Test Acc: 0.534
Validation loss decreased (-0.503803 --> -0.534338).  Saving model ...
Epoch: 10 cost time: 1.2214744091033936
Epoch: 10, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.465 Vali Acc: 0.519 Test Loss: 1.465 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4759624004364014
Epoch: 11, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2772960662841797
Epoch: 12, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.449 Vali Acc: 0.519 Test Loss: 1.449 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2676353454589844
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.420 Vali Acc: 0.527 Test Loss: 1.420 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3904595375061035
Epoch: 14, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.362 Vali Acc: 0.527 Test Loss: 1.362 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2341175079345703
Epoch: 15, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.399 Vali Acc: 0.542 Test Loss: 1.399 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.4050955772399902
Epoch: 16, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.428 Vali Acc: 0.542 Test Loss: 1.428 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.579939842224121
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1957900524139404
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.443 Vali Acc: 0.534 Test Loss: 1.443 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3291258811950684
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.489 Vali Acc: 0.542 Test Loss: 1.489 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.321570873260498
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1957669258117676
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.617 Vali Acc: 0.534 Test Loss: 1.617 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4835805892944336
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.623 Vali Acc: 0.534 Test Loss: 1.623 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3475637435913086
Epoch: 23, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.653 Vali Acc: 0.534 Test Loss: 1.653 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2870423793792725
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5537683963775635
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.896 Vali Acc: 0.527 Test Loss: 1.896 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 176741
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9273416996002197
Epoch: 1, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.304527759552002
Epoch: 2, Steps: 8 | Train Loss: 1.492 Vali Loss: 1.524 Vali Acc: 0.427 Test Loss: 1.524 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.3604836463928223
Epoch: 3, Steps: 8 | Train Loss: 1.394 Vali Loss: 1.518 Vali Acc: 0.427 Test Loss: 1.518 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.216092586517334
Epoch: 4, Steps: 8 | Train Loss: 1.290 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1282296180725098
Epoch: 5, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.496 Vali Acc: 0.420 Test Loss: 1.496 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3196475505828857
Epoch: 6, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.454 Vali Acc: 0.435 Test Loss: 1.454 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 1.2110979557037354
Epoch: 7, Steps: 8 | Train Loss: 0.925 Vali Loss: 1.427 Vali Acc: 0.450 Test Loss: 1.427 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.1040375232696533
Epoch: 8, Steps: 8 | Train Loss: 0.793 Vali Loss: 1.404 Vali Acc: 0.458 Test Loss: 1.404 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 1.3448634147644043
Epoch: 9, Steps: 8 | Train Loss: 0.658 Vali Loss: 1.363 Vali Acc: 0.489 Test Loss: 1.363 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488536).  Saving model ...
Epoch: 10 cost time: 1.1175644397735596
Epoch: 10, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.355 Vali Acc: 0.496 Test Loss: 1.355 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 11 cost time: 1.571112871170044
Epoch: 11, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.283 Vali Acc: 0.519 Test Loss: 1.283 Test Acc: 0.519
Validation loss decreased (-0.496170 --> -0.519071).  Saving model ...
Epoch: 12 cost time: 1.121671438217163
Epoch: 12, Steps: 8 | Train Loss: 0.385 Vali Loss: 1.344 Vali Acc: 0.519 Test Loss: 1.344 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1400737762451172
Epoch: 13, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.343 Vali Acc: 0.534 Test Loss: 1.343 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534338).  Saving model ...
Epoch: 14 cost time: 1.376237392425537
Epoch: 14, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.294 Vali Acc: 0.534 Test Loss: 1.294 Test Acc: 0.534
Validation loss decreased (-0.534338 --> -0.534338).  Saving model ...
Epoch: 15 cost time: 0.9616069793701172
Epoch: 15, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.306 Vali Acc: 0.534 Test Loss: 1.306 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2684786319732666
Epoch: 16, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.311 Vali Acc: 0.542 Test Loss: 1.311 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 17 cost time: 1.1484043598175049
Epoch: 17, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.360 Vali Acc: 0.542 Test Loss: 1.360 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4859731197357178
Epoch: 18, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.348 Vali Acc: 0.557 Test Loss: 1.348 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557238).  Saving model ...
Epoch: 19 cost time: 1.1457817554473877
Epoch: 19, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.364 Vali Acc: 0.550 Test Loss: 1.364 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.095259189605713
Epoch: 20, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1494388580322266
Epoch: 21, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.394 Vali Acc: 0.542 Test Loss: 1.394 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6381030082702637
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.335 Vali Acc: 0.595 Test Loss: 1.335 Test Acc: 0.595
Validation loss decreased (-0.557238 --> -0.595406).  Saving model ...
Epoch: 23 cost time: 1.240534782409668
Epoch: 23, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.398 Vali Acc: 0.565 Test Loss: 1.398 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1933999061584473
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.435 Vali Acc: 0.550 Test Loss: 1.435 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2208688259124756
Epoch: 25, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.429 Vali Acc: 0.573 Test Loss: 1.429 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.596742868423462
Epoch: 26, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.478 Vali Acc: 0.573 Test Loss: 1.478 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1553893089294434
Epoch: 27, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.449 Vali Acc: 0.550 Test Loss: 1.449 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1990609169006348
Epoch: 28, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.459 Vali Acc: 0.588 Test Loss: 1.459 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9491949081420898
Epoch: 29, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.502 Vali Acc: 0.580 Test Loss: 1.502 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.199711561203003
Epoch: 30, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.457 Vali Acc: 0.595 Test Loss: 1.457 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3778505325317383
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.444 Vali Acc: 0.603 Test Loss: 1.444 Test Acc: 0.603
Validation loss decreased (-0.595406 --> -0.603039).  Saving model ...
Epoch: 32 cost time: 1.6026809215545654
Epoch: 32, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.538 Vali Acc: 0.580 Test Loss: 1.538 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1569547653198242
Epoch: 33, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.597 Vali Acc: 0.557 Test Loss: 1.597 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2728002071380615
Epoch: 34, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.587 Vali Acc: 0.603 Test Loss: 1.587 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.194444179534912
Epoch: 35, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.588 Vali Acc: 0.595 Test Loss: 1.588 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0643980503082275
Epoch: 36, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.596 Vali Acc: 0.595 Test Loss: 1.596 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4814417362213135
Epoch: 37, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.560 Vali Acc: 0.588 Test Loss: 1.560 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3723995685577393
Epoch: 38, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.675 Vali Acc: 0.573 Test Loss: 1.675 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0798802375793457
Epoch: 39, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.697 Vali Acc: 0.588 Test Loss: 1.697 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2233519554138184
Epoch: 40, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.691 Vali Acc: 0.603 Test Loss: 1.691 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3168511390686035
Epoch: 41, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.808 Vali Acc: 0.588 Test Loss: 1.808 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 152741
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.856498956680298
Epoch: 1, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.128114938735962
Epoch: 2, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.533 Vali Acc: 0.420 Test Loss: 1.533 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2839879989624023
Epoch: 3, Steps: 8 | Train Loss: 1.416 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.165360689163208
Epoch: 4, Steps: 8 | Train Loss: 1.330 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.2544727325439453
Epoch: 5, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1872048377990723
Epoch: 6, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.1421589851379395
Epoch: 7, Steps: 8 | Train Loss: 1.033 Vali Loss: 1.503 Vali Acc: 0.420 Test Loss: 1.503 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.0522370338439941
Epoch: 8, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.480 Vali Acc: 0.420 Test Loss: 1.480 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 9 cost time: 1.1610338687896729
Epoch: 9, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.465 Vali Acc: 0.427 Test Loss: 1.465 Test Acc: 0.427
Validation loss decreased (-0.419833 --> -0.427466).  Saving model ...
Epoch: 10 cost time: 1.0827999114990234
Epoch: 10, Steps: 8 | Train Loss: 0.731 Vali Loss: 1.453 Vali Acc: 0.450 Test Loss: 1.453 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 1.1828267574310303
Epoch: 11, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.424 Vali Acc: 0.481 Test Loss: 1.424 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 1.1716487407684326
Epoch: 12, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.475 Vali Acc: 0.473 Test Loss: 1.475 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1713201999664307
Epoch: 13, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.489 Vali Acc: 0.481 Test Loss: 1.489 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.022752285003662
Epoch: 14, Steps: 8 | Train Loss: 0.403 Vali Loss: 1.452 Vali Acc: 0.481 Test Loss: 1.452 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2187182903289795
Epoch: 15, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.377 Vali Acc: 0.519 Test Loss: 1.377 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 1.1493806838989258
Epoch: 16, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.530 Vali Acc: 0.481 Test Loss: 1.530 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2240653038024902
Epoch: 17, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.510 Vali Acc: 0.511 Test Loss: 1.510 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1801493167877197
Epoch: 18, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.443 Vali Acc: 0.511 Test Loss: 1.443 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1704015731811523
Epoch: 19, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.382 Vali Acc: 0.519 Test Loss: 1.382 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.261225700378418
Epoch: 20, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.452 Vali Acc: 0.511 Test Loss: 1.452 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.204275369644165
Epoch: 21, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.496 Vali Acc: 0.519 Test Loss: 1.496 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2803857326507568
Epoch: 22, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.524 Vali Acc: 0.519 Test Loss: 1.524 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.334268569946289
Epoch: 23, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.564 Vali Acc: 0.511 Test Loss: 1.564 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2603087425231934
Epoch: 24, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.544 Vali Acc: 0.519 Test Loss: 1.544 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3189892768859863
Epoch: 25, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.578 Vali Acc: 0.519 Test Loss: 1.578 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 153669
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8917672634124756
Epoch: 1, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.590 Vali Acc: 0.313 Test Loss: 1.590 Test Acc: 0.313
Validation loss decreased (inf --> -0.312961).  Saving model ...
Epoch: 2 cost time: 1.1826419830322266
Epoch: 2, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.561 Vali Acc: 0.443 Test Loss: 1.561 Test Acc: 0.443
Validation loss decreased (-0.312961 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.1608917713165283
Epoch: 3, Steps: 8 | Train Loss: 1.444 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4302363395690918
Epoch: 4, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0307862758636475
Epoch: 5, Steps: 8 | Train Loss: 1.251 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2214789390563965
Epoch: 6, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2168281078338623
Epoch: 7, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.509 Vali Acc: 0.427 Test Loss: 1.509 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3444764614105225
Epoch: 8, Steps: 8 | Train Loss: 0.958 Vali Loss: 1.493 Vali Acc: 0.427 Test Loss: 1.493 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2953038215637207
Epoch: 9, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.471 Vali Acc: 0.443 Test Loss: 1.471 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 1.2417376041412354
Epoch: 10, Steps: 8 | Train Loss: 0.789 Vali Loss: 1.451 Vali Acc: 0.450 Test Loss: 1.451 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 1.2696523666381836
Epoch: 11, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.422 Vali Acc: 0.481 Test Loss: 1.422 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 1.249500036239624
Epoch: 12, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.395 Vali Acc: 0.496 Test Loss: 1.395 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 13 cost time: 1.1858432292938232
Epoch: 13, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.354 Vali Acc: 0.519 Test Loss: 1.354 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.8626253604888916
Epoch: 14, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.378 Vali Acc: 0.511 Test Loss: 1.378 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2170474529266357
Epoch: 15, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.359 Vali Acc: 0.511 Test Loss: 1.359 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2652852535247803
Epoch: 16, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1282119750976562
Epoch: 17, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.399 Vali Acc: 0.534 Test Loss: 1.399 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 18 cost time: 1.3493788242340088
Epoch: 18, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.364 Vali Acc: 0.550 Test Loss: 1.364 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549605).  Saving model ...
Epoch: 19 cost time: 1.560967206954956
Epoch: 19, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.349 Vali Acc: 0.542 Test Loss: 1.349 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3610014915466309
Epoch: 20, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.366 Vali Acc: 0.542 Test Loss: 1.366 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.311889886856079
Epoch: 21, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.385 Vali Acc: 0.542 Test Loss: 1.385 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3979830741882324
Epoch: 22, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.389 Vali Acc: 0.534 Test Loss: 1.389 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5273826122283936
Epoch: 23, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.401 Vali Acc: 0.527 Test Loss: 1.401 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2030115127563477
Epoch: 24, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.398 Vali Acc: 0.534 Test Loss: 1.398 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3494906425476074
Epoch: 25, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.399 Vali Acc: 0.542 Test Loss: 1.399 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3748083114624023
Epoch: 26, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.348 Vali Acc: 0.557 Test Loss: 1.348 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557238).  Saving model ...
Epoch: 27 cost time: 1.3956043720245361
Epoch: 27, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3935303688049316
Epoch: 28, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1539831161499023
Epoch: 29, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2858295440673828
Epoch: 30, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.446 Vali Acc: 0.534 Test Loss: 1.446 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3798987865447998
Epoch: 31, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.386 Vali Acc: 0.534 Test Loss: 1.386 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3709378242492676
Epoch: 32, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.357 Vali Acc: 0.534 Test Loss: 1.357 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4340128898620605
Epoch: 33, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.409 Vali Acc: 0.542 Test Loss: 1.409 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3029956817626953
Epoch: 34, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.393 Vali Acc: 0.542 Test Loss: 1.393 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4545795917510986
Epoch: 35, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5451178550720215
Epoch: 36, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.381 Vali Acc: 0.519 Test Loss: 1.381 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 162309
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2654130458831787
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.600 Vali Acc: 0.229 Test Loss: 1.600 Test Acc: 0.229
Validation loss decreased (inf --> -0.228992).  Saving model ...
Epoch: 2 cost time: 1.4252204895019531
Epoch: 2, Steps: 8 | Train Loss: 1.536 Vali Loss: 1.572 Vali Acc: 0.382 Test Loss: 1.572 Test Acc: 0.382
Validation loss decreased (-0.228992 --> -0.381664).  Saving model ...
Epoch: 3 cost time: 1.5268094539642334
Epoch: 3, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.546 Vali Acc: 0.427 Test Loss: 1.546 Test Acc: 0.427
Validation loss decreased (-0.381664 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.1978118419647217
Epoch: 4, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4480388164520264
Epoch: 5, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.38352370262146
Epoch: 6, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1576507091522217
Epoch: 7, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.502 Vali Acc: 0.427 Test Loss: 1.502 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 1.0361847877502441
Epoch: 8, Steps: 8 | Train Loss: 0.979 Vali Loss: 1.497 Vali Acc: 0.427 Test Loss: 1.497 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.173858404159546
Epoch: 9, Steps: 8 | Train Loss: 0.889 Vali Loss: 1.497 Vali Acc: 0.420 Test Loss: 1.497 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1698250770568848
Epoch: 10, Steps: 8 | Train Loss: 0.862 Vali Loss: 1.498 Vali Acc: 0.427 Test Loss: 1.498 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1271471977233887
Epoch: 11, Steps: 8 | Train Loss: 0.758 Vali Loss: 1.487 Vali Acc: 0.435 Test Loss: 1.487 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 12 cost time: 1.2332534790039062
Epoch: 12, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.480 Vali Acc: 0.435 Test Loss: 1.480 Test Acc: 0.435
Validation loss decreased (-0.435100 --> -0.435100).  Saving model ...
Epoch: 13 cost time: 1.1435043811798096
Epoch: 13, Steps: 8 | Train Loss: 0.662 Vali Loss: 1.502 Vali Acc: 0.420 Test Loss: 1.502 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.26332688331604
Epoch: 14, Steps: 8 | Train Loss: 0.553 Vali Loss: 1.505 Vali Acc: 0.427 Test Loss: 1.505 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2367432117462158
Epoch: 15, Steps: 8 | Train Loss: 0.548 Vali Loss: 1.481 Vali Acc: 0.443 Test Loss: 1.481 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442733).  Saving model ...
Epoch: 16 cost time: 1.3502991199493408
Epoch: 16, Steps: 8 | Train Loss: 0.468 Vali Loss: 1.452 Vali Acc: 0.466 Test Loss: 1.452 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 17 cost time: 1.339388370513916
Epoch: 17, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.483 Vali Acc: 0.450 Test Loss: 1.483 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.176877498626709
Epoch: 18, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.461 Vali Acc: 0.473 Test Loss: 1.461 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 19 cost time: 1.6572413444519043
Epoch: 19, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.458 Vali Acc: 0.481 Test Loss: 1.458 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 20 cost time: 1.309692621231079
Epoch: 20, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.483 Vali Acc: 0.466 Test Loss: 1.483 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3439266681671143
Epoch: 21, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.455 Vali Acc: 0.489 Test Loss: 1.455 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 22 cost time: 1.1247999668121338
Epoch: 22, Steps: 8 | Train Loss: 0.245 Vali Loss: 1.431 Vali Acc: 0.496 Test Loss: 1.431 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 23 cost time: 1.336033821105957
Epoch: 23, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.462 Vali Acc: 0.473 Test Loss: 1.462 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1725854873657227
Epoch: 24, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.468 Vali Acc: 0.489 Test Loss: 1.468 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2367606163024902
Epoch: 25, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.283764123916626
Epoch: 26, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.496 Vali Acc: 0.489 Test Loss: 1.496 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2491912841796875
Epoch: 27, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.522 Vali Acc: 0.473 Test Loss: 1.522 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.289111852645874
Epoch: 28, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.593 Vali Acc: 0.450 Test Loss: 1.593 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1921155452728271
Epoch: 29, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.560 Vali Acc: 0.450 Test Loss: 1.560 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.145104169845581
Epoch: 30, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.484 Vali Acc: 0.489 Test Loss: 1.484 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1995317935943604
Epoch: 31, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.468 Vali Acc: 0.511 Test Loss: 1.468 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 32 cost time: 1.1981914043426514
Epoch: 32, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.477 Vali Acc: 0.519 Test Loss: 1.477 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 33 cost time: 1.1550707817077637
Epoch: 33, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.514 Vali Acc: 0.496 Test Loss: 1.514 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2648344039916992
Epoch: 34, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.483 Vali Acc: 0.511 Test Loss: 1.483 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3726840019226074
Epoch: 35, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.469 Vali Acc: 0.519 Test Loss: 1.469 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 36 cost time: 1.2529363632202148
Epoch: 36, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.459 Vali Acc: 0.496 Test Loss: 1.459 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2109112739562988
Epoch: 37, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.452 Vali Acc: 0.481 Test Loss: 1.452 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1798880100250244
Epoch: 38, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.508 Vali Acc: 0.481 Test Loss: 1.508 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.34084153175354
Epoch: 39, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.507 Vali Acc: 0.496 Test Loss: 1.507 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5405709743499756
Epoch: 40, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.503 Vali Acc: 0.511 Test Loss: 1.503 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3014588356018066
Epoch: 41, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.512 Vali Acc: 0.496 Test Loss: 1.512 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2086808681488037
Epoch: 42, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.506 Vali Acc: 0.504 Test Loss: 1.506 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2190971374511719
Epoch: 43, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.507 Vali Acc: 0.511 Test Loss: 1.507 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.522446632385254
Epoch: 44, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.527 Vali Acc: 0.496 Test Loss: 1.527 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2279729843139648
Epoch: 45, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.510 Vali Acc: 0.504 Test Loss: 1.510 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 185317
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.081246852874756
Epoch: 1, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.635 Vali Acc: 0.153 Test Loss: 1.635 Test Acc: 0.153
Validation loss decreased (inf --> -0.152655).  Saving model ...
Epoch: 2 cost time: 1.128462791442871
Epoch: 2, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.609 Vali Acc: 0.221 Test Loss: 1.609 Test Acc: 0.221
Validation loss decreased (-0.152655 --> -0.221358).  Saving model ...
Epoch: 3 cost time: 1.1658151149749756
Epoch: 3, Steps: 8 | Train Loss: 1.476 Vali Loss: 1.583 Vali Acc: 0.328 Test Loss: 1.583 Test Acc: 0.328
Validation loss decreased (-0.221358 --> -0.328228).  Saving model ...
Epoch: 4 cost time: 1.0541930198669434
Epoch: 4, Steps: 8 | Train Loss: 1.360 Vali Loss: 1.555 Vali Acc: 0.427 Test Loss: 1.555 Test Acc: 0.427
Validation loss decreased (-0.328228 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.0819826126098633
Epoch: 5, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.513 Vali Acc: 0.443 Test Loss: 1.513 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 0.9628233909606934
Epoch: 6, Steps: 8 | Train Loss: 1.105 Vali Loss: 1.500 Vali Acc: 0.427 Test Loss: 1.500 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2395470142364502
Epoch: 7, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.486 Vali Acc: 0.435 Test Loss: 1.486 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.238617181777954
Epoch: 8, Steps: 8 | Train Loss: 0.933 Vali Loss: 1.465 Vali Acc: 0.443 Test Loss: 1.465 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.310640811920166
Epoch: 9, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.465 Vali Acc: 0.466 Test Loss: 1.465 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 1.1243276596069336
Epoch: 10, Steps: 8 | Train Loss: 0.751 Vali Loss: 1.422 Vali Acc: 0.489 Test Loss: 1.422 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 1.2355012893676758
Epoch: 11, Steps: 8 | Train Loss: 0.672 Vali Loss: 1.408 Vali Acc: 0.504 Test Loss: 1.408 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.2857611179351807
Epoch: 12, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 1.263303279876709
Epoch: 13, Steps: 8 | Train Loss: 0.552 Vali Loss: 1.385 Vali Acc: 0.519 Test Loss: 1.385 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.1170873641967773
Epoch: 14, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.369 Vali Acc: 0.489 Test Loss: 1.369 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2291390895843506
Epoch: 15, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.355 Vali Acc: 0.511 Test Loss: 1.355 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2731223106384277
Epoch: 16, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.346 Vali Acc: 0.511 Test Loss: 1.346 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3360540866851807
Epoch: 17, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.339 Vali Acc: 0.519 Test Loss: 1.339 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519071).  Saving model ...
Epoch: 18 cost time: 1.1472985744476318
Epoch: 18, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.339 Vali Acc: 0.519 Test Loss: 1.339 Test Acc: 0.519
Validation loss decreased (-0.519071 --> -0.519071).  Saving model ...
Epoch: 19 cost time: 1.332468032836914
Epoch: 19, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.310 Vali Acc: 0.550 Test Loss: 1.310 Test Acc: 0.550
Validation loss decreased (-0.519071 --> -0.549605).  Saving model ...
Epoch: 20 cost time: 1.1548035144805908
Epoch: 20, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.395 Vali Acc: 0.519 Test Loss: 1.395 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3952045440673828
Epoch: 21, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.335 Vali Acc: 0.573 Test Loss: 1.335 Test Acc: 0.573
Validation loss decreased (-0.549605 --> -0.572506).  Saving model ...
Epoch: 22 cost time: 1.3867506980895996
Epoch: 22, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.363 Vali Acc: 0.557 Test Loss: 1.363 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2818210124969482
Epoch: 23, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.454 Vali Acc: 0.534 Test Loss: 1.454 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2254581451416016
Epoch: 24, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.410 Vali Acc: 0.542 Test Loss: 1.410 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2792282104492188
Epoch: 25, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.378 Vali Acc: 0.534 Test Loss: 1.378 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.465402603149414
Epoch: 26, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.317 Vali Acc: 0.618 Test Loss: 1.317 Test Acc: 0.618
Validation loss decreased (-0.572506 --> -0.618307).  Saving model ...
Epoch: 27 cost time: 1.2452201843261719
Epoch: 27, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.444 Vali Acc: 0.588 Test Loss: 1.444 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2096245288848877
Epoch: 28, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.524 Vali Acc: 0.573 Test Loss: 1.524 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1998813152313232
Epoch: 29, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.478 Vali Acc: 0.519 Test Loss: 1.478 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1349914073944092
Epoch: 30, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.416 Vali Acc: 0.542 Test Loss: 1.416 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2194271087646484
Epoch: 31, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.436 Vali Acc: 0.565 Test Loss: 1.436 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2065513134002686
Epoch: 32, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.460 Vali Acc: 0.550 Test Loss: 1.460 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4017572402954102
Epoch: 33, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.578 Vali Acc: 0.534 Test Loss: 1.578 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.490680456161499
Epoch: 34, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.522 Vali Acc: 0.550 Test Loss: 1.522 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.40950608253479
Epoch: 35, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.468 Vali Acc: 0.519 Test Loss: 1.468 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1769905090332031
Epoch: 36, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.484 Vali Acc: 0.519 Test Loss: 1.484 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 210245
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.264457941055298
Epoch: 1, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.607 Vali Acc: 0.107 Test Loss: 1.607 Test Acc: 0.107
Validation loss decreased (inf --> -0.106854).  Saving model ...
Epoch: 2 cost time: 1.4898269176483154
Epoch: 2, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.585 Vali Acc: 0.229 Test Loss: 1.585 Test Acc: 0.229
Validation loss decreased (-0.106854 --> -0.228992).  Saving model ...
Epoch: 3 cost time: 1.1172256469726562
Epoch: 3, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.562 Vali Acc: 0.450 Test Loss: 1.562 Test Acc: 0.450
Validation loss decreased (-0.228992 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.253234624862671
Epoch: 4, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1465706825256348
Epoch: 5, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2851009368896484
Epoch: 6, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1086153984069824
Epoch: 7, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.506 Vali Acc: 0.420 Test Loss: 1.506 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1294190883636475
Epoch: 8, Steps: 8 | Train Loss: 0.964 Vali Loss: 1.499 Vali Acc: 0.420 Test Loss: 1.499 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4048402309417725
Epoch: 9, Steps: 8 | Train Loss: 0.922 Vali Loss: 1.496 Vali Acc: 0.420 Test Loss: 1.496 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.377821445465088
Epoch: 10, Steps: 8 | Train Loss: 0.851 Vali Loss: 1.479 Vali Acc: 0.420 Test Loss: 1.479 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1632874011993408
Epoch: 11, Steps: 8 | Train Loss: 0.791 Vali Loss: 1.485 Vali Acc: 0.427 Test Loss: 1.485 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2618184089660645
Epoch: 12, Steps: 8 | Train Loss: 0.750 Vali Loss: 1.475 Vali Acc: 0.443 Test Loss: 1.475 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.135418176651001
Epoch: 13, Steps: 8 | Train Loss: 0.681 Vali Loss: 1.458 Vali Acc: 0.458 Test Loss: 1.458 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458001).  Saving model ...
Epoch: 14 cost time: 1.247187614440918
Epoch: 14, Steps: 8 | Train Loss: 0.572 Vali Loss: 1.484 Vali Acc: 0.458 Test Loss: 1.484 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1728837490081787
Epoch: 15, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.461 Vali Acc: 0.458 Test Loss: 1.461 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2956089973449707
Epoch: 16, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.458 Vali Acc: 0.458 Test Loss: 1.458 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 17 cost time: 1.4898204803466797
Epoch: 17, Steps: 8 | Train Loss: 0.471 Vali Loss: 1.515 Vali Acc: 0.450 Test Loss: 1.515 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.355597734451294
Epoch: 18, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2748141288757324
Epoch: 19, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.482 Vali Acc: 0.458 Test Loss: 1.482 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3266370296478271
Epoch: 20, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.478 Vali Acc: 0.473 Test Loss: 1.478 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 21 cost time: 1.4256117343902588
Epoch: 21, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.483 Vali Acc: 0.466 Test Loss: 1.483 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4349861145019531
Epoch: 22, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.508 Vali Acc: 0.466 Test Loss: 1.508 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3763022422790527
Epoch: 23, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.537 Vali Acc: 0.466 Test Loss: 1.537 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0357160568237305
Epoch: 24, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.484 Vali Acc: 0.489 Test Loss: 1.484 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 25 cost time: 0.9781124591827393
Epoch: 25, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.500 Vali Acc: 0.481 Test Loss: 1.500 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3301630020141602
Epoch: 26, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.522 Vali Acc: 0.489 Test Loss: 1.522 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2060704231262207
Epoch: 27, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.563 Vali Acc: 0.481 Test Loss: 1.563 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.38515305519104
Epoch: 28, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.610 Vali Acc: 0.458 Test Loss: 1.610 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3531205654144287
Epoch: 29, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.546 Vali Acc: 0.450 Test Loss: 1.546 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.214113712310791
Epoch: 30, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.544 Vali Acc: 0.481 Test Loss: 1.544 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.221144199371338
Epoch: 31, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.528 Vali Acc: 0.481 Test Loss: 1.528 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2636399269104004
Epoch: 32, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.497 Vali Acc: 0.466 Test Loss: 1.497 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.38551926612854
Epoch: 33, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.504 Vali Acc: 0.466 Test Loss: 1.504 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2511444091796875
Epoch: 34, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.545 Vali Acc: 0.458 Test Loss: 1.545 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 237093
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4471373558044434
Epoch: 1, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.576 Vali Acc: 0.420 Test Loss: 1.576 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2689378261566162
Epoch: 2, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.406 Vali Acc: 0.542 Test Loss: 1.406 Test Acc: 0.542
Validation loss decreased (-0.419832 --> -0.541971).  Saving model ...
Epoch: 3 cost time: 1.2351047992706299
Epoch: 3, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.290 Vali Acc: 0.519 Test Loss: 1.290 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1580603122711182
Epoch: 4, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.567 Vali Acc: 0.519 Test Loss: 1.567 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4447734355926514
Epoch: 5, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.052 Vali Acc: 0.595 Test Loss: 1.052 Test Acc: 0.595
Validation loss decreased (-0.541971 --> -0.595409).  Saving model ...
Epoch: 6 cost time: 1.1078245639801025
Epoch: 6, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.477 Vali Acc: 0.565 Test Loss: 1.477 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.280458927154541
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.416 Vali Acc: 0.557 Test Loss: 1.416 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9878435134887695
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.334 Vali Acc: 0.542 Test Loss: 2.334 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3215746879577637
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.243 Vali Acc: 0.550 Test Loss: 2.243 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2367544174194336
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.122 Vali Acc: 0.550 Test Loss: 2.122 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1788620948791504
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.837 Vali Acc: 0.557 Test Loss: 1.837 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1301016807556152
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.977 Vali Acc: 0.557 Test Loss: 1.977 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1592309474945068
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.290 Vali Acc: 0.542 Test Loss: 2.290 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1736557483673096
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.393 Vali Acc: 0.550 Test Loss: 2.393 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.206221580505371
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.442 Vali Acc: 0.550 Test Loss: 2.442 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 1568005
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.686633586883545
Epoch: 1, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.613 Vali Acc: 0.420 Test Loss: 1.613 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.469078779220581
Epoch: 2, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.0588769912719727
Epoch: 3, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.392 Vali Acc: 0.458 Test Loss: 1.392 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.2029507160186768
Epoch: 4, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.417 Vali Acc: 0.527 Test Loss: 1.417 Test Acc: 0.527
Validation loss decreased (-0.458001 --> -0.526703).  Saving model ...
Epoch: 5 cost time: 1.064009189605713
Epoch: 5, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.653 Vali Acc: 0.519 Test Loss: 1.653 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5602304935455322
Epoch: 6, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.367 Vali Acc: 0.519 Test Loss: 1.367 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2433135509490967
Epoch: 7, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.657 Vali Acc: 0.519 Test Loss: 1.657 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.036377191543579
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.067 Vali Acc: 0.519 Test Loss: 2.067 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.299475908279419
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.311 Vali Acc: 0.519 Test Loss: 2.311 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3480126857757568
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.046 Vali Acc: 0.519 Test Loss: 2.046 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1936964988708496
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.687 Vali Acc: 0.534 Test Loss: 1.687 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534334).  Saving model ...
Epoch: 12 cost time: 1.3025715351104736
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.536 Vali Acc: 0.534 Test Loss: 1.536 Test Acc: 0.534
Validation loss decreased (-0.534334 --> -0.534336).  Saving model ...
Epoch: 13 cost time: 1.130448341369629
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.591 Vali Acc: 0.534 Test Loss: 1.591 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1684670448303223
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.889 Vali Acc: 0.519 Test Loss: 1.889 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4676384925842285
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.197 Vali Acc: 0.519 Test Loss: 2.197 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.484562873840332
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.362 Vali Acc: 0.573 Test Loss: 1.362 Test Acc: 0.573
Validation loss decreased (-0.534336 --> -0.572505).  Saving model ...
Epoch: 17 cost time: 1.2437901496887207
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.038 Vali Acc: 0.519 Test Loss: 2.038 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3720154762268066
Epoch: 18, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.578 Vali Acc: 0.527 Test Loss: 2.578 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2452335357666016
Epoch: 19, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.944 Vali Acc: 0.527 Test Loss: 1.944 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2785675525665283
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.417 Vali Acc: 0.527 Test Loss: 2.417 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3156523704528809
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.352 Vali Acc: 0.527 Test Loss: 2.352 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2285385131835938
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.688 Vali Acc: 0.565 Test Loss: 1.688 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2599475383758545
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.680 Vali Acc: 0.557 Test Loss: 1.680 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.370319128036499
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.548 Vali Acc: 0.527 Test Loss: 2.548 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1108605861663818
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.044 Vali Acc: 0.542 Test Loss: 2.044 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2820937633514404
Epoch: 26, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.122 Vali Acc: 0.534 Test Loss: 2.122 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 1376005
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.391571283340454
Epoch: 1, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.565 Vali Acc: 0.405 Test Loss: 1.565 Test Acc: 0.405
Validation loss decreased (inf --> -0.404565).  Saving model ...
Epoch: 2 cost time: 1.117962121963501
Epoch: 2, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.404565 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2852303981781006
Epoch: 3, Steps: 8 | Train Loss: 0.807 Vali Loss: 1.404 Vali Acc: 0.504 Test Loss: 1.404 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.1010854244232178
Epoch: 4, Steps: 8 | Train Loss: 0.415 Vali Loss: 1.481 Vali Acc: 0.473 Test Loss: 1.481 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2460167407989502
Epoch: 5, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.3607990741729736
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.281111240386963
Epoch: 7, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.491 Vali Acc: 0.527 Test Loss: 1.491 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.219200611114502
Epoch: 8, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4010088443756104
Epoch: 9, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.596 Vali Acc: 0.519 Test Loss: 1.596 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.182800531387329
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.759 Vali Acc: 0.527 Test Loss: 1.759 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.355999231338501
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.864 Vali Acc: 0.527 Test Loss: 1.864 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1905596256256104
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.836 Vali Acc: 0.519 Test Loss: 1.836 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2573812007904053
Epoch: 13, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.975 Vali Acc: 0.519 Test Loss: 1.975 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2176332473754883
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.554 Vali Acc: 0.527 Test Loss: 1.554 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0581638813018799
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.777 Vali Acc: 0.534 Test Loss: 1.777 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534333).  Saving model ...
Epoch: 16 cost time: 1.1767585277557373
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.743 Vali Acc: 0.534 Test Loss: 1.743 Test Acc: 0.534
Validation loss decreased (-0.534333 --> -0.534334).  Saving model ...
Epoch: 17 cost time: 1.426133632659912
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.438 Vali Acc: 0.550 Test Loss: 1.438 Test Acc: 0.550
Validation loss decreased (-0.534334 --> -0.549604).  Saving model ...
Epoch: 18 cost time: 1.080463171005249
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.362 Vali Acc: 0.557 Test Loss: 1.362 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557238).  Saving model ...
Epoch: 19 cost time: 1.111642837524414
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.736 Vali Acc: 0.519 Test Loss: 1.736 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2444770336151123
Epoch: 20, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.509 Vali Acc: 0.519 Test Loss: 1.509 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.363323450088501
Epoch: 21, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.652 Vali Acc: 0.542 Test Loss: 1.652 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3348352909088135
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.910 Vali Acc: 0.534 Test Loss: 1.910 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3233957290649414
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.173 Vali Acc: 0.519 Test Loss: 2.173 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1333250999450684
Epoch: 24, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.617 Vali Acc: 0.588 Test Loss: 1.617 Test Acc: 0.588
Validation loss decreased (-0.557238 --> -0.587770).  Saving model ...
Epoch: 25 cost time: 1.4251453876495361
Epoch: 25, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.008 Vali Acc: 0.527 Test Loss: 2.008 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.46285080909729
Epoch: 26, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.455 Vali Acc: 0.557 Test Loss: 1.455 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2633707523345947
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 3.725 Vali Acc: 0.519 Test Loss: 3.725 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3213677406311035
Epoch: 28, Steps: 8 | Train Loss: 0.075 Vali Loss: 2.558 Vali Acc: 0.519 Test Loss: 2.558 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2875585556030273
Epoch: 29, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.632 Vali Acc: 0.557 Test Loss: 1.632 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2476825714111328
Epoch: 30, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.934 Vali Acc: 0.557 Test Loss: 1.934 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6253941059112549
Epoch: 31, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.100 Vali Acc: 0.534 Test Loss: 2.100 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0804619789123535
Epoch: 32, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.254 Vali Acc: 0.534 Test Loss: 2.254 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2688860893249512
Epoch: 33, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.926 Vali Acc: 0.504 Test Loss: 1.926 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1648647785186768
Epoch: 34, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.973 Vali Acc: 0.565 Test Loss: 1.973 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1391109
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.058411121368408
Epoch: 1, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.588 Vali Acc: 0.389 Test Loss: 1.588 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.229781150817871
Epoch: 2, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.239654541015625
Epoch: 3, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.405 Vali Acc: 0.527 Test Loss: 1.405 Test Acc: 0.527
Validation loss decreased (-0.419832 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 1.2772808074951172
Epoch: 4, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3679378032684326
Epoch: 5, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.328 Vali Acc: 0.534 Test Loss: 1.328 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 6 cost time: 1.0136680603027344
Epoch: 6, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.505 Vali Acc: 0.519 Test Loss: 1.505 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3863344192504883
Epoch: 7, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.393 Vali Acc: 0.527 Test Loss: 1.393 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.513084888458252
Epoch: 8, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.386 Vali Acc: 0.550 Test Loss: 1.386 Test Acc: 0.550
Validation loss decreased (-0.534338 --> -0.549604).  Saving model ...
Epoch: 9 cost time: 1.2127726078033447
Epoch: 9, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.340 Vali Acc: 0.565 Test Loss: 1.340 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564872).  Saving model ...
Epoch: 10 cost time: 1.0676870346069336
Epoch: 10, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.241912841796875
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1779122352600098
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.439 Vali Acc: 0.573 Test Loss: 1.439 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
Epoch: 13 cost time: 1.0881550312042236
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.466 Vali Acc: 0.542 Test Loss: 1.466 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.905742883682251
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.819 Vali Acc: 0.542 Test Loss: 1.819 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.066770315170288
Epoch: 15, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.577 Vali Acc: 0.534 Test Loss: 1.577 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.477593183517456
Epoch: 16, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.755 Vali Acc: 0.557 Test Loss: 1.755 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9968059062957764
Epoch: 17, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.868 Vali Acc: 0.565 Test Loss: 1.868 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1201646327972412
Epoch: 18, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.936 Vali Acc: 0.527 Test Loss: 1.936 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2447259426116943
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.643 Vali Acc: 0.519 Test Loss: 2.643 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1321425437927246
Epoch: 20, Steps: 8 | Train Loss: 0.067 Vali Loss: 2.058 Vali Acc: 0.527 Test Loss: 2.058 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3169646263122559
Epoch: 21, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.628 Vali Acc: 0.557 Test Loss: 1.628 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2964832782745361
Epoch: 22, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.013 Vali Acc: 0.603 Test Loss: 2.013 Test Acc: 0.603
Validation loss decreased (-0.572505 --> -0.603033).  Saving model ...
Epoch: 23 cost time: 1.1425325870513916
Epoch: 23, Steps: 8 | Train Loss: 0.043 Vali Loss: 2.026 Vali Acc: 0.542 Test Loss: 2.026 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3318755626678467
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.912 Vali Acc: 0.595 Test Loss: 1.912 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3577702045440674
Epoch: 25, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.605 Vali Acc: 0.550 Test Loss: 1.605 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.210937261581421
Epoch: 26, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.953 Vali Acc: 0.580 Test Loss: 1.953 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2279772758483887
Epoch: 27, Steps: 8 | Train Loss: 0.059 Vali Loss: 2.068 Vali Acc: 0.550 Test Loss: 2.068 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.189399242401123
Epoch: 28, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.770 Vali Acc: 0.550 Test Loss: 1.770 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4346063137054443
Epoch: 29, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.743 Vali Acc: 0.580 Test Loss: 1.743 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3879055976867676
Epoch: 30, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.331 Vali Acc: 0.550 Test Loss: 2.331 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1551103591918945
Epoch: 31, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.184 Vali Acc: 0.527 Test Loss: 2.184 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2775013446807861
Epoch: 32, Steps: 8 | Train Loss: 0.065 Vali Loss: 2.181 Vali Acc: 0.565 Test Loss: 2.181 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 1452549
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.985541582107544
Epoch: 1, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.592 Vali Acc: 0.412 Test Loss: 1.592 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.326296329498291
Epoch: 2, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1502902507781982
Epoch: 3, Steps: 8 | Train Loss: 0.859 Vali Loss: 1.490 Vali Acc: 0.435 Test Loss: 1.490 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.106738567352295
Epoch: 4, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.410 Vali Acc: 0.489 Test Loss: 1.410 Test Acc: 0.489
Validation loss decreased (-0.435100 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.2166497707366943
Epoch: 5, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.436 Vali Acc: 0.481 Test Loss: 1.436 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3978943824768066
Epoch: 6, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.473 Vali Acc: 0.504 Test Loss: 1.473 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 1.2958984375
Epoch: 7, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.487 Vali Acc: 0.511 Test Loss: 1.487 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.1136205196380615
Epoch: 8, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.528 Vali Acc: 0.504 Test Loss: 1.528 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0999760627746582
Epoch: 9, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.2073619365692139
Epoch: 10, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.436 Vali Acc: 0.519 Test Loss: 1.436 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2713291645050049
Epoch: 11, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 12 cost time: 1.2449800968170166
Epoch: 12, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.386 Vali Acc: 0.534 Test Loss: 1.386 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.1275482177734375
Epoch: 13, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.378 Vali Acc: 0.534 Test Loss: 1.378 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 1.346372127532959
Epoch: 14, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.329162359237671
Epoch: 15, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.575 Vali Acc: 0.511 Test Loss: 1.575 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.144352912902832
Epoch: 16, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.427 Vali Acc: 0.519 Test Loss: 1.427 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2291805744171143
Epoch: 17, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.490 Vali Acc: 0.511 Test Loss: 1.490 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.104405403137207
Epoch: 18, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1726634502410889
Epoch: 19, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.619 Vali Acc: 0.511 Test Loss: 1.619 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2100672721862793
Epoch: 20, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.462 Vali Acc: 0.519 Test Loss: 1.462 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1126377582550049
Epoch: 21, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.069328784942627
Epoch: 22, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.529 Vali Acc: 0.534 Test Loss: 1.529 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1080775260925293
Epoch: 23, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.596 Vali Acc: 0.504 Test Loss: 1.596 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1636613
model size : 6.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3303658962249756
Epoch: 1, Steps: 8 | Train Loss: 1.670 Vali Loss: 1.577 Vali Acc: 0.305 Test Loss: 1.577 Test Acc: 0.305
Validation loss decreased (inf --> -0.305328).  Saving model ...
Epoch: 2 cost time: 1.4543819427490234
Epoch: 2, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
Validation loss decreased (-0.305328 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4509456157684326
Epoch: 3, Steps: 8 | Train Loss: 0.835 Vali Loss: 1.427 Vali Acc: 0.473 Test Loss: 1.427 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.1400301456451416
Epoch: 4, Steps: 8 | Train Loss: 0.497 Vali Loss: 1.314 Vali Acc: 0.557 Test Loss: 1.314 Test Acc: 0.557
Validation loss decreased (-0.473268 --> -0.557239).  Saving model ...
Epoch: 5 cost time: 1.4594495296478271
Epoch: 5, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.307 Vali Acc: 0.534 Test Loss: 1.307 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4688830375671387
Epoch: 6, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.282 Vali Acc: 0.534 Test Loss: 1.282 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3103413581848145
Epoch: 7, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.265 Vali Acc: 0.542 Test Loss: 1.265 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4603140354156494
Epoch: 8, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.277 Vali Acc: 0.550 Test Loss: 1.277 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.346916913986206
Epoch: 9, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.337 Vali Acc: 0.557 Test Loss: 1.337 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2917206287384033
Epoch: 10, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.350 Vali Acc: 0.550 Test Loss: 1.350 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.018911600112915
Epoch: 11, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.419 Vali Acc: 0.550 Test Loss: 1.419 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3737261295318604
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.342 Vali Acc: 0.550 Test Loss: 1.342 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.279343843460083
Epoch: 13, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.281 Vali Acc: 0.557 Test Loss: 1.281 Test Acc: 0.557
Validation loss decreased (-0.557239 --> -0.557239).  Saving model ...
Epoch: 14 cost time: 1.3354089260101318
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.391 Vali Acc: 0.542 Test Loss: 1.391 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3475143909454346
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.356 Vali Acc: 0.565 Test Loss: 1.356 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564872).  Saving model ...
Epoch: 16 cost time: 1.2907588481903076
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.314 Vali Acc: 0.565 Test Loss: 1.314 Test Acc: 0.565
Validation loss decreased (-0.564872 --> -0.564872).  Saving model ...
Epoch: 17 cost time: 1.4095368385314941
Epoch: 17, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.309 Vali Acc: 0.565 Test Loss: 1.309 Test Acc: 0.565
Validation loss decreased (-0.564872 --> -0.564872).  Saving model ...
Epoch: 18 cost time: 1.181161642074585
Epoch: 18, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.354 Vali Acc: 0.557 Test Loss: 1.354 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2656879425048828
Epoch: 19, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.433 Vali Acc: 0.557 Test Loss: 1.433 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1854097843170166
Epoch: 20, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.475 Vali Acc: 0.550 Test Loss: 1.475 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3745663166046143
Epoch: 21, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.718 Vali Acc: 0.573 Test Loss: 1.718 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572502).  Saving model ...
Epoch: 22 cost time: 1.3118999004364014
Epoch: 22, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.607 Vali Acc: 0.565 Test Loss: 1.607 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.449211597442627
Epoch: 23, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.577 Vali Acc: 0.565 Test Loss: 1.577 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1469001770019531
Epoch: 24, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.732 Vali Acc: 0.542 Test Loss: 1.732 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3628177642822266
Epoch: 25, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.446 Vali Acc: 0.542 Test Loss: 1.446 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3350708484649658
Epoch: 26, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.335 Vali Acc: 0.588 Test Loss: 1.335 Test Acc: 0.588
Validation loss decreased (-0.572502 --> -0.587773).  Saving model ...
Epoch: 27 cost time: 1.2262048721313477
Epoch: 27, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.379 Vali Acc: 0.603 Test Loss: 1.379 Test Acc: 0.603
Validation loss decreased (-0.587773 --> -0.603040).  Saving model ...
Epoch: 28 cost time: 1.5184075832366943
Epoch: 28, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.321 Vali Acc: 0.580 Test Loss: 1.321 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3951923847198486
Epoch: 29, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.445 Vali Acc: 0.580 Test Loss: 1.445 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1564135551452637
Epoch: 30, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.496 Vali Acc: 0.557 Test Loss: 1.496 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3120462894439697
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.373 Vali Acc: 0.519 Test Loss: 1.373 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2735388278961182
Epoch: 32, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.303 Vali Acc: 0.542 Test Loss: 1.303 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.278120756149292
Epoch: 33, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.764 Vali Acc: 0.580 Test Loss: 1.764 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2078382968902588
Epoch: 34, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.449 Vali Acc: 0.580 Test Loss: 1.449 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2717235088348389
Epoch: 35, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4456920623779297
Epoch: 36, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.021 Vali Acc: 0.534 Test Loss: 2.021 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2266075611114502
Epoch: 37, Steps: 8 | Train Loss: 0.069 Vali Loss: 2.000 Vali Acc: 0.550 Test Loss: 2.000 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 1836037
model size : 7.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7914927005767822
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.624 Vali Acc: 0.275 Test Loss: 1.624 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 1.3648416996002197
Epoch: 2, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.575 Vali Acc: 0.435 Test Loss: 1.575 Test Acc: 0.435
Validation loss decreased (-0.274793 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.381657600402832
Epoch: 3, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.542 Vali Acc: 0.427 Test Loss: 1.542 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3138415813446045
Epoch: 4, Steps: 8 | Train Loss: 0.582 Vali Loss: 1.516 Vali Acc: 0.473 Test Loss: 1.516 Test Acc: 0.473
Validation loss decreased (-0.435099 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.396620750427246
Epoch: 5, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.507 Vali Acc: 0.473 Test Loss: 1.507 Test Acc: 0.473
Validation loss decreased (-0.473267 --> -0.473267).  Saving model ...
Epoch: 6 cost time: 1.3760433197021484
Epoch: 6, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.575 Vali Acc: 0.458 Test Loss: 1.575 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4921071529388428
Epoch: 7, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.561 Vali Acc: 0.450 Test Loss: 1.561 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5323598384857178
Epoch: 8, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.590 Vali Acc: 0.466 Test Loss: 1.590 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.670830488204956
Epoch: 9, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.547 Vali Acc: 0.489 Test Loss: 1.547 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488534).  Saving model ...
Epoch: 10 cost time: 1.425628900527954
Epoch: 10, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.543 Vali Acc: 0.489 Test Loss: 1.543 Test Acc: 0.489
Validation loss decreased (-0.488534 --> -0.488534).  Saving model ...
Epoch: 11 cost time: 1.4069311618804932
Epoch: 11, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.555 Vali Acc: 0.473 Test Loss: 1.555 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.474663257598877
Epoch: 12, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.613 Vali Acc: 0.511 Test Loss: 1.613 Test Acc: 0.511
Validation loss decreased (-0.488534 --> -0.511434).  Saving model ...
Epoch: 13 cost time: 1.6071250438690186
Epoch: 13, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.660 Vali Acc: 0.466 Test Loss: 1.660 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2515275478363037
Epoch: 14, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.611 Vali Acc: 0.481 Test Loss: 1.611 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4427332878112793
Epoch: 15, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.564 Vali Acc: 0.489 Test Loss: 1.564 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.638603925704956
Epoch: 16, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.591 Vali Acc: 0.458 Test Loss: 1.591 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4069390296936035
Epoch: 17, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.535 Vali Acc: 0.511 Test Loss: 1.535 Test Acc: 0.511
Validation loss decreased (-0.511434 --> -0.511435).  Saving model ...
Epoch: 18 cost time: 1.4762983322143555
Epoch: 18, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.569 Vali Acc: 0.511 Test Loss: 1.569 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3854796886444092
Epoch: 19, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.650 Vali Acc: 0.473 Test Loss: 1.650 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6508972644805908
Epoch: 20, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.623 Vali Acc: 0.466 Test Loss: 1.623 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5438117980957031
Epoch: 21, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.631 Vali Acc: 0.481 Test Loss: 1.631 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4037129878997803
Epoch: 22, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.655 Vali Acc: 0.450 Test Loss: 1.655 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4732921123504639
Epoch: 23, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.572 Vali Acc: 0.458 Test Loss: 1.572 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7653710842132568
Epoch: 24, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.534 Vali Acc: 0.443 Test Loss: 1.534 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4417223930358887
Epoch: 25, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.543 Vali Acc: 0.481 Test Loss: 1.543 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3320457935333252
Epoch: 26, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.572 Vali Acc: 0.473 Test Loss: 1.572 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6988463401794434
Epoch: 27, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.622 Vali Acc: 0.458 Test Loss: 1.622 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2058501
model size : 7.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0290253162384033
Epoch: 1, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1281678676605225
Epoch: 2, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.449 Vali Acc: 0.427 Test Loss: 1.449 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.0490477085113525
Epoch: 3, Steps: 8 | Train Loss: 0.562 Vali Loss: 1.370 Vali Acc: 0.466 Test Loss: 1.370 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.2731597423553467
Epoch: 4, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.301 Vali Acc: 0.527 Test Loss: 1.301 Test Acc: 0.527
Validation loss decreased (-0.465635 --> -0.526705).  Saving model ...
Epoch: 5 cost time: 1.2523245811462402
Epoch: 5, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.744 Vali Acc: 0.519 Test Loss: 1.744 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1231629848480225
Epoch: 6, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3794875144958496
Epoch: 7, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.557 Vali Acc: 0.527 Test Loss: 1.557 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2738227844238281
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.802 Vali Acc: 0.519 Test Loss: 1.802 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.100672721862793
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.495 Vali Acc: 0.534 Test Loss: 1.495 Test Acc: 0.534
Validation loss decreased (-0.526705 --> -0.534336).  Saving model ...
Epoch: 10 cost time: 1.1290018558502197
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.966 Vali Acc: 0.519 Test Loss: 1.966 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1178181171417236
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.478 Vali Acc: 0.519 Test Loss: 2.478 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.355478048324585
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.331 Vali Acc: 0.519 Test Loss: 2.331 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1125438213348389
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.011 Vali Acc: 0.519 Test Loss: 2.011 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9403657913208008
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.027 Vali Acc: 0.519 Test Loss: 2.027 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2682268619537354
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.067 Vali Acc: 0.519 Test Loss: 2.067 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.091550588607788
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.009 Vali Acc: 0.542 Test Loss: 2.009 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541965).  Saving model ...
Epoch: 17 cost time: 1.2036809921264648
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.784 Vali Acc: 0.550 Test Loss: 1.784 Test Acc: 0.550
Validation loss decreased (-0.541965 --> -0.549600).  Saving model ...
Epoch: 18 cost time: 1.4176127910614014
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.076 Vali Acc: 0.534 Test Loss: 2.076 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2099039554595947
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.113 Vali Acc: 0.542 Test Loss: 2.113 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4565808773040771
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.072 Vali Acc: 0.534 Test Loss: 2.072 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.06693434715271
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.222 Vali Acc: 0.550 Test Loss: 2.222 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5197656154632568
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.713 Vali Acc: 0.519 Test Loss: 2.713 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1996676921844482
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.419 Vali Acc: 0.550 Test Loss: 2.419 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.113389492034912
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.797 Vali Acc: 0.519 Test Loss: 2.797 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6403605937957764
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.173 Vali Acc: 0.511 Test Loss: 2.173 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2052664756774902
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.307 Vali Acc: 0.519 Test Loss: 2.307 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2199647426605225
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.747 Vali Acc: 0.534 Test Loss: 1.747 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 587397
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.924351215362549
Epoch: 1, Steps: 8 | Train Loss: 1.669 Vali Loss: 1.584 Vali Acc: 0.412 Test Loss: 1.584 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.0378379821777344
Epoch: 2, Steps: 8 | Train Loss: 1.324 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.0389952659606934
Epoch: 3, Steps: 8 | Train Loss: 0.938 Vali Loss: 1.429 Vali Acc: 0.466 Test Loss: 1.429 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 0.9915676116943359
Epoch: 4, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.339 Vali Acc: 0.511 Test Loss: 1.339 Test Acc: 0.511
Validation loss decreased (-0.465635 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 0.9685847759246826
Epoch: 5, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.429 Vali Acc: 0.496 Test Loss: 1.429 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1682054996490479
Epoch: 6, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.406 Vali Acc: 0.519 Test Loss: 1.406 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.1198513507843018
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.299 Vali Acc: 0.534 Test Loss: 1.299 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534338).  Saving model ...
Epoch: 8 cost time: 1.0594985485076904
Epoch: 8, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.641 Vali Acc: 0.519 Test Loss: 1.641 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0693185329437256
Epoch: 9, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.452 Vali Acc: 0.519 Test Loss: 1.452 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1001856327056885
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.360 Vali Acc: 0.542 Test Loss: 1.360 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 11 cost time: 1.0571184158325195
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.569 Vali Acc: 0.519 Test Loss: 1.569 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1313931941986084
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.680 Vali Acc: 0.527 Test Loss: 1.680 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0723421573638916
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.780 Vali Acc: 0.519 Test Loss: 1.780 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1799559593200684
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.771 Vali Acc: 0.519 Test Loss: 1.771 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0043625831604004
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.859 Vali Acc: 0.519 Test Loss: 1.859 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1521039009094238
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.775 Vali Acc: 0.519 Test Loss: 1.775 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0624747276306152
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.847 Vali Acc: 0.519 Test Loss: 1.847 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0786333084106445
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.539 Vali Acc: 0.534 Test Loss: 1.539 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0590429306030273
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.411 Vali Acc: 0.603 Test Loss: 1.411 Test Acc: 0.603
Validation loss decreased (-0.541971 --> -0.603039).  Saving model ...
Epoch: 20 cost time: 1.0076851844787598
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.557 Vali Acc: 0.550 Test Loss: 1.557 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.310856580734253
Epoch: 21, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.442 Vali Acc: 0.550 Test Loss: 1.442 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2802419662475586
Epoch: 22, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.414 Vali Acc: 0.557 Test Loss: 1.414 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1697187423706055
Epoch: 23, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.794 Vali Acc: 0.527 Test Loss: 1.794 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.140594244003296
Epoch: 24, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.308 Vali Acc: 0.519 Test Loss: 2.308 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0497000217437744
Epoch: 25, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.454 Vali Acc: 0.534 Test Loss: 1.454 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2393977642059326
Epoch: 26, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.140 Vali Acc: 0.595 Test Loss: 1.140 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1286323070526123
Epoch: 27, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.641 Vali Acc: 0.565 Test Loss: 1.641 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.039430856704712
Epoch: 28, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.777 Vali Acc: 0.550 Test Loss: 1.777 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.270369529724121
Epoch: 29, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.586 Vali Acc: 0.557 Test Loss: 1.586 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 491397
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1780781745910645
Epoch: 1, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.560 Vali Acc: 0.427 Test Loss: 1.560 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.0764985084533691
Epoch: 2, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.488 Vali Acc: 0.427 Test Loss: 1.488 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.9993588924407959
Epoch: 3, Steps: 8 | Train Loss: 1.008 Vali Loss: 1.430 Vali Acc: 0.473 Test Loss: 1.430 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.0542638301849365
Epoch: 4, Steps: 8 | Train Loss: 0.681 Vali Loss: 1.368 Vali Acc: 0.489 Test Loss: 1.368 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.2055718898773193
Epoch: 5, Steps: 8 | Train Loss: 0.451 Vali Loss: 1.331 Vali Acc: 0.496 Test Loss: 1.331 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 6 cost time: 1.1067461967468262
Epoch: 6, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.305 Vali Acc: 0.519 Test Loss: 1.305 Test Acc: 0.519
Validation loss decreased (-0.496170 --> -0.519071).  Saving model ...
Epoch: 7 cost time: 1.129697561264038
Epoch: 7, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.251 Vali Acc: 0.527 Test Loss: 1.251 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526705).  Saving model ...
Epoch: 8 cost time: 1.1423633098602295
Epoch: 8, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.346 Vali Acc: 0.527 Test Loss: 1.346 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9762966632843018
Epoch: 9, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.337 Vali Acc: 0.534 Test Loss: 1.337 Test Acc: 0.534
Validation loss decreased (-0.526705 --> -0.534338).  Saving model ...
Epoch: 10 cost time: 1.0464563369750977
Epoch: 10, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.315 Vali Acc: 0.527 Test Loss: 1.315 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0601541996002197
Epoch: 11, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.298 Vali Acc: 0.527 Test Loss: 1.298 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0609538555145264
Epoch: 12, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9553623199462891
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.414 Vali Acc: 0.527 Test Loss: 1.414 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1422457695007324
Epoch: 14, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.424 Vali Acc: 0.527 Test Loss: 1.424 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1641061305999756
Epoch: 15, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.403 Vali Acc: 0.527 Test Loss: 1.403 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1735243797302246
Epoch: 16, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.011626958847046
Epoch: 17, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.387 Vali Acc: 0.534 Test Loss: 1.387 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0203487873077393
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.467 Vali Acc: 0.527 Test Loss: 1.467 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0998890399932861
Epoch: 19, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.696 Vali Acc: 0.519 Test Loss: 1.696 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 498949
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6080751419067383
Epoch: 1, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.602 Vali Acc: 0.374 Test Loss: 1.602 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.218183994293213
Epoch: 2, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.831416130065918
Epoch: 3, Steps: 8 | Train Loss: 1.074 Vali Loss: 1.461 Vali Acc: 0.450 Test Loss: 1.461 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 0.859966516494751
Epoch: 4, Steps: 8 | Train Loss: 0.789 Vali Loss: 1.370 Vali Acc: 0.481 Test Loss: 1.370 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 0.9564809799194336
Epoch: 5, Steps: 8 | Train Loss: 0.546 Vali Loss: 1.313 Vali Acc: 0.496 Test Loss: 1.313 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496170).  Saving model ...
Epoch: 6 cost time: 0.9672739505767822
Epoch: 6, Steps: 8 | Train Loss: 0.360 Vali Loss: 1.288 Vali Acc: 0.542 Test Loss: 1.288 Test Acc: 0.542
Validation loss decreased (-0.496170 --> -0.541972).  Saving model ...
Epoch: 7 cost time: 1.0897729396820068
Epoch: 7, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.295 Vali Acc: 0.527 Test Loss: 1.295 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.001136302947998
Epoch: 8, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.331 Vali Acc: 0.534 Test Loss: 1.331 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0207154750823975
Epoch: 9, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.265 Vali Acc: 0.534 Test Loss: 1.265 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0539216995239258
Epoch: 10, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.291 Vali Acc: 0.550 Test Loss: 1.291 Test Acc: 0.550
Validation loss decreased (-0.541972 --> -0.549605).  Saving model ...
Epoch: 11 cost time: 1.1363990306854248
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.380 Vali Acc: 0.542 Test Loss: 1.380 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0198791027069092
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.352 Vali Acc: 0.542 Test Loss: 1.352 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.024012565612793
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.305 Vali Acc: 0.557 Test Loss: 1.305 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 14 cost time: 1.00276517868042
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.386 Vali Acc: 0.534 Test Loss: 1.386 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2068800926208496
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.369 Vali Acc: 0.542 Test Loss: 1.369 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.235393762588501
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.356 Vali Acc: 0.557 Test Loss: 1.356 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1107714176177979
Epoch: 17, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.354 Vali Acc: 0.573 Test Loss: 1.354 Test Acc: 0.573
Validation loss decreased (-0.557239 --> -0.572506).  Saving model ...
Epoch: 18 cost time: 1.1752254962921143
Epoch: 18, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.477 Vali Acc: 0.542 Test Loss: 1.477 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.054149866104126
Epoch: 19, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.533 Vali Acc: 0.550 Test Loss: 1.533 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1117963790893555
Epoch: 20, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.459 Vali Acc: 0.550 Test Loss: 1.459 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3669085502624512
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.303 Vali Acc: 0.580 Test Loss: 1.303 Test Acc: 0.580
Validation loss decreased (-0.572506 --> -0.580140).  Saving model ...
Epoch: 22 cost time: 1.2156164646148682
Epoch: 22, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0901076793670654
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.294 Vali Acc: 0.565 Test Loss: 1.294 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9012153148651123
Epoch: 24, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.394 Vali Acc: 0.557 Test Loss: 1.394 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2593374252319336
Epoch: 25, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.689 Vali Acc: 0.534 Test Loss: 1.689 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1789147853851318
Epoch: 26, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.444 Vali Acc: 0.565 Test Loss: 1.444 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1131722927093506
Epoch: 27, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.322 Vali Acc: 0.588 Test Loss: 1.322 Test Acc: 0.588
Validation loss decreased (-0.580140 --> -0.587773).  Saving model ...
Epoch: 28 cost time: 1.1804192066192627
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.376 Vali Acc: 0.557 Test Loss: 1.376 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9418618679046631
Epoch: 29, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.426 Vali Acc: 0.573 Test Loss: 1.426 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2205979824066162
Epoch: 30, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.495 Vali Acc: 0.542 Test Loss: 1.495 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1005594730377197
Epoch: 31, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.642 Vali Acc: 0.565 Test Loss: 1.642 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1145846843719482
Epoch: 32, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.521 Vali Acc: 0.565 Test Loss: 1.521 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2445354461669922
Epoch: 33, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1225059032440186
Epoch: 34, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.395 Vali Acc: 0.588 Test Loss: 1.395 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2727766036987305
Epoch: 35, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.629 Vali Acc: 0.550 Test Loss: 1.629 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3248062133789062
Epoch: 36, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.525 Vali Acc: 0.565 Test Loss: 1.525 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0917558670043945
Epoch: 37, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.560 Vali Acc: 0.504 Test Loss: 1.560 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 529669
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.341156244277954
Epoch: 1, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.563 Vali Acc: 0.420 Test Loss: 1.563 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2787668704986572
Epoch: 2, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.519 Vali Acc: 0.427 Test Loss: 1.519 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.309016227722168
Epoch: 3, Steps: 8 | Train Loss: 1.122 Vali Loss: 1.483 Vali Acc: 0.427 Test Loss: 1.483 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 0.9253859519958496
Epoch: 4, Steps: 8 | Train Loss: 0.813 Vali Loss: 1.448 Vali Acc: 0.458 Test Loss: 1.448 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.0545814037322998
Epoch: 5, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.441 Vali Acc: 0.458 Test Loss: 1.441 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.050208330154419
Epoch: 6, Steps: 8 | Train Loss: 0.486 Vali Loss: 1.418 Vali Acc: 0.458 Test Loss: 1.418 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 7 cost time: 1.0376617908477783
Epoch: 7, Steps: 8 | Train Loss: 0.360 Vali Loss: 1.425 Vali Acc: 0.496 Test Loss: 1.425 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.36983323097229
Epoch: 8, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.1738688945770264
Epoch: 9, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.402 Vali Acc: 0.511 Test Loss: 1.402 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.4585256576538086
Epoch: 10, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2039189338684082
Epoch: 11, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.456 Vali Acc: 0.519 Test Loss: 1.456 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 12 cost time: 1.2838664054870605
Epoch: 12, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.408 Vali Acc: 0.511 Test Loss: 1.408 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6133012771606445
Epoch: 13, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.401 Vali Acc: 0.519 Test Loss: 1.401 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 1.0438652038574219
Epoch: 14, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.406 Vali Acc: 0.519 Test Loss: 1.406 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1772327423095703
Epoch: 15, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.428 Vali Acc: 0.527 Test Loss: 1.428 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 16 cost time: 0.9755065441131592
Epoch: 16, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.428 Vali Acc: 0.527 Test Loss: 1.428 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3208324909210205
Epoch: 17, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.406 Vali Acc: 0.527 Test Loss: 1.406 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 18 cost time: 1.4306447505950928
Epoch: 18, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.432 Vali Acc: 0.519 Test Loss: 1.432 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1559233665466309
Epoch: 19, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1863253116607666
Epoch: 20, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.09611177444458
Epoch: 21, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.477 Vali Acc: 0.511 Test Loss: 1.477 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2203803062438965
Epoch: 22, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.422 Vali Acc: 0.511 Test Loss: 1.422 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3723068237304688
Epoch: 23, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.334 Vali Acc: 0.481 Test Loss: 1.334 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0470623970031738
Epoch: 24, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.388 Vali Acc: 0.511 Test Loss: 1.388 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1859028339385986
Epoch: 25, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.371 Vali Acc: 0.511 Test Loss: 1.371 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9111313819885254
Epoch: 26, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.354 Vali Acc: 0.534 Test Loss: 1.354 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534338).  Saving model ...
Epoch: 27 cost time: 1.1618313789367676
Epoch: 27, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.362 Vali Acc: 0.527 Test Loss: 1.362 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3646302223205566
Epoch: 28, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2005069255828857
Epoch: 29, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.380 Vali Acc: 0.519 Test Loss: 1.380 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2710938453674316
Epoch: 30, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.349 Vali Acc: 0.542 Test Loss: 1.349 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 31 cost time: 1.1418464183807373
Epoch: 31, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.329 Vali Acc: 0.534 Test Loss: 1.329 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2577290534973145
Epoch: 32, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.374 Vali Acc: 0.527 Test Loss: 1.374 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.266150712966919
Epoch: 33, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.481 Vali Acc: 0.534 Test Loss: 1.481 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.150132656097412
Epoch: 34, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.545 Vali Acc: 0.504 Test Loss: 1.545 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1600427627563477
Epoch: 35, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4375526905059814
Epoch: 36, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.427 Vali Acc: 0.542 Test Loss: 1.427 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1704955101013184
Epoch: 37, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.424 Vali Acc: 0.534 Test Loss: 1.424 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.176712989807129
Epoch: 38, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.389 Vali Acc: 0.527 Test Loss: 1.389 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3470091819763184
Epoch: 39, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.529 Vali Acc: 0.511 Test Loss: 1.529 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.234363317489624
Epoch: 40, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.533 Vali Acc: 0.519 Test Loss: 1.533 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 621701
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0391685962677
Epoch: 1, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.657 Vali Acc: 0.176 Test Loss: 1.657 Test Acc: 0.176
Validation loss decreased (inf --> -0.175556).  Saving model ...
Epoch: 2 cost time: 1.2765130996704102
Epoch: 2, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.597 Vali Acc: 0.389 Test Loss: 1.597 Test Acc: 0.389
Validation loss decreased (-0.175556 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.1704275608062744
Epoch: 3, Steps: 8 | Train Loss: 1.058 Vali Loss: 1.538 Vali Acc: 0.466 Test Loss: 1.538 Test Acc: 0.466
Validation loss decreased (-0.389297 --> -0.465633).  Saving model ...
Epoch: 4 cost time: 0.9285097122192383
Epoch: 4, Steps: 8 | Train Loss: 0.767 Vali Loss: 1.484 Vali Acc: 0.481 Test Loss: 1.484 Test Acc: 0.481
Validation loss decreased (-0.465633 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 0.9412152767181396
Epoch: 5, Steps: 8 | Train Loss: 0.534 Vali Loss: 1.442 Vali Acc: 0.534 Test Loss: 1.442 Test Acc: 0.534
Validation loss decreased (-0.480901 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 1.0876524448394775
Epoch: 6, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.435 Vali Acc: 0.534 Test Loss: 1.435 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 7 cost time: 1.149341106414795
Epoch: 7, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.490 Vali Acc: 0.534 Test Loss: 1.490 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3245046138763428
Epoch: 8, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.450 Vali Acc: 0.557 Test Loss: 1.450 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557237).  Saving model ...
Epoch: 9 cost time: 1.062516689300537
Epoch: 9, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.521 Vali Acc: 0.557 Test Loss: 1.521 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.203942060470581
Epoch: 10, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.524 Vali Acc: 0.534 Test Loss: 1.524 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3164136409759521
Epoch: 11, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.595 Vali Acc: 0.534 Test Loss: 1.595 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2145049571990967
Epoch: 12, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.561 Vali Acc: 0.557 Test Loss: 1.561 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2610609531402588
Epoch: 13, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.504 Vali Acc: 0.565 Test Loss: 1.504 Test Acc: 0.565
Validation loss decreased (-0.557237 --> -0.564870).  Saving model ...
Epoch: 14 cost time: 1.2937676906585693
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.562 Vali Acc: 0.550 Test Loss: 1.562 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0644078254699707
Epoch: 15, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.643 Vali Acc: 0.557 Test Loss: 1.643 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0341415405273438
Epoch: 16, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.604 Vali Acc: 0.565 Test Loss: 1.604 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3071849346160889
Epoch: 17, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.553 Vali Acc: 0.557 Test Loss: 1.553 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2495348453521729
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.540 Vali Acc: 0.557 Test Loss: 1.540 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4394853115081787
Epoch: 19, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.678 Vali Acc: 0.557 Test Loss: 1.678 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4866037368774414
Epoch: 20, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.639 Vali Acc: 0.550 Test Loss: 1.639 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6010041236877441
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.538 Vali Acc: 0.565 Test Loss: 1.538 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2249188423156738
Epoch: 22, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.430 Vali Acc: 0.565 Test Loss: 1.430 Test Acc: 0.565
Validation loss decreased (-0.564870 --> -0.564871).  Saving model ...
Epoch: 23 cost time: 1.2876088619232178
Epoch: 23, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.648 Vali Acc: 0.542 Test Loss: 1.648 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.99796462059021
Epoch: 24, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.615 Vali Acc: 0.557 Test Loss: 1.615 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1122207641601562
Epoch: 25, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.562 Vali Acc: 0.542 Test Loss: 1.562 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2218677997589111
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.535 Vali Acc: 0.550 Test Loss: 1.535 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.225095510482788
Epoch: 27, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.462 Vali Acc: 0.557 Test Loss: 1.462 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0110487937927246
Epoch: 28, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.395 Vali Acc: 0.565 Test Loss: 1.395 Test Acc: 0.565
Validation loss decreased (-0.564871 --> -0.564872).  Saving model ...
Epoch: 29 cost time: 0.9484624862670898
Epoch: 29, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.488 Vali Acc: 0.557 Test Loss: 1.488 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0129368305206299
Epoch: 30, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.516 Vali Acc: 0.595 Test Loss: 1.516 Test Acc: 0.595
Validation loss decreased (-0.564872 --> -0.595405).  Saving model ...
Epoch: 31 cost time: 1.316617727279663
Epoch: 31, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.394 Vali Acc: 0.580 Test Loss: 1.394 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0847327709197998
Epoch: 32, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.420 Vali Acc: 0.565 Test Loss: 1.420 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0364203453063965
Epoch: 33, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.471 Vali Acc: 0.565 Test Loss: 1.471 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.091588020324707
Epoch: 34, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.534 Vali Acc: 0.557 Test Loss: 1.534 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1086509227752686
Epoch: 35, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.500 Vali Acc: 0.557 Test Loss: 1.500 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2512192726135254
Epoch: 36, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.658 Vali Acc: 0.573 Test Loss: 1.658 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1229374408721924
Epoch: 37, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.402 Vali Acc: 0.573 Test Loss: 1.402 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1744165420532227
Epoch: 38, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.357 Vali Acc: 0.573 Test Loss: 1.357 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.107588768005371
Epoch: 39, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.461 Vali Acc: 0.557 Test Loss: 1.461 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2013747692108154
Epoch: 40, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.505 Vali Acc: 0.565 Test Loss: 1.505 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 721413
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2953577041625977
Epoch: 1, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.609 Vali Acc: 0.252 Test Loss: 1.609 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.0818455219268799
Epoch: 2, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
Validation loss decreased (-0.251892 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1224253177642822
Epoch: 3, Steps: 8 | Train Loss: 1.056 Vali Loss: 1.525 Vali Acc: 0.427 Test Loss: 1.525 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.1499509811401367
Epoch: 4, Steps: 8 | Train Loss: 0.815 Vali Loss: 1.519 Vali Acc: 0.427 Test Loss: 1.519 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.1577961444854736
Epoch: 5, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.510 Vali Acc: 0.435 Test Loss: 1.510 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.341360330581665
Epoch: 6, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.531 Vali Acc: 0.473 Test Loss: 1.531 Test Acc: 0.473
Validation loss decreased (-0.435099 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 1.007185935974121
Epoch: 7, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.486 Vali Acc: 0.496 Test Loss: 1.486 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 1.198911428451538
Epoch: 8, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.504 Vali Acc: 0.489 Test Loss: 1.504 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2927541732788086
Epoch: 9, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.530 Vali Acc: 0.489 Test Loss: 1.530 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.129709243774414
Epoch: 10, Steps: 8 | Train Loss: 0.277 Vali Loss: 1.532 Vali Acc: 0.489 Test Loss: 1.532 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2855656147003174
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.539 Vali Acc: 0.496 Test Loss: 1.539 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2179155349731445
Epoch: 12, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.525 Vali Acc: 0.473 Test Loss: 1.525 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.336611032485962
Epoch: 13, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4286606311798096
Epoch: 14, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.501 Vali Acc: 0.496 Test Loss: 1.501 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0192089080810547
Epoch: 15, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.536 Vali Acc: 0.450 Test Loss: 1.536 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.336472988128662
Epoch: 16, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.562 Vali Acc: 0.458 Test Loss: 1.562 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.240121603012085
Epoch: 17, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.559 Vali Acc: 0.458 Test Loss: 1.559 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 832645
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6389923095703125
Epoch: 1, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1690642833709717
Epoch: 2, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.506 Vali Acc: 0.420 Test Loss: 1.506 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9700803756713867
Epoch: 3, Steps: 8 | Train Loss: 0.871 Vali Loss: 1.422 Vali Acc: 0.435 Test Loss: 1.422 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.1126432418823242
Epoch: 4, Steps: 8 | Train Loss: 0.543 Vali Loss: 1.308 Vali Acc: 0.496 Test Loss: 1.308 Test Acc: 0.496
Validation loss decreased (-0.435100 --> -0.496170).  Saving model ...
Epoch: 5 cost time: 1.0554721355438232
Epoch: 5, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.346 Vali Acc: 0.511 Test Loss: 1.346 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.0403988361358643
Epoch: 6, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.0377881526947021
Epoch: 7, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.1389098167419434
Epoch: 8, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.353 Vali Acc: 0.534 Test Loss: 1.353 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 9 cost time: 0.9471981525421143
Epoch: 9, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.481 Vali Acc: 0.527 Test Loss: 1.481 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2262749671936035
Epoch: 10, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.574 Vali Acc: 0.519 Test Loss: 1.574 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.176788330078125
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.333 Vali Acc: 0.557 Test Loss: 1.333 Test Acc: 0.557
Validation loss decreased (-0.534338 --> -0.557239).  Saving model ...
Epoch: 12 cost time: 1.1335368156433105
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.522 Vali Acc: 0.527 Test Loss: 1.522 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9262840747833252
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.700 Vali Acc: 0.519 Test Loss: 1.700 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0674870014190674
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.706 Vali Acc: 0.519 Test Loss: 1.706 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.059004545211792
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.608 Vali Acc: 0.519 Test Loss: 1.608 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.105778455734253
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.941 Vali Acc: 0.527 Test Loss: 1.941 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1502397060394287
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.115 Vali Acc: 0.519 Test Loss: 2.115 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.986882209777832
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.173 Vali Acc: 0.527 Test Loss: 2.173 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0255050659179688
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.858 Vali Acc: 0.557 Test Loss: 1.858 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1146564483642578
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.196 Vali Acc: 0.527 Test Loss: 2.196 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0521180629730225
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.703 Vali Acc: 0.519 Test Loss: 2.703 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 244549
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7473738193511963
Epoch: 1, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.572 Vali Acc: 0.336 Test Loss: 1.572 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.1519677639007568
Epoch: 2, Steps: 8 | Train Loss: 1.394 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.335862 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.171198844909668
Epoch: 3, Steps: 8 | Train Loss: 1.172 Vali Loss: 1.472 Vali Acc: 0.435 Test Loss: 1.472 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.3194901943206787
Epoch: 4, Steps: 8 | Train Loss: 0.851 Vali Loss: 1.385 Vali Acc: 0.489 Test Loss: 1.385 Test Acc: 0.489
Validation loss decreased (-0.435100 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.2630059719085693
Epoch: 5, Steps: 8 | Train Loss: 0.633 Vali Loss: 1.314 Vali Acc: 0.496 Test Loss: 1.314 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 6 cost time: 0.9237818717956543
Epoch: 6, Steps: 8 | Train Loss: 0.395 Vali Loss: 1.327 Vali Acc: 0.511 Test Loss: 1.327 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511437).  Saving model ...
Epoch: 7 cost time: 1.1863539218902588
Epoch: 7, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526705).  Saving model ...
Epoch: 8 cost time: 1.0224754810333252
Epoch: 8, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.241 Vali Acc: 0.527 Test Loss: 1.241 Test Acc: 0.527
Validation loss decreased (-0.526705 --> -0.526705).  Saving model ...
Epoch: 9 cost time: 0.989844799041748
Epoch: 9, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0564122200012207
Epoch: 10, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.447 Vali Acc: 0.527 Test Loss: 1.447 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1564743518829346
Epoch: 11, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.340 Vali Acc: 0.534 Test Loss: 1.340 Test Acc: 0.534
Validation loss decreased (-0.526705 --> -0.534338).  Saving model ...
Epoch: 12 cost time: 1.1042554378509521
Epoch: 12, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.467 Vali Acc: 0.534 Test Loss: 1.467 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1327383518218994
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.526 Vali Acc: 0.534 Test Loss: 1.526 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2150208950042725
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.506 Vali Acc: 0.542 Test Loss: 1.506 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541970).  Saving model ...
Epoch: 15 cost time: 1.0220413208007812
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.362 Vali Acc: 0.542 Test Loss: 1.362 Test Acc: 0.542
Validation loss decreased (-0.541970 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 1.0562567710876465
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.579 Vali Acc: 0.534 Test Loss: 1.579 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.031986951828003
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0547072887420654
Epoch: 18, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.405 Vali Acc: 0.519 Test Loss: 1.405 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0875177383422852
Epoch: 19, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.455 Vali Acc: 0.534 Test Loss: 1.455 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0722827911376953
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.588 Vali Acc: 0.534 Test Loss: 1.588 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.989757776260376
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.546 Vali Acc: 0.542 Test Loss: 1.546 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8454437255859375
Epoch: 22, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.819 Vali Acc: 0.534 Test Loss: 1.819 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0162379741668701
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.767 Vali Acc: 0.534 Test Loss: 1.767 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0655510425567627
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.876 Vali Acc: 0.534 Test Loss: 1.876 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0579042434692383
Epoch: 25, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.735 Vali Acc: 0.534 Test Loss: 1.735 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 196549
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4772238731384277
Epoch: 1, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.586 Vali Acc: 0.366 Test Loss: 1.586 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 1.0650570392608643
Epoch: 2, Steps: 8 | Train Loss: 1.520 Vali Loss: 1.531 Vali Acc: 0.412 Test Loss: 1.531 Test Acc: 0.412
Validation loss decreased (-0.366396 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 0.9732391834259033
Epoch: 3, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.492 Vali Acc: 0.420 Test Loss: 1.492 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 0.9945251941680908
Epoch: 4, Steps: 8 | Train Loss: 1.007 Vali Loss: 1.466 Vali Acc: 0.435 Test Loss: 1.466 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 0.9215707778930664
Epoch: 5, Steps: 8 | Train Loss: 0.796 Vali Loss: 1.385 Vali Acc: 0.473 Test Loss: 1.385 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473269).  Saving model ...
Epoch: 6 cost time: 1.2231523990631104
Epoch: 6, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.338 Vali Acc: 0.504 Test Loss: 1.338 Test Acc: 0.504
Validation loss decreased (-0.473269 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.0664091110229492
Epoch: 7, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.384 Vali Acc: 0.489 Test Loss: 1.384 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9853055477142334
Epoch: 8, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.357 Vali Acc: 0.519 Test Loss: 1.357 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.1959912776947021
Epoch: 9, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1337451934814453
Epoch: 10, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.362 Vali Acc: 0.519 Test Loss: 1.362 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0115156173706055
Epoch: 11, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.475 Vali Acc: 0.519 Test Loss: 1.475 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0471751689910889
Epoch: 12, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.428 Vali Acc: 0.534 Test Loss: 1.428 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.0348827838897705
Epoch: 13, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.422 Vali Acc: 0.534 Test Loss: 1.422 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 0.9941163063049316
Epoch: 14, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.455 Vali Acc: 0.519 Test Loss: 1.455 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0153663158416748
Epoch: 15, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.518 Vali Acc: 0.519 Test Loss: 1.518 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.208364486694336
Epoch: 16, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.496 Vali Acc: 0.519 Test Loss: 1.496 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2096846103668213
Epoch: 17, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.505 Vali Acc: 0.534 Test Loss: 1.505 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1912143230438232
Epoch: 18, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.424 Vali Acc: 0.534 Test Loss: 1.424 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0558252334594727
Epoch: 19, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.433 Vali Acc: 0.534 Test Loss: 1.433 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1467983722686768
Epoch: 20, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.475 Vali Acc: 0.519 Test Loss: 1.475 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2417490482330322
Epoch: 21, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.434 Vali Acc: 0.527 Test Loss: 1.434 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4569311141967773
Epoch: 22, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.504 Vali Acc: 0.519 Test Loss: 1.504 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2145485877990723
Epoch: 23, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.477 Vali Acc: 0.519 Test Loss: 1.477 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 200325
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.331707715988159
Epoch: 1, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.631 Vali Acc: 0.244 Test Loss: 1.631 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 1.1673579216003418
Epoch: 2, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.591 Vali Acc: 0.366 Test Loss: 1.591 Test Acc: 0.366
Validation loss decreased (-0.244258 --> -0.366396).  Saving model ...
Epoch: 3 cost time: 1.000394344329834
Epoch: 3, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.566 Vali Acc: 0.443 Test Loss: 1.566 Test Acc: 0.443
Validation loss decreased (-0.366396 --> -0.442732).  Saving model ...
Epoch: 4 cost time: 1.097484827041626
Epoch: 4, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.519 Vali Acc: 0.473 Test Loss: 1.519 Test Acc: 0.473
Validation loss decreased (-0.442732 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.1839268207550049
Epoch: 5, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.444 Vali Acc: 0.481 Test Loss: 1.444 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.1896955966949463
Epoch: 6, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.451 Vali Acc: 0.473 Test Loss: 1.451 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2222626209259033
Epoch: 7, Steps: 8 | Train Loss: 0.500 Vali Loss: 1.437 Vali Acc: 0.496 Test Loss: 1.437 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.0384430885314941
Epoch: 8, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.383 Vali Acc: 0.496 Test Loss: 1.383 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 0.9638667106628418
Epoch: 9, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.362 Vali Acc: 0.519 Test Loss: 1.362 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.1486515998840332
Epoch: 10, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.424 Vali Acc: 0.519 Test Loss: 1.424 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9423232078552246
Epoch: 11, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.441 Vali Acc: 0.511 Test Loss: 1.441 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.000805139541626
Epoch: 12, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.390 Vali Acc: 0.527 Test Loss: 1.390 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 13 cost time: 0.9768249988555908
Epoch: 13, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 14 cost time: 1.014631748199463
Epoch: 14, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0961124897003174
Epoch: 15, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1501286029815674
Epoch: 16, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2870867252349854
Epoch: 17, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.532 Vali Acc: 0.519 Test Loss: 1.532 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2336046695709229
Epoch: 18, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.416 Vali Acc: 0.534 Test Loss: 1.416 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 19 cost time: 1.0329561233520508
Epoch: 19, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1026227474212646
Epoch: 20, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.532 Vali Acc: 0.527 Test Loss: 1.532 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.137188196182251
Epoch: 21, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.525 Vali Acc: 0.519 Test Loss: 1.525 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1236753463745117
Epoch: 22, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.466 Vali Acc: 0.519 Test Loss: 1.466 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0074498653411865
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0065889358520508
Epoch: 24, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.456 Vali Acc: 0.519 Test Loss: 1.456 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.069176197052002
Epoch: 25, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.679 Vali Acc: 0.542 Test Loss: 1.679 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541968).  Saving model ...
Epoch: 26 cost time: 1.219191074371338
Epoch: 26, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.536 Vali Acc: 0.527 Test Loss: 1.536 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1217293739318848
Epoch: 27, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.425 Vali Acc: 0.527 Test Loss: 1.425 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9200425148010254
Epoch: 28, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.341 Vali Acc: 0.534 Test Loss: 1.341 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9275085926055908
Epoch: 29, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.317 Vali Acc: 0.542 Test Loss: 1.317 Test Acc: 0.542
Validation loss decreased (-0.541968 --> -0.541972).  Saving model ...
Epoch: 30 cost time: 1.1877384185791016
Epoch: 30, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.371 Vali Acc: 0.542 Test Loss: 1.371 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2494471073150635
Epoch: 31, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.406 Vali Acc: 0.534 Test Loss: 1.406 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9327454566955566
Epoch: 32, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.558 Vali Acc: 0.542 Test Loss: 1.558 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.098844289779663
Epoch: 33, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.461 Vali Acc: 0.557 Test Loss: 1.461 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557237).  Saving model ...
Epoch: 34 cost time: 1.01235032081604
Epoch: 34, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.345 Vali Acc: 0.550 Test Loss: 1.345 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0400989055633545
Epoch: 35, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.448 Vali Acc: 0.557 Test Loss: 1.448 Test Acc: 0.557
Validation loss decreased (-0.557237 --> -0.557237).  Saving model ...
Epoch: 36 cost time: 1.0213191509246826
Epoch: 36, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.573 Vali Acc: 0.542 Test Loss: 1.573 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9658565521240234
Epoch: 37, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.453 Vali Acc: 0.557 Test Loss: 1.453 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.245732069015503
Epoch: 38, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.528 Vali Acc: 0.534 Test Loss: 1.528 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1894447803497314
Epoch: 39, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1709949970245361
Epoch: 40, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.433 Vali Acc: 0.557 Test Loss: 1.433 Test Acc: 0.557
Validation loss decreased (-0.557237 --> -0.557238).  Saving model ...
Epoch: 41 cost time: 1.1726033687591553
Epoch: 41, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.505 Vali Acc: 0.557 Test Loss: 1.505 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1841857433319092
Epoch: 42, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.495 Vali Acc: 0.534 Test Loss: 1.495 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0399065017700195
Epoch: 43, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.485 Vali Acc: 0.534 Test Loss: 1.485 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1467537879943848
Epoch: 44, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.910 Vali Acc: 0.519 Test Loss: 1.910 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1117792129516602
Epoch: 45, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.467 Vali Acc: 0.534 Test Loss: 1.467 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.026071548461914
Epoch: 46, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.307 Vali Acc: 0.542 Test Loss: 1.307 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0264182090759277
Epoch: 47, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.325 Vali Acc: 0.557 Test Loss: 1.325 Test Acc: 0.557
Validation loss decreased (-0.557238 --> -0.557239).  Saving model ...
Epoch: 48 cost time: 1.090458869934082
Epoch: 48, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.322 Vali Acc: 0.565 Test Loss: 1.322 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564872).  Saving model ...
Epoch: 49 cost time: 1.107323169708252
Epoch: 49, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.310 Vali Acc: 0.565 Test Loss: 1.310 Test Acc: 0.565
Validation loss decreased (-0.564872 --> -0.564872).  Saving model ...
Epoch: 50 cost time: 1.1339612007141113
Epoch: 50, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.424 Vali Acc: 0.573 Test Loss: 1.424 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 215685
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.011461019515991
Epoch: 1, Steps: 8 | Train Loss: 1.715 Vali Loss: 1.595 Vali Acc: 0.221 Test Loss: 1.595 Test Acc: 0.221
Validation loss decreased (inf --> -0.221358).  Saving model ...
Epoch: 2 cost time: 1.0331416130065918
Epoch: 2, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.548 Vali Acc: 0.420 Test Loss: 1.548 Test Acc: 0.420
Validation loss decreased (-0.221358 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2657582759857178
Epoch: 3, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.507 Vali Acc: 0.435 Test Loss: 1.507 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.0661756992340088
Epoch: 4, Steps: 8 | Train Loss: 1.055 Vali Loss: 1.469 Vali Acc: 0.435 Test Loss: 1.469 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.0077509880065918
Epoch: 5, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.445 Vali Acc: 0.458 Test Loss: 1.445 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.2401745319366455
Epoch: 6, Steps: 8 | Train Loss: 0.724 Vali Loss: 1.433 Vali Acc: 0.466 Test Loss: 1.433 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465635).  Saving model ...
Epoch: 7 cost time: 1.1459534168243408
Epoch: 7, Steps: 8 | Train Loss: 0.590 Vali Loss: 1.408 Vali Acc: 0.489 Test Loss: 1.408 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488536).  Saving model ...
Epoch: 8 cost time: 1.264162302017212
Epoch: 8, Steps: 8 | Train Loss: 0.467 Vali Loss: 1.412 Vali Acc: 0.496 Test Loss: 1.412 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.0129890441894531
Epoch: 9, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.1136419773101807
Epoch: 10, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.372 Vali Acc: 0.527 Test Loss: 1.372 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.451777696609497
Epoch: 11, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.386 Vali Acc: 0.527 Test Loss: 1.386 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.237105369567871
Epoch: 12, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.390 Vali Acc: 0.519 Test Loss: 1.390 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.10831880569458
Epoch: 13, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.357 Vali Acc: 0.519 Test Loss: 1.357 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1726648807525635
Epoch: 14, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.345 Vali Acc: 0.519 Test Loss: 1.345 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0834271907806396
Epoch: 15, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.340 Vali Acc: 0.534 Test Loss: 1.340 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 16 cost time: 1.1946234703063965
Epoch: 16, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1527893543243408
Epoch: 17, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9677038192749023
Epoch: 18, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8799309730529785
Epoch: 19, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.443 Vali Acc: 0.519 Test Loss: 1.443 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1761631965637207
Epoch: 20, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.401 Vali Acc: 0.519 Test Loss: 1.401 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.188399076461792
Epoch: 21, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9540755748748779
Epoch: 22, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.538 Vali Acc: 0.519 Test Loss: 1.538 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0373060703277588
Epoch: 23, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.480 Vali Acc: 0.504 Test Loss: 1.480 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8496172428131104
Epoch: 24, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.415 Vali Acc: 0.504 Test Loss: 1.415 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2140865325927734
Epoch: 25, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.386 Vali Acc: 0.519 Test Loss: 1.386 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 261701
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9673547744750977
Epoch: 1, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.590 Vali Acc: 0.290 Test Loss: 1.590 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.2699689865112305
Epoch: 2, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.555 Vali Acc: 0.389 Test Loss: 1.555 Test Acc: 0.389
Validation loss decreased (-0.290060 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.0503077507019043
Epoch: 3, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.515 Vali Acc: 0.427 Test Loss: 1.515 Test Acc: 0.427
Validation loss decreased (-0.389297 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.4483518600463867
Epoch: 4, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.491 Vali Acc: 0.458 Test Loss: 1.491 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 1.1240122318267822
Epoch: 5, Steps: 8 | Train Loss: 0.770 Vali Loss: 1.437 Vali Acc: 0.496 Test Loss: 1.437 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.292447566986084
Epoch: 6, Steps: 8 | Train Loss: 0.618 Vali Loss: 1.414 Vali Acc: 0.504 Test Loss: 1.414 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.073732852935791
Epoch: 7, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.421 Vali Acc: 0.496 Test Loss: 1.421 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1564431190490723
Epoch: 8, Steps: 8 | Train Loss: 0.385 Vali Loss: 1.437 Vali Acc: 0.504 Test Loss: 1.437 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0560412406921387
Epoch: 9, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.448 Vali Acc: 0.511 Test Loss: 1.448 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.0081055164337158
Epoch: 10, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.511 Vali Acc: 0.519 Test Loss: 1.511 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 11 cost time: 0.9199001789093018
Epoch: 11, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.419 Vali Acc: 0.519 Test Loss: 1.419 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 1.0167951583862305
Epoch: 12, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.452 Vali Acc: 0.511 Test Loss: 1.452 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9533631801605225
Epoch: 13, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 14 cost time: 0.9498958587646484
Epoch: 14, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.044145107269287
Epoch: 15, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.644 Vali Acc: 0.534 Test Loss: 1.644 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534335).  Saving model ...
Epoch: 16 cost time: 1.0498666763305664
Epoch: 16, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.493 Vali Acc: 0.534 Test Loss: 1.493 Test Acc: 0.534
Validation loss decreased (-0.534335 --> -0.534336).  Saving model ...
Epoch: 17 cost time: 1.2642998695373535
Epoch: 17, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.596 Vali Acc: 0.527 Test Loss: 1.596 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1395370960235596
Epoch: 18, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.552 Vali Acc: 0.534 Test Loss: 1.552 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.159994125366211
Epoch: 19, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9572460651397705
Epoch: 20, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.464 Vali Acc: 0.542 Test Loss: 1.464 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541970).  Saving model ...
Epoch: 21 cost time: 1.1759130954742432
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.507 Vali Acc: 0.542 Test Loss: 1.507 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2798452377319336
Epoch: 22, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1150779724121094
Epoch: 23, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.469 Vali Acc: 0.527 Test Loss: 1.469 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.022291898727417
Epoch: 24, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0669379234313965
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.483 Vali Acc: 0.534 Test Loss: 1.483 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1594469547271729
Epoch: 26, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.510 Vali Acc: 0.527 Test Loss: 1.510 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1602871417999268
Epoch: 27, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.456 Vali Acc: 0.534 Test Loss: 1.456 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0835723876953125
Epoch: 28, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.587 Vali Acc: 0.519 Test Loss: 1.587 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.091872215270996
Epoch: 29, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.538 Vali Acc: 0.534 Test Loss: 1.538 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1105127334594727
Epoch: 30, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.439 Vali Acc: 0.534 Test Loss: 1.439 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 311557
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.134807825088501
Epoch: 1, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.629 Vali Acc: 0.176 Test Loss: 1.629 Test Acc: 0.176
Validation loss decreased (inf --> -0.175556).  Saving model ...
Epoch: 2 cost time: 1.5452098846435547
Epoch: 2, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.601 Vali Acc: 0.290 Test Loss: 1.601 Test Acc: 0.290
Validation loss decreased (-0.175556 --> -0.290060).  Saving model ...
Epoch: 3 cost time: 1.5350046157836914
Epoch: 3, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.563 Vali Acc: 0.397 Test Loss: 1.563 Test Acc: 0.397
Validation loss decreased (-0.290060 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 1.1373071670532227
Epoch: 4, Steps: 8 | Train Loss: 1.051 Vali Loss: 1.541 Vali Acc: 0.435 Test Loss: 1.541 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.1942284107208252
Epoch: 5, Steps: 8 | Train Loss: 0.866 Vali Loss: 1.523 Vali Acc: 0.435 Test Loss: 1.523 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.319594144821167
Epoch: 6, Steps: 8 | Train Loss: 0.694 Vali Loss: 1.500 Vali Acc: 0.473 Test Loss: 1.500 Test Acc: 0.473
Validation loss decreased (-0.435099 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 1.3410820960998535
Epoch: 7, Steps: 8 | Train Loss: 0.569 Vali Loss: 1.472 Vali Acc: 0.473 Test Loss: 1.472 Test Acc: 0.473
Validation loss decreased (-0.473267 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.360074520111084
Epoch: 8, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.430 Vali Acc: 0.481 Test Loss: 1.430 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.1286425590515137
Epoch: 9, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.433 Vali Acc: 0.489 Test Loss: 1.433 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.1792871952056885
Epoch: 10, Steps: 8 | Train Loss: 0.360 Vali Loss: 1.409 Vali Acc: 0.481 Test Loss: 1.409 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6091766357421875
Epoch: 11, Steps: 8 | Train Loss: 0.312 Vali Loss: 1.431 Vali Acc: 0.481 Test Loss: 1.431 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5238871574401855
Epoch: 12, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.455 Vali Acc: 0.473 Test Loss: 1.455 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.034240484237671
Epoch: 13, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.439 Vali Acc: 0.489 Test Loss: 1.439 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0430314540863037
Epoch: 14, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.424 Vali Acc: 0.489 Test Loss: 1.424 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 15 cost time: 1.086622953414917
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.420 Vali Acc: 0.511 Test Loss: 1.420 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 16 cost time: 1.2620086669921875
Epoch: 16, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.432 Vali Acc: 0.496 Test Loss: 1.432 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1427757740020752
Epoch: 17, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.440 Vali Acc: 0.481 Test Loss: 1.440 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3442723751068115
Epoch: 18, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.437 Vali Acc: 0.504 Test Loss: 1.437 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.954613208770752
Epoch: 19, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.453 Vali Acc: 0.481 Test Loss: 1.453 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5503168106079102
Epoch: 20, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.590555191040039
Epoch: 21, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.445 Vali Acc: 0.481 Test Loss: 1.445 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2317306995391846
Epoch: 22, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.453 Vali Acc: 0.481 Test Loss: 1.453 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2827582359313965
Epoch: 23, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1630942821502686
Epoch: 24, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.418 Vali Acc: 0.496 Test Loss: 1.418 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2090160846710205
Epoch: 25, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.398 Vali Acc: 0.504 Test Loss: 1.398 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 367173
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7907779216766357
Epoch: 1, Steps: 8 | Train Loss: 1.743 Vali Loss: 1.638 Vali Acc: 0.198 Test Loss: 1.638 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 1.0311782360076904
Epoch: 2, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.594 Vali Acc: 0.420 Test Loss: 1.594 Test Acc: 0.420
Validation loss decreased (-0.198457 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.1228265762329102
Epoch: 3, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.551 Vali Acc: 0.427 Test Loss: 1.551 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 0.9616203308105469
Epoch: 4, Steps: 8 | Train Loss: 1.022 Vali Loss: 1.447 Vali Acc: 0.450 Test Loss: 1.447 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.0879673957824707
Epoch: 5, Steps: 8 | Train Loss: 0.725 Vali Loss: 1.362 Vali Acc: 0.473 Test Loss: 1.362 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473269).  Saving model ...
Epoch: 6 cost time: 1.0838348865509033
Epoch: 6, Steps: 8 | Train Loss: 0.487 Vali Loss: 1.289 Vali Acc: 0.511 Test Loss: 1.289 Test Acc: 0.511
Validation loss decreased (-0.473269 --> -0.511437).  Saving model ...
Epoch: 7 cost time: 1.2145531177520752
Epoch: 7, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.232 Vali Acc: 0.534 Test Loss: 1.232 Test Acc: 0.534
Validation loss decreased (-0.511437 --> -0.534339).  Saving model ...
Epoch: 8 cost time: 1.061065912246704
Epoch: 8, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.314 Vali Acc: 0.527 Test Loss: 1.314 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0975589752197266
Epoch: 9, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.277 Vali Acc: 0.542 Test Loss: 1.277 Test Acc: 0.542
Validation loss decreased (-0.534339 --> -0.541972).  Saving model ...
Epoch: 10 cost time: 0.9816858768463135
Epoch: 10, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.393 Vali Acc: 0.519 Test Loss: 1.393 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9599626064300537
Epoch: 11, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.321 Vali Acc: 0.542 Test Loss: 1.321 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.120471715927124
Epoch: 12, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.324 Vali Acc: 0.550 Test Loss: 1.324 Test Acc: 0.550
Validation loss decreased (-0.541972 --> -0.549605).  Saving model ...
Epoch: 13 cost time: 1.0973758697509766
Epoch: 13, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.331 Vali Acc: 0.550 Test Loss: 1.331 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0276010036468506
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.364 Vali Acc: 0.534 Test Loss: 1.364 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0421383380889893
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.314 Vali Acc: 0.542 Test Loss: 1.314 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9940485954284668
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.201 Vali Acc: 0.588 Test Loss: 1.201 Test Acc: 0.588
Validation loss decreased (-0.549605 --> -0.587774).  Saving model ...
Epoch: 17 cost time: 1.1935176849365234
Epoch: 17, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.330 Vali Acc: 0.565 Test Loss: 1.330 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.173229455947876
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.393 Vali Acc: 0.550 Test Loss: 1.393 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2331457138061523
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.376 Vali Acc: 0.565 Test Loss: 1.376 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1684904098510742
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.509 Vali Acc: 0.542 Test Loss: 1.509 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8883275985717773
Epoch: 21, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.421 Vali Acc: 0.557 Test Loss: 1.421 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9798619747161865
Epoch: 22, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.410 Vali Acc: 0.542 Test Loss: 1.410 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0874569416046143
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.330 Vali Acc: 0.603 Test Loss: 1.330 Test Acc: 0.603
Validation loss decreased (-0.587774 --> -0.603040).  Saving model ...
Epoch: 24 cost time: 1.1324028968811035
Epoch: 24, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.491 Vali Acc: 0.534 Test Loss: 1.491 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3114733695983887
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.716 Vali Acc: 0.519 Test Loss: 1.716 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9593658447265625
Epoch: 26, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.526 Vali Acc: 0.542 Test Loss: 1.526 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9894988536834717
Epoch: 27, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.501 Vali Acc: 0.542 Test Loss: 1.501 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0920701026916504
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.573 Vali Acc: 0.565 Test Loss: 1.573 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1010208129882812
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.551 Vali Acc: 0.565 Test Loss: 1.551 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.060279369354248
Epoch: 30, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.444 Vali Acc: 0.542 Test Loss: 1.444 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1706874370574951
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.368 Vali Acc: 0.565 Test Loss: 1.368 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.229416847229004
Epoch: 32, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.553 Vali Acc: 0.550 Test Loss: 1.553 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6159718036651611
Epoch: 33, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.752 Vali Acc: 0.534 Test Loss: 1.752 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 109989
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.065011978149414
Epoch: 1, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.603 Vali Acc: 0.237 Test Loss: 1.603 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.1620287895202637
Epoch: 2, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.565 Vali Acc: 0.389 Test Loss: 1.565 Test Acc: 0.389
Validation loss decreased (-0.236625 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.0629193782806396
Epoch: 3, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.3986611366271973
Epoch: 4, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.498 Vali Acc: 0.435 Test Loss: 1.498 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.163869857788086
Epoch: 5, Steps: 8 | Train Loss: 0.993 Vali Loss: 1.447 Vali Acc: 0.466 Test Loss: 1.447 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.1449623107910156
Epoch: 6, Steps: 8 | Train Loss: 0.854 Vali Loss: 1.430 Vali Acc: 0.450 Test Loss: 1.430 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.005504846572876
Epoch: 7, Steps: 8 | Train Loss: 0.651 Vali Loss: 1.379 Vali Acc: 0.504 Test Loss: 1.379 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 0.9862065315246582
Epoch: 8, Steps: 8 | Train Loss: 0.507 Vali Loss: 1.372 Vali Acc: 0.489 Test Loss: 1.372 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9854660034179688
Epoch: 9, Steps: 8 | Train Loss: 0.398 Vali Loss: 1.371 Vali Acc: 0.496 Test Loss: 1.371 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1916320323944092
Epoch: 10, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.443 Vali Acc: 0.489 Test Loss: 1.443 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9675133228302002
Epoch: 11, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.1004078388214111
Epoch: 12, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 13 cost time: 0.9941315650939941
Epoch: 13, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.455 Vali Acc: 0.534 Test Loss: 1.455 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 14 cost time: 0.8209903240203857
Epoch: 14, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.558 Vali Acc: 0.511 Test Loss: 1.558 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1022868156433105
Epoch: 15, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.625 Vali Acc: 0.519 Test Loss: 1.625 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1078636646270752
Epoch: 16, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.521 Vali Acc: 0.519 Test Loss: 1.521 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.100759744644165
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1402604579925537
Epoch: 18, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1254024505615234
Epoch: 19, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.564 Vali Acc: 0.519 Test Loss: 1.564 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9554557800292969
Epoch: 20, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.626 Vali Acc: 0.527 Test Loss: 1.626 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0546634197235107
Epoch: 21, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.520 Vali Acc: 0.527 Test Loss: 1.520 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2971179485321045
Epoch: 22, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.506 Vali Acc: 0.527 Test Loss: 1.506 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.346879482269287
Epoch: 23, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.636 Vali Acc: 0.519 Test Loss: 1.636 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps900_str450_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 85989
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9940552711486816
Epoch: 1, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.603 Vali Acc: 0.290 Test Loss: 1.603 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.081986665725708
Epoch: 2, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.570 Vali Acc: 0.374 Test Loss: 1.570 Test Acc: 0.374
Validation loss decreased (-0.290060 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.0296447277069092
Epoch: 3, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.540 Vali Acc: 0.405 Test Loss: 1.540 Test Acc: 0.405
Validation loss decreased (-0.374030 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.184025764465332
Epoch: 4, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.404565 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 0.9554178714752197
Epoch: 5, Steps: 8 | Train Loss: 1.037 Vali Loss: 1.478 Vali Acc: 0.435 Test Loss: 1.478 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.0114548206329346
Epoch: 6, Steps: 8 | Train Loss: 0.869 Vali Loss: 1.441 Vali Acc: 0.443 Test Loss: 1.441 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442734).  Saving model ...
Epoch: 7 cost time: 1.0505166053771973
Epoch: 7, Steps: 8 | Train Loss: 0.742 Vali Loss: 1.420 Vali Acc: 0.481 Test Loss: 1.420 Test Acc: 0.481
Validation loss decreased (-0.442734 --> -0.480902).  Saving model ...
Epoch: 8 cost time: 1.0541284084320068
Epoch: 8, Steps: 8 | Train Loss: 0.673 Vali Loss: 1.394 Vali Acc: 0.489 Test Loss: 1.394 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488536).  Saving model ...
Epoch: 9 cost time: 1.1969573497772217
Epoch: 9, Steps: 8 | Train Loss: 0.547 Vali Loss: 1.389 Vali Acc: 0.481 Test Loss: 1.389 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1728806495666504
Epoch: 10, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.374 Vali Acc: 0.473 Test Loss: 1.374 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1929421424865723
Epoch: 11, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.364 Vali Acc: 0.504 Test Loss: 1.364 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.1330931186676025
Epoch: 12, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.339 Vali Acc: 0.511 Test Loss: 1.339 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 13 cost time: 1.0409505367279053
Epoch: 13, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.371 Vali Acc: 0.511 Test Loss: 1.371 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9794046878814697
Epoch: 14, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.415 Vali Acc: 0.489 Test Loss: 1.415 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1729869842529297
Epoch: 15, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.449 Vali Acc: 0.496 Test Loss: 1.449 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3613274097442627
Epoch: 16, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.463 Vali Acc: 0.519 Test Loss: 1.463 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519069).  Saving model ...
Epoch: 17 cost time: 1.1987011432647705
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.368 Vali Acc: 0.542 Test Loss: 1.368 Test Acc: 0.542
Validation loss decreased (-0.519069 --> -0.541971).  Saving model ...
Epoch: 18 cost time: 1.0684709548950195
Epoch: 18, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.387 Vali Acc: 0.534 Test Loss: 1.387 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.209010124206543
Epoch: 19, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.437 Vali Acc: 0.542 Test Loss: 1.437 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0187535285949707
Epoch: 20, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.511 Vali Acc: 0.527 Test Loss: 1.511 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.120438814163208
Epoch: 21, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.525 Vali Acc: 0.534 Test Loss: 1.525 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2152974605560303
Epoch: 22, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.473 Vali Acc: 0.519 Test Loss: 1.473 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1381428241729736
Epoch: 23, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.166776180267334
Epoch: 24, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.420 Vali Acc: 0.534 Test Loss: 1.420 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0024385452270508
Epoch: 25, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.366 Vali Acc: 0.534 Test Loss: 1.366 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0270147323608398
Epoch: 26, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.367 Vali Acc: 0.519 Test Loss: 1.367 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.445206880569458
Epoch: 27, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.350 Vali Acc: 0.527 Test Loss: 1.350 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1349_str675_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 87877
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.26115345954895
Epoch: 1, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.649 Vali Acc: 0.206 Test Loss: 1.649 Test Acc: 0.206
Validation loss decreased (inf --> -0.206090).  Saving model ...
Epoch: 2 cost time: 1.156121015548706
Epoch: 2, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.625 Vali Acc: 0.290 Test Loss: 1.625 Test Acc: 0.290
Validation loss decreased (-0.206090 --> -0.290060).  Saving model ...
Epoch: 3 cost time: 1.437028408050537
Epoch: 3, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.606 Vali Acc: 0.405 Test Loss: 1.606 Test Acc: 0.405
Validation loss decreased (-0.290060 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 1.266547679901123
Epoch: 4, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.573 Vali Acc: 0.427 Test Loss: 1.573 Test Acc: 0.427
Validation loss decreased (-0.404564 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.0864899158477783
Epoch: 5, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.554 Vali Acc: 0.458 Test Loss: 1.554 Test Acc: 0.458
Validation loss decreased (-0.427465 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 0.9742388725280762
Epoch: 6, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.483 Vali Acc: 0.466 Test Loss: 1.483 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 0.9526691436767578
Epoch: 7, Steps: 8 | Train Loss: 0.815 Vali Loss: 1.446 Vali Acc: 0.489 Test Loss: 1.446 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.3850574493408203
Epoch: 8, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.432 Vali Acc: 0.504 Test Loss: 1.432 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 9 cost time: 1.3831820487976074
Epoch: 9, Steps: 8 | Train Loss: 0.588 Vali Loss: 1.392 Vali Acc: 0.481 Test Loss: 1.392 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1445631980895996
Epoch: 10, Steps: 8 | Train Loss: 0.483 Vali Loss: 1.391 Vali Acc: 0.496 Test Loss: 1.391 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1569650173187256
Epoch: 11, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.377 Vali Acc: 0.489 Test Loss: 1.377 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1934430599212646
Epoch: 12, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.391 Vali Acc: 0.511 Test Loss: 1.391 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 1.13716721534729
Epoch: 13, Steps: 8 | Train Loss: 0.317 Vali Loss: 1.462 Vali Acc: 0.504 Test Loss: 1.462 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.101752519607544
Epoch: 14, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.361 Vali Acc: 0.527 Test Loss: 1.361 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 15 cost time: 1.0688915252685547
Epoch: 15, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.373 Vali Acc: 0.519 Test Loss: 1.373 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.950439453125
Epoch: 16, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.371 Vali Acc: 0.519 Test Loss: 1.371 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9135994911193848
Epoch: 17, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.339 Vali Acc: 0.519 Test Loss: 1.339 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.870492696762085
Epoch: 18, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.385 Vali Acc: 0.519 Test Loss: 1.385 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2518651485443115
Epoch: 19, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.366 Vali Acc: 0.519 Test Loss: 1.366 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.349565029144287
Epoch: 20, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.396 Vali Acc: 0.534 Test Loss: 1.396 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 21 cost time: 1.4211602210998535
Epoch: 21, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2016055583953857
Epoch: 22, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.396 Vali Acc: 0.511 Test Loss: 1.396 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0192317962646484
Epoch: 23, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9850151538848877
Epoch: 24, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.527 Vali Acc: 0.519 Test Loss: 1.527 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2845618724822998
Epoch: 25, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.443 Vali Acc: 0.534 Test Loss: 1.443 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.033198595046997
Epoch: 26, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.453 Vali Acc: 0.534 Test Loss: 1.453 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1964843273162842
Epoch: 27, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.400 Vali Acc: 0.542 Test Loss: 1.400 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 28 cost time: 0.9916760921478271
Epoch: 28, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9459404945373535
Epoch: 29, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.562 Vali Acc: 0.519 Test Loss: 1.562 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.221487283706665
Epoch: 30, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.437 Vali Acc: 0.542 Test Loss: 1.437 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2024116516113281
Epoch: 31, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.441 Vali Acc: 0.550 Test Loss: 1.441 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 32 cost time: 1.1843171119689941
Epoch: 32, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.309 Vali Acc: 0.573 Test Loss: 1.309 Test Acc: 0.573
Validation loss decreased (-0.549604 --> -0.572506).  Saving model ...
Epoch: 33 cost time: 1.3077244758605957
Epoch: 33, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.353 Vali Acc: 0.557 Test Loss: 1.353 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.274160385131836
Epoch: 34, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.499 Vali Acc: 0.519 Test Loss: 1.499 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0749456882476807
Epoch: 35, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.582 Vali Acc: 0.534 Test Loss: 1.582 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1120028495788574
Epoch: 36, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.535 Vali Acc: 0.565 Test Loss: 1.535 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1408424377441406
Epoch: 37, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.429 Vali Acc: 0.565 Test Loss: 1.429 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0909309387207031
Epoch: 38, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.469 Vali Acc: 0.573 Test Loss: 1.469 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2314648628234863
Epoch: 39, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.570 Vali Acc: 0.550 Test Loss: 1.570 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.990513801574707
Epoch: 40, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.377 Vali Acc: 0.580 Test Loss: 1.377 Test Acc: 0.580
Validation loss decreased (-0.572506 --> -0.580139).  Saving model ...
Epoch: 41 cost time: 1.1713511943817139
Epoch: 41, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.511 Vali Acc: 0.550 Test Loss: 1.511 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.310157060623169
Epoch: 42, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.621 Vali Acc: 0.534 Test Loss: 1.621 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1929285526275635
Epoch: 43, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.620 Vali Acc: 0.550 Test Loss: 1.620 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1706905364990234
Epoch: 44, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.687 Vali Acc: 0.557 Test Loss: 1.687 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2919061183929443
Epoch: 45, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.534 Vali Acc: 0.542 Test Loss: 1.534 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3343095779418945
Epoch: 46, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.568 Vali Acc: 0.557 Test Loss: 1.568 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3174879550933838
Epoch: 47, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.558 Vali Acc: 0.557 Test Loss: 1.558 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0545399188995361
Epoch: 48, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.513 Vali Acc: 0.550 Test Loss: 1.513 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2220306396484375
Epoch: 49, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.652 Vali Acc: 0.557 Test Loss: 1.652 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.141568660736084
Epoch: 50, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.555 Vali Acc: 0.557 Test Loss: 1.555 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1799_str900_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 95557
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.929023504257202
Epoch: 1, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.632 Vali Acc: 0.359 Test Loss: 1.632 Test Acc: 0.359
Validation loss decreased (inf --> -0.358762).  Saving model ...
Epoch: 2 cost time: 1.0057053565979004
Epoch: 2, Steps: 8 | Train Loss: 1.481 Vali Loss: 1.615 Vali Acc: 0.389 Test Loss: 1.615 Test Acc: 0.389
Validation loss decreased (-0.358762 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.1271133422851562
Epoch: 3, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.589 Vali Acc: 0.450 Test Loss: 1.589 Test Acc: 0.450
Validation loss decreased (-0.389297 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.42095947265625
Epoch: 4, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.560 Vali Acc: 0.450 Test Loss: 1.560 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.0973830223083496
Epoch: 5, Steps: 8 | Train Loss: 1.091 Vali Loss: 1.546 Vali Acc: 0.450 Test Loss: 1.546 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450366).  Saving model ...
Epoch: 6 cost time: 1.2365212440490723
Epoch: 6, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.535 Vali Acc: 0.466 Test Loss: 1.535 Test Acc: 0.466
Validation loss decreased (-0.450366 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.0060303211212158
Epoch: 7, Steps: 8 | Train Loss: 0.849 Vali Loss: 1.522 Vali Acc: 0.466 Test Loss: 1.522 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.0732440948486328
Epoch: 8, Steps: 8 | Train Loss: 0.751 Vali Loss: 1.520 Vali Acc: 0.473 Test Loss: 1.520 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 9 cost time: 1.2257936000823975
Epoch: 9, Steps: 8 | Train Loss: 0.615 Vali Loss: 1.503 Vali Acc: 0.481 Test Loss: 1.503 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.252140998840332
Epoch: 10, Steps: 8 | Train Loss: 0.520 Vali Loss: 1.487 Vali Acc: 0.511 Test Loss: 1.487 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 11 cost time: 1.3961784839630127
Epoch: 11, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.432 Vali Acc: 0.504 Test Loss: 1.432 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1183381080627441
Epoch: 12, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.443 Vali Acc: 0.511 Test Loss: 1.443 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 13 cost time: 0.9970841407775879
Epoch: 13, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 14 cost time: 1.3178040981292725
Epoch: 14, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.466 Vali Acc: 0.527 Test Loss: 1.466 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5367937088012695
Epoch: 15, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0827038288116455
Epoch: 16, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.408 Vali Acc: 0.534 Test Loss: 1.408 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 17 cost time: 1.1519975662231445
Epoch: 17, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.365 Vali Acc: 0.534 Test Loss: 1.365 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 18 cost time: 1.038362979888916
Epoch: 18, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.247103214263916
Epoch: 19, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.472 Vali Acc: 0.534 Test Loss: 1.472 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2906038761138916
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.408 Vali Acc: 0.534 Test Loss: 1.408 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1425366401672363
Epoch: 21, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.406 Vali Acc: 0.534 Test Loss: 1.406 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.973630428314209
Epoch: 22, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.461 Vali Acc: 0.534 Test Loss: 1.461 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.071347713470459
Epoch: 23, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.491 Vali Acc: 0.534 Test Loss: 1.491 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.004887342453003
Epoch: 24, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.428 Vali Acc: 0.519 Test Loss: 1.428 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1159181594848633
Epoch: 25, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.453 Vali Acc: 0.519 Test Loss: 1.453 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.190901756286621
Epoch: 26, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.017063856124878
Epoch: 27, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2698_str1349_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 118565
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9470443725585938
Epoch: 1, Steps: 8 | Train Loss: 1.713 Vali Loss: 1.611 Vali Acc: 0.244 Test Loss: 1.611 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 1.3419995307922363
Epoch: 2, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.598 Vali Acc: 0.305 Test Loss: 1.598 Test Acc: 0.305
Validation loss decreased (-0.244259 --> -0.305328).  Saving model ...
Epoch: 3 cost time: 1.2065534591674805
Epoch: 3, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.585 Vali Acc: 0.336 Test Loss: 1.585 Test Acc: 0.336
Validation loss decreased (-0.305328 --> -0.335862).  Saving model ...
Epoch: 4 cost time: 1.0631263256072998
Epoch: 4, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.551 Vali Acc: 0.412 Test Loss: 1.551 Test Acc: 0.412
Validation loss decreased (-0.335862 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 1.1387286186218262
Epoch: 5, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.509 Vali Acc: 0.420 Test Loss: 1.509 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.02467679977417
Epoch: 6, Steps: 8 | Train Loss: 0.879 Vali Loss: 1.503 Vali Acc: 0.458 Test Loss: 1.503 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.0372974872589111
Epoch: 7, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.492 Vali Acc: 0.466 Test Loss: 1.492 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.2061395645141602
Epoch: 8, Steps: 8 | Train Loss: 0.667 Vali Loss: 1.500 Vali Acc: 0.466 Test Loss: 1.500 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1990306377410889
Epoch: 9, Steps: 8 | Train Loss: 0.570 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.0348811149597168
Epoch: 10, Steps: 8 | Train Loss: 0.501 Vali Loss: 1.461 Vali Acc: 0.481 Test Loss: 1.461 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 1.1729800701141357
Epoch: 11, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.501 Vali Acc: 0.504 Test Loss: 1.501 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 12 cost time: 1.207899808883667
Epoch: 12, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.415 Vali Acc: 0.504 Test Loss: 1.415 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503803).  Saving model ...
Epoch: 13 cost time: 1.0675256252288818
Epoch: 13, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.448 Vali Acc: 0.504 Test Loss: 1.448 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.001159906387329
Epoch: 14, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.447 Vali Acc: 0.519 Test Loss: 1.447 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519069).  Saving model ...
Epoch: 15 cost time: 0.8839137554168701
Epoch: 15, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.379 Vali Acc: 0.542 Test Loss: 1.379 Test Acc: 0.542
Validation loss decreased (-0.519069 --> -0.541971).  Saving model ...
Epoch: 16 cost time: 0.8875856399536133
Epoch: 16, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9378516674041748
Epoch: 17, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.449 Vali Acc: 0.534 Test Loss: 1.449 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8513534069061279
Epoch: 18, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.378 Vali Acc: 0.534 Test Loss: 1.378 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9628112316131592
Epoch: 19, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.451 Vali Acc: 0.519 Test Loss: 1.451 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9973795413970947
Epoch: 20, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0426006317138672
Epoch: 21, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.902550220489502
Epoch: 22, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1497492790222168
Epoch: 23, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.380 Vali Acc: 0.534 Test Loss: 1.380 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0818932056427002
Epoch: 24, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.425 Vali Acc: 0.519 Test Loss: 1.425 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9482519626617432
Epoch: 25, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.447 Vali Acc: 0.534 Test Loss: 1.447 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3597_str1799_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 143493
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.014761209487915
Epoch: 1, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.633 Vali Acc: 0.145 Test Loss: 1.633 Test Acc: 0.145
Validation loss decreased (inf --> -0.145022).  Saving model ...
Epoch: 2 cost time: 1.0092027187347412
Epoch: 2, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.622 Vali Acc: 0.229 Test Loss: 1.622 Test Acc: 0.229
Validation loss decreased (-0.145022 --> -0.228991).  Saving model ...
Epoch: 3 cost time: 1.0415942668914795
Epoch: 3, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.626 Vali Acc: 0.328 Test Loss: 1.626 Test Acc: 0.328
Validation loss decreased (-0.228991 --> -0.328228).  Saving model ...
Epoch: 4 cost time: 0.8342885971069336
Epoch: 4, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.600 Vali Acc: 0.405 Test Loss: 1.600 Test Acc: 0.405
Validation loss decreased (-0.328228 --> -0.404564).  Saving model ...
Epoch: 5 cost time: 0.9419591426849365
Epoch: 5, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.561 Vali Acc: 0.443 Test Loss: 1.561 Test Acc: 0.443
Validation loss decreased (-0.404564 --> -0.442732).  Saving model ...
Epoch: 6 cost time: 0.9878077507019043
Epoch: 6, Steps: 8 | Train Loss: 0.926 Vali Loss: 1.562 Vali Acc: 0.443 Test Loss: 1.562 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9944539070129395
Epoch: 7, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.556 Vali Acc: 0.427 Test Loss: 1.556 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0550651550292969
Epoch: 8, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.536 Vali Acc: 0.466 Test Loss: 1.536 Test Acc: 0.466
Validation loss decreased (-0.442732 --> -0.465633).  Saving model ...
Epoch: 9 cost time: 1.0046472549438477
Epoch: 9, Steps: 8 | Train Loss: 0.661 Vali Loss: 1.532 Vali Acc: 0.489 Test Loss: 1.532 Test Acc: 0.489
Validation loss decreased (-0.465633 --> -0.488534).  Saving model ...
Epoch: 10 cost time: 0.9193599224090576
Epoch: 10, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.525 Vali Acc: 0.481 Test Loss: 1.525 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9496769905090332
Epoch: 11, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.522 Vali Acc: 0.481 Test Loss: 1.522 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9533355236053467
Epoch: 12, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.516 Vali Acc: 0.527 Test Loss: 1.516 Test Acc: 0.527
Validation loss decreased (-0.488534 --> -0.526702).  Saving model ...
Epoch: 13 cost time: 1.0734362602233887
Epoch: 13, Steps: 8 | Train Loss: 0.396 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526703).  Saving model ...
Epoch: 14 cost time: 1.0006046295166016
Epoch: 14, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.469 Vali Acc: 0.527 Test Loss: 1.469 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.0001490116119385
Epoch: 15, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.452 Vali Acc: 0.496 Test Loss: 1.452 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0103318691253662
Epoch: 16, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.443 Vali Acc: 0.511 Test Loss: 1.443 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9885871410369873
Epoch: 17, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.462 Vali Acc: 0.511 Test Loss: 1.462 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9187095165252686
Epoch: 18, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.279170036315918
Epoch: 19, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.520 Vali Acc: 0.496 Test Loss: 1.520 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.019124984741211
Epoch: 20, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.510 Vali Acc: 0.473 Test Loss: 1.510 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.092470407485962
Epoch: 21, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.519 Vali Acc: 0.511 Test Loss: 1.519 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1557557582855225
Epoch: 22, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.15181565284729
Epoch: 23, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.476 Vali Acc: 0.511 Test Loss: 1.476 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9146108627319336
Epoch: 24, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.496 Vali Acc: 0.511 Test Loss: 1.496 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ModernTCN_UEA_ftM_sl17984_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4496_str2248_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 171301
model size : 0.67MB
