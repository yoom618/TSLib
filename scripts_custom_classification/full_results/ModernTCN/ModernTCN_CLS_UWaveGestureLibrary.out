Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1072585582733154
Epoch: 1, Steps: 8 | Train Loss: 2.036 Vali Loss: 2.036 Vali Acc: 0.172 Test Loss: 2.036 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 0.8264937400817871
Epoch: 2, Steps: 8 | Train Loss: 1.864 Vali Loss: 1.894 Vali Acc: 0.606 Test Loss: 1.894 Test Acc: 0.606
Validation loss decreased (-0.171855 --> -0.606231).  Saving model ...
Epoch: 3 cost time: 0.7602531909942627
Epoch: 3, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.632 Vali Acc: 0.791 Test Loss: 1.632 Test Acc: 0.791
Validation loss decreased (-0.606231 --> -0.790609).  Saving model ...
Epoch: 4 cost time: 0.677426815032959
Epoch: 4, Steps: 8 | Train Loss: 1.235 Vali Loss: 1.251 Vali Acc: 0.812 Test Loss: 1.251 Test Acc: 0.812
Validation loss decreased (-0.790609 --> -0.812487).  Saving model ...
Epoch: 5 cost time: 0.7185173034667969
Epoch: 5, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.867 Vali Acc: 0.806 Test Loss: 0.867 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6453852653503418
Epoch: 6, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
Validation loss decreased (-0.812487 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.803757905960083
Epoch: 7, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.828119 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.6088554859161377
Epoch: 8, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.6822474002838135
Epoch: 9, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7056074142456055
Epoch: 10, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7188270092010498
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6146180629730225
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7157797813415527
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8070628643035889
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7268092632293701
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7104358673095703
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6825516223907471
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.570 Vali Acc: 0.834 Test Loss: 0.570 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.68576979637146
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 636840
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9551031589508057
Epoch: 1, Steps: 8 | Train Loss: 2.124 Vali Loss: 2.088 Vali Acc: 0.087 Test Loss: 2.088 Test Acc: 0.087
Validation loss decreased (inf --> -0.087479).  Saving model ...
Epoch: 2 cost time: 0.7712500095367432
Epoch: 2, Steps: 8 | Train Loss: 2.027 Vali Loss: 2.007 Vali Acc: 0.359 Test Loss: 2.007 Test Acc: 0.359
Validation loss decreased (-0.087479 --> -0.359355).  Saving model ...
Epoch: 3 cost time: 0.6221456527709961
Epoch: 3, Steps: 8 | Train Loss: 1.828 Vali Loss: 1.839 Vali Acc: 0.619 Test Loss: 1.839 Test Acc: 0.619
Validation loss decreased (-0.359355 --> -0.618732).  Saving model ...
Epoch: 4 cost time: 0.6915676593780518
Epoch: 4, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.588 Vali Acc: 0.728 Test Loss: 1.588 Test Acc: 0.728
Validation loss decreased (-0.618732 --> -0.728109).  Saving model ...
Epoch: 5 cost time: 0.758394718170166
Epoch: 5, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.267 Vali Acc: 0.772 Test Loss: 1.267 Test Acc: 0.772
Validation loss decreased (-0.728109 --> -0.771862).  Saving model ...
Epoch: 6 cost time: 0.7551670074462891
Epoch: 6, Steps: 8 | Train Loss: 0.991 Vali Loss: 0.945 Vali Acc: 0.809 Test Loss: 0.945 Test Acc: 0.809
Validation loss decreased (-0.771862 --> -0.809366).  Saving model ...
Epoch: 7 cost time: 0.7675981521606445
Epoch: 7, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 0.6367807388305664
Epoch: 8, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
Validation loss decreased (-0.821868 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.6710910797119141
Epoch: 9, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.7280917167663574
Epoch: 10, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 0.6926050186157227
Epoch: 11, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.435 Vali Acc: 0.863 Test Loss: 0.435 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.694037914276123
Epoch: 12, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7987968921661377
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8011596202850342
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6478447914123535
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.465 Vali Acc: 0.834 Test Loss: 0.465 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6778411865234375
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7420604228973389
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7033281326293945
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7369515895843506
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6267929077148438
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 606376
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8810536861419678
Epoch: 1, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.067 Vali Acc: 0.084 Test Loss: 2.067 Test Acc: 0.084
Validation loss decreased (inf --> -0.084354).  Saving model ...
Epoch: 2 cost time: 0.7984597682952881
Epoch: 2, Steps: 8 | Train Loss: 2.016 Vali Loss: 2.001 Vali Acc: 0.278 Test Loss: 2.001 Test Acc: 0.278
Validation loss decreased (-0.084354 --> -0.278105).  Saving model ...
Epoch: 3 cost time: 0.7164156436920166
Epoch: 3, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.879 Vali Acc: 0.559 Test Loss: 1.879 Test Acc: 0.559
Validation loss decreased (-0.278105 --> -0.559356).  Saving model ...
Epoch: 4 cost time: 0.6629230976104736
Epoch: 4, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.696 Vali Acc: 0.738 Test Loss: 1.696 Test Acc: 0.738
Validation loss decreased (-0.559356 --> -0.737483).  Saving model ...
Epoch: 5 cost time: 0.7230188846588135
Epoch: 5, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.472 Vali Acc: 0.766 Test Loss: 1.472 Test Acc: 0.766
Validation loss decreased (-0.737483 --> -0.765610).  Saving model ...
Epoch: 6 cost time: 0.6486749649047852
Epoch: 6, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.219 Vali Acc: 0.794 Test Loss: 1.219 Test Acc: 0.794
Validation loss decreased (-0.765610 --> -0.793738).  Saving model ...
Epoch: 7 cost time: 0.781498908996582
Epoch: 7, Steps: 8 | Train Loss: 1.004 Vali Loss: 0.966 Vali Acc: 0.809 Test Loss: 0.966 Test Acc: 0.809
Validation loss decreased (-0.793738 --> -0.809365).  Saving model ...
Epoch: 8 cost time: 0.7188854217529297
Epoch: 8, Steps: 8 | Train Loss: 0.764 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.809365 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.7342393398284912
Epoch: 9, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.632 Vali Acc: 0.841 Test Loss: 0.632 Test Acc: 0.841
Validation loss decreased (-0.824992 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.8364341259002686
Epoch: 10, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 0.7124288082122803
Epoch: 11, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.7291052341461182
Epoch: 12, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.6928622722625732
Epoch: 13, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 0.7368309497833252
Epoch: 14, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6547036170959473
Epoch: 15, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.801825761795044
Epoch: 16, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.470 Vali Acc: 0.834 Test Loss: 0.470 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7191369533538818
Epoch: 17, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7323043346405029
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.697192907333374
Epoch: 19, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6807806491851807
Epoch: 20, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.489 Vali Acc: 0.834 Test Loss: 0.489 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6771316528320312
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7515456676483154
Epoch: 22, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6554393768310547
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 597416
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0760903358459473
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.068 Vali Acc: 0.119 Test Loss: 2.068 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 0.7001960277557373
Epoch: 2, Steps: 8 | Train Loss: 2.025 Vali Loss: 2.016 Vali Acc: 0.263 Test Loss: 2.016 Test Acc: 0.263
Validation loss decreased (-0.118729 --> -0.262480).  Saving model ...
Epoch: 3 cost time: 0.7794637680053711
Epoch: 3, Steps: 8 | Train Loss: 1.887 Vali Loss: 1.912 Vali Acc: 0.512 Test Loss: 1.912 Test Acc: 0.512
Validation loss decreased (-0.262480 --> -0.512481).  Saving model ...
Epoch: 4 cost time: 0.6645464897155762
Epoch: 4, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.750 Vali Acc: 0.713 Test Loss: 1.750 Test Acc: 0.713
Validation loss decreased (-0.512481 --> -0.712482).  Saving model ...
Epoch: 5 cost time: 0.7686512470245361
Epoch: 5, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.542 Vali Acc: 0.766 Test Loss: 1.542 Test Acc: 0.766
Validation loss decreased (-0.712482 --> -0.765610).  Saving model ...
Epoch: 6 cost time: 0.6943769454956055
Epoch: 6, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.301 Vali Acc: 0.781 Test Loss: 1.301 Test Acc: 0.781
Validation loss decreased (-0.765610 --> -0.781237).  Saving model ...
Epoch: 7 cost time: 0.6929647922515869
Epoch: 7, Steps: 8 | Train Loss: 1.117 Vali Loss: 1.065 Vali Acc: 0.800 Test Loss: 1.065 Test Acc: 0.800
Validation loss decreased (-0.781237 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.7464966773986816
Epoch: 8, Steps: 8 | Train Loss: 0.909 Vali Loss: 0.872 Vali Acc: 0.806 Test Loss: 0.872 Test Acc: 0.806
Validation loss decreased (-0.799989 --> -0.806241).  Saving model ...
Epoch: 9 cost time: 0.6988911628723145
Epoch: 9, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
Validation loss decreased (-0.806241 --> -0.821868).  Saving model ...
Epoch: 10 cost time: 0.7031891345977783
Epoch: 10, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.619 Vali Acc: 0.838 Test Loss: 0.619 Test Acc: 0.838
Validation loss decreased (-0.821868 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.7576475143432617
Epoch: 11, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 0.66404128074646
Epoch: 12, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.6612040996551514
Epoch: 13, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.729844331741333
Epoch: 14, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.637596845626831
Epoch: 15, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.7743129730224609
Epoch: 16, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.447 Vali Acc: 0.866 Test Loss: 0.447 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865621).  Saving model ...
Epoch: 17 cost time: 0.6694223880767822
Epoch: 17, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.444 Vali Acc: 0.863 Test Loss: 0.444 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8148512840270996
Epoch: 18, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7729282379150391
Epoch: 19, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.432 Vali Acc: 0.863 Test Loss: 0.432 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7219483852386475
Epoch: 20, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7717459201812744
Epoch: 21, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.437 Vali Acc: 0.863 Test Loss: 0.437 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6835637092590332
Epoch: 22, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7437477111816406
Epoch: 23, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6977105140686035
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6943931579589844
Epoch: 25, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6889550685882568
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 591528
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9289002418518066
Epoch: 1, Steps: 8 | Train Loss: 2.044 Vali Loss: 2.050 Vali Acc: 0.191 Test Loss: 2.050 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 0.7730920314788818
Epoch: 2, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.997 Vali Acc: 0.325 Test Loss: 1.997 Test Acc: 0.325
Validation loss decreased (-0.190605 --> -0.324980).  Saving model ...
Epoch: 3 cost time: 0.7396259307861328
Epoch: 3, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.893 Vali Acc: 0.553 Test Loss: 1.893 Test Acc: 0.553
Validation loss decreased (-0.324980 --> -0.553106).  Saving model ...
Epoch: 4 cost time: 0.8020632266998291
Epoch: 4, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.735 Vali Acc: 0.684 Test Loss: 1.735 Test Acc: 0.684
Validation loss decreased (-0.553106 --> -0.684358).  Saving model ...
Epoch: 5 cost time: 0.7351033687591553
Epoch: 5, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.546 Vali Acc: 0.756 Test Loss: 1.546 Test Acc: 0.756
Validation loss decreased (-0.684358 --> -0.756235).  Saving model ...
Epoch: 6 cost time: 0.8183903694152832
Epoch: 6, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.337 Vali Acc: 0.791 Test Loss: 1.337 Test Acc: 0.791
Validation loss decreased (-0.756235 --> -0.790612).  Saving model ...
Epoch: 7 cost time: 0.6279323101043701
Epoch: 7, Steps: 8 | Train Loss: 1.171 Vali Loss: 1.133 Vali Acc: 0.816 Test Loss: 1.133 Test Acc: 0.816
Validation loss decreased (-0.790612 --> -0.815614).  Saving model ...
Epoch: 8 cost time: 0.6639435291290283
Epoch: 8, Steps: 8 | Train Loss: 0.978 Vali Loss: 0.945 Vali Acc: 0.828 Test Loss: 0.945 Test Acc: 0.828
Validation loss decreased (-0.815614 --> -0.828116).  Saving model ...
Epoch: 9 cost time: 0.7279312610626221
Epoch: 9, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.795 Vali Acc: 0.838 Test Loss: 0.795 Test Acc: 0.838
Validation loss decreased (-0.828116 --> -0.837492).  Saving model ...
Epoch: 10 cost time: 0.6658258438110352
Epoch: 10, Steps: 8 | Train Loss: 0.624 Vali Loss: 0.674 Vali Acc: 0.853 Test Loss: 0.674 Test Acc: 0.853
Validation loss decreased (-0.837492 --> -0.853118).  Saving model ...
Epoch: 11 cost time: 0.6310272216796875
Epoch: 11, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.591 Vali Acc: 0.863 Test Loss: 0.591 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862494).  Saving model ...
Epoch: 12 cost time: 0.6933526992797852
Epoch: 12, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
Validation loss decreased (-0.862494 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.7337875366210938
Epoch: 13, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.504 Vali Acc: 0.866 Test Loss: 0.504 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 14 cost time: 0.702221155166626
Epoch: 14, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6838037967681885
Epoch: 15, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6886131763458252
Epoch: 16, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6165928840637207
Epoch: 17, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7289350032806396
Epoch: 18, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.683696985244751
Epoch: 19, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6426718235015869
Epoch: 20, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7425625324249268
Epoch: 21, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7139055728912354
Epoch: 22, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7385890483856201
Epoch: 23, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 588968
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9277381896972656
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 2.055 Vali Acc: 0.122 Test Loss: 2.055 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.6780118942260742
Epoch: 2, Steps: 8 | Train Loss: 2.041 Vali Loss: 2.013 Vali Acc: 0.237 Test Loss: 2.013 Test Acc: 0.237
Validation loss decreased (-0.121854 --> -0.237480).  Saving model ...
Epoch: 3 cost time: 0.6203317642211914
Epoch: 3, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.932 Vali Acc: 0.481 Test Loss: 1.932 Test Acc: 0.481
Validation loss decreased (-0.237480 --> -0.481231).  Saving model ...
Epoch: 4 cost time: 0.5927615165710449
Epoch: 4, Steps: 8 | Train Loss: 1.820 Vali Loss: 1.815 Vali Acc: 0.644 Test Loss: 1.815 Test Acc: 0.644
Validation loss decreased (-0.481231 --> -0.643732).  Saving model ...
Epoch: 5 cost time: 0.60976243019104
Epoch: 5, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.669 Vali Acc: 0.694 Test Loss: 1.669 Test Acc: 0.694
Validation loss decreased (-0.643732 --> -0.693733).  Saving model ...
Epoch: 6 cost time: 0.6603536605834961
Epoch: 6, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.507 Vali Acc: 0.738 Test Loss: 1.507 Test Acc: 0.738
Validation loss decreased (-0.693733 --> -0.737485).  Saving model ...
Epoch: 7 cost time: 0.6536703109741211
Epoch: 7, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.332 Vali Acc: 0.775 Test Loss: 1.332 Test Acc: 0.775
Validation loss decreased (-0.737485 --> -0.774987).  Saving model ...
Epoch: 8 cost time: 0.6763203144073486
Epoch: 8, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.163 Vali Acc: 0.781 Test Loss: 1.163 Test Acc: 0.781
Validation loss decreased (-0.774987 --> -0.781238).  Saving model ...
Epoch: 9 cost time: 0.6412873268127441
Epoch: 9, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.996 Vali Acc: 0.794 Test Loss: 0.996 Test Acc: 0.794
Validation loss decreased (-0.781238 --> -0.793740).  Saving model ...
Epoch: 10 cost time: 0.6577279567718506
Epoch: 10, Steps: 8 | Train Loss: 0.813 Vali Loss: 0.858 Vali Acc: 0.809 Test Loss: 0.858 Test Acc: 0.809
Validation loss decreased (-0.793740 --> -0.809366).  Saving model ...
Epoch: 11 cost time: 0.6960909366607666
Epoch: 11, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821868).  Saving model ...
Epoch: 12 cost time: 0.7183074951171875
Epoch: 12, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.660 Vali Acc: 0.834 Test Loss: 0.660 Test Acc: 0.834
Validation loss decreased (-0.821868 --> -0.834368).  Saving model ...
Epoch: 13 cost time: 0.8012933731079102
Epoch: 13, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
Validation loss decreased (-0.834368 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 0.6923408508300781
Epoch: 14, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 0.6947908401489258
Epoch: 15, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 0.7256178855895996
Epoch: 16, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 0.6463067531585693
Epoch: 17, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 0.7014555931091309
Epoch: 18, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6009993553161621
Epoch: 19, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 0.556403636932373
Epoch: 20, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7122530937194824
Epoch: 21, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7279691696166992
Epoch: 22, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6703977584838867
Epoch: 23, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8217127323150635
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 25 cost time: 0.7085108757019043
Epoch: 25, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7464704513549805
Epoch: 26, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 27 cost time: 0.7708909511566162
Epoch: 27, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7362499237060547
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6080021858215332
Epoch: 29, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 30 cost time: 0.6777386665344238
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7252326011657715
Epoch: 31, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6148297786712646
Epoch: 32, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7173006534576416
Epoch: 33, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8128969669342041
Epoch: 34, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7214851379394531
Epoch: 35, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7311031818389893
Epoch: 36, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6835284233093262
Epoch: 37, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6157312393188477
Epoch: 38, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7155206203460693
Epoch: 39, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 586376
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1648528575897217
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.094 Vali Acc: 0.122 Test Loss: 2.094 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.6194581985473633
Epoch: 2, Steps: 8 | Train Loss: 2.079 Vali Loss: 2.061 Vali Acc: 0.209 Test Loss: 2.061 Test Acc: 0.209
Validation loss decreased (-0.121854 --> -0.209354).  Saving model ...
Epoch: 3 cost time: 0.7346096038818359
Epoch: 3, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.988 Vali Acc: 0.394 Test Loss: 1.988 Test Acc: 0.394
Validation loss decreased (-0.209354 --> -0.393730).  Saving model ...
Epoch: 4 cost time: 0.6729521751403809
Epoch: 4, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.881 Vali Acc: 0.531 Test Loss: 1.881 Test Acc: 0.531
Validation loss decreased (-0.393730 --> -0.531231).  Saving model ...
Epoch: 5 cost time: 0.6623423099517822
Epoch: 5, Steps: 8 | Train Loss: 1.740 Vali Loss: 1.752 Vali Acc: 0.628 Test Loss: 1.752 Test Acc: 0.628
Validation loss decreased (-0.531231 --> -0.628107).  Saving model ...
Epoch: 6 cost time: 0.7967004776000977
Epoch: 6, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.607 Vali Acc: 0.741 Test Loss: 1.607 Test Acc: 0.741
Validation loss decreased (-0.628107 --> -0.740609).  Saving model ...
Epoch: 7 cost time: 0.6739387512207031
Epoch: 7, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.455 Vali Acc: 0.787 Test Loss: 1.455 Test Acc: 0.787
Validation loss decreased (-0.740609 --> -0.787485).  Saving model ...
Epoch: 8 cost time: 0.8087239265441895
Epoch: 8, Steps: 8 | Train Loss: 1.314 Vali Loss: 1.303 Vali Acc: 0.791 Test Loss: 1.303 Test Acc: 0.791
Validation loss decreased (-0.787485 --> -0.790612).  Saving model ...
Epoch: 9 cost time: 0.6811873912811279
Epoch: 9, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.148 Vali Acc: 0.800 Test Loss: 1.148 Test Acc: 0.800
Validation loss decreased (-0.790612 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 0.8406956195831299
Epoch: 10, Steps: 8 | Train Loss: 0.972 Vali Loss: 1.011 Vali Acc: 0.806 Test Loss: 1.011 Test Acc: 0.806
Validation loss decreased (-0.799989 --> -0.806240).  Saving model ...
Epoch: 11 cost time: 0.6534898281097412
Epoch: 11, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.881 Vali Acc: 0.809 Test Loss: 0.881 Test Acc: 0.809
Validation loss decreased (-0.806240 --> -0.809366).  Saving model ...
Epoch: 12 cost time: 0.664750337600708
Epoch: 12, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.772 Vali Acc: 0.831 Test Loss: 0.772 Test Acc: 0.831
Validation loss decreased (-0.809366 --> -0.831242).  Saving model ...
Epoch: 13 cost time: 0.7520694732666016
Epoch: 13, Steps: 8 | Train Loss: 0.598 Vali Loss: 0.689 Vali Acc: 0.838 Test Loss: 0.689 Test Acc: 0.838
Validation loss decreased (-0.831242 --> -0.837493).  Saving model ...
Epoch: 14 cost time: 0.6461958885192871
Epoch: 14, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.627 Vali Acc: 0.838 Test Loss: 0.627 Test Acc: 0.838
Validation loss decreased (-0.837493 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 0.6674134731292725
Epoch: 15, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.572 Vali Acc: 0.853 Test Loss: 0.572 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853119).  Saving model ...
Epoch: 16 cost time: 0.7360806465148926
Epoch: 16, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856245).  Saving model ...
Epoch: 17 cost time: 0.669931173324585
Epoch: 17, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7004780769348145
Epoch: 18, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.479 Vali Acc: 0.853 Test Loss: 0.479 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7586231231689453
Epoch: 19, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6615605354309082
Epoch: 20, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7232968807220459
Epoch: 21, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7318129539489746
Epoch: 22, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.435 Vali Acc: 0.859 Test Loss: 0.435 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859371).  Saving model ...
Epoch: 23 cost time: 0.6342966556549072
Epoch: 23, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.424 Vali Acc: 0.859 Test Loss: 0.424 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 24 cost time: 0.7893979549407959
Epoch: 24, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7007324695587158
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6894187927246094
Epoch: 26, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7227504253387451
Epoch: 27, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.438 Vali Acc: 0.847 Test Loss: 0.438 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7093417644500732
Epoch: 28, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.433 Vali Acc: 0.853 Test Loss: 0.433 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6901340484619141
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.445 Vali Acc: 0.847 Test Loss: 0.445 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7617378234863281
Epoch: 30, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7640130519866943
Epoch: 31, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.455 Vali Acc: 0.863 Test Loss: 0.455 Test Acc: 0.863
Validation loss decreased (-0.859371 --> -0.862495).  Saving model ...
Epoch: 32 cost time: 0.7156262397766113
Epoch: 32, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.453 Vali Acc: 0.863 Test Loss: 0.453 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 33 cost time: 0.7368710041046143
Epoch: 33, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.708683967590332
Epoch: 34, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7437560558319092
Epoch: 35, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6651902198791504
Epoch: 36, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6954011917114258
Epoch: 37, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6632699966430664
Epoch: 38, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5995075702667236
Epoch: 39, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6216261386871338
Epoch: 40, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6504981517791748
Epoch: 41, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7508080005645752
Epoch: 42, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 583816
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2430667877197266
Epoch: 1, Steps: 8 | Train Loss: 2.072 Vali Loss: 2.049 Vali Acc: 0.194 Test Loss: 2.049 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.647533655166626
Epoch: 2, Steps: 8 | Train Loss: 1.898 Vali Loss: 1.911 Vali Acc: 0.562 Test Loss: 1.911 Test Acc: 0.562
Validation loss decreased (-0.193730 --> -0.562481).  Saving model ...
Epoch: 3 cost time: 0.6542773246765137
Epoch: 3, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.653 Vali Acc: 0.781 Test Loss: 1.653 Test Acc: 0.781
Validation loss decreased (-0.562481 --> -0.781233).  Saving model ...
Epoch: 4 cost time: 0.7378787994384766
Epoch: 4, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.276 Vali Acc: 0.800 Test Loss: 1.276 Test Acc: 0.800
Validation loss decreased (-0.781233 --> -0.799987).  Saving model ...
Epoch: 5 cost time: 0.7793140411376953
Epoch: 5, Steps: 8 | Train Loss: 0.871 Vali Loss: 0.886 Vali Acc: 0.822 Test Loss: 0.886 Test Acc: 0.822
Validation loss decreased (-0.799987 --> -0.821866).  Saving model ...
Epoch: 6 cost time: 0.605177640914917
Epoch: 6, Steps: 8 | Train Loss: 0.605 Vali Loss: 0.621 Vali Acc: 0.828 Test Loss: 0.621 Test Acc: 0.828
Validation loss decreased (-0.821866 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.6563706398010254
Epoch: 7, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.711571455001831
Epoch: 8, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.7003250122070312
Epoch: 9, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7855062484741211
Epoch: 10, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.6714644432067871
Epoch: 11, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7388186454772949
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.761763334274292
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7642576694488525
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7316272258758545
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6964943408966064
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.570 Vali Acc: 0.834 Test Loss: 0.570 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7361373901367188
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8947722911834717
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.596 Vali Acc: 0.831 Test Loss: 0.596 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7389533519744873
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.611 Vali Acc: 0.831 Test Loss: 0.611 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7089452743530273
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 634152
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.066739320755005
Epoch: 1, Steps: 8 | Train Loss: 2.018 Vali Loss: 2.053 Vali Acc: 0.212 Test Loss: 2.053 Test Acc: 0.212
Validation loss decreased (inf --> -0.212479).  Saving model ...
Epoch: 2 cost time: 0.593937873840332
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.972 Vali Acc: 0.400 Test Loss: 1.972 Test Acc: 0.400
Validation loss decreased (-0.212479 --> -0.399980).  Saving model ...
Epoch: 3 cost time: 0.6621060371398926
Epoch: 3, Steps: 8 | Train Loss: 1.726 Vali Loss: 1.807 Vali Acc: 0.691 Test Loss: 1.807 Test Acc: 0.691
Validation loss decreased (-0.399980 --> -0.690607).  Saving model ...
Epoch: 4 cost time: 0.7725644111633301
Epoch: 4, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.552 Vali Acc: 0.775 Test Loss: 1.552 Test Acc: 0.775
Validation loss decreased (-0.690607 --> -0.774984).  Saving model ...
Epoch: 5 cost time: 0.7358334064483643
Epoch: 5, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.241 Vali Acc: 0.794 Test Loss: 1.241 Test Acc: 0.794
Validation loss decreased (-0.774984 --> -0.793738).  Saving model ...
Epoch: 6 cost time: 0.7650864124298096
Epoch: 6, Steps: 8 | Train Loss: 0.965 Vali Loss: 0.938 Vali Acc: 0.794 Test Loss: 0.938 Test Acc: 0.794
Validation loss decreased (-0.793738 --> -0.793741).  Saving model ...
Epoch: 7 cost time: 0.7970256805419922
Epoch: 7, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
Validation loss decreased (-0.793741 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 0.860022783279419
Epoch: 8, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
Validation loss decreased (-0.824993 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 0.8327453136444092
Epoch: 9, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.831244 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 0.6762077808380127
Epoch: 10, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.460 Vali Acc: 0.859 Test Loss: 0.460 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 0.7535934448242188
Epoch: 11, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 12 cost time: 0.7806172370910645
Epoch: 12, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.443 Vali Acc: 0.859 Test Loss: 0.443 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6692891120910645
Epoch: 13, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6377847194671631
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8133277893066406
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8710517883300781
Epoch: 16, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7227785587310791
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.491 Vali Acc: 0.834 Test Loss: 0.491 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7310669422149658
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7402675151824951
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7135601043701172
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8195285797119141
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 603688
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.206667184829712
Epoch: 1, Steps: 8 | Train Loss: 2.037 Vali Loss: 2.047 Vali Acc: 0.272 Test Loss: 2.047 Test Acc: 0.272
Validation loss decreased (inf --> -0.271855).  Saving model ...
Epoch: 2 cost time: 0.6552872657775879
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.984 Vali Acc: 0.397 Test Loss: 1.984 Test Acc: 0.397
Validation loss decreased (-0.271855 --> -0.396855).  Saving model ...
Epoch: 3 cost time: 0.8853025436401367
Epoch: 3, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.860 Vali Acc: 0.584 Test Loss: 1.860 Test Acc: 0.584
Validation loss decreased (-0.396855 --> -0.584356).  Saving model ...
Epoch: 4 cost time: 0.7100846767425537
Epoch: 4, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.670 Vali Acc: 0.681 Test Loss: 1.670 Test Acc: 0.681
Validation loss decreased (-0.584356 --> -0.681233).  Saving model ...
Epoch: 5 cost time: 0.573249340057373
Epoch: 5, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.417 Vali Acc: 0.753 Test Loss: 1.417 Test Acc: 0.753
Validation loss decreased (-0.681233 --> -0.753111).  Saving model ...
Epoch: 6 cost time: 0.618178129196167
Epoch: 6, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.140 Vali Acc: 0.791 Test Loss: 1.140 Test Acc: 0.791
Validation loss decreased (-0.753111 --> -0.790614).  Saving model ...
Epoch: 7 cost time: 0.7763240337371826
Epoch: 7, Steps: 8 | Train Loss: 0.897 Vali Loss: 0.882 Vali Acc: 0.825 Test Loss: 0.882 Test Acc: 0.825
Validation loss decreased (-0.790614 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 0.6711201667785645
Epoch: 8, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6601507663726807
Epoch: 9, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
Validation loss decreased (-0.824991 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.7444536685943604
Epoch: 10, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.6780316829681396
Epoch: 11, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.7996397018432617
Epoch: 12, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.7488551139831543
Epoch: 13, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7407257556915283
Epoch: 14, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5757696628570557
Epoch: 15, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6598644256591797
Epoch: 16, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6960124969482422
Epoch: 17, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7234647274017334
Epoch: 18, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7035551071166992
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6676845550537109
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7263553142547607
Epoch: 21, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8559987545013428
Epoch: 22, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 594728
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1336116790771484
Epoch: 1, Steps: 8 | Train Loss: 2.099 Vali Loss: 2.070 Vali Acc: 0.156 Test Loss: 2.070 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.704958438873291
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 2.026 Vali Acc: 0.266 Test Loss: 2.026 Test Acc: 0.266
Validation loss decreased (-0.156229 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 0.7774410247802734
Epoch: 3, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.929 Vali Acc: 0.450 Test Loss: 1.929 Test Acc: 0.450
Validation loss decreased (-0.265605 --> -0.449981).  Saving model ...
Epoch: 4 cost time: 0.7470598220825195
Epoch: 4, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.777 Vali Acc: 0.628 Test Loss: 1.777 Test Acc: 0.628
Validation loss decreased (-0.449981 --> -0.628107).  Saving model ...
Epoch: 5 cost time: 0.6410021781921387
Epoch: 5, Steps: 8 | Train Loss: 1.585 Vali Loss: 1.585 Vali Acc: 0.725 Test Loss: 1.585 Test Acc: 0.725
Validation loss decreased (-0.628107 --> -0.724984).  Saving model ...
Epoch: 6 cost time: 0.6554462909698486
Epoch: 6, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.368 Vali Acc: 0.775 Test Loss: 1.368 Test Acc: 0.775
Validation loss decreased (-0.724984 --> -0.774986).  Saving model ...
Epoch: 7 cost time: 0.5776972770690918
Epoch: 7, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.149 Vali Acc: 0.816 Test Loss: 1.149 Test Acc: 0.816
Validation loss decreased (-0.774986 --> -0.815614).  Saving model ...
Epoch: 8 cost time: 0.7128984928131104
Epoch: 8, Steps: 8 | Train Loss: 0.952 Vali Loss: 0.952 Vali Acc: 0.806 Test Loss: 0.952 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6628618240356445
Epoch: 9, Steps: 8 | Train Loss: 0.754 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7108869552612305
Epoch: 10, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
Validation loss decreased (-0.815614 --> -0.815618).  Saving model ...
Epoch: 11 cost time: 0.6730148792266846
Epoch: 11, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.594 Vali Acc: 0.834 Test Loss: 0.594 Test Acc: 0.834
Validation loss decreased (-0.815618 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 0.7371585369110107
Epoch: 12, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.750267744064331
Epoch: 13, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.647010087966919
Epoch: 14, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.6846511363983154
Epoch: 15, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7899165153503418
Epoch: 16, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7591829299926758
Epoch: 17, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9439826011657715
Epoch: 18, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7013289928436279
Epoch: 19, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 0.7562675476074219
Epoch: 20, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 0.823322057723999
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7755639553070068
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6996438503265381
Epoch: 23, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7727494239807129
Epoch: 24, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9198482036590576
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 0.8018426895141602
Epoch: 26, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7606444358825684
Epoch: 27, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7248210906982422
Epoch: 28, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7585058212280273
Epoch: 29, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7689993381500244
Epoch: 30, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.722531795501709
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7070920467376709
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6476800441741943
Epoch: 33, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7822227478027344
Epoch: 34, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7160418033599854
Epoch: 35, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 588840
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8186495304107666
Epoch: 1, Steps: 8 | Train Loss: 2.080 Vali Loss: 2.059 Vali Acc: 0.188 Test Loss: 2.059 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 0.752061128616333
Epoch: 2, Steps: 8 | Train Loss: 2.019 Vali Loss: 2.012 Vali Acc: 0.269 Test Loss: 2.012 Test Acc: 0.269
Validation loss decreased (-0.187479 --> -0.268730).  Saving model ...
Epoch: 3 cost time: 0.6542940139770508
Epoch: 3, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.916 Vali Acc: 0.419 Test Loss: 1.916 Test Acc: 0.419
Validation loss decreased (-0.268730 --> -0.418731).  Saving model ...
Epoch: 4 cost time: 0.8426764011383057
Epoch: 4, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.779 Vali Acc: 0.556 Test Loss: 1.779 Test Acc: 0.556
Validation loss decreased (-0.418731 --> -0.556232).  Saving model ...
Epoch: 5 cost time: 0.7762355804443359
Epoch: 5, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.609 Vali Acc: 0.650 Test Loss: 1.609 Test Acc: 0.650
Validation loss decreased (-0.556232 --> -0.649984).  Saving model ...
Epoch: 6 cost time: 0.714266300201416
Epoch: 6, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.424 Vali Acc: 0.703 Test Loss: 1.424 Test Acc: 0.703
Validation loss decreased (-0.649984 --> -0.703111).  Saving model ...
Epoch: 7 cost time: 0.8226737976074219
Epoch: 7, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.234 Vali Acc: 0.753 Test Loss: 1.234 Test Acc: 0.753
Validation loss decreased (-0.703111 --> -0.753113).  Saving model ...
Epoch: 8 cost time: 0.7781262397766113
Epoch: 8, Steps: 8 | Train Loss: 1.019 Vali Loss: 1.045 Vali Acc: 0.775 Test Loss: 1.045 Test Acc: 0.775
Validation loss decreased (-0.753113 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 0.7118024826049805
Epoch: 9, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.882 Vali Acc: 0.797 Test Loss: 0.882 Test Acc: 0.797
Validation loss decreased (-0.774990 --> -0.796866).  Saving model ...
Epoch: 10 cost time: 0.7181541919708252
Epoch: 10, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.742 Vali Acc: 0.834 Test Loss: 0.742 Test Acc: 0.834
Validation loss decreased (-0.796866 --> -0.834368).  Saving model ...
Epoch: 11 cost time: 0.6978328227996826
Epoch: 11, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840618).  Saving model ...
Epoch: 12 cost time: 0.6654446125030518
Epoch: 12, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.592 Vali Acc: 0.853 Test Loss: 0.592 Test Acc: 0.853
Validation loss decreased (-0.840618 --> -0.853119).  Saving model ...
Epoch: 13 cost time: 0.6643421649932861
Epoch: 13, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.547 Vali Acc: 0.866 Test Loss: 0.547 Test Acc: 0.866
Validation loss decreased (-0.853119 --> -0.865620).  Saving model ...
Epoch: 14 cost time: 0.6475145816802979
Epoch: 14, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.519 Vali Acc: 0.866 Test Loss: 0.519 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 15 cost time: 0.7155182361602783
Epoch: 15, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7785420417785645
Epoch: 16, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7802145481109619
Epoch: 17, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7520465850830078
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.470 Vali Acc: 0.866 Test Loss: 0.470 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 0.641301155090332
Epoch: 19, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.465 Vali Acc: 0.866 Test Loss: 0.465 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 20 cost time: 0.7371017932891846
Epoch: 20, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.469 Vali Acc: 0.866 Test Loss: 0.469 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7623171806335449
Epoch: 21, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8206679821014404
Epoch: 22, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 23 cost time: 0.6781265735626221
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.471 Vali Acc: 0.869 Test Loss: 0.471 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8158307075500488
Epoch: 24, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9276463985443115
Epoch: 25, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.474 Vali Acc: 0.866 Test Loss: 0.474 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.841149091720581
Epoch: 26, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7536883354187012
Epoch: 27, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8097817897796631
Epoch: 28, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9849808216094971
Epoch: 29, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6984457969665527
Epoch: 30, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.839461088180542
Epoch: 31, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7819397449493408
Epoch: 32, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 586280
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.063300132751465
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.084 Vali Acc: 0.150 Test Loss: 2.084 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 0.7700231075286865
Epoch: 2, Steps: 8 | Train Loss: 2.050 Vali Loss: 2.049 Vali Acc: 0.212 Test Loss: 2.049 Test Acc: 0.212
Validation loss decreased (-0.149979 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 0.7260770797729492
Epoch: 3, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.974 Vali Acc: 0.366 Test Loss: 1.974 Test Acc: 0.366
Validation loss decreased (-0.212480 --> -0.365605).  Saving model ...
Epoch: 4 cost time: 0.715576171875
Epoch: 4, Steps: 8 | Train Loss: 1.829 Vali Loss: 1.866 Vali Acc: 0.562 Test Loss: 1.866 Test Acc: 0.562
Validation loss decreased (-0.365605 --> -0.562481).  Saving model ...
Epoch: 5 cost time: 0.8792064189910889
Epoch: 5, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.733 Vali Acc: 0.675 Test Loss: 1.733 Test Acc: 0.675
Validation loss decreased (-0.562481 --> -0.674983).  Saving model ...
Epoch: 6 cost time: 0.6785426139831543
Epoch: 6, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.580 Vali Acc: 0.694 Test Loss: 1.580 Test Acc: 0.694
Validation loss decreased (-0.674983 --> -0.693734).  Saving model ...
Epoch: 7 cost time: 0.6789669990539551
Epoch: 7, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.414 Vali Acc: 0.731 Test Loss: 1.414 Test Acc: 0.731
Validation loss decreased (-0.693734 --> -0.731236).  Saving model ...
Epoch: 8 cost time: 0.7877745628356934
Epoch: 8, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.239 Vali Acc: 0.766 Test Loss: 1.239 Test Acc: 0.766
Validation loss decreased (-0.731236 --> -0.765613).  Saving model ...
Epoch: 9 cost time: 0.7516975402832031
Epoch: 9, Steps: 8 | Train Loss: 1.054 Vali Loss: 1.074 Vali Acc: 0.778 Test Loss: 1.074 Test Acc: 0.778
Validation loss decreased (-0.765613 --> -0.778114).  Saving model ...
Epoch: 10 cost time: 0.678248405456543
Epoch: 10, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.933 Vali Acc: 0.800 Test Loss: 0.933 Test Acc: 0.800
Validation loss decreased (-0.778114 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.701775074005127
Epoch: 11, Steps: 8 | Train Loss: 0.730 Vali Loss: 0.803 Vali Acc: 0.816 Test Loss: 0.803 Test Acc: 0.816
Validation loss decreased (-0.799991 --> -0.815617).  Saving model ...
Epoch: 12 cost time: 0.7191293239593506
Epoch: 12, Steps: 8 | Train Loss: 0.598 Vali Loss: 0.702 Vali Acc: 0.819 Test Loss: 0.702 Test Acc: 0.819
Validation loss decreased (-0.815617 --> -0.818743).  Saving model ...
Epoch: 13 cost time: 0.735919713973999
Epoch: 13, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
Validation loss decreased (-0.818743 --> -0.821869).  Saving model ...
Epoch: 14 cost time: 0.7411620616912842
Epoch: 14, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.642024040222168
Epoch: 15, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 0.7791612148284912
Epoch: 16, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 0.6520998477935791
Epoch: 17, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8740606307983398
Epoch: 18, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 0.8559343814849854
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 0.7330894470214844
Epoch: 20, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 0.6451938152313232
Epoch: 21, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.5927164554595947
Epoch: 22, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 23 cost time: 0.5494980812072754
Epoch: 23, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 24 cost time: 0.6875312328338623
Epoch: 24, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6369643211364746
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.640709638595581
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7496936321258545
Epoch: 27, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7053916454315186
Epoch: 28, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8003790378570557
Epoch: 29, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.843496561050415
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7287211418151855
Epoch: 31, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6327753067016602
Epoch: 32, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.693885087966919
Epoch: 33, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 583688
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0768072605133057
Epoch: 1, Steps: 8 | Train Loss: 2.050 Vali Loss: 2.046 Vali Acc: 0.244 Test Loss: 2.046 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 0.7735397815704346
Epoch: 2, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.995 Vali Acc: 0.281 Test Loss: 1.995 Test Acc: 0.281
Validation loss decreased (-0.243730 --> -0.281230).  Saving model ...
Epoch: 3 cost time: 0.77695631980896
Epoch: 3, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.907 Vali Acc: 0.391 Test Loss: 1.907 Test Acc: 0.391
Validation loss decreased (-0.281230 --> -0.390606).  Saving model ...
Epoch: 4 cost time: 0.6622424125671387
Epoch: 4, Steps: 8 | Train Loss: 1.798 Vali Loss: 1.792 Vali Acc: 0.572 Test Loss: 1.792 Test Acc: 0.572
Validation loss decreased (-0.390606 --> -0.571857).  Saving model ...
Epoch: 5 cost time: 0.8218355178833008
Epoch: 5, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.661 Vali Acc: 0.688 Test Loss: 1.661 Test Acc: 0.688
Validation loss decreased (-0.571857 --> -0.687483).  Saving model ...
Epoch: 6 cost time: 0.6985712051391602
Epoch: 6, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.521 Vali Acc: 0.747 Test Loss: 1.521 Test Acc: 0.747
Validation loss decreased (-0.687483 --> -0.746860).  Saving model ...
Epoch: 7 cost time: 0.6895079612731934
Epoch: 7, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.377 Vali Acc: 0.753 Test Loss: 1.377 Test Acc: 0.753
Validation loss decreased (-0.746860 --> -0.753111).  Saving model ...
Epoch: 8 cost time: 0.8035838603973389
Epoch: 8, Steps: 8 | Train Loss: 1.220 Vali Loss: 1.229 Vali Acc: 0.766 Test Loss: 1.229 Test Acc: 0.766
Validation loss decreased (-0.753111 --> -0.765613).  Saving model ...
Epoch: 9 cost time: 0.7304019927978516
Epoch: 9, Steps: 8 | Train Loss: 1.086 Vali Loss: 1.085 Vali Acc: 0.775 Test Loss: 1.085 Test Acc: 0.775
Validation loss decreased (-0.765613 --> -0.774989).  Saving model ...
Epoch: 10 cost time: 0.8111443519592285
Epoch: 10, Steps: 8 | Train Loss: 0.918 Vali Loss: 0.956 Vali Acc: 0.794 Test Loss: 0.956 Test Acc: 0.794
Validation loss decreased (-0.774989 --> -0.793740).  Saving model ...
Epoch: 11 cost time: 0.7394380569458008
Epoch: 11, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.846 Vali Acc: 0.794 Test Loss: 0.846 Test Acc: 0.794
Validation loss decreased (-0.793740 --> -0.793742).  Saving model ...
Epoch: 12 cost time: 0.6054325103759766
Epoch: 12, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.752 Vali Acc: 0.797 Test Loss: 0.752 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796867).  Saving model ...
Epoch: 13 cost time: 0.5971169471740723
Epoch: 13, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.671 Vali Acc: 0.809 Test Loss: 0.671 Test Acc: 0.809
Validation loss decreased (-0.796867 --> -0.809368).  Saving model ...
Epoch: 14 cost time: 0.6492013931274414
Epoch: 14, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 15 cost time: 0.669684886932373
Epoch: 15, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
Validation loss decreased (-0.818744 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 0.672844648361206
Epoch: 16, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.517 Vali Acc: 0.853 Test Loss: 0.517 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.7620041370391846
Epoch: 17, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 0.6914856433868408
Epoch: 18, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8145325183868408
Epoch: 19, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5977256298065186
Epoch: 20, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.441 Vali Acc: 0.847 Test Loss: 0.441 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6607775688171387
Epoch: 21, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.641777515411377
Epoch: 22, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.429 Vali Acc: 0.859 Test Loss: 0.429 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 23 cost time: 0.7099995613098145
Epoch: 23, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7462506294250488
Epoch: 24, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.423 Vali Acc: 0.847 Test Loss: 0.423 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6820881366729736
Epoch: 25, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.424 Vali Acc: 0.847 Test Loss: 0.424 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6990106105804443
Epoch: 26, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.426 Vali Acc: 0.847 Test Loss: 0.426 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8530986309051514
Epoch: 27, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.420 Vali Acc: 0.869 Test Loss: 0.420 Test Acc: 0.869
Validation loss decreased (-0.859371 --> -0.868746).  Saving model ...
Epoch: 28 cost time: 0.7476892471313477
Epoch: 28, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.427 Vali Acc: 0.863 Test Loss: 0.427 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7538659572601318
Epoch: 29, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.431 Vali Acc: 0.863 Test Loss: 0.431 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8190202713012695
Epoch: 30, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.435 Vali Acc: 0.859 Test Loss: 0.435 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8747603893280029
Epoch: 31, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6299197673797607
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6687355041503906
Epoch: 33, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.436 Vali Acc: 0.872 Test Loss: 0.436 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871871).  Saving model ...
Epoch: 34 cost time: 0.7758791446685791
Epoch: 34, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.435 Vali Acc: 0.872 Test Loss: 0.435 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 35 cost time: 0.73575758934021
Epoch: 35, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.448 Vali Acc: 0.866 Test Loss: 0.448 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.684457540512085
Epoch: 36, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6774337291717529
Epoch: 37, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6248757839202881
Epoch: 38, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7131524085998535
Epoch: 39, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.467 Vali Acc: 0.866 Test Loss: 0.467 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6075663566589355
Epoch: 40, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.468 Vali Acc: 0.866 Test Loss: 0.468 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6755428314208984
Epoch: 41, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7251083850860596
Epoch: 42, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7184536457061768
Epoch: 43, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6760988235473633
Epoch: 44, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.492 Vali Acc: 0.866 Test Loss: 0.492 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 581128
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.136235237121582
Epoch: 1, Steps: 8 | Train Loss: 1.999 Vali Loss: 1.887 Vali Acc: 0.481 Test Loss: 1.887 Test Acc: 0.481
Validation loss decreased (inf --> -0.481231).  Saving model ...
Epoch: 2 cost time: 0.981513500213623
Epoch: 2, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.276 Vali Acc: 0.787 Test Loss: 1.276 Test Acc: 0.787
Validation loss decreased (-0.481231 --> -0.787487).  Saving model ...
Epoch: 3 cost time: 0.9664554595947266
Epoch: 3, Steps: 8 | Train Loss: 0.730 Vali Loss: 0.680 Vali Acc: 0.809 Test Loss: 0.680 Test Acc: 0.809
Validation loss decreased (-0.787487 --> -0.809368).  Saving model ...
Epoch: 4 cost time: 0.9146833419799805
Epoch: 4, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.809368 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 0.6970889568328857
Epoch: 5, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.7605307102203369
Epoch: 6, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8177416324615479
Epoch: 7, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.604 Vali Acc: 0.831 Test Loss: 0.604 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8052859306335449
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.682 Vali Acc: 0.831 Test Loss: 0.682 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9289076328277588
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.777 Vali Acc: 0.828 Test Loss: 0.777 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9629716873168945
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.831 Test Loss: 0.791 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0822577476501465
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.828 Test Loss: 0.805 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9582481384277344
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.833 Vali Acc: 0.825 Test Loss: 0.833 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9083003997802734
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.828 Test Loss: 0.849 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9057497978210449
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.831 Test Loss: 0.844 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8081297874450684
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.831 Test Loss: 0.840 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 2338440
model size : 8.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2096831798553467
Epoch: 1, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.938 Vali Acc: 0.494 Test Loss: 1.938 Test Acc: 0.494
Validation loss decreased (inf --> -0.493731).  Saving model ...
Epoch: 2 cost time: 1.0118272304534912
Epoch: 2, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.545 Vali Acc: 0.762 Test Loss: 1.545 Test Acc: 0.762
Validation loss decreased (-0.493731 --> -0.762485).  Saving model ...
Epoch: 3 cost time: 0.9627864360809326
Epoch: 3, Steps: 8 | Train Loss: 1.028 Vali Loss: 0.993 Vali Acc: 0.812 Test Loss: 0.993 Test Acc: 0.812
Validation loss decreased (-0.762485 --> -0.812490).  Saving model ...
Epoch: 4 cost time: 0.9413962364196777
Epoch: 4, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.595 Vali Acc: 0.838 Test Loss: 0.595 Test Acc: 0.838
Validation loss decreased (-0.812490 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 0.7517781257629395
Epoch: 5, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 0.8057448863983154
Epoch: 6, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.456 Vali Acc: 0.853 Test Loss: 0.456 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7005467414855957
Epoch: 7, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0357942581176758
Epoch: 8, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7344875335693359
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0625250339508057
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8822681903839111
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8574612140655518
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7606351375579834
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7605037689208984
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6595017910003662
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 2222728
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1443865299224854
Epoch: 1, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.965 Vali Acc: 0.416 Test Loss: 1.965 Test Acc: 0.416
Validation loss decreased (inf --> -0.415605).  Saving model ...
Epoch: 2 cost time: 0.7958705425262451
Epoch: 2, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.669 Vali Acc: 0.697 Test Loss: 1.669 Test Acc: 0.697
Validation loss decreased (-0.415605 --> -0.696858).  Saving model ...
Epoch: 3 cost time: 0.9198188781738281
Epoch: 3, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.217 Vali Acc: 0.797 Test Loss: 1.217 Test Acc: 0.797
Validation loss decreased (-0.696858 --> -0.796863).  Saving model ...
Epoch: 4 cost time: 0.887688159942627
Epoch: 4, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.779 Vali Acc: 0.816 Test Loss: 0.779 Test Acc: 0.816
Validation loss decreased (-0.796863 --> -0.815617).  Saving model ...
Epoch: 5 cost time: 0.8523299694061279
Epoch: 5, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 0.7596564292907715
Epoch: 6, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
Validation loss decreased (-0.821870 --> -0.856246).  Saving model ...
Epoch: 7 cost time: 0.8047950267791748
Epoch: 7, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.431 Vali Acc: 0.869 Test Loss: 0.431 Test Acc: 0.869
Validation loss decreased (-0.856246 --> -0.868746).  Saving model ...
Epoch: 8 cost time: 0.6746006011962891
Epoch: 8, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7379670143127441
Epoch: 9, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6780686378479004
Epoch: 10, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9293463230133057
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9018633365631104
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8911707401275635
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.559 Vali Acc: 0.834 Test Loss: 0.559 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7578940391540527
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7547593116760254
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.834 Test Loss: 0.585 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8742775917053223
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7049450874328613
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.620 Vali Acc: 0.831 Test Loss: 0.620 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2180744
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0142722129821777
Epoch: 1, Steps: 8 | Train Loss: 2.078 Vali Loss: 2.002 Vali Acc: 0.297 Test Loss: 2.002 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 0.7003152370452881
Epoch: 2, Steps: 8 | Train Loss: 1.817 Vali Loss: 1.754 Vali Acc: 0.659 Test Loss: 1.754 Test Acc: 0.659
Validation loss decreased (-0.296855 --> -0.659357).  Saving model ...
Epoch: 3 cost time: 0.7053377628326416
Epoch: 3, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.370 Vali Acc: 0.784 Test Loss: 1.370 Test Acc: 0.784
Validation loss decreased (-0.659357 --> -0.784361).  Saving model ...
Epoch: 4 cost time: 0.940748929977417
Epoch: 4, Steps: 8 | Train Loss: 0.993 Vali Loss: 0.938 Vali Acc: 0.822 Test Loss: 0.938 Test Acc: 0.822
Validation loss decreased (-0.784361 --> -0.821866).  Saving model ...
Epoch: 5 cost time: 0.8926432132720947
Epoch: 5, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.629 Vali Acc: 0.831 Test Loss: 0.629 Test Acc: 0.831
Validation loss decreased (-0.821866 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 0.8834762573242188
Epoch: 6, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.8518321514129639
Epoch: 7, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.432 Vali Acc: 0.859 Test Loss: 0.432 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859371).  Saving model ...
Epoch: 8 cost time: 0.7876925468444824
Epoch: 8, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.435 Vali Acc: 0.859 Test Loss: 0.435 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7015972137451172
Epoch: 9, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7825345993041992
Epoch: 10, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8725934028625488
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7746486663818359
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.865443229675293
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8414316177368164
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9895904064178467
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.843621015548706
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8624835014343262
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2163336
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9218852519989014
Epoch: 1, Steps: 8 | Train Loss: 2.056 Vali Loss: 1.984 Vali Acc: 0.309 Test Loss: 1.984 Test Acc: 0.309
Validation loss decreased (inf --> -0.309355).  Saving model ...
Epoch: 2 cost time: 0.6663777828216553
Epoch: 2, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.783 Vali Acc: 0.678 Test Loss: 1.783 Test Acc: 0.678
Validation loss decreased (-0.309355 --> -0.678107).  Saving model ...
Epoch: 3 cost time: 0.7742874622344971
Epoch: 3, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.463 Vali Acc: 0.806 Test Loss: 1.463 Test Acc: 0.806
Validation loss decreased (-0.678107 --> -0.806235).  Saving model ...
Epoch: 4 cost time: 0.7376999855041504
Epoch: 4, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.077 Vali Acc: 0.819 Test Loss: 1.077 Test Acc: 0.819
Validation loss decreased (-0.806235 --> -0.818739).  Saving model ...
Epoch: 5 cost time: 0.8429269790649414
Epoch: 5, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.746 Vali Acc: 0.844 Test Loss: 0.746 Test Acc: 0.844
Validation loss decreased (-0.818739 --> -0.843743).  Saving model ...
Epoch: 6 cost time: 0.7191617488861084
Epoch: 6, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.543 Vali Acc: 0.853 Test Loss: 0.543 Test Acc: 0.853
Validation loss decreased (-0.843743 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.7735147476196289
Epoch: 7, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.457 Vali Acc: 0.853 Test Loss: 0.457 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.6543231010437012
Epoch: 8, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.431 Vali Acc: 0.866 Test Loss: 0.431 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865621).  Saving model ...
Epoch: 9 cost time: 0.7010135650634766
Epoch: 9, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6993100643157959
Epoch: 10, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8586459159851074
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.446 Vali Acc: 0.863 Test Loss: 0.446 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6660308837890625
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7666115760803223
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.462 Vali Acc: 0.869 Test Loss: 0.462 Test Acc: 0.869
Validation loss decreased (-0.865621 --> -0.868745).  Saving model ...
Epoch: 14 cost time: 0.8020024299621582
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7877829074859619
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7643320560455322
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6572005748748779
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.489 Vali Acc: 0.866 Test Loss: 0.489 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8439242839813232
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.498 Vali Acc: 0.866 Test Loss: 0.498 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7066130638122559
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.513 Vali Acc: 0.863 Test Loss: 0.513 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6377017498016357
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8139913082122803
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5671036243438721
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6247787475585938
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2146952
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9086754322052002
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.023 Vali Acc: 0.269 Test Loss: 2.023 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 0.8133718967437744
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.848 Vali Acc: 0.550 Test Loss: 1.848 Test Acc: 0.550
Validation loss decreased (-0.268730 --> -0.549982).  Saving model ...
Epoch: 3 cost time: 0.7825541496276855
Epoch: 3, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.569 Vali Acc: 0.759 Test Loss: 1.569 Test Acc: 0.759
Validation loss decreased (-0.549982 --> -0.759359).  Saving model ...
Epoch: 4 cost time: 0.7845029830932617
Epoch: 4, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.236 Vali Acc: 0.794 Test Loss: 1.236 Test Acc: 0.794
Validation loss decreased (-0.759359 --> -0.793738).  Saving model ...
Epoch: 5 cost time: 0.6299512386322021
Epoch: 5, Steps: 8 | Train Loss: 0.979 Vali Loss: 0.906 Vali Acc: 0.806 Test Loss: 0.906 Test Acc: 0.806
Validation loss decreased (-0.793738 --> -0.806241).  Saving model ...
Epoch: 6 cost time: 0.7042655944824219
Epoch: 6, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
Validation loss decreased (-0.806241 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 0.7882499694824219
Epoch: 7, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.821868 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.7234189510345459
Epoch: 8, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.7372217178344727
Epoch: 9, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.437 Vali Acc: 0.859 Test Loss: 0.437 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859371).  Saving model ...
Epoch: 10 cost time: 0.7289915084838867
Epoch: 10, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.434 Vali Acc: 0.859 Test Loss: 0.434 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 11 cost time: 0.70693039894104
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.425 Vali Acc: 0.872 Test Loss: 0.425 Test Acc: 0.872
Validation loss decreased (-0.859371 --> -0.871871).  Saving model ...
Epoch: 12 cost time: 0.779449462890625
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.437 Vali Acc: 0.859 Test Loss: 0.437 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8083205223083496
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.841416597366333
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6469686031341553
Epoch: 15, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6875185966491699
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7286572456359863
Epoch: 17, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.650726318359375
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6743512153625488
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8295819759368896
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.719231367111206
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 2136584
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0494155883789062
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 2.097 Vali Acc: 0.150 Test Loss: 2.097 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 0.6618683338165283
Epoch: 2, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.941 Vali Acc: 0.328 Test Loss: 1.941 Test Acc: 0.328
Validation loss decreased (-0.149979 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 0.685396671295166
Epoch: 3, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.685 Vali Acc: 0.666 Test Loss: 1.685 Test Acc: 0.666
Validation loss decreased (-0.328106 --> -0.665608).  Saving model ...
Epoch: 4 cost time: 0.6453855037689209
Epoch: 4, Steps: 8 | Train Loss: 1.391 Vali Loss: 1.372 Vali Acc: 0.738 Test Loss: 1.372 Test Acc: 0.738
Validation loss decreased (-0.665608 --> -0.737486).  Saving model ...
Epoch: 5 cost time: 0.6938114166259766
Epoch: 5, Steps: 8 | Train Loss: 1.070 Vali Loss: 1.052 Vali Acc: 0.772 Test Loss: 1.052 Test Acc: 0.772
Validation loss decreased (-0.737486 --> -0.771864).  Saving model ...
Epoch: 6 cost time: 0.6244451999664307
Epoch: 6, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.771864 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.6191229820251465
Epoch: 7, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 0.6350634098052979
Epoch: 8, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
Validation loss decreased (-0.809369 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 0.6367573738098145
Epoch: 9, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.834370 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.5895941257476807
Epoch: 10, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 0.7600998878479004
Epoch: 11, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.440 Vali Acc: 0.856 Test Loss: 0.440 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.787534236907959
Epoch: 12, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7523434162139893
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.430 Vali Acc: 0.863 Test Loss: 0.430 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 14 cost time: 0.7117667198181152
Epoch: 14, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.435 Vali Acc: 0.853 Test Loss: 0.435 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6278584003448486
Epoch: 15, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.433 Vali Acc: 0.869 Test Loss: 0.433 Test Acc: 0.869
Validation loss decreased (-0.862496 --> -0.868746).  Saving model ...
Epoch: 16 cost time: 0.7819969654083252
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.435 Vali Acc: 0.863 Test Loss: 0.435 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.956439733505249
Epoch: 17, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.446 Vali Acc: 0.856 Test Loss: 0.446 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8500576019287109
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8146927356719971
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9285037517547607
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8466160297393799
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7122104167938232
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7242672443389893
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8368961811065674
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8305935859680176
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2132488
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1914148330688477
Epoch: 1, Steps: 8 | Train Loss: 2.081 Vali Loss: 1.990 Vali Acc: 0.356 Test Loss: 1.990 Test Acc: 0.356
Validation loss decreased (inf --> -0.356230).  Saving model ...
Epoch: 2 cost time: 0.764401912689209
Epoch: 2, Steps: 8 | Train Loss: 1.747 Vali Loss: 1.664 Vali Acc: 0.700 Test Loss: 1.664 Test Acc: 0.700
Validation loss decreased (-0.356230 --> -0.699983).  Saving model ...
Epoch: 3 cost time: 0.7531483173370361
Epoch: 3, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.190 Vali Acc: 0.791 Test Loss: 1.190 Test Acc: 0.791
Validation loss decreased (-0.699983 --> -0.790613).  Saving model ...
Epoch: 4 cost time: 0.6765520572662354
Epoch: 4, Steps: 8 | Train Loss: 0.769 Vali Loss: 0.758 Vali Acc: 0.816 Test Loss: 0.758 Test Acc: 0.816
Validation loss decreased (-0.790613 --> -0.815617).  Saving model ...
Epoch: 5 cost time: 0.7066795825958252
Epoch: 5, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.815617 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.7037246227264404
Epoch: 6, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.7792994976043701
Epoch: 7, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.6084611415863037
Epoch: 8, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8000984191894531
Epoch: 9, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.702425479888916
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8660464286804199
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.642 Vali Acc: 0.819 Test Loss: 0.642 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8062636852264404
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6808459758758545
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.674 Vali Acc: 0.819 Test Loss: 0.674 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6566627025604248
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.825 Test Loss: 0.679 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.695009708404541
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.828 Test Loss: 0.690 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5335075855255127
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5589568614959717
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 661320
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9784255027770996
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.053 Vali Acc: 0.312 Test Loss: 2.053 Test Acc: 0.312
Validation loss decreased (inf --> -0.312479).  Saving model ...
Epoch: 2 cost time: 0.739861011505127
Epoch: 2, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.864 Vali Acc: 0.566 Test Loss: 1.864 Test Acc: 0.566
Validation loss decreased (-0.312479 --> -0.565606).  Saving model ...
Epoch: 3 cost time: 0.620142936706543
Epoch: 3, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.534 Vali Acc: 0.747 Test Loss: 1.534 Test Acc: 0.747
Validation loss decreased (-0.565606 --> -0.746860).  Saving model ...
Epoch: 4 cost time: 0.7174289226531982
Epoch: 4, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.112 Vali Acc: 0.806 Test Loss: 1.112 Test Acc: 0.806
Validation loss decreased (-0.746860 --> -0.806239).  Saving model ...
Epoch: 5 cost time: 0.7032239437103271
Epoch: 5, Steps: 8 | Train Loss: 0.749 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
Validation loss decreased (-0.806239 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 0.6648170948028564
Epoch: 6, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.545 Vali Acc: 0.834 Test Loss: 0.545 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.5570845603942871
Epoch: 7, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.6504926681518555
Epoch: 8, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.453 Vali Acc: 0.859 Test Loss: 0.453 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 0.6189091205596924
Epoch: 9, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.464 Vali Acc: 0.859 Test Loss: 0.464 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6035068035125732
Epoch: 10, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6075975894927979
Epoch: 11, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7113008499145508
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6360921859741211
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7006242275238037
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6580493450164795
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7558383941650391
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7776186466217041
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6801755428314209
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 603464
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.029134511947632
Epoch: 1, Steps: 8 | Train Loss: 2.059 Vali Loss: 2.007 Vali Acc: 0.303 Test Loss: 2.007 Test Acc: 0.303
Validation loss decreased (inf --> -0.303105).  Saving model ...
Epoch: 2 cost time: 0.6265511512756348
Epoch: 2, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.873 Vali Acc: 0.481 Test Loss: 1.873 Test Acc: 0.481
Validation loss decreased (-0.303105 --> -0.481231).  Saving model ...
Epoch: 3 cost time: 0.5986485481262207
Epoch: 3, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.645 Vali Acc: 0.700 Test Loss: 1.645 Test Acc: 0.700
Validation loss decreased (-0.481231 --> -0.699984).  Saving model ...
Epoch: 4 cost time: 0.5718185901641846
Epoch: 4, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.333 Vali Acc: 0.781 Test Loss: 1.333 Test Acc: 0.781
Validation loss decreased (-0.699984 --> -0.781237).  Saving model ...
Epoch: 5 cost time: 0.5914947986602783
Epoch: 5, Steps: 8 | Train Loss: 1.009 Vali Loss: 1.002 Vali Acc: 0.816 Test Loss: 1.002 Test Acc: 0.816
Validation loss decreased (-0.781237 --> -0.815615).  Saving model ...
Epoch: 6 cost time: 0.6875922679901123
Epoch: 6, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.725 Vali Acc: 0.831 Test Loss: 0.725 Test Acc: 0.831
Validation loss decreased (-0.815615 --> -0.831243).  Saving model ...
Epoch: 7 cost time: 0.669574499130249
Epoch: 7, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.571 Vali Acc: 0.847 Test Loss: 0.571 Test Acc: 0.847
Validation loss decreased (-0.831243 --> -0.846869).  Saving model ...
Epoch: 8 cost time: 0.5641272068023682
Epoch: 8, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.6796226501464844
Epoch: 9, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.5649149417877197
Epoch: 10, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.7296221256256104
Epoch: 11, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.6253440380096436
Epoch: 12, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6410770416259766
Epoch: 13, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6702420711517334
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7524089813232422
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6981039047241211
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7303378582000732
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6597635746002197
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6040945053100586
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6920678615570068
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6905257701873779
Epoch: 21, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 582472
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.080913543701172
Epoch: 1, Steps: 8 | Train Loss: 2.072 Vali Loss: 2.034 Vali Acc: 0.172 Test Loss: 2.034 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 0.6264784336090088
Epoch: 2, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.906 Vali Acc: 0.456 Test Loss: 1.906 Test Acc: 0.456
Validation loss decreased (-0.171855 --> -0.456231).  Saving model ...
Epoch: 3 cost time: 0.6217217445373535
Epoch: 3, Steps: 8 | Train Loss: 1.710 Vali Loss: 1.691 Vali Acc: 0.725 Test Loss: 1.691 Test Acc: 0.725
Validation loss decreased (-0.456231 --> -0.724983).  Saving model ...
Epoch: 4 cost time: 0.699246883392334
Epoch: 4, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.404 Vali Acc: 0.784 Test Loss: 1.404 Test Acc: 0.784
Validation loss decreased (-0.724983 --> -0.784361).  Saving model ...
Epoch: 5 cost time: 0.6296319961547852
Epoch: 5, Steps: 8 | Train Loss: 1.128 Vali Loss: 1.086 Vali Acc: 0.797 Test Loss: 1.086 Test Acc: 0.797
Validation loss decreased (-0.784361 --> -0.796864).  Saving model ...
Epoch: 6 cost time: 0.6862547397613525
Epoch: 6, Steps: 8 | Train Loss: 0.852 Vali Loss: 0.811 Vali Acc: 0.812 Test Loss: 0.811 Test Acc: 0.812
Validation loss decreased (-0.796864 --> -0.812492).  Saving model ...
Epoch: 7 cost time: 0.717989444732666
Epoch: 7, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.620 Vali Acc: 0.831 Test Loss: 0.620 Test Acc: 0.831
Validation loss decreased (-0.812492 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 0.5923616886138916
Epoch: 8, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.6437726020812988
Epoch: 9, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.6744673252105713
Epoch: 10, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.462 Vali Acc: 0.866 Test Loss: 0.462 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 0.6758661270141602
Epoch: 11, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.457 Vali Acc: 0.863 Test Loss: 0.457 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6470139026641846
Epoch: 12, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865621).  Saving model ...
Epoch: 13 cost time: 0.6875159740447998
Epoch: 13, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6060671806335449
Epoch: 14, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.477 Vali Acc: 0.834 Test Loss: 0.477 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7036581039428711
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7218880653381348
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.585860013961792
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.596174955368042
Epoch: 18, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5866117477416992
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6038625240325928
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5728733539581299
Epoch: 21, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6037852764129639
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 573768
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8853647708892822
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.068 Vali Acc: 0.172 Test Loss: 2.068 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.6737232208251953
Epoch: 2, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.971 Vali Acc: 0.359 Test Loss: 1.971 Test Acc: 0.359
Validation loss decreased (-0.171854 --> -0.359355).  Saving model ...
Epoch: 3 cost time: 0.6447384357452393
Epoch: 3, Steps: 8 | Train Loss: 1.823 Vali Loss: 1.810 Vali Acc: 0.553 Test Loss: 1.810 Test Acc: 0.553
Validation loss decreased (-0.359355 --> -0.553107).  Saving model ...
Epoch: 4 cost time: 0.6743552684783936
Epoch: 4, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.594 Vali Acc: 0.691 Test Loss: 1.594 Test Acc: 0.691
Validation loss decreased (-0.553107 --> -0.690609).  Saving model ...
Epoch: 5 cost time: 0.6027004718780518
Epoch: 5, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.340 Vali Acc: 0.728 Test Loss: 1.340 Test Acc: 0.728
Validation loss decreased (-0.690609 --> -0.728112).  Saving model ...
Epoch: 6 cost time: 0.6494541168212891
Epoch: 6, Steps: 8 | Train Loss: 1.094 Vali Loss: 1.093 Vali Acc: 0.784 Test Loss: 1.093 Test Acc: 0.784
Validation loss decreased (-0.728112 --> -0.784364).  Saving model ...
Epoch: 7 cost time: 0.623603343963623
Epoch: 7, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.860 Vali Acc: 0.812 Test Loss: 0.860 Test Acc: 0.812
Validation loss decreased (-0.784364 --> -0.812491).  Saving model ...
Epoch: 8 cost time: 0.5855882167816162
Epoch: 8, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.687 Vali Acc: 0.822 Test Loss: 0.687 Test Acc: 0.822
Validation loss decreased (-0.812491 --> -0.821868).  Saving model ...
Epoch: 9 cost time: 0.6909186840057373
Epoch: 9, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
Validation loss decreased (-0.821868 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.6307694911956787
Epoch: 10, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.837494 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.6373538970947266
Epoch: 11, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.5637485980987549
Epoch: 12, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.6847074031829834
Epoch: 13, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6041090488433838
Epoch: 14, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5855395793914795
Epoch: 15, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.625690221786499
Epoch: 16, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7484979629516602
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7309310436248779
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7655243873596191
Epoch: 19, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7178125381469727
Epoch: 20, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6927845478057861
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6822237968444824
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7054657936096191
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.656517744064331
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 25 cost time: 0.7784721851348877
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7607920169830322
Epoch: 26, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8035786151885986
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7164134979248047
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7502198219299316
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7711615562438965
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.551856279373169
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7081611156463623
Epoch: 32, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7595083713531494
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7010040283203125
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 565576
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.907217264175415
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.078 Vali Acc: 0.147 Test Loss: 2.078 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.6169352531433105
Epoch: 2, Steps: 8 | Train Loss: 2.057 Vali Loss: 2.004 Vali Acc: 0.253 Test Loss: 2.004 Test Acc: 0.253
Validation loss decreased (-0.146854 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 0.6795051097869873
Epoch: 3, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.877 Vali Acc: 0.537 Test Loss: 1.877 Test Acc: 0.537
Validation loss decreased (-0.253105 --> -0.537481).  Saving model ...
Epoch: 4 cost time: 0.6911461353302002
Epoch: 4, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.704 Vali Acc: 0.684 Test Loss: 1.704 Test Acc: 0.684
Validation loss decreased (-0.537481 --> -0.684358).  Saving model ...
Epoch: 5 cost time: 0.749617338180542
Epoch: 5, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.502 Vali Acc: 0.741 Test Loss: 1.502 Test Acc: 0.741
Validation loss decreased (-0.684358 --> -0.740610).  Saving model ...
Epoch: 6 cost time: 0.6701292991638184
Epoch: 6, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.284 Vali Acc: 0.766 Test Loss: 1.284 Test Acc: 0.766
Validation loss decreased (-0.740610 --> -0.765612).  Saving model ...
Epoch: 7 cost time: 0.6655862331390381
Epoch: 7, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.064 Vali Acc: 0.794 Test Loss: 1.064 Test Acc: 0.794
Validation loss decreased (-0.765612 --> -0.793739).  Saving model ...
Epoch: 8 cost time: 0.7441787719726562
Epoch: 8, Steps: 8 | Train Loss: 0.885 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
Validation loss decreased (-0.793739 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.6976382732391357
Epoch: 9, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
Validation loss decreased (-0.799991 --> -0.803118).  Saving model ...
Epoch: 10 cost time: 0.702204704284668
Epoch: 10, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
Validation loss decreased (-0.803118 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 0.7888123989105225
Epoch: 11, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837494).  Saving model ...
Epoch: 12 cost time: 0.7856278419494629
Epoch: 12, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.837494 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.7352097034454346
Epoch: 13, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7709283828735352
Epoch: 14, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 0.719336748123169
Epoch: 15, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 16 cost time: 0.8106296062469482
Epoch: 16, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6328935623168945
Epoch: 17, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.443 Vali Acc: 0.859 Test Loss: 0.443 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 18 cost time: 0.6039879322052002
Epoch: 18, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.438 Vali Acc: 0.859 Test Loss: 0.438 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 19 cost time: 0.759838342666626
Epoch: 19, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6502547264099121
Epoch: 20, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6840856075286865
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5989468097686768
Epoch: 22, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7516744136810303
Epoch: 23, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6924989223480225
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7198483943939209
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7151110172271729
Epoch: 26, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6448342800140381
Epoch: 27, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6336703300476074
Epoch: 28, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 560392
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.146402359008789
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 2.044 Vali Acc: 0.241 Test Loss: 2.044 Test Acc: 0.241
Validation loss decreased (inf --> -0.240605).  Saving model ...
Epoch: 2 cost time: 0.5658047199249268
Epoch: 2, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.971 Vali Acc: 0.366 Test Loss: 1.971 Test Acc: 0.366
Validation loss decreased (-0.240605 --> -0.365605).  Saving model ...
Epoch: 3 cost time: 0.7341291904449463
Epoch: 3, Steps: 8 | Train Loss: 1.857 Vali Loss: 1.851 Vali Acc: 0.559 Test Loss: 1.851 Test Acc: 0.559
Validation loss decreased (-0.365605 --> -0.559356).  Saving model ...
Epoch: 4 cost time: 0.6440763473510742
Epoch: 4, Steps: 8 | Train Loss: 1.691 Vali Loss: 1.694 Vali Acc: 0.672 Test Loss: 1.694 Test Acc: 0.672
Validation loss decreased (-0.559356 --> -0.671858).  Saving model ...
Epoch: 5 cost time: 0.7102093696594238
Epoch: 5, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.509 Vali Acc: 0.731 Test Loss: 1.509 Test Acc: 0.731
Validation loss decreased (-0.671858 --> -0.731235).  Saving model ...
Epoch: 6 cost time: 0.7459945678710938
Epoch: 6, Steps: 8 | Train Loss: 1.336 Vali Loss: 1.314 Vali Acc: 0.775 Test Loss: 1.314 Test Acc: 0.775
Validation loss decreased (-0.731235 --> -0.774987).  Saving model ...
Epoch: 7 cost time: 0.6611533164978027
Epoch: 7, Steps: 8 | Train Loss: 1.123 Vali Loss: 1.121 Vali Acc: 0.806 Test Loss: 1.121 Test Acc: 0.806
Validation loss decreased (-0.774987 --> -0.806239).  Saving model ...
Epoch: 8 cost time: 0.664980411529541
Epoch: 8, Steps: 8 | Train Loss: 0.911 Vali Loss: 0.940 Vali Acc: 0.816 Test Loss: 0.940 Test Acc: 0.816
Validation loss decreased (-0.806239 --> -0.815616).  Saving model ...
Epoch: 9 cost time: 0.6728956699371338
Epoch: 9, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.815616 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.5777683258056641
Epoch: 10, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.686 Vali Acc: 0.828 Test Loss: 0.686 Test Acc: 0.828
Validation loss decreased (-0.824992 --> -0.828118).  Saving model ...
Epoch: 11 cost time: 0.6611757278442383
Epoch: 11, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 0.6088554859161377
Epoch: 12, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.834369 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.5636553764343262
Epoch: 13, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 0.5811464786529541
Epoch: 14, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.5558276176452637
Epoch: 15, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.657705545425415
Epoch: 16, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6179707050323486
Epoch: 17, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.425 Vali Acc: 0.859 Test Loss: 0.425 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 18 cost time: 0.7395243644714355
Epoch: 18, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.424 Vali Acc: 0.859 Test Loss: 0.424 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 19 cost time: 0.6464262008666992
Epoch: 19, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.426 Vali Acc: 0.847 Test Loss: 0.426 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7884283065795898
Epoch: 20, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.417 Vali Acc: 0.866 Test Loss: 0.417 Test Acc: 0.866
Validation loss decreased (-0.859371 --> -0.865621).  Saving model ...
Epoch: 21 cost time: 0.6246235370635986
Epoch: 21, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.423 Vali Acc: 0.872 Test Loss: 0.423 Test Acc: 0.872
Validation loss decreased (-0.865621 --> -0.871871).  Saving model ...
Epoch: 22 cost time: 0.66263747215271
Epoch: 22, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.419 Vali Acc: 0.872 Test Loss: 0.419 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 23 cost time: 0.685969352722168
Epoch: 23, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.425 Vali Acc: 0.866 Test Loss: 0.425 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5473649501800537
Epoch: 24, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.429 Vali Acc: 0.859 Test Loss: 0.429 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6392431259155273
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.430 Vali Acc: 0.856 Test Loss: 0.430 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6316039562225342
Epoch: 26, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.439 Vali Acc: 0.863 Test Loss: 0.439 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6898205280303955
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.445 Vali Acc: 0.866 Test Loss: 0.445 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.694133996963501
Epoch: 28, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.442 Vali Acc: 0.866 Test Loss: 0.442 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6487996578216553
Epoch: 29, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.446 Vali Acc: 0.863 Test Loss: 0.446 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5125360488891602
Epoch: 30, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6623532772064209
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.450 Vali Acc: 0.869 Test Loss: 0.450 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6319875717163086
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 558344
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9269559383392334
Epoch: 1, Steps: 8 | Train Loss: 2.063 Vali Loss: 2.003 Vali Acc: 0.269 Test Loss: 2.003 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 0.7058656215667725
Epoch: 2, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.803 Vali Acc: 0.584 Test Loss: 1.803 Test Acc: 0.584
Validation loss decreased (-0.268730 --> -0.584357).  Saving model ...
Epoch: 3 cost time: 0.5480434894561768
Epoch: 3, Steps: 8 | Train Loss: 1.523 Vali Loss: 1.500 Vali Acc: 0.728 Test Loss: 1.500 Test Acc: 0.728
Validation loss decreased (-0.584357 --> -0.728110).  Saving model ...
Epoch: 4 cost time: 0.6672298908233643
Epoch: 4, Steps: 8 | Train Loss: 1.129 Vali Loss: 1.144 Vali Acc: 0.781 Test Loss: 1.144 Test Acc: 0.781
Validation loss decreased (-0.728110 --> -0.781239).  Saving model ...
Epoch: 5 cost time: 0.7133400440216064
Epoch: 5, Steps: 8 | Train Loss: 0.809 Vali Loss: 0.825 Vali Acc: 0.812 Test Loss: 0.825 Test Acc: 0.812
Validation loss decreased (-0.781239 --> -0.812492).  Saving model ...
Epoch: 6 cost time: 0.6923675537109375
Epoch: 6, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
Validation loss decreased (-0.812492 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.615386962890625
Epoch: 7, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
Validation loss decreased (-0.818744 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.6423583030700684
Epoch: 8, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
Validation loss decreased (-0.834370 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 0.6916871070861816
Epoch: 9, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6066784858703613
Epoch: 10, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6946015357971191
Epoch: 11, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.644134521484375
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7564373016357422
Epoch: 13, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6878376007080078
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6059226989746094
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7078707218170166
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7105302810668945
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6046450138092041
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 203688
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8318555355072021
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 2.075 Vali Acc: 0.122 Test Loss: 2.075 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.5483748912811279
Epoch: 2, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.969 Vali Acc: 0.322 Test Loss: 1.969 Test Acc: 0.322
Validation loss decreased (-0.121854 --> -0.321855).  Saving model ...
Epoch: 3 cost time: 0.6165249347686768
Epoch: 3, Steps: 8 | Train Loss: 1.804 Vali Loss: 1.791 Vali Acc: 0.537 Test Loss: 1.791 Test Acc: 0.537
Validation loss decreased (-0.321855 --> -0.537482).  Saving model ...
Epoch: 4 cost time: 0.6082630157470703
Epoch: 4, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.553 Vali Acc: 0.725 Test Loss: 1.553 Test Acc: 0.725
Validation loss decreased (-0.537482 --> -0.724984).  Saving model ...
Epoch: 5 cost time: 0.6798238754272461
Epoch: 5, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.275 Vali Acc: 0.775 Test Loss: 1.275 Test Acc: 0.775
Validation loss decreased (-0.724984 --> -0.774987).  Saving model ...
Epoch: 6 cost time: 0.6648683547973633
Epoch: 6, Steps: 8 | Train Loss: 1.062 Vali Loss: 1.000 Vali Acc: 0.797 Test Loss: 1.000 Test Acc: 0.797
Validation loss decreased (-0.774987 --> -0.796865).  Saving model ...
Epoch: 7 cost time: 0.5452241897583008
Epoch: 7, Steps: 8 | Train Loss: 0.783 Vali Loss: 0.785 Vali Acc: 0.812 Test Loss: 0.785 Test Acc: 0.812
Validation loss decreased (-0.796865 --> -0.812492).  Saving model ...
Epoch: 8 cost time: 0.6488072872161865
Epoch: 8, Steps: 8 | Train Loss: 0.599 Vali Loss: 0.630 Vali Acc: 0.828 Test Loss: 0.630 Test Acc: 0.828
Validation loss decreased (-0.812492 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.6567866802215576
Epoch: 9, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.580411434173584
Epoch: 10, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.49406981468200684
Epoch: 11, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.5920398235321045
Epoch: 12, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.6018044948577881
Epoch: 13, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5506014823913574
Epoch: 14, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.6877212524414062
Epoch: 15, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6127512454986572
Epoch: 16, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6887781620025635
Epoch: 17, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6674354076385498
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7182507514953613
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5658297538757324
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6438896656036377
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6794497966766357
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6413147449493408
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6095261573791504
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 174760
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0481836795806885
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.084 Vali Acc: 0.184 Test Loss: 2.084 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 0.6021099090576172
Epoch: 2, Steps: 8 | Train Loss: 2.016 Vali Loss: 2.013 Vali Acc: 0.409 Test Loss: 2.013 Test Acc: 0.409
Validation loss decreased (-0.184354 --> -0.409355).  Saving model ...
Epoch: 3 cost time: 0.47722458839416504
Epoch: 3, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.886 Vali Acc: 0.569 Test Loss: 1.886 Test Acc: 0.569
Validation loss decreased (-0.409355 --> -0.568731).  Saving model ...
Epoch: 4 cost time: 0.6361901760101318
Epoch: 4, Steps: 8 | Train Loss: 1.725 Vali Loss: 1.715 Vali Acc: 0.666 Test Loss: 1.715 Test Acc: 0.666
Validation loss decreased (-0.568731 --> -0.665608).  Saving model ...
Epoch: 5 cost time: 0.6152493953704834
Epoch: 5, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.509 Vali Acc: 0.741 Test Loss: 1.509 Test Acc: 0.741
Validation loss decreased (-0.665608 --> -0.740610).  Saving model ...
Epoch: 6 cost time: 0.6518228054046631
Epoch: 6, Steps: 8 | Train Loss: 1.318 Vali Loss: 1.281 Vali Acc: 0.791 Test Loss: 1.281 Test Acc: 0.791
Validation loss decreased (-0.740610 --> -0.790612).  Saving model ...
Epoch: 7 cost time: 0.611541748046875
Epoch: 7, Steps: 8 | Train Loss: 1.096 Vali Loss: 1.056 Vali Acc: 0.797 Test Loss: 1.056 Test Acc: 0.797
Validation loss decreased (-0.790612 --> -0.796864).  Saving model ...
Epoch: 8 cost time: 0.7272288799285889
Epoch: 8, Steps: 8 | Train Loss: 0.855 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.796864 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.5178160667419434
Epoch: 9, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.709 Vali Acc: 0.816 Test Loss: 0.709 Test Acc: 0.816
Validation loss decreased (-0.799991 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 0.7171270847320557
Epoch: 10, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
Validation loss decreased (-0.815618 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 0.6290395259857178
Epoch: 11, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 12 cost time: 0.6727395057678223
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.6132795810699463
Epoch: 13, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.6918296813964844
Epoch: 14, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.5563099384307861
Epoch: 15, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.55509352684021
Epoch: 16, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5959923267364502
Epoch: 17, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6443498134613037
Epoch: 18, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5831449031829834
Epoch: 19, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853121).  Saving model ...
Epoch: 20 cost time: 0.6398184299468994
Epoch: 20, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7634148597717285
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5576708316802979
Epoch: 22, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7231299877166748
Epoch: 23, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6205348968505859
Epoch: 24, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7682361602783203
Epoch: 25, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6421418190002441
Epoch: 26, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6645333766937256
Epoch: 27, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6679270267486572
Epoch: 28, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.762122392654419
Epoch: 29, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 164264
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8434908390045166
Epoch: 1, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.062 Vali Acc: 0.122 Test Loss: 2.062 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.7099828720092773
Epoch: 2, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.999 Vali Acc: 0.225 Test Loss: 1.999 Test Acc: 0.225
Validation loss decreased (-0.121854 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 0.6704766750335693
Epoch: 3, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.897 Vali Acc: 0.434 Test Loss: 1.897 Test Acc: 0.434
Validation loss decreased (-0.224980 --> -0.434356).  Saving model ...
Epoch: 4 cost time: 0.6165871620178223
Epoch: 4, Steps: 8 | Train Loss: 1.784 Vali Loss: 1.756 Vali Acc: 0.616 Test Loss: 1.756 Test Acc: 0.616
Validation loss decreased (-0.434356 --> -0.615607).  Saving model ...
Epoch: 5 cost time: 0.6093282699584961
Epoch: 5, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.591 Vali Acc: 0.709 Test Loss: 1.591 Test Acc: 0.709
Validation loss decreased (-0.615607 --> -0.709359).  Saving model ...
Epoch: 6 cost time: 0.5292129516601562
Epoch: 6, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.403 Vali Acc: 0.750 Test Loss: 1.403 Test Acc: 0.750
Validation loss decreased (-0.709359 --> -0.749986).  Saving model ...
Epoch: 7 cost time: 0.5666296482086182
Epoch: 7, Steps: 8 | Train Loss: 1.256 Vali Loss: 1.204 Vali Acc: 0.778 Test Loss: 1.204 Test Acc: 0.778
Validation loss decreased (-0.749986 --> -0.778113).  Saving model ...
Epoch: 8 cost time: 0.5586729049682617
Epoch: 8, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.009 Vali Acc: 0.784 Test Loss: 1.009 Test Acc: 0.784
Validation loss decreased (-0.778113 --> -0.784365).  Saving model ...
Epoch: 9 cost time: 0.5720658302307129
Epoch: 9, Steps: 8 | Train Loss: 0.836 Vali Loss: 0.843 Vali Acc: 0.806 Test Loss: 0.843 Test Acc: 0.806
Validation loss decreased (-0.784365 --> -0.806242).  Saving model ...
Epoch: 10 cost time: 0.5516114234924316
Epoch: 10, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.707 Vali Acc: 0.822 Test Loss: 0.707 Test Acc: 0.822
Validation loss decreased (-0.806242 --> -0.821868).  Saving model ...
Epoch: 11 cost time: 0.6090700626373291
Epoch: 11, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 0.6573185920715332
Epoch: 12, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840619).  Saving model ...
Epoch: 13 cost time: 0.536675214767456
Epoch: 13, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6756329536437988
Epoch: 14, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.7133526802062988
Epoch: 15, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.627070426940918
Epoch: 16, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6177041530609131
Epoch: 17, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6500906944274902
Epoch: 18, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6389095783233643
Epoch: 19, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.454 Vali Acc: 0.847 Test Loss: 0.454 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6154859066009521
Epoch: 20, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6001622676849365
Epoch: 21, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6300115585327148
Epoch: 22, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5355682373046875
Epoch: 23, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.609764575958252
Epoch: 24, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6043088436126709
Epoch: 25, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 159912
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0150341987609863
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.054 Vali Acc: 0.237 Test Loss: 2.054 Test Acc: 0.237
Validation loss decreased (inf --> -0.237479).  Saving model ...
Epoch: 2 cost time: 0.5859436988830566
Epoch: 2, Steps: 8 | Train Loss: 2.025 Vali Loss: 2.006 Vali Acc: 0.297 Test Loss: 2.006 Test Acc: 0.297
Validation loss decreased (-0.237479 --> -0.296855).  Saving model ...
Epoch: 3 cost time: 0.4995861053466797
Epoch: 3, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.923 Vali Acc: 0.353 Test Loss: 1.923 Test Acc: 0.353
Validation loss decreased (-0.296855 --> -0.353106).  Saving model ...
Epoch: 4 cost time: 0.6392884254455566
Epoch: 4, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.812 Vali Acc: 0.481 Test Loss: 1.812 Test Acc: 0.481
Validation loss decreased (-0.353106 --> -0.481232).  Saving model ...
Epoch: 5 cost time: 0.5885739326477051
Epoch: 5, Steps: 8 | Train Loss: 1.692 Vali Loss: 1.670 Vali Acc: 0.600 Test Loss: 1.670 Test Acc: 0.600
Validation loss decreased (-0.481232 --> -0.599983).  Saving model ...
Epoch: 6 cost time: 0.5543403625488281
Epoch: 6, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.507 Vali Acc: 0.688 Test Loss: 1.507 Test Acc: 0.688
Validation loss decreased (-0.599983 --> -0.687485).  Saving model ...
Epoch: 7 cost time: 0.5389235019683838
Epoch: 7, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.342 Vali Acc: 0.725 Test Loss: 1.342 Test Acc: 0.725
Validation loss decreased (-0.687485 --> -0.724987).  Saving model ...
Epoch: 8 cost time: 0.5033791065216064
Epoch: 8, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.170 Vali Acc: 0.775 Test Loss: 1.170 Test Acc: 0.775
Validation loss decreased (-0.724987 --> -0.774988).  Saving model ...
Epoch: 9 cost time: 0.5325870513916016
Epoch: 9, Steps: 8 | Train Loss: 1.072 Vali Loss: 1.002 Vali Acc: 0.784 Test Loss: 1.002 Test Acc: 0.784
Validation loss decreased (-0.774988 --> -0.784365).  Saving model ...
Epoch: 10 cost time: 0.5131745338439941
Epoch: 10, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.869 Vali Acc: 0.809 Test Loss: 0.869 Test Acc: 0.809
Validation loss decreased (-0.784365 --> -0.809366).  Saving model ...
Epoch: 11 cost time: 0.5909526348114014
Epoch: 11, Steps: 8 | Train Loss: 0.737 Vali Loss: 0.758 Vali Acc: 0.822 Test Loss: 0.758 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821867).  Saving model ...
Epoch: 12 cost time: 0.5238523483276367
Epoch: 12, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.671 Vali Acc: 0.831 Test Loss: 0.671 Test Acc: 0.831
Validation loss decreased (-0.821867 --> -0.831243).  Saving model ...
Epoch: 13 cost time: 0.5616915225982666
Epoch: 13, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.601 Vali Acc: 0.841 Test Loss: 0.601 Test Acc: 0.841
Validation loss decreased (-0.831243 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 0.4935765266418457
Epoch: 14, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856244).  Saving model ...
Epoch: 15 cost time: 0.5490157604217529
Epoch: 15, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4759068489074707
Epoch: 16, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6097159385681152
Epoch: 17, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856245).  Saving model ...
Epoch: 18 cost time: 0.5869088172912598
Epoch: 18, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6088695526123047
Epoch: 19, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.503669261932373
Epoch: 20, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6169083118438721
Epoch: 21, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5125672817230225
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5960865020751953
Epoch: 23, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5837066173553467
Epoch: 24, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4937868118286133
Epoch: 25, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5443947315216064
Epoch: 26, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6201615333557129
Epoch: 27, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 155816
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9168963432312012
Epoch: 1, Steps: 8 | Train Loss: 2.051 Vali Loss: 2.051 Vali Acc: 0.194 Test Loss: 2.051 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.6218795776367188
Epoch: 2, Steps: 8 | Train Loss: 1.992 Vali Loss: 2.014 Vali Acc: 0.322 Test Loss: 2.014 Test Acc: 0.322
Validation loss decreased (-0.193729 --> -0.321855).  Saving model ...
Epoch: 3 cost time: 0.6550502777099609
Epoch: 3, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.948 Vali Acc: 0.444 Test Loss: 1.948 Test Acc: 0.444
Validation loss decreased (-0.321855 --> -0.443731).  Saving model ...
Epoch: 4 cost time: 0.572380781173706
Epoch: 4, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.859 Vali Acc: 0.516 Test Loss: 1.859 Test Acc: 0.516
Validation loss decreased (-0.443731 --> -0.515606).  Saving model ...
Epoch: 5 cost time: 0.5855526924133301
Epoch: 5, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.752 Vali Acc: 0.575 Test Loss: 1.752 Test Acc: 0.575
Validation loss decreased (-0.515606 --> -0.574982).  Saving model ...
Epoch: 6 cost time: 0.6177005767822266
Epoch: 6, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.626 Vali Acc: 0.647 Test Loss: 1.626 Test Acc: 0.647
Validation loss decreased (-0.574982 --> -0.646859).  Saving model ...
Epoch: 7 cost time: 0.6303648948669434
Epoch: 7, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.493 Vali Acc: 0.694 Test Loss: 1.493 Test Acc: 0.694
Validation loss decreased (-0.646859 --> -0.693735).  Saving model ...
Epoch: 8 cost time: 0.5137572288513184
Epoch: 8, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.349 Vali Acc: 0.741 Test Loss: 1.349 Test Acc: 0.741
Validation loss decreased (-0.693735 --> -0.740612).  Saving model ...
Epoch: 9 cost time: 0.622387170791626
Epoch: 9, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.203 Vali Acc: 0.772 Test Loss: 1.203 Test Acc: 0.772
Validation loss decreased (-0.740612 --> -0.771863).  Saving model ...
Epoch: 10 cost time: 0.6496119499206543
Epoch: 10, Steps: 8 | Train Loss: 1.054 Vali Loss: 1.062 Vali Acc: 0.781 Test Loss: 1.062 Test Acc: 0.781
Validation loss decreased (-0.771863 --> -0.781239).  Saving model ...
Epoch: 11 cost time: 0.6006574630737305
Epoch: 11, Steps: 8 | Train Loss: 0.899 Vali Loss: 0.933 Vali Acc: 0.803 Test Loss: 0.933 Test Acc: 0.803
Validation loss decreased (-0.781239 --> -0.803116).  Saving model ...
Epoch: 12 cost time: 0.5596632957458496
Epoch: 12, Steps: 8 | Train Loss: 0.776 Vali Loss: 0.822 Vali Acc: 0.816 Test Loss: 0.822 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815617).  Saving model ...
Epoch: 13 cost time: 0.6114547252655029
Epoch: 13, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.731 Vali Acc: 0.819 Test Loss: 0.731 Test Acc: 0.819
Validation loss decreased (-0.815617 --> -0.818743).  Saving model ...
Epoch: 14 cost time: 0.629737377166748
Epoch: 14, Steps: 8 | Train Loss: 0.571 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828118).  Saving model ...
Epoch: 15 cost time: 0.5348732471466064
Epoch: 15, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.609 Vali Acc: 0.831 Test Loss: 0.609 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 0.6038615703582764
Epoch: 16, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 0.5748929977416992
Epoch: 17, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 18 cost time: 0.5054178237915039
Epoch: 18, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 0.5511002540588379
Epoch: 19, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5655648708343506
Epoch: 20, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 0.5887267589569092
Epoch: 21, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 0.6172347068786621
Epoch: 22, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 23 cost time: 0.7518713474273682
Epoch: 23, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 24 cost time: 0.6392464637756348
Epoch: 24, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5964345932006836
Epoch: 25, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.686589241027832
Epoch: 26, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.439 Vali Acc: 0.859 Test Loss: 0.439 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 27 cost time: 0.6038401126861572
Epoch: 27, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
Validation loss decreased (-0.859371 --> -0.862496).  Saving model ...
Epoch: 28 cost time: 0.6235742568969727
Epoch: 28, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.441 Vali Acc: 0.863 Test Loss: 0.441 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6083784103393555
Epoch: 29, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.440 Vali Acc: 0.866 Test Loss: 0.440 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865621).  Saving model ...
Epoch: 30 cost time: 0.5915653705596924
Epoch: 30, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5096297264099121
Epoch: 31, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5984580516815186
Epoch: 32, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.446 Vali Acc: 0.866 Test Loss: 0.446 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5678296089172363
Epoch: 33, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.865621 --> -0.868745).  Saving model ...
Epoch: 34 cost time: 0.6762430667877197
Epoch: 34, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6643929481506348
Epoch: 35, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7161791324615479
Epoch: 36, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6585414409637451
Epoch: 37, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6114261150360107
Epoch: 38, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6235544681549072
Epoch: 39, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5886991024017334
Epoch: 40, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5582482814788818
Epoch: 41, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5499007701873779
Epoch: 42, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5402779579162598
Epoch: 43, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.488 Vali Acc: 0.863 Test Loss: 0.488 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 153224
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.932873010635376
Epoch: 1, Steps: 8 | Train Loss: 2.125 Vali Loss: 2.109 Vali Acc: 0.128 Test Loss: 2.109 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 0.6992924213409424
Epoch: 2, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.078 Vali Acc: 0.163 Test Loss: 2.078 Test Acc: 0.163
Validation loss decreased (-0.128104 --> -0.162479).  Saving model ...
Epoch: 3 cost time: 0.6294870376586914
Epoch: 3, Steps: 8 | Train Loss: 2.040 Vali Loss: 2.023 Vali Acc: 0.253 Test Loss: 2.023 Test Acc: 0.253
Validation loss decreased (-0.162479 --> -0.253105).  Saving model ...
Epoch: 4 cost time: 0.5845761299133301
Epoch: 4, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.946 Vali Acc: 0.412 Test Loss: 1.946 Test Acc: 0.412
Validation loss decreased (-0.253105 --> -0.412481).  Saving model ...
Epoch: 5 cost time: 0.6037952899932861
Epoch: 5, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.853 Vali Acc: 0.506 Test Loss: 1.853 Test Acc: 0.506
Validation loss decreased (-0.412481 --> -0.506231).  Saving model ...
Epoch: 6 cost time: 0.5577793121337891
Epoch: 6, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.748 Vali Acc: 0.622 Test Loss: 1.748 Test Acc: 0.622
Validation loss decreased (-0.506231 --> -0.621858).  Saving model ...
Epoch: 7 cost time: 0.6313509941101074
Epoch: 7, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.635 Vali Acc: 0.700 Test Loss: 1.635 Test Acc: 0.700
Validation loss decreased (-0.621858 --> -0.699984).  Saving model ...
Epoch: 8 cost time: 0.6552021503448486
Epoch: 8, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.518 Vali Acc: 0.731 Test Loss: 1.518 Test Acc: 0.731
Validation loss decreased (-0.699984 --> -0.731235).  Saving model ...
Epoch: 9 cost time: 0.6772000789642334
Epoch: 9, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.394 Vali Acc: 0.759 Test Loss: 1.394 Test Acc: 0.759
Validation loss decreased (-0.731235 --> -0.759361).  Saving model ...
Epoch: 10 cost time: 0.5897846221923828
Epoch: 10, Steps: 8 | Train Loss: 1.265 Vali Loss: 1.265 Vali Acc: 0.772 Test Loss: 1.265 Test Acc: 0.772
Validation loss decreased (-0.759361 --> -0.771862).  Saving model ...
Epoch: 11 cost time: 0.5876748561859131
Epoch: 11, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.137 Vali Acc: 0.784 Test Loss: 1.137 Test Acc: 0.784
Validation loss decreased (-0.771862 --> -0.784364).  Saving model ...
Epoch: 12 cost time: 0.5135705471038818
Epoch: 12, Steps: 8 | Train Loss: 1.006 Vali Loss: 1.016 Vali Acc: 0.794 Test Loss: 1.016 Test Acc: 0.794
Validation loss decreased (-0.784364 --> -0.793740).  Saving model ...
Epoch: 13 cost time: 0.5943787097930908
Epoch: 13, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.909 Vali Acc: 0.803 Test Loss: 0.909 Test Acc: 0.803
Validation loss decreased (-0.793740 --> -0.803116).  Saving model ...
Epoch: 14 cost time: 0.6034822463989258
Epoch: 14, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.817 Vali Acc: 0.809 Test Loss: 0.817 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809367).  Saving model ...
Epoch: 15 cost time: 0.6046102046966553
Epoch: 15, Steps: 8 | Train Loss: 0.646 Vali Loss: 0.740 Vali Acc: 0.822 Test Loss: 0.740 Test Acc: 0.822
Validation loss decreased (-0.809367 --> -0.821868).  Saving model ...
Epoch: 16 cost time: 0.5908949375152588
Epoch: 16, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821868).  Saving model ...
Epoch: 17 cost time: 0.6481497287750244
Epoch: 17, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.634 Vali Acc: 0.825 Test Loss: 0.634 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 0.6239805221557617
Epoch: 18, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 19 cost time: 0.5440268516540527
Epoch: 19, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.5411117076873779
Epoch: 20, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.856245).  Saving model ...
Epoch: 21 cost time: 0.6385083198547363
Epoch: 21, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5996417999267578
Epoch: 22, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7202770709991455
Epoch: 23, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6550486087799072
Epoch: 24, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6754097938537598
Epoch: 25, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 26 cost time: 0.6267085075378418
Epoch: 26, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 27 cost time: 0.6439187526702881
Epoch: 27, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 28 cost time: 0.6601567268371582
Epoch: 28, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 29 cost time: 0.6163606643676758
Epoch: 29, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.441 Vali Acc: 0.859 Test Loss: 0.441 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 30 cost time: 0.5242829322814941
Epoch: 30, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6811511516571045
Epoch: 31, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.444 Vali Acc: 0.856 Test Loss: 0.444 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.62811279296875
Epoch: 32, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.441 Vali Acc: 0.863 Test Loss: 0.441 Test Acc: 0.863
Validation loss decreased (-0.859371 --> -0.862496).  Saving model ...
Epoch: 33 cost time: 0.6085672378540039
Epoch: 33, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.439 Vali Acc: 0.859 Test Loss: 0.439 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6361782550811768
Epoch: 34, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5244855880737305
Epoch: 35, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.440 Vali Acc: 0.863 Test Loss: 0.440 Test Acc: 0.863
Validation loss decreased (-0.862496 --> -0.862496).  Saving model ...
Epoch: 36 cost time: 0.5645034313201904
Epoch: 36, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.633613109588623
Epoch: 37, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5256035327911377
Epoch: 38, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5233461856842041
Epoch: 39, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5588841438293457
Epoch: 40, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.457 Vali Acc: 0.863 Test Loss: 0.457 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5368950366973877
Epoch: 41, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5247433185577393
Epoch: 42, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6065585613250732
Epoch: 43, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.460 Vali Acc: 0.863 Test Loss: 0.460 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6441347599029541
Epoch: 44, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6378979682922363
Epoch: 45, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 152200
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.272214651107788
Epoch: 1, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.857 Vali Acc: 0.550 Test Loss: 1.857 Test Acc: 0.550
Validation loss decreased (inf --> -0.549981).  Saving model ...
Epoch: 2 cost time: 0.9443392753601074
Epoch: 2, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.236 Vali Acc: 0.791 Test Loss: 1.236 Test Acc: 0.791
Validation loss decreased (-0.549981 --> -0.790613).  Saving model ...
Epoch: 3 cost time: 0.8932962417602539
Epoch: 3, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
Validation loss decreased (-0.790613 --> -0.818743).  Saving model ...
Epoch: 4 cost time: 0.7343676090240479
Epoch: 4, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.481 Vali Acc: 0.866 Test Loss: 0.481 Test Acc: 0.866
Validation loss decreased (-0.818743 --> -0.865620).  Saving model ...
Epoch: 5 cost time: 1.095557451248169
Epoch: 5, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9722487926483154
Epoch: 6, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0962417125701904
Epoch: 7, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.604 Vali Acc: 0.831 Test Loss: 0.604 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9745693206787109
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.718 Vali Acc: 0.819 Test Loss: 0.718 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9081523418426514
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.751 Vali Acc: 0.822 Test Loss: 0.751 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0735156536102295
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.831 Test Loss: 0.749 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9638674259185791
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.831 Test Loss: 0.739 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9912664890289307
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.831 Test Loss: 0.748 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0350024700164795
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.831 Test Loss: 0.771 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9180600643157959
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.831 Test Loss: 0.796 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 2333832
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3035166263580322
Epoch: 1, Steps: 8 | Train Loss: 2.025 Vali Loss: 1.962 Vali Acc: 0.331 Test Loss: 1.962 Test Acc: 0.331
Validation loss decreased (inf --> -0.331230).  Saving model ...
Epoch: 2 cost time: 0.6731963157653809
Epoch: 2, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.577 Vali Acc: 0.762 Test Loss: 1.577 Test Acc: 0.762
Validation loss decreased (-0.331230 --> -0.762484).  Saving model ...
Epoch: 3 cost time: 0.9279239177703857
Epoch: 3, Steps: 8 | Train Loss: 1.024 Vali Loss: 1.035 Vali Acc: 0.816 Test Loss: 1.035 Test Acc: 0.816
Validation loss decreased (-0.762484 --> -0.815615).  Saving model ...
Epoch: 4 cost time: 1.1258528232574463
Epoch: 4, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.619 Vali Acc: 0.831 Test Loss: 0.619 Test Acc: 0.831
Validation loss decreased (-0.815615 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 0.7249758243560791
Epoch: 5, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.8187153339385986
Epoch: 6, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.7262229919433594
Epoch: 7, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8959009647369385
Epoch: 8, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9770493507385254
Epoch: 9, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6880018711090088
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.590 Vali Acc: 0.834 Test Loss: 0.590 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9114549160003662
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9061365127563477
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8721389770507812
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.831 Test Loss: 0.654 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7654373645782471
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.831 Test Loss: 0.668 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1603631973266602
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.674 Vali Acc: 0.831 Test Loss: 0.674 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0840296745300293
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.831 Test Loss: 0.682 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 2218120
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.337379217147827
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.039 Vali Acc: 0.166 Test Loss: 2.039 Test Acc: 0.166
Validation loss decreased (inf --> -0.165605).  Saving model ...
Epoch: 2 cost time: 0.7122399806976318
Epoch: 2, Steps: 8 | Train Loss: 1.823 Vali Loss: 1.747 Vali Acc: 0.684 Test Loss: 1.747 Test Acc: 0.684
Validation loss decreased (-0.165605 --> -0.684358).  Saving model ...
Epoch: 3 cost time: 0.7841424942016602
Epoch: 3, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.306 Vali Acc: 0.797 Test Loss: 1.306 Test Acc: 0.797
Validation loss decreased (-0.684358 --> -0.796862).  Saving model ...
Epoch: 4 cost time: 0.6631119251251221
Epoch: 4, Steps: 8 | Train Loss: 0.866 Vali Loss: 0.848 Vali Acc: 0.819 Test Loss: 0.848 Test Acc: 0.819
Validation loss decreased (-0.796862 --> -0.818742).  Saving model ...
Epoch: 5 cost time: 0.6250793933868408
Epoch: 5, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.818742 --> -0.840619).  Saving model ...
Epoch: 6 cost time: 0.6250104904174805
Epoch: 6, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 0.7351663112640381
Epoch: 7, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862496).  Saving model ...
Epoch: 8 cost time: 0.7580850124359131
Epoch: 8, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9196035861968994
Epoch: 9, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8664910793304443
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8653519153594971
Epoch: 11, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8783130645751953
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.561 Vali Acc: 0.838 Test Loss: 0.561 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8253374099731445
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.570 Vali Acc: 0.838 Test Loss: 0.570 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9337887763977051
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0373237133026123
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1297285556793213
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6724543571472168
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.834 Test Loss: 0.611 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 2176136
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.270028829574585
Epoch: 1, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.989 Vali Acc: 0.334 Test Loss: 1.989 Test Acc: 0.334
Validation loss decreased (inf --> -0.334355).  Saving model ...
Epoch: 2 cost time: 0.7485978603363037
Epoch: 2, Steps: 8 | Train Loss: 1.804 Vali Loss: 1.740 Vali Acc: 0.700 Test Loss: 1.740 Test Acc: 0.700
Validation loss decreased (-0.334355 --> -0.699983).  Saving model ...
Epoch: 3 cost time: 0.9096260070800781
Epoch: 3, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.350 Vali Acc: 0.794 Test Loss: 1.350 Test Acc: 0.794
Validation loss decreased (-0.699983 --> -0.793736).  Saving model ...
Epoch: 4 cost time: 0.934880256652832
Epoch: 4, Steps: 8 | Train Loss: 0.940 Vali Loss: 0.908 Vali Acc: 0.809 Test Loss: 0.908 Test Acc: 0.809
Validation loss decreased (-0.793736 --> -0.809366).  Saving model ...
Epoch: 5 cost time: 0.7612369060516357
Epoch: 5, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
Validation loss decreased (-0.809366 --> -0.828119).  Saving model ...
Epoch: 6 cost time: 0.9281342029571533
Epoch: 6, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.470 Vali Acc: 0.872 Test Loss: 0.470 Test Acc: 0.872
Validation loss decreased (-0.828119 --> -0.871870).  Saving model ...
Epoch: 7 cost time: 0.81392502784729
Epoch: 7, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7916178703308105
Epoch: 8, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.428 Vali Acc: 0.866 Test Loss: 0.428 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8147995471954346
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8099241256713867
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6961121559143066
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6888761520385742
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9768402576446533
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.866816520690918
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.908130407333374
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9057216644287109
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 2158728
model size : 8.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0347163677215576
Epoch: 1, Steps: 8 | Train Loss: 2.043 Vali Loss: 1.991 Vali Acc: 0.375 Test Loss: 1.991 Test Acc: 0.375
Validation loss decreased (inf --> -0.374980).  Saving model ...
Epoch: 2 cost time: 0.7372162342071533
Epoch: 2, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.791 Vali Acc: 0.653 Test Loss: 1.791 Test Acc: 0.653
Validation loss decreased (-0.374980 --> -0.653107).  Saving model ...
Epoch: 3 cost time: 0.5750453472137451
Epoch: 3, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.478 Vali Acc: 0.778 Test Loss: 1.478 Test Acc: 0.778
Validation loss decreased (-0.653107 --> -0.778110).  Saving model ...
Epoch: 4 cost time: 0.737851619720459
Epoch: 4, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.104 Vali Acc: 0.803 Test Loss: 1.104 Test Acc: 0.803
Validation loss decreased (-0.778110 --> -0.803114).  Saving model ...
Epoch: 5 cost time: 0.7538084983825684
Epoch: 5, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
Validation loss decreased (-0.803114 --> -0.821867).  Saving model ...
Epoch: 6 cost time: 0.7288541793823242
Epoch: 6, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
Validation loss decreased (-0.821867 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.6315889358520508
Epoch: 7, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
Validation loss decreased (-0.824994 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.8915910720825195
Epoch: 8, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.426 Vali Acc: 0.884 Test Loss: 0.426 Test Acc: 0.884
Validation loss decreased (-0.859370 --> -0.884371).  Saving model ...
Epoch: 9 cost time: 0.8420777320861816
Epoch: 9, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.433 Vali Acc: 0.869 Test Loss: 0.433 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8766541481018066
Epoch: 10, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6529176235198975
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.435 Vali Acc: 0.853 Test Loss: 0.435 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6785879135131836
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6605226993560791
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.913928747177124
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7538509368896484
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8019628524780273
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9359574317932129
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7009055614471436
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 2142344
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.153947591781616
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.032 Vali Acc: 0.222 Test Loss: 2.032 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 0.7929646968841553
Epoch: 2, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.862 Vali Acc: 0.491 Test Loss: 1.862 Test Acc: 0.491
Validation loss decreased (-0.221855 --> -0.490606).  Saving model ...
Epoch: 3 cost time: 0.7359271049499512
Epoch: 3, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.586 Vali Acc: 0.731 Test Loss: 1.586 Test Acc: 0.731
Validation loss decreased (-0.490606 --> -0.731234).  Saving model ...
Epoch: 4 cost time: 0.9738421440124512
Epoch: 4, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.246 Vali Acc: 0.803 Test Loss: 1.246 Test Acc: 0.803
Validation loss decreased (-0.731234 --> -0.803113).  Saving model ...
Epoch: 5 cost time: 0.9728922843933105
Epoch: 5, Steps: 8 | Train Loss: 0.953 Vali Loss: 0.915 Vali Acc: 0.806 Test Loss: 0.915 Test Acc: 0.806
Validation loss decreased (-0.803113 --> -0.806241).  Saving model ...
Epoch: 6 cost time: 0.701434850692749
Epoch: 6, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
Validation loss decreased (-0.806241 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.8582310676574707
Epoch: 7, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
Validation loss decreased (-0.824993 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.8762812614440918
Epoch: 8, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.7783126831054688
Epoch: 9, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.444 Vali Acc: 0.853 Test Loss: 0.444 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853121).  Saving model ...
Epoch: 10 cost time: 0.8154296875
Epoch: 10, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
Validation loss decreased (-0.853121 --> -0.859371).  Saving model ...
Epoch: 11 cost time: 0.7283756732940674
Epoch: 11, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7235288619995117
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7435014247894287
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7924449443817139
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8381011486053467
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9311914443969727
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7665424346923828
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8665628433227539
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8464720249176025
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.655742883682251
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2131976
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0877857208251953
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 2.041 Vali Acc: 0.150 Test Loss: 2.041 Test Acc: 0.150
Validation loss decreased (inf --> -0.149980).  Saving model ...
Epoch: 2 cost time: 0.8055310249328613
Epoch: 2, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.880 Vali Acc: 0.444 Test Loss: 1.880 Test Acc: 0.444
Validation loss decreased (-0.149980 --> -0.443731).  Saving model ...
Epoch: 3 cost time: 0.7973792552947998
Epoch: 3, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.620 Vali Acc: 0.731 Test Loss: 1.620 Test Acc: 0.731
Validation loss decreased (-0.443731 --> -0.731234).  Saving model ...
Epoch: 4 cost time: 0.7453274726867676
Epoch: 4, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.300 Vali Acc: 0.784 Test Loss: 1.300 Test Acc: 0.784
Validation loss decreased (-0.731234 --> -0.784362).  Saving model ...
Epoch: 5 cost time: 0.7326810359954834
Epoch: 5, Steps: 8 | Train Loss: 1.003 Vali Loss: 0.984 Vali Acc: 0.800 Test Loss: 0.984 Test Acc: 0.800
Validation loss decreased (-0.784362 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.8257615566253662
Epoch: 6, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.742 Vali Acc: 0.816 Test Loss: 0.742 Test Acc: 0.816
Validation loss decreased (-0.799990 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 0.9146225452423096
Epoch: 7, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 0.9178736209869385
Epoch: 8, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 0.6926524639129639
Epoch: 9, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.8050732612609863
Epoch: 10, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.441 Vali Acc: 0.847 Test Loss: 0.441 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846871).  Saving model ...
Epoch: 11 cost time: 0.9261062145233154
Epoch: 11, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
Validation loss decreased (-0.846871 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 0.7437033653259277
Epoch: 12, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7859103679656982
Epoch: 13, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7547247409820557
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.435 Vali Acc: 0.853 Test Loss: 0.435 Test Acc: 0.853
Validation loss decreased (-0.849996 --> -0.853121).  Saving model ...
Epoch: 15 cost time: 0.6779823303222656
Epoch: 15, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.867617130279541
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.445 Vali Acc: 0.853 Test Loss: 0.445 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8204755783081055
Epoch: 17, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
Validation loss decreased (-0.853121 --> -0.856246).  Saving model ...
Epoch: 18 cost time: 0.9693603515625
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.790381669998169
Epoch: 19, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.886934757232666
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
Validation loss decreased (-0.856246 --> -0.859370).  Saving model ...
Epoch: 21 cost time: 0.868112325668335
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 22 cost time: 0.7289695739746094
Epoch: 22, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9180784225463867
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 24 cost time: 0.7876675128936768
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0226497650146484
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9694375991821289
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9660043716430664
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7772164344787598
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.762070894241333
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7653701305389404
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9499642848968506
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8263287544250488
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.863 Test Loss: 0.529 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8191399574279785
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 2127880
model size : 8.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.230182409286499
Epoch: 1, Steps: 8 | Train Loss: 2.086 Vali Loss: 2.021 Vali Acc: 0.287 Test Loss: 2.021 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 0.7576553821563721
Epoch: 2, Steps: 8 | Train Loss: 1.744 Vali Loss: 1.687 Vali Acc: 0.716 Test Loss: 1.687 Test Acc: 0.716
Validation loss decreased (-0.287480 --> -0.715608).  Saving model ...
Epoch: 3 cost time: 0.7369928359985352
Epoch: 3, Steps: 8 | Train Loss: 1.227 Vali Loss: 1.191 Vali Acc: 0.800 Test Loss: 1.191 Test Acc: 0.800
Validation loss decreased (-0.715608 --> -0.799988).  Saving model ...
Epoch: 4 cost time: 0.6507582664489746
Epoch: 4, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.752 Vali Acc: 0.828 Test Loss: 0.752 Test Acc: 0.828
Validation loss decreased (-0.799988 --> -0.828117).  Saving model ...
Epoch: 5 cost time: 0.7948963642120361
Epoch: 5, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.828117 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.6720659732818604
Epoch: 6, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.7588732242584229
Epoch: 7, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6260406970977783
Epoch: 8, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7748157978057861
Epoch: 9, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.565 Vali Acc: 0.838 Test Loss: 0.565 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6792373657226562
Epoch: 10, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6305980682373047
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6736500263214111
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7611081600189209
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8416295051574707
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.683 Vali Acc: 0.831 Test Loss: 0.683 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7455291748046875
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6486067771911621
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.828 Test Loss: 0.717 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 659016
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.142899990081787
Epoch: 1, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.983 Vali Acc: 0.372 Test Loss: 1.983 Test Acc: 0.372
Validation loss decreased (inf --> -0.371855).  Saving model ...
Epoch: 2 cost time: 0.7383372783660889
Epoch: 2, Steps: 8 | Train Loss: 1.812 Vali Loss: 1.774 Vali Acc: 0.675 Test Loss: 1.774 Test Acc: 0.675
Validation loss decreased (-0.371855 --> -0.674982).  Saving model ...
Epoch: 3 cost time: 0.5540287494659424
Epoch: 3, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.432 Vali Acc: 0.775 Test Loss: 1.432 Test Acc: 0.775
Validation loss decreased (-0.674982 --> -0.774986).  Saving model ...
Epoch: 4 cost time: 0.6652121543884277
Epoch: 4, Steps: 8 | Train Loss: 1.036 Vali Loss: 1.029 Vali Acc: 0.797 Test Loss: 1.029 Test Acc: 0.797
Validation loss decreased (-0.774986 --> -0.796865).  Saving model ...
Epoch: 5 cost time: 0.725780725479126
Epoch: 5, Steps: 8 | Train Loss: 0.703 Vali Loss: 0.713 Vali Acc: 0.828 Test Loss: 0.713 Test Acc: 0.828
Validation loss decreased (-0.796865 --> -0.828118).  Saving model ...
Epoch: 6 cost time: 0.7032585144042969
Epoch: 6, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.7844662666320801
Epoch: 7, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.6675765514373779
Epoch: 8, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.6074779033660889
Epoch: 9, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.6431453227996826
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.772531270980835
Epoch: 11, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7253787517547607
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.62042236328125
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6884629726409912
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7085299491882324
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6368687152862549
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.599 Vali Acc: 0.825 Test Loss: 0.599 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5483126640319824
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.605 Vali Acc: 0.825 Test Loss: 0.605 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5735795497894287
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5676038265228271
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 601160
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.031486988067627
Epoch: 1, Steps: 8 | Train Loss: 2.068 Vali Loss: 2.046 Vali Acc: 0.244 Test Loss: 2.046 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 0.6448369026184082
Epoch: 2, Steps: 8 | Train Loss: 1.913 Vali Loss: 1.916 Vali Acc: 0.472 Test Loss: 1.916 Test Acc: 0.472
Validation loss decreased (-0.243730 --> -0.471856).  Saving model ...
Epoch: 3 cost time: 0.6104369163513184
Epoch: 3, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.692 Vali Acc: 0.684 Test Loss: 1.692 Test Acc: 0.684
Validation loss decreased (-0.471856 --> -0.684358).  Saving model ...
Epoch: 4 cost time: 0.6719973087310791
Epoch: 4, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.383 Vali Acc: 0.772 Test Loss: 1.383 Test Acc: 0.772
Validation loss decreased (-0.684358 --> -0.771861).  Saving model ...
Epoch: 5 cost time: 0.5252082347869873
Epoch: 5, Steps: 8 | Train Loss: 1.041 Vali Loss: 1.036 Vali Acc: 0.800 Test Loss: 1.036 Test Acc: 0.800
Validation loss decreased (-0.771861 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.6369960308074951
Epoch: 6, Steps: 8 | Train Loss: 0.777 Vali Loss: 0.760 Vali Acc: 0.806 Test Loss: 0.760 Test Acc: 0.806
Validation loss decreased (-0.799990 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.6403210163116455
Epoch: 7, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.598 Vali Acc: 0.834 Test Loss: 0.598 Test Acc: 0.834
Validation loss decreased (-0.806242 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 0.6325082778930664
Epoch: 8, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.6373884677886963
Epoch: 9, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.6923713684082031
Epoch: 10, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.6906914710998535
Epoch: 11, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6743330955505371
Epoch: 12, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6746704578399658
Epoch: 13, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6927998065948486
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7321689128875732
Epoch: 15, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.629173994064331
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7622907161712646
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7011444568634033
Epoch: 18, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7032938003540039
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7962722778320312
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 580168
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9227218627929688
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.044 Vali Acc: 0.234 Test Loss: 2.044 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.6346983909606934
Epoch: 2, Steps: 8 | Train Loss: 1.968 Vali Loss: 1.920 Vali Acc: 0.419 Test Loss: 1.920 Test Acc: 0.419
Validation loss decreased (-0.234355 --> -0.418731).  Saving model ...
Epoch: 3 cost time: 0.5516357421875
Epoch: 3, Steps: 8 | Train Loss: 1.751 Vali Loss: 1.707 Vali Acc: 0.641 Test Loss: 1.707 Test Acc: 0.641
Validation loss decreased (-0.418731 --> -0.640608).  Saving model ...
Epoch: 4 cost time: 0.7055439949035645
Epoch: 4, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.429 Vali Acc: 0.750 Test Loss: 1.429 Test Acc: 0.750
Validation loss decreased (-0.640608 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 0.6294429302215576
Epoch: 5, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.114 Vali Acc: 0.787 Test Loss: 1.114 Test Acc: 0.787
Validation loss decreased (-0.749986 --> -0.787489).  Saving model ...
Epoch: 6 cost time: 0.5954375267028809
Epoch: 6, Steps: 8 | Train Loss: 0.916 Vali Loss: 0.853 Vali Acc: 0.797 Test Loss: 0.853 Test Acc: 0.797
Validation loss decreased (-0.787489 --> -0.796866).  Saving model ...
Epoch: 7 cost time: 0.5475127696990967
Epoch: 7, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.660 Vali Acc: 0.828 Test Loss: 0.660 Test Acc: 0.828
Validation loss decreased (-0.796866 --> -0.828118).  Saving model ...
Epoch: 8 cost time: 0.5562469959259033
Epoch: 8, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.6473884582519531
Epoch: 9, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.6045114994049072
Epoch: 10, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.73468017578125
Epoch: 11, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.5921096801757812
Epoch: 12, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.578639030456543
Epoch: 13, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6309583187103271
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5875651836395264
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7798354625701904
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.757049560546875
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6293094158172607
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7142186164855957
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7158248424530029
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6516373157501221
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 571464
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8626048564910889
Epoch: 1, Steps: 8 | Train Loss: 2.036 Vali Loss: 2.003 Vali Acc: 0.272 Test Loss: 2.003 Test Acc: 0.272
Validation loss decreased (inf --> -0.271855).  Saving model ...
Epoch: 2 cost time: 0.6008486747741699
Epoch: 2, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.903 Vali Acc: 0.434 Test Loss: 1.903 Test Acc: 0.434
Validation loss decreased (-0.271855 --> -0.434356).  Saving model ...
Epoch: 3 cost time: 0.7200562953948975
Epoch: 3, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.740 Vali Acc: 0.644 Test Loss: 1.740 Test Acc: 0.644
Validation loss decreased (-0.434356 --> -0.643733).  Saving model ...
Epoch: 4 cost time: 0.666506290435791
Epoch: 4, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.527 Vali Acc: 0.756 Test Loss: 1.527 Test Acc: 0.756
Validation loss decreased (-0.643733 --> -0.756235).  Saving model ...
Epoch: 5 cost time: 0.6486263275146484
Epoch: 5, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.278 Vali Acc: 0.784 Test Loss: 1.278 Test Acc: 0.784
Validation loss decreased (-0.756235 --> -0.784362).  Saving model ...
Epoch: 6 cost time: 0.6475551128387451
Epoch: 6, Steps: 8 | Train Loss: 1.078 Vali Loss: 1.026 Vali Acc: 0.800 Test Loss: 1.026 Test Acc: 0.800
Validation loss decreased (-0.784362 --> -0.799990).  Saving model ...
Epoch: 7 cost time: 0.666083574295044
Epoch: 7, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.812 Vali Acc: 0.816 Test Loss: 0.812 Test Acc: 0.816
Validation loss decreased (-0.799990 --> -0.815617).  Saving model ...
Epoch: 8 cost time: 0.6639783382415771
Epoch: 8, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
Validation loss decreased (-0.815617 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.6395680904388428
Epoch: 9, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.556 Vali Acc: 0.834 Test Loss: 0.556 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.7255737781524658
Epoch: 10, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.5575428009033203
Epoch: 11, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.7664871215820312
Epoch: 12, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6754369735717773
Epoch: 13, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853121).  Saving model ...
Epoch: 14 cost time: 0.6661896705627441
Epoch: 14, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
Validation loss decreased (-0.853121 --> -0.853121).  Saving model ...
Epoch: 15 cost time: 0.6444046497344971
Epoch: 15, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7670094966888428
Epoch: 16, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5813572406768799
Epoch: 17, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6430239677429199
Epoch: 18, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5410106182098389
Epoch: 19, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5601010322570801
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
Validation loss decreased (-0.853121 --> -0.859370).  Saving model ...
Epoch: 21 cost time: 0.5276587009429932
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6503889560699463
Epoch: 22, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6961085796356201
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6901202201843262
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6114354133605957
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6836707592010498
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6709549427032471
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6964454650878906
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6469643115997314
Epoch: 29, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6483783721923828
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 563272
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8397293090820312
Epoch: 1, Steps: 8 | Train Loss: 2.028 Vali Loss: 2.021 Vali Acc: 0.209 Test Loss: 2.021 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 0.6201629638671875
Epoch: 2, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.937 Vali Acc: 0.397 Test Loss: 1.937 Test Acc: 0.397
Validation loss decreased (-0.209355 --> -0.396856).  Saving model ...
Epoch: 3 cost time: 0.6050689220428467
Epoch: 3, Steps: 8 | Train Loss: 1.807 Vali Loss: 1.797 Vali Acc: 0.584 Test Loss: 1.797 Test Acc: 0.584
Validation loss decreased (-0.396856 --> -0.584357).  Saving model ...
Epoch: 4 cost time: 0.6434779167175293
Epoch: 4, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.611 Vali Acc: 0.719 Test Loss: 1.611 Test Acc: 0.719
Validation loss decreased (-0.584357 --> -0.718734).  Saving model ...
Epoch: 5 cost time: 0.5701553821563721
Epoch: 5, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.395 Vali Acc: 0.762 Test Loss: 1.395 Test Acc: 0.762
Validation loss decreased (-0.718734 --> -0.762486).  Saving model ...
Epoch: 6 cost time: 0.6386847496032715
Epoch: 6, Steps: 8 | Train Loss: 1.189 Vali Loss: 1.167 Vali Acc: 0.781 Test Loss: 1.167 Test Acc: 0.781
Validation loss decreased (-0.762486 --> -0.781238).  Saving model ...
Epoch: 7 cost time: 0.7097301483154297
Epoch: 7, Steps: 8 | Train Loss: 1.003 Vali Loss: 0.956 Vali Acc: 0.787 Test Loss: 0.956 Test Acc: 0.787
Validation loss decreased (-0.781238 --> -0.787490).  Saving model ...
Epoch: 8 cost time: 0.5867578983306885
Epoch: 8, Steps: 8 | Train Loss: 0.788 Vali Loss: 0.785 Vali Acc: 0.822 Test Loss: 0.785 Test Acc: 0.822
Validation loss decreased (-0.787490 --> -0.821867).  Saving model ...
Epoch: 9 cost time: 0.7146058082580566
Epoch: 9, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.663 Vali Acc: 0.838 Test Loss: 0.663 Test Acc: 0.838
Validation loss decreased (-0.821867 --> -0.837493).  Saving model ...
Epoch: 10 cost time: 0.676541805267334
Epoch: 10, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.584 Vali Acc: 0.834 Test Loss: 0.584 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6256978511810303
Epoch: 11, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.837493 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 0.668879508972168
Epoch: 12, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.486 Vali Acc: 0.866 Test Loss: 0.486 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 13 cost time: 0.71396803855896
Epoch: 13, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.465 Vali Acc: 0.869 Test Loss: 0.465 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 14 cost time: 0.5647714138031006
Epoch: 14, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.652064323425293
Epoch: 15, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6858782768249512
Epoch: 16, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.442 Vali Acc: 0.856 Test Loss: 0.442 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6037130355834961
Epoch: 17, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.438 Vali Acc: 0.859 Test Loss: 0.438 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5178711414337158
Epoch: 18, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.437 Vali Acc: 0.863 Test Loss: 0.437 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6578216552734375
Epoch: 19, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6763761043548584
Epoch: 20, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.433 Vali Acc: 0.863 Test Loss: 0.433 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.669295072555542
Epoch: 21, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5885167121887207
Epoch: 22, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.440 Vali Acc: 0.859 Test Loss: 0.440 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6179125308990479
Epoch: 23, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 558088
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.936194658279419
Epoch: 1, Steps: 8 | Train Loss: 2.075 Vali Loss: 2.065 Vali Acc: 0.178 Test Loss: 2.065 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 0.7029614448547363
Epoch: 2, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.987 Vali Acc: 0.266 Test Loss: 1.987 Test Acc: 0.266
Validation loss decreased (-0.178104 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 0.6899139881134033
Epoch: 3, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.856 Vali Acc: 0.469 Test Loss: 1.856 Test Acc: 0.469
Validation loss decreased (-0.265605 --> -0.468731).  Saving model ...
Epoch: 4 cost time: 0.6467452049255371
Epoch: 4, Steps: 8 | Train Loss: 1.701 Vali Loss: 1.686 Vali Acc: 0.666 Test Loss: 1.686 Test Acc: 0.666
Validation loss decreased (-0.468731 --> -0.665608).  Saving model ...
Epoch: 5 cost time: 0.6108002662658691
Epoch: 5, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.501 Vali Acc: 0.769 Test Loss: 1.501 Test Acc: 0.769
Validation loss decreased (-0.665608 --> -0.768735).  Saving model ...
Epoch: 6 cost time: 0.6805694103240967
Epoch: 6, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.304 Vali Acc: 0.778 Test Loss: 1.304 Test Acc: 0.778
Validation loss decreased (-0.768735 --> -0.778112).  Saving model ...
Epoch: 7 cost time: 0.6745119094848633
Epoch: 7, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.111 Vali Acc: 0.794 Test Loss: 1.111 Test Acc: 0.794
Validation loss decreased (-0.778112 --> -0.793739).  Saving model ...
Epoch: 8 cost time: 0.6399011611938477
Epoch: 8, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.941 Vali Acc: 0.816 Test Loss: 0.941 Test Acc: 0.816
Validation loss decreased (-0.793739 --> -0.815616).  Saving model ...
Epoch: 9 cost time: 0.6174848079681396
Epoch: 9, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.798 Vali Acc: 0.828 Test Loss: 0.798 Test Acc: 0.828
Validation loss decreased (-0.815616 --> -0.828117).  Saving model ...
Epoch: 10 cost time: 0.6076133251190186
Epoch: 10, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.686 Vali Acc: 0.844 Test Loss: 0.686 Test Acc: 0.844
Validation loss decreased (-0.828117 --> -0.843743).  Saving model ...
Epoch: 11 cost time: 0.6188235282897949
Epoch: 11, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.608 Vali Acc: 0.853 Test Loss: 0.608 Test Acc: 0.853
Validation loss decreased (-0.843743 --> -0.853119).  Saving model ...
Epoch: 12 cost time: 0.6658015251159668
Epoch: 12, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.552 Vali Acc: 0.859 Test Loss: 0.552 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 13 cost time: 0.64194655418396
Epoch: 13, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862495).  Saving model ...
Epoch: 14 cost time: 0.5774855613708496
Epoch: 14, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5106863975524902
Epoch: 15, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5345742702484131
Epoch: 16, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.454 Vali Acc: 0.866 Test Loss: 0.454 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 17 cost time: 0.5385317802429199
Epoch: 17, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.442 Vali Acc: 0.859 Test Loss: 0.442 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7029209136962891
Epoch: 18, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5180532932281494
Epoch: 19, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.430 Vali Acc: 0.853 Test Loss: 0.430 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5928812026977539
Epoch: 20, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7177784442901611
Epoch: 21, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.423 Vali Acc: 0.853 Test Loss: 0.423 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7419881820678711
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.421 Vali Acc: 0.853 Test Loss: 0.421 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5870931148529053
Epoch: 23, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.431 Vali Acc: 0.847 Test Loss: 0.431 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6900730133056641
Epoch: 24, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.438 Vali Acc: 0.853 Test Loss: 0.438 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6974678039550781
Epoch: 25, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.438 Vali Acc: 0.856 Test Loss: 0.438 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6464533805847168
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.429 Vali Acc: 0.853 Test Loss: 0.429 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 556040
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0005292892456055
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 2.072 Vali Acc: 0.072 Test Loss: 2.072 Test Acc: 0.072
Validation loss decreased (inf --> -0.071854).  Saving model ...
Epoch: 2 cost time: 0.6519434452056885
Epoch: 2, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.863 Vali Acc: 0.503 Test Loss: 1.863 Test Acc: 0.503
Validation loss decreased (-0.071854 --> -0.503106).  Saving model ...
Epoch: 3 cost time: 0.5835320949554443
Epoch: 3, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.543 Vali Acc: 0.725 Test Loss: 1.543 Test Acc: 0.725
Validation loss decreased (-0.503106 --> -0.724985).  Saving model ...
Epoch: 4 cost time: 0.6348669528961182
Epoch: 4, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.167 Vali Acc: 0.766 Test Loss: 1.167 Test Acc: 0.766
Validation loss decreased (-0.724985 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.6704726219177246
Epoch: 5, Steps: 8 | Train Loss: 0.812 Vali Loss: 0.828 Vali Acc: 0.797 Test Loss: 0.828 Test Acc: 0.797
Validation loss decreased (-0.765613 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 0.6437435150146484
Epoch: 6, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.622 Vali Acc: 0.812 Test Loss: 0.622 Test Acc: 0.812
Validation loss decreased (-0.796867 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 0.6078808307647705
Epoch: 7, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.5977201461791992
Epoch: 8, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.831245 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.5884921550750732
Epoch: 9, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6510593891143799
Epoch: 10, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5818850994110107
Epoch: 11, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6888906955718994
Epoch: 12, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6617076396942139
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.658104419708252
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6419126987457275
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6887907981872559
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7245032787322998
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6588551998138428
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 202536
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7650763988494873
Epoch: 1, Steps: 8 | Train Loss: 2.051 Vali Loss: 2.026 Vali Acc: 0.234 Test Loss: 2.026 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.5475268363952637
Epoch: 2, Steps: 8 | Train Loss: 1.938 Vali Loss: 1.917 Vali Acc: 0.500 Test Loss: 1.917 Test Acc: 0.500
Validation loss decreased (-0.234355 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 0.5681729316711426
Epoch: 3, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.735 Vali Acc: 0.650 Test Loss: 1.735 Test Acc: 0.650
Validation loss decreased (-0.499981 --> -0.649983).  Saving model ...
Epoch: 4 cost time: 0.5395386219024658
Epoch: 4, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.504 Vali Acc: 0.713 Test Loss: 1.504 Test Acc: 0.713
Validation loss decreased (-0.649983 --> -0.712485).  Saving model ...
Epoch: 5 cost time: 0.5614359378814697
Epoch: 5, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.240 Vali Acc: 0.750 Test Loss: 1.240 Test Acc: 0.750
Validation loss decreased (-0.712485 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.5076861381530762
Epoch: 6, Steps: 8 | Train Loss: 1.012 Vali Loss: 0.978 Vali Acc: 0.769 Test Loss: 0.978 Test Acc: 0.769
Validation loss decreased (-0.749988 --> -0.768740).  Saving model ...
Epoch: 7 cost time: 0.5715067386627197
Epoch: 7, Steps: 8 | Train Loss: 0.757 Vali Loss: 0.774 Vali Acc: 0.797 Test Loss: 0.774 Test Acc: 0.797
Validation loss decreased (-0.768740 --> -0.796867).  Saving model ...
Epoch: 8 cost time: 0.5225417613983154
Epoch: 8, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.6551427841186523
Epoch: 9, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
Validation loss decreased (-0.806244 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.5496029853820801
Epoch: 10, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.6049399375915527
Epoch: 11, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.6481475830078125
Epoch: 12, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5710434913635254
Epoch: 13, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.474 Vali Acc: 0.859 Test Loss: 0.474 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 0.5707645416259766
Epoch: 14, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5660269260406494
Epoch: 15, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6646339893341064
Epoch: 16, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6039960384368896
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.629065990447998
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6044788360595703
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7295053005218506
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.630774974822998
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6608657836914062
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6098949909210205
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 173608
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8779919147491455
Epoch: 1, Steps: 8 | Train Loss: 2.062 Vali Loss: 2.038 Vali Acc: 0.194 Test Loss: 2.038 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.540266752243042
Epoch: 2, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.965 Vali Acc: 0.369 Test Loss: 1.965 Test Acc: 0.369
Validation loss decreased (-0.193730 --> -0.368730).  Saving model ...
Epoch: 3 cost time: 0.5042269229888916
Epoch: 3, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.840 Vali Acc: 0.594 Test Loss: 1.840 Test Acc: 0.594
Validation loss decreased (-0.368730 --> -0.593732).  Saving model ...
Epoch: 4 cost time: 0.5576961040496826
Epoch: 4, Steps: 8 | Train Loss: 1.674 Vali Loss: 1.664 Vali Acc: 0.750 Test Loss: 1.664 Test Acc: 0.750
Validation loss decreased (-0.593732 --> -0.749983).  Saving model ...
Epoch: 5 cost time: 0.5558838844299316
Epoch: 5, Steps: 8 | Train Loss: 1.478 Vali Loss: 1.453 Vali Acc: 0.794 Test Loss: 1.453 Test Acc: 0.794
Validation loss decreased (-0.749983 --> -0.793735).  Saving model ...
Epoch: 6 cost time: 0.5477511882781982
Epoch: 6, Steps: 8 | Train Loss: 1.230 Vali Loss: 1.222 Vali Acc: 0.809 Test Loss: 1.222 Test Acc: 0.809
Validation loss decreased (-0.793735 --> -0.809363).  Saving model ...
Epoch: 7 cost time: 0.565401554107666
Epoch: 7, Steps: 8 | Train Loss: 1.005 Vali Loss: 1.001 Vali Acc: 0.816 Test Loss: 1.001 Test Acc: 0.816
Validation loss decreased (-0.809363 --> -0.815615).  Saving model ...
Epoch: 8 cost time: 0.5288944244384766
Epoch: 8, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.815615 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.5548696517944336
Epoch: 9, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.663 Vali Acc: 0.831 Test Loss: 0.663 Test Acc: 0.831
Validation loss decreased (-0.824992 --> -0.831243).  Saving model ...
Epoch: 10 cost time: 0.5607900619506836
Epoch: 10, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
Validation loss decreased (-0.831243 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 0.5799682140350342
Epoch: 11, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.5854706764221191
Epoch: 12, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.685675859451294
Epoch: 13, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5313186645507812
Epoch: 14, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.6361327171325684
Epoch: 15, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6617703437805176
Epoch: 16, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.664891242980957
Epoch: 17, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.524789571762085
Epoch: 18, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5795910358428955
Epoch: 19, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7669997215270996
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6377527713775635
Epoch: 21, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5749142169952393
Epoch: 22, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6852548122406006
Epoch: 23, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5517711639404297
Epoch: 24, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 163112
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8360316753387451
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.087 Vali Acc: 0.103 Test Loss: 2.087 Test Acc: 0.103
Validation loss decreased (inf --> -0.103104).  Saving model ...
Epoch: 2 cost time: 0.5061495304107666
Epoch: 2, Steps: 8 | Train Loss: 2.083 Vali Loss: 2.040 Vali Acc: 0.253 Test Loss: 2.040 Test Acc: 0.253
Validation loss decreased (-0.103104 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 0.5673284530639648
Epoch: 3, Steps: 8 | Train Loss: 1.962 Vali Loss: 1.952 Vali Acc: 0.400 Test Loss: 1.952 Test Acc: 0.400
Validation loss decreased (-0.253105 --> -0.399980).  Saving model ...
Epoch: 4 cost time: 0.6018133163452148
Epoch: 4, Steps: 8 | Train Loss: 1.861 Vali Loss: 1.830 Vali Acc: 0.556 Test Loss: 1.830 Test Acc: 0.556
Validation loss decreased (-0.399980 --> -0.556232).  Saving model ...
Epoch: 5 cost time: 0.510725736618042
Epoch: 5, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.681 Vali Acc: 0.666 Test Loss: 1.681 Test Acc: 0.666
Validation loss decreased (-0.556232 --> -0.665608).  Saving model ...
Epoch: 6 cost time: 0.5283758640289307
Epoch: 6, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.505 Vali Acc: 0.725 Test Loss: 1.505 Test Acc: 0.725
Validation loss decreased (-0.665608 --> -0.724985).  Saving model ...
Epoch: 7 cost time: 0.6098465919494629
Epoch: 7, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.306 Vali Acc: 0.784 Test Loss: 1.306 Test Acc: 0.784
Validation loss decreased (-0.724985 --> -0.784362).  Saving model ...
Epoch: 8 cost time: 0.5826423168182373
Epoch: 8, Steps: 8 | Train Loss: 1.120 Vali Loss: 1.109 Vali Acc: 0.800 Test Loss: 1.109 Test Acc: 0.800
Validation loss decreased (-0.784362 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.6388630867004395
Epoch: 9, Steps: 8 | Train Loss: 0.955 Vali Loss: 0.917 Vali Acc: 0.819 Test Loss: 0.917 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818741).  Saving model ...
Epoch: 10 cost time: 0.6014025211334229
Epoch: 10, Steps: 8 | Train Loss: 0.785 Vali Loss: 0.765 Vali Acc: 0.834 Test Loss: 0.765 Test Acc: 0.834
Validation loss decreased (-0.818741 --> -0.834367).  Saving model ...
Epoch: 11 cost time: 0.6059129238128662
Epoch: 11, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.656 Vali Acc: 0.838 Test Loss: 0.656 Test Acc: 0.838
Validation loss decreased (-0.834367 --> -0.837493).  Saving model ...
Epoch: 12 cost time: 0.6129276752471924
Epoch: 12, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
Validation loss decreased (-0.837493 --> -0.856244).  Saving model ...
Epoch: 13 cost time: 0.7100181579589844
Epoch: 13, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6121468544006348
Epoch: 14, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6247227191925049
Epoch: 15, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6346142292022705
Epoch: 16, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6752164363861084
Epoch: 17, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.70916748046875
Epoch: 18, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6787340641021729
Epoch: 19, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.451 Vali Acc: 0.853 Test Loss: 0.451 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5363726615905762
Epoch: 20, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6947438716888428
Epoch: 21, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5833039283752441
Epoch: 22, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 158760
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0090696811676025
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 2.084 Vali Acc: 0.125 Test Loss: 2.084 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 0.5748224258422852
Epoch: 2, Steps: 8 | Train Loss: 2.097 Vali Loss: 2.047 Vali Acc: 0.184 Test Loss: 2.047 Test Acc: 0.184
Validation loss decreased (-0.124979 --> -0.184355).  Saving model ...
Epoch: 3 cost time: 0.6030545234680176
Epoch: 3, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.975 Vali Acc: 0.322 Test Loss: 1.975 Test Acc: 0.322
Validation loss decreased (-0.184355 --> -0.321855).  Saving model ...
Epoch: 4 cost time: 0.6115236282348633
Epoch: 4, Steps: 8 | Train Loss: 1.904 Vali Loss: 1.868 Vali Acc: 0.484 Test Loss: 1.868 Test Acc: 0.484
Validation loss decreased (-0.321855 --> -0.484356).  Saving model ...
Epoch: 5 cost time: 0.7309529781341553
Epoch: 5, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.732 Vali Acc: 0.616 Test Loss: 1.732 Test Acc: 0.616
Validation loss decreased (-0.484356 --> -0.615608).  Saving model ...
Epoch: 6 cost time: 0.5491452217102051
Epoch: 6, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.580 Vali Acc: 0.725 Test Loss: 1.580 Test Acc: 0.725
Validation loss decreased (-0.615608 --> -0.724984).  Saving model ...
Epoch: 7 cost time: 0.6004393100738525
Epoch: 7, Steps: 8 | Train Loss: 1.459 Vali Loss: 1.416 Vali Acc: 0.787 Test Loss: 1.416 Test Acc: 0.787
Validation loss decreased (-0.724984 --> -0.787486).  Saving model ...
Epoch: 8 cost time: 0.5588295459747314
Epoch: 8, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.234 Vali Acc: 0.819 Test Loss: 1.234 Test Acc: 0.819
Validation loss decreased (-0.787486 --> -0.818738).  Saving model ...
Epoch: 9 cost time: 0.5949451923370361
Epoch: 9, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.066 Vali Acc: 0.834 Test Loss: 1.066 Test Acc: 0.834
Validation loss decreased (-0.818738 --> -0.834364).  Saving model ...
Epoch: 10 cost time: 0.6062555313110352
Epoch: 10, Steps: 8 | Train Loss: 0.915 Vali Loss: 0.906 Vali Acc: 0.841 Test Loss: 0.906 Test Acc: 0.841
Validation loss decreased (-0.834364 --> -0.840616).  Saving model ...
Epoch: 11 cost time: 0.5902094841003418
Epoch: 11, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.770 Vali Acc: 0.850 Test Loss: 0.770 Test Acc: 0.850
Validation loss decreased (-0.840616 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.6657044887542725
Epoch: 12, Steps: 8 | Train Loss: 0.605 Vali Loss: 0.672 Vali Acc: 0.847 Test Loss: 0.672 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.616788387298584
Epoch: 13, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.6239147186279297
Epoch: 14, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.6427483558654785
Epoch: 15, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.5451722145080566
Epoch: 16, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 17 cost time: 0.5614819526672363
Epoch: 17, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 18 cost time: 0.5092871189117432
Epoch: 18, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 0.5907487869262695
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 0.5958759784698486
Epoch: 20, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6027495861053467
Epoch: 21, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.646916389465332
Epoch: 22, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.441 Vali Acc: 0.847 Test Loss: 0.441 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.524000883102417
Epoch: 23, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5744054317474365
Epoch: 24, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.439 Vali Acc: 0.863 Test Loss: 0.439 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 25 cost time: 0.5404648780822754
Epoch: 25, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5230860710144043
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.518294095993042
Epoch: 27, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5984575748443604
Epoch: 28, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.588860034942627
Epoch: 29, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5642261505126953
Epoch: 30, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5597183704376221
Epoch: 31, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.457 Vali Acc: 0.853 Test Loss: 0.457 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.617159366607666
Epoch: 32, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5147249698638916
Epoch: 33, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6159307956695557
Epoch: 34, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 154664
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.047224283218384
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.059 Vali Acc: 0.156 Test Loss: 2.059 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.6613435745239258
Epoch: 2, Steps: 8 | Train Loss: 2.086 Vali Loss: 2.024 Vali Acc: 0.197 Test Loss: 2.024 Test Acc: 0.197
Validation loss decreased (-0.156229 --> -0.196855).  Saving model ...
Epoch: 3 cost time: 0.5899362564086914
Epoch: 3, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.965 Vali Acc: 0.250 Test Loss: 1.965 Test Acc: 0.250
Validation loss decreased (-0.196855 --> -0.249980).  Saving model ...
Epoch: 4 cost time: 0.6067869663238525
Epoch: 4, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.883 Vali Acc: 0.425 Test Loss: 1.883 Test Acc: 0.425
Validation loss decreased (-0.249980 --> -0.424981).  Saving model ...
Epoch: 5 cost time: 0.6591143608093262
Epoch: 5, Steps: 8 | Train Loss: 1.829 Vali Loss: 1.779 Vali Acc: 0.606 Test Loss: 1.779 Test Acc: 0.606
Validation loss decreased (-0.424981 --> -0.606232).  Saving model ...
Epoch: 6 cost time: 0.5865006446838379
Epoch: 6, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.665 Vali Acc: 0.688 Test Loss: 1.665 Test Acc: 0.688
Validation loss decreased (-0.606232 --> -0.687483).  Saving model ...
Epoch: 7 cost time: 0.5452287197113037
Epoch: 7, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.538 Vali Acc: 0.756 Test Loss: 1.538 Test Acc: 0.756
Validation loss decreased (-0.687483 --> -0.756235).  Saving model ...
Epoch: 8 cost time: 0.5538532733917236
Epoch: 8, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.397 Vali Acc: 0.769 Test Loss: 1.397 Test Acc: 0.769
Validation loss decreased (-0.756235 --> -0.768736).  Saving model ...
Epoch: 9 cost time: 0.5183596611022949
Epoch: 9, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.247 Vali Acc: 0.781 Test Loss: 1.247 Test Acc: 0.781
Validation loss decreased (-0.768736 --> -0.781238).  Saving model ...
Epoch: 10 cost time: 0.5383639335632324
Epoch: 10, Steps: 8 | Train Loss: 1.135 Vali Loss: 1.100 Vali Acc: 0.797 Test Loss: 1.100 Test Acc: 0.797
Validation loss decreased (-0.781238 --> -0.796864).  Saving model ...
Epoch: 11 cost time: 0.6369054317474365
Epoch: 11, Steps: 8 | Train Loss: 0.992 Vali Loss: 0.963 Vali Acc: 0.800 Test Loss: 0.963 Test Acc: 0.800
Validation loss decreased (-0.796864 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 0.5991036891937256
Epoch: 12, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.843 Vali Acc: 0.816 Test Loss: 0.843 Test Acc: 0.816
Validation loss decreased (-0.799990 --> -0.815617).  Saving model ...
Epoch: 13 cost time: 0.5714738368988037
Epoch: 13, Steps: 8 | Train Loss: 0.703 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
Validation loss decreased (-0.815617 --> -0.818743).  Saving model ...
Epoch: 14 cost time: 0.5981860160827637
Epoch: 14, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.667 Vali Acc: 0.831 Test Loss: 0.667 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831243).  Saving model ...
Epoch: 15 cost time: 0.5810317993164062
Epoch: 15, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
Validation loss decreased (-0.831243 --> -0.840619).  Saving model ...
Epoch: 16 cost time: 0.5341672897338867
Epoch: 16, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.557 Vali Acc: 0.853 Test Loss: 0.557 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853119).  Saving model ...
Epoch: 17 cost time: 0.5522317886352539
Epoch: 17, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 0.5848231315612793
Epoch: 18, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.5977396965026855
Epoch: 19, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.468 Vali Acc: 0.863 Test Loss: 0.468 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 20 cost time: 0.6036231517791748
Epoch: 20, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862496).  Saving model ...
Epoch: 21 cost time: 0.583000898361206
Epoch: 21, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
Validation loss decreased (-0.862496 --> -0.871871).  Saving model ...
Epoch: 22 cost time: 0.5551760196685791
Epoch: 22, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.438 Vali Acc: 0.869 Test Loss: 0.438 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.609870433807373
Epoch: 23, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.429 Vali Acc: 0.863 Test Loss: 0.429 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5910589694976807
Epoch: 24, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.430 Vali Acc: 0.863 Test Loss: 0.430 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5859389305114746
Epoch: 25, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.427 Vali Acc: 0.866 Test Loss: 0.427 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5841269493103027
Epoch: 26, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5773558616638184
Epoch: 27, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.420 Vali Acc: 0.856 Test Loss: 0.420 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6091570854187012
Epoch: 28, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.420 Vali Acc: 0.859 Test Loss: 0.420 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5752067565917969
Epoch: 29, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.422 Vali Acc: 0.869 Test Loss: 0.422 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.552382230758667
Epoch: 30, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.422 Vali Acc: 0.872 Test Loss: 0.422 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 31 cost time: 0.606133222579956
Epoch: 31, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.417 Vali Acc: 0.872 Test Loss: 0.417 Test Acc: 0.872
Validation loss decreased (-0.871871 --> -0.871871).  Saving model ...
Epoch: 32 cost time: 0.49627041816711426
Epoch: 32, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.419 Vali Acc: 0.872 Test Loss: 0.419 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5460352897644043
Epoch: 33, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.423 Vali Acc: 0.872 Test Loss: 0.423 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5250515937805176
Epoch: 34, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.425 Vali Acc: 0.872 Test Loss: 0.425 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.552323579788208
Epoch: 35, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.429 Vali Acc: 0.872 Test Loss: 0.429 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5763659477233887
Epoch: 36, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.567345142364502
Epoch: 37, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5785586833953857
Epoch: 38, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.446 Vali Acc: 0.869 Test Loss: 0.446 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6222794055938721
Epoch: 39, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.452 Vali Acc: 0.866 Test Loss: 0.452 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6132957935333252
Epoch: 40, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.449 Vali Acc: 0.869 Test Loss: 0.449 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6404848098754883
Epoch: 41, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 152072
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8352890014648438
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 2.037 Vali Acc: 0.159 Test Loss: 2.037 Test Acc: 0.159
Validation loss decreased (inf --> -0.159355).  Saving model ...
Epoch: 2 cost time: 0.6157000064849854
Epoch: 2, Steps: 8 | Train Loss: 2.028 Vali Loss: 2.001 Vali Acc: 0.216 Test Loss: 2.001 Test Acc: 0.216
Validation loss decreased (-0.159355 --> -0.215605).  Saving model ...
Epoch: 3 cost time: 0.6009244918823242
Epoch: 3, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.939 Vali Acc: 0.316 Test Loss: 1.939 Test Acc: 0.316
Validation loss decreased (-0.215605 --> -0.315606).  Saving model ...
Epoch: 4 cost time: 0.5637590885162354
Epoch: 4, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.856 Vali Acc: 0.484 Test Loss: 1.856 Test Acc: 0.484
Validation loss decreased (-0.315606 --> -0.484356).  Saving model ...
Epoch: 5 cost time: 0.52829909324646
Epoch: 5, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.756 Vali Acc: 0.562 Test Loss: 1.756 Test Acc: 0.562
Validation loss decreased (-0.484356 --> -0.562482).  Saving model ...
Epoch: 6 cost time: 0.5421280860900879
Epoch: 6, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.643 Vali Acc: 0.650 Test Loss: 1.643 Test Acc: 0.650
Validation loss decreased (-0.562482 --> -0.649984).  Saving model ...
Epoch: 7 cost time: 0.4922800064086914
Epoch: 7, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.520 Vali Acc: 0.688 Test Loss: 1.520 Test Acc: 0.688
Validation loss decreased (-0.649984 --> -0.687485).  Saving model ...
Epoch: 8 cost time: 0.5117805004119873
Epoch: 8, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.391 Vali Acc: 0.728 Test Loss: 1.391 Test Acc: 0.728
Validation loss decreased (-0.687485 --> -0.728111).  Saving model ...
Epoch: 9 cost time: 0.5528724193572998
Epoch: 9, Steps: 8 | Train Loss: 1.256 Vali Loss: 1.261 Vali Acc: 0.747 Test Loss: 1.261 Test Acc: 0.747
Validation loss decreased (-0.728111 --> -0.746862).  Saving model ...
Epoch: 10 cost time: 0.5659193992614746
Epoch: 10, Steps: 8 | Train Loss: 1.133 Vali Loss: 1.135 Vali Acc: 0.753 Test Loss: 1.135 Test Acc: 0.753
Validation loss decreased (-0.746862 --> -0.753114).  Saving model ...
Epoch: 11 cost time: 0.5729577541351318
Epoch: 11, Steps: 8 | Train Loss: 0.988 Vali Loss: 1.013 Vali Acc: 0.787 Test Loss: 1.013 Test Acc: 0.787
Validation loss decreased (-0.753114 --> -0.787490).  Saving model ...
Epoch: 12 cost time: 0.5523743629455566
Epoch: 12, Steps: 8 | Train Loss: 0.883 Vali Loss: 0.906 Vali Acc: 0.803 Test Loss: 0.906 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803116).  Saving model ...
Epoch: 13 cost time: 0.47123026847839355
Epoch: 13, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.814 Vali Acc: 0.797 Test Loss: 0.814 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5536289215087891
Epoch: 14, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815618).  Saving model ...
Epoch: 15 cost time: 0.5871071815490723
Epoch: 15, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.675 Vali Acc: 0.816 Test Loss: 0.675 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 16 cost time: 0.5343871116638184
Epoch: 16, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5331652164459229
Epoch: 17, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821869).  Saving model ...
Epoch: 18 cost time: 0.5086290836334229
Epoch: 18, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 19 cost time: 0.47453904151916504
Epoch: 19, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 20 cost time: 0.6888928413391113
Epoch: 20, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 21 cost time: 0.603492021560669
Epoch: 21, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.489 Vali Acc: 0.828 Test Loss: 0.489 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5513739585876465
Epoch: 22, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.475 Vali Acc: 0.831 Test Loss: 0.475 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.560868501663208
Epoch: 23, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.471 Vali Acc: 0.828 Test Loss: 0.471 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5518639087677002
Epoch: 24, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.467 Vali Acc: 0.825 Test Loss: 0.467 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5018327236175537
Epoch: 25, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.461 Vali Acc: 0.825 Test Loss: 0.461 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5165543556213379
Epoch: 26, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 27 cost time: 0.4859633445739746
Epoch: 27, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 0.5109889507293701
Epoch: 28, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.447 Vali Acc: 0.847 Test Loss: 0.447 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6118428707122803
Epoch: 29, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6318650245666504
Epoch: 30, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.531245231628418
Epoch: 31, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.449 Vali Acc: 0.831 Test Loss: 0.449 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5329639911651611
Epoch: 32, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.452 Vali Acc: 0.834 Test Loss: 0.452 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6207742691040039
Epoch: 33, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.459 Vali Acc: 0.834 Test Loss: 0.459 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6044583320617676
Epoch: 34, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5454535484313965
Epoch: 35, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5826399326324463
Epoch: 36, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.849996 --> -0.853120).  Saving model ...
Epoch: 37 cost time: 0.6197926998138428
Epoch: 37, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6072342395782471
Epoch: 38, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5228328704833984
Epoch: 39, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 40 cost time: 0.5671641826629639
Epoch: 40, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 41 cost time: 0.6272985935211182
Epoch: 41, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.605644702911377
Epoch: 42, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.478 Vali Acc: 0.863 Test Loss: 0.478 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5683050155639648
Epoch: 43, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5673105716705322
Epoch: 44, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5949809551239014
Epoch: 45, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5161030292510986
Epoch: 46, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5887460708618164
Epoch: 47, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5735042095184326
Epoch: 48, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5347034931182861
Epoch: 49, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.512 Vali Acc: 0.859 Test Loss: 0.512 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5602500438690186
Epoch: 50, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.515 Vali Acc: 0.859 Test Loss: 0.515 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 151048
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0114808082580566
Epoch: 1, Steps: 8 | Train Loss: 1.810 Vali Loss: 1.471 Vali Acc: 0.766 Test Loss: 1.471 Test Acc: 0.766
Validation loss decreased (inf --> -0.765610).  Saving model ...
Epoch: 2 cost time: 0.7530989646911621
Epoch: 2, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
Validation loss decreased (-0.765610 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 0.7105796337127686
Epoch: 3, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
Validation loss decreased (-0.821869 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 0.737241268157959
Epoch: 4, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8194704055786133
Epoch: 5, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.653 Vali Acc: 0.812 Test Loss: 0.653 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7460460662841797
Epoch: 6, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.812 Test Loss: 0.802 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7179818153381348
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.850 Vali Acc: 0.819 Test Loss: 0.850 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7881772518157959
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.812 Test Loss: 0.845 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6092772483825684
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.809 Test Loss: 0.842 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5740070343017578
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.819 Test Loss: 0.855 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6303768157958984
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.819 Test Loss: 0.858 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7734365463256836
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.822 Test Loss: 0.859 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7712693214416504
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.822 Test Loss: 0.856 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 2098440
model size : 8.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9049689769744873
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.781 Vali Acc: 0.506 Test Loss: 1.781 Test Acc: 0.506
Validation loss decreased (inf --> -0.506232).  Saving model ...
Epoch: 2 cost time: 0.6353058815002441
Epoch: 2, Steps: 8 | Train Loss: 1.083 Vali Loss: 0.871 Vali Acc: 0.803 Test Loss: 0.871 Test Acc: 0.803
Validation loss decreased (-0.506232 --> -0.803116).  Saving model ...
Epoch: 3 cost time: 0.5774881839752197
Epoch: 3, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
Validation loss decreased (-0.803116 --> -0.824995).  Saving model ...
Epoch: 4 cost time: 0.5171608924865723
Epoch: 4, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
Validation loss decreased (-0.824995 --> -0.859371).  Saving model ...
Epoch: 5 cost time: 0.6083407402038574
Epoch: 5, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6024456024169922
Epoch: 6, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6127192974090576
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.679187536239624
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6073973178863525
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.704209566116333
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6498432159423828
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.831 Test Loss: 0.635 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.550102710723877
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6491389274597168
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6271531581878662
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1860872
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9314653873443604
Epoch: 1, Steps: 8 | Train Loss: 2.125 Vali Loss: 1.864 Vali Acc: 0.438 Test Loss: 1.864 Test Acc: 0.438
Validation loss decreased (inf --> -0.437481).  Saving model ...
Epoch: 2 cost time: 0.6601803302764893
Epoch: 2, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.119 Vali Acc: 0.787 Test Loss: 1.119 Test Acc: 0.787
Validation loss decreased (-0.437481 --> -0.787489).  Saving model ...
Epoch: 3 cost time: 0.6035997867584229
Epoch: 3, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.608 Vali Acc: 0.838 Test Loss: 0.608 Test Acc: 0.838
Validation loss decreased (-0.787489 --> -0.837494).  Saving model ...
Epoch: 4 cost time: 0.5730161666870117
Epoch: 4, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
Validation loss decreased (-0.837494 --> -0.859371).  Saving model ...
Epoch: 5 cost time: 0.6177713871002197
Epoch: 5, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.607006311416626
Epoch: 6, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6954169273376465
Epoch: 7, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7310819625854492
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6123189926147461
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5634500980377197
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7389631271362305
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6505334377288818
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6857619285583496
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7658770084381104
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1783048
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7985341548919678
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 1.933 Vali Acc: 0.341 Test Loss: 1.933 Test Acc: 0.341
Validation loss decreased (inf --> -0.340606).  Saving model ...
Epoch: 2 cost time: 0.589921236038208
Epoch: 2, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.309 Vali Acc: 0.750 Test Loss: 1.309 Test Acc: 0.750
Validation loss decreased (-0.340606 --> -0.749987).  Saving model ...
Epoch: 3 cost time: 0.6762161254882812
Epoch: 3, Steps: 8 | Train Loss: 0.796 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
Validation loss decreased (-0.749987 --> -0.803117).  Saving model ...
Epoch: 4 cost time: 0.8088788986206055
Epoch: 4, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
Validation loss decreased (-0.803117 --> -0.834370).  Saving model ...
Epoch: 5 cost time: 0.6854496002197266
Epoch: 5, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
Validation loss decreased (-0.834370 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 0.6459708213806152
Epoch: 6, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8711669445037842
Epoch: 7, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6509506702423096
Epoch: 8, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.627281665802002
Epoch: 9, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6093943119049072
Epoch: 10, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7064900398254395
Epoch: 11, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7084529399871826
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7896769046783447
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7949695587158203
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8537023067474365
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1742088
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.953763723373413
Epoch: 1, Steps: 8 | Train Loss: 2.075 Vali Loss: 1.916 Vali Acc: 0.306 Test Loss: 1.916 Test Acc: 0.306
Validation loss decreased (inf --> -0.306231).  Saving model ...
Epoch: 2 cost time: 0.5980372428894043
Epoch: 2, Steps: 8 | Train Loss: 1.598 Vali Loss: 1.443 Vali Acc: 0.772 Test Loss: 1.443 Test Acc: 0.772
Validation loss decreased (-0.306231 --> -0.771861).  Saving model ...
Epoch: 3 cost time: 0.5196056365966797
Epoch: 3, Steps: 8 | Train Loss: 0.958 Vali Loss: 0.923 Vali Acc: 0.825 Test Loss: 0.923 Test Acc: 0.825
Validation loss decreased (-0.771861 --> -0.824991).  Saving model ...
Epoch: 4 cost time: 0.6598756313323975
Epoch: 4, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
Validation loss decreased (-0.824991 --> -0.840619).  Saving model ...
Epoch: 5 cost time: 0.6086940765380859
Epoch: 5, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
Validation loss decreased (-0.840619 --> -0.862495).  Saving model ...
Epoch: 6 cost time: 0.5885775089263916
Epoch: 6, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6011896133422852
Epoch: 7, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.436 Vali Acc: 0.859 Test Loss: 0.436 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.788214921951294
Epoch: 8, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.452 Vali Acc: 0.844 Test Loss: 0.452 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7711312770843506
Epoch: 9, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6617295742034912
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.456 Vali Acc: 0.831 Test Loss: 0.456 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6533021926879883
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.469 Vali Acc: 0.828 Test Loss: 0.469 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6890647411346436
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.473 Vali Acc: 0.828 Test Loss: 0.473 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6996731758117676
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.481 Vali Acc: 0.828 Test Loss: 0.481 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7266714572906494
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6726267337799072
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1709320
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9230635166168213
Epoch: 1, Steps: 8 | Train Loss: 2.110 Vali Loss: 1.966 Vali Acc: 0.253 Test Loss: 1.966 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 0.5897936820983887
Epoch: 2, Steps: 8 | Train Loss: 1.733 Vali Loss: 1.599 Vali Acc: 0.631 Test Loss: 1.599 Test Acc: 0.631
Validation loss decreased (-0.253105 --> -0.631234).  Saving model ...
Epoch: 3 cost time: 0.7257673740386963
Epoch: 3, Steps: 8 | Train Loss: 1.202 Vali Loss: 1.138 Vali Acc: 0.791 Test Loss: 1.138 Test Acc: 0.791
Validation loss decreased (-0.631234 --> -0.790614).  Saving model ...
Epoch: 4 cost time: 0.6226422786712646
Epoch: 4, Steps: 8 | Train Loss: 0.757 Vali Loss: 0.785 Vali Acc: 0.794 Test Loss: 0.785 Test Acc: 0.794
Validation loss decreased (-0.790614 --> -0.793742).  Saving model ...
Epoch: 5 cost time: 0.7180440425872803
Epoch: 5, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
Validation loss decreased (-0.793742 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 0.6926047801971436
Epoch: 6, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.815619 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.6957600116729736
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 0.703434944152832
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.437 Vali Acc: 0.853 Test Loss: 0.437 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7180173397064209
Epoch: 9, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6635890007019043
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6759772300720215
Epoch: 11, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6777248382568359
Epoch: 12, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7050266265869141
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.697136640548706
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6689455509185791
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7161068916320801
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6212525367736816
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 1688584
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8890271186828613
Epoch: 1, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.951 Vali Acc: 0.344 Test Loss: 1.951 Test Acc: 0.344
Validation loss decreased (inf --> -0.343730).  Saving model ...
Epoch: 2 cost time: 0.566328763961792
Epoch: 2, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.632 Vali Acc: 0.669 Test Loss: 1.632 Test Acc: 0.669
Validation loss decreased (-0.343730 --> -0.668734).  Saving model ...
Epoch: 3 cost time: 0.6149091720581055
Epoch: 3, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.227 Vali Acc: 0.794 Test Loss: 1.227 Test Acc: 0.794
Validation loss decreased (-0.668734 --> -0.793738).  Saving model ...
Epoch: 4 cost time: 0.6721682548522949
Epoch: 4, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.888 Vali Acc: 0.812 Test Loss: 0.888 Test Acc: 0.812
Validation loss decreased (-0.793738 --> -0.812491).  Saving model ...
Epoch: 5 cost time: 0.6714174747467041
Epoch: 5, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.669 Vali Acc: 0.819 Test Loss: 0.669 Test Acc: 0.819
Validation loss decreased (-0.812491 --> -0.818743).  Saving model ...
Epoch: 6 cost time: 0.6472995281219482
Epoch: 6, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.6152665615081787
Epoch: 7, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.5894134044647217
Epoch: 8, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.467 Vali Acc: 0.853 Test Loss: 0.467 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.6581315994262695
Epoch: 9, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.6764822006225586
Epoch: 10, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.6308095455169678
Epoch: 11, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.441 Vali Acc: 0.853 Test Loss: 0.441 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5875711441040039
Epoch: 12, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.442 Vali Acc: 0.856 Test Loss: 0.442 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856246).  Saving model ...
Epoch: 13 cost time: 0.573493480682373
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6240143775939941
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5960714817047119
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.555772066116333
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4798922538757324
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.49063611030578613
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6881468296051025
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6589770317077637
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6065773963928223
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.576052188873291
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 1680392
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8933141231536865
Epoch: 1, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.707 Vali Acc: 0.609 Test Loss: 1.707 Test Acc: 0.609
Validation loss decreased (inf --> -0.609358).  Saving model ...
Epoch: 2 cost time: 0.5171842575073242
Epoch: 2, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.873 Vali Acc: 0.797 Test Loss: 0.873 Test Acc: 0.797
Validation loss decreased (-0.609358 --> -0.796866).  Saving model ...
Epoch: 3 cost time: 0.5938146114349365
Epoch: 3, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
Validation loss decreased (-0.796866 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 0.5095295906066895
Epoch: 4, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 0.6010034084320068
Epoch: 5, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5567283630371094
Epoch: 6, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6116135120391846
Epoch: 7, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7905170917510986
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6587262153625488
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6503539085388184
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5675678253173828
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5968179702758789
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6295642852783203
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6349227428436279
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.828 Test Loss: 0.676 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 656008
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6862142086029053
Epoch: 1, Steps: 8 | Train Loss: 2.082 Vali Loss: 1.901 Vali Acc: 0.388 Test Loss: 1.901 Test Acc: 0.388
Validation loss decreased (inf --> -0.387481).  Saving model ...
Epoch: 2 cost time: 0.5988953113555908
Epoch: 2, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.288 Vali Acc: 0.791 Test Loss: 1.288 Test Acc: 0.791
Validation loss decreased (-0.387481 --> -0.790612).  Saving model ...
Epoch: 3 cost time: 0.6179783344268799
Epoch: 3, Steps: 8 | Train Loss: 0.792 Vali Loss: 0.750 Vali Acc: 0.809 Test Loss: 0.750 Test Acc: 0.809
Validation loss decreased (-0.790612 --> -0.809368).  Saving model ...
Epoch: 4 cost time: 0.506183385848999
Epoch: 4, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
Validation loss decreased (-0.809368 --> -0.834370).  Saving model ...
Epoch: 5 cost time: 0.5576050281524658
Epoch: 5, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.834370 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.49671125411987305
Epoch: 6, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5755422115325928
Epoch: 7, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.546330451965332
Epoch: 8, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5220644474029541
Epoch: 9, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5507993698120117
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6492810249328613
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.569516658782959
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7112395763397217
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6128885746002197
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.834 Test Loss: 0.562 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5618672370910645
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 537224
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8348767757415771
Epoch: 1, Steps: 8 | Train Loss: 1.999 Vali Loss: 1.936 Vali Acc: 0.362 Test Loss: 1.936 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 0.5096721649169922
Epoch: 2, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.480 Vali Acc: 0.753 Test Loss: 1.480 Test Acc: 0.753
Validation loss decreased (-0.362481 --> -0.753110).  Saving model ...
Epoch: 3 cost time: 0.6080195903778076
Epoch: 3, Steps: 8 | Train Loss: 0.950 Vali Loss: 0.960 Vali Acc: 0.809 Test Loss: 0.960 Test Acc: 0.809
Validation loss decreased (-0.753110 --> -0.809365).  Saving model ...
Epoch: 4 cost time: 0.5067226886749268
Epoch: 4, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.648 Vali Acc: 0.834 Test Loss: 0.648 Test Acc: 0.834
Validation loss decreased (-0.809365 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 0.5378472805023193
Epoch: 5, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 0.5044729709625244
Epoch: 6, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6175758838653564
Epoch: 7, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.48932385444641113
Epoch: 8, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5302822589874268
Epoch: 9, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5262866020202637
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.831 Test Loss: 0.482 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.474210262298584
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.487 Vali Acc: 0.825 Test Loss: 0.487 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5137612819671631
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.492 Vali Acc: 0.828 Test Loss: 0.492 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6013321876525879
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.493 Vali Acc: 0.831 Test Loss: 0.493 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.61232590675354
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5294187068939209
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 498312
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.891411304473877
Epoch: 1, Steps: 8 | Train Loss: 2.099 Vali Loss: 1.964 Vali Acc: 0.256 Test Loss: 1.964 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 0.5097143650054932
Epoch: 2, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.587 Vali Acc: 0.662 Test Loss: 1.587 Test Acc: 0.662
Validation loss decreased (-0.256230 --> -0.662484).  Saving model ...
Epoch: 3 cost time: 0.5703747272491455
Epoch: 3, Steps: 8 | Train Loss: 1.170 Vali Loss: 1.137 Vali Acc: 0.800 Test Loss: 1.137 Test Acc: 0.800
Validation loss decreased (-0.662484 --> -0.799989).  Saving model ...
Epoch: 4 cost time: 0.5034017562866211
Epoch: 4, Steps: 8 | Train Loss: 0.747 Vali Loss: 0.777 Vali Acc: 0.822 Test Loss: 0.777 Test Acc: 0.822
Validation loss decreased (-0.799989 --> -0.821867).  Saving model ...
Epoch: 5 cost time: 0.5580930709838867
Epoch: 5, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.593 Vali Acc: 0.838 Test Loss: 0.593 Test Acc: 0.838
Validation loss decreased (-0.821867 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.4727180004119873
Epoch: 6, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
Validation loss decreased (-0.837494 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 0.5976123809814453
Epoch: 7, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5225481986999512
Epoch: 8, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 0.5049088001251221
Epoch: 9, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5943179130554199
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5826656818389893
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.452 Vali Acc: 0.853 Test Loss: 0.452 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5632295608520508
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7093727588653564
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6347982883453369
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5683681964874268
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.626542329788208
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5290336608886719
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5825901031494141
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 477832
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.027510643005371
Epoch: 1, Steps: 8 | Train Loss: 2.053 Vali Loss: 1.982 Vali Acc: 0.266 Test Loss: 1.982 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 0.5282800197601318
Epoch: 2, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.707 Vali Acc: 0.644 Test Loss: 1.707 Test Acc: 0.644
Validation loss decreased (-0.265605 --> -0.643733).  Saving model ...
Epoch: 3 cost time: 0.5048489570617676
Epoch: 3, Steps: 8 | Train Loss: 1.376 Vali Loss: 1.337 Vali Acc: 0.753 Test Loss: 1.337 Test Acc: 0.753
Validation loss decreased (-0.643733 --> -0.753112).  Saving model ...
Epoch: 4 cost time: 0.4589240550994873
Epoch: 4, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.981 Vali Acc: 0.816 Test Loss: 0.981 Test Acc: 0.816
Validation loss decreased (-0.753112 --> -0.815615).  Saving model ...
Epoch: 5 cost time: 0.47553586959838867
Epoch: 5, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.734 Vali Acc: 0.834 Test Loss: 0.734 Test Acc: 0.834
Validation loss decreased (-0.815615 --> -0.834368).  Saving model ...
Epoch: 6 cost time: 0.5138545036315918
Epoch: 6, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.592 Vali Acc: 0.834 Test Loss: 0.592 Test Acc: 0.834
Validation loss decreased (-0.834368 --> -0.834369).  Saving model ...
Epoch: 7 cost time: 0.5320961475372314
Epoch: 7, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.834369 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.5720381736755371
Epoch: 8, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.466 Vali Acc: 0.869 Test Loss: 0.466 Test Acc: 0.869
Validation loss decreased (-0.849995 --> -0.868745).  Saving model ...
Epoch: 9 cost time: 0.647958517074585
Epoch: 9, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 10 cost time: 0.5677008628845215
Epoch: 10, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6602575778961182
Epoch: 11, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5094132423400879
Epoch: 12, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.434 Vali Acc: 0.859 Test Loss: 0.434 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7524371147155762
Epoch: 13, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6795542240142822
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.652146577835083
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.444 Vali Acc: 0.853 Test Loss: 0.444 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5215837955474854
Epoch: 16, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6081447601318359
Epoch: 17, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.516819953918457
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5408928394317627
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 461448
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8404500484466553
Epoch: 1, Steps: 8 | Train Loss: 2.081 Vali Loss: 2.012 Vali Acc: 0.197 Test Loss: 2.012 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 0.6176831722259521
Epoch: 2, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.801 Vali Acc: 0.525 Test Loss: 1.801 Test Acc: 0.525
Validation loss decreased (-0.196855 --> -0.524982).  Saving model ...
Epoch: 3 cost time: 0.5681216716766357
Epoch: 3, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.499 Vali Acc: 0.719 Test Loss: 1.499 Test Acc: 0.719
Validation loss decreased (-0.524982 --> -0.718735).  Saving model ...
Epoch: 4 cost time: 0.7428271770477295
Epoch: 4, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.177 Vali Acc: 0.772 Test Loss: 1.177 Test Acc: 0.772
Validation loss decreased (-0.718735 --> -0.771863).  Saving model ...
Epoch: 5 cost time: 0.7704861164093018
Epoch: 5, Steps: 8 | Train Loss: 0.913 Vali Loss: 0.912 Vali Acc: 0.800 Test Loss: 0.912 Test Acc: 0.800
Validation loss decreased (-0.771863 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 0.7778337001800537
Epoch: 6, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.734 Vali Acc: 0.816 Test Loss: 0.734 Test Acc: 0.816
Validation loss decreased (-0.799991 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 0.6051859855651855
Epoch: 7, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 0.5745029449462891
Epoch: 8, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 0.5609304904937744
Epoch: 9, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.6306858062744141
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.5178282260894775
Epoch: 11, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.6546952724456787
Epoch: 12, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.4889202117919922
Epoch: 13, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6094968318939209
Epoch: 14, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7728254795074463
Epoch: 15, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.445 Vali Acc: 0.847 Test Loss: 0.445 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6397933959960938
Epoch: 16, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6116447448730469
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.449 Vali Acc: 0.844 Test Loss: 0.449 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.636925220489502
Epoch: 18, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6895003318786621
Epoch: 19, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5930402278900146
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.450 Vali Acc: 0.844 Test Loss: 0.450 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.632051944732666
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6096627712249756
Epoch: 22, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 451080
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.012712001800537
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.020 Vali Acc: 0.297 Test Loss: 2.020 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 0.6065330505371094
Epoch: 2, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.850 Vali Acc: 0.406 Test Loss: 1.850 Test Acc: 0.406
Validation loss decreased (-0.296855 --> -0.406231).  Saving model ...
Epoch: 3 cost time: 0.5719456672668457
Epoch: 3, Steps: 8 | Train Loss: 1.651 Vali Loss: 1.600 Vali Acc: 0.606 Test Loss: 1.600 Test Acc: 0.606
Validation loss decreased (-0.406231 --> -0.606234).  Saving model ...
Epoch: 4 cost time: 0.6177256107330322
Epoch: 4, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.322 Vali Acc: 0.697 Test Loss: 1.322 Test Acc: 0.697
Validation loss decreased (-0.606234 --> -0.696862).  Saving model ...
Epoch: 5 cost time: 0.6291048526763916
Epoch: 5, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.070 Vali Acc: 0.744 Test Loss: 1.070 Test Acc: 0.744
Validation loss decreased (-0.696862 --> -0.743739).  Saving model ...
Epoch: 6 cost time: 0.602175235748291
Epoch: 6, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.868 Vali Acc: 0.803 Test Loss: 0.868 Test Acc: 0.803
Validation loss decreased (-0.743739 --> -0.803116).  Saving model ...
Epoch: 7 cost time: 0.49758291244506836
Epoch: 7, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.729 Vali Acc: 0.816 Test Loss: 0.729 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 0.5757005214691162
Epoch: 8, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.815618 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.5280015468597412
Epoch: 9, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.579 Vali Acc: 0.838 Test Loss: 0.579 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.5065937042236328
Epoch: 10, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.643033504486084
Epoch: 11, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5924270153045654
Epoch: 12, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 0.6078598499298096
Epoch: 13, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.6235218048095703
Epoch: 14, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.6929018497467041
Epoch: 15, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6001105308532715
Epoch: 16, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6533803939819336
Epoch: 17, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5552873611450195
Epoch: 18, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5912981033325195
Epoch: 19, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.454 Vali Acc: 0.847 Test Loss: 0.454 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7045726776123047
Epoch: 20, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 21 cost time: 0.6743412017822266
Epoch: 21, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5747325420379639
Epoch: 22, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6550602912902832
Epoch: 23, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5903191566467285
Epoch: 24, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
Validation loss decreased (-0.849996 --> -0.853120).  Saving model ...
Epoch: 25 cost time: 0.5637118816375732
Epoch: 25, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.467 Vali Acc: 0.853 Test Loss: 0.467 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5856947898864746
Epoch: 26, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5712954998016357
Epoch: 27, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6153085231781006
Epoch: 28, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4903450012207031
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6102268695831299
Epoch: 30, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5645596981048584
Epoch: 31, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5569846630096436
Epoch: 32, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5567841529846191
Epoch: 33, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5598692893981934
Epoch: 34, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 446984
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9072763919830322
Epoch: 1, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.862 Vali Acc: 0.469 Test Loss: 1.862 Test Acc: 0.469
Validation loss decreased (inf --> -0.468731).  Saving model ...
Epoch: 2 cost time: 0.5258786678314209
Epoch: 2, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.278 Vali Acc: 0.775 Test Loss: 1.278 Test Acc: 0.775
Validation loss decreased (-0.468731 --> -0.774987).  Saving model ...
Epoch: 3 cost time: 0.6504592895507812
Epoch: 3, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.774987 --> -0.824992).  Saving model ...
Epoch: 4 cost time: 0.6220147609710693
Epoch: 4, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.824992 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 0.5327022075653076
Epoch: 5, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.5562992095947266
Epoch: 6, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 0.6181647777557373
Epoch: 7, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6421055793762207
Epoch: 8, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5331170558929443
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6349918842315674
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5704107284545898
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5662026405334473
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.789569616317749
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5357236862182617
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5416064262390137
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5344786643981934
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.605 Vali Acc: 0.831 Test Loss: 0.605 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 229704
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.887821912765503
Epoch: 1, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.950 Vali Acc: 0.344 Test Loss: 1.950 Test Acc: 0.344
Validation loss decreased (inf --> -0.343730).  Saving model ...
Epoch: 2 cost time: 0.5262091159820557
Epoch: 2, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.587 Vali Acc: 0.697 Test Loss: 1.587 Test Acc: 0.697
Validation loss decreased (-0.343730 --> -0.696859).  Saving model ...
Epoch: 3 cost time: 0.5400168895721436
Epoch: 3, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.142 Vali Acc: 0.775 Test Loss: 1.142 Test Acc: 0.775
Validation loss decreased (-0.696859 --> -0.774989).  Saving model ...
Epoch: 4 cost time: 0.581700325012207
Epoch: 4, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 0.6331024169921875
Epoch: 5, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.589 Vali Acc: 0.847 Test Loss: 0.589 Test Acc: 0.847
Validation loss decreased (-0.799992 --> -0.846869).  Saving model ...
Epoch: 6 cost time: 0.6098494529724121
Epoch: 6, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.846869 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.5306320190429688
Epoch: 7, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.5577118396759033
Epoch: 8, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.633669376373291
Epoch: 9, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5758941173553467
Epoch: 10, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.478 Vali Acc: 0.831 Test Loss: 0.478 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6226849555969238
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6087093353271484
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6648869514465332
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5779566764831543
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5770668983459473
Epoch: 15, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7008645534515381
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6010627746582031
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 170312
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6258518695831299
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.057 Vali Acc: 0.128 Test Loss: 2.057 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 0.553516149520874
Epoch: 2, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.844 Vali Acc: 0.481 Test Loss: 1.844 Test Acc: 0.481
Validation loss decreased (-0.128104 --> -0.481232).  Saving model ...
Epoch: 3 cost time: 0.5888559818267822
Epoch: 3, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.501 Vali Acc: 0.662 Test Loss: 1.501 Test Acc: 0.662
Validation loss decreased (-0.481232 --> -0.662485).  Saving model ...
Epoch: 4 cost time: 0.5577821731567383
Epoch: 4, Steps: 8 | Train Loss: 1.074 Vali Loss: 1.132 Vali Acc: 0.759 Test Loss: 1.132 Test Acc: 0.759
Validation loss decreased (-0.662485 --> -0.759364).  Saving model ...
Epoch: 5 cost time: 0.5118210315704346
Epoch: 5, Steps: 8 | Train Loss: 0.778 Vali Loss: 0.835 Vali Acc: 0.797 Test Loss: 0.835 Test Acc: 0.797
Validation loss decreased (-0.759364 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 0.5146870613098145
Epoch: 6, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.652 Vali Acc: 0.834 Test Loss: 0.652 Test Acc: 0.834
Validation loss decreased (-0.796867 --> -0.834368).  Saving model ...
Epoch: 7 cost time: 0.49515461921691895
Epoch: 7, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.5739579200744629
Epoch: 8, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.493 Vali Acc: 0.869 Test Loss: 0.493 Test Acc: 0.869
Validation loss decreased (-0.840620 --> -0.868745).  Saving model ...
Epoch: 9 cost time: 0.7311968803405762
Epoch: 9, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.465 Vali Acc: 0.863 Test Loss: 0.465 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4529297351837158
Epoch: 10, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5569305419921875
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4952843189239502
Epoch: 12, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5995597839355469
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5231835842132568
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.48467564582824707
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.46515536308288574
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.62261962890625
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.46323323249816895
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 150856
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.877856731414795
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 2.028 Vali Acc: 0.228 Test Loss: 2.028 Test Acc: 0.228
Validation loss decreased (inf --> -0.228105).  Saving model ...
Epoch: 2 cost time: 0.5436396598815918
Epoch: 2, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.846 Vali Acc: 0.447 Test Loss: 1.846 Test Acc: 0.447
Validation loss decreased (-0.228105 --> -0.446857).  Saving model ...
Epoch: 3 cost time: 0.6147356033325195
Epoch: 3, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.562 Vali Acc: 0.706 Test Loss: 1.562 Test Acc: 0.706
Validation loss decreased (-0.446857 --> -0.706234).  Saving model ...
Epoch: 4 cost time: 0.5568346977233887
Epoch: 4, Steps: 8 | Train Loss: 1.274 Vali Loss: 1.241 Vali Acc: 0.781 Test Loss: 1.241 Test Acc: 0.781
Validation loss decreased (-0.706234 --> -0.781238).  Saving model ...
Epoch: 5 cost time: 0.49390649795532227
Epoch: 5, Steps: 8 | Train Loss: 0.974 Vali Loss: 0.963 Vali Acc: 0.800 Test Loss: 0.963 Test Acc: 0.800
Validation loss decreased (-0.781238 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.5043973922729492
Epoch: 6, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.775 Vali Acc: 0.816 Test Loss: 0.775 Test Acc: 0.816
Validation loss decreased (-0.799990 --> -0.815617).  Saving model ...
Epoch: 7 cost time: 0.5049164295196533
Epoch: 7, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.644 Vali Acc: 0.816 Test Loss: 0.644 Test Acc: 0.816
Validation loss decreased (-0.815617 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 0.4867734909057617
Epoch: 8, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.562 Vali Acc: 0.847 Test Loss: 0.562 Test Acc: 0.847
Validation loss decreased (-0.815619 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 0.5024397373199463
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.5135800838470459
Epoch: 10, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.5310356616973877
Epoch: 11, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.5586819648742676
Epoch: 12, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4842221736907959
Epoch: 13, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.47357702255249023
Epoch: 14, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5575134754180908
Epoch: 15, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4835638999938965
Epoch: 16, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5631136894226074
Epoch: 17, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5355930328369141
Epoch: 18, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.44695568084716797
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.472 Vali Acc: 0.834 Test Loss: 0.472 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4465148448944092
Epoch: 20, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.472 Vali Acc: 0.834 Test Loss: 0.472 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.49794459342956543
Epoch: 21, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.470 Vali Acc: 0.831 Test Loss: 0.470 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 140616
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8882637023925781
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 2.065 Vali Acc: 0.169 Test Loss: 2.065 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 0.4958004951477051
Epoch: 2, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.927 Vali Acc: 0.275 Test Loss: 1.927 Test Acc: 0.275
Validation loss decreased (-0.168729 --> -0.274981).  Saving model ...
Epoch: 3 cost time: 0.4763762950897217
Epoch: 3, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.703 Vali Acc: 0.550 Test Loss: 1.703 Test Acc: 0.550
Validation loss decreased (-0.274981 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 0.5553536415100098
Epoch: 4, Steps: 8 | Train Loss: 1.491 Vali Loss: 1.439 Vali Acc: 0.713 Test Loss: 1.439 Test Acc: 0.713
Validation loss decreased (-0.549983 --> -0.712486).  Saving model ...
Epoch: 5 cost time: 0.5229406356811523
Epoch: 5, Steps: 8 | Train Loss: 1.180 Vali Loss: 1.180 Vali Acc: 0.784 Test Loss: 1.180 Test Acc: 0.784
Validation loss decreased (-0.712486 --> -0.784363).  Saving model ...
Epoch: 6 cost time: 0.525292158126831
Epoch: 6, Steps: 8 | Train Loss: 0.960 Vali Loss: 0.960 Vali Acc: 0.819 Test Loss: 0.960 Test Acc: 0.819
Validation loss decreased (-0.784363 --> -0.818740).  Saving model ...
Epoch: 7 cost time: 0.5496115684509277
Epoch: 7, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.818740 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.49123644828796387
Epoch: 8, Steps: 8 | Train Loss: 0.606 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
Validation loss decreased (-0.824992 --> -0.828118).  Saving model ...
Epoch: 9 cost time: 0.48108482360839844
Epoch: 9, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
Validation loss decreased (-0.828118 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.5212619304656982
Epoch: 10, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.579979658126831
Epoch: 11, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.6215264797210693
Epoch: 12, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 0.5817656517028809
Epoch: 13, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.5803256034851074
Epoch: 14, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6111857891082764
Epoch: 15, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5802741050720215
Epoch: 16, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5595583915710449
Epoch: 17, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.445 Vali Acc: 0.853 Test Loss: 0.445 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853121).  Saving model ...
Epoch: 18 cost time: 0.5695600509643555
Epoch: 18, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5481369495391846
Epoch: 19, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4647855758666992
Epoch: 20, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.443 Vali Acc: 0.847 Test Loss: 0.443 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.41199469566345215
Epoch: 21, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.543546199798584
Epoch: 22, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.443 Vali Acc: 0.831 Test Loss: 0.443 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.588364839553833
Epoch: 23, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5253055095672607
Epoch: 24, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.455 Vali Acc: 0.831 Test Loss: 0.455 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5335750579833984
Epoch: 25, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.456 Vali Acc: 0.834 Test Loss: 0.456 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5654330253601074
Epoch: 26, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.457 Vali Acc: 0.834 Test Loss: 0.457 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5435011386871338
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.464 Vali Acc: 0.828 Test Loss: 0.464 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 132424
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9226014614105225
Epoch: 1, Steps: 8 | Train Loss: 2.050 Vali Loss: 2.008 Vali Acc: 0.247 Test Loss: 2.008 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.547783374786377
Epoch: 2, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.894 Vali Acc: 0.397 Test Loss: 1.894 Test Acc: 0.397
Validation loss decreased (-0.246855 --> -0.396856).  Saving model ...
Epoch: 3 cost time: 0.5904324054718018
Epoch: 3, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.719 Vali Acc: 0.550 Test Loss: 1.719 Test Acc: 0.550
Validation loss decreased (-0.396856 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 0.5928947925567627
Epoch: 4, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.513 Vali Acc: 0.653 Test Loss: 1.513 Test Acc: 0.653
Validation loss decreased (-0.549983 --> -0.653110).  Saving model ...
Epoch: 5 cost time: 0.554074764251709
Epoch: 5, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.308 Vali Acc: 0.747 Test Loss: 1.308 Test Acc: 0.747
Validation loss decreased (-0.653110 --> -0.746862).  Saving model ...
Epoch: 6 cost time: 0.6280953884124756
Epoch: 6, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.122 Vali Acc: 0.778 Test Loss: 1.122 Test Acc: 0.778
Validation loss decreased (-0.746862 --> -0.778114).  Saving model ...
Epoch: 7 cost time: 0.6479613780975342
Epoch: 7, Steps: 8 | Train Loss: 0.901 Vali Loss: 0.964 Vali Acc: 0.803 Test Loss: 0.964 Test Acc: 0.803
Validation loss decreased (-0.778114 --> -0.803115).  Saving model ...
Epoch: 8 cost time: 0.586400032043457
Epoch: 8, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.833 Vali Acc: 0.828 Test Loss: 0.833 Test Acc: 0.828
Validation loss decreased (-0.803115 --> -0.828117).  Saving model ...
Epoch: 9 cost time: 0.5961027145385742
Epoch: 9, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.733 Vali Acc: 0.828 Test Loss: 0.733 Test Acc: 0.828
Validation loss decreased (-0.828117 --> -0.828118).  Saving model ...
Epoch: 10 cost time: 0.672236442565918
Epoch: 10, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.665 Vali Acc: 0.834 Test Loss: 0.665 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834368).  Saving model ...
Epoch: 11 cost time: 0.5067107677459717
Epoch: 11, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 0.5870308876037598
Epoch: 12, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 0.5351052284240723
Epoch: 13, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5430171489715576
Epoch: 14, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 0.6153459548950195
Epoch: 15, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6727695465087891
Epoch: 16, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5656969547271729
Epoch: 17, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5819685459136963
Epoch: 18, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.482 Vali Acc: 0.834 Test Loss: 0.482 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4903848171234131
Epoch: 19, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4916105270385742
Epoch: 20, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 0.43813276290893555
Epoch: 21, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.48204970359802246
Epoch: 22, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 23 cost time: 0.5523538589477539
Epoch: 23, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4930844306945801
Epoch: 24, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.468 Vali Acc: 0.834 Test Loss: 0.468 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5200212001800537
Epoch: 25, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.509124755859375
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5186707973480225
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5180373191833496
Epoch: 28, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5830953121185303
Epoch: 29, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.452 Vali Acc: 0.838 Test Loss: 0.452 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5603132247924805
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.456 Vali Acc: 0.831 Test Loss: 0.456 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5369052886962891
Epoch: 31, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.464 Vali Acc: 0.831 Test Loss: 0.464 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.48606419563293457
Epoch: 32, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.476 Vali Acc: 0.828 Test Loss: 0.476 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 127240
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.799058437347412
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 2.112 Vali Acc: 0.116 Test Loss: 2.112 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.5217082500457764
Epoch: 2, Steps: 8 | Train Loss: 2.102 Vali Loss: 2.031 Vali Acc: 0.184 Test Loss: 2.031 Test Acc: 0.184
Validation loss decreased (-0.115604 --> -0.184355).  Saving model ...
Epoch: 3 cost time: 0.5148575305938721
Epoch: 3, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.885 Vali Acc: 0.341 Test Loss: 1.885 Test Acc: 0.341
Validation loss decreased (-0.184355 --> -0.340606).  Saving model ...
Epoch: 4 cost time: 0.43548107147216797
Epoch: 4, Steps: 8 | Train Loss: 1.733 Vali Loss: 1.697 Vali Acc: 0.491 Test Loss: 1.697 Test Acc: 0.491
Validation loss decreased (-0.340606 --> -0.490608).  Saving model ...
Epoch: 5 cost time: 0.49785494804382324
Epoch: 5, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.493 Vali Acc: 0.647 Test Loss: 1.493 Test Acc: 0.647
Validation loss decreased (-0.490608 --> -0.646860).  Saving model ...
Epoch: 6 cost time: 0.501549482345581
Epoch: 6, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.303 Vali Acc: 0.734 Test Loss: 1.303 Test Acc: 0.734
Validation loss decreased (-0.646860 --> -0.734362).  Saving model ...
Epoch: 7 cost time: 0.493602991104126
Epoch: 7, Steps: 8 | Train Loss: 1.127 Vali Loss: 1.132 Vali Acc: 0.781 Test Loss: 1.132 Test Acc: 0.781
Validation loss decreased (-0.734362 --> -0.781239).  Saving model ...
Epoch: 8 cost time: 0.5748538970947266
Epoch: 8, Steps: 8 | Train Loss: 0.971 Vali Loss: 0.992 Vali Acc: 0.797 Test Loss: 0.992 Test Acc: 0.797
Validation loss decreased (-0.781239 --> -0.796865).  Saving model ...
Epoch: 9 cost time: 0.4555552005767822
Epoch: 9, Steps: 8 | Train Loss: 0.829 Vali Loss: 0.877 Vali Acc: 0.803 Test Loss: 0.877 Test Acc: 0.803
Validation loss decreased (-0.796865 --> -0.803116).  Saving model ...
Epoch: 10 cost time: 0.5869724750518799
Epoch: 10, Steps: 8 | Train Loss: 0.674 Vali Loss: 0.785 Vali Acc: 0.816 Test Loss: 0.785 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815617).  Saving model ...
Epoch: 11 cost time: 0.5191004276275635
Epoch: 11, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.711 Vali Acc: 0.819 Test Loss: 0.711 Test Acc: 0.819
Validation loss decreased (-0.815617 --> -0.818743).  Saving model ...
Epoch: 12 cost time: 0.5619299411773682
Epoch: 12, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.657 Vali Acc: 0.819 Test Loss: 0.657 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818743).  Saving model ...
Epoch: 13 cost time: 0.4990112781524658
Epoch: 13, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
Validation loss decreased (-0.818743 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 0.611957311630249
Epoch: 14, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.5071942806243896
Epoch: 15, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853119).  Saving model ...
Epoch: 16 cost time: 0.540816068649292
Epoch: 16, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.5989384651184082
Epoch: 17, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5195357799530029
Epoch: 18, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5095353126525879
Epoch: 19, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5827617645263672
Epoch: 20, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5402288436889648
Epoch: 21, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6247045993804932
Epoch: 22, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 23 cost time: 0.6681122779846191
Epoch: 23, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 24 cost time: 0.5321273803710938
Epoch: 24, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6063191890716553
Epoch: 25, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.467 Vali Acc: 0.853 Test Loss: 0.467 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5394167900085449
Epoch: 26, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5704560279846191
Epoch: 27, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5444309711456299
Epoch: 28, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.49909305572509766
Epoch: 29, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.552234411239624
Epoch: 30, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5008158683776855
Epoch: 31, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5971448421478271
Epoch: 32, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5157890319824219
Epoch: 33, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 125192
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6919238567352295
Epoch: 1, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.903 Vali Acc: 0.397 Test Loss: 1.903 Test Acc: 0.397
Validation loss decreased (inf --> -0.396856).  Saving model ...
Epoch: 2 cost time: 0.5176169872283936
Epoch: 2, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.544 Vali Acc: 0.691 Test Loss: 1.544 Test Acc: 0.691
Validation loss decreased (-0.396856 --> -0.690610).  Saving model ...
Epoch: 3 cost time: 0.46942567825317383
Epoch: 3, Steps: 8 | Train Loss: 1.115 Vali Loss: 1.113 Vali Acc: 0.772 Test Loss: 1.113 Test Acc: 0.772
Validation loss decreased (-0.690610 --> -0.771864).  Saving model ...
Epoch: 4 cost time: 0.4815802574157715
Epoch: 4, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.771864 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 0.4585392475128174
Epoch: 5, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
Validation loss decreased (-0.824992 --> -0.843744).  Saving model ...
Epoch: 6 cost time: 0.46430087089538574
Epoch: 6, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.5282011032104492
Epoch: 7, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.4652843475341797
Epoch: 8, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.4745900630950928
Epoch: 9, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5063474178314209
Epoch: 10, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5498325824737549
Epoch: 11, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5125265121459961
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6811892986297607
Epoch: 13, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5291428565979004
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5766513347625732
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5061092376708984
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.526646614074707
Epoch: 17, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5888857841491699
Epoch: 18, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 90280
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.861131191253662
Epoch: 1, Steps: 8 | Train Loss: 2.161 Vali Loss: 2.033 Vali Acc: 0.237 Test Loss: 2.033 Test Acc: 0.237
Validation loss decreased (inf --> -0.237480).  Saving model ...
Epoch: 2 cost time: 0.5355279445648193
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.874 Vali Acc: 0.375 Test Loss: 1.874 Test Acc: 0.375
Validation loss decreased (-0.237480 --> -0.374981).  Saving model ...
Epoch: 3 cost time: 0.48226070404052734
Epoch: 3, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.606 Vali Acc: 0.631 Test Loss: 1.606 Test Acc: 0.631
Validation loss decreased (-0.374981 --> -0.631234).  Saving model ...
Epoch: 4 cost time: 0.5181245803833008
Epoch: 4, Steps: 8 | Train Loss: 1.295 Vali Loss: 1.295 Vali Acc: 0.747 Test Loss: 1.295 Test Acc: 0.747
Validation loss decreased (-0.631234 --> -0.746862).  Saving model ...
Epoch: 5 cost time: 0.48668909072875977
Epoch: 5, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.014 Vali Acc: 0.787 Test Loss: 1.014 Test Acc: 0.787
Validation loss decreased (-0.746862 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.48078179359436035
Epoch: 6, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.787490 --> -0.824992).  Saving model ...
Epoch: 7 cost time: 0.5261759757995605
Epoch: 7, Steps: 8 | Train Loss: 0.594 Vali Loss: 0.669 Vali Acc: 0.847 Test Loss: 0.669 Test Acc: 0.847
Validation loss decreased (-0.824992 --> -0.846868).  Saving model ...
Epoch: 8 cost time: 0.5481486320495605
Epoch: 8, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5183196067810059
Epoch: 9, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4544072151184082
Epoch: 10, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.5107302665710449
Epoch: 11, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5725152492523193
Epoch: 12, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.5548977851867676
Epoch: 13, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 0.5541591644287109
Epoch: 14, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5457839965820312
Epoch: 15, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6678626537322998
Epoch: 16, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5626649856567383
Epoch: 17, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.493 Vali Acc: 0.831 Test Loss: 0.493 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5372922420501709
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.493 Vali Acc: 0.831 Test Loss: 0.493 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5660650730133057
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4641406536102295
Epoch: 20, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6159858703613281
Epoch: 21, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5693473815917969
Epoch: 22, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5224432945251465
Epoch: 23, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 60584
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8532075881958008
Epoch: 1, Steps: 8 | Train Loss: 2.039 Vali Loss: 2.058 Vali Acc: 0.191 Test Loss: 2.058 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 0.5302927494049072
Epoch: 2, Steps: 8 | Train Loss: 1.917 Vali Loss: 1.935 Vali Acc: 0.344 Test Loss: 1.935 Test Acc: 0.344
Validation loss decreased (-0.190604 --> -0.343731).  Saving model ...
Epoch: 3 cost time: 0.4958481788635254
Epoch: 3, Steps: 8 | Train Loss: 1.703 Vali Loss: 1.726 Vali Acc: 0.537 Test Loss: 1.726 Test Acc: 0.537
Validation loss decreased (-0.343731 --> -0.537483).  Saving model ...
Epoch: 4 cost time: 0.46175527572631836
Epoch: 4, Steps: 8 | Train Loss: 1.444 Vali Loss: 1.463 Vali Acc: 0.716 Test Loss: 1.463 Test Acc: 0.716
Validation loss decreased (-0.537483 --> -0.715610).  Saving model ...
Epoch: 5 cost time: 0.5007638931274414
Epoch: 5, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.200 Vali Acc: 0.762 Test Loss: 1.200 Test Acc: 0.762
Validation loss decreased (-0.715610 --> -0.762488).  Saving model ...
Epoch: 6 cost time: 0.4946298599243164
Epoch: 6, Steps: 8 | Train Loss: 0.949 Vali Loss: 0.988 Vali Acc: 0.794 Test Loss: 0.988 Test Acc: 0.794
Validation loss decreased (-0.762488 --> -0.793740).  Saving model ...
Epoch: 7 cost time: 0.5376324653625488
Epoch: 7, Steps: 8 | Train Loss: 0.746 Vali Loss: 0.824 Vali Acc: 0.816 Test Loss: 0.824 Test Acc: 0.816
Validation loss decreased (-0.793740 --> -0.815617).  Saving model ...
Epoch: 8 cost time: 0.5214240550994873
Epoch: 8, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.815617 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.5172333717346191
Epoch: 9, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.633 Vali Acc: 0.834 Test Loss: 0.633 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.5845842361450195
Epoch: 10, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 0.6831405162811279
Epoch: 11, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.5390713214874268
Epoch: 12, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.47248148918151855
Epoch: 13, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 0.47643542289733887
Epoch: 14, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 0.47650623321533203
Epoch: 15, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.5320611000061035
Epoch: 16, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4777872562408447
Epoch: 17, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4647994041442871
Epoch: 18, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.48227787017822266
Epoch: 19, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5568335056304932
Epoch: 20, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5737357139587402
Epoch: 21, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5501883029937744
Epoch: 22, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6582717895507812
Epoch: 23, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5480163097381592
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6594874858856201
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 50856
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9141907691955566
Epoch: 1, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.964 Vali Acc: 0.328 Test Loss: 1.964 Test Acc: 0.328
Validation loss decreased (inf --> -0.328105).  Saving model ...
Epoch: 2 cost time: 0.599933385848999
Epoch: 2, Steps: 8 | Train Loss: 1.894 Vali Loss: 1.867 Vali Acc: 0.406 Test Loss: 1.867 Test Acc: 0.406
Validation loss decreased (-0.328105 --> -0.406231).  Saving model ...
Epoch: 3 cost time: 0.5924851894378662
Epoch: 3, Steps: 8 | Train Loss: 1.728 Vali Loss: 1.707 Vali Acc: 0.525 Test Loss: 1.707 Test Acc: 0.525
Validation loss decreased (-0.406231 --> -0.524983).  Saving model ...
Epoch: 4 cost time: 0.48100829124450684
Epoch: 4, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.506 Vali Acc: 0.650 Test Loss: 1.506 Test Acc: 0.650
Validation loss decreased (-0.524983 --> -0.649985).  Saving model ...
Epoch: 5 cost time: 0.6088683605194092
Epoch: 5, Steps: 8 | Train Loss: 1.303 Vali Loss: 1.307 Vali Acc: 0.731 Test Loss: 1.307 Test Acc: 0.731
Validation loss decreased (-0.649985 --> -0.731237).  Saving model ...
Epoch: 6 cost time: 0.5786232948303223
Epoch: 6, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.124 Vali Acc: 0.750 Test Loss: 1.124 Test Acc: 0.750
Validation loss decreased (-0.731237 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.6204738616943359
Epoch: 7, Steps: 8 | Train Loss: 0.929 Vali Loss: 0.967 Vali Acc: 0.787 Test Loss: 0.967 Test Acc: 0.787
Validation loss decreased (-0.749989 --> -0.787490).  Saving model ...
Epoch: 8 cost time: 0.5323195457458496
Epoch: 8, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.839 Vali Acc: 0.806 Test Loss: 0.839 Test Acc: 0.806
Validation loss decreased (-0.787490 --> -0.806242).  Saving model ...
Epoch: 9 cost time: 0.6717309951782227
Epoch: 9, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.743 Vali Acc: 0.806 Test Loss: 0.743 Test Acc: 0.806
Validation loss decreased (-0.806242 --> -0.806243).  Saving model ...
Epoch: 10 cost time: 0.5207936763763428
Epoch: 10, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.678 Vali Acc: 0.819 Test Loss: 0.678 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818743).  Saving model ...
Epoch: 11 cost time: 0.5055897235870361
Epoch: 11, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
Validation loss decreased (-0.818743 --> -0.837494).  Saving model ...
Epoch: 12 cost time: 0.47029709815979004
Epoch: 12, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 13 cost time: 0.4812047481536865
Epoch: 13, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 0.5025274753570557
Epoch: 14, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 0.49379920959472656
Epoch: 15, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.4481186866760254
Epoch: 16, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.6654036045074463
Epoch: 17, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.6810431480407715
Epoch: 18, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.511716365814209
Epoch: 19, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5301744937896729
Epoch: 20, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 0.6438169479370117
Epoch: 21, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 22 cost time: 0.5753791332244873
Epoch: 22, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5927267074584961
Epoch: 23, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6191682815551758
Epoch: 24, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.619438886642456
Epoch: 25, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6603076457977295
Epoch: 26, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.478 Vali Acc: 0.859 Test Loss: 0.478 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 27 cost time: 0.6663053035736084
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 28 cost time: 0.5655648708343506
Epoch: 28, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.498171329498291
Epoch: 29, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.507073163986206
Epoch: 30, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5698966979980469
Epoch: 31, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5658478736877441
Epoch: 32, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.46991896629333496
Epoch: 33, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.49730873107910156
Epoch: 34, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5997846126556396
Epoch: 35, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4698331356048584
Epoch: 36, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.552088737487793
Epoch: 37, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 45736
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7827296257019043
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.025 Vali Acc: 0.212 Test Loss: 2.025 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.608879566192627
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.949 Vali Acc: 0.328 Test Loss: 1.949 Test Acc: 0.328
Validation loss decreased (-0.212480 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 0.48258090019226074
Epoch: 3, Steps: 8 | Train Loss: 1.867 Vali Loss: 1.831 Vali Acc: 0.459 Test Loss: 1.831 Test Acc: 0.459
Validation loss decreased (-0.328106 --> -0.459357).  Saving model ...
Epoch: 4 cost time: 0.5866515636444092
Epoch: 4, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.680 Vali Acc: 0.588 Test Loss: 1.680 Test Acc: 0.588
Validation loss decreased (-0.459357 --> -0.587483).  Saving model ...
Epoch: 5 cost time: 0.5053880214691162
Epoch: 5, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.513 Vali Acc: 0.684 Test Loss: 1.513 Test Acc: 0.684
Validation loss decreased (-0.587483 --> -0.684360).  Saving model ...
Epoch: 6 cost time: 0.474926233291626
Epoch: 6, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.349 Vali Acc: 0.734 Test Loss: 1.349 Test Acc: 0.734
Validation loss decreased (-0.684360 --> -0.734362).  Saving model ...
Epoch: 7 cost time: 0.46918320655822754
Epoch: 7, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.190 Vali Acc: 0.756 Test Loss: 1.190 Test Acc: 0.756
Validation loss decreased (-0.734362 --> -0.756238).  Saving model ...
Epoch: 8 cost time: 0.4985973834991455
Epoch: 8, Steps: 8 | Train Loss: 1.049 Vali Loss: 1.054 Vali Acc: 0.772 Test Loss: 1.054 Test Acc: 0.772
Validation loss decreased (-0.756238 --> -0.771864).  Saving model ...
Epoch: 9 cost time: 0.5226931571960449
Epoch: 9, Steps: 8 | Train Loss: 0.916 Vali Loss: 0.936 Vali Acc: 0.781 Test Loss: 0.936 Test Acc: 0.781
Validation loss decreased (-0.771864 --> -0.781241).  Saving model ...
Epoch: 10 cost time: 0.6019458770751953
Epoch: 10, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.837 Vali Acc: 0.800 Test Loss: 0.837 Test Acc: 0.800
Validation loss decreased (-0.781241 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.5601050853729248
Epoch: 11, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.759 Vali Acc: 0.819 Test Loss: 0.759 Test Acc: 0.819
Validation loss decreased (-0.799992 --> -0.818742).  Saving model ...
Epoch: 12 cost time: 0.5170433521270752
Epoch: 12, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
Validation loss decreased (-0.818742 --> -0.828118).  Saving model ...
Epoch: 13 cost time: 0.49979138374328613
Epoch: 13, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.659 Vali Acc: 0.838 Test Loss: 0.659 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837493).  Saving model ...
Epoch: 14 cost time: 0.5667645931243896
Epoch: 14, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.620 Vali Acc: 0.838 Test Loss: 0.620 Test Acc: 0.838
Validation loss decreased (-0.837493 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 0.5304436683654785
Epoch: 15, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.593 Vali Acc: 0.831 Test Loss: 0.593 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6075549125671387
Epoch: 16, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 17 cost time: 0.5635554790496826
Epoch: 17, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 0.4909636974334717
Epoch: 18, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 0.5518167018890381
Epoch: 19, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5115635395050049
Epoch: 20, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.46765637397766113
Epoch: 21, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5515921115875244
Epoch: 22, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5726995468139648
Epoch: 23, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.458599328994751
Epoch: 24, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.45305466651916504
Epoch: 25, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5974915027618408
Epoch: 26, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4561197757720947
Epoch: 27, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.59438157081604
Epoch: 28, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 41640
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8081419467926025
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.075 Vali Acc: 0.106 Test Loss: 2.075 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 0.49816203117370605
Epoch: 2, Steps: 8 | Train Loss: 2.049 Vali Loss: 2.018 Vali Acc: 0.169 Test Loss: 2.018 Test Acc: 0.169
Validation loss decreased (-0.106229 --> -0.168730).  Saving model ...
Epoch: 3 cost time: 0.4830455780029297
Epoch: 3, Steps: 8 | Train Loss: 1.945 Vali Loss: 1.924 Vali Acc: 0.331 Test Loss: 1.924 Test Acc: 0.331
Validation loss decreased (-0.168730 --> -0.331231).  Saving model ...
Epoch: 4 cost time: 0.48871850967407227
Epoch: 4, Steps: 8 | Train Loss: 1.828 Vali Loss: 1.799 Vali Acc: 0.463 Test Loss: 1.799 Test Acc: 0.463
Validation loss decreased (-0.331231 --> -0.462482).  Saving model ...
Epoch: 5 cost time: 0.5020053386688232
Epoch: 5, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.661 Vali Acc: 0.594 Test Loss: 1.661 Test Acc: 0.594
Validation loss decreased (-0.462482 --> -0.593733).  Saving model ...
Epoch: 6 cost time: 0.6097347736358643
Epoch: 6, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.520 Vali Acc: 0.647 Test Loss: 1.520 Test Acc: 0.647
Validation loss decreased (-0.593733 --> -0.646860).  Saving model ...
Epoch: 7 cost time: 0.45258569717407227
Epoch: 7, Steps: 8 | Train Loss: 1.391 Vali Loss: 1.389 Vali Acc: 0.706 Test Loss: 1.389 Test Acc: 0.706
Validation loss decreased (-0.646860 --> -0.706236).  Saving model ...
Epoch: 8 cost time: 0.5434780120849609
Epoch: 8, Steps: 8 | Train Loss: 1.261 Vali Loss: 1.264 Vali Acc: 0.738 Test Loss: 1.264 Test Acc: 0.738
Validation loss decreased (-0.706236 --> -0.737487).  Saving model ...
Epoch: 9 cost time: 0.5451223850250244
Epoch: 9, Steps: 8 | Train Loss: 1.101 Vali Loss: 1.151 Vali Acc: 0.756 Test Loss: 1.151 Test Acc: 0.756
Validation loss decreased (-0.737487 --> -0.756238).  Saving model ...
Epoch: 10 cost time: 0.44049954414367676
Epoch: 10, Steps: 8 | Train Loss: 0.990 Vali Loss: 1.045 Vali Acc: 0.769 Test Loss: 1.045 Test Acc: 0.769
Validation loss decreased (-0.756238 --> -0.768740).  Saving model ...
Epoch: 11 cost time: 0.6134810447692871
Epoch: 11, Steps: 8 | Train Loss: 0.873 Vali Loss: 0.948 Vali Acc: 0.772 Test Loss: 0.948 Test Acc: 0.772
Validation loss decreased (-0.768740 --> -0.771866).  Saving model ...
Epoch: 12 cost time: 0.47877001762390137
Epoch: 12, Steps: 8 | Train Loss: 0.785 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.771866 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.47179698944091797
Epoch: 13, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.802 Vali Acc: 0.812 Test Loss: 0.802 Test Acc: 0.812
Validation loss decreased (-0.799991 --> -0.812492).  Saving model ...
Epoch: 14 cost time: 0.39472246170043945
Epoch: 14, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821868).  Saving model ...
Epoch: 15 cost time: 0.4961385726928711
Epoch: 15, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.708 Vali Acc: 0.831 Test Loss: 0.708 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831243).  Saving model ...
Epoch: 16 cost time: 0.4461493492126465
Epoch: 16, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.671 Vali Acc: 0.828 Test Loss: 0.671 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.48145389556884766
Epoch: 17, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4830968379974365
Epoch: 18, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.612 Vali Acc: 0.831 Test Loss: 0.612 Test Acc: 0.831
Validation loss decreased (-0.831243 --> -0.831244).  Saving model ...
Epoch: 19 cost time: 0.5378482341766357
Epoch: 19, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.590 Vali Acc: 0.834 Test Loss: 0.590 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 20 cost time: 0.5054361820220947
Epoch: 20, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.570 Vali Acc: 0.838 Test Loss: 0.570 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 21 cost time: 0.5644512176513672
Epoch: 21, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 22 cost time: 0.5831005573272705
Epoch: 22, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5071899890899658
Epoch: 23, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.47713446617126465
Epoch: 24, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5674798488616943
Epoch: 25, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5502750873565674
Epoch: 26, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5357258319854736
Epoch: 27, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.530494213104248
Epoch: 28, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5100436210632324
Epoch: 29, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5337791442871094
Epoch: 30, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5465681552886963
Epoch: 31, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.47515249252319336
Epoch: 32, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5916686058044434
Epoch: 33, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 39048
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9458563327789307
Epoch: 1, Steps: 8 | Train Loss: 2.089 Vali Loss: 2.065 Vali Acc: 0.181 Test Loss: 2.065 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 0.5497419834136963
Epoch: 2, Steps: 8 | Train Loss: 2.026 Vali Loss: 2.014 Vali Acc: 0.219 Test Loss: 2.014 Test Acc: 0.219
Validation loss decreased (-0.181229 --> -0.218730).  Saving model ...
Epoch: 3 cost time: 0.6070206165313721
Epoch: 3, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.923 Vali Acc: 0.297 Test Loss: 1.923 Test Acc: 0.297
Validation loss decreased (-0.218730 --> -0.296856).  Saving model ...
Epoch: 4 cost time: 0.49750304222106934
Epoch: 4, Steps: 8 | Train Loss: 1.816 Vali Loss: 1.807 Vali Acc: 0.384 Test Loss: 1.807 Test Acc: 0.384
Validation loss decreased (-0.296856 --> -0.384357).  Saving model ...
Epoch: 5 cost time: 0.5654613971710205
Epoch: 5, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.679 Vali Acc: 0.509 Test Loss: 1.679 Test Acc: 0.509
Validation loss decreased (-0.384357 --> -0.509358).  Saving model ...
Epoch: 6 cost time: 0.5649237632751465
Epoch: 6, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.550 Vali Acc: 0.609 Test Loss: 1.550 Test Acc: 0.609
Validation loss decreased (-0.509358 --> -0.609359).  Saving model ...
Epoch: 7 cost time: 0.5164988040924072
Epoch: 7, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.429 Vali Acc: 0.691 Test Loss: 1.429 Test Acc: 0.691
Validation loss decreased (-0.609359 --> -0.690611).  Saving model ...
Epoch: 8 cost time: 0.4784727096557617
Epoch: 8, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.309 Vali Acc: 0.750 Test Loss: 1.309 Test Acc: 0.750
Validation loss decreased (-0.690611 --> -0.749987).  Saving model ...
Epoch: 9 cost time: 0.47071075439453125
Epoch: 9, Steps: 8 | Train Loss: 1.147 Vali Loss: 1.196 Vali Acc: 0.775 Test Loss: 1.196 Test Acc: 0.775
Validation loss decreased (-0.749987 --> -0.774988).  Saving model ...
Epoch: 10 cost time: 0.48623061180114746
Epoch: 10, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.092 Vali Acc: 0.787 Test Loss: 1.092 Test Acc: 0.787
Validation loss decreased (-0.774988 --> -0.787489).  Saving model ...
Epoch: 11 cost time: 0.4233698844909668
Epoch: 11, Steps: 8 | Train Loss: 0.953 Vali Loss: 1.005 Vali Acc: 0.803 Test Loss: 1.005 Test Acc: 0.803
Validation loss decreased (-0.787489 --> -0.803115).  Saving model ...
Epoch: 12 cost time: 0.5337519645690918
Epoch: 12, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.934 Vali Acc: 0.809 Test Loss: 0.934 Test Acc: 0.809
Validation loss decreased (-0.803115 --> -0.809366).  Saving model ...
Epoch: 13 cost time: 0.46888279914855957
Epoch: 13, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.869 Vali Acc: 0.812 Test Loss: 0.869 Test Acc: 0.812
Validation loss decreased (-0.809366 --> -0.812491).  Saving model ...
Epoch: 14 cost time: 0.5190036296844482
Epoch: 14, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.811 Vali Acc: 0.819 Test Loss: 0.811 Test Acc: 0.819
Validation loss decreased (-0.812491 --> -0.818742).  Saving model ...
Epoch: 15 cost time: 0.5411036014556885
Epoch: 15, Steps: 8 | Train Loss: 0.656 Vali Loss: 0.763 Vali Acc: 0.831 Test Loss: 0.763 Test Acc: 0.831
Validation loss decreased (-0.818742 --> -0.831242).  Saving model ...
Epoch: 16 cost time: 0.5373191833496094
Epoch: 16, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.721 Vali Acc: 0.834 Test Loss: 0.721 Test Acc: 0.834
Validation loss decreased (-0.831242 --> -0.834368).  Saving model ...
Epoch: 17 cost time: 0.5239105224609375
Epoch: 17, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.686 Vali Acc: 0.841 Test Loss: 0.686 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840618).  Saving model ...
Epoch: 18 cost time: 0.5017759799957275
Epoch: 18, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.657 Vali Acc: 0.847 Test Loss: 0.657 Test Acc: 0.847
Validation loss decreased (-0.840618 --> -0.846868).  Saving model ...
Epoch: 19 cost time: 0.46428418159484863
Epoch: 19, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5211904048919678
Epoch: 20, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5041067600250244
Epoch: 21, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.49085068702697754
Epoch: 22, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.565 Vali Acc: 0.838 Test Loss: 0.565 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5460875034332275
Epoch: 23, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.49910783767700195
Epoch: 24, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5231490135192871
Epoch: 25, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
Validation loss decreased (-0.846868 --> -0.846870).  Saving model ...
Epoch: 26 cost time: 0.4457073211669922
Epoch: 26, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 27 cost time: 0.5078649520874023
Epoch: 27, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.5231635570526123
Epoch: 28, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5023293495178223
Epoch: 29, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.478226900100708
Epoch: 30, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.5221655368804932
Epoch: 31, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5081233978271484
Epoch: 32, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.47748756408691406
Epoch: 33, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.46727752685546875
Epoch: 34, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.42574095726013184
Epoch: 35, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 36 cost time: 0.6006495952606201
Epoch: 36, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.49814486503601074
Epoch: 37, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.454 Vali Acc: 0.847 Test Loss: 0.454 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5546994209289551
Epoch: 38, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.529503583908081
Epoch: 39, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5149936676025391
Epoch: 40, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6597671508789062
Epoch: 41, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5708706378936768
Epoch: 42, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5797507762908936
Epoch: 43, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.4822349548339844
Epoch: 44, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.4940755367279053
Epoch: 45, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 38024
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9371449947357178
Epoch: 1, Steps: 8 | Train Loss: 2.056 Vali Loss: 2.008 Vali Acc: 0.222 Test Loss: 2.008 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 0.5714874267578125
Epoch: 2, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.865 Vali Acc: 0.650 Test Loss: 1.865 Test Acc: 0.650
Validation loss decreased (-0.221855 --> -0.649981).  Saving model ...
Epoch: 3 cost time: 0.6260411739349365
Epoch: 3, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.602 Vali Acc: 0.762 Test Loss: 1.602 Test Acc: 0.762
Validation loss decreased (-0.649981 --> -0.762484).  Saving model ...
Epoch: 4 cost time: 0.5669937133789062
Epoch: 4, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.241 Vali Acc: 0.781 Test Loss: 1.241 Test Acc: 0.781
Validation loss decreased (-0.762484 --> -0.781238).  Saving model ...
Epoch: 5 cost time: 0.6568503379821777
Epoch: 5, Steps: 8 | Train Loss: 0.914 Vali Loss: 0.874 Vali Acc: 0.816 Test Loss: 0.874 Test Acc: 0.816
Validation loss decreased (-0.781238 --> -0.815616).  Saving model ...
Epoch: 6 cost time: 0.6650922298431396
Epoch: 6, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
Validation loss decreased (-0.815616 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.6107254028320312
Epoch: 7, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.6107223033905029
Epoch: 8, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 0.64119553565979
Epoch: 9, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.705895185470581
Epoch: 10, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 0.6118886470794678
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6110625267028809
Epoch: 12, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7023553848266602
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7037672996520996
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6402158737182617
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5791473388671875
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6254692077636719
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6284801959991455
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.589 Vali Acc: 0.838 Test Loss: 0.589 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5901470184326172
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.841 Test Loss: 0.606 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.612084150314331
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 368040
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9739627838134766
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.057 Vali Acc: 0.194 Test Loss: 2.057 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.6527271270751953
Epoch: 2, Steps: 8 | Train Loss: 1.985 Vali Loss: 1.975 Vali Acc: 0.375 Test Loss: 1.975 Test Acc: 0.375
Validation loss decreased (-0.193729 --> -0.374980).  Saving model ...
Epoch: 3 cost time: 0.6427409648895264
Epoch: 3, Steps: 8 | Train Loss: 1.831 Vali Loss: 1.821 Vali Acc: 0.662 Test Loss: 1.821 Test Acc: 0.662
Validation loss decreased (-0.374980 --> -0.662482).  Saving model ...
Epoch: 4 cost time: 0.6830246448516846
Epoch: 4, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.595 Vali Acc: 0.747 Test Loss: 1.595 Test Acc: 0.747
Validation loss decreased (-0.662482 --> -0.746859).  Saving model ...
Epoch: 5 cost time: 0.6413173675537109
Epoch: 5, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.315 Vali Acc: 0.781 Test Loss: 1.315 Test Acc: 0.781
Validation loss decreased (-0.746859 --> -0.781237).  Saving model ...
Epoch: 6 cost time: 0.7232182025909424
Epoch: 6, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.029 Vali Acc: 0.803 Test Loss: 1.029 Test Acc: 0.803
Validation loss decreased (-0.781237 --> -0.803115).  Saving model ...
Epoch: 7 cost time: 0.693408727645874
Epoch: 7, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
Validation loss decreased (-0.803115 --> -0.803117).  Saving model ...
Epoch: 8 cost time: 0.6252071857452393
Epoch: 8, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
Validation loss decreased (-0.803117 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.6855471134185791
Epoch: 9, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 0.6410031318664551
Epoch: 10, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 0.669475793838501
Epoch: 11, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 0.6596424579620361
Epoch: 12, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.6424658298492432
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5713293552398682
Epoch: 14, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6483440399169922
Epoch: 15, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6166825294494629
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.48686814308166504
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5886542797088623
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.569749116897583
Epoch: 19, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6236269474029541
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.636643648147583
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5906262397766113
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 337576
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0175390243530273
Epoch: 1, Steps: 8 | Train Loss: 2.071 Vali Loss: 2.053 Vali Acc: 0.156 Test Loss: 2.053 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.7128739356994629
Epoch: 2, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.992 Vali Acc: 0.300 Test Loss: 1.992 Test Acc: 0.300
Validation loss decreased (-0.156229 --> -0.299980).  Saving model ...
Epoch: 3 cost time: 0.6282072067260742
Epoch: 3, Steps: 8 | Train Loss: 1.868 Vali Loss: 1.877 Vali Acc: 0.588 Test Loss: 1.877 Test Acc: 0.588
Validation loss decreased (-0.299980 --> -0.587481).  Saving model ...
Epoch: 4 cost time: 0.6297481060028076
Epoch: 4, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.709 Vali Acc: 0.706 Test Loss: 1.709 Test Acc: 0.706
Validation loss decreased (-0.587481 --> -0.706233).  Saving model ...
Epoch: 5 cost time: 0.6726272106170654
Epoch: 5, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.496 Vali Acc: 0.756 Test Loss: 1.496 Test Acc: 0.756
Validation loss decreased (-0.706233 --> -0.756235).  Saving model ...
Epoch: 6 cost time: 0.5803306102752686
Epoch: 6, Steps: 8 | Train Loss: 1.268 Vali Loss: 1.265 Vali Acc: 0.784 Test Loss: 1.265 Test Acc: 0.784
Validation loss decreased (-0.756235 --> -0.784362).  Saving model ...
Epoch: 7 cost time: 0.5799322128295898
Epoch: 7, Steps: 8 | Train Loss: 1.064 Vali Loss: 1.039 Vali Acc: 0.797 Test Loss: 1.039 Test Acc: 0.797
Validation loss decreased (-0.784362 --> -0.796865).  Saving model ...
Epoch: 8 cost time: 0.6552066802978516
Epoch: 8, Steps: 8 | Train Loss: 0.826 Vali Loss: 0.844 Vali Acc: 0.797 Test Loss: 0.844 Test Acc: 0.797
Validation loss decreased (-0.796865 --> -0.796867).  Saving model ...
Epoch: 9 cost time: 0.5705769062042236
Epoch: 9, Steps: 8 | Train Loss: 0.630 Vali Loss: 0.695 Vali Acc: 0.812 Test Loss: 0.695 Test Acc: 0.812
Validation loss decreased (-0.796867 --> -0.812493).  Saving model ...
Epoch: 10 cost time: 0.549365758895874
Epoch: 10, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.583 Vali Acc: 0.834 Test Loss: 0.583 Test Acc: 0.834
Validation loss decreased (-0.812493 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 0.6051907539367676
Epoch: 11, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.5614767074584961
Epoch: 12, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 0.6085684299468994
Epoch: 13, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 0.6478898525238037
Epoch: 14, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.608726978302002
Epoch: 15, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.6476140022277832
Epoch: 16, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.606365442276001
Epoch: 17, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6753666400909424
Epoch: 18, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6618735790252686
Epoch: 19, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6441051959991455
Epoch: 20, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6112861633300781
Epoch: 21, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.648371696472168
Epoch: 22, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6216404438018799
Epoch: 23, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5594942569732666
Epoch: 24, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6440296173095703
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 328616
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.994685411453247
Epoch: 1, Steps: 8 | Train Loss: 2.127 Vali Loss: 2.086 Vali Acc: 0.131 Test Loss: 2.086 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.5747499465942383
Epoch: 2, Steps: 8 | Train Loss: 2.069 Vali Loss: 2.043 Vali Acc: 0.188 Test Loss: 2.043 Test Acc: 0.188
Validation loss decreased (-0.131229 --> -0.187480).  Saving model ...
Epoch: 3 cost time: 0.6265926361083984
Epoch: 3, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.952 Vali Acc: 0.319 Test Loss: 1.952 Test Acc: 0.319
Validation loss decreased (-0.187480 --> -0.318730).  Saving model ...
Epoch: 4 cost time: 0.6071767807006836
Epoch: 4, Steps: 8 | Train Loss: 1.812 Vali Loss: 1.813 Vali Acc: 0.606 Test Loss: 1.813 Test Acc: 0.606
Validation loss decreased (-0.318730 --> -0.606232).  Saving model ...
Epoch: 5 cost time: 0.7440569400787354
Epoch: 5, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.640 Vali Acc: 0.725 Test Loss: 1.640 Test Acc: 0.725
Validation loss decreased (-0.606232 --> -0.724984).  Saving model ...
Epoch: 6 cost time: 0.651848554611206
Epoch: 6, Steps: 8 | Train Loss: 1.473 Vali Loss: 1.434 Vali Acc: 0.772 Test Loss: 1.434 Test Acc: 0.772
Validation loss decreased (-0.724984 --> -0.771861).  Saving model ...
Epoch: 7 cost time: 0.6450009346008301
Epoch: 7, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.222 Vali Acc: 0.791 Test Loss: 1.222 Test Acc: 0.791
Validation loss decreased (-0.771861 --> -0.790613).  Saving model ...
Epoch: 8 cost time: 0.6385238170623779
Epoch: 8, Steps: 8 | Train Loss: 1.065 Vali Loss: 1.013 Vali Acc: 0.803 Test Loss: 1.013 Test Acc: 0.803
Validation loss decreased (-0.790613 --> -0.803115).  Saving model ...
Epoch: 9 cost time: 0.6373312473297119
Epoch: 9, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.830 Vali Acc: 0.812 Test Loss: 0.830 Test Acc: 0.812
Validation loss decreased (-0.803115 --> -0.812492).  Saving model ...
Epoch: 10 cost time: 0.6163029670715332
Epoch: 10, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.695 Vali Acc: 0.838 Test Loss: 0.695 Test Acc: 0.838
Validation loss decreased (-0.812492 --> -0.837493).  Saving model ...
Epoch: 11 cost time: 0.6298353672027588
Epoch: 11, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
Validation loss decreased (-0.837493 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 0.7027184963226318
Epoch: 12, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 0.7152199745178223
Epoch: 13, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 14 cost time: 0.6849305629730225
Epoch: 14, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 0.6718075275421143
Epoch: 15, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.461 Vali Acc: 0.866 Test Loss: 0.461 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 0.6672360897064209
Epoch: 16, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.447 Vali Acc: 0.866 Test Loss: 0.447 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865621).  Saving model ...
Epoch: 17 cost time: 0.6170907020568848
Epoch: 17, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
Validation loss decreased (-0.865621 --> -0.871871).  Saving model ...
Epoch: 18 cost time: 0.6018962860107422
Epoch: 18, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.445 Vali Acc: 0.863 Test Loss: 0.445 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6481354236602783
Epoch: 19, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.445 Vali Acc: 0.859 Test Loss: 0.445 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6433568000793457
Epoch: 20, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7593293190002441
Epoch: 21, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6918461322784424
Epoch: 22, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6091914176940918
Epoch: 23, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6300570964813232
Epoch: 24, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7291033267974854
Epoch: 25, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7619109153747559
Epoch: 26, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7018306255340576
Epoch: 27, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 322728
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.824700117111206
Epoch: 1, Steps: 8 | Train Loss: 2.071 Vali Loss: 2.058 Vali Acc: 0.222 Test Loss: 2.058 Test Acc: 0.222
Validation loss decreased (inf --> -0.221854).  Saving model ...
Epoch: 2 cost time: 0.6990633010864258
Epoch: 2, Steps: 8 | Train Loss: 2.016 Vali Loss: 2.012 Vali Acc: 0.359 Test Loss: 2.012 Test Acc: 0.359
Validation loss decreased (-0.221854 --> -0.359355).  Saving model ...
Epoch: 3 cost time: 0.7065463066101074
Epoch: 3, Steps: 8 | Train Loss: 1.918 Vali Loss: 1.920 Vali Acc: 0.503 Test Loss: 1.920 Test Acc: 0.503
Validation loss decreased (-0.359355 --> -0.503106).  Saving model ...
Epoch: 4 cost time: 0.709604024887085
Epoch: 4, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.790 Vali Acc: 0.641 Test Loss: 1.790 Test Acc: 0.641
Validation loss decreased (-0.503106 --> -0.640607).  Saving model ...
Epoch: 5 cost time: 0.6086239814758301
Epoch: 5, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.631 Vali Acc: 0.706 Test Loss: 1.631 Test Acc: 0.706
Validation loss decreased (-0.640607 --> -0.706234).  Saving model ...
Epoch: 6 cost time: 0.7359602451324463
Epoch: 6, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.451 Vali Acc: 0.738 Test Loss: 1.451 Test Acc: 0.738
Validation loss decreased (-0.706234 --> -0.737485).  Saving model ...
Epoch: 7 cost time: 0.6904315948486328
Epoch: 7, Steps: 8 | Train Loss: 1.297 Vali Loss: 1.263 Vali Acc: 0.778 Test Loss: 1.263 Test Acc: 0.778
Validation loss decreased (-0.737485 --> -0.778112).  Saving model ...
Epoch: 8 cost time: 0.6410717964172363
Epoch: 8, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.078 Vali Acc: 0.797 Test Loss: 1.078 Test Acc: 0.797
Validation loss decreased (-0.778112 --> -0.796864).  Saving model ...
Epoch: 9 cost time: 0.6479287147521973
Epoch: 9, Steps: 8 | Train Loss: 0.915 Vali Loss: 0.915 Vali Acc: 0.806 Test Loss: 0.915 Test Acc: 0.806
Validation loss decreased (-0.796864 --> -0.806241).  Saving model ...
Epoch: 10 cost time: 0.5875427722930908
Epoch: 10, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.779 Vali Acc: 0.822 Test Loss: 0.779 Test Acc: 0.822
Validation loss decreased (-0.806241 --> -0.821867).  Saving model ...
Epoch: 11 cost time: 0.5251169204711914
Epoch: 11, Steps: 8 | Train Loss: 0.613 Vali Loss: 0.674 Vali Acc: 0.834 Test Loss: 0.674 Test Acc: 0.834
Validation loss decreased (-0.821867 --> -0.834368).  Saving model ...
Epoch: 12 cost time: 0.5837807655334473
Epoch: 12, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
Validation loss decreased (-0.834368 --> -0.856244).  Saving model ...
Epoch: 13 cost time: 0.5938692092895508
Epoch: 13, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.560 Vali Acc: 0.853 Test Loss: 0.560 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5942168235778809
Epoch: 14, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 0.554915189743042
Epoch: 15, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6896176338195801
Epoch: 16, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6570637226104736
Epoch: 17, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6252756118774414
Epoch: 18, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6324217319488525
Epoch: 19, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6220886707305908
Epoch: 20, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5927033424377441
Epoch: 21, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6132252216339111
Epoch: 22, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6384451389312744
Epoch: 23, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6980171203613281
Epoch: 24, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 320168
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9544637203216553
Epoch: 1, Steps: 8 | Train Loss: 2.082 Vali Loss: 2.073 Vali Acc: 0.138 Test Loss: 2.073 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.604499340057373
Epoch: 2, Steps: 8 | Train Loss: 2.038 Vali Loss: 2.031 Vali Acc: 0.206 Test Loss: 2.031 Test Acc: 0.206
Validation loss decreased (-0.137479 --> -0.206230).  Saving model ...
Epoch: 3 cost time: 0.689467191696167
Epoch: 3, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.949 Vali Acc: 0.403 Test Loss: 1.949 Test Acc: 0.403
Validation loss decreased (-0.206230 --> -0.403106).  Saving model ...
Epoch: 4 cost time: 0.5402476787567139
Epoch: 4, Steps: 8 | Train Loss: 1.837 Vali Loss: 1.830 Vali Acc: 0.547 Test Loss: 1.830 Test Acc: 0.547
Validation loss decreased (-0.403106 --> -0.546857).  Saving model ...
Epoch: 5 cost time: 0.5638883113861084
Epoch: 5, Steps: 8 | Train Loss: 1.701 Vali Loss: 1.685 Vali Acc: 0.650 Test Loss: 1.685 Test Acc: 0.650
Validation loss decreased (-0.546857 --> -0.649983).  Saving model ...
Epoch: 6 cost time: 0.6179475784301758
Epoch: 6, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.524 Vali Acc: 0.703 Test Loss: 1.524 Test Acc: 0.703
Validation loss decreased (-0.649983 --> -0.703110).  Saving model ...
Epoch: 7 cost time: 0.6353988647460938
Epoch: 7, Steps: 8 | Train Loss: 1.409 Vali Loss: 1.356 Vali Acc: 0.756 Test Loss: 1.356 Test Acc: 0.756
Validation loss decreased (-0.703110 --> -0.756236).  Saving model ...
Epoch: 8 cost time: 0.5857734680175781
Epoch: 8, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.183 Vali Acc: 0.778 Test Loss: 1.183 Test Acc: 0.778
Validation loss decreased (-0.756236 --> -0.778113).  Saving model ...
Epoch: 9 cost time: 0.6151483058929443
Epoch: 9, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.024 Vali Acc: 0.797 Test Loss: 1.024 Test Acc: 0.797
Validation loss decreased (-0.778113 --> -0.796865).  Saving model ...
Epoch: 10 cost time: 0.6709365844726562
Epoch: 10, Steps: 8 | Train Loss: 0.909 Vali Loss: 0.891 Vali Acc: 0.809 Test Loss: 0.891 Test Acc: 0.809
Validation loss decreased (-0.796865 --> -0.809366).  Saving model ...
Epoch: 11 cost time: 0.6120507717132568
Epoch: 11, Steps: 8 | Train Loss: 0.753 Vali Loss: 0.776 Vali Acc: 0.828 Test Loss: 0.776 Test Acc: 0.828
Validation loss decreased (-0.809366 --> -0.828117).  Saving model ...
Epoch: 12 cost time: 0.6725952625274658
Epoch: 12, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.688 Vali Acc: 0.834 Test Loss: 0.688 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834368).  Saving model ...
Epoch: 13 cost time: 0.6402547359466553
Epoch: 13, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 0.6972687244415283
Epoch: 14, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.561 Vali Acc: 0.859 Test Loss: 0.561 Test Acc: 0.859
Validation loss decreased (-0.843744 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 0.6204073429107666
Epoch: 15, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
Validation loss decreased (-0.859369 --> -0.871870).  Saving model ...
Epoch: 16 cost time: 0.6939096450805664
Epoch: 16, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5914385318756104
Epoch: 17, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6821684837341309
Epoch: 18, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5257530212402344
Epoch: 19, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6524472236633301
Epoch: 20, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6167242527008057
Epoch: 21, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5226125717163086
Epoch: 22, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6495361328125
Epoch: 23, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.446 Vali Acc: 0.863 Test Loss: 0.446 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6233046054840088
Epoch: 24, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6635351181030273
Epoch: 25, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 317576
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.918290376663208
Epoch: 1, Steps: 8 | Train Loss: 2.080 Vali Loss: 2.058 Vali Acc: 0.131 Test Loss: 2.058 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.6092128753662109
Epoch: 2, Steps: 8 | Train Loss: 2.037 Vali Loss: 2.017 Vali Acc: 0.166 Test Loss: 2.017 Test Acc: 0.166
Validation loss decreased (-0.131229 --> -0.165605).  Saving model ...
Epoch: 3 cost time: 0.6070315837860107
Epoch: 3, Steps: 8 | Train Loss: 1.950 Vali Loss: 1.944 Vali Acc: 0.297 Test Loss: 1.944 Test Acc: 0.297
Validation loss decreased (-0.165605 --> -0.296856).  Saving model ...
Epoch: 4 cost time: 0.6797289848327637
Epoch: 4, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.846 Vali Acc: 0.494 Test Loss: 1.846 Test Acc: 0.494
Validation loss decreased (-0.296856 --> -0.493732).  Saving model ...
Epoch: 5 cost time: 0.6845860481262207
Epoch: 5, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.727 Vali Acc: 0.634 Test Loss: 1.727 Test Acc: 0.634
Validation loss decreased (-0.493732 --> -0.634358).  Saving model ...
Epoch: 6 cost time: 0.5814435482025146
Epoch: 6, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.596 Vali Acc: 0.684 Test Loss: 1.596 Test Acc: 0.684
Validation loss decreased (-0.634358 --> -0.684359).  Saving model ...
Epoch: 7 cost time: 0.6895525455474854
Epoch: 7, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.458 Vali Acc: 0.725 Test Loss: 1.458 Test Acc: 0.725
Validation loss decreased (-0.684359 --> -0.724985).  Saving model ...
Epoch: 8 cost time: 0.789675235748291
Epoch: 8, Steps: 8 | Train Loss: 1.330 Vali Loss: 1.316 Vali Acc: 0.753 Test Loss: 1.316 Test Acc: 0.753
Validation loss decreased (-0.724985 --> -0.753112).  Saving model ...
Epoch: 9 cost time: 0.669903039932251
Epoch: 9, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.181 Vali Acc: 0.766 Test Loss: 1.181 Test Acc: 0.766
Validation loss decreased (-0.753112 --> -0.765613).  Saving model ...
Epoch: 10 cost time: 0.6366422176361084
Epoch: 10, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.049 Vali Acc: 0.787 Test Loss: 1.049 Test Acc: 0.787
Validation loss decreased (-0.765613 --> -0.787490).  Saving model ...
Epoch: 11 cost time: 0.5641958713531494
Epoch: 11, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.932 Vali Acc: 0.800 Test Loss: 0.932 Test Acc: 0.800
Validation loss decreased (-0.787490 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 0.5556578636169434
Epoch: 12, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.831 Vali Acc: 0.806 Test Loss: 0.831 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.806242).  Saving model ...
Epoch: 13 cost time: 0.6584517955780029
Epoch: 13, Steps: 8 | Train Loss: 0.712 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.806242 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.7084343433380127
Epoch: 14, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.682 Vali Acc: 0.831 Test Loss: 0.682 Test Acc: 0.831
Validation loss decreased (-0.824993 --> -0.831243).  Saving model ...
Epoch: 15 cost time: 0.6126868724822998
Epoch: 15, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.831243 --> -0.843744).  Saving model ...
Epoch: 16 cost time: 0.6080310344696045
Epoch: 16, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 17 cost time: 0.5976080894470215
Epoch: 17, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7186849117279053
Epoch: 18, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7041308879852295
Epoch: 19, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7076952457427979
Epoch: 20, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6752266883850098
Epoch: 21, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6442198753356934
Epoch: 22, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6964921951293945
Epoch: 23, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.6583366394042969
Epoch: 24, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.6146352291107178
Epoch: 25, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865621).  Saving model ...
Epoch: 26 cost time: 0.7156250476837158
Epoch: 26, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.453 Vali Acc: 0.859 Test Loss: 0.453 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5654895305633545
Epoch: 27, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7002642154693604
Epoch: 28, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
Validation loss decreased (-0.865621 --> -0.865621).  Saving model ...
Epoch: 29 cost time: 0.5941717624664307
Epoch: 29, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.451 Vali Acc: 0.863 Test Loss: 0.451 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7290253639221191
Epoch: 30, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.453 Vali Acc: 0.866 Test Loss: 0.453 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6336748600006104
Epoch: 31, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.452 Vali Acc: 0.863 Test Loss: 0.452 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6085999011993408
Epoch: 32, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5966215133666992
Epoch: 33, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.865621 --> -0.874995).  Saving model ...
Epoch: 34 cost time: 0.5722367763519287
Epoch: 34, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5668148994445801
Epoch: 35, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6346652507781982
Epoch: 36, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6109511852264404
Epoch: 37, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.456 Vali Acc: 0.869 Test Loss: 0.456 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5984823703765869
Epoch: 38, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.464 Vali Acc: 0.869 Test Loss: 0.464 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6745576858520508
Epoch: 39, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.467 Vali Acc: 0.869 Test Loss: 0.467 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6396758556365967
Epoch: 40, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.474 Vali Acc: 0.869 Test Loss: 0.474 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5381276607513428
Epoch: 41, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.872 Test Loss: 0.483 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5588228702545166
Epoch: 42, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.493 Vali Acc: 0.869 Test Loss: 0.493 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6547374725341797
Epoch: 43, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.499 Vali Acc: 0.866 Test Loss: 0.499 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 315016
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.867196798324585
Epoch: 1, Steps: 8 | Train Loss: 2.062 Vali Loss: 2.061 Vali Acc: 0.319 Test Loss: 2.061 Test Acc: 0.319
Validation loss decreased (inf --> -0.318729).  Saving model ...
Epoch: 2 cost time: 0.6929700374603271
Epoch: 2, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.924 Vali Acc: 0.528 Test Loss: 1.924 Test Acc: 0.528
Validation loss decreased (-0.318729 --> -0.528106).  Saving model ...
Epoch: 3 cost time: 0.6716125011444092
Epoch: 3, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.674 Vali Acc: 0.747 Test Loss: 1.674 Test Acc: 0.747
Validation loss decreased (-0.528106 --> -0.746858).  Saving model ...
Epoch: 4 cost time: 0.6492056846618652
Epoch: 4, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.324 Vali Acc: 0.803 Test Loss: 1.324 Test Acc: 0.803
Validation loss decreased (-0.746858 --> -0.803112).  Saving model ...
Epoch: 5 cost time: 0.5985333919525146
Epoch: 5, Steps: 8 | Train Loss: 0.962 Vali Loss: 0.932 Vali Acc: 0.819 Test Loss: 0.932 Test Acc: 0.819
Validation loss decreased (-0.803112 --> -0.818741).  Saving model ...
Epoch: 6 cost time: 0.694040060043335
Epoch: 6, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
Validation loss decreased (-0.818741 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.6078779697418213
Epoch: 7, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.6635546684265137
Epoch: 8, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.475 Vali Acc: 0.847 Test Loss: 0.475 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.6358792781829834
Epoch: 9, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.6633358001708984
Epoch: 10, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.6936578750610352
Epoch: 11, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6720280647277832
Epoch: 12, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7607252597808838
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7469439506530762
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6659865379333496
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6181907653808594
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5959692001342773
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5701949596405029
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5293207168579102
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6548936367034912
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.622 Vali Acc: 0.825 Test Loss: 0.622 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 365352
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9295742511749268
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 2.074 Vali Acc: 0.147 Test Loss: 2.074 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.6209597587585449
Epoch: 2, Steps: 8 | Train Loss: 2.032 Vali Loss: 2.003 Vali Acc: 0.350 Test Loss: 2.003 Test Acc: 0.350
Validation loss decreased (-0.146854 --> -0.349980).  Saving model ...
Epoch: 3 cost time: 0.6531336307525635
Epoch: 3, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.860 Vali Acc: 0.569 Test Loss: 1.860 Test Acc: 0.569
Validation loss decreased (-0.349980 --> -0.568731).  Saving model ...
Epoch: 4 cost time: 0.6085770130157471
Epoch: 4, Steps: 8 | Train Loss: 1.641 Vali Loss: 1.642 Vali Acc: 0.703 Test Loss: 1.642 Test Acc: 0.703
Validation loss decreased (-0.568731 --> -0.703109).  Saving model ...
Epoch: 5 cost time: 0.6033935546875
Epoch: 5, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.366 Vali Acc: 0.753 Test Loss: 1.366 Test Acc: 0.753
Validation loss decreased (-0.703109 --> -0.753111).  Saving model ...
Epoch: 6 cost time: 0.6280884742736816
Epoch: 6, Steps: 8 | Train Loss: 1.109 Vali Loss: 1.064 Vali Acc: 0.787 Test Loss: 1.064 Test Acc: 0.787
Validation loss decreased (-0.753111 --> -0.787489).  Saving model ...
Epoch: 7 cost time: 0.6076517105102539
Epoch: 7, Steps: 8 | Train Loss: 0.826 Vali Loss: 0.809 Vali Acc: 0.806 Test Loss: 0.809 Test Acc: 0.806
Validation loss decreased (-0.787489 --> -0.806242).  Saving model ...
Epoch: 8 cost time: 0.6462230682373047
Epoch: 8, Steps: 8 | Train Loss: 0.626 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.806242 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.5269193649291992
Epoch: 9, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
Validation loss decreased (-0.809369 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.6528840065002441
Epoch: 10, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.6257631778717041
Epoch: 11, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.650592565536499
Epoch: 12, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6782574653625488
Epoch: 13, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6578254699707031
Epoch: 14, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5841429233551025
Epoch: 15, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6020567417144775
Epoch: 16, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6210627555847168
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6401610374450684
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5854847431182861
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6996243000030518
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6496384143829346
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 334888
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9475252628326416
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 2.078 Vali Acc: 0.125 Test Loss: 2.078 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 0.6053848266601562
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 2.016 Vali Acc: 0.134 Test Loss: 2.016 Test Acc: 0.134
Validation loss decreased (-0.124979 --> -0.134355).  Saving model ...
Epoch: 3 cost time: 0.5362281799316406
Epoch: 3, Steps: 8 | Train Loss: 1.884 Vali Loss: 1.898 Vali Acc: 0.497 Test Loss: 1.898 Test Acc: 0.497
Validation loss decreased (-0.134355 --> -0.496856).  Saving model ...
Epoch: 4 cost time: 0.5691986083984375
Epoch: 4, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.723 Vali Acc: 0.700 Test Loss: 1.723 Test Acc: 0.700
Validation loss decreased (-0.496856 --> -0.699983).  Saving model ...
Epoch: 5 cost time: 0.5441579818725586
Epoch: 5, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.493 Vali Acc: 0.772 Test Loss: 1.493 Test Acc: 0.772
Validation loss decreased (-0.699983 --> -0.771860).  Saving model ...
Epoch: 6 cost time: 0.5888338088989258
Epoch: 6, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.240 Vali Acc: 0.794 Test Loss: 1.240 Test Acc: 0.794
Validation loss decreased (-0.771860 --> -0.793738).  Saving model ...
Epoch: 7 cost time: 0.5729749202728271
Epoch: 7, Steps: 8 | Train Loss: 1.022 Vali Loss: 0.993 Vali Acc: 0.809 Test Loss: 0.993 Test Acc: 0.809
Validation loss decreased (-0.793738 --> -0.809365).  Saving model ...
Epoch: 8 cost time: 0.649721622467041
Epoch: 8, Steps: 8 | Train Loss: 0.789 Vali Loss: 0.785 Vali Acc: 0.822 Test Loss: 0.785 Test Acc: 0.822
Validation loss decreased (-0.809365 --> -0.821867).  Saving model ...
Epoch: 9 cost time: 0.5955281257629395
Epoch: 9, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.821867 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.5731964111328125
Epoch: 10, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.555 Vali Acc: 0.838 Test Loss: 0.555 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.5992186069488525
Epoch: 11, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.561208963394165
Epoch: 12, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.5183074474334717
Epoch: 13, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5596683025360107
Epoch: 14, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5466289520263672
Epoch: 15, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.565824031829834
Epoch: 16, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6228995323181152
Epoch: 17, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5817172527313232
Epoch: 18, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5975785255432129
Epoch: 19, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6354513168334961
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5934185981750488
Epoch: 21, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6428267955780029
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 325928
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9710729122161865
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.067 Vali Acc: 0.169 Test Loss: 2.067 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 0.608959436416626
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 2.018 Vali Acc: 0.269 Test Loss: 2.018 Test Acc: 0.269
Validation loss decreased (-0.168729 --> -0.268730).  Saving model ...
Epoch: 3 cost time: 0.5819587707519531
Epoch: 3, Steps: 8 | Train Loss: 1.915 Vali Loss: 1.922 Vali Acc: 0.481 Test Loss: 1.922 Test Acc: 0.481
Validation loss decreased (-0.268730 --> -0.481231).  Saving model ...
Epoch: 4 cost time: 0.6676962375640869
Epoch: 4, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.783 Vali Acc: 0.628 Test Loss: 1.783 Test Acc: 0.628
Validation loss decreased (-0.481231 --> -0.628107).  Saving model ...
Epoch: 5 cost time: 0.5644581317901611
Epoch: 5, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.607 Vali Acc: 0.719 Test Loss: 1.607 Test Acc: 0.719
Validation loss decreased (-0.628107 --> -0.718734).  Saving model ...
Epoch: 6 cost time: 0.5644612312316895
Epoch: 6, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.411 Vali Acc: 0.756 Test Loss: 1.411 Test Acc: 0.756
Validation loss decreased (-0.718734 --> -0.756236).  Saving model ...
Epoch: 7 cost time: 0.6866509914398193
Epoch: 7, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.206 Vali Acc: 0.778 Test Loss: 1.206 Test Acc: 0.778
Validation loss decreased (-0.756236 --> -0.778113).  Saving model ...
Epoch: 8 cost time: 0.7805008888244629
Epoch: 8, Steps: 8 | Train Loss: 1.026 Vali Loss: 1.010 Vali Acc: 0.791 Test Loss: 1.010 Test Acc: 0.791
Validation loss decreased (-0.778113 --> -0.790615).  Saving model ...
Epoch: 9 cost time: 0.6712875366210938
Epoch: 9, Steps: 8 | Train Loss: 0.848 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.790615 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.6216671466827393
Epoch: 10, Steps: 8 | Train Loss: 0.672 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.821868).  Saving model ...
Epoch: 11 cost time: 0.6497211456298828
Epoch: 11, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
Validation loss decreased (-0.821868 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 0.6217184066772461
Epoch: 12, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 0.5910756587982178
Epoch: 13, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 0.627227783203125
Epoch: 14, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.6528778076171875
Epoch: 15, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.6617894172668457
Epoch: 16, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.7082531452178955
Epoch: 17, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.614520788192749
Epoch: 18, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.6319632530212402
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853121).  Saving model ...
Epoch: 20 cost time: 0.654900312423706
Epoch: 20, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.452 Vali Acc: 0.844 Test Loss: 0.452 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5816259384155273
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7510008811950684
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6377935409545898
Epoch: 23, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5672247409820557
Epoch: 24, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7516398429870605
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7187097072601318
Epoch: 26, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6465556621551514
Epoch: 27, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6757631301879883
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6347851753234863
Epoch: 29, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 320040
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.989419937133789
Epoch: 1, Steps: 8 | Train Loss: 2.071 Vali Loss: 2.062 Vali Acc: 0.172 Test Loss: 2.062 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.6190276145935059
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 2.012 Vali Acc: 0.328 Test Loss: 2.012 Test Acc: 0.328
Validation loss decreased (-0.171854 --> -0.328105).  Saving model ...
Epoch: 3 cost time: 0.549116849899292
Epoch: 3, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.917 Vali Acc: 0.541 Test Loss: 1.917 Test Acc: 0.541
Validation loss decreased (-0.328105 --> -0.540606).  Saving model ...
Epoch: 4 cost time: 0.5671119689941406
Epoch: 4, Steps: 8 | Train Loss: 1.754 Vali Loss: 1.785 Vali Acc: 0.662 Test Loss: 1.785 Test Acc: 0.662
Validation loss decreased (-0.540606 --> -0.662482).  Saving model ...
Epoch: 5 cost time: 0.5889005661010742
Epoch: 5, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.620 Vali Acc: 0.725 Test Loss: 1.620 Test Acc: 0.725
Validation loss decreased (-0.662482 --> -0.724984).  Saving model ...
Epoch: 6 cost time: 0.7317519187927246
Epoch: 6, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.432 Vali Acc: 0.756 Test Loss: 1.432 Test Acc: 0.756
Validation loss decreased (-0.724984 --> -0.756236).  Saving model ...
Epoch: 7 cost time: 0.5938923358917236
Epoch: 7, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.246 Vali Acc: 0.781 Test Loss: 1.246 Test Acc: 0.781
Validation loss decreased (-0.756236 --> -0.781238).  Saving model ...
Epoch: 8 cost time: 0.6158952713012695
Epoch: 8, Steps: 8 | Train Loss: 1.090 Vali Loss: 1.070 Vali Acc: 0.797 Test Loss: 1.070 Test Acc: 0.797
Validation loss decreased (-0.781238 --> -0.796864).  Saving model ...
Epoch: 9 cost time: 0.6045551300048828
Epoch: 9, Steps: 8 | Train Loss: 0.898 Vali Loss: 0.914 Vali Acc: 0.816 Test Loss: 0.914 Test Acc: 0.816
Validation loss decreased (-0.796864 --> -0.815616).  Saving model ...
Epoch: 10 cost time: 0.6586735248565674
Epoch: 10, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.784 Vali Acc: 0.831 Test Loss: 0.784 Test Acc: 0.831
Validation loss decreased (-0.815616 --> -0.831242).  Saving model ...
Epoch: 11 cost time: 0.7126824855804443
Epoch: 11, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.684 Vali Acc: 0.841 Test Loss: 0.684 Test Acc: 0.841
Validation loss decreased (-0.831242 --> -0.840618).  Saving model ...
Epoch: 12 cost time: 0.7691266536712646
Epoch: 12, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 0.7164697647094727
Epoch: 13, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 14 cost time: 0.6248321533203125
Epoch: 14, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.6360206604003906
Epoch: 15, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.6270806789398193
Epoch: 16, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 0.6430041790008545
Epoch: 17, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.740119218826294
Epoch: 18, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7061576843261719
Epoch: 19, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6555690765380859
Epoch: 20, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.458 Vali Acc: 0.869 Test Loss: 0.458 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 21 cost time: 0.605858564376831
Epoch: 21, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.452 Vali Acc: 0.866 Test Loss: 0.452 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6285314559936523
Epoch: 22, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6672508716583252
Epoch: 23, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8052787780761719
Epoch: 24, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7363357543945312
Epoch: 25, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6347024440765381
Epoch: 26, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6595127582550049
Epoch: 27, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6661098003387451
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.636760950088501
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6319634914398193
Epoch: 30, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 317480
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8310520648956299
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 2.061 Vali Acc: 0.147 Test Loss: 2.061 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.651561975479126
Epoch: 2, Steps: 8 | Train Loss: 2.037 Vali Loss: 2.018 Vali Acc: 0.256 Test Loss: 2.018 Test Acc: 0.256
Validation loss decreased (-0.146854 --> -0.256230).  Saving model ...
Epoch: 3 cost time: 0.6968002319335938
Epoch: 3, Steps: 8 | Train Loss: 1.936 Vali Loss: 1.934 Vali Acc: 0.484 Test Loss: 1.934 Test Acc: 0.484
Validation loss decreased (-0.256230 --> -0.484356).  Saving model ...
Epoch: 4 cost time: 0.668975830078125
Epoch: 4, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.817 Vali Acc: 0.644 Test Loss: 1.817 Test Acc: 0.644
Validation loss decreased (-0.484356 --> -0.643732).  Saving model ...
Epoch: 5 cost time: 0.7593743801116943
Epoch: 5, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.678 Vali Acc: 0.722 Test Loss: 1.678 Test Acc: 0.722
Validation loss decreased (-0.643732 --> -0.721858).  Saving model ...
Epoch: 6 cost time: 0.6303262710571289
Epoch: 6, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.518 Vali Acc: 0.744 Test Loss: 1.518 Test Acc: 0.744
Validation loss decreased (-0.721858 --> -0.743735).  Saving model ...
Epoch: 7 cost time: 0.595665693283081
Epoch: 7, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.353 Vali Acc: 0.759 Test Loss: 1.353 Test Acc: 0.759
Validation loss decreased (-0.743735 --> -0.759361).  Saving model ...
Epoch: 8 cost time: 0.5755951404571533
Epoch: 8, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.184 Vali Acc: 0.775 Test Loss: 1.184 Test Acc: 0.775
Validation loss decreased (-0.759361 --> -0.774988).  Saving model ...
Epoch: 9 cost time: 0.6150493621826172
Epoch: 9, Steps: 8 | Train Loss: 1.059 Vali Loss: 1.014 Vali Acc: 0.816 Test Loss: 1.014 Test Acc: 0.816
Validation loss decreased (-0.774988 --> -0.815615).  Saving model ...
Epoch: 10 cost time: 0.6475718021392822
Epoch: 10, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.876 Vali Acc: 0.812 Test Loss: 0.876 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6751587390899658
Epoch: 11, Steps: 8 | Train Loss: 0.754 Vali Loss: 0.759 Vali Acc: 0.822 Test Loss: 0.759 Test Acc: 0.822
Validation loss decreased (-0.815615 --> -0.821867).  Saving model ...
Epoch: 12 cost time: 0.6342978477478027
Epoch: 12, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.670 Vali Acc: 0.831 Test Loss: 0.670 Test Acc: 0.831
Validation loss decreased (-0.821867 --> -0.831243).  Saving model ...
Epoch: 13 cost time: 0.6317892074584961
Epoch: 13, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.605 Vali Acc: 0.853 Test Loss: 0.605 Test Acc: 0.853
Validation loss decreased (-0.831243 --> -0.853119).  Saving model ...
Epoch: 14 cost time: 0.6105382442474365
Epoch: 14, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.558 Vali Acc: 0.859 Test Loss: 0.558 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 0.5886454582214355
Epoch: 15, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859370).  Saving model ...
Epoch: 16 cost time: 0.6458826065063477
Epoch: 16, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6108322143554688
Epoch: 17, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 18 cost time: 0.6489794254302979
Epoch: 18, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 0.7211666107177734
Epoch: 19, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.451 Vali Acc: 0.869 Test Loss: 0.451 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 20 cost time: 0.6658639907836914
Epoch: 20, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6983468532562256
Epoch: 21, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6676545143127441
Epoch: 22, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7382614612579346
Epoch: 23, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6692502498626709
Epoch: 24, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6565158367156982
Epoch: 25, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.436 Vali Acc: 0.859 Test Loss: 0.436 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6888861656188965
Epoch: 26, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.435 Vali Acc: 0.866 Test Loss: 0.435 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.737924337387085
Epoch: 27, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.438 Vali Acc: 0.859 Test Loss: 0.438 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6424906253814697
Epoch: 28, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.447 Vali Acc: 0.859 Test Loss: 0.447 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6864218711853027
Epoch: 29, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 314888
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9926414489746094
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.085 Vali Acc: 0.056 Test Loss: 2.085 Test Acc: 0.056
Validation loss decreased (inf --> -0.056229).  Saving model ...
Epoch: 2 cost time: 0.6932535171508789
Epoch: 2, Steps: 8 | Train Loss: 2.097 Vali Loss: 2.052 Vali Acc: 0.094 Test Loss: 2.052 Test Acc: 0.094
Validation loss decreased (-0.056229 --> -0.093729).  Saving model ...
Epoch: 3 cost time: 0.7312972545623779
Epoch: 3, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.987 Vali Acc: 0.281 Test Loss: 1.987 Test Acc: 0.281
Validation loss decreased (-0.093729 --> -0.281230).  Saving model ...
Epoch: 4 cost time: 0.591881513595581
Epoch: 4, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.895 Vali Acc: 0.512 Test Loss: 1.895 Test Acc: 0.512
Validation loss decreased (-0.281230 --> -0.512481).  Saving model ...
Epoch: 5 cost time: 0.556816577911377
Epoch: 5, Steps: 8 | Train Loss: 1.807 Vali Loss: 1.788 Vali Acc: 0.647 Test Loss: 1.788 Test Acc: 0.647
Validation loss decreased (-0.512481 --> -0.646857).  Saving model ...
Epoch: 6 cost time: 0.5621709823608398
Epoch: 6, Steps: 8 | Train Loss: 1.663 Vali Loss: 1.668 Vali Acc: 0.706 Test Loss: 1.668 Test Acc: 0.706
Validation loss decreased (-0.646857 --> -0.706233).  Saving model ...
Epoch: 7 cost time: 0.5791401863098145
Epoch: 7, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.531 Vali Acc: 0.766 Test Loss: 1.531 Test Acc: 0.766
Validation loss decreased (-0.706233 --> -0.765610).  Saving model ...
Epoch: 8 cost time: 0.7264728546142578
Epoch: 8, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.390 Vali Acc: 0.778 Test Loss: 1.390 Test Acc: 0.778
Validation loss decreased (-0.765610 --> -0.778111).  Saving model ...
Epoch: 9 cost time: 0.5884416103363037
Epoch: 9, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.244 Vali Acc: 0.800 Test Loss: 1.244 Test Acc: 0.800
Validation loss decreased (-0.778111 --> -0.799988).  Saving model ...
Epoch: 10 cost time: 0.6539876461029053
Epoch: 10, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.107 Vali Acc: 0.806 Test Loss: 1.107 Test Acc: 0.806
Validation loss decreased (-0.799988 --> -0.806239).  Saving model ...
Epoch: 11 cost time: 0.6394810676574707
Epoch: 11, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.974 Vali Acc: 0.812 Test Loss: 0.974 Test Acc: 0.812
Validation loss decreased (-0.806239 --> -0.812490).  Saving model ...
Epoch: 12 cost time: 0.5930430889129639
Epoch: 12, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.859 Vali Acc: 0.816 Test Loss: 0.859 Test Acc: 0.816
Validation loss decreased (-0.812490 --> -0.815616).  Saving model ...
Epoch: 13 cost time: 0.6039912700653076
Epoch: 13, Steps: 8 | Train Loss: 0.721 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
Validation loss decreased (-0.815616 --> -0.818742).  Saving model ...
Epoch: 14 cost time: 0.7317385673522949
Epoch: 14, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.689 Vali Acc: 0.819 Test Loss: 0.689 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818743).  Saving model ...
Epoch: 15 cost time: 0.5717883110046387
Epoch: 15, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.627 Vali Acc: 0.831 Test Loss: 0.627 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 0.6279933452606201
Epoch: 16, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 17 cost time: 0.641488790512085
Epoch: 17, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 0.6702618598937988
Epoch: 18, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 0.752028226852417
Epoch: 19, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 0.5653154850006104
Epoch: 20, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 0.5799720287322998
Epoch: 21, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 22 cost time: 0.6724998950958252
Epoch: 22, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.445 Vali Acc: 0.859 Test Loss: 0.445 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 23 cost time: 0.6028039455413818
Epoch: 23, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.439 Vali Acc: 0.853 Test Loss: 0.439 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.569300651550293
Epoch: 24, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5725369453430176
Epoch: 25, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.430 Vali Acc: 0.853 Test Loss: 0.430 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6254563331604004
Epoch: 26, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.422 Vali Acc: 0.853 Test Loss: 0.422 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6030285358428955
Epoch: 27, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.419 Vali Acc: 0.859 Test Loss: 0.419 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 28 cost time: 0.6264846324920654
Epoch: 28, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.428 Vali Acc: 0.859 Test Loss: 0.428 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6555061340332031
Epoch: 29, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.433 Vali Acc: 0.863 Test Loss: 0.433 Test Acc: 0.863
Validation loss decreased (-0.859371 --> -0.862496).  Saving model ...
Epoch: 30 cost time: 0.6774370670318604
Epoch: 30, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6624746322631836
Epoch: 31, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6555101871490479
Epoch: 32, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.434 Vali Acc: 0.859 Test Loss: 0.434 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6653406620025635
Epoch: 33, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6241590976715088
Epoch: 34, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.434 Vali Acc: 0.859 Test Loss: 0.434 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6328864097595215
Epoch: 35, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7321321964263916
Epoch: 36, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.447 Vali Acc: 0.866 Test Loss: 0.447 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865621).  Saving model ...
Epoch: 37 cost time: 0.5792160034179688
Epoch: 37, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5906047821044922
Epoch: 38, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7085790634155273
Epoch: 39, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.599987268447876
Epoch: 40, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.651033878326416
Epoch: 41, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6744632720947266
Epoch: 42, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.467 Vali Acc: 0.866 Test Loss: 0.467 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6998751163482666
Epoch: 43, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.473 Vali Acc: 0.866 Test Loss: 0.473 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6525924205780029
Epoch: 44, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.477 Vali Acc: 0.866 Test Loss: 0.477 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6371393203735352
Epoch: 45, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
Validation loss decreased (-0.865621 --> -0.871870).  Saving model ...
Epoch: 46 cost time: 0.5482256412506104
Epoch: 46, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5717425346374512
Epoch: 47, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.487 Vali Acc: 0.866 Test Loss: 0.487 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5575742721557617
Epoch: 48, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.492 Vali Acc: 0.869 Test Loss: 0.492 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6458673477172852
Epoch: 49, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.494 Vali Acc: 0.869 Test Loss: 0.494 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5933232307434082
Epoch: 50, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.495 Vali Acc: 0.866 Test Loss: 0.495 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 312328
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.031893014907837
Epoch: 1, Steps: 8 | Train Loss: 1.961 Vali Loss: 1.838 Vali Acc: 0.600 Test Loss: 1.838 Test Acc: 0.600
Validation loss decreased (inf --> -0.599982).  Saving model ...
Epoch: 2 cost time: 0.5694267749786377
Epoch: 2, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.245 Vali Acc: 0.806 Test Loss: 1.245 Test Acc: 0.806
Validation loss decreased (-0.599982 --> -0.806238).  Saving model ...
Epoch: 3 cost time: 0.6492419242858887
Epoch: 3, Steps: 8 | Train Loss: 0.698 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
Validation loss decreased (-0.806238 --> -0.815618).  Saving model ...
Epoch: 4 cost time: 0.6295058727264404
Epoch: 4, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.488 Vali Acc: 0.828 Test Loss: 0.488 Test Acc: 0.828
Validation loss decreased (-0.815618 --> -0.828120).  Saving model ...
Epoch: 5 cost time: 0.6667294502258301
Epoch: 5, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.469 Vali Acc: 0.859 Test Loss: 0.469 Test Acc: 0.859
Validation loss decreased (-0.828120 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 0.639491081237793
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7114963531494141
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6256005764007568
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.731 Vali Acc: 0.828 Test Loss: 0.731 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.65948486328125
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.787 Vali Acc: 0.816 Test Loss: 0.787 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6242637634277344
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.819 Test Loss: 0.804 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6076164245605469
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.810 Vali Acc: 0.822 Test Loss: 0.810 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6440103054046631
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.825 Test Loss: 0.819 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5938351154327393
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.831 Test Loss: 0.820 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5913617610931396
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.831 Test Loss: 0.821 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6113872528076172
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.831 Test Loss: 0.825 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1336968
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0114424228668213
Epoch: 1, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.915 Vali Acc: 0.300 Test Loss: 1.915 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 0.7019832134246826
Epoch: 2, Steps: 8 | Train Loss: 1.625 Vali Loss: 1.547 Vali Acc: 0.794 Test Loss: 1.547 Test Acc: 0.794
Validation loss decreased (-0.299981 --> -0.793735).  Saving model ...
Epoch: 3 cost time: 0.6463115215301514
Epoch: 3, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.024 Vali Acc: 0.806 Test Loss: 1.024 Test Acc: 0.806
Validation loss decreased (-0.793735 --> -0.806240).  Saving model ...
Epoch: 4 cost time: 0.6423749923706055
Epoch: 4, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
Validation loss decreased (-0.806240 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.7042512893676758
Epoch: 5, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.5515649318695068
Epoch: 6, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
Validation loss decreased (-0.837495 --> -0.871871).  Saving model ...
Epoch: 7 cost time: 0.6102385520935059
Epoch: 7, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.472 Vali Acc: 0.863 Test Loss: 0.472 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6319637298583984
Epoch: 8, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.671879768371582
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.572521448135376
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.589 Vali Acc: 0.834 Test Loss: 0.589 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6111636161804199
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6423239707946777
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.834 Test Loss: 0.637 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6732618808746338
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.831 Test Loss: 0.668 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.605226993560791
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.831 Test Loss: 0.684 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7093167304992676
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.834 Test Loss: 0.676 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7190501689910889
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.834 Test Loss: 0.696 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1221256
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8930022716522217
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 2.021 Vali Acc: 0.225 Test Loss: 2.021 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 0.6710529327392578
Epoch: 2, Steps: 8 | Train Loss: 1.810 Vali Loss: 1.733 Vali Acc: 0.681 Test Loss: 1.733 Test Acc: 0.681
Validation loss decreased (-0.224980 --> -0.681233).  Saving model ...
Epoch: 3 cost time: 0.656395435333252
Epoch: 3, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.295 Vali Acc: 0.797 Test Loss: 1.295 Test Acc: 0.797
Validation loss decreased (-0.681233 --> -0.796862).  Saving model ...
Epoch: 4 cost time: 0.6313109397888184
Epoch: 4, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.854 Vali Acc: 0.812 Test Loss: 0.854 Test Acc: 0.812
Validation loss decreased (-0.796862 --> -0.812491).  Saving model ...
Epoch: 5 cost time: 0.6094903945922852
Epoch: 5, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
Validation loss decreased (-0.812491 --> -0.840619).  Saving model ...
Epoch: 6 cost time: 0.6823632717132568
Epoch: 6, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.7369749546051025
Epoch: 7, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5658562183380127
Epoch: 8, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.667191743850708
Epoch: 9, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6100978851318359
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6146197319030762
Epoch: 11, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6134130954742432
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.585 Vali Acc: 0.834 Test Loss: 0.585 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.64607834815979
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.590 Vali Acc: 0.831 Test Loss: 0.590 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6631300449371338
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5257790088653564
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.834 Test Loss: 0.609 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5562102794647217
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.620 Vali Acc: 0.834 Test Loss: 0.620 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1179272
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9262175559997559
Epoch: 1, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.994 Vali Acc: 0.319 Test Loss: 1.994 Test Acc: 0.319
Validation loss decreased (inf --> -0.318730).  Saving model ...
Epoch: 2 cost time: 0.5960893630981445
Epoch: 2, Steps: 8 | Train Loss: 1.793 Vali Loss: 1.752 Vali Acc: 0.688 Test Loss: 1.752 Test Acc: 0.688
Validation loss decreased (-0.318730 --> -0.687482).  Saving model ...
Epoch: 3 cost time: 0.5853424072265625
Epoch: 3, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.371 Vali Acc: 0.791 Test Loss: 1.371 Test Acc: 0.791
Validation loss decreased (-0.687482 --> -0.790611).  Saving model ...
Epoch: 4 cost time: 0.5748541355133057
Epoch: 4, Steps: 8 | Train Loss: 1.002 Vali Loss: 0.950 Vali Acc: 0.816 Test Loss: 0.950 Test Acc: 0.816
Validation loss decreased (-0.790611 --> -0.815616).  Saving model ...
Epoch: 5 cost time: 0.6492915153503418
Epoch: 5, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
Validation loss decreased (-0.815616 --> -0.828119).  Saving model ...
Epoch: 6 cost time: 0.5921261310577393
Epoch: 6, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.6148326396942139
Epoch: 7, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 0.6336374282836914
Epoch: 8, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.428 Vali Acc: 0.872 Test Loss: 0.428 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.871871).  Saving model ...
Epoch: 9 cost time: 0.637331485748291
Epoch: 9, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.431 Vali Acc: 0.863 Test Loss: 0.431 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5533144474029541
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5267469882965088
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.577185869216919
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.488 Vali Acc: 0.834 Test Loss: 0.488 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4968264102935791
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5594265460968018
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6091771125793457
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5675766468048096
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.569880485534668
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.61423659324646
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1161864
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7308132648468018
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 2.018 Vali Acc: 0.212 Test Loss: 2.018 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.5835843086242676
Epoch: 2, Steps: 8 | Train Loss: 1.861 Vali Loss: 1.814 Vali Acc: 0.537 Test Loss: 1.814 Test Acc: 0.537
Validation loss decreased (-0.212480 --> -0.537482).  Saving model ...
Epoch: 3 cost time: 0.601266622543335
Epoch: 3, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.507 Vali Acc: 0.766 Test Loss: 1.507 Test Acc: 0.766
Validation loss decreased (-0.537482 --> -0.765610).  Saving model ...
Epoch: 4 cost time: 0.6147964000701904
Epoch: 4, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.148 Vali Acc: 0.819 Test Loss: 1.148 Test Acc: 0.819
Validation loss decreased (-0.765610 --> -0.818739).  Saving model ...
Epoch: 5 cost time: 0.6184487342834473
Epoch: 5, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.820 Vali Acc: 0.831 Test Loss: 0.820 Test Acc: 0.831
Validation loss decreased (-0.818739 --> -0.831242).  Saving model ...
Epoch: 6 cost time: 0.6030170917510986
Epoch: 6, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.831242 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 0.5700883865356445
Epoch: 7, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5831336975097656
Epoch: 8, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.452 Vali Acc: 0.853 Test Loss: 0.452 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.5684034824371338
Epoch: 9, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.456 Vali Acc: 0.859 Test Loss: 0.456 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 0.6015276908874512
Epoch: 10, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.476 Vali Acc: 0.834 Test Loss: 0.476 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.535595178604126
Epoch: 11, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6274065971374512
Epoch: 12, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5261421203613281
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5184264183044434
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6427273750305176
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6856262683868408
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6730160713195801
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6518652439117432
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5621178150177002
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1145480
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9684679508209229
Epoch: 1, Steps: 8 | Train Loss: 2.023 Vali Loss: 1.983 Vali Acc: 0.294 Test Loss: 1.983 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 0.6275873184204102
Epoch: 2, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.812 Vali Acc: 0.550 Test Loss: 1.812 Test Acc: 0.550
Validation loss decreased (-0.293730 --> -0.549982).  Saving model ...
Epoch: 3 cost time: 0.6689395904541016
Epoch: 3, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.547 Vali Acc: 0.769 Test Loss: 1.547 Test Acc: 0.769
Validation loss decreased (-0.549982 --> -0.768735).  Saving model ...
Epoch: 4 cost time: 0.6092400550842285
Epoch: 4, Steps: 8 | Train Loss: 1.281 Vali Loss: 1.225 Vali Acc: 0.816 Test Loss: 1.225 Test Acc: 0.816
Validation loss decreased (-0.768735 --> -0.815613).  Saving model ...
Epoch: 5 cost time: 0.6364107131958008
Epoch: 5, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.912 Vali Acc: 0.812 Test Loss: 0.912 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6591875553131104
Epoch: 6, Steps: 8 | Train Loss: 0.672 Vali Loss: 0.681 Vali Acc: 0.838 Test Loss: 0.681 Test Acc: 0.838
Validation loss decreased (-0.815613 --> -0.837493).  Saving model ...
Epoch: 7 cost time: 0.586284875869751
Epoch: 7, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
Validation loss decreased (-0.837493 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.6215202808380127
Epoch: 8, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 0.6263713836669922
Epoch: 9, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.448 Vali Acc: 0.872 Test Loss: 0.448 Test Acc: 0.872
Validation loss decreased (-0.856245 --> -0.871871).  Saving model ...
Epoch: 10 cost time: 0.5954182147979736
Epoch: 10, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.442 Vali Acc: 0.866 Test Loss: 0.442 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.648101806640625
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6366448402404785
Epoch: 12, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.445 Vali Acc: 0.853 Test Loss: 0.445 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5759248733520508
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.443 Vali Acc: 0.853 Test Loss: 0.443 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6109707355499268
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6452474594116211
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6244852542877197
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6703426837921143
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6608076095581055
Epoch: 18, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.633986234664917
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1135112
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9857707023620605
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 2.039 Vali Acc: 0.163 Test Loss: 2.039 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 0.5795760154724121
Epoch: 2, Steps: 8 | Train Loss: 1.957 Vali Loss: 1.880 Vali Acc: 0.416 Test Loss: 1.880 Test Acc: 0.416
Validation loss decreased (-0.162480 --> -0.415606).  Saving model ...
Epoch: 3 cost time: 0.6017625331878662
Epoch: 3, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.624 Vali Acc: 0.700 Test Loss: 1.624 Test Acc: 0.700
Validation loss decreased (-0.415606 --> -0.699984).  Saving model ...
Epoch: 4 cost time: 0.6318089962005615
Epoch: 4, Steps: 8 | Train Loss: 1.382 Vali Loss: 1.315 Vali Acc: 0.797 Test Loss: 1.315 Test Acc: 0.797
Validation loss decreased (-0.699984 --> -0.796862).  Saving model ...
Epoch: 5 cost time: 0.5400989055633545
Epoch: 5, Steps: 8 | Train Loss: 1.077 Vali Loss: 1.011 Vali Acc: 0.816 Test Loss: 1.011 Test Acc: 0.816
Validation loss decreased (-0.796862 --> -0.815615).  Saving model ...
Epoch: 6 cost time: 0.6478495597839355
Epoch: 6, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5432679653167725
Epoch: 7, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.620 Vali Acc: 0.806 Test Loss: 0.620 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5804557800292969
Epoch: 8, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
Validation loss decreased (-0.815615 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.6255753040313721
Epoch: 9, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.671412467956543
Epoch: 10, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.454 Vali Acc: 0.847 Test Loss: 0.454 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6635823249816895
Epoch: 11, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 0.6412532329559326
Epoch: 12, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.429 Vali Acc: 0.856 Test Loss: 0.429 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.856246).  Saving model ...
Epoch: 13 cost time: 0.6475937366485596
Epoch: 13, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.432 Vali Acc: 0.847 Test Loss: 0.432 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6476938724517822
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.430 Vali Acc: 0.853 Test Loss: 0.430 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.645435094833374
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.444 Vali Acc: 0.853 Test Loss: 0.444 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.69100022315979
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6133749485015869
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6864497661590576
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7141323089599609
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6720609664916992
Epoch: 20, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.460 Vali Acc: 0.859 Test Loss: 0.460 Test Acc: 0.859
Validation loss decreased (-0.856246 --> -0.859370).  Saving model ...
Epoch: 21 cost time: 0.6495699882507324
Epoch: 21, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5847325325012207
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6195449829101562
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6867516040802002
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6122915744781494
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5642259120941162
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5313785076141357
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6768491268157959
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6558206081390381
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5447466373443604
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1131016
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9577994346618652
Epoch: 1, Steps: 8 | Train Loss: 2.073 Vali Loss: 1.984 Vali Acc: 0.231 Test Loss: 1.984 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.5371952056884766
Epoch: 2, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.657 Vali Acc: 0.731 Test Loss: 1.657 Test Acc: 0.731
Validation loss decreased (-0.231230 --> -0.731233).  Saving model ...
Epoch: 3 cost time: 0.4969930648803711
Epoch: 3, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.189 Vali Acc: 0.797 Test Loss: 1.189 Test Acc: 0.797
Validation loss decreased (-0.731233 --> -0.796863).  Saving model ...
Epoch: 4 cost time: 0.5732953548431396
Epoch: 4, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.755 Vali Acc: 0.809 Test Loss: 0.755 Test Acc: 0.809
Validation loss decreased (-0.796863 --> -0.809367).  Saving model ...
Epoch: 5 cost time: 0.6180963516235352
Epoch: 5, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.809367 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.6056110858917236
Epoch: 6, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.5240201950073242
Epoch: 7, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.597069501876831
Epoch: 8, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6096627712249756
Epoch: 9, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6151883602142334
Epoch: 10, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5525767803192139
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6666703224182129
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5744388103485107
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.681 Vali Acc: 0.831 Test Loss: 0.681 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5849359035491943
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6993439197540283
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.831 Test Loss: 0.690 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5864596366882324
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 406344
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8710896968841553
Epoch: 1, Steps: 8 | Train Loss: 2.070 Vali Loss: 2.027 Vali Acc: 0.234 Test Loss: 2.027 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.6212921142578125
Epoch: 2, Steps: 8 | Train Loss: 1.839 Vali Loss: 1.830 Vali Acc: 0.666 Test Loss: 1.830 Test Acc: 0.666
Validation loss decreased (-0.234355 --> -0.665607).  Saving model ...
Epoch: 3 cost time: 0.6198992729187012
Epoch: 3, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.505 Vali Acc: 0.775 Test Loss: 1.505 Test Acc: 0.775
Validation loss decreased (-0.665607 --> -0.774985).  Saving model ...
Epoch: 4 cost time: 0.7614099979400635
Epoch: 4, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.088 Vali Acc: 0.809 Test Loss: 1.088 Test Acc: 0.809
Validation loss decreased (-0.774985 --> -0.809364).  Saving model ...
Epoch: 5 cost time: 0.54410719871521
Epoch: 5, Steps: 8 | Train Loss: 0.754 Vali Loss: 0.745 Vali Acc: 0.819 Test Loss: 0.745 Test Acc: 0.819
Validation loss decreased (-0.809364 --> -0.818743).  Saving model ...
Epoch: 6 cost time: 0.550246000289917
Epoch: 6, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.60186767578125
Epoch: 7, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.609649658203125
Epoch: 8, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.452 Vali Acc: 0.866 Test Loss: 0.452 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 0.5955777168273926
Epoch: 9, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.57057785987854
Epoch: 10, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6890411376953125
Epoch: 11, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.554750919342041
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6336655616760254
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5821418762207031
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5893526077270508
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.561 Vali Acc: 0.838 Test Loss: 0.561 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6706576347351074
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.573 Vali Acc: 0.834 Test Loss: 0.573 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6416494846343994
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6720287799835205
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 348488
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8181142807006836
Epoch: 1, Steps: 8 | Train Loss: 2.068 Vali Loss: 2.029 Vali Acc: 0.219 Test Loss: 2.029 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.5111193656921387
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.899 Vali Acc: 0.566 Test Loss: 1.899 Test Acc: 0.566
Validation loss decreased (-0.218730 --> -0.565606).  Saving model ...
Epoch: 3 cost time: 0.6169073581695557
Epoch: 3, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.676 Vali Acc: 0.741 Test Loss: 1.676 Test Acc: 0.741
Validation loss decreased (-0.565606 --> -0.740608).  Saving model ...
Epoch: 4 cost time: 0.5598883628845215
Epoch: 4, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.371 Vali Acc: 0.775 Test Loss: 1.371 Test Acc: 0.775
Validation loss decreased (-0.740608 --> -0.774986).  Saving model ...
Epoch: 5 cost time: 0.6142599582672119
Epoch: 5, Steps: 8 | Train Loss: 1.087 Vali Loss: 1.031 Vali Acc: 0.812 Test Loss: 1.031 Test Acc: 0.812
Validation loss decreased (-0.774986 --> -0.812490).  Saving model ...
Epoch: 6 cost time: 0.5698938369750977
Epoch: 6, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.771 Vali Acc: 0.819 Test Loss: 0.771 Test Acc: 0.819
Validation loss decreased (-0.812490 --> -0.818742).  Saving model ...
Epoch: 7 cost time: 0.5433826446533203
Epoch: 7, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.818742 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 0.5937590599060059
Epoch: 8, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.6278584003448486
Epoch: 9, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
Validation loss decreased (-0.824995 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.6287496089935303
Epoch: 10, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.462 Vali Acc: 0.866 Test Loss: 0.462 Test Acc: 0.866
Validation loss decreased (-0.843745 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 0.6582276821136475
Epoch: 11, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5301039218902588
Epoch: 12, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6848204135894775
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.702491283416748
Epoch: 14, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6386778354644775
Epoch: 15, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.584338903427124
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5666766166687012
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6372616291046143
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5560381412506104
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6150860786437988
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 327496
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8368141651153564
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.042 Vali Acc: 0.259 Test Loss: 2.042 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 0.6287405490875244
Epoch: 2, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.920 Vali Acc: 0.441 Test Loss: 1.920 Test Acc: 0.441
Validation loss decreased (-0.259355 --> -0.440606).  Saving model ...
Epoch: 3 cost time: 0.5550205707550049
Epoch: 3, Steps: 8 | Train Loss: 1.744 Vali Loss: 1.717 Vali Acc: 0.625 Test Loss: 1.717 Test Acc: 0.625
Validation loss decreased (-0.440606 --> -0.624983).  Saving model ...
Epoch: 4 cost time: 0.5224547386169434
Epoch: 4, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.444 Vali Acc: 0.716 Test Loss: 1.444 Test Acc: 0.716
Validation loss decreased (-0.624983 --> -0.715611).  Saving model ...
Epoch: 5 cost time: 0.539980411529541
Epoch: 5, Steps: 8 | Train Loss: 1.179 Vali Loss: 1.149 Vali Acc: 0.778 Test Loss: 1.149 Test Acc: 0.778
Validation loss decreased (-0.715611 --> -0.778114).  Saving model ...
Epoch: 6 cost time: 0.530442476272583
Epoch: 6, Steps: 8 | Train Loss: 0.921 Vali Loss: 0.880 Vali Acc: 0.806 Test Loss: 0.880 Test Acc: 0.806
Validation loss decreased (-0.778114 --> -0.806241).  Saving model ...
Epoch: 7 cost time: 0.5659794807434082
Epoch: 7, Steps: 8 | Train Loss: 0.656 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
Validation loss decreased (-0.806241 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 0.5273549556732178
Epoch: 8, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.824993 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 0.4705479145050049
Epoch: 9, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.4711911678314209
Epoch: 10, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.5371015071868896
Epoch: 11, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5530791282653809
Epoch: 12, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5485587120056152
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.476 Vali Acc: 0.834 Test Loss: 0.476 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5838451385498047
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.476 Vali Acc: 0.834 Test Loss: 0.476 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6449832916259766
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6348609924316406
Epoch: 16, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.481 Vali Acc: 0.834 Test Loss: 0.481 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6151292324066162
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5168449878692627
Epoch: 18, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5727651119232178
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6022083759307861
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 318792
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8496239185333252
Epoch: 1, Steps: 8 | Train Loss: 2.100 Vali Loss: 2.060 Vali Acc: 0.087 Test Loss: 2.060 Test Acc: 0.087
Validation loss decreased (inf --> -0.087479).  Saving model ...
Epoch: 2 cost time: 0.6113357543945312
Epoch: 2, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.974 Vali Acc: 0.263 Test Loss: 1.974 Test Acc: 0.263
Validation loss decreased (-0.087479 --> -0.262480).  Saving model ...
Epoch: 3 cost time: 0.5441012382507324
Epoch: 3, Steps: 8 | Train Loss: 1.847 Vali Loss: 1.824 Vali Acc: 0.613 Test Loss: 1.824 Test Acc: 0.613
Validation loss decreased (-0.262480 --> -0.612482).  Saving model ...
Epoch: 4 cost time: 0.6204698085784912
Epoch: 4, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.624 Vali Acc: 0.747 Test Loss: 1.624 Test Acc: 0.747
Validation loss decreased (-0.612482 --> -0.746859).  Saving model ...
Epoch: 5 cost time: 0.5728492736816406
Epoch: 5, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.393 Vali Acc: 0.791 Test Loss: 1.393 Test Acc: 0.791
Validation loss decreased (-0.746859 --> -0.790611).  Saving model ...
Epoch: 6 cost time: 0.5971963405609131
Epoch: 6, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.145 Vali Acc: 0.806 Test Loss: 1.145 Test Acc: 0.806
Validation loss decreased (-0.790611 --> -0.806239).  Saving model ...
Epoch: 7 cost time: 0.5355865955352783
Epoch: 7, Steps: 8 | Train Loss: 0.923 Vali Loss: 0.919 Vali Acc: 0.819 Test Loss: 0.919 Test Acc: 0.819
Validation loss decreased (-0.806239 --> -0.818741).  Saving model ...
Epoch: 8 cost time: 0.4991273880004883
Epoch: 8, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.738 Vali Acc: 0.825 Test Loss: 0.738 Test Acc: 0.825
Validation loss decreased (-0.818741 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.5586485862731934
Epoch: 9, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.616 Vali Acc: 0.831 Test Loss: 0.616 Test Acc: 0.831
Validation loss decreased (-0.824993 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 0.532623291015625
Epoch: 10, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.5391545295715332
Epoch: 11, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.490 Vali Acc: 0.866 Test Loss: 0.490 Test Acc: 0.866
Validation loss decreased (-0.846870 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 0.563380241394043
Epoch: 12, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5968832969665527
Epoch: 13, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5909953117370605
Epoch: 14, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.472 Vali Acc: 0.859 Test Loss: 0.472 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6018695831298828
Epoch: 15, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5241725444793701
Epoch: 16, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5466940402984619
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7093088626861572
Epoch: 18, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6449882984161377
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5236527919769287
Epoch: 20, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5188150405883789
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 310600
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9030988216400146
Epoch: 1, Steps: 8 | Train Loss: 2.048 Vali Loss: 2.034 Vali Acc: 0.181 Test Loss: 2.034 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 0.5727188587188721
Epoch: 2, Steps: 8 | Train Loss: 1.961 Vali Loss: 1.948 Vali Acc: 0.409 Test Loss: 1.948 Test Acc: 0.409
Validation loss decreased (-0.181230 --> -0.409356).  Saving model ...
Epoch: 3 cost time: 0.5650897026062012
Epoch: 3, Steps: 8 | Train Loss: 1.822 Vali Loss: 1.820 Vali Acc: 0.634 Test Loss: 1.820 Test Acc: 0.634
Validation loss decreased (-0.409356 --> -0.634357).  Saving model ...
Epoch: 4 cost time: 0.6312627792358398
Epoch: 4, Steps: 8 | Train Loss: 1.675 Vali Loss: 1.649 Vali Acc: 0.766 Test Loss: 1.649 Test Acc: 0.766
Validation loss decreased (-0.634357 --> -0.765609).  Saving model ...
Epoch: 5 cost time: 0.5522317886352539
Epoch: 5, Steps: 8 | Train Loss: 1.497 Vali Loss: 1.447 Vali Acc: 0.778 Test Loss: 1.447 Test Acc: 0.778
Validation loss decreased (-0.765609 --> -0.778111).  Saving model ...
Epoch: 6 cost time: 0.4977896213531494
Epoch: 6, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.235 Vali Acc: 0.797 Test Loss: 1.235 Test Acc: 0.797
Validation loss decreased (-0.778111 --> -0.796863).  Saving model ...
Epoch: 7 cost time: 0.46526360511779785
Epoch: 7, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.023 Vali Acc: 0.806 Test Loss: 1.023 Test Acc: 0.806
Validation loss decreased (-0.796863 --> -0.806240).  Saving model ...
Epoch: 8 cost time: 0.5301487445831299
Epoch: 8, Steps: 8 | Train Loss: 0.848 Vali Loss: 0.840 Vali Acc: 0.819 Test Loss: 0.840 Test Acc: 0.819
Validation loss decreased (-0.806240 --> -0.818742).  Saving model ...
Epoch: 9 cost time: 0.5010559558868408
Epoch: 9, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
Validation loss decreased (-0.818742 --> -0.828118).  Saving model ...
Epoch: 10 cost time: 0.5686607360839844
Epoch: 10, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 0.5343654155731201
Epoch: 11, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.5927298069000244
Epoch: 12, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.6921520233154297
Epoch: 13, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 0.5560531616210938
Epoch: 14, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 15 cost time: 0.602121114730835
Epoch: 15, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6507318019866943
Epoch: 16, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.428 Vali Acc: 0.866 Test Loss: 0.428 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865621).  Saving model ...
Epoch: 17 cost time: 0.6237466335296631
Epoch: 17, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.431 Vali Acc: 0.866 Test Loss: 0.431 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6727766990661621
Epoch: 18, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6661980152130127
Epoch: 19, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.440 Vali Acc: 0.859 Test Loss: 0.440 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6601836681365967
Epoch: 20, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.441 Vali Acc: 0.853 Test Loss: 0.441 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6319215297698975
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6697468757629395
Epoch: 22, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.440 Vali Acc: 0.856 Test Loss: 0.440 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6034817695617676
Epoch: 23, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5992188453674316
Epoch: 24, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5654919147491455
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5706841945648193
Epoch: 26, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 305416
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8781282901763916
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 2.058 Vali Acc: 0.141 Test Loss: 2.058 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 0.6399118900299072
Epoch: 2, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.984 Vali Acc: 0.322 Test Loss: 1.984 Test Acc: 0.322
Validation loss decreased (-0.140604 --> -0.321855).  Saving model ...
Epoch: 3 cost time: 0.6162288188934326
Epoch: 3, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.860 Vali Acc: 0.537 Test Loss: 1.860 Test Acc: 0.537
Validation loss decreased (-0.321855 --> -0.537481).  Saving model ...
Epoch: 4 cost time: 0.619194746017456
Epoch: 4, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.703 Vali Acc: 0.681 Test Loss: 1.703 Test Acc: 0.681
Validation loss decreased (-0.537481 --> -0.681233).  Saving model ...
Epoch: 5 cost time: 0.6409497261047363
Epoch: 5, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.520 Vali Acc: 0.759 Test Loss: 1.520 Test Acc: 0.759
Validation loss decreased (-0.681233 --> -0.759360).  Saving model ...
Epoch: 6 cost time: 0.6933238506317139
Epoch: 6, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.326 Vali Acc: 0.775 Test Loss: 1.326 Test Acc: 0.775
Validation loss decreased (-0.759360 --> -0.774987).  Saving model ...
Epoch: 7 cost time: 0.5856776237487793
Epoch: 7, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.130 Vali Acc: 0.797 Test Loss: 1.130 Test Acc: 0.797
Validation loss decreased (-0.774987 --> -0.796864).  Saving model ...
Epoch: 8 cost time: 0.6134343147277832
Epoch: 8, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.955 Vali Acc: 0.822 Test Loss: 0.955 Test Acc: 0.822
Validation loss decreased (-0.796864 --> -0.821865).  Saving model ...
Epoch: 9 cost time: 0.5996701717376709
Epoch: 9, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.802 Vali Acc: 0.831 Test Loss: 0.802 Test Acc: 0.831
Validation loss decreased (-0.821865 --> -0.831242).  Saving model ...
Epoch: 10 cost time: 0.6438257694244385
Epoch: 10, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
Validation loss decreased (-0.831242 --> -0.843743).  Saving model ...
Epoch: 11 cost time: 0.6351644992828369
Epoch: 11, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.600 Vali Acc: 0.863 Test Loss: 0.600 Test Acc: 0.863
Validation loss decreased (-0.843743 --> -0.862494).  Saving model ...
Epoch: 12 cost time: 0.7158982753753662
Epoch: 12, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
Validation loss decreased (-0.862494 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.6261122226715088
Epoch: 13, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.627589225769043
Epoch: 14, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5310254096984863
Epoch: 15, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 0.6222238540649414
Epoch: 16, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.442 Vali Acc: 0.869 Test Loss: 0.442 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868746).  Saving model ...
Epoch: 17 cost time: 0.5792794227600098
Epoch: 17, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.424 Vali Acc: 0.872 Test Loss: 0.424 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871871).  Saving model ...
Epoch: 18 cost time: 0.5509147644042969
Epoch: 18, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.421 Vali Acc: 0.869 Test Loss: 0.421 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5657732486724854
Epoch: 19, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
Validation loss decreased (-0.871871 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.5341510772705078
Epoch: 20, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.422 Vali Acc: 0.863 Test Loss: 0.422 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6294324398040771
Epoch: 21, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.426 Vali Acc: 0.866 Test Loss: 0.426 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5995750427246094
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.426 Vali Acc: 0.863 Test Loss: 0.426 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5144212245941162
Epoch: 23, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.430 Vali Acc: 0.863 Test Loss: 0.430 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5239124298095703
Epoch: 24, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.428 Vali Acc: 0.859 Test Loss: 0.428 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7354495525360107
Epoch: 25, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.424 Vali Acc: 0.869 Test Loss: 0.424 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5777182579040527
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.424 Vali Acc: 0.869 Test Loss: 0.424 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5764451026916504
Epoch: 27, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.437 Vali Acc: 0.869 Test Loss: 0.437 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5973904132843018
Epoch: 28, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6355397701263428
Epoch: 29, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.437 Vali Acc: 0.866 Test Loss: 0.437 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 303368
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8190937042236328
Epoch: 1, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.970 Vali Acc: 0.353 Test Loss: 1.970 Test Acc: 0.353
Validation loss decreased (inf --> -0.353105).  Saving model ...
Epoch: 2 cost time: 0.6196532249450684
Epoch: 2, Steps: 8 | Train Loss: 1.820 Vali Loss: 1.775 Vali Acc: 0.600 Test Loss: 1.775 Test Acc: 0.600
Validation loss decreased (-0.353105 --> -0.599982).  Saving model ...
Epoch: 3 cost time: 0.5621480941772461
Epoch: 3, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.495 Vali Acc: 0.753 Test Loss: 1.495 Test Acc: 0.753
Validation loss decreased (-0.599982 --> -0.753110).  Saving model ...
Epoch: 4 cost time: 0.5580565929412842
Epoch: 4, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.153 Vali Acc: 0.775 Test Loss: 1.153 Test Acc: 0.775
Validation loss decreased (-0.753110 --> -0.774988).  Saving model ...
Epoch: 5 cost time: 0.50197434425354
Epoch: 5, Steps: 8 | Train Loss: 0.829 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
Validation loss decreased (-0.774988 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 0.5218377113342285
Epoch: 6, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.799992 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.5795061588287354
Epoch: 7, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.818744 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.5694057941436768
Epoch: 8, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.605579137802124
Epoch: 9, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6357183456420898
Epoch: 10, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.5721042156219482
Epoch: 11, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.576021671295166
Epoch: 12, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.577392578125
Epoch: 13, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.610436201095581
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.647468090057373
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6271297931671143
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5969583988189697
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5603930950164795
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6519613265991211
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6141695976257324
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 137640
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9847819805145264
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 2.053 Vali Acc: 0.144 Test Loss: 2.053 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 0.6436071395874023
Epoch: 2, Steps: 8 | Train Loss: 1.966 Vali Loss: 1.965 Vali Acc: 0.356 Test Loss: 1.965 Test Acc: 0.356
Validation loss decreased (-0.143729 --> -0.356230).  Saving model ...
Epoch: 3 cost time: 0.5587303638458252
Epoch: 3, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.804 Vali Acc: 0.594 Test Loss: 1.804 Test Acc: 0.594
Validation loss decreased (-0.356230 --> -0.593732).  Saving model ...
Epoch: 4 cost time: 0.6247613430023193
Epoch: 4, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.575 Vali Acc: 0.750 Test Loss: 1.575 Test Acc: 0.750
Validation loss decreased (-0.593732 --> -0.749984).  Saving model ...
Epoch: 5 cost time: 0.6190905570983887
Epoch: 5, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.296 Vali Acc: 0.794 Test Loss: 1.296 Test Acc: 0.794
Validation loss decreased (-0.749984 --> -0.793737).  Saving model ...
Epoch: 6 cost time: 0.5432734489440918
Epoch: 6, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.018 Vali Acc: 0.806 Test Loss: 1.018 Test Acc: 0.806
Validation loss decreased (-0.793737 --> -0.806240).  Saving model ...
Epoch: 7 cost time: 0.59456467628479
Epoch: 7, Steps: 8 | Train Loss: 0.799 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.806240 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.550260066986084
Epoch: 8, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.5367391109466553
Epoch: 9, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.6835505962371826
Epoch: 10, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.586277961730957
Epoch: 11, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.6559982299804688
Epoch: 12, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6257262229919434
Epoch: 13, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.550600528717041
Epoch: 14, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6186878681182861
Epoch: 15, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6544404029846191
Epoch: 16, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5053954124450684
Epoch: 17, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5393126010894775
Epoch: 18, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.47655582427978516
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6970486640930176
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.589226245880127
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 108712
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9244213104248047
Epoch: 1, Steps: 8 | Train Loss: 2.029 Vali Loss: 2.023 Vali Acc: 0.222 Test Loss: 2.023 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 0.631950855255127
Epoch: 2, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.953 Vali Acc: 0.397 Test Loss: 1.953 Test Acc: 0.397
Validation loss decreased (-0.221855 --> -0.396855).  Saving model ...
Epoch: 3 cost time: 0.6168169975280762
Epoch: 3, Steps: 8 | Train Loss: 1.822 Vali Loss: 1.833 Vali Acc: 0.634 Test Loss: 1.833 Test Acc: 0.634
Validation loss decreased (-0.396855 --> -0.634357).  Saving model ...
Epoch: 4 cost time: 0.5748324394226074
Epoch: 4, Steps: 8 | Train Loss: 1.669 Vali Loss: 1.669 Vali Acc: 0.700 Test Loss: 1.669 Test Acc: 0.700
Validation loss decreased (-0.634357 --> -0.699983).  Saving model ...
Epoch: 5 cost time: 0.7046356201171875
Epoch: 5, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.472 Vali Acc: 0.756 Test Loss: 1.472 Test Acc: 0.756
Validation loss decreased (-0.699983 --> -0.756235).  Saving model ...
Epoch: 6 cost time: 0.6203458309173584
Epoch: 6, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.254 Vali Acc: 0.797 Test Loss: 1.254 Test Acc: 0.797
Validation loss decreased (-0.756235 --> -0.796862).  Saving model ...
Epoch: 7 cost time: 0.5210282802581787
Epoch: 7, Steps: 8 | Train Loss: 1.054 Vali Loss: 1.046 Vali Acc: 0.784 Test Loss: 1.046 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6336286067962646
Epoch: 8, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.861 Vali Acc: 0.797 Test Loss: 0.861 Test Acc: 0.797
Validation loss decreased (-0.796862 --> -0.796866).  Saving model ...
Epoch: 9 cost time: 0.7469568252563477
Epoch: 9, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.710 Vali Acc: 0.834 Test Loss: 0.710 Test Acc: 0.834
Validation loss decreased (-0.796866 --> -0.834368).  Saving model ...
Epoch: 10 cost time: 0.749711275100708
Epoch: 10, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.609 Vali Acc: 0.834 Test Loss: 0.609 Test Acc: 0.834
Validation loss decreased (-0.834368 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 0.5532476902008057
Epoch: 11, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.834369 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.5664663314819336
Epoch: 12, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.6042704582214355
Epoch: 13, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.6249229907989502
Epoch: 14, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.6225550174713135
Epoch: 15, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.585578203201294
Epoch: 16, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5459625720977783
Epoch: 17, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 0.5575146675109863
Epoch: 18, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 19 cost time: 0.6017320156097412
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.56903076171875
Epoch: 20, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5498459339141846
Epoch: 21, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5838186740875244
Epoch: 22, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5098378658294678
Epoch: 23, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6306700706481934
Epoch: 24, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.625007152557373
Epoch: 25, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5714526176452637
Epoch: 26, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6180367469787598
Epoch: 27, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5610649585723877
Epoch: 28, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 98216
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.907735824584961
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 2.090 Vali Acc: 0.134 Test Loss: 2.090 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 0.6391217708587646
Epoch: 2, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.048 Vali Acc: 0.159 Test Loss: 2.048 Test Acc: 0.159
Validation loss decreased (-0.134354 --> -0.159355).  Saving model ...
Epoch: 3 cost time: 0.6811525821685791
Epoch: 3, Steps: 8 | Train Loss: 2.024 Vali Loss: 1.972 Vali Acc: 0.253 Test Loss: 1.972 Test Acc: 0.253
Validation loss decreased (-0.159355 --> -0.253105).  Saving model ...
Epoch: 4 cost time: 0.6520547866821289
Epoch: 4, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.862 Vali Acc: 0.394 Test Loss: 1.862 Test Acc: 0.394
Validation loss decreased (-0.253105 --> -0.393731).  Saving model ...
Epoch: 5 cost time: 0.6509478092193604
Epoch: 5, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.723 Vali Acc: 0.603 Test Loss: 1.723 Test Acc: 0.603
Validation loss decreased (-0.393731 --> -0.603108).  Saving model ...
Epoch: 6 cost time: 0.5771458148956299
Epoch: 6, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.564 Vali Acc: 0.700 Test Loss: 1.564 Test Acc: 0.700
Validation loss decreased (-0.603108 --> -0.699984).  Saving model ...
Epoch: 7 cost time: 0.660879373550415
Epoch: 7, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.378 Vali Acc: 0.762 Test Loss: 1.378 Test Acc: 0.762
Validation loss decreased (-0.699984 --> -0.762486).  Saving model ...
Epoch: 8 cost time: 0.5111217498779297
Epoch: 8, Steps: 8 | Train Loss: 1.220 Vali Loss: 1.174 Vali Acc: 0.803 Test Loss: 1.174 Test Acc: 0.803
Validation loss decreased (-0.762486 --> -0.803113).  Saving model ...
Epoch: 9 cost time: 0.5113368034362793
Epoch: 9, Steps: 8 | Train Loss: 0.978 Vali Loss: 0.976 Vali Acc: 0.825 Test Loss: 0.976 Test Acc: 0.825
Validation loss decreased (-0.803113 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.6406137943267822
Epoch: 10, Steps: 8 | Train Loss: 0.802 Vali Loss: 0.812 Vali Acc: 0.819 Test Loss: 0.812 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.573016881942749
Epoch: 11, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
Validation loss decreased (-0.824990 --> -0.828118).  Saving model ...
Epoch: 12 cost time: 0.5865702629089355
Epoch: 12, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.603 Vali Acc: 0.834 Test Loss: 0.603 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 0.5154612064361572
Epoch: 13, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.834369 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.5218493938446045
Epoch: 14, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 0.5733158588409424
Epoch: 15, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.485 Vali Acc: 0.866 Test Loss: 0.485 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 0.5018248558044434
Epoch: 16, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.472 Vali Acc: 0.859 Test Loss: 0.472 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5337264537811279
Epoch: 17, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.48737239837646484
Epoch: 18, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6294112205505371
Epoch: 19, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6379363536834717
Epoch: 20, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6114864349365234
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6734397411346436
Epoch: 22, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6390721797943115
Epoch: 23, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6565060615539551
Epoch: 24, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.746490478515625
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 93864
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9079327583312988
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 2.107 Vali Acc: 0.103 Test Loss: 2.107 Test Acc: 0.103
Validation loss decreased (inf --> -0.103104).  Saving model ...
Epoch: 2 cost time: 0.5743539333343506
Epoch: 2, Steps: 8 | Train Loss: 2.080 Vali Loss: 2.067 Vali Acc: 0.159 Test Loss: 2.067 Test Acc: 0.159
Validation loss decreased (-0.103104 --> -0.159354).  Saving model ...
Epoch: 3 cost time: 0.5154106616973877
Epoch: 3, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.991 Vali Acc: 0.259 Test Loss: 1.991 Test Acc: 0.259
Validation loss decreased (-0.159354 --> -0.259355).  Saving model ...
Epoch: 4 cost time: 0.6684210300445557
Epoch: 4, Steps: 8 | Train Loss: 1.904 Vali Loss: 1.883 Vali Acc: 0.431 Test Loss: 1.883 Test Acc: 0.431
Validation loss decreased (-0.259355 --> -0.431231).  Saving model ...
Epoch: 5 cost time: 0.6130247116088867
Epoch: 5, Steps: 8 | Train Loss: 1.772 Vali Loss: 1.747 Vali Acc: 0.581 Test Loss: 1.747 Test Acc: 0.581
Validation loss decreased (-0.431231 --> -0.581233).  Saving model ...
Epoch: 6 cost time: 0.544335126876831
Epoch: 6, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.589 Vali Acc: 0.700 Test Loss: 1.589 Test Acc: 0.700
Validation loss decreased (-0.581233 --> -0.699984).  Saving model ...
Epoch: 7 cost time: 0.5667088031768799
Epoch: 7, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.413 Vali Acc: 0.759 Test Loss: 1.413 Test Acc: 0.759
Validation loss decreased (-0.699984 --> -0.759361).  Saving model ...
Epoch: 8 cost time: 0.6596391201019287
Epoch: 8, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.234 Vali Acc: 0.800 Test Loss: 1.234 Test Acc: 0.800
Validation loss decreased (-0.759361 --> -0.799988).  Saving model ...
Epoch: 9 cost time: 0.5306906700134277
Epoch: 9, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.056 Vali Acc: 0.819 Test Loss: 1.056 Test Acc: 0.819
Validation loss decreased (-0.799988 --> -0.818739).  Saving model ...
Epoch: 10 cost time: 0.5424997806549072
Epoch: 10, Steps: 8 | Train Loss: 0.925 Vali Loss: 0.897 Vali Acc: 0.828 Test Loss: 0.897 Test Acc: 0.828
Validation loss decreased (-0.818739 --> -0.828116).  Saving model ...
Epoch: 11 cost time: 0.726475715637207
Epoch: 11, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.770 Vali Acc: 0.834 Test Loss: 0.770 Test Acc: 0.834
Validation loss decreased (-0.828116 --> -0.834367).  Saving model ...
Epoch: 12 cost time: 0.6651077270507812
Epoch: 12, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.668 Vali Acc: 0.834 Test Loss: 0.668 Test Acc: 0.834
Validation loss decreased (-0.834367 --> -0.834368).  Saving model ...
Epoch: 13 cost time: 0.6542131900787354
Epoch: 13, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
Validation loss decreased (-0.834368 --> -0.856244).  Saving model ...
Epoch: 14 cost time: 0.6504120826721191
Epoch: 14, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5842161178588867
Epoch: 15, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
Validation loss decreased (-0.856244 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 0.5809354782104492
Epoch: 16, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.496 Vali Acc: 0.869 Test Loss: 0.496 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 17 cost time: 0.5806419849395752
Epoch: 17, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.478 Vali Acc: 0.866 Test Loss: 0.478 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6342935562133789
Epoch: 18, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.465 Vali Acc: 0.866 Test Loss: 0.465 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6572763919830322
Epoch: 19, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.456 Vali Acc: 0.859 Test Loss: 0.456 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.550243616104126
Epoch: 20, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5910477638244629
Epoch: 21, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6163089275360107
Epoch: 22, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.447 Vali Acc: 0.866 Test Loss: 0.447 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6356503963470459
Epoch: 23, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868746).  Saving model ...
Epoch: 24 cost time: 0.6098334789276123
Epoch: 24, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.445 Vali Acc: 0.872 Test Loss: 0.445 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871871).  Saving model ...
Epoch: 25 cost time: 0.5647315979003906
Epoch: 25, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.443 Vali Acc: 0.866 Test Loss: 0.443 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6315393447875977
Epoch: 26, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6306228637695312
Epoch: 27, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.452 Vali Acc: 0.866 Test Loss: 0.452 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5336298942565918
Epoch: 28, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.453 Vali Acc: 0.869 Test Loss: 0.453 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6083731651306152
Epoch: 29, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6612820625305176
Epoch: 30, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.457 Vali Acc: 0.869 Test Loss: 0.457 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6823458671569824
Epoch: 31, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
Validation loss decreased (-0.871871 --> -0.878120).  Saving model ...
Epoch: 32 cost time: 0.66558837890625
Epoch: 32, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6164364814758301
Epoch: 33, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.476 Vali Acc: 0.869 Test Loss: 0.476 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6911892890930176
Epoch: 34, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.487 Vali Acc: 0.866 Test Loss: 0.487 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6498937606811523
Epoch: 35, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.489 Vali Acc: 0.869 Test Loss: 0.489 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5412240028381348
Epoch: 36, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.487 Vali Acc: 0.866 Test Loss: 0.487 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5455689430236816
Epoch: 37, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.492 Vali Acc: 0.869 Test Loss: 0.492 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5173776149749756
Epoch: 38, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.494 Vali Acc: 0.869 Test Loss: 0.494 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5668141841888428
Epoch: 39, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.490 Vali Acc: 0.869 Test Loss: 0.490 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5508341789245605
Epoch: 40, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.492 Vali Acc: 0.866 Test Loss: 0.492 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5773954391479492
Epoch: 41, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.869 Test Loss: 0.495 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 89768
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7453126907348633
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.089 Vali Acc: 0.087 Test Loss: 2.089 Test Acc: 0.087
Validation loss decreased (inf --> -0.087479).  Saving model ...
Epoch: 2 cost time: 0.5328166484832764
Epoch: 2, Steps: 8 | Train Loss: 2.065 Vali Loss: 2.053 Vali Acc: 0.141 Test Loss: 2.053 Test Acc: 0.141
Validation loss decreased (-0.087479 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 0.5816738605499268
Epoch: 3, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.997 Vali Acc: 0.247 Test Loss: 1.997 Test Acc: 0.247
Validation loss decreased (-0.140604 --> -0.246855).  Saving model ...
Epoch: 4 cost time: 0.647590160369873
Epoch: 4, Steps: 8 | Train Loss: 1.927 Vali Loss: 1.923 Vali Acc: 0.369 Test Loss: 1.923 Test Acc: 0.369
Validation loss decreased (-0.246855 --> -0.368731).  Saving model ...
Epoch: 5 cost time: 0.6515159606933594
Epoch: 5, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.832 Vali Acc: 0.469 Test Loss: 1.832 Test Acc: 0.469
Validation loss decreased (-0.368731 --> -0.468732).  Saving model ...
Epoch: 6 cost time: 0.5145931243896484
Epoch: 6, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.725 Vali Acc: 0.584 Test Loss: 1.725 Test Acc: 0.584
Validation loss decreased (-0.468732 --> -0.584358).  Saving model ...
Epoch: 7 cost time: 0.5981590747833252
Epoch: 7, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.607 Vali Acc: 0.672 Test Loss: 1.607 Test Acc: 0.672
Validation loss decreased (-0.584358 --> -0.671859).  Saving model ...
Epoch: 8 cost time: 0.607229471206665
Epoch: 8, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.478 Vali Acc: 0.713 Test Loss: 1.478 Test Acc: 0.713
Validation loss decreased (-0.671859 --> -0.712485).  Saving model ...
Epoch: 9 cost time: 0.5310094356536865
Epoch: 9, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.336 Vali Acc: 0.766 Test Loss: 1.336 Test Acc: 0.766
Validation loss decreased (-0.712485 --> -0.765612).  Saving model ...
Epoch: 10 cost time: 0.5924994945526123
Epoch: 10, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.192 Vali Acc: 0.781 Test Loss: 1.192 Test Acc: 0.781
Validation loss decreased (-0.765612 --> -0.781238).  Saving model ...
Epoch: 11 cost time: 0.5703096389770508
Epoch: 11, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.051 Vali Acc: 0.797 Test Loss: 1.051 Test Acc: 0.797
Validation loss decreased (-0.781238 --> -0.796864).  Saving model ...
Epoch: 12 cost time: 0.5684735774993896
Epoch: 12, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.928 Vali Acc: 0.800 Test Loss: 0.928 Test Acc: 0.800
Validation loss decreased (-0.796864 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.651634931564331
Epoch: 13, Steps: 8 | Train Loss: 0.739 Vali Loss: 0.816 Vali Acc: 0.812 Test Loss: 0.816 Test Acc: 0.812
Validation loss decreased (-0.799991 --> -0.812492).  Saving model ...
Epoch: 14 cost time: 0.6165602207183838
Epoch: 14, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.727 Vali Acc: 0.822 Test Loss: 0.727 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821868).  Saving model ...
Epoch: 15 cost time: 0.6495251655578613
Epoch: 15, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.5578911304473877
Epoch: 16, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 17 cost time: 0.6084690093994141
Epoch: 17, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 18 cost time: 0.5427470207214355
Epoch: 18, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.545 Vali Acc: 0.834 Test Loss: 0.545 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 19 cost time: 0.6083931922912598
Epoch: 19, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5316016674041748
Epoch: 20, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 21 cost time: 0.5926852226257324
Epoch: 21, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 22 cost time: 0.5401301383972168
Epoch: 22, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 23 cost time: 0.6193938255310059
Epoch: 23, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5258235931396484
Epoch: 24, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 25 cost time: 0.6078100204467773
Epoch: 25, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.580561637878418
Epoch: 26, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.549229621887207
Epoch: 27, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 28 cost time: 0.5822947025299072
Epoch: 28, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5575602054595947
Epoch: 29, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5523512363433838
Epoch: 30, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.452 Vali Acc: 0.844 Test Loss: 0.452 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5862250328063965
Epoch: 31, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849996).  Saving model ...
Epoch: 32 cost time: 0.5483202934265137
Epoch: 32, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.502845048904419
Epoch: 33, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.48095130920410156
Epoch: 34, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6411335468292236
Epoch: 35, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5605959892272949
Epoch: 36, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5913980007171631
Epoch: 37, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
Validation loss decreased (-0.849996 --> -0.853120).  Saving model ...
Epoch: 38 cost time: 0.5708940029144287
Epoch: 38, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 39 cost time: 0.6258542537689209
Epoch: 39, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6473312377929688
Epoch: 40, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5549688339233398
Epoch: 41, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6074690818786621
Epoch: 42, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7266626358032227
Epoch: 43, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5340559482574463
Epoch: 44, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.47982192039489746
Epoch: 45, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5129680633544922
Epoch: 46, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.47146177291870117
Epoch: 47, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5744132995605469
Epoch: 48, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 49 cost time: 0.543621301651001
Epoch: 49, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5482265949249268
Epoch: 50, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 87176
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.723710060119629
Epoch: 1, Steps: 8 | Train Loss: 2.079 Vali Loss: 2.049 Vali Acc: 0.172 Test Loss: 2.049 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 0.5777151584625244
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 2.014 Vali Acc: 0.216 Test Loss: 2.014 Test Acc: 0.216
Validation loss decreased (-0.171855 --> -0.215605).  Saving model ...
Epoch: 3 cost time: 0.5135087966918945
Epoch: 3, Steps: 8 | Train Loss: 1.973 Vali Loss: 1.954 Vali Acc: 0.303 Test Loss: 1.954 Test Acc: 0.303
Validation loss decreased (-0.215605 --> -0.303105).  Saving model ...
Epoch: 4 cost time: 0.5275716781616211
Epoch: 4, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.876 Vali Acc: 0.431 Test Loss: 1.876 Test Acc: 0.431
Validation loss decreased (-0.303105 --> -0.431231).  Saving model ...
Epoch: 5 cost time: 0.5680201053619385
Epoch: 5, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.784 Vali Acc: 0.559 Test Loss: 1.784 Test Acc: 0.559
Validation loss decreased (-0.431231 --> -0.559357).  Saving model ...
Epoch: 6 cost time: 0.5396170616149902
Epoch: 6, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.683 Vali Acc: 0.634 Test Loss: 1.683 Test Acc: 0.634
Validation loss decreased (-0.559357 --> -0.634358).  Saving model ...
Epoch: 7 cost time: 0.5412797927856445
Epoch: 7, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.575 Vali Acc: 0.681 Test Loss: 1.575 Test Acc: 0.681
Validation loss decreased (-0.634358 --> -0.681234).  Saving model ...
Epoch: 8 cost time: 0.5254843235015869
Epoch: 8, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.463 Vali Acc: 0.741 Test Loss: 1.463 Test Acc: 0.741
Validation loss decreased (-0.681234 --> -0.740610).  Saving model ...
Epoch: 9 cost time: 0.6213369369506836
Epoch: 9, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.344 Vali Acc: 0.756 Test Loss: 1.344 Test Acc: 0.756
Validation loss decreased (-0.740610 --> -0.756237).  Saving model ...
Epoch: 10 cost time: 0.5498056411743164
Epoch: 10, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.220 Vali Acc: 0.772 Test Loss: 1.220 Test Acc: 0.772
Validation loss decreased (-0.756237 --> -0.771863).  Saving model ...
Epoch: 11 cost time: 0.6795799732208252
Epoch: 11, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.101 Vali Acc: 0.772 Test Loss: 1.101 Test Acc: 0.772
Validation loss decreased (-0.771863 --> -0.771864).  Saving model ...
Epoch: 12 cost time: 0.5541126728057861
Epoch: 12, Steps: 8 | Train Loss: 0.985 Vali Loss: 0.989 Vali Acc: 0.794 Test Loss: 0.989 Test Acc: 0.794
Validation loss decreased (-0.771864 --> -0.793740).  Saving model ...
Epoch: 13 cost time: 0.5318362712860107
Epoch: 13, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.888 Vali Acc: 0.797 Test Loss: 0.888 Test Acc: 0.797
Validation loss decreased (-0.793740 --> -0.796866).  Saving model ...
Epoch: 14 cost time: 0.49562692642211914
Epoch: 14, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.803 Vali Acc: 0.803 Test Loss: 0.803 Test Acc: 0.803
Validation loss decreased (-0.796866 --> -0.803117).  Saving model ...
Epoch: 15 cost time: 0.4749007225036621
Epoch: 15, Steps: 8 | Train Loss: 0.694 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
Validation loss decreased (-0.803117 --> -0.809368).  Saving model ...
Epoch: 16 cost time: 0.621891975402832
Epoch: 16, Steps: 8 | Train Loss: 0.606 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818743).  Saving model ...
Epoch: 17 cost time: 0.49614930152893066
Epoch: 17, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 0.4793057441711426
Epoch: 18, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.581 Vali Acc: 0.831 Test Loss: 0.581 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 19 cost time: 0.6095554828643799
Epoch: 19, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 20 cost time: 0.5964648723602295
Epoch: 20, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 0.5939044952392578
Epoch: 21, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 0.5666828155517578
Epoch: 22, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5521376132965088
Epoch: 23, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.5604264736175537
Epoch: 24, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6768350601196289
Epoch: 25, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.461 Vali Acc: 0.838 Test Loss: 0.461 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5941753387451172
Epoch: 26, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5871343612670898
Epoch: 27, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5819568634033203
Epoch: 28, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862496).  Saving model ...
Epoch: 29 cost time: 0.5465009212493896
Epoch: 29, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5327847003936768
Epoch: 30, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5242068767547607
Epoch: 31, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.443 Vali Acc: 0.847 Test Loss: 0.443 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.537299394607544
Epoch: 32, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.45862531661987305
Epoch: 33, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.438 Vali Acc: 0.856 Test Loss: 0.438 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.4957540035247803
Epoch: 34, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5244321823120117
Epoch: 35, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.50042724609375
Epoch: 36, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.438 Vali Acc: 0.847 Test Loss: 0.438 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5242233276367188
Epoch: 37, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.49288463592529297
Epoch: 38, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 86152
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9993031024932861
Epoch: 1, Steps: 8 | Train Loss: 1.996 Vali Loss: 1.878 Vali Acc: 0.594 Test Loss: 1.878 Test Acc: 0.594
Validation loss decreased (inf --> -0.593731).  Saving model ...
Epoch: 2 cost time: 0.773155927658081
Epoch: 2, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.261 Vali Acc: 0.772 Test Loss: 1.261 Test Acc: 0.772
Validation loss decreased (-0.593731 --> -0.771862).  Saving model ...
Epoch: 3 cost time: 0.6717562675476074
Epoch: 3, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.771862 --> -0.824993).  Saving model ...
Epoch: 4 cost time: 0.7939987182617188
Epoch: 4, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.481 Vali Acc: 0.866 Test Loss: 0.481 Test Acc: 0.866
Validation loss decreased (-0.824993 --> -0.865620).  Saving model ...
Epoch: 5 cost time: 0.742560625076294
Epoch: 5, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7466099262237549
Epoch: 6, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.620429515838623
Epoch: 7, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.585 Vali Acc: 0.834 Test Loss: 0.585 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6609971523284912
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6287426948547363
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.803 Vali Acc: 0.828 Test Loss: 0.803 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7616550922393799
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.814 Vali Acc: 0.822 Test Loss: 0.814 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6605913639068604
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.823 Vali Acc: 0.831 Test Loss: 0.823 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6092541217803955
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.822 Test Loss: 0.841 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7257652282714844
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.828 Test Loss: 0.853 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6799826622009277
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.831 Test Loss: 0.861 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 1332360
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9390254020690918
Epoch: 1, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.940 Vali Acc: 0.497 Test Loss: 1.940 Test Acc: 0.497
Validation loss decreased (inf --> -0.496856).  Saving model ...
Epoch: 2 cost time: 0.6500532627105713
Epoch: 2, Steps: 8 | Train Loss: 1.680 Vali Loss: 1.580 Vali Acc: 0.750 Test Loss: 1.580 Test Acc: 0.750
Validation loss decreased (-0.496856 --> -0.749984).  Saving model ...
Epoch: 3 cost time: 0.7227921485900879
Epoch: 3, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.057 Vali Acc: 0.806 Test Loss: 1.057 Test Acc: 0.806
Validation loss decreased (-0.749984 --> -0.806239).  Saving model ...
Epoch: 4 cost time: 0.6876046657562256
Epoch: 4, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.653 Vali Acc: 0.812 Test Loss: 0.653 Test Acc: 0.812
Validation loss decreased (-0.806239 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 0.6087756156921387
Epoch: 5, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
Validation loss decreased (-0.812493 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.5247812271118164
Epoch: 6, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5142590999603271
Epoch: 7, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5201494693756104
Epoch: 8, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5578305721282959
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6354477405548096
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.571 Vali Acc: 0.838 Test Loss: 0.571 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6564886569976807
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.831 Test Loss: 0.602 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7328758239746094
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.828 Test Loss: 0.629 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7502989768981934
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.831 Test Loss: 0.636 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7568869590759277
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7369046211242676
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.666 Vali Acc: 0.834 Test Loss: 0.666 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1216648
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9604284763336182
Epoch: 1, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.978 Vali Acc: 0.359 Test Loss: 1.978 Test Acc: 0.359
Validation loss decreased (inf --> -0.359355).  Saving model ...
Epoch: 2 cost time: 0.6633367538452148
Epoch: 2, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.694 Vali Acc: 0.722 Test Loss: 1.694 Test Acc: 0.722
Validation loss decreased (-0.359355 --> -0.721858).  Saving model ...
Epoch: 3 cost time: 0.6455049514770508
Epoch: 3, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.278 Vali Acc: 0.778 Test Loss: 1.278 Test Acc: 0.778
Validation loss decreased (-0.721858 --> -0.778112).  Saving model ...
Epoch: 4 cost time: 0.5972492694854736
Epoch: 4, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.778112 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.5618433952331543
Epoch: 5, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
Validation loss decreased (-0.799991 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.5662031173706055
Epoch: 6, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.4767756462097168
Epoch: 7, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.6171755790710449
Epoch: 8, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5653507709503174
Epoch: 9, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5656468868255615
Epoch: 10, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5209658145904541
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5318589210510254
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.57389235496521
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5606939792633057
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.583 Vali Acc: 0.831 Test Loss: 0.583 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5067195892333984
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.598 Vali Acc: 0.831 Test Loss: 0.598 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.655292272567749
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.605 Vali Acc: 0.838 Test Loss: 0.605 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6386263370513916
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.834 Test Loss: 0.612 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1174664
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9841902256011963
Epoch: 1, Steps: 8 | Train Loss: 2.057 Vali Loss: 2.008 Vali Acc: 0.287 Test Loss: 2.008 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 0.6613869667053223
Epoch: 2, Steps: 8 | Train Loss: 1.847 Vali Loss: 1.772 Vali Acc: 0.662 Test Loss: 1.772 Test Acc: 0.662
Validation loss decreased (-0.287480 --> -0.662482).  Saving model ...
Epoch: 3 cost time: 0.6474118232727051
Epoch: 3, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.399 Vali Acc: 0.787 Test Loss: 1.399 Test Acc: 0.787
Validation loss decreased (-0.662482 --> -0.787486).  Saving model ...
Epoch: 4 cost time: 0.6349515914916992
Epoch: 4, Steps: 8 | Train Loss: 1.032 Vali Loss: 0.971 Vali Acc: 0.806 Test Loss: 0.971 Test Acc: 0.806
Validation loss decreased (-0.787486 --> -0.806240).  Saving model ...
Epoch: 5 cost time: 0.6913526058197021
Epoch: 5, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.642 Vali Acc: 0.834 Test Loss: 0.642 Test Acc: 0.834
Validation loss decreased (-0.806240 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 0.6278972625732422
Epoch: 6, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
Validation loss decreased (-0.834369 --> -0.871870).  Saving model ...
Epoch: 7 cost time: 0.6421933174133301
Epoch: 7, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.433 Vali Acc: 0.869 Test Loss: 0.433 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7486190795898438
Epoch: 8, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.429 Vali Acc: 0.869 Test Loss: 0.429 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6792550086975098
Epoch: 9, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.424 Vali Acc: 0.866 Test Loss: 0.424 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.613006591796875
Epoch: 10, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.447 Vali Acc: 0.866 Test Loss: 0.447 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5881586074829102
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6778542995452881
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6052041053771973
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5863645076751709
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6351141929626465
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6444156169891357
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1157256
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8849828243255615
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.030 Vali Acc: 0.184 Test Loss: 2.030 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 0.6021931171417236
Epoch: 2, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.834 Vali Acc: 0.569 Test Loss: 1.834 Test Acc: 0.569
Validation loss decreased (-0.184355 --> -0.568732).  Saving model ...
Epoch: 3 cost time: 0.5952694416046143
Epoch: 3, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.523 Vali Acc: 0.794 Test Loss: 1.523 Test Acc: 0.794
Validation loss decreased (-0.568732 --> -0.793735).  Saving model ...
Epoch: 4 cost time: 0.66764235496521
Epoch: 4, Steps: 8 | Train Loss: 1.203 Vali Loss: 1.144 Vali Acc: 0.822 Test Loss: 1.144 Test Acc: 0.822
Validation loss decreased (-0.793735 --> -0.821864).  Saving model ...
Epoch: 5 cost time: 0.6521480083465576
Epoch: 5, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.798 Vali Acc: 0.825 Test Loss: 0.798 Test Acc: 0.825
Validation loss decreased (-0.821864 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 0.6405861377716064
Epoch: 6, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
Validation loss decreased (-0.824992 --> -0.840619).  Saving model ...
Epoch: 7 cost time: 0.6059584617614746
Epoch: 7, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
Validation loss decreased (-0.840619 --> -0.865620).  Saving model ...
Epoch: 8 cost time: 0.660621166229248
Epoch: 8, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.437 Vali Acc: 0.863 Test Loss: 0.437 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5779547691345215
Epoch: 9, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.430 Vali Acc: 0.869 Test Loss: 0.430 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868746).  Saving model ...
Epoch: 10 cost time: 0.6193995475769043
Epoch: 10, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6479153633117676
Epoch: 11, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6984744071960449
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.456 Vali Acc: 0.853 Test Loss: 0.456 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5858728885650635
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6629726886749268
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6082708835601807
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5862302780151367
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6248841285705566
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5376574993133545
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7160642147064209
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 1140872
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.798860788345337
Epoch: 1, Steps: 8 | Train Loss: 2.135 Vali Loss: 2.050 Vali Acc: 0.181 Test Loss: 2.050 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 0.5300087928771973
Epoch: 2, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.885 Vali Acc: 0.544 Test Loss: 1.885 Test Acc: 0.544
Validation loss decreased (-0.181230 --> -0.543731).  Saving model ...
Epoch: 3 cost time: 0.612309455871582
Epoch: 3, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.630 Vali Acc: 0.738 Test Loss: 1.630 Test Acc: 0.738
Validation loss decreased (-0.543731 --> -0.737484).  Saving model ...
Epoch: 4 cost time: 0.6147098541259766
Epoch: 4, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.310 Vali Acc: 0.775 Test Loss: 1.310 Test Acc: 0.775
Validation loss decreased (-0.737484 --> -0.774987).  Saving model ...
Epoch: 5 cost time: 0.5904827117919922
Epoch: 5, Steps: 8 | Train Loss: 1.038 Vali Loss: 0.985 Vali Acc: 0.794 Test Loss: 0.985 Test Acc: 0.794
Validation loss decreased (-0.774987 --> -0.793740).  Saving model ...
Epoch: 6 cost time: 0.6630764007568359
Epoch: 6, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.724 Vali Acc: 0.828 Test Loss: 0.724 Test Acc: 0.828
Validation loss decreased (-0.793740 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 0.5902485847473145
Epoch: 7, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6085014343261719
Epoch: 8, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.828118 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.6112716197967529
Epoch: 9, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.442 Vali Acc: 0.856 Test Loss: 0.442 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856246).  Saving model ...
Epoch: 10 cost time: 0.6125009059906006
Epoch: 10, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.431 Vali Acc: 0.866 Test Loss: 0.431 Test Acc: 0.866
Validation loss decreased (-0.856246 --> -0.865621).  Saving model ...
Epoch: 11 cost time: 0.6123344898223877
Epoch: 11, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6419553756713867
Epoch: 12, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6258633136749268
Epoch: 13, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.610034704208374
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6043834686279297
Epoch: 15, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6655900478363037
Epoch: 16, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6756494045257568
Epoch: 17, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.486 Vali Acc: 0.831 Test Loss: 0.486 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6288347244262695
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6153383255004883
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5446584224700928
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 1130504
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7854275703430176
Epoch: 1, Steps: 8 | Train Loss: 2.045 Vali Loss: 2.026 Vali Acc: 0.194 Test Loss: 2.026 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.6638891696929932
Epoch: 2, Steps: 8 | Train Loss: 1.908 Vali Loss: 1.867 Vali Acc: 0.422 Test Loss: 1.867 Test Acc: 0.422
Validation loss decreased (-0.193730 --> -0.421856).  Saving model ...
Epoch: 3 cost time: 0.6822073459625244
Epoch: 3, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.621 Vali Acc: 0.644 Test Loss: 1.621 Test Acc: 0.644
Validation loss decreased (-0.421856 --> -0.643734).  Saving model ...
Epoch: 4 cost time: 0.650214433670044
Epoch: 4, Steps: 8 | Train Loss: 1.374 Vali Loss: 1.320 Vali Acc: 0.722 Test Loss: 1.320 Test Acc: 0.722
Validation loss decreased (-0.643734 --> -0.721862).  Saving model ...
Epoch: 5 cost time: 0.6311631202697754
Epoch: 5, Steps: 8 | Train Loss: 1.077 Vali Loss: 1.024 Vali Acc: 0.787 Test Loss: 1.024 Test Acc: 0.787
Validation loss decreased (-0.721862 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.6186041831970215
Epoch: 6, Steps: 8 | Train Loss: 0.789 Vali Loss: 0.784 Vali Acc: 0.806 Test Loss: 0.784 Test Acc: 0.806
Validation loss decreased (-0.787490 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.556861400604248
Epoch: 7, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
Validation loss decreased (-0.806242 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.5678553581237793
Epoch: 8, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.5669651031494141
Epoch: 9, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.6312401294708252
Epoch: 10, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.60964035987854
Epoch: 11, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.443 Vali Acc: 0.853 Test Loss: 0.443 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5260984897613525
Epoch: 12, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856246).  Saving model ...
Epoch: 13 cost time: 0.6072931289672852
Epoch: 13, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5587427616119385
Epoch: 14, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6385645866394043
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6437604427337646
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.653031587600708
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6421999931335449
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.856246 --> -0.859370).  Saving model ...
Epoch: 19 cost time: 0.6949419975280762
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6552650928497314
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6731877326965332
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.474 Vali Acc: 0.859 Test Loss: 0.474 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6029906272888184
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5955874919891357
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.477 Vali Acc: 0.859 Test Loss: 0.477 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6251592636108398
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5565962791442871
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.582202672958374
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.632737398147583
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6956965923309326
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1126408
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9548368453979492
Epoch: 1, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.973 Vali Acc: 0.381 Test Loss: 1.973 Test Acc: 0.381
Validation loss decreased (inf --> -0.381230).  Saving model ...
Epoch: 2 cost time: 0.5489933490753174
Epoch: 2, Steps: 8 | Train Loss: 1.701 Vali Loss: 1.650 Vali Acc: 0.681 Test Loss: 1.650 Test Acc: 0.681
Validation loss decreased (-0.381230 --> -0.681233).  Saving model ...
Epoch: 3 cost time: 0.5910618305206299
Epoch: 3, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.179 Vali Acc: 0.787 Test Loss: 1.179 Test Acc: 0.787
Validation loss decreased (-0.681233 --> -0.787488).  Saving model ...
Epoch: 4 cost time: 0.5145449638366699
Epoch: 4, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.767 Vali Acc: 0.806 Test Loss: 0.767 Test Acc: 0.806
Validation loss decreased (-0.787488 --> -0.806242).  Saving model ...
Epoch: 5 cost time: 0.500347375869751
Epoch: 5, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
Validation loss decreased (-0.806242 --> -0.840619).  Saving model ...
Epoch: 6 cost time: 0.4822535514831543
Epoch: 6, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.6215238571166992
Epoch: 7, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.595672607421875
Epoch: 8, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5510456562042236
Epoch: 9, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6099245548248291
Epoch: 10, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5131628513336182
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.665 Vali Acc: 0.819 Test Loss: 0.665 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6712207794189453
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.681 Vali Acc: 0.816 Test Loss: 0.681 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5659563541412354
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6028690338134766
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6129570007324219
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.828 Test Loss: 0.711 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5817878246307373
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 404040
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7861499786376953
Epoch: 1, Steps: 8 | Train Loss: 2.034 Vali Loss: 2.008 Vali Acc: 0.219 Test Loss: 2.008 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.5217084884643555
Epoch: 2, Steps: 8 | Train Loss: 1.859 Vali Loss: 1.816 Vali Acc: 0.669 Test Loss: 1.816 Test Acc: 0.669
Validation loss decreased (-0.218730 --> -0.668732).  Saving model ...
Epoch: 3 cost time: 0.6381418704986572
Epoch: 3, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.495 Vali Acc: 0.766 Test Loss: 1.495 Test Acc: 0.766
Validation loss decreased (-0.668732 --> -0.765610).  Saving model ...
Epoch: 4 cost time: 0.5563883781433105
Epoch: 4, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.106 Vali Acc: 0.803 Test Loss: 1.106 Test Acc: 0.803
Validation loss decreased (-0.765610 --> -0.803114).  Saving model ...
Epoch: 5 cost time: 0.5851528644561768
Epoch: 5, Steps: 8 | Train Loss: 0.752 Vali Loss: 0.765 Vali Acc: 0.819 Test Loss: 0.765 Test Acc: 0.819
Validation loss decreased (-0.803114 --> -0.818742).  Saving model ...
Epoch: 6 cost time: 0.6234631538391113
Epoch: 6, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
Validation loss decreased (-0.818742 --> -0.837494).  Saving model ...
Epoch: 7 cost time: 0.6087470054626465
Epoch: 7, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.5684356689453125
Epoch: 8, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 0.6082406044006348
Epoch: 9, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5844252109527588
Epoch: 10, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5462095737457275
Epoch: 11, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5555555820465088
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6034276485443115
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.544 Vali Acc: 0.831 Test Loss: 0.544 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5611913204193115
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6163885593414307
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6346688270568848
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.574 Vali Acc: 0.831 Test Loss: 0.574 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.591090202331543
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6068828105926514
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.831 Test Loss: 0.604 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 346184
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.134488582611084
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.046 Vali Acc: 0.194 Test Loss: 2.046 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.5422914028167725
Epoch: 2, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.917 Vali Acc: 0.447 Test Loss: 1.917 Test Acc: 0.447
Validation loss decreased (-0.193730 --> -0.446856).  Saving model ...
Epoch: 3 cost time: 0.6789605617523193
Epoch: 3, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.697 Vali Acc: 0.681 Test Loss: 1.697 Test Acc: 0.681
Validation loss decreased (-0.446856 --> -0.681233).  Saving model ...
Epoch: 4 cost time: 0.525327205657959
Epoch: 4, Steps: 8 | Train Loss: 1.420 Vali Loss: 1.401 Vali Acc: 0.734 Test Loss: 1.401 Test Acc: 0.734
Validation loss decreased (-0.681233 --> -0.734361).  Saving model ...
Epoch: 5 cost time: 0.6317474842071533
Epoch: 5, Steps: 8 | Train Loss: 1.113 Vali Loss: 1.074 Vali Acc: 0.769 Test Loss: 1.074 Test Acc: 0.769
Validation loss decreased (-0.734361 --> -0.768739).  Saving model ...
Epoch: 6 cost time: 0.5666053295135498
Epoch: 6, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.791 Vali Acc: 0.797 Test Loss: 0.791 Test Acc: 0.797
Validation loss decreased (-0.768739 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5296204090118408
Epoch: 7, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
Validation loss decreased (-0.796867 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 0.6117472648620605
Epoch: 8, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.812494 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.5654182434082031
Epoch: 9, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.5277097225189209
Epoch: 10, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5773723125457764
Epoch: 11, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5981326103210449
Epoch: 12, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5474717617034912
Epoch: 13, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6095809936523438
Epoch: 14, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6169435977935791
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5350313186645508
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5854997634887695
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5421063899993896
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5419888496398926
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 325192
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.948444128036499
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.059 Vali Acc: 0.159 Test Loss: 2.059 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.6164758205413818
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.941 Vali Acc: 0.281 Test Loss: 1.941 Test Acc: 0.281
Validation loss decreased (-0.159354 --> -0.281231).  Saving model ...
Epoch: 3 cost time: 0.534886360168457
Epoch: 3, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.738 Vali Acc: 0.569 Test Loss: 1.738 Test Acc: 0.569
Validation loss decreased (-0.281231 --> -0.568733).  Saving model ...
Epoch: 4 cost time: 0.4616692066192627
Epoch: 4, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.463 Vali Acc: 0.762 Test Loss: 1.463 Test Acc: 0.762
Validation loss decreased (-0.568733 --> -0.762485).  Saving model ...
Epoch: 5 cost time: 0.509315013885498
Epoch: 5, Steps: 8 | Train Loss: 1.231 Vali Loss: 1.157 Vali Acc: 0.797 Test Loss: 1.157 Test Acc: 0.797
Validation loss decreased (-0.762485 --> -0.796863).  Saving model ...
Epoch: 6 cost time: 0.5865581035614014
Epoch: 6, Steps: 8 | Train Loss: 0.942 Vali Loss: 0.875 Vali Acc: 0.828 Test Loss: 0.875 Test Acc: 0.828
Validation loss decreased (-0.796863 --> -0.828116).  Saving model ...
Epoch: 7 cost time: 0.6094346046447754
Epoch: 7, Steps: 8 | Train Loss: 0.696 Vali Loss: 0.676 Vali Acc: 0.831 Test Loss: 0.676 Test Acc: 0.831
Validation loss decreased (-0.828116 --> -0.831243).  Saving model ...
Epoch: 8 cost time: 0.5550925731658936
Epoch: 8, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 0.5343663692474365
Epoch: 9, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.834369 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.6175820827484131
Epoch: 10, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.674774169921875
Epoch: 11, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5535171031951904
Epoch: 12, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5698130130767822
Epoch: 13, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.838 Test Loss: 0.451 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6095077991485596
Epoch: 14, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5952367782592773
Epoch: 15, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5665595531463623
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5616927146911621
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5331335067749023
Epoch: 18, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5301392078399658
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5245304107666016
Epoch: 20, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 316488
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.026092052459717
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 2.063 Vali Acc: 0.147 Test Loss: 2.063 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.5510945320129395
Epoch: 2, Steps: 8 | Train Loss: 2.024 Vali Loss: 1.976 Vali Acc: 0.369 Test Loss: 1.976 Test Acc: 0.369
Validation loss decreased (-0.146854 --> -0.368730).  Saving model ...
Epoch: 3 cost time: 0.5648276805877686
Epoch: 3, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.830 Vali Acc: 0.556 Test Loss: 1.830 Test Acc: 0.556
Validation loss decreased (-0.368730 --> -0.556232).  Saving model ...
Epoch: 4 cost time: 0.581942081451416
Epoch: 4, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.642 Vali Acc: 0.675 Test Loss: 1.642 Test Acc: 0.675
Validation loss decreased (-0.556232 --> -0.674984).  Saving model ...
Epoch: 5 cost time: 0.5537729263305664
Epoch: 5, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.419 Vali Acc: 0.738 Test Loss: 1.419 Test Acc: 0.738
Validation loss decreased (-0.674984 --> -0.737486).  Saving model ...
Epoch: 6 cost time: 0.57169508934021
Epoch: 6, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.172 Vali Acc: 0.800 Test Loss: 1.172 Test Acc: 0.800
Validation loss decreased (-0.737486 --> -0.799988).  Saving model ...
Epoch: 7 cost time: 0.5179216861724854
Epoch: 7, Steps: 8 | Train Loss: 0.949 Vali Loss: 0.941 Vali Acc: 0.816 Test Loss: 0.941 Test Acc: 0.816
Validation loss decreased (-0.799988 --> -0.815616).  Saving model ...
Epoch: 8 cost time: 0.5641560554504395
Epoch: 8, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.756 Vali Acc: 0.828 Test Loss: 0.756 Test Acc: 0.828
Validation loss decreased (-0.815616 --> -0.828117).  Saving model ...
Epoch: 9 cost time: 0.5300889015197754
Epoch: 9, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.621 Vali Acc: 0.834 Test Loss: 0.621 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.6054286956787109
Epoch: 10, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4966316223144531
Epoch: 11, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 0.5339951515197754
Epoch: 12, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.5597748756408691
Epoch: 13, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.5879371166229248
Epoch: 14, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 0.547595739364624
Epoch: 15, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.5358128547668457
Epoch: 16, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5256240367889404
Epoch: 17, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6645097732543945
Epoch: 18, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5251495838165283
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.516674280166626
Epoch: 20, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4802072048187256
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5559654235839844
Epoch: 22, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5966579914093018
Epoch: 23, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6093432903289795
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5329899787902832
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 308296
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8425414562225342
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 2.116 Vali Acc: 0.072 Test Loss: 2.116 Test Acc: 0.072
Validation loss decreased (inf --> -0.071854).  Saving model ...
Epoch: 2 cost time: 0.558030366897583
Epoch: 2, Steps: 8 | Train Loss: 2.078 Vali Loss: 2.041 Vali Acc: 0.191 Test Loss: 2.041 Test Acc: 0.191
Validation loss decreased (-0.071854 --> -0.190605).  Saving model ...
Epoch: 3 cost time: 0.5422546863555908
Epoch: 3, Steps: 8 | Train Loss: 1.936 Vali Loss: 1.916 Vali Acc: 0.409 Test Loss: 1.916 Test Acc: 0.409
Validation loss decreased (-0.190605 --> -0.409356).  Saving model ...
Epoch: 4 cost time: 0.47709035873413086
Epoch: 4, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.758 Vali Acc: 0.600 Test Loss: 1.758 Test Acc: 0.600
Validation loss decreased (-0.409356 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 0.530836820602417
Epoch: 5, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.568 Vali Acc: 0.741 Test Loss: 1.568 Test Acc: 0.741
Validation loss decreased (-0.599982 --> -0.740609).  Saving model ...
Epoch: 6 cost time: 0.5255541801452637
Epoch: 6, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.355 Vali Acc: 0.778 Test Loss: 1.355 Test Acc: 0.778
Validation loss decreased (-0.740609 --> -0.778111).  Saving model ...
Epoch: 7 cost time: 0.5300121307373047
Epoch: 7, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.129 Vali Acc: 0.806 Test Loss: 1.129 Test Acc: 0.806
Validation loss decreased (-0.778111 --> -0.806239).  Saving model ...
Epoch: 8 cost time: 0.5346620082855225
Epoch: 8, Steps: 8 | Train Loss: 0.970 Vali Loss: 0.932 Vali Acc: 0.809 Test Loss: 0.932 Test Acc: 0.809
Validation loss decreased (-0.806239 --> -0.809366).  Saving model ...
Epoch: 9 cost time: 0.5142865180969238
Epoch: 9, Steps: 8 | Train Loss: 0.783 Vali Loss: 0.778 Vali Acc: 0.819 Test Loss: 0.778 Test Acc: 0.819
Validation loss decreased (-0.809366 --> -0.818742).  Saving model ...
Epoch: 10 cost time: 0.5242247581481934
Epoch: 10, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
Validation loss decreased (-0.818742 --> -0.828118).  Saving model ...
Epoch: 11 cost time: 0.5089433193206787
Epoch: 11, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.579 Vali Acc: 0.838 Test Loss: 0.579 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837494).  Saving model ...
Epoch: 12 cost time: 0.6074028015136719
Epoch: 12, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 0.5191972255706787
Epoch: 13, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.6611371040344238
Epoch: 14, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5256221294403076
Epoch: 15, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.5306203365325928
Epoch: 16, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853121).  Saving model ...
Epoch: 17 cost time: 0.5635550022125244
Epoch: 17, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
Validation loss decreased (-0.853121 --> -0.856246).  Saving model ...
Epoch: 18 cost time: 0.5754406452178955
Epoch: 18, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5266933441162109
Epoch: 19, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.429 Vali Acc: 0.834 Test Loss: 0.429 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5232985019683838
Epoch: 20, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4618513584136963
Epoch: 21, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5527787208557129
Epoch: 22, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.438 Vali Acc: 0.847 Test Loss: 0.438 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5314035415649414
Epoch: 23, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.432 Vali Acc: 0.853 Test Loss: 0.432 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5135505199432373
Epoch: 24, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5358927249908447
Epoch: 25, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
Validation loss decreased (-0.856246 --> -0.859370).  Saving model ...
Epoch: 26 cost time: 0.5519030094146729
Epoch: 26, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5547151565551758
Epoch: 27, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.49619245529174805
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.54691481590271
Epoch: 29, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5870335102081299
Epoch: 30, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5018327236175537
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5535056591033936
Epoch: 32, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5367832183837891
Epoch: 33, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5324556827545166
Epoch: 34, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5389513969421387
Epoch: 35, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 303112
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.737830638885498
Epoch: 1, Steps: 8 | Train Loss: 2.024 Vali Loss: 2.018 Vali Acc: 0.178 Test Loss: 2.018 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.5797858238220215
Epoch: 2, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.940 Vali Acc: 0.312 Test Loss: 1.940 Test Acc: 0.312
Validation loss decreased (-0.178105 --> -0.312481).  Saving model ...
Epoch: 3 cost time: 0.4955024719238281
Epoch: 3, Steps: 8 | Train Loss: 1.828 Vali Loss: 1.817 Vali Acc: 0.556 Test Loss: 1.817 Test Acc: 0.556
Validation loss decreased (-0.312481 --> -0.556232).  Saving model ...
Epoch: 4 cost time: 0.5298848152160645
Epoch: 4, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.665 Vali Acc: 0.656 Test Loss: 1.665 Test Acc: 0.656
Validation loss decreased (-0.556232 --> -0.656233).  Saving model ...
Epoch: 5 cost time: 0.5758302211761475
Epoch: 5, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.493 Vali Acc: 0.709 Test Loss: 1.493 Test Acc: 0.709
Validation loss decreased (-0.656233 --> -0.709360).  Saving model ...
Epoch: 6 cost time: 0.5650625228881836
Epoch: 6, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.316 Vali Acc: 0.747 Test Loss: 1.316 Test Acc: 0.747
Validation loss decreased (-0.709360 --> -0.746862).  Saving model ...
Epoch: 7 cost time: 0.5547916889190674
Epoch: 7, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.143 Vali Acc: 0.775 Test Loss: 1.143 Test Acc: 0.775
Validation loss decreased (-0.746862 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 0.5655176639556885
Epoch: 8, Steps: 8 | Train Loss: 0.960 Vali Loss: 0.978 Vali Acc: 0.791 Test Loss: 0.978 Test Acc: 0.791
Validation loss decreased (-0.774989 --> -0.790615).  Saving model ...
Epoch: 9 cost time: 0.6354672908782959
Epoch: 9, Steps: 8 | Train Loss: 0.817 Vali Loss: 0.833 Vali Acc: 0.800 Test Loss: 0.833 Test Acc: 0.800
Validation loss decreased (-0.790615 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.5640020370483398
Epoch: 10, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.728 Vali Acc: 0.822 Test Loss: 0.728 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.821868).  Saving model ...
Epoch: 11 cost time: 0.5532538890838623
Epoch: 11, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.644 Vali Acc: 0.834 Test Loss: 0.644 Test Acc: 0.834
Validation loss decreased (-0.821868 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 0.5833272933959961
Epoch: 12, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846869).  Saving model ...
Epoch: 13 cost time: 0.5874695777893066
Epoch: 13, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5826218128204346
Epoch: 14, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.5517425537109375
Epoch: 15, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5593166351318359
Epoch: 16, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5964889526367188
Epoch: 17, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.5472466945648193
Epoch: 18, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853121).  Saving model ...
Epoch: 19 cost time: 0.6959176063537598
Epoch: 19, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5426428318023682
Epoch: 20, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6059350967407227
Epoch: 21, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.445 Vali Acc: 0.847 Test Loss: 0.445 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6261117458343506
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5771844387054443
Epoch: 23, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5709629058837891
Epoch: 24, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.51483154296875
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6377878189086914
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.443 Vali Acc: 0.847 Test Loss: 0.443 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5005941390991211
Epoch: 27, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5517244338989258
Epoch: 28, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 301064
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9070801734924316
Epoch: 1, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.955 Vali Acc: 0.378 Test Loss: 1.955 Test Acc: 0.378
Validation loss decreased (inf --> -0.378105).  Saving model ...
Epoch: 2 cost time: 0.5789611339569092
Epoch: 2, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.771 Vali Acc: 0.603 Test Loss: 1.771 Test Acc: 0.603
Validation loss decreased (-0.378105 --> -0.603107).  Saving model ...
Epoch: 3 cost time: 0.6150367259979248
Epoch: 3, Steps: 8 | Train Loss: 1.520 Vali Loss: 1.497 Vali Acc: 0.759 Test Loss: 1.497 Test Acc: 0.759
Validation loss decreased (-0.603107 --> -0.759360).  Saving model ...
Epoch: 4 cost time: 0.5496828556060791
Epoch: 4, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.160 Vali Acc: 0.809 Test Loss: 1.160 Test Acc: 0.809
Validation loss decreased (-0.759360 --> -0.809363).  Saving model ...
Epoch: 5 cost time: 0.5299735069274902
Epoch: 5, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.854 Vali Acc: 0.806 Test Loss: 0.854 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4651050567626953
Epoch: 6, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.648 Vali Acc: 0.819 Test Loss: 0.648 Test Acc: 0.819
Validation loss decreased (-0.809363 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.5595495700836182
Epoch: 7, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.818744 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.5152060985565186
Epoch: 8, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.4611341953277588
Epoch: 9, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.5523989200592041
Epoch: 10, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5015804767608643
Epoch: 11, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5029137134552002
Epoch: 12, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5310828685760498
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5684709548950195
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.579939603805542
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5453577041625977
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5911049842834473
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.819 Test Loss: 0.604 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5717670917510986
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.593 Vali Acc: 0.834 Test Loss: 0.593 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5511300563812256
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 136488
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9027445316314697
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.073 Vali Acc: 0.184 Test Loss: 2.073 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 0.48621416091918945
Epoch: 2, Steps: 8 | Train Loss: 1.973 Vali Loss: 1.969 Vali Acc: 0.409 Test Loss: 1.969 Test Acc: 0.409
Validation loss decreased (-0.184354 --> -0.409355).  Saving model ...
Epoch: 3 cost time: 0.49274611473083496
Epoch: 3, Steps: 8 | Train Loss: 1.812 Vali Loss: 1.797 Vali Acc: 0.575 Test Loss: 1.797 Test Acc: 0.575
Validation loss decreased (-0.409355 --> -0.574982).  Saving model ...
Epoch: 4 cost time: 0.5346360206604004
Epoch: 4, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.567 Vali Acc: 0.716 Test Loss: 1.567 Test Acc: 0.716
Validation loss decreased (-0.574982 --> -0.715609).  Saving model ...
Epoch: 5 cost time: 0.48972058296203613
Epoch: 5, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.302 Vali Acc: 0.772 Test Loss: 1.302 Test Acc: 0.772
Validation loss decreased (-0.715609 --> -0.771862).  Saving model ...
Epoch: 6 cost time: 0.5500128269195557
Epoch: 6, Steps: 8 | Train Loss: 1.079 Vali Loss: 1.030 Vali Acc: 0.803 Test Loss: 1.030 Test Acc: 0.803
Validation loss decreased (-0.771862 --> -0.803115).  Saving model ...
Epoch: 7 cost time: 0.5408356189727783
Epoch: 7, Steps: 8 | Train Loss: 0.845 Vali Loss: 0.802 Vali Acc: 0.809 Test Loss: 0.802 Test Acc: 0.809
Validation loss decreased (-0.803115 --> -0.809367).  Saving model ...
Epoch: 8 cost time: 0.5548758506774902
Epoch: 8, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.651 Vali Acc: 0.831 Test Loss: 0.651 Test Acc: 0.831
Validation loss decreased (-0.809367 --> -0.831243).  Saving model ...
Epoch: 9 cost time: 0.5890645980834961
Epoch: 9, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
Validation loss decreased (-0.831243 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.629990816116333
Epoch: 10, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.5418374538421631
Epoch: 11, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.5349817276000977
Epoch: 12, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 0.5794072151184082
Epoch: 13, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5073695182800293
Epoch: 14, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4859349727630615
Epoch: 15, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5158538818359375
Epoch: 16, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5252995491027832
Epoch: 17, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.47138237953186035
Epoch: 18, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.47757506370544434
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5129153728485107
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4651174545288086
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5068438053131104
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 107560
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7002308368682861
Epoch: 1, Steps: 8 | Train Loss: 2.048 Vali Loss: 2.026 Vali Acc: 0.269 Test Loss: 2.026 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 0.5027942657470703
Epoch: 2, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.955 Vali Acc: 0.375 Test Loss: 1.955 Test Acc: 0.375
Validation loss decreased (-0.268730 --> -0.374980).  Saving model ...
Epoch: 3 cost time: 0.5019443035125732
Epoch: 3, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.832 Vali Acc: 0.594 Test Loss: 1.832 Test Acc: 0.594
Validation loss decreased (-0.374980 --> -0.593732).  Saving model ...
Epoch: 4 cost time: 0.47400474548339844
Epoch: 4, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.660 Vali Acc: 0.697 Test Loss: 1.660 Test Acc: 0.697
Validation loss decreased (-0.593732 --> -0.696858).  Saving model ...
Epoch: 5 cost time: 0.5856561660766602
Epoch: 5, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.450 Vali Acc: 0.756 Test Loss: 1.450 Test Acc: 0.756
Validation loss decreased (-0.696858 --> -0.756235).  Saving model ...
Epoch: 6 cost time: 0.5498561859130859
Epoch: 6, Steps: 8 | Train Loss: 1.262 Vali Loss: 1.229 Vali Acc: 0.784 Test Loss: 1.229 Test Acc: 0.784
Validation loss decreased (-0.756235 --> -0.784363).  Saving model ...
Epoch: 7 cost time: 0.4770779609680176
Epoch: 7, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.008 Vali Acc: 0.812 Test Loss: 1.008 Test Acc: 0.812
Validation loss decreased (-0.784363 --> -0.812490).  Saving model ...
Epoch: 8 cost time: 0.596735954284668
Epoch: 8, Steps: 8 | Train Loss: 0.801 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
Validation loss decreased (-0.812490 --> -0.818742).  Saving model ...
Epoch: 9 cost time: 0.5183537006378174
Epoch: 9, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.679 Vali Acc: 0.819 Test Loss: 0.679 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818743).  Saving model ...
Epoch: 10 cost time: 0.5689029693603516
Epoch: 10, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.46632981300354004
Epoch: 11, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.587571382522583
Epoch: 12, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.5218544006347656
Epoch: 13, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.5088860988616943
Epoch: 14, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5339586734771729
Epoch: 15, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.472 Vali Acc: 0.834 Test Loss: 0.472 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5188989639282227
Epoch: 16, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4862666130065918
Epoch: 17, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.48329663276672363
Epoch: 18, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4774649143218994
Epoch: 19, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5122723579406738
Epoch: 20, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4330563545227051
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.45215535163879395
Epoch: 22, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4882051944732666
Epoch: 23, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 97064
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6194586753845215
Epoch: 1, Steps: 8 | Train Loss: 2.093 Vali Loss: 2.074 Vali Acc: 0.144 Test Loss: 2.074 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 0.4906489849090576
Epoch: 2, Steps: 8 | Train Loss: 2.024 Vali Loss: 2.022 Vali Acc: 0.256 Test Loss: 2.022 Test Acc: 0.256
Validation loss decreased (-0.143729 --> -0.256230).  Saving model ...
Epoch: 3 cost time: 0.5720195770263672
Epoch: 3, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.928 Vali Acc: 0.444 Test Loss: 1.928 Test Acc: 0.444
Validation loss decreased (-0.256230 --> -0.443731).  Saving model ...
Epoch: 4 cost time: 0.5201513767242432
Epoch: 4, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.797 Vali Acc: 0.641 Test Loss: 1.797 Test Acc: 0.641
Validation loss decreased (-0.443731 --> -0.640607).  Saving model ...
Epoch: 5 cost time: 0.5181000232696533
Epoch: 5, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.632 Vali Acc: 0.741 Test Loss: 1.632 Test Acc: 0.741
Validation loss decreased (-0.640607 --> -0.740609).  Saving model ...
Epoch: 6 cost time: 0.5757749080657959
Epoch: 6, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.441 Vali Acc: 0.772 Test Loss: 1.441 Test Acc: 0.772
Validation loss decreased (-0.740609 --> -0.771861).  Saving model ...
Epoch: 7 cost time: 0.5301327705383301
Epoch: 7, Steps: 8 | Train Loss: 1.274 Vali Loss: 1.246 Vali Acc: 0.781 Test Loss: 1.246 Test Acc: 0.781
Validation loss decreased (-0.771861 --> -0.781238).  Saving model ...
Epoch: 8 cost time: 0.505408525466919
Epoch: 8, Steps: 8 | Train Loss: 1.037 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
Validation loss decreased (-0.781238 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.5926315784454346
Epoch: 9, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.873 Vali Acc: 0.812 Test Loss: 0.873 Test Acc: 0.812
Validation loss decreased (-0.799990 --> -0.812491).  Saving model ...
Epoch: 10 cost time: 0.5551965236663818
Epoch: 10, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.737 Vali Acc: 0.812 Test Loss: 0.737 Test Acc: 0.812
Validation loss decreased (-0.812491 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 0.4976928234100342
Epoch: 11, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.645 Vali Acc: 0.819 Test Loss: 0.645 Test Acc: 0.819
Validation loss decreased (-0.812493 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.46441197395324707
Epoch: 12, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.45003414154052734
Epoch: 13, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 0.46390318870544434
Epoch: 14, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.5209286212921143
Epoch: 15, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4475390911102295
Epoch: 16, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5093801021575928
Epoch: 17, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.46476006507873535
Epoch: 18, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.47632789611816406
Epoch: 19, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 20 cost time: 0.5125746726989746
Epoch: 20, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5359106063842773
Epoch: 21, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5140647888183594
Epoch: 22, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5431969165802002
Epoch: 23, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5367527008056641
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4772319793701172
Epoch: 25, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.481 Vali Acc: 0.834 Test Loss: 0.481 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4964597225189209
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.552588701248169
Epoch: 27, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.515582799911499
Epoch: 28, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5816299915313721
Epoch: 29, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 92712
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9364304542541504
Epoch: 1, Steps: 8 | Train Loss: 2.100 Vali Loss: 2.045 Vali Acc: 0.159 Test Loss: 2.045 Test Acc: 0.159
Validation loss decreased (inf --> -0.159355).  Saving model ...
Epoch: 2 cost time: 0.5266544818878174
Epoch: 2, Steps: 8 | Train Loss: 2.022 Vali Loss: 1.999 Vali Acc: 0.247 Test Loss: 1.999 Test Acc: 0.247
Validation loss decreased (-0.159355 --> -0.246855).  Saving model ...
Epoch: 3 cost time: 0.5511438846588135
Epoch: 3, Steps: 8 | Train Loss: 1.962 Vali Loss: 1.918 Vali Acc: 0.441 Test Loss: 1.918 Test Acc: 0.441
Validation loss decreased (-0.246855 --> -0.440606).  Saving model ...
Epoch: 4 cost time: 0.5745127201080322
Epoch: 4, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.809 Vali Acc: 0.606 Test Loss: 1.809 Test Acc: 0.606
Validation loss decreased (-0.440606 --> -0.606232).  Saving model ...
Epoch: 5 cost time: 0.4651057720184326
Epoch: 5, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.674 Vali Acc: 0.728 Test Loss: 1.674 Test Acc: 0.728
Validation loss decreased (-0.606232 --> -0.728108).  Saving model ...
Epoch: 6 cost time: 0.530402660369873
Epoch: 6, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.520 Vali Acc: 0.766 Test Loss: 1.520 Test Acc: 0.766
Validation loss decreased (-0.728108 --> -0.765610).  Saving model ...
Epoch: 7 cost time: 0.4900088310241699
Epoch: 7, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.356 Vali Acc: 0.781 Test Loss: 1.356 Test Acc: 0.781
Validation loss decreased (-0.765610 --> -0.781236).  Saving model ...
Epoch: 8 cost time: 0.5702970027923584
Epoch: 8, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.186 Vali Acc: 0.803 Test Loss: 1.186 Test Acc: 0.803
Validation loss decreased (-0.781236 --> -0.803113).  Saving model ...
Epoch: 9 cost time: 0.5436100959777832
Epoch: 9, Steps: 8 | Train Loss: 1.080 Vali Loss: 1.017 Vali Acc: 0.816 Test Loss: 1.017 Test Acc: 0.816
Validation loss decreased (-0.803113 --> -0.815615).  Saving model ...
Epoch: 10 cost time: 0.466538667678833
Epoch: 10, Steps: 8 | Train Loss: 0.879 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
Validation loss decreased (-0.815615 --> -0.818741).  Saving model ...
Epoch: 11 cost time: 0.4542388916015625
Epoch: 11, Steps: 8 | Train Loss: 0.740 Vali Loss: 0.749 Vali Acc: 0.834 Test Loss: 0.749 Test Acc: 0.834
Validation loss decreased (-0.818741 --> -0.834368).  Saving model ...
Epoch: 12 cost time: 0.4950988292694092
Epoch: 12, Steps: 8 | Train Loss: 0.626 Vali Loss: 0.659 Vali Acc: 0.838 Test Loss: 0.659 Test Acc: 0.838
Validation loss decreased (-0.834368 --> -0.837493).  Saving model ...
Epoch: 13 cost time: 0.6145162582397461
Epoch: 13, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
Validation loss decreased (-0.837493 --> -0.856244).  Saving model ...
Epoch: 14 cost time: 0.5128700733184814
Epoch: 14, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 0.5069293975830078
Epoch: 15, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.511 Vali Acc: 0.859 Test Loss: 0.511 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 16 cost time: 0.5655782222747803
Epoch: 16, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 0.49326419830322266
Epoch: 17, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 18 cost time: 0.5662288665771484
Epoch: 18, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.862495 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.543100118637085
Epoch: 19, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.452 Vali Acc: 0.863 Test Loss: 0.452 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5534939765930176
Epoch: 20, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.443 Vali Acc: 0.866 Test Loss: 0.443 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4976630210876465
Epoch: 21, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.438 Vali Acc: 0.869 Test Loss: 0.438 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5745625495910645
Epoch: 22, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.438 Vali Acc: 0.869 Test Loss: 0.438 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.541867733001709
Epoch: 23, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.436 Vali Acc: 0.869 Test Loss: 0.436 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5633175373077393
Epoch: 24, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.437 Vali Acc: 0.872 Test Loss: 0.437 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4593505859375
Epoch: 25, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.439 Vali Acc: 0.869 Test Loss: 0.439 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4958186149597168
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.437 Vali Acc: 0.866 Test Loss: 0.437 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.453723669052124
Epoch: 27, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5033555030822754
Epoch: 28, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.444 Vali Acc: 0.869 Test Loss: 0.444 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 88616
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8892858028411865
Epoch: 1, Steps: 8 | Train Loss: 2.041 Vali Loss: 2.035 Vali Acc: 0.188 Test Loss: 2.035 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 0.5247139930725098
Epoch: 2, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.995 Vali Acc: 0.234 Test Loss: 1.995 Test Acc: 0.234
Validation loss decreased (-0.187480 --> -0.234355).  Saving model ...
Epoch: 3 cost time: 0.5243968963623047
Epoch: 3, Steps: 8 | Train Loss: 1.936 Vali Loss: 1.931 Vali Acc: 0.306 Test Loss: 1.931 Test Acc: 0.306
Validation loss decreased (-0.234355 --> -0.306231).  Saving model ...
Epoch: 4 cost time: 0.5207526683807373
Epoch: 4, Steps: 8 | Train Loss: 1.869 Vali Loss: 1.845 Vali Acc: 0.475 Test Loss: 1.845 Test Acc: 0.475
Validation loss decreased (-0.306231 --> -0.474982).  Saving model ...
Epoch: 5 cost time: 0.4822421073913574
Epoch: 5, Steps: 8 | Train Loss: 1.775 Vali Loss: 1.745 Vali Acc: 0.628 Test Loss: 1.745 Test Acc: 0.628
Validation loss decreased (-0.474982 --> -0.628108).  Saving model ...
Epoch: 6 cost time: 0.5012979507446289
Epoch: 6, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.632 Vali Acc: 0.719 Test Loss: 1.632 Test Acc: 0.719
Validation loss decreased (-0.628108 --> -0.718734).  Saving model ...
Epoch: 7 cost time: 0.5350642204284668
Epoch: 7, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.505 Vali Acc: 0.738 Test Loss: 1.505 Test Acc: 0.738
Validation loss decreased (-0.718734 --> -0.737485).  Saving model ...
Epoch: 8 cost time: 0.5285487174987793
Epoch: 8, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.369 Vali Acc: 0.762 Test Loss: 1.369 Test Acc: 0.762
Validation loss decreased (-0.737485 --> -0.762486).  Saving model ...
Epoch: 9 cost time: 0.5564672946929932
Epoch: 9, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.229 Vali Acc: 0.781 Test Loss: 1.229 Test Acc: 0.781
Validation loss decreased (-0.762486 --> -0.781238).  Saving model ...
Epoch: 10 cost time: 0.576343297958374
Epoch: 10, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.093 Vali Acc: 0.797 Test Loss: 1.093 Test Acc: 0.797
Validation loss decreased (-0.781238 --> -0.796864).  Saving model ...
Epoch: 11 cost time: 0.5256094932556152
Epoch: 11, Steps: 8 | Train Loss: 0.949 Vali Loss: 0.963 Vali Acc: 0.806 Test Loss: 0.963 Test Acc: 0.806
Validation loss decreased (-0.796864 --> -0.806240).  Saving model ...
Epoch: 12 cost time: 0.5680751800537109
Epoch: 12, Steps: 8 | Train Loss: 0.839 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
Validation loss decreased (-0.806240 --> -0.809367).  Saving model ...
Epoch: 13 cost time: 0.5688393115997314
Epoch: 13, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.751 Vali Acc: 0.816 Test Loss: 0.751 Test Acc: 0.816
Validation loss decreased (-0.809367 --> -0.815617).  Saving model ...
Epoch: 14 cost time: 0.555941104888916
Epoch: 14, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.675 Vali Acc: 0.809 Test Loss: 0.675 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6033542156219482
Epoch: 15, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.613 Vali Acc: 0.812 Test Loss: 0.613 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5047776699066162
Epoch: 16, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
Validation loss decreased (-0.815617 --> -0.828119).  Saving model ...
Epoch: 17 cost time: 0.49301695823669434
Epoch: 17, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 0.5015852451324463
Epoch: 18, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5625693798065186
Epoch: 19, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 0.5738010406494141
Epoch: 20, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 0.4434938430786133
Epoch: 21, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.5646927356719971
Epoch: 22, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.5003180503845215
Epoch: 23, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 24 cost time: 0.49327707290649414
Epoch: 24, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.439 Vali Acc: 0.853 Test Loss: 0.439 Test Acc: 0.853
Validation loss decreased (-0.849996 --> -0.853121).  Saving model ...
Epoch: 25 cost time: 0.4388136863708496
Epoch: 25, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.429 Vali Acc: 0.859 Test Loss: 0.429 Test Acc: 0.859
Validation loss decreased (-0.853121 --> -0.859371).  Saving model ...
Epoch: 26 cost time: 0.5148913860321045
Epoch: 26, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.422 Vali Acc: 0.863 Test Loss: 0.422 Test Acc: 0.863
Validation loss decreased (-0.859371 --> -0.862496).  Saving model ...
Epoch: 27 cost time: 0.5045440196990967
Epoch: 27, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.419 Vali Acc: 0.863 Test Loss: 0.419 Test Acc: 0.863
Validation loss decreased (-0.862496 --> -0.862496).  Saving model ...
Epoch: 28 cost time: 0.5672433376312256
Epoch: 28, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.419 Vali Acc: 0.859 Test Loss: 0.419 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5898382663726807
Epoch: 29, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.418 Vali Acc: 0.856 Test Loss: 0.418 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5120139122009277
Epoch: 30, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.421 Vali Acc: 0.853 Test Loss: 0.421 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5226318836212158
Epoch: 31, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5119833946228027
Epoch: 32, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5214781761169434
Epoch: 33, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.418 Vali Acc: 0.866 Test Loss: 0.418 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865621).  Saving model ...
Epoch: 34 cost time: 0.5879266262054443
Epoch: 34, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.420 Vali Acc: 0.863 Test Loss: 0.420 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.536729097366333
Epoch: 35, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.428 Vali Acc: 0.863 Test Loss: 0.428 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5133743286132812
Epoch: 36, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.433 Vali Acc: 0.859 Test Loss: 0.433 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.57723069190979
Epoch: 37, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.429 Vali Acc: 0.863 Test Loss: 0.429 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5001015663146973
Epoch: 38, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5563774108886719
Epoch: 39, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5798215866088867
Epoch: 40, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.441 Vali Acc: 0.863 Test Loss: 0.441 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4896566867828369
Epoch: 41, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.441 Vali Acc: 0.859 Test Loss: 0.441 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5111150741577148
Epoch: 42, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.47179436683654785
Epoch: 43, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.444 Vali Acc: 0.866 Test Loss: 0.444 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 86024
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7418198585510254
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.118 Vali Acc: 0.125 Test Loss: 2.118 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 0.5557608604431152
Epoch: 2, Steps: 8 | Train Loss: 2.096 Vali Loss: 2.088 Vali Acc: 0.125 Test Loss: 2.088 Test Acc: 0.125
Validation loss decreased (-0.124979 --> -0.124979).  Saving model ...
Epoch: 3 cost time: 0.4978494644165039
Epoch: 3, Steps: 8 | Train Loss: 2.041 Vali Loss: 2.032 Vali Acc: 0.194 Test Loss: 2.032 Test Acc: 0.194
Validation loss decreased (-0.124979 --> -0.193730).  Saving model ...
Epoch: 4 cost time: 0.6097538471221924
Epoch: 4, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.957 Vali Acc: 0.341 Test Loss: 1.957 Test Acc: 0.341
Validation loss decreased (-0.193730 --> -0.340605).  Saving model ...
Epoch: 5 cost time: 0.5830793380737305
Epoch: 5, Steps: 8 | Train Loss: 1.862 Vali Loss: 1.865 Vali Acc: 0.472 Test Loss: 1.865 Test Acc: 0.472
Validation loss decreased (-0.340605 --> -0.471856).  Saving model ...
Epoch: 6 cost time: 0.5561356544494629
Epoch: 6, Steps: 8 | Train Loss: 1.769 Vali Loss: 1.761 Vali Acc: 0.584 Test Loss: 1.761 Test Acc: 0.584
Validation loss decreased (-0.471856 --> -0.584357).  Saving model ...
Epoch: 7 cost time: 0.6392104625701904
Epoch: 7, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.645 Vali Acc: 0.656 Test Loss: 1.645 Test Acc: 0.656
Validation loss decreased (-0.584357 --> -0.656234).  Saving model ...
Epoch: 8 cost time: 0.48113179206848145
Epoch: 8, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.519 Vali Acc: 0.731 Test Loss: 1.519 Test Acc: 0.731
Validation loss decreased (-0.656234 --> -0.731235).  Saving model ...
Epoch: 9 cost time: 0.48250436782836914
Epoch: 9, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.387 Vali Acc: 0.759 Test Loss: 1.387 Test Acc: 0.759
Validation loss decreased (-0.731235 --> -0.759361).  Saving model ...
Epoch: 10 cost time: 0.47809386253356934
Epoch: 10, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.246 Vali Acc: 0.778 Test Loss: 1.246 Test Acc: 0.778
Validation loss decreased (-0.759361 --> -0.778113).  Saving model ...
Epoch: 11 cost time: 0.5611600875854492
Epoch: 11, Steps: 8 | Train Loss: 1.105 Vali Loss: 1.116 Vali Acc: 0.784 Test Loss: 1.116 Test Acc: 0.784
Validation loss decreased (-0.778113 --> -0.784364).  Saving model ...
Epoch: 12 cost time: 0.47893261909484863
Epoch: 12, Steps: 8 | Train Loss: 0.973 Vali Loss: 0.994 Vali Acc: 0.797 Test Loss: 0.994 Test Acc: 0.797
Validation loss decreased (-0.784364 --> -0.796865).  Saving model ...
Epoch: 13 cost time: 0.5561642646789551
Epoch: 13, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.893 Vali Acc: 0.800 Test Loss: 0.893 Test Acc: 0.800
Validation loss decreased (-0.796865 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.5316011905670166
Epoch: 14, Steps: 8 | Train Loss: 0.748 Vali Loss: 0.802 Vali Acc: 0.806 Test Loss: 0.802 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.806242).  Saving model ...
Epoch: 15 cost time: 0.5482282638549805
Epoch: 15, Steps: 8 | Train Loss: 0.646 Vali Loss: 0.728 Vali Acc: 0.809 Test Loss: 0.728 Test Acc: 0.809
Validation loss decreased (-0.806242 --> -0.809368).  Saving model ...
Epoch: 16 cost time: 0.5633058547973633
Epoch: 16, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.669 Vali Acc: 0.816 Test Loss: 0.669 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815618).  Saving model ...
Epoch: 17 cost time: 0.5686779022216797
Epoch: 17, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815619).  Saving model ...
Epoch: 18 cost time: 0.5362772941589355
Epoch: 18, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824994).  Saving model ...
Epoch: 19 cost time: 0.5259640216827393
Epoch: 19, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 20 cost time: 0.5381309986114502
Epoch: 20, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 0.49683165550231934
Epoch: 21, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 0.5184807777404785
Epoch: 22, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 0.6170005798339844
Epoch: 23, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 24 cost time: 0.6125614643096924
Epoch: 24, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 25 cost time: 0.6356632709503174
Epoch: 25, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 26 cost time: 0.5617666244506836
Epoch: 26, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.451 Vali Acc: 0.863 Test Loss: 0.451 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 27 cost time: 0.5479555130004883
Epoch: 27, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5029895305633545
Epoch: 28, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.443 Vali Acc: 0.853 Test Loss: 0.443 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5776610374450684
Epoch: 29, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5566246509552002
Epoch: 30, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5189988613128662
Epoch: 31, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.437 Vali Acc: 0.847 Test Loss: 0.437 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5655276775360107
Epoch: 32, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5084130764007568
Epoch: 33, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5538852214813232
Epoch: 34, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5401084423065186
Epoch: 35, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5843505859375
Epoch: 36, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 85000
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7446260452270508
Epoch: 1, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.488 Vali Acc: 0.769 Test Loss: 1.488 Test Acc: 0.769
Validation loss decreased (inf --> -0.768735).  Saving model ...
Epoch: 2 cost time: 0.6254160404205322
Epoch: 2, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
Validation loss decreased (-0.768735 --> -0.824994).  Saving model ...
Epoch: 3 cost time: 0.5983121395111084
Epoch: 3, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 4 cost time: 0.604691743850708
Epoch: 4, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5998945236206055
Epoch: 5, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7712798118591309
Epoch: 6, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6294441223144531
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.806 Vali Acc: 0.816 Test Loss: 0.806 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5295169353485107
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.861 Vali Acc: 0.809 Test Loss: 0.861 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7186522483825684
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.812 Test Loss: 0.837 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5905587673187256
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.828 Test Loss: 0.816 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5943508148193359
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.828 Test Loss: 0.811 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6150257587432861
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.828 Test Loss: 0.812 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5948376655578613
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.831 Test Loss: 0.816 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 1299720
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9932498931884766
Epoch: 1, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.722 Vali Acc: 0.584 Test Loss: 1.722 Test Acc: 0.584
Validation loss decreased (inf --> -0.584358).  Saving model ...
Epoch: 2 cost time: 0.5147373676300049
Epoch: 2, Steps: 8 | Train Loss: 1.044 Vali Loss: 0.863 Vali Acc: 0.803 Test Loss: 0.863 Test Acc: 0.803
Validation loss decreased (-0.584358 --> -0.803116).  Saving model ...
Epoch: 3 cost time: 0.4509429931640625
Epoch: 3, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.803116 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.518329381942749
Epoch: 4, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5227811336517334
Epoch: 5, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4523589611053467
Epoch: 6, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5175144672393799
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.588 Vali Acc: 0.828 Test Loss: 0.588 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5036091804504395
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5832428932189941
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.649 Vali Acc: 0.819 Test Loss: 0.649 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4927809238433838
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.48451757431030273
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4975917339324951
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.831 Test Loss: 0.653 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5413098335266113
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.831 Test Loss: 0.659 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1062152
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.735943078994751
Epoch: 1, Steps: 8 | Train Loss: 2.016 Vali Loss: 1.841 Vali Acc: 0.472 Test Loss: 1.841 Test Acc: 0.472
Validation loss decreased (inf --> -0.471857).  Saving model ...
Epoch: 2 cost time: 0.5624082088470459
Epoch: 2, Steps: 8 | Train Loss: 1.267 Vali Loss: 1.096 Vali Acc: 0.787 Test Loss: 1.096 Test Acc: 0.787
Validation loss decreased (-0.471857 --> -0.787489).  Saving model ...
Epoch: 3 cost time: 0.5257253646850586
Epoch: 3, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.627 Vali Acc: 0.838 Test Loss: 0.627 Test Acc: 0.838
Validation loss decreased (-0.787489 --> -0.837494).  Saving model ...
Epoch: 4 cost time: 0.566657304763794
Epoch: 4, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
Validation loss decreased (-0.837494 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 0.6465930938720703
Epoch: 5, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5897200107574463
Epoch: 6, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5279872417449951
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6443979740142822
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5776362419128418
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5461142063140869
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5759477615356445
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.44638562202453613
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.47957420349121094
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4884192943572998
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.834 Test Loss: 0.585 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 984328
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7184274196624756
Epoch: 1, Steps: 8 | Train Loss: 2.056 Vali Loss: 1.913 Vali Acc: 0.325 Test Loss: 1.913 Test Acc: 0.325
Validation loss decreased (inf --> -0.324981).  Saving model ...
Epoch: 2 cost time: 0.6576192378997803
Epoch: 2, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.299 Vali Acc: 0.747 Test Loss: 1.299 Test Acc: 0.747
Validation loss decreased (-0.324981 --> -0.746862).  Saving model ...
Epoch: 3 cost time: 0.4562339782714844
Epoch: 3, Steps: 8 | Train Loss: 0.800 Vali Loss: 0.770 Vali Acc: 0.784 Test Loss: 0.770 Test Acc: 0.784
Validation loss decreased (-0.746862 --> -0.784367).  Saving model ...
Epoch: 4 cost time: 0.5127320289611816
Epoch: 4, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.784367 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 0.563453197479248
Epoch: 5, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.5443477630615234
Epoch: 6, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5801329612731934
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5864989757537842
Epoch: 8, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.486 Vali Acc: 0.834 Test Loss: 0.486 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5446786880493164
Epoch: 9, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6527442932128906
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5048565864562988
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.47586727142333984
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.49329233169555664
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.44565749168395996
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.46360301971435547
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 943368
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7077267169952393
Epoch: 1, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.916 Vali Acc: 0.291 Test Loss: 1.916 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 0.5169153213500977
Epoch: 2, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.423 Vali Acc: 0.716 Test Loss: 1.423 Test Acc: 0.716
Validation loss decreased (-0.290606 --> -0.715611).  Saving model ...
Epoch: 3 cost time: 0.4969360828399658
Epoch: 3, Steps: 8 | Train Loss: 0.962 Vali Loss: 0.916 Vali Acc: 0.809 Test Loss: 0.916 Test Acc: 0.809
Validation loss decreased (-0.715611 --> -0.809366).  Saving model ...
Epoch: 4 cost time: 0.5096940994262695
Epoch: 4, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.625 Vali Acc: 0.834 Test Loss: 0.625 Test Acc: 0.834
Validation loss decreased (-0.809366 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 0.5336422920227051
Epoch: 5, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 0.4954349994659424
Epoch: 6, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 0.5182082653045654
Epoch: 7, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4867894649505615
Epoch: 8, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5124800205230713
Epoch: 9, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5610113143920898
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6084420680999756
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.516775369644165
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6484434604644775
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.484 Vali Acc: 0.834 Test Loss: 0.484 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5665369033813477
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.483 Vali Acc: 0.834 Test Loss: 0.483 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5528006553649902
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5160946846008301
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 910600
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6984326839447021
Epoch: 1, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.901 Vali Acc: 0.381 Test Loss: 1.901 Test Acc: 0.381
Validation loss decreased (inf --> -0.381231).  Saving model ...
Epoch: 2 cost time: 0.5923709869384766
Epoch: 2, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.536 Vali Acc: 0.688 Test Loss: 1.536 Test Acc: 0.688
Validation loss decreased (-0.381231 --> -0.687485).  Saving model ...
Epoch: 3 cost time: 0.5042731761932373
Epoch: 3, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.093 Vali Acc: 0.772 Test Loss: 1.093 Test Acc: 0.772
Validation loss decreased (-0.687485 --> -0.771864).  Saving model ...
Epoch: 4 cost time: 0.5490050315856934
Epoch: 4, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.773 Vali Acc: 0.803 Test Loss: 0.773 Test Acc: 0.803
Validation loss decreased (-0.771864 --> -0.803117).  Saving model ...
Epoch: 5 cost time: 0.5542716979980469
Epoch: 5, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
Validation loss decreased (-0.803117 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.6037726402282715
Epoch: 6, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.5191271305084229
Epoch: 7, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
Validation loss decreased (-0.856245 --> -0.878120).  Saving model ...
Epoch: 8 cost time: 0.5172441005706787
Epoch: 8, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5523185729980469
Epoch: 9, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5233497619628906
Epoch: 10, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5082499980926514
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.439 Vali Acc: 0.853 Test Loss: 0.439 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5931477546691895
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.437 Vali Acc: 0.853 Test Loss: 0.437 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5441462993621826
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4996497631072998
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6441891193389893
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5500166416168213
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5720353126525879
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 889864
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7470479011535645
Epoch: 1, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.896 Vali Acc: 0.338 Test Loss: 1.896 Test Acc: 0.338
Validation loss decreased (inf --> -0.337481).  Saving model ...
Epoch: 2 cost time: 0.5351512432098389
Epoch: 2, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.581 Vali Acc: 0.691 Test Loss: 1.581 Test Acc: 0.691
Validation loss decreased (-0.337481 --> -0.690609).  Saving model ...
Epoch: 3 cost time: 0.5199062824249268
Epoch: 3, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.187 Vali Acc: 0.781 Test Loss: 1.187 Test Acc: 0.781
Validation loss decreased (-0.690609 --> -0.781238).  Saving model ...
Epoch: 4 cost time: 0.4779472351074219
Epoch: 4, Steps: 8 | Train Loss: 0.896 Vali Loss: 0.866 Vali Acc: 0.803 Test Loss: 0.866 Test Acc: 0.803
Validation loss decreased (-0.781238 --> -0.803116).  Saving model ...
Epoch: 5 cost time: 0.4982879161834717
Epoch: 5, Steps: 8 | Train Loss: 0.605 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809368).  Saving model ...
Epoch: 6 cost time: 0.5428986549377441
Epoch: 6, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
Validation loss decreased (-0.809368 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.5143449306488037
Epoch: 7, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.5250072479248047
Epoch: 8, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.5730414390563965
Epoch: 9, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.5343594551086426
Epoch: 10, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856246).  Saving model ...
Epoch: 11 cost time: 0.5056216716766357
Epoch: 11, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.442 Vali Acc: 0.856 Test Loss: 0.442 Test Acc: 0.856
Validation loss decreased (-0.856246 --> -0.856246).  Saving model ...
Epoch: 12 cost time: 0.5083034038543701
Epoch: 12, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.451 Vali Acc: 0.853 Test Loss: 0.451 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6475174427032471
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4973587989807129
Epoch: 14, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5163319110870361
Epoch: 15, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6125626564025879
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5362110137939453
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.48361945152282715
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5301694869995117
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.501190185546875
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6020026206970215
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 881672
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8765983581542969
Epoch: 1, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.668 Vali Acc: 0.688 Test Loss: 1.668 Test Acc: 0.688
Validation loss decreased (inf --> -0.687483).  Saving model ...
Epoch: 2 cost time: 0.4804646968841553
Epoch: 2, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.855 Vali Acc: 0.825 Test Loss: 0.855 Test Acc: 0.825
Validation loss decreased (-0.687483 --> -0.824991).  Saving model ...
Epoch: 3 cost time: 0.5001134872436523
Epoch: 3, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
Validation loss decreased (-0.824991 --> -0.853120).  Saving model ...
Epoch: 4 cost time: 0.5036280155181885
Epoch: 4, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 5 cost time: 0.4655613899230957
Epoch: 5, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4549424648284912
Epoch: 6, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5649425983428955
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5004627704620361
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.49030399322509766
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4994540214538574
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.645 Vali Acc: 0.825 Test Loss: 0.645 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.49503064155578613
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5688741207122803
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4997596740722656
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.825 Test Loss: 0.676 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4442100524902344
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.825 Test Loss: 0.693 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 453256
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6486713886260986
Epoch: 1, Steps: 8 | Train Loss: 2.164 Vali Loss: 1.962 Vali Acc: 0.316 Test Loss: 1.962 Test Acc: 0.316
Validation loss decreased (inf --> -0.315605).  Saving model ...
Epoch: 2 cost time: 0.47452235221862793
Epoch: 2, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.358 Vali Acc: 0.769 Test Loss: 1.358 Test Acc: 0.769
Validation loss decreased (-0.315605 --> -0.768736).  Saving model ...
Epoch: 3 cost time: 0.4408607482910156
Epoch: 3, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.796 Vali Acc: 0.812 Test Loss: 0.796 Test Acc: 0.812
Validation loss decreased (-0.768736 --> -0.812492).  Saving model ...
Epoch: 4 cost time: 0.475480318069458
Epoch: 4, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
Validation loss decreased (-0.812492 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 0.5150275230407715
Epoch: 5, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 0.5053009986877441
Epoch: 6, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862496).  Saving model ...
Epoch: 7 cost time: 0.5453770160675049
Epoch: 7, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5074195861816406
Epoch: 8, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.491 Vali Acc: 0.831 Test Loss: 0.491 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.45495057106018066
Epoch: 9, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5088942050933838
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5349938869476318
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5948169231414795
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4686777591705322
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6249682903289795
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4921591281890869
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5256330966949463
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 334472
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7149989604949951
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.957 Vali Acc: 0.362 Test Loss: 1.957 Test Acc: 0.362
Validation loss decreased (inf --> -0.362480).  Saving model ...
Epoch: 2 cost time: 0.4562230110168457
Epoch: 2, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.512 Vali Acc: 0.747 Test Loss: 1.512 Test Acc: 0.747
Validation loss decreased (-0.362480 --> -0.746860).  Saving model ...
Epoch: 3 cost time: 0.4562859535217285
Epoch: 3, Steps: 8 | Train Loss: 1.061 Vali Loss: 0.992 Vali Acc: 0.812 Test Loss: 0.992 Test Acc: 0.812
Validation loss decreased (-0.746860 --> -0.812490).  Saving model ...
Epoch: 4 cost time: 0.46831846237182617
Epoch: 4, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.666 Vali Acc: 0.828 Test Loss: 0.666 Test Acc: 0.828
Validation loss decreased (-0.812490 --> -0.828118).  Saving model ...
Epoch: 5 cost time: 0.5285780429840088
Epoch: 5, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.828118 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.49866819381713867
Epoch: 6, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.5101063251495361
Epoch: 7, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.53916335105896
Epoch: 8, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5502848625183105
Epoch: 9, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.532231330871582
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.47637367248535156
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5032753944396973
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5119733810424805
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5275700092315674
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5361919403076172
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4798402786254883
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4562230110168457
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 295560
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.590719223022461
Epoch: 1, Steps: 8 | Train Loss: 2.048 Vali Loss: 1.960 Vali Acc: 0.291 Test Loss: 1.960 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 0.4785735607147217
Epoch: 2, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.597 Vali Acc: 0.647 Test Loss: 1.597 Test Acc: 0.647
Validation loss decreased (-0.290605 --> -0.646859).  Saving model ...
Epoch: 3 cost time: 0.416309118270874
Epoch: 3, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.127 Vali Acc: 0.784 Test Loss: 1.127 Test Acc: 0.784
Validation loss decreased (-0.646859 --> -0.784364).  Saving model ...
Epoch: 4 cost time: 0.5513920783996582
Epoch: 4, Steps: 8 | Train Loss: 0.758 Vali Loss: 0.777 Vali Acc: 0.838 Test Loss: 0.777 Test Acc: 0.838
Validation loss decreased (-0.784364 --> -0.837492).  Saving model ...
Epoch: 5 cost time: 0.42925357818603516
Epoch: 5, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
Validation loss decreased (-0.837492 --> -0.871869).  Saving model ...
Epoch: 6 cost time: 0.5474250316619873
Epoch: 6, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.5160508155822754
Epoch: 7, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.463 Vali Acc: 0.869 Test Loss: 0.463 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6323766708374023
Epoch: 8, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.691448450088501
Epoch: 9, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5415091514587402
Epoch: 10, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.521338701248169
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5838475227355957
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.609236478805542
Epoch: 13, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5575988292694092
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6381139755249023
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5670311450958252
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 275080
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7055084705352783
Epoch: 1, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.920 Vali Acc: 0.344 Test Loss: 1.920 Test Acc: 0.344
Validation loss decreased (inf --> -0.343731).  Saving model ...
Epoch: 2 cost time: 0.43691515922546387
Epoch: 2, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.653 Vali Acc: 0.619 Test Loss: 1.653 Test Acc: 0.619
Validation loss decreased (-0.343731 --> -0.618733).  Saving model ...
Epoch: 3 cost time: 0.40705180168151855
Epoch: 3, Steps: 8 | Train Loss: 1.392 Vali Loss: 1.287 Vali Acc: 0.766 Test Loss: 1.287 Test Acc: 0.766
Validation loss decreased (-0.618733 --> -0.765612).  Saving model ...
Epoch: 4 cost time: 0.43181872367858887
Epoch: 4, Steps: 8 | Train Loss: 0.980 Vali Loss: 0.944 Vali Acc: 0.812 Test Loss: 0.944 Test Acc: 0.812
Validation loss decreased (-0.765612 --> -0.812491).  Saving model ...
Epoch: 5 cost time: 0.42334532737731934
Epoch: 5, Steps: 8 | Train Loss: 0.709 Vali Loss: 0.716 Vali Acc: 0.834 Test Loss: 0.716 Test Acc: 0.834
Validation loss decreased (-0.812491 --> -0.834368).  Saving model ...
Epoch: 6 cost time: 0.5434482097625732
Epoch: 6, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.43242454528808594
Epoch: 7, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
Validation loss decreased (-0.834368 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.47101807594299316
Epoch: 8, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.475 Vali Acc: 0.869 Test Loss: 0.475 Test Acc: 0.869
Validation loss decreased (-0.849995 --> -0.868745).  Saving model ...
Epoch: 9 cost time: 0.5509359836578369
Epoch: 9, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45314764976501465
Epoch: 10, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.451 Vali Acc: 0.853 Test Loss: 0.451 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5048840045928955
Epoch: 11, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.445 Vali Acc: 0.853 Test Loss: 0.445 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4893190860748291
Epoch: 12, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.443 Vali Acc: 0.853 Test Loss: 0.443 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5464599132537842
Epoch: 13, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5913941860198975
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.49686717987060547
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5766963958740234
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5074498653411865
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5980038642883301
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 258696
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8082504272460938
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 1.973 Vali Acc: 0.247 Test Loss: 1.973 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.5588641166687012
Epoch: 2, Steps: 8 | Train Loss: 1.868 Vali Loss: 1.765 Vali Acc: 0.575 Test Loss: 1.765 Test Acc: 0.575
Validation loss decreased (-0.246855 --> -0.574982).  Saving model ...
Epoch: 3 cost time: 0.4339573383331299
Epoch: 3, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.462 Vali Acc: 0.725 Test Loss: 1.462 Test Acc: 0.725
Validation loss decreased (-0.574982 --> -0.724985).  Saving model ...
Epoch: 4 cost time: 0.452359676361084
Epoch: 4, Steps: 8 | Train Loss: 1.185 Vali Loss: 1.155 Vali Acc: 0.769 Test Loss: 1.155 Test Acc: 0.769
Validation loss decreased (-0.724985 --> -0.768738).  Saving model ...
Epoch: 5 cost time: 0.50860595703125
Epoch: 5, Steps: 8 | Train Loss: 0.916 Vali Loss: 0.903 Vali Acc: 0.791 Test Loss: 0.903 Test Acc: 0.791
Validation loss decreased (-0.768738 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 0.5351030826568604
Epoch: 6, Steps: 8 | Train Loss: 0.667 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
Validation loss decreased (-0.790616 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 0.4606025218963623
Epoch: 7, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.621 Vali Acc: 0.828 Test Loss: 0.621 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.506549596786499
Epoch: 8, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.5885066986083984
Epoch: 9, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.4691319465637207
Epoch: 10, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.486 Vali Acc: 0.863 Test Loss: 0.486 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 11 cost time: 0.4195058345794678
Epoch: 11, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.472 Vali Acc: 0.859 Test Loss: 0.472 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5802357196807861
Epoch: 12, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5058825016021729
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6131408214569092
Epoch: 14, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.45846128463745117
Epoch: 15, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5383007526397705
Epoch: 16, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.444 Vali Acc: 0.853 Test Loss: 0.444 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6094248294830322
Epoch: 17, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.439 Vali Acc: 0.847 Test Loss: 0.439 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5879690647125244
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4746227264404297
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5163173675537109
Epoch: 20, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 248328
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.766127586364746
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.035 Vali Acc: 0.144 Test Loss: 2.035 Test Acc: 0.144
Validation loss decreased (inf --> -0.143730).  Saving model ...
Epoch: 2 cost time: 0.4660208225250244
Epoch: 2, Steps: 8 | Train Loss: 1.931 Vali Loss: 1.878 Vali Acc: 0.322 Test Loss: 1.878 Test Acc: 0.322
Validation loss decreased (-0.143730 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 0.5445544719696045
Epoch: 3, Steps: 8 | Train Loss: 1.674 Vali Loss: 1.628 Vali Acc: 0.569 Test Loss: 1.628 Test Acc: 0.569
Validation loss decreased (-0.321856 --> -0.568734).  Saving model ...
Epoch: 4 cost time: 0.46241188049316406
Epoch: 4, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.356 Vali Acc: 0.716 Test Loss: 1.356 Test Acc: 0.716
Validation loss decreased (-0.568734 --> -0.715611).  Saving model ...
Epoch: 5 cost time: 0.4651832580566406
Epoch: 5, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.097 Vali Acc: 0.766 Test Loss: 1.097 Test Acc: 0.766
Validation loss decreased (-0.715611 --> -0.765614).  Saving model ...
Epoch: 6 cost time: 0.47274160385131836
Epoch: 6, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.897 Vali Acc: 0.794 Test Loss: 0.897 Test Acc: 0.794
Validation loss decreased (-0.765614 --> -0.793741).  Saving model ...
Epoch: 7 cost time: 0.5272955894470215
Epoch: 7, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.756 Vali Acc: 0.803 Test Loss: 0.756 Test Acc: 0.803
Validation loss decreased (-0.793741 --> -0.803117).  Saving model ...
Epoch: 8 cost time: 0.5629627704620361
Epoch: 8, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
Validation loss decreased (-0.803117 --> -0.821868).  Saving model ...
Epoch: 9 cost time: 0.5822081565856934
Epoch: 9, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.821868 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 0.4865598678588867
Epoch: 10, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.537 Vali Acc: 0.859 Test Loss: 0.537 Test Acc: 0.859
Validation loss decreased (-0.843744 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 0.5721898078918457
Epoch: 11, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.543903112411499
Epoch: 12, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5690782070159912
Epoch: 13, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5910227298736572
Epoch: 14, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5834386348724365
Epoch: 15, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4968106746673584
Epoch: 16, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5420973300933838
Epoch: 17, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5525121688842773
Epoch: 18, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.47843456268310547
Epoch: 19, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.439 Vali Acc: 0.853 Test Loss: 0.439 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.577448844909668
Epoch: 20, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 244232
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8132076263427734
Epoch: 1, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.789 Vali Acc: 0.497 Test Loss: 1.789 Test Acc: 0.497
Validation loss decreased (inf --> -0.496857).  Saving model ...
Epoch: 2 cost time: 0.46724557876586914
Epoch: 2, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.205 Vali Acc: 0.766 Test Loss: 1.205 Test Acc: 0.766
Validation loss decreased (-0.496857 --> -0.765613).  Saving model ...
Epoch: 3 cost time: 0.5305478572845459
Epoch: 3, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.729 Vali Acc: 0.819 Test Loss: 0.729 Test Acc: 0.819
Validation loss decreased (-0.765613 --> -0.818743).  Saving model ...
Epoch: 4 cost time: 0.6268303394317627
Epoch: 4, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 0.5370767116546631
Epoch: 5, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.473 Vali Acc: 0.859 Test Loss: 0.473 Test Acc: 0.859
Validation loss decreased (-0.831244 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 0.4821352958679199
Epoch: 6, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4962732791900635
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.454831600189209
Epoch: 8, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5347375869750977
Epoch: 9, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5652854442596436
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4280867576599121
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.571 Vali Acc: 0.838 Test Loss: 0.571 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4806387424468994
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.46663808822631836
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.496565580368042
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.588 Vali Acc: 0.834 Test Loss: 0.588 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5129642486572266
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.831 Test Loss: 0.593 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 177480
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8365669250488281
Epoch: 1, Steps: 8 | Train Loss: 2.053 Vali Loss: 1.983 Vali Acc: 0.291 Test Loss: 1.983 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 0.4932675361633301
Epoch: 2, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.655 Vali Acc: 0.603 Test Loss: 1.655 Test Acc: 0.603
Validation loss decreased (-0.290605 --> -0.603108).  Saving model ...
Epoch: 3 cost time: 0.5358550548553467
Epoch: 3, Steps: 8 | Train Loss: 1.215 Vali Loss: 1.200 Vali Acc: 0.753 Test Loss: 1.200 Test Acc: 0.753
Validation loss decreased (-0.603108 --> -0.753113).  Saving model ...
Epoch: 4 cost time: 0.5841054916381836
Epoch: 4, Steps: 8 | Train Loss: 0.787 Vali Loss: 0.836 Vali Acc: 0.787 Test Loss: 0.836 Test Acc: 0.787
Validation loss decreased (-0.753113 --> -0.787492).  Saving model ...
Epoch: 5 cost time: 0.5229418277740479
Epoch: 5, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.628 Vali Acc: 0.816 Test Loss: 0.628 Test Acc: 0.816
Validation loss decreased (-0.787492 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 0.5158073902130127
Epoch: 6, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.5070552825927734
Epoch: 7, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.5622806549072266
Epoch: 8, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.5370669364929199
Epoch: 9, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.4413442611694336
Epoch: 10, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46994996070861816
Epoch: 11, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.44349145889282227
Epoch: 12, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5091385841369629
Epoch: 13, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5442047119140625
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.44197654724121094
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5070266723632812
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5558276176452637
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5596785545349121
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5283491611480713
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 118088
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.707820177078247
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.057 Vali Acc: 0.153 Test Loss: 2.057 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 0.4910001754760742
Epoch: 2, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.834 Vali Acc: 0.434 Test Loss: 1.834 Test Acc: 0.434
Validation loss decreased (-0.153104 --> -0.434357).  Saving model ...
Epoch: 3 cost time: 0.4520857334136963
Epoch: 3, Steps: 8 | Train Loss: 1.501 Vali Loss: 1.496 Vali Acc: 0.678 Test Loss: 1.496 Test Acc: 0.678
Validation loss decreased (-0.434357 --> -0.678110).  Saving model ...
Epoch: 4 cost time: 0.4566969871520996
Epoch: 4, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.141 Vali Acc: 0.781 Test Loss: 1.141 Test Acc: 0.781
Validation loss decreased (-0.678110 --> -0.781239).  Saving model ...
Epoch: 5 cost time: 0.518674373626709
Epoch: 5, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.852 Vali Acc: 0.812 Test Loss: 0.852 Test Acc: 0.812
Validation loss decreased (-0.781239 --> -0.812491).  Saving model ...
Epoch: 6 cost time: 0.5008466243743896
Epoch: 6, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.669 Vali Acc: 0.847 Test Loss: 0.669 Test Acc: 0.847
Validation loss decreased (-0.812491 --> -0.846868).  Saving model ...
Epoch: 7 cost time: 0.5147976875305176
Epoch: 7, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4774308204650879
Epoch: 8, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
Validation loss decreased (-0.846868 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.4989767074584961
Epoch: 9, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.5122745037078857
Epoch: 10, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.5561392307281494
Epoch: 11, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.49688124656677246
Epoch: 12, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.484421968460083
Epoch: 13, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5255699157714844
Epoch: 14, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4767172336578369
Epoch: 15, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.47460150718688965
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5323777198791504
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6699230670928955
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.46721482276916504
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.45834970474243164
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5989096164703369
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 98632
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.710529088973999
Epoch: 1, Steps: 8 | Train Loss: 2.233 Vali Loss: 2.109 Vali Acc: 0.116 Test Loss: 2.109 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.421039342880249
Epoch: 2, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.924 Vali Acc: 0.300 Test Loss: 1.924 Test Acc: 0.300
Validation loss decreased (-0.115604 --> -0.299981).  Saving model ...
Epoch: 3 cost time: 0.5022232532501221
Epoch: 3, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.626 Vali Acc: 0.631 Test Loss: 1.626 Test Acc: 0.631
Validation loss decreased (-0.299981 --> -0.631234).  Saving model ...
Epoch: 4 cost time: 0.5029046535491943
Epoch: 4, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.290 Vali Acc: 0.775 Test Loss: 1.290 Test Acc: 0.775
Validation loss decreased (-0.631234 --> -0.774987).  Saving model ...
Epoch: 5 cost time: 0.5478458404541016
Epoch: 5, Steps: 8 | Train Loss: 0.968 Vali Loss: 0.993 Vali Acc: 0.806 Test Loss: 0.993 Test Acc: 0.806
Validation loss decreased (-0.774987 --> -0.806240).  Saving model ...
Epoch: 6 cost time: 0.4640812873840332
Epoch: 6, Steps: 8 | Train Loss: 0.743 Vali Loss: 0.787 Vali Acc: 0.791 Test Loss: 0.787 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49727463722229004
Epoch: 7, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.654 Vali Acc: 0.834 Test Loss: 0.654 Test Acc: 0.834
Validation loss decreased (-0.806240 --> -0.834368).  Saving model ...
Epoch: 8 cost time: 0.44277477264404297
Epoch: 8, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.583 Vali Acc: 0.831 Test Loss: 0.583 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.41900014877319336
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.834368 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.5333051681518555
Epoch: 10, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4773225784301758
Epoch: 11, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.39409351348876953
Epoch: 12, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.569645881652832
Epoch: 13, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.467 Vali Acc: 0.853 Test Loss: 0.467 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 0.5590634346008301
Epoch: 14, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.39397192001342773
Epoch: 15, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.45113515853881836
Epoch: 16, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.46216821670532227
Epoch: 17, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4657557010650635
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4366881847381592
Epoch: 19, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.465 Vali Acc: 0.834 Test Loss: 0.465 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5698544979095459
Epoch: 20, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5002880096435547
Epoch: 21, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.49921512603759766
Epoch: 22, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4142417907714844
Epoch: 23, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 88392
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.794010877609253
Epoch: 1, Steps: 8 | Train Loss: 2.097 Vali Loss: 2.024 Vali Acc: 0.272 Test Loss: 2.024 Test Acc: 0.272
Validation loss decreased (inf --> -0.271855).  Saving model ...
Epoch: 2 cost time: 0.5340051651000977
Epoch: 2, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.890 Vali Acc: 0.397 Test Loss: 1.890 Test Acc: 0.397
Validation loss decreased (-0.271855 --> -0.396856).  Saving model ...
Epoch: 3 cost time: 0.4884958267211914
Epoch: 3, Steps: 8 | Train Loss: 1.735 Vali Loss: 1.678 Vali Acc: 0.572 Test Loss: 1.678 Test Acc: 0.572
Validation loss decreased (-0.396856 --> -0.571858).  Saving model ...
Epoch: 4 cost time: 0.5418064594268799
Epoch: 4, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.430 Vali Acc: 0.719 Test Loss: 1.430 Test Acc: 0.719
Validation loss decreased (-0.571858 --> -0.718736).  Saving model ...
Epoch: 5 cost time: 0.4633021354675293
Epoch: 5, Steps: 8 | Train Loss: 1.219 Vali Loss: 1.180 Vali Acc: 0.762 Test Loss: 1.180 Test Acc: 0.762
Validation loss decreased (-0.718736 --> -0.762488).  Saving model ...
Epoch: 6 cost time: 0.4213523864746094
Epoch: 6, Steps: 8 | Train Loss: 0.948 Vali Loss: 0.975 Vali Acc: 0.797 Test Loss: 0.975 Test Acc: 0.797
Validation loss decreased (-0.762488 --> -0.796865).  Saving model ...
Epoch: 7 cost time: 0.4744534492492676
Epoch: 7, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.815 Vali Acc: 0.803 Test Loss: 0.815 Test Acc: 0.803
Validation loss decreased (-0.796865 --> -0.803117).  Saving model ...
Epoch: 8 cost time: 0.4719383716583252
Epoch: 8, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.698 Vali Acc: 0.812 Test Loss: 0.698 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812493).  Saving model ...
Epoch: 9 cost time: 0.5054111480712891
Epoch: 9, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.621 Vali Acc: 0.831 Test Loss: 0.621 Test Acc: 0.831
Validation loss decreased (-0.812493 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 0.4517226219177246
Epoch: 10, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 0.4476621150970459
Epoch: 11, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5604946613311768
Epoch: 12, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 13 cost time: 0.43546533584594727
Epoch: 13, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.486 Vali Acc: 0.834 Test Loss: 0.486 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.5633256435394287
Epoch: 14, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.480 Vali Acc: 0.834 Test Loss: 0.480 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 0.45843076705932617
Epoch: 15, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 0.4630241394042969
Epoch: 16, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.467 Vali Acc: 0.834 Test Loss: 0.467 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.47048354148864746
Epoch: 17, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 0.4551270008087158
Epoch: 18, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5271193981170654
Epoch: 19, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.450 Vali Acc: 0.838 Test Loss: 0.450 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5093586444854736
Epoch: 20, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.453 Vali Acc: 0.838 Test Loss: 0.453 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5395565032958984
Epoch: 21, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.446 Vali Acc: 0.838 Test Loss: 0.446 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4920189380645752
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840621).  Saving model ...
Epoch: 23 cost time: 0.4397444725036621
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.46134352684020996
Epoch: 24, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.459 Vali Acc: 0.831 Test Loss: 0.459 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4488406181335449
Epoch: 25, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.458 Vali Acc: 0.831 Test Loss: 0.458 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4023094177246094
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.449 Vali Acc: 0.838 Test Loss: 0.449 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.40439558029174805
Epoch: 27, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.448 Vali Acc: 0.838 Test Loss: 0.448 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4491093158721924
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.457 Vali Acc: 0.834 Test Loss: 0.457 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.3978409767150879
Epoch: 29, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.3989078998565674
Epoch: 30, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5334830284118652
Epoch: 31, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5406501293182373
Epoch: 32, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 80200
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8823955059051514
Epoch: 1, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.943 Vali Acc: 0.316 Test Loss: 1.943 Test Acc: 0.316
Validation loss decreased (inf --> -0.315606).  Saving model ...
Epoch: 2 cost time: 0.5139739513397217
Epoch: 2, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.842 Vali Acc: 0.378 Test Loss: 1.842 Test Acc: 0.378
Validation loss decreased (-0.315606 --> -0.378107).  Saving model ...
Epoch: 3 cost time: 0.5203728675842285
Epoch: 3, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.681 Vali Acc: 0.537 Test Loss: 1.681 Test Acc: 0.537
Validation loss decreased (-0.378107 --> -0.537483).  Saving model ...
Epoch: 4 cost time: 0.47710323333740234
Epoch: 4, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.485 Vali Acc: 0.694 Test Loss: 1.485 Test Acc: 0.694
Validation loss decreased (-0.537483 --> -0.693735).  Saving model ...
Epoch: 5 cost time: 0.5532760620117188
Epoch: 5, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.281 Vali Acc: 0.759 Test Loss: 1.281 Test Acc: 0.759
Validation loss decreased (-0.693735 --> -0.759362).  Saving model ...
Epoch: 6 cost time: 0.5495893955230713
Epoch: 6, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.098 Vali Acc: 0.803 Test Loss: 1.098 Test Acc: 0.803
Validation loss decreased (-0.759362 --> -0.803114).  Saving model ...
Epoch: 7 cost time: 0.6029655933380127
Epoch: 7, Steps: 8 | Train Loss: 0.896 Vali Loss: 0.951 Vali Acc: 0.803 Test Loss: 0.951 Test Acc: 0.803
Validation loss decreased (-0.803114 --> -0.803115).  Saving model ...
Epoch: 8 cost time: 0.5244264602661133
Epoch: 8, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.829 Vali Acc: 0.809 Test Loss: 0.829 Test Acc: 0.809
Validation loss decreased (-0.803115 --> -0.809367).  Saving model ...
Epoch: 9 cost time: 0.4998667240142822
Epoch: 9, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.729 Vali Acc: 0.816 Test Loss: 0.729 Test Acc: 0.816
Validation loss decreased (-0.809367 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 0.45634007453918457
Epoch: 10, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818743).  Saving model ...
Epoch: 11 cost time: 0.47507572174072266
Epoch: 11, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.818743 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.5536372661590576
Epoch: 12, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.582 Vali Acc: 0.834 Test Loss: 0.582 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 0.5233807563781738
Epoch: 13, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.554 Vali Acc: 0.847 Test Loss: 0.554 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846869).  Saving model ...
Epoch: 14 cost time: 0.48868560791015625
Epoch: 14, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.5461232662200928
Epoch: 15, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.40388989448547363
Epoch: 16, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5257699489593506
Epoch: 17, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 0.5685007572174072
Epoch: 18, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5471558570861816
Epoch: 19, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.54022216796875
Epoch: 20, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.477 Vali Acc: 0.831 Test Loss: 0.477 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5845069885253906
Epoch: 21, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.474 Vali Acc: 0.834 Test Loss: 0.474 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.551222562789917
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5213804244995117
Epoch: 23, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.597743034362793
Epoch: 24, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5067546367645264
Epoch: 25, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.465 Vali Acc: 0.831 Test Loss: 0.465 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5130250453948975
Epoch: 26, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5161933898925781
Epoch: 27, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.453 Vali Acc: 0.838 Test Loss: 0.453 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 75016
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7289021015167236
Epoch: 1, Steps: 8 | Train Loss: 2.063 Vali Loss: 2.022 Vali Acc: 0.231 Test Loss: 2.022 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.5092127323150635
Epoch: 2, Steps: 8 | Train Loss: 1.956 Vali Loss: 1.921 Vali Acc: 0.334 Test Loss: 1.921 Test Acc: 0.334
Validation loss decreased (-0.231230 --> -0.334356).  Saving model ...
Epoch: 3 cost time: 0.581193208694458
Epoch: 3, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.765 Vali Acc: 0.472 Test Loss: 1.765 Test Acc: 0.472
Validation loss decreased (-0.334356 --> -0.471857).  Saving model ...
Epoch: 4 cost time: 0.5602242946624756
Epoch: 4, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.578 Vali Acc: 0.606 Test Loss: 1.578 Test Acc: 0.606
Validation loss decreased (-0.471857 --> -0.606234).  Saving model ...
Epoch: 5 cost time: 0.529015302658081
Epoch: 5, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.391 Vali Acc: 0.697 Test Loss: 1.391 Test Acc: 0.697
Validation loss decreased (-0.606234 --> -0.696861).  Saving model ...
Epoch: 6 cost time: 0.5023880004882812
Epoch: 6, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.216 Vali Acc: 0.762 Test Loss: 1.216 Test Acc: 0.762
Validation loss decreased (-0.696861 --> -0.762488).  Saving model ...
Epoch: 7 cost time: 0.4348640441894531
Epoch: 7, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.067 Vali Acc: 0.803 Test Loss: 1.067 Test Acc: 0.803
Validation loss decreased (-0.762488 --> -0.803114).  Saving model ...
Epoch: 8 cost time: 0.5170028209686279
Epoch: 8, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.932 Vali Acc: 0.828 Test Loss: 0.932 Test Acc: 0.828
Validation loss decreased (-0.803114 --> -0.828116).  Saving model ...
Epoch: 9 cost time: 0.5302693843841553
Epoch: 9, Steps: 8 | Train Loss: 0.766 Vali Loss: 0.830 Vali Acc: 0.847 Test Loss: 0.830 Test Acc: 0.847
Validation loss decreased (-0.828116 --> -0.846867).  Saving model ...
Epoch: 10 cost time: 0.5109593868255615
Epoch: 10, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.846867 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.43515777587890625
Epoch: 11, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.690 Vali Acc: 0.853 Test Loss: 0.690 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853118).  Saving model ...
Epoch: 12 cost time: 0.4455387592315674
Epoch: 12, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.48891448974609375
Epoch: 13, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
Validation loss decreased (-0.853118 --> -0.859369).  Saving model ...
Epoch: 14 cost time: 0.5305013656616211
Epoch: 14, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.576 Vali Acc: 0.859 Test Loss: 0.576 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 0.5029575824737549
Epoch: 15, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.555 Vali Acc: 0.859 Test Loss: 0.555 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859369).  Saving model ...
Epoch: 16 cost time: 0.4898996353149414
Epoch: 16, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.535 Vali Acc: 0.863 Test Loss: 0.535 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 0.563286304473877
Epoch: 17, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5807943344116211
Epoch: 18, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.508 Vali Acc: 0.859 Test Loss: 0.508 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4805891513824463
Epoch: 19, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.496 Vali Acc: 0.859 Test Loss: 0.496 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.48381495475769043
Epoch: 20, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5223085880279541
Epoch: 21, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.49867796897888184
Epoch: 22, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 23 cost time: 0.49701547622680664
Epoch: 23, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5615160465240479
Epoch: 24, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5409126281738281
Epoch: 25, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5869858264923096
Epoch: 26, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5259857177734375
Epoch: 27, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.451 Vali Acc: 0.863 Test Loss: 0.451 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5704612731933594
Epoch: 28, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.444 Vali Acc: 0.863 Test Loss: 0.444 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4961273670196533
Epoch: 29, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5837852954864502
Epoch: 30, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5283095836639404
Epoch: 31, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5263636112213135
Epoch: 32, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 72968
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8103079795837402
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.015 Vali Acc: 0.169 Test Loss: 2.015 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 0.5036475658416748
Epoch: 2, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.642 Vali Acc: 0.606 Test Loss: 1.642 Test Acc: 0.606
Validation loss decreased (-0.168730 --> -0.606234).  Saving model ...
Epoch: 3 cost time: 0.5080854892730713
Epoch: 3, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.178 Vali Acc: 0.781 Test Loss: 1.178 Test Acc: 0.781
Validation loss decreased (-0.606234 --> -0.781238).  Saving model ...
Epoch: 4 cost time: 0.49085211753845215
Epoch: 4, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.825 Vali Acc: 0.806 Test Loss: 0.825 Test Acc: 0.806
Validation loss decreased (-0.781238 --> -0.806242).  Saving model ...
Epoch: 5 cost time: 0.5141658782958984
Epoch: 5, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.622 Vali Acc: 0.834 Test Loss: 0.622 Test Acc: 0.834
Validation loss decreased (-0.806242 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 0.4886493682861328
Epoch: 6, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.5049750804901123
Epoch: 7, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 0.5517749786376953
Epoch: 8, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5055463314056396
Epoch: 9, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.520209789276123
Epoch: 10, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5210227966308594
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5262343883514404
Epoch: 12, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5372641086578369
Epoch: 13, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5280055999755859
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5509328842163086
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5040774345397949
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.42693209648132324
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 76456
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.702566146850586
Epoch: 1, Steps: 8 | Train Loss: 1.982 Vali Loss: 1.925 Vali Acc: 0.384 Test Loss: 1.925 Test Acc: 0.384
Validation loss decreased (inf --> -0.384356).  Saving model ...
Epoch: 2 cost time: 0.49132227897644043
Epoch: 2, Steps: 8 | Train Loss: 1.802 Vali Loss: 1.745 Vali Acc: 0.578 Test Loss: 1.745 Test Acc: 0.578
Validation loss decreased (-0.384356 --> -0.578108).  Saving model ...
Epoch: 3 cost time: 0.518582820892334
Epoch: 3, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.477 Vali Acc: 0.703 Test Loss: 1.477 Test Acc: 0.703
Validation loss decreased (-0.578108 --> -0.703110).  Saving model ...
Epoch: 4 cost time: 0.5334815979003906
Epoch: 4, Steps: 8 | Train Loss: 1.191 Vali Loss: 1.187 Vali Acc: 0.744 Test Loss: 1.187 Test Acc: 0.744
Validation loss decreased (-0.703110 --> -0.743738).  Saving model ...
Epoch: 5 cost time: 0.47800397872924805
Epoch: 5, Steps: 8 | Train Loss: 0.917 Vali Loss: 0.945 Vali Acc: 0.781 Test Loss: 0.945 Test Acc: 0.781
Validation loss decreased (-0.743738 --> -0.781241).  Saving model ...
Epoch: 6 cost time: 0.5038912296295166
Epoch: 6, Steps: 8 | Train Loss: 0.729 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
Validation loss decreased (-0.781241 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5649027824401855
Epoch: 7, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 0.5066251754760742
Epoch: 8, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.4551868438720703
Epoch: 9, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.48239850997924805
Epoch: 10, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.4913969039916992
Epoch: 11, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.518718957901001
Epoch: 12, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4891040325164795
Epoch: 13, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49340391159057617
Epoch: 14, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.4731459617614746
Epoch: 15, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48291921615600586
Epoch: 16, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5194921493530273
Epoch: 17, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5737452507019043
Epoch: 18, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.493 Vali Acc: 0.831 Test Loss: 0.493 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.47202610969543457
Epoch: 19, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.497 Vali Acc: 0.834 Test Loss: 0.497 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4476742744445801
Epoch: 20, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4523792266845703
Epoch: 21, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5647835731506348
Epoch: 22, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4924447536468506
Epoch: 23, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.505805492401123
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 46760
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6186797618865967
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.084 Vali Acc: 0.081 Test Loss: 2.084 Test Acc: 0.081
Validation loss decreased (inf --> -0.081229).  Saving model ...
Epoch: 2 cost time: 0.5243165493011475
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.967 Vali Acc: 0.231 Test Loss: 1.967 Test Acc: 0.231
Validation loss decreased (-0.081229 --> -0.231230).  Saving model ...
Epoch: 3 cost time: 0.49883460998535156
Epoch: 3, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.768 Vali Acc: 0.475 Test Loss: 1.768 Test Acc: 0.475
Validation loss decreased (-0.231230 --> -0.474982).  Saving model ...
Epoch: 4 cost time: 0.4972994327545166
Epoch: 4, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.516 Vali Acc: 0.688 Test Loss: 1.516 Test Acc: 0.688
Validation loss decreased (-0.474982 --> -0.687485).  Saving model ...
Epoch: 5 cost time: 0.49739766120910645
Epoch: 5, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.257 Vali Acc: 0.762 Test Loss: 1.257 Test Acc: 0.762
Validation loss decreased (-0.687485 --> -0.762487).  Saving model ...
Epoch: 6 cost time: 0.5283603668212891
Epoch: 6, Steps: 8 | Train Loss: 1.014 Vali Loss: 1.027 Vali Acc: 0.797 Test Loss: 1.027 Test Acc: 0.797
Validation loss decreased (-0.762487 --> -0.796865).  Saving model ...
Epoch: 7 cost time: 0.4317030906677246
Epoch: 7, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.854 Vali Acc: 0.819 Test Loss: 0.854 Test Acc: 0.819
Validation loss decreased (-0.796865 --> -0.818741).  Saving model ...
Epoch: 8 cost time: 0.49652647972106934
Epoch: 8, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.728 Vali Acc: 0.834 Test Loss: 0.728 Test Acc: 0.834
Validation loss decreased (-0.818741 --> -0.834368).  Saving model ...
Epoch: 9 cost time: 0.484485387802124
Epoch: 9, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.640 Vali Acc: 0.841 Test Loss: 0.640 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.4083263874053955
Epoch: 10, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.585 Vali Acc: 0.853 Test Loss: 0.585 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853119).  Saving model ...
Epoch: 11 cost time: 0.5443482398986816
Epoch: 11, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.547 Vali Acc: 0.853 Test Loss: 0.547 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.46164608001708984
Epoch: 12, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.4842677116394043
Epoch: 13, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4444737434387207
Epoch: 14, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.490 Vali Acc: 0.859 Test Loss: 0.490 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.49965763092041016
Epoch: 15, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4891993999481201
Epoch: 16, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4414405822753906
Epoch: 17, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.47971200942993164
Epoch: 18, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5130279064178467
Epoch: 19, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.45671701431274414
Epoch: 20, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5001227855682373
Epoch: 21, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5039238929748535
Epoch: 22, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.48570752143859863
Epoch: 23, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5153086185455322
Epoch: 24, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 37032
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9039132595062256
Epoch: 1, Steps: 8 | Train Loss: 2.059 Vali Loss: 2.036 Vali Acc: 0.181 Test Loss: 2.036 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 0.5363540649414062
Epoch: 2, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.935 Vali Acc: 0.284 Test Loss: 1.935 Test Acc: 0.284
Validation loss decreased (-0.181230 --> -0.284356).  Saving model ...
Epoch: 3 cost time: 0.4963972568511963
Epoch: 3, Steps: 8 | Train Loss: 1.790 Vali Loss: 1.775 Vali Acc: 0.475 Test Loss: 1.775 Test Acc: 0.475
Validation loss decreased (-0.284356 --> -0.474982).  Saving model ...
Epoch: 4 cost time: 0.5684537887573242
Epoch: 4, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.577 Vali Acc: 0.619 Test Loss: 1.577 Test Acc: 0.619
Validation loss decreased (-0.474982 --> -0.618734).  Saving model ...
Epoch: 5 cost time: 0.5633111000061035
Epoch: 5, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.370 Vali Acc: 0.738 Test Loss: 1.370 Test Acc: 0.738
Validation loss decreased (-0.618734 --> -0.737486).  Saving model ...
Epoch: 6 cost time: 0.5247182846069336
Epoch: 6, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.174 Vali Acc: 0.781 Test Loss: 1.174 Test Acc: 0.781
Validation loss decreased (-0.737486 --> -0.781238).  Saving model ...
Epoch: 7 cost time: 0.5749280452728271
Epoch: 7, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.005 Vali Acc: 0.800 Test Loss: 1.005 Test Acc: 0.800
Validation loss decreased (-0.781238 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.5473310947418213
Epoch: 8, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.881 Vali Acc: 0.809 Test Loss: 0.881 Test Acc: 0.809
Validation loss decreased (-0.799990 --> -0.809366).  Saving model ...
Epoch: 9 cost time: 0.5362341403961182
Epoch: 9, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.777 Vali Acc: 0.828 Test Loss: 0.777 Test Acc: 0.828
Validation loss decreased (-0.809366 --> -0.828117).  Saving model ...
Epoch: 10 cost time: 0.5565822124481201
Epoch: 10, Steps: 8 | Train Loss: 0.599 Vali Loss: 0.706 Vali Acc: 0.834 Test Loss: 0.706 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834368).  Saving model ...
Epoch: 11 cost time: 0.530747652053833
Epoch: 11, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.654 Vali Acc: 0.841 Test Loss: 0.654 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840618).  Saving model ...
Epoch: 12 cost time: 0.5548269748687744
Epoch: 12, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.619 Vali Acc: 0.834 Test Loss: 0.619 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.509192705154419
Epoch: 13, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
Validation loss decreased (-0.840618 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 0.5819356441497803
Epoch: 14, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846869).  Saving model ...
Epoch: 15 cost time: 0.5149731636047363
Epoch: 15, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.46939730644226074
Epoch: 16, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4911665916442871
Epoch: 17, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5398979187011719
Epoch: 18, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5345542430877686
Epoch: 19, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5225050449371338
Epoch: 20, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5309898853302002
Epoch: 21, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5226471424102783
Epoch: 22, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4905738830566406
Epoch: 23, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4905097484588623
Epoch: 24, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.502 Vali Acc: 0.828 Test Loss: 0.502 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 31912
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6804418563842773
Epoch: 1, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.982 Vali Acc: 0.247 Test Loss: 1.982 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.4175901412963867
Epoch: 2, Steps: 8 | Train Loss: 1.942 Vali Loss: 1.897 Vali Acc: 0.381 Test Loss: 1.897 Test Acc: 0.381
Validation loss decreased (-0.246855 --> -0.381231).  Saving model ...
Epoch: 3 cost time: 0.5187561511993408
Epoch: 3, Steps: 8 | Train Loss: 1.829 Vali Loss: 1.767 Vali Acc: 0.528 Test Loss: 1.767 Test Acc: 0.528
Validation loss decreased (-0.381231 --> -0.528107).  Saving model ...
Epoch: 4 cost time: 0.4726099967956543
Epoch: 4, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.610 Vali Acc: 0.628 Test Loss: 1.610 Test Acc: 0.628
Validation loss decreased (-0.528107 --> -0.628109).  Saving model ...
Epoch: 5 cost time: 0.4734792709350586
Epoch: 5, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.442 Vali Acc: 0.719 Test Loss: 1.442 Test Acc: 0.719
Validation loss decreased (-0.628109 --> -0.718736).  Saving model ...
Epoch: 6 cost time: 0.49897241592407227
Epoch: 6, Steps: 8 | Train Loss: 1.301 Vali Loss: 1.282 Vali Acc: 0.775 Test Loss: 1.282 Test Acc: 0.775
Validation loss decreased (-0.718736 --> -0.774987).  Saving model ...
Epoch: 7 cost time: 0.44470977783203125
Epoch: 7, Steps: 8 | Train Loss: 1.142 Vali Loss: 1.129 Vali Acc: 0.800 Test Loss: 1.129 Test Acc: 0.800
Validation loss decreased (-0.774987 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.4851951599121094
Epoch: 8, Steps: 8 | Train Loss: 0.982 Vali Loss: 0.989 Vali Acc: 0.812 Test Loss: 0.989 Test Acc: 0.812
Validation loss decreased (-0.799989 --> -0.812490).  Saving model ...
Epoch: 9 cost time: 0.536409854888916
Epoch: 9, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.882 Vali Acc: 0.828 Test Loss: 0.882 Test Acc: 0.828
Validation loss decreased (-0.812490 --> -0.828116).  Saving model ...
Epoch: 10 cost time: 0.500046968460083
Epoch: 10, Steps: 8 | Train Loss: 0.749 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4759042263031006
Epoch: 11, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.722 Vali Acc: 0.834 Test Loss: 0.722 Test Acc: 0.834
Validation loss decreased (-0.828116 --> -0.834368).  Saving model ...
Epoch: 12 cost time: 0.4545459747314453
Epoch: 12, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.667 Vali Acc: 0.847 Test Loss: 0.667 Test Acc: 0.847
Validation loss decreased (-0.834368 --> -0.846868).  Saving model ...
Epoch: 13 cost time: 0.47056126594543457
Epoch: 13, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
Validation loss decreased (-0.846868 --> -0.856244).  Saving model ...
Epoch: 14 cost time: 0.40837836265563965
Epoch: 14, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 15 cost time: 0.459883451461792
Epoch: 15, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 16 cost time: 0.5090723037719727
Epoch: 16, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 0.4764137268066406
Epoch: 17, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 0.5140480995178223
Epoch: 18, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.506 Vali Acc: 0.866 Test Loss: 0.506 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 0.5543439388275146
Epoch: 19, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 20 cost time: 0.47010278701782227
Epoch: 20, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.489 Vali Acc: 0.872 Test Loss: 0.489 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 21 cost time: 0.49569153785705566
Epoch: 21, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.483 Vali Acc: 0.872 Test Loss: 0.483 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 22 cost time: 0.5223779678344727
Epoch: 22, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5415596961975098
Epoch: 23, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.469 Vali Acc: 0.866 Test Loss: 0.469 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.46497106552124023
Epoch: 24, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.461 Vali Acc: 0.863 Test Loss: 0.461 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5200486183166504
Epoch: 25, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4514322280883789
Epoch: 26, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5484850406646729
Epoch: 27, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.455 Vali Acc: 0.863 Test Loss: 0.455 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.505962610244751
Epoch: 28, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5273499488830566
Epoch: 29, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6073241233825684
Epoch: 30, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.595844030380249
Epoch: 31, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 27816
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.57098388671875
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 2.103 Vali Acc: 0.091 Test Loss: 2.103 Test Acc: 0.091
Validation loss decreased (inf --> -0.090604).  Saving model ...
Epoch: 2 cost time: 0.49042367935180664
Epoch: 2, Steps: 8 | Train Loss: 2.070 Vali Loss: 2.049 Vali Acc: 0.159 Test Loss: 2.049 Test Acc: 0.159
Validation loss decreased (-0.090604 --> -0.159355).  Saving model ...
Epoch: 3 cost time: 0.45581889152526855
Epoch: 3, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.958 Vali Acc: 0.287 Test Loss: 1.958 Test Acc: 0.287
Validation loss decreased (-0.159355 --> -0.287480).  Saving model ...
Epoch: 4 cost time: 0.431429386138916
Epoch: 4, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.837 Vali Acc: 0.438 Test Loss: 1.837 Test Acc: 0.438
Validation loss decreased (-0.287480 --> -0.437482).  Saving model ...
Epoch: 5 cost time: 0.44291090965270996
Epoch: 5, Steps: 8 | Train Loss: 1.731 Vali Loss: 1.705 Vali Acc: 0.591 Test Loss: 1.705 Test Acc: 0.591
Validation loss decreased (-0.437482 --> -0.590608).  Saving model ...
Epoch: 6 cost time: 0.45566320419311523
Epoch: 6, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.569 Vali Acc: 0.678 Test Loss: 1.569 Test Acc: 0.678
Validation loss decreased (-0.590608 --> -0.678109).  Saving model ...
Epoch: 7 cost time: 0.4539499282836914
Epoch: 7, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.434 Vali Acc: 0.738 Test Loss: 1.434 Test Acc: 0.738
Validation loss decreased (-0.678109 --> -0.737486).  Saving model ...
Epoch: 8 cost time: 0.45026659965515137
Epoch: 8, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.307 Vali Acc: 0.762 Test Loss: 1.307 Test Acc: 0.762
Validation loss decreased (-0.737486 --> -0.762487).  Saving model ...
Epoch: 9 cost time: 0.5375664234161377
Epoch: 9, Steps: 8 | Train Loss: 1.189 Vali Loss: 1.189 Vali Acc: 0.784 Test Loss: 1.189 Test Acc: 0.784
Validation loss decreased (-0.762487 --> -0.784363).  Saving model ...
Epoch: 10 cost time: 0.41529369354248047
Epoch: 10, Steps: 8 | Train Loss: 1.056 Vali Loss: 1.078 Vali Acc: 0.797 Test Loss: 1.078 Test Acc: 0.797
Validation loss decreased (-0.784363 --> -0.796864).  Saving model ...
Epoch: 11 cost time: 0.4655113220214844
Epoch: 11, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.981 Vali Acc: 0.806 Test Loss: 0.981 Test Acc: 0.806
Validation loss decreased (-0.796864 --> -0.806240).  Saving model ...
Epoch: 12 cost time: 0.4407672882080078
Epoch: 12, Steps: 8 | Train Loss: 0.828 Vali Loss: 0.897 Vali Acc: 0.812 Test Loss: 0.897 Test Acc: 0.812
Validation loss decreased (-0.806240 --> -0.812491).  Saving model ...
Epoch: 13 cost time: 0.4670755863189697
Epoch: 13, Steps: 8 | Train Loss: 0.754 Vali Loss: 0.831 Vali Acc: 0.819 Test Loss: 0.831 Test Acc: 0.819
Validation loss decreased (-0.812491 --> -0.818742).  Saving model ...
Epoch: 14 cost time: 0.4719240665435791
Epoch: 14, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
Validation loss decreased (-0.818742 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.44193077087402344
Epoch: 15, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.5136644840240479
Epoch: 16, Steps: 8 | Train Loss: 0.584 Vali Loss: 0.691 Vali Acc: 0.834 Test Loss: 0.691 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834368).  Saving model ...
Epoch: 17 cost time: 0.44754672050476074
Epoch: 17, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.667 Vali Acc: 0.825 Test Loss: 0.667 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46132850646972656
Epoch: 18, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843744).  Saving model ...
Epoch: 19 cost time: 0.4629206657409668
Epoch: 19, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.611 Vali Acc: 0.838 Test Loss: 0.611 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4905412197113037
Epoch: 20, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.589 Vali Acc: 0.841 Test Loss: 0.589 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5033211708068848
Epoch: 21, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.44707417488098145
Epoch: 22, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 23 cost time: 0.4477267265319824
Epoch: 23, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4687793254852295
Epoch: 24, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4698340892791748
Epoch: 25, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 26 cost time: 0.46872687339782715
Epoch: 26, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 27 cost time: 0.5252306461334229
Epoch: 27, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 28 cost time: 0.4735124111175537
Epoch: 28, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 0.5100224018096924
Epoch: 29, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5041069984436035
Epoch: 30, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5338757038116455
Epoch: 31, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.49895358085632324
Epoch: 32, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4948694705963135
Epoch: 33, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.42966389656066895
Epoch: 34, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5441708564758301
Epoch: 35, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.467266321182251
Epoch: 36, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 37 cost time: 0.47977161407470703
Epoch: 37, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.49616479873657227
Epoch: 38, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.591134786605835
Epoch: 39, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6141774654388428
Epoch: 40, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5887720584869385
Epoch: 41, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.59454345703125
Epoch: 42, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5624377727508545
Epoch: 43, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5886790752410889
Epoch: 44, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6205077171325684
Epoch: 45, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5743052959442139
Epoch: 46, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 25224
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7085177898406982
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 2.109 Vali Acc: 0.138 Test Loss: 2.109 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.5724577903747559
Epoch: 2, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.069 Vali Acc: 0.169 Test Loss: 2.069 Test Acc: 0.169
Validation loss decreased (-0.137479 --> -0.168729).  Saving model ...
Epoch: 3 cost time: 0.5036990642547607
Epoch: 3, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.999 Vali Acc: 0.272 Test Loss: 1.999 Test Acc: 0.272
Validation loss decreased (-0.168729 --> -0.271855).  Saving model ...
Epoch: 4 cost time: 0.5149707794189453
Epoch: 4, Steps: 8 | Train Loss: 1.915 Vali Loss: 1.910 Vali Acc: 0.341 Test Loss: 1.910 Test Acc: 0.341
Validation loss decreased (-0.271855 --> -0.340606).  Saving model ...
Epoch: 5 cost time: 0.5160560607910156
Epoch: 5, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.800 Vali Acc: 0.422 Test Loss: 1.800 Test Acc: 0.422
Validation loss decreased (-0.340606 --> -0.421857).  Saving model ...
Epoch: 6 cost time: 0.4601423740386963
Epoch: 6, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.681 Vali Acc: 0.534 Test Loss: 1.681 Test Acc: 0.534
Validation loss decreased (-0.421857 --> -0.534358).  Saving model ...
Epoch: 7 cost time: 0.4805736541748047
Epoch: 7, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.561 Vali Acc: 0.616 Test Loss: 1.561 Test Acc: 0.616
Validation loss decreased (-0.534358 --> -0.615609).  Saving model ...
Epoch: 8 cost time: 0.49284911155700684
Epoch: 8, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.443 Vali Acc: 0.656 Test Loss: 1.443 Test Acc: 0.656
Validation loss decreased (-0.615609 --> -0.656236).  Saving model ...
Epoch: 9 cost time: 0.5323750972747803
Epoch: 9, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.333 Vali Acc: 0.697 Test Loss: 1.333 Test Acc: 0.697
Validation loss decreased (-0.656236 --> -0.696862).  Saving model ...
Epoch: 10 cost time: 0.466733455657959
Epoch: 10, Steps: 8 | Train Loss: 1.170 Vali Loss: 1.227 Vali Acc: 0.725 Test Loss: 1.227 Test Acc: 0.725
Validation loss decreased (-0.696862 --> -0.724988).  Saving model ...
Epoch: 11 cost time: 0.5464804172515869
Epoch: 11, Steps: 8 | Train Loss: 1.050 Vali Loss: 1.133 Vali Acc: 0.747 Test Loss: 1.133 Test Acc: 0.747
Validation loss decreased (-0.724988 --> -0.746864).  Saving model ...
Epoch: 12 cost time: 0.48928117752075195
Epoch: 12, Steps: 8 | Train Loss: 0.932 Vali Loss: 1.049 Vali Acc: 0.759 Test Loss: 1.049 Test Acc: 0.759
Validation loss decreased (-0.746864 --> -0.759365).  Saving model ...
Epoch: 13 cost time: 0.4710102081298828
Epoch: 13, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
Validation loss decreased (-0.759365 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 0.5609121322631836
Epoch: 14, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.915 Vali Acc: 0.787 Test Loss: 0.915 Test Acc: 0.787
Validation loss decreased (-0.774990 --> -0.787491).  Saving model ...
Epoch: 15 cost time: 0.5362229347229004
Epoch: 15, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.860 Vali Acc: 0.791 Test Loss: 0.860 Test Acc: 0.791
Validation loss decreased (-0.787491 --> -0.790616).  Saving model ...
Epoch: 16 cost time: 0.4944422245025635
Epoch: 16, Steps: 8 | Train Loss: 0.675 Vali Loss: 0.817 Vali Acc: 0.797 Test Loss: 0.817 Test Acc: 0.797
Validation loss decreased (-0.790616 --> -0.796867).  Saving model ...
Epoch: 17 cost time: 0.47947192192077637
Epoch: 17, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.796867 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.5465104579925537
Epoch: 18, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 19 cost time: 0.5224509239196777
Epoch: 19, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809368).  Saving model ...
Epoch: 20 cost time: 0.5632076263427734
Epoch: 20, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815618).  Saving model ...
Epoch: 21 cost time: 0.4755682945251465
Epoch: 21, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.664 Vali Acc: 0.816 Test Loss: 0.664 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 22 cost time: 0.4626336097717285
Epoch: 22, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.640 Vali Acc: 0.822 Test Loss: 0.640 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821869).  Saving model ...
Epoch: 23 cost time: 0.5435388088226318
Epoch: 23, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 24 cost time: 0.51235032081604
Epoch: 24, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 25 cost time: 0.4965212345123291
Epoch: 25, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 26 cost time: 0.5059337615966797
Epoch: 26, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5633482933044434
Epoch: 27, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5466141700744629
Epoch: 28, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.49858760833740234
Epoch: 29, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5266714096069336
Epoch: 30, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.38028573989868164
Epoch: 31, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 32 cost time: 0.5460846424102783
Epoch: 32, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 33 cost time: 0.42148828506469727
Epoch: 33, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 34 cost time: 0.5464320182800293
Epoch: 34, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 35 cost time: 0.44069862365722656
Epoch: 35, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5763881206512451
Epoch: 36, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4891626834869385
Epoch: 37, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 38 cost time: 0.597820520401001
Epoch: 38, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 39 cost time: 0.5110480785369873
Epoch: 39, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4813532829284668
Epoch: 40, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5002310276031494
Epoch: 41, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 42 cost time: 0.4435582160949707
Epoch: 42, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.490 Vali Acc: 0.834 Test Loss: 0.490 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 43 cost time: 0.4569988250732422
Epoch: 43, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 44 cost time: 0.47721409797668457
Epoch: 44, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.489 Vali Acc: 0.834 Test Loss: 0.489 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4640185832977295
Epoch: 45, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.488 Vali Acc: 0.834 Test Loss: 0.488 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5063600540161133
Epoch: 46, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 47 cost time: 0.53704833984375
Epoch: 47, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5237071514129639
Epoch: 48, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.45310354232788086
Epoch: 49, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4740002155303955
Epoch: 50, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 24200
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8692727088928223
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.060 Vali Acc: 0.225 Test Loss: 2.060 Test Acc: 0.225
Validation loss decreased (inf --> -0.224979).  Saving model ...
Epoch: 2 cost time: 0.5747518539428711
Epoch: 2, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.938 Vali Acc: 0.500 Test Loss: 1.938 Test Acc: 0.500
Validation loss decreased (-0.224979 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 0.6004533767700195
Epoch: 3, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.717 Vali Acc: 0.738 Test Loss: 1.717 Test Acc: 0.738
Validation loss decreased (-0.499981 --> -0.737483).  Saving model ...
Epoch: 4 cost time: 0.5620055198669434
Epoch: 4, Steps: 8 | Train Loss: 1.391 Vali Loss: 1.388 Vali Acc: 0.794 Test Loss: 1.388 Test Acc: 0.794
Validation loss decreased (-0.737483 --> -0.793736).  Saving model ...
Epoch: 5 cost time: 0.5757620334625244
Epoch: 5, Steps: 8 | Train Loss: 1.074 Vali Loss: 1.012 Vali Acc: 0.806 Test Loss: 1.012 Test Acc: 0.806
Validation loss decreased (-0.793736 --> -0.806240).  Saving model ...
Epoch: 6 cost time: 0.5616862773895264
Epoch: 6, Steps: 8 | Train Loss: 0.740 Vali Loss: 0.709 Vali Acc: 0.828 Test Loss: 0.709 Test Acc: 0.828
Validation loss decreased (-0.806240 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 0.5631394386291504
Epoch: 7, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.828118 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.6068899631500244
Epoch: 8, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.6124711036682129
Epoch: 9, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.457 Vali Acc: 0.853 Test Loss: 0.457 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.6121673583984375
Epoch: 10, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6085340976715088
Epoch: 11, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6418642997741699
Epoch: 12, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.5822608470916748
Epoch: 13, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6601064205169678
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5694279670715332
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.626997709274292
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.564 Vali Acc: 0.838 Test Loss: 0.564 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6823215484619141
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5657410621643066
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.593 Vali Acc: 0.838 Test Loss: 0.593 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6165354251861572
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.838 Test Loss: 0.600 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.651618242263794
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6307709217071533
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.625908374786377
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 233640
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7217211723327637
Epoch: 1, Steps: 8 | Train Loss: 2.035 Vali Loss: 2.065 Vali Acc: 0.075 Test Loss: 2.065 Test Acc: 0.075
Validation loss decreased (inf --> -0.074979).  Saving model ...
Epoch: 2 cost time: 0.5092916488647461
Epoch: 2, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.984 Vali Acc: 0.316 Test Loss: 1.984 Test Acc: 0.316
Validation loss decreased (-0.074979 --> -0.315605).  Saving model ...
Epoch: 3 cost time: 0.6253399848937988
Epoch: 3, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.837 Vali Acc: 0.628 Test Loss: 1.837 Test Acc: 0.628
Validation loss decreased (-0.315605 --> -0.628107).  Saving model ...
Epoch: 4 cost time: 0.626492977142334
Epoch: 4, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.631 Vali Acc: 0.722 Test Loss: 1.631 Test Acc: 0.722
Validation loss decreased (-0.628107 --> -0.721859).  Saving model ...
Epoch: 5 cost time: 0.6476414203643799
Epoch: 5, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.364 Vali Acc: 0.775 Test Loss: 1.364 Test Acc: 0.775
Validation loss decreased (-0.721859 --> -0.774986).  Saving model ...
Epoch: 6 cost time: 0.6158735752105713
Epoch: 6, Steps: 8 | Train Loss: 1.115 Vali Loss: 1.078 Vali Acc: 0.787 Test Loss: 1.078 Test Acc: 0.787
Validation loss decreased (-0.774986 --> -0.787489).  Saving model ...
Epoch: 7 cost time: 0.6014308929443359
Epoch: 7, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.821 Vali Acc: 0.812 Test Loss: 0.821 Test Acc: 0.812
Validation loss decreased (-0.787489 --> -0.812492).  Saving model ...
Epoch: 8 cost time: 0.6286063194274902
Epoch: 8, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
Validation loss decreased (-0.812492 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.6297464370727539
Epoch: 9, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.5401337146759033
Epoch: 10, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.615565299987793
Epoch: 11, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.6033251285552979
Epoch: 12, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.455 Vali Acc: 0.863 Test Loss: 0.455 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.6003105640411377
Epoch: 13, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6091296672821045
Epoch: 14, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6407289505004883
Epoch: 15, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6388418674468994
Epoch: 16, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5951781272888184
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6076717376708984
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5616436004638672
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5342516899108887
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5720632076263428
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6207969188690186
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 203176
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8751816749572754
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 2.053 Vali Acc: 0.178 Test Loss: 2.053 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 0.6344325542449951
Epoch: 2, Steps: 8 | Train Loss: 2.009 Vali Loss: 1.992 Vali Acc: 0.325 Test Loss: 1.992 Test Acc: 0.325
Validation loss decreased (-0.178104 --> -0.324980).  Saving model ...
Epoch: 3 cost time: 0.6753227710723877
Epoch: 3, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.879 Vali Acc: 0.556 Test Loss: 1.879 Test Acc: 0.556
Validation loss decreased (-0.324980 --> -0.556231).  Saving model ...
Epoch: 4 cost time: 0.6437900066375732
Epoch: 4, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.709 Vali Acc: 0.697 Test Loss: 1.709 Test Acc: 0.697
Validation loss decreased (-0.556231 --> -0.696858).  Saving model ...
Epoch: 5 cost time: 0.6027817726135254
Epoch: 5, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.493 Vali Acc: 0.784 Test Loss: 1.493 Test Acc: 0.784
Validation loss decreased (-0.696858 --> -0.784360).  Saving model ...
Epoch: 6 cost time: 0.6425347328186035
Epoch: 6, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.245 Vali Acc: 0.803 Test Loss: 1.245 Test Acc: 0.803
Validation loss decreased (-0.784360 --> -0.803113).  Saving model ...
Epoch: 7 cost time: 0.6277713775634766
Epoch: 7, Steps: 8 | Train Loss: 1.050 Vali Loss: 0.996 Vali Acc: 0.816 Test Loss: 0.996 Test Acc: 0.816
Validation loss decreased (-0.803113 --> -0.815615).  Saving model ...
Epoch: 8 cost time: 0.6092965602874756
Epoch: 8, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
Validation loss decreased (-0.815615 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.6208059787750244
Epoch: 9, Steps: 8 | Train Loss: 0.646 Vali Loss: 0.646 Vali Acc: 0.838 Test Loss: 0.646 Test Acc: 0.838
Validation loss decreased (-0.824992 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.6830804347991943
Epoch: 10, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6154241561889648
Epoch: 11, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.6419520378112793
Epoch: 12, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.588676929473877
Epoch: 13, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 0.6226093769073486
Epoch: 14, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.460 Vali Acc: 0.859 Test Loss: 0.460 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.5838601589202881
Epoch: 15, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6738801002502441
Epoch: 16, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.477 Vali Acc: 0.834 Test Loss: 0.477 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5924525260925293
Epoch: 17, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6463313102722168
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6515774726867676
Epoch: 19, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6254246234893799
Epoch: 20, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6571037769317627
Epoch: 21, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6284959316253662
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7082734107971191
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6908884048461914
Epoch: 24, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 194216
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.669832706451416
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 2.085 Vali Acc: 0.147 Test Loss: 2.085 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.5075111389160156
Epoch: 2, Steps: 8 | Train Loss: 2.063 Vali Loss: 2.041 Vali Acc: 0.216 Test Loss: 2.041 Test Acc: 0.216
Validation loss decreased (-0.146854 --> -0.215605).  Saving model ...
Epoch: 3 cost time: 0.6006176471710205
Epoch: 3, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.956 Vali Acc: 0.359 Test Loss: 1.956 Test Acc: 0.359
Validation loss decreased (-0.215605 --> -0.359355).  Saving model ...
Epoch: 4 cost time: 0.5216495990753174
Epoch: 4, Steps: 8 | Train Loss: 1.861 Vali Loss: 1.831 Vali Acc: 0.603 Test Loss: 1.831 Test Acc: 0.603
Validation loss decreased (-0.359355 --> -0.603107).  Saving model ...
Epoch: 5 cost time: 0.5935647487640381
Epoch: 5, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.673 Vali Acc: 0.747 Test Loss: 1.673 Test Acc: 0.747
Validation loss decreased (-0.603107 --> -0.746858).  Saving model ...
Epoch: 6 cost time: 0.5379464626312256
Epoch: 6, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.489 Vali Acc: 0.778 Test Loss: 1.489 Test Acc: 0.778
Validation loss decreased (-0.746858 --> -0.778110).  Saving model ...
Epoch: 7 cost time: 0.5854682922363281
Epoch: 7, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.280 Vali Acc: 0.781 Test Loss: 1.280 Test Acc: 0.781
Validation loss decreased (-0.778110 --> -0.781237).  Saving model ...
Epoch: 8 cost time: 0.6700692176818848
Epoch: 8, Steps: 8 | Train Loss: 1.142 Vali Loss: 1.073 Vali Acc: 0.800 Test Loss: 1.073 Test Acc: 0.800
Validation loss decreased (-0.781237 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.5710997581481934
Epoch: 9, Steps: 8 | Train Loss: 0.905 Vali Loss: 0.884 Vali Acc: 0.803 Test Loss: 0.884 Test Acc: 0.803
Validation loss decreased (-0.799989 --> -0.803116).  Saving model ...
Epoch: 10 cost time: 0.5974173545837402
Epoch: 10, Steps: 8 | Train Loss: 0.756 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 0.6403985023498535
Epoch: 11, Steps: 8 | Train Loss: 0.575 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.5815680027008057
Epoch: 12, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 0.589552640914917
Epoch: 13, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
Validation loss decreased (-0.834369 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 0.5498301982879639
Epoch: 14, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5579097270965576
Epoch: 15, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5767781734466553
Epoch: 16, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6136331558227539
Epoch: 17, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.453 Vali Acc: 0.859 Test Loss: 0.453 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 0.6039943695068359
Epoch: 18, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5932848453521729
Epoch: 19, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 20 cost time: 0.5968127250671387
Epoch: 20, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.441 Vali Acc: 0.853 Test Loss: 0.441 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5966448783874512
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6354460716247559
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6601870059967041
Epoch: 23, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 24 cost time: 0.5755126476287842
Epoch: 24, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5541987419128418
Epoch: 25, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6002886295318604
Epoch: 26, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5494608879089355
Epoch: 27, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5897443294525146
Epoch: 28, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.54457688331604
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4865849018096924
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.547234296798706
Epoch: 31, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5942525863647461
Epoch: 32, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5386719703674316
Epoch: 33, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 188328
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.820068120956421
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 2.092 Vali Acc: 0.056 Test Loss: 2.092 Test Acc: 0.056
Validation loss decreased (inf --> -0.056229).  Saving model ...
Epoch: 2 cost time: 0.6071398258209229
Epoch: 2, Steps: 8 | Train Loss: 2.050 Vali Loss: 2.049 Vali Acc: 0.181 Test Loss: 2.049 Test Acc: 0.181
Validation loss decreased (-0.056229 --> -0.181230).  Saving model ...
Epoch: 3 cost time: 0.6239464282989502
Epoch: 3, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.969 Vali Acc: 0.444 Test Loss: 1.969 Test Acc: 0.444
Validation loss decreased (-0.181230 --> -0.443730).  Saving model ...
Epoch: 4 cost time: 0.6186230182647705
Epoch: 4, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.855 Vali Acc: 0.625 Test Loss: 1.855 Test Acc: 0.625
Validation loss decreased (-0.443730 --> -0.624981).  Saving model ...
Epoch: 5 cost time: 0.6705799102783203
Epoch: 5, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.719 Vali Acc: 0.706 Test Loss: 1.719 Test Acc: 0.706
Validation loss decreased (-0.624981 --> -0.706233).  Saving model ...
Epoch: 6 cost time: 0.6330881118774414
Epoch: 6, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.558 Vali Acc: 0.750 Test Loss: 1.558 Test Acc: 0.750
Validation loss decreased (-0.706233 --> -0.749984).  Saving model ...
Epoch: 7 cost time: 0.6162419319152832
Epoch: 7, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.381 Vali Acc: 0.775 Test Loss: 1.381 Test Acc: 0.775
Validation loss decreased (-0.749984 --> -0.774986).  Saving model ...
Epoch: 8 cost time: 0.6080737113952637
Epoch: 8, Steps: 8 | Train Loss: 1.254 Vali Loss: 1.195 Vali Acc: 0.791 Test Loss: 1.195 Test Acc: 0.791
Validation loss decreased (-0.774986 --> -0.790613).  Saving model ...
Epoch: 9 cost time: 0.6379456520080566
Epoch: 9, Steps: 8 | Train Loss: 1.059 Vali Loss: 1.013 Vali Acc: 0.803 Test Loss: 1.013 Test Acc: 0.803
Validation loss decreased (-0.790613 --> -0.803115).  Saving model ...
Epoch: 10 cost time: 0.5708863735198975
Epoch: 10, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.859 Vali Acc: 0.819 Test Loss: 0.859 Test Acc: 0.819
Validation loss decreased (-0.803115 --> -0.818741).  Saving model ...
Epoch: 11 cost time: 0.5681107044219971
Epoch: 11, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.732 Vali Acc: 0.828 Test Loss: 0.732 Test Acc: 0.828
Validation loss decreased (-0.818741 --> -0.828118).  Saving model ...
Epoch: 12 cost time: 0.6864132881164551
Epoch: 12, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.644 Vali Acc: 0.831 Test Loss: 0.644 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 0.6418564319610596
Epoch: 13, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 0.6087033748626709
Epoch: 14, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.5875589847564697
Epoch: 15, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.6328940391540527
Epoch: 16, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.5599334239959717
Epoch: 17, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 0.5491423606872559
Epoch: 18, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6409690380096436
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6290042400360107
Epoch: 20, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6875789165496826
Epoch: 21, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5672070980072021
Epoch: 22, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5926446914672852
Epoch: 23, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6630825996398926
Epoch: 24, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.610501766204834
Epoch: 25, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6291165351867676
Epoch: 26, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5422229766845703
Epoch: 27, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 185768
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8853623867034912
Epoch: 1, Steps: 8 | Train Loss: 2.082 Vali Loss: 2.064 Vali Acc: 0.169 Test Loss: 2.064 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 0.6322309970855713
Epoch: 2, Steps: 8 | Train Loss: 2.043 Vali Loss: 2.026 Vali Acc: 0.244 Test Loss: 2.026 Test Acc: 0.244
Validation loss decreased (-0.168729 --> -0.243730).  Saving model ...
Epoch: 3 cost time: 0.6679751873016357
Epoch: 3, Steps: 8 | Train Loss: 1.978 Vali Loss: 1.957 Vali Acc: 0.412 Test Loss: 1.957 Test Acc: 0.412
Validation loss decreased (-0.243730 --> -0.412480).  Saving model ...
Epoch: 4 cost time: 0.6146194934844971
Epoch: 4, Steps: 8 | Train Loss: 1.883 Vali Loss: 1.860 Vali Acc: 0.544 Test Loss: 1.860 Test Acc: 0.544
Validation loss decreased (-0.412480 --> -0.543731).  Saving model ...
Epoch: 5 cost time: 0.6129312515258789
Epoch: 5, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.740 Vali Acc: 0.662 Test Loss: 1.740 Test Acc: 0.662
Validation loss decreased (-0.543731 --> -0.662483).  Saving model ...
Epoch: 6 cost time: 0.5940110683441162
Epoch: 6, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.601 Vali Acc: 0.731 Test Loss: 1.601 Test Acc: 0.731
Validation loss decreased (-0.662483 --> -0.731234).  Saving model ...
Epoch: 7 cost time: 0.6142256259918213
Epoch: 7, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.451 Vali Acc: 0.759 Test Loss: 1.451 Test Acc: 0.759
Validation loss decreased (-0.731234 --> -0.759360).  Saving model ...
Epoch: 8 cost time: 0.548241376876831
Epoch: 8, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.296 Vali Acc: 0.784 Test Loss: 1.296 Test Acc: 0.784
Validation loss decreased (-0.759360 --> -0.784362).  Saving model ...
Epoch: 9 cost time: 0.5577123165130615
Epoch: 9, Steps: 8 | Train Loss: 1.162 Vali Loss: 1.138 Vali Acc: 0.797 Test Loss: 1.138 Test Acc: 0.797
Validation loss decreased (-0.784362 --> -0.796864).  Saving model ...
Epoch: 10 cost time: 0.6778700351715088
Epoch: 10, Steps: 8 | Train Loss: 1.005 Vali Loss: 0.990 Vali Acc: 0.812 Test Loss: 0.990 Test Acc: 0.812
Validation loss decreased (-0.796864 --> -0.812490).  Saving model ...
Epoch: 11 cost time: 0.6225295066833496
Epoch: 11, Steps: 8 | Train Loss: 0.866 Vali Loss: 0.859 Vali Acc: 0.806 Test Loss: 0.859 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7303714752197266
Epoch: 12, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.752 Vali Acc: 0.828 Test Loss: 0.752 Test Acc: 0.828
Validation loss decreased (-0.812490 --> -0.828117).  Saving model ...
Epoch: 13 cost time: 0.6433041095733643
Epoch: 13, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.666 Vali Acc: 0.838 Test Loss: 0.666 Test Acc: 0.838
Validation loss decreased (-0.828117 --> -0.837493).  Saving model ...
Epoch: 14 cost time: 0.5948083400726318
Epoch: 14, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
Validation loss decreased (-0.837493 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 0.6301407814025879
Epoch: 15, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.663520097732544
Epoch: 16, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6191248893737793
Epoch: 17, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6078188419342041
Epoch: 18, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6062371730804443
Epoch: 19, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 0.6328508853912354
Epoch: 20, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 21 cost time: 0.6120586395263672
Epoch: 21, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5914757251739502
Epoch: 22, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7117254734039307
Epoch: 23, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6148943901062012
Epoch: 24, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.449 Vali Acc: 0.844 Test Loss: 0.449 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5573625564575195
Epoch: 25, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.449 Vali Acc: 0.838 Test Loss: 0.449 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5712666511535645
Epoch: 26, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5847382545471191
Epoch: 27, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6456496715545654
Epoch: 28, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.452 Vali Acc: 0.844 Test Loss: 0.452 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6209745407104492
Epoch: 29, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6817886829376221
Epoch: 30, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.463 Vali Acc: 0.834 Test Loss: 0.463 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 183176
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.878828525543213
Epoch: 1, Steps: 8 | Train Loss: 2.056 Vali Loss: 2.072 Vali Acc: 0.131 Test Loss: 2.072 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.5987005233764648
Epoch: 2, Steps: 8 | Train Loss: 2.015 Vali Loss: 2.033 Vali Acc: 0.184 Test Loss: 2.033 Test Acc: 0.184
Validation loss decreased (-0.131229 --> -0.184355).  Saving model ...
Epoch: 3 cost time: 0.5750606060028076
Epoch: 3, Steps: 8 | Train Loss: 1.977 Vali Loss: 1.965 Vali Acc: 0.300 Test Loss: 1.965 Test Acc: 0.300
Validation loss decreased (-0.184355 --> -0.299980).  Saving model ...
Epoch: 4 cost time: 0.5930194854736328
Epoch: 4, Steps: 8 | Train Loss: 1.887 Vali Loss: 1.876 Vali Acc: 0.456 Test Loss: 1.876 Test Acc: 0.456
Validation loss decreased (-0.299980 --> -0.456231).  Saving model ...
Epoch: 5 cost time: 0.6924922466278076
Epoch: 5, Steps: 8 | Train Loss: 1.778 Vali Loss: 1.773 Vali Acc: 0.628 Test Loss: 1.773 Test Acc: 0.628
Validation loss decreased (-0.456231 --> -0.628107).  Saving model ...
Epoch: 6 cost time: 0.5569100379943848
Epoch: 6, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.658 Vali Acc: 0.706 Test Loss: 1.658 Test Acc: 0.706
Validation loss decreased (-0.628107 --> -0.706233).  Saving model ...
Epoch: 7 cost time: 0.6221532821655273
Epoch: 7, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.535 Vali Acc: 0.744 Test Loss: 1.535 Test Acc: 0.744
Validation loss decreased (-0.706233 --> -0.743735).  Saving model ...
Epoch: 8 cost time: 0.6251373291015625
Epoch: 8, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.401 Vali Acc: 0.766 Test Loss: 1.401 Test Acc: 0.766
Validation loss decreased (-0.743735 --> -0.765611).  Saving model ...
Epoch: 9 cost time: 0.6173491477966309
Epoch: 9, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.259 Vali Acc: 0.791 Test Loss: 1.259 Test Acc: 0.791
Validation loss decreased (-0.765611 --> -0.790612).  Saving model ...
Epoch: 10 cost time: 0.6230416297912598
Epoch: 10, Steps: 8 | Train Loss: 1.163 Vali Loss: 1.131 Vali Acc: 0.794 Test Loss: 1.131 Test Acc: 0.794
Validation loss decreased (-0.790612 --> -0.793739).  Saving model ...
Epoch: 11 cost time: 0.6486043930053711
Epoch: 11, Steps: 8 | Train Loss: 1.032 Vali Loss: 1.005 Vali Acc: 0.809 Test Loss: 1.005 Test Acc: 0.809
Validation loss decreased (-0.793739 --> -0.809365).  Saving model ...
Epoch: 12 cost time: 0.5782074928283691
Epoch: 12, Steps: 8 | Train Loss: 0.895 Vali Loss: 0.892 Vali Acc: 0.825 Test Loss: 0.892 Test Acc: 0.825
Validation loss decreased (-0.809365 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 0.5515701770782471
Epoch: 13, Steps: 8 | Train Loss: 0.788 Vali Loss: 0.798 Vali Acc: 0.844 Test Loss: 0.798 Test Acc: 0.844
Validation loss decreased (-0.824991 --> -0.843742).  Saving model ...
Epoch: 14 cost time: 0.5851595401763916
Epoch: 14, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.720 Vali Acc: 0.853 Test Loss: 0.720 Test Acc: 0.853
Validation loss decreased (-0.843742 --> -0.853118).  Saving model ...
Epoch: 15 cost time: 0.5423829555511475
Epoch: 15, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.656 Vali Acc: 0.853 Test Loss: 0.656 Test Acc: 0.853
Validation loss decreased (-0.853118 --> -0.853118).  Saving model ...
Epoch: 16 cost time: 0.5113620758056641
Epoch: 16, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
Validation loss decreased (-0.853118 --> -0.871869).  Saving model ...
Epoch: 17 cost time: 0.6097269058227539
Epoch: 17, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
Validation loss decreased (-0.871869 --> -0.871869).  Saving model ...
Epoch: 18 cost time: 0.6316072940826416
Epoch: 18, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.6724245548248291
Epoch: 19, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.510 Vali Acc: 0.869 Test Loss: 0.510 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5691680908203125
Epoch: 20, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6040694713592529
Epoch: 21, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.5838243961334229
Epoch: 22, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.5765054225921631
Epoch: 23, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.5713100433349609
Epoch: 24, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5774111747741699
Epoch: 25, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 0.5478308200836182
Epoch: 26, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 0.5632729530334473
Epoch: 27, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 0.6287930011749268
Epoch: 28, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
Validation loss decreased (-0.874996 --> -0.878121).  Saving model ...
Epoch: 29 cost time: 0.6055259704589844
Epoch: 29, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5569286346435547
Epoch: 30, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.421 Vali Acc: 0.872 Test Loss: 0.421 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6244015693664551
Epoch: 31, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.422 Vali Acc: 0.872 Test Loss: 0.422 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5453815460205078
Epoch: 32, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.423 Vali Acc: 0.869 Test Loss: 0.423 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5602741241455078
Epoch: 33, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.577855110168457
Epoch: 34, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.428 Vali Acc: 0.869 Test Loss: 0.428 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6024432182312012
Epoch: 35, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.430 Vali Acc: 0.869 Test Loss: 0.430 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5783567428588867
Epoch: 36, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.434 Vali Acc: 0.869 Test Loss: 0.434 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5686893463134766
Epoch: 37, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.47401881217956543
Epoch: 38, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.430 Vali Acc: 0.869 Test Loss: 0.430 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 180616
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7258985042572021
Epoch: 1, Steps: 8 | Train Loss: 2.039 Vali Loss: 2.028 Vali Acc: 0.328 Test Loss: 2.028 Test Acc: 0.328
Validation loss decreased (inf --> -0.328105).  Saving model ...
Epoch: 2 cost time: 0.627906084060669
Epoch: 2, Steps: 8 | Train Loss: 1.897 Vali Loss: 1.895 Vali Acc: 0.575 Test Loss: 1.895 Test Acc: 0.575
Validation loss decreased (-0.328105 --> -0.574981).  Saving model ...
Epoch: 3 cost time: 0.6398739814758301
Epoch: 3, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.663 Vali Acc: 0.709 Test Loss: 1.663 Test Acc: 0.709
Validation loss decreased (-0.574981 --> -0.709358).  Saving model ...
Epoch: 4 cost time: 0.5857326984405518
Epoch: 4, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.340 Vali Acc: 0.769 Test Loss: 1.340 Test Acc: 0.769
Validation loss decreased (-0.709358 --> -0.768737).  Saving model ...
Epoch: 5 cost time: 0.6318356990814209
Epoch: 5, Steps: 8 | Train Loss: 1.021 Vali Loss: 0.970 Vali Acc: 0.825 Test Loss: 0.970 Test Acc: 0.825
Validation loss decreased (-0.768737 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.6392462253570557
Epoch: 6, Steps: 8 | Train Loss: 0.737 Vali Loss: 0.688 Vali Acc: 0.812 Test Loss: 0.688 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5967679023742676
Epoch: 7, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
Validation loss decreased (-0.824990 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.6078145503997803
Epoch: 8, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
Validation loss decreased (-0.831245 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 0.5600972175598145
Epoch: 9, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.452 Vali Acc: 0.869 Test Loss: 0.452 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 10 cost time: 0.5830180644989014
Epoch: 10, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6227617263793945
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7072572708129883
Epoch: 12, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5339603424072266
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5313644409179688
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5407319068908691
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5951213836669922
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6855442523956299
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.615 Vali Acc: 0.834 Test Loss: 0.615 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5686259269714355
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.632 Vali Acc: 0.834 Test Loss: 0.632 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5980935096740723
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 230952
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8343122005462646
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 2.083 Vali Acc: 0.200 Test Loss: 2.083 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 0.5790274143218994
Epoch: 2, Steps: 8 | Train Loss: 1.991 Vali Loss: 2.006 Vali Acc: 0.287 Test Loss: 2.006 Test Acc: 0.287
Validation loss decreased (-0.199979 --> -0.287480).  Saving model ...
Epoch: 3 cost time: 0.5802850723266602
Epoch: 3, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.862 Vali Acc: 0.478 Test Loss: 1.862 Test Acc: 0.478
Validation loss decreased (-0.287480 --> -0.478106).  Saving model ...
Epoch: 4 cost time: 0.5247993469238281
Epoch: 4, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.656 Vali Acc: 0.713 Test Loss: 1.656 Test Acc: 0.713
Validation loss decreased (-0.478106 --> -0.712483).  Saving model ...
Epoch: 5 cost time: 0.5502660274505615
Epoch: 5, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.402 Vali Acc: 0.775 Test Loss: 1.402 Test Acc: 0.775
Validation loss decreased (-0.712483 --> -0.774986).  Saving model ...
Epoch: 6 cost time: 0.6006186008453369
Epoch: 6, Steps: 8 | Train Loss: 1.138 Vali Loss: 1.114 Vali Acc: 0.797 Test Loss: 1.114 Test Acc: 0.797
Validation loss decreased (-0.774986 --> -0.796864).  Saving model ...
Epoch: 7 cost time: 0.5538876056671143
Epoch: 7, Steps: 8 | Train Loss: 0.906 Vali Loss: 0.857 Vali Acc: 0.797 Test Loss: 0.857 Test Acc: 0.797
Validation loss decreased (-0.796864 --> -0.796866).  Saving model ...
Epoch: 8 cost time: 0.5640583038330078
Epoch: 8, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
Validation loss decreased (-0.796866 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.6160140037536621
Epoch: 9, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5730955600738525
Epoch: 10, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.5194454193115234
Epoch: 11, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
Validation loss decreased (-0.840620 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 0.5725038051605225
Epoch: 12, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5265672206878662
Epoch: 13, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5306975841522217
Epoch: 14, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5437502861022949
Epoch: 15, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5927159786224365
Epoch: 16, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5379905700683594
Epoch: 17, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5021286010742188
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6000833511352539
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5811464786529541
Epoch: 20, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5611283779144287
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 200488
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7632710933685303
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.066 Vali Acc: 0.116 Test Loss: 2.066 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.602977991104126
Epoch: 2, Steps: 8 | Train Loss: 2.036 Vali Loss: 2.009 Vali Acc: 0.225 Test Loss: 2.009 Test Acc: 0.225
Validation loss decreased (-0.115604 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 0.5917012691497803
Epoch: 3, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.910 Vali Acc: 0.509 Test Loss: 1.910 Test Acc: 0.509
Validation loss decreased (-0.224980 --> -0.509356).  Saving model ...
Epoch: 4 cost time: 0.676140308380127
Epoch: 4, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.768 Vali Acc: 0.688 Test Loss: 1.768 Test Acc: 0.688
Validation loss decreased (-0.509356 --> -0.687482).  Saving model ...
Epoch: 5 cost time: 0.5649440288543701
Epoch: 5, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.588 Vali Acc: 0.766 Test Loss: 1.588 Test Acc: 0.766
Validation loss decreased (-0.687482 --> -0.765609).  Saving model ...
Epoch: 6 cost time: 0.5556073188781738
Epoch: 6, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.372 Vali Acc: 0.781 Test Loss: 1.372 Test Acc: 0.781
Validation loss decreased (-0.765609 --> -0.781236).  Saving model ...
Epoch: 7 cost time: 0.6693038940429688
Epoch: 7, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.141 Vali Acc: 0.800 Test Loss: 1.141 Test Acc: 0.800
Validation loss decreased (-0.781236 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.584726095199585
Epoch: 8, Steps: 8 | Train Loss: 0.973 Vali Loss: 0.920 Vali Acc: 0.797 Test Loss: 0.920 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6017129421234131
Epoch: 9, Steps: 8 | Train Loss: 0.778 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
Validation loss decreased (-0.799989 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 0.5776476860046387
Epoch: 10, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
Validation loss decreased (-0.815618 --> -0.843744).  Saving model ...
Epoch: 11 cost time: 0.6476612091064453
Epoch: 11, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.536 Vali Acc: 0.853 Test Loss: 0.536 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.6496901512145996
Epoch: 12, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.6353104114532471
Epoch: 13, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5731320381164551
Epoch: 14, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6238963603973389
Epoch: 15, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.5536034107208252
Epoch: 16, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6838831901550293
Epoch: 17, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.454 Vali Acc: 0.838 Test Loss: 0.454 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6579737663269043
Epoch: 18, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5802063941955566
Epoch: 19, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.474 Vali Acc: 0.834 Test Loss: 0.474 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.645674467086792
Epoch: 20, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.487 Vali Acc: 0.828 Test Loss: 0.487 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7281365394592285
Epoch: 21, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5921130180358887
Epoch: 22, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5681524276733398
Epoch: 23, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6841123104095459
Epoch: 24, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.552227258682251
Epoch: 25, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 191528
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7979905605316162
Epoch: 1, Steps: 8 | Train Loss: 2.085 Vali Loss: 2.080 Vali Acc: 0.175 Test Loss: 2.080 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 0.605708122253418
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 2.032 Vali Acc: 0.237 Test Loss: 2.032 Test Acc: 0.237
Validation loss decreased (-0.174979 --> -0.237480).  Saving model ...
Epoch: 3 cost time: 0.6917951107025146
Epoch: 3, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.945 Vali Acc: 0.425 Test Loss: 1.945 Test Acc: 0.425
Validation loss decreased (-0.237480 --> -0.424981).  Saving model ...
Epoch: 4 cost time: 0.669680118560791
Epoch: 4, Steps: 8 | Train Loss: 1.831 Vali Loss: 1.826 Vali Acc: 0.659 Test Loss: 1.826 Test Acc: 0.659
Validation loss decreased (-0.424981 --> -0.659357).  Saving model ...
Epoch: 5 cost time: 0.586529016494751
Epoch: 5, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.680 Vali Acc: 0.762 Test Loss: 1.680 Test Acc: 0.762
Validation loss decreased (-0.659357 --> -0.762483).  Saving model ...
Epoch: 6 cost time: 0.6593635082244873
Epoch: 6, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.502 Vali Acc: 0.778 Test Loss: 1.502 Test Acc: 0.778
Validation loss decreased (-0.762483 --> -0.778110).  Saving model ...
Epoch: 7 cost time: 0.5780782699584961
Epoch: 7, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.311 Vali Acc: 0.794 Test Loss: 1.311 Test Acc: 0.794
Validation loss decreased (-0.778110 --> -0.793737).  Saving model ...
Epoch: 8 cost time: 0.6583225727081299
Epoch: 8, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.109 Vali Acc: 0.822 Test Loss: 1.109 Test Acc: 0.822
Validation loss decreased (-0.793737 --> -0.821864).  Saving model ...
Epoch: 9 cost time: 0.587674617767334
Epoch: 9, Steps: 8 | Train Loss: 0.957 Vali Loss: 0.922 Vali Acc: 0.834 Test Loss: 0.922 Test Acc: 0.834
Validation loss decreased (-0.821864 --> -0.834366).  Saving model ...
Epoch: 10 cost time: 0.604708194732666
Epoch: 10, Steps: 8 | Train Loss: 0.782 Vali Loss: 0.759 Vali Acc: 0.831 Test Loss: 0.759 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5913670063018799
Epoch: 11, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.643 Vali Acc: 0.831 Test Loss: 0.643 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6261403560638428
Epoch: 12, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
Validation loss decreased (-0.834366 --> -0.840619).  Saving model ...
Epoch: 13 cost time: 0.5801002979278564
Epoch: 13, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.6137607097625732
Epoch: 14, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.6504459381103516
Epoch: 15, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5913286209106445
Epoch: 16, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6527459621429443
Epoch: 17, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6019582748413086
Epoch: 18, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.445 Vali Acc: 0.853 Test Loss: 0.445 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5725610256195068
Epoch: 19, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5610675811767578
Epoch: 20, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5630664825439453
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.450 Vali Acc: 0.856 Test Loss: 0.450 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5629074573516846
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.543987512588501
Epoch: 23, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5528888702392578
Epoch: 24, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 185640
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7730145454406738
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 2.098 Vali Acc: 0.022 Test Loss: 2.098 Test Acc: 0.022
Validation loss decreased (inf --> -0.021854).  Saving model ...
Epoch: 2 cost time: 0.5677802562713623
Epoch: 2, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.057 Vali Acc: 0.103 Test Loss: 2.057 Test Acc: 0.103
Validation loss decreased (-0.021854 --> -0.103104).  Saving model ...
Epoch: 3 cost time: 0.585132360458374
Epoch: 3, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.973 Vali Acc: 0.325 Test Loss: 1.973 Test Acc: 0.325
Validation loss decreased (-0.103104 --> -0.324980).  Saving model ...
Epoch: 4 cost time: 0.6272978782653809
Epoch: 4, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.854 Vali Acc: 0.528 Test Loss: 1.854 Test Acc: 0.528
Validation loss decreased (-0.324980 --> -0.528106).  Saving model ...
Epoch: 5 cost time: 0.5757632255554199
Epoch: 5, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.706 Vali Acc: 0.709 Test Loss: 1.706 Test Acc: 0.709
Validation loss decreased (-0.528106 --> -0.709358).  Saving model ...
Epoch: 6 cost time: 0.5682573318481445
Epoch: 6, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.544 Vali Acc: 0.759 Test Loss: 1.544 Test Acc: 0.759
Validation loss decreased (-0.709358 --> -0.759360).  Saving model ...
Epoch: 7 cost time: 0.612065315246582
Epoch: 7, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.365 Vali Acc: 0.787 Test Loss: 1.365 Test Acc: 0.787
Validation loss decreased (-0.759360 --> -0.787486).  Saving model ...
Epoch: 8 cost time: 0.5905084609985352
Epoch: 8, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.182 Vali Acc: 0.803 Test Loss: 1.182 Test Acc: 0.803
Validation loss decreased (-0.787486 --> -0.803113).  Saving model ...
Epoch: 9 cost time: 0.5756347179412842
Epoch: 9, Steps: 8 | Train Loss: 1.051 Vali Loss: 1.010 Vali Acc: 0.812 Test Loss: 1.010 Test Acc: 0.812
Validation loss decreased (-0.803113 --> -0.812490).  Saving model ...
Epoch: 10 cost time: 0.6008467674255371
Epoch: 10, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.861 Vali Acc: 0.809 Test Loss: 0.861 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5725915431976318
Epoch: 11, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.733 Vali Acc: 0.834 Test Loss: 0.733 Test Acc: 0.834
Validation loss decreased (-0.812490 --> -0.834368).  Saving model ...
Epoch: 12 cost time: 0.5981144905090332
Epoch: 12, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 0.6038446426391602
Epoch: 13, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853119).  Saving model ...
Epoch: 14 cost time: 0.5633664131164551
Epoch: 14, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.613785982131958
Epoch: 15, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.5466313362121582
Epoch: 16, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6758995056152344
Epoch: 17, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6044981479644775
Epoch: 18, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.469 Vali Acc: 0.866 Test Loss: 0.469 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 0.624028205871582
Epoch: 19, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6862406730651855
Epoch: 20, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.469 Vali Acc: 0.859 Test Loss: 0.469 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.570091724395752
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.622887372970581
Epoch: 22, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6468241214752197
Epoch: 23, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5398802757263184
Epoch: 24, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5816047191619873
Epoch: 25, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6367785930633545
Epoch: 26, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6061856746673584
Epoch: 27, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6774015426635742
Epoch: 28, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 183080
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8446409702301025
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.087 Vali Acc: 0.097 Test Loss: 2.087 Test Acc: 0.097
Validation loss decreased (inf --> -0.096854).  Saving model ...
Epoch: 2 cost time: 0.5683834552764893
Epoch: 2, Steps: 8 | Train Loss: 2.054 Vali Loss: 2.046 Vali Acc: 0.197 Test Loss: 2.046 Test Acc: 0.197
Validation loss decreased (-0.096854 --> -0.196855).  Saving model ...
Epoch: 3 cost time: 0.603156566619873
Epoch: 3, Steps: 8 | Train Loss: 1.964 Vali Loss: 1.965 Vali Acc: 0.362 Test Loss: 1.965 Test Acc: 0.362
Validation loss decreased (-0.196855 --> -0.362480).  Saving model ...
Epoch: 4 cost time: 0.6552135944366455
Epoch: 4, Steps: 8 | Train Loss: 1.869 Vali Loss: 1.855 Vali Acc: 0.588 Test Loss: 1.855 Test Acc: 0.588
Validation loss decreased (-0.362480 --> -0.587481).  Saving model ...
Epoch: 5 cost time: 0.6218397617340088
Epoch: 5, Steps: 8 | Train Loss: 1.748 Vali Loss: 1.722 Vali Acc: 0.691 Test Loss: 1.722 Test Acc: 0.691
Validation loss decreased (-0.587481 --> -0.690608).  Saving model ...
Epoch: 6 cost time: 0.608177900314331
Epoch: 6, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.577 Vali Acc: 0.769 Test Loss: 1.577 Test Acc: 0.769
Validation loss decreased (-0.690608 --> -0.768734).  Saving model ...
Epoch: 7 cost time: 0.5443589687347412
Epoch: 7, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.426 Vali Acc: 0.791 Test Loss: 1.426 Test Acc: 0.791
Validation loss decreased (-0.768734 --> -0.790611).  Saving model ...
Epoch: 8 cost time: 0.5547518730163574
Epoch: 8, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.265 Vali Acc: 0.800 Test Loss: 1.265 Test Acc: 0.800
Validation loss decreased (-0.790611 --> -0.799987).  Saving model ...
Epoch: 9 cost time: 0.6141424179077148
Epoch: 9, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.099 Vali Acc: 0.809 Test Loss: 1.099 Test Acc: 0.809
Validation loss decreased (-0.799987 --> -0.809364).  Saving model ...
Epoch: 10 cost time: 0.609835147857666
Epoch: 10, Steps: 8 | Train Loss: 0.995 Vali Loss: 0.951 Vali Acc: 0.831 Test Loss: 0.951 Test Acc: 0.831
Validation loss decreased (-0.809364 --> -0.831240).  Saving model ...
Epoch: 11 cost time: 0.47420835494995117
Epoch: 11, Steps: 8 | Train Loss: 0.859 Vali Loss: 0.829 Vali Acc: 0.838 Test Loss: 0.829 Test Acc: 0.838
Validation loss decreased (-0.831240 --> -0.837492).  Saving model ...
Epoch: 12 cost time: 0.5155229568481445
Epoch: 12, Steps: 8 | Train Loss: 0.689 Vali Loss: 0.732 Vali Acc: 0.838 Test Loss: 0.732 Test Acc: 0.838
Validation loss decreased (-0.837492 --> -0.837493).  Saving model ...
Epoch: 13 cost time: 0.5036096572875977
Epoch: 13, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
Validation loss decreased (-0.837493 --> -0.840618).  Saving model ...
Epoch: 14 cost time: 0.5158426761627197
Epoch: 14, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 0.5671341419219971
Epoch: 15, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
Validation loss decreased (-0.843744 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 0.625338077545166
Epoch: 16, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 17 cost time: 0.5820772647857666
Epoch: 17, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.493 Vali Acc: 0.869 Test Loss: 0.493 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5761637687683105
Epoch: 18, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.480 Vali Acc: 0.863 Test Loss: 0.480 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6115520000457764
Epoch: 19, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6597890853881836
Epoch: 20, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.458 Vali Acc: 0.866 Test Loss: 0.458 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5700984001159668
Epoch: 21, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6308972835540771
Epoch: 22, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5870029926300049
Epoch: 23, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.614851713180542
Epoch: 24, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.439 Vali Acc: 0.866 Test Loss: 0.439 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.601024866104126
Epoch: 25, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.438 Vali Acc: 0.866 Test Loss: 0.438 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5927002429962158
Epoch: 26, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.439 Vali Acc: 0.869 Test Loss: 0.439 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 180488
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.880084753036499
Epoch: 1, Steps: 8 | Train Loss: 2.058 Vali Loss: 2.049 Vali Acc: 0.231 Test Loss: 2.049 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.5780525207519531
Epoch: 2, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.996 Vali Acc: 0.266 Test Loss: 1.996 Test Acc: 0.266
Validation loss decreased (-0.231230 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 0.5526552200317383
Epoch: 3, Steps: 8 | Train Loss: 1.936 Vali Loss: 1.915 Vali Acc: 0.353 Test Loss: 1.915 Test Acc: 0.353
Validation loss decreased (-0.265605 --> -0.353106).  Saving model ...
Epoch: 4 cost time: 0.6371808052062988
Epoch: 4, Steps: 8 | Train Loss: 1.850 Vali Loss: 1.815 Vali Acc: 0.463 Test Loss: 1.815 Test Acc: 0.463
Validation loss decreased (-0.353106 --> -0.462482).  Saving model ...
Epoch: 5 cost time: 0.615464448928833
Epoch: 5, Steps: 8 | Train Loss: 1.749 Vali Loss: 1.697 Vali Acc: 0.622 Test Loss: 1.697 Test Acc: 0.622
Validation loss decreased (-0.462482 --> -0.621858).  Saving model ...
Epoch: 6 cost time: 0.6136720180511475
Epoch: 6, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.573 Vali Acc: 0.722 Test Loss: 1.573 Test Acc: 0.722
Validation loss decreased (-0.621858 --> -0.721859).  Saving model ...
Epoch: 7 cost time: 0.6165275573730469
Epoch: 7, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.441 Vali Acc: 0.769 Test Loss: 1.441 Test Acc: 0.769
Validation loss decreased (-0.721859 --> -0.768736).  Saving model ...
Epoch: 8 cost time: 0.6033110618591309
Epoch: 8, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.316 Vali Acc: 0.787 Test Loss: 1.316 Test Acc: 0.787
Validation loss decreased (-0.768736 --> -0.787487).  Saving model ...
Epoch: 9 cost time: 0.5751204490661621
Epoch: 9, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.190 Vali Acc: 0.809 Test Loss: 1.190 Test Acc: 0.809
Validation loss decreased (-0.787487 --> -0.809363).  Saving model ...
Epoch: 10 cost time: 0.53944993019104
Epoch: 10, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.070 Vali Acc: 0.822 Test Loss: 1.070 Test Acc: 0.822
Validation loss decreased (-0.809363 --> -0.821864).  Saving model ...
Epoch: 11 cost time: 0.5359933376312256
Epoch: 11, Steps: 8 | Train Loss: 0.956 Vali Loss: 0.965 Vali Acc: 0.822 Test Loss: 0.965 Test Acc: 0.822
Validation loss decreased (-0.821864 --> -0.821865).  Saving model ...
Epoch: 12 cost time: 0.5488545894622803
Epoch: 12, Steps: 8 | Train Loss: 0.853 Vali Loss: 0.862 Vali Acc: 0.828 Test Loss: 0.862 Test Acc: 0.828
Validation loss decreased (-0.821865 --> -0.828116).  Saving model ...
Epoch: 13 cost time: 0.4935722351074219
Epoch: 13, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.777 Vali Acc: 0.828 Test Loss: 0.777 Test Acc: 0.828
Validation loss decreased (-0.828116 --> -0.828117).  Saving model ...
Epoch: 14 cost time: 0.6393351554870605
Epoch: 14, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.707 Vali Acc: 0.828 Test Loss: 0.707 Test Acc: 0.828
Validation loss decreased (-0.828117 --> -0.828118).  Saving model ...
Epoch: 15 cost time: 0.5031590461730957
Epoch: 15, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.646 Vali Acc: 0.831 Test Loss: 0.646 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 0.5220651626586914
Epoch: 16, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.599 Vali Acc: 0.831 Test Loss: 0.599 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 0.5601515769958496
Epoch: 17, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.559 Vali Acc: 0.834 Test Loss: 0.559 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 18 cost time: 0.591022253036499
Epoch: 18, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 19 cost time: 0.5898833274841309
Epoch: 19, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 20 cost time: 0.6025643348693848
Epoch: 20, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5415890216827393
Epoch: 21, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.481 Vali Acc: 0.834 Test Loss: 0.481 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 22 cost time: 0.6164271831512451
Epoch: 22, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 0.6503951549530029
Epoch: 23, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 0.5141391754150391
Epoch: 24, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.454 Vali Acc: 0.838 Test Loss: 0.454 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 25 cost time: 0.6264910697937012
Epoch: 25, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.453 Vali Acc: 0.834 Test Loss: 0.453 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5426042079925537
Epoch: 26, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843746).  Saving model ...
Epoch: 27 cost time: 0.5535836219787598
Epoch: 27, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
Validation loss decreased (-0.843746 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 0.5686631202697754
Epoch: 28, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.444 Vali Acc: 0.856 Test Loss: 0.444 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.856246).  Saving model ...
Epoch: 29 cost time: 0.5905756950378418
Epoch: 29, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.437 Vali Acc: 0.863 Test Loss: 0.437 Test Acc: 0.863
Validation loss decreased (-0.856246 --> -0.862496).  Saving model ...
Epoch: 30 cost time: 0.519446611404419
Epoch: 30, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.438 Vali Acc: 0.853 Test Loss: 0.438 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5419704914093018
Epoch: 31, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5966477394104004
Epoch: 32, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5807123184204102
Epoch: 33, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6040778160095215
Epoch: 34, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6415886878967285
Epoch: 35, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.444 Vali Acc: 0.863 Test Loss: 0.444 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6298141479492188
Epoch: 36, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5631272792816162
Epoch: 37, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5853559970855713
Epoch: 38, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5923805236816406
Epoch: 39, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 177928
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7333731651306152
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.928 Vali Acc: 0.475 Test Loss: 1.928 Test Acc: 0.475
Validation loss decreased (inf --> -0.474981).  Saving model ...
Epoch: 2 cost time: 0.6386644840240479
Epoch: 2, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.343 Vali Acc: 0.719 Test Loss: 1.343 Test Acc: 0.719
Validation loss decreased (-0.474981 --> -0.718737).  Saving model ...
Epoch: 3 cost time: 0.6025707721710205
Epoch: 3, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.737 Vali Acc: 0.834 Test Loss: 0.737 Test Acc: 0.834
Validation loss decreased (-0.718737 --> -0.834368).  Saving model ...
Epoch: 4 cost time: 0.5908870697021484
Epoch: 4, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5255410671234131
Epoch: 5, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
Validation loss decreased (-0.834368 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 0.5501031875610352
Epoch: 6, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6379551887512207
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.609 Vali Acc: 0.834 Test Loss: 0.609 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6117250919342041
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5257575511932373
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.782 Vali Acc: 0.828 Test Loss: 0.782 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5647716522216797
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.828 Test Loss: 0.843 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5590581893920898
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.834 Test Loss: 0.832 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6093649864196777
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.831 Test Loss: 0.835 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.675086259841919
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.834 Test Loss: 0.850 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6155881881713867
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.831 Test Loss: 0.858 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6295359134674072
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.831 Test Loss: 0.856 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 836232
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8080146312713623
Epoch: 1, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.943 Vali Acc: 0.438 Test Loss: 1.943 Test Acc: 0.438
Validation loss decreased (inf --> -0.437481).  Saving model ...
Epoch: 2 cost time: 0.6422536373138428
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.578 Vali Acc: 0.725 Test Loss: 1.578 Test Acc: 0.725
Validation loss decreased (-0.437481 --> -0.724984).  Saving model ...
Epoch: 3 cost time: 0.6136305332183838
Epoch: 3, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.049 Vali Acc: 0.791 Test Loss: 1.049 Test Acc: 0.791
Validation loss decreased (-0.724984 --> -0.790615).  Saving model ...
Epoch: 4 cost time: 0.6077258586883545
Epoch: 4, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.640 Vali Acc: 0.831 Test Loss: 0.640 Test Acc: 0.831
Validation loss decreased (-0.790615 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 0.6646201610565186
Epoch: 5, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.6063528060913086
Epoch: 6, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.569523811340332
Epoch: 7, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5906534194946289
Epoch: 8, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.5688035488128662
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.590 Vali Acc: 0.834 Test Loss: 0.590 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.67252516746521
Epoch: 10, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.831 Test Loss: 0.617 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5967507362365723
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.632 Vali Acc: 0.834 Test Loss: 0.632 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6561708450317383
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.838 Test Loss: 0.652 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6440274715423584
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.834 Test Loss: 0.670 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6005153656005859
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.834 Test Loss: 0.684 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6366469860076904
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.834 Test Loss: 0.705 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5640099048614502
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.834 Test Loss: 0.708 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.584326982498169
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.834 Test Loss: 0.718 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7184340953826904
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.834 Test Loss: 0.733 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 720520
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.789457082748413
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.036 Vali Acc: 0.275 Test Loss: 2.036 Test Acc: 0.275
Validation loss decreased (inf --> -0.274980).  Saving model ...
Epoch: 2 cost time: 0.550736665725708
Epoch: 2, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.782 Vali Acc: 0.684 Test Loss: 1.782 Test Acc: 0.684
Validation loss decreased (-0.274980 --> -0.684357).  Saving model ...
Epoch: 3 cost time: 0.5440883636474609
Epoch: 3, Steps: 8 | Train Loss: 1.435 Vali Loss: 1.374 Vali Acc: 0.816 Test Loss: 1.374 Test Acc: 0.816
Validation loss decreased (-0.684357 --> -0.815611).  Saving model ...
Epoch: 4 cost time: 0.5283441543579102
Epoch: 4, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.917 Vali Acc: 0.831 Test Loss: 0.917 Test Acc: 0.831
Validation loss decreased (-0.815611 --> -0.831241).  Saving model ...
Epoch: 5 cost time: 0.5405867099761963
Epoch: 5, Steps: 8 | Train Loss: 0.598 Vali Loss: 0.603 Vali Acc: 0.831 Test Loss: 0.603 Test Acc: 0.831
Validation loss decreased (-0.831241 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 0.5368986129760742
Epoch: 6, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.5305380821228027
Epoch: 7, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.448 Vali Acc: 0.869 Test Loss: 0.448 Test Acc: 0.869
Validation loss decreased (-0.834370 --> -0.868746).  Saving model ...
Epoch: 8 cost time: 0.5363903045654297
Epoch: 8, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5505504608154297
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5696132183074951
Epoch: 10, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5973069667816162
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6425244808197021
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5970332622528076
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6330695152282715
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6123428344726562
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.838 Test Loss: 0.591 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5737240314483643
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.838 Test Loss: 0.596 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6485433578491211
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 678536
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8222389221191406
Epoch: 1, Steps: 8 | Train Loss: 2.068 Vali Loss: 2.028 Vali Acc: 0.181 Test Loss: 2.028 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 0.6089920997619629
Epoch: 2, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.804 Vali Acc: 0.600 Test Loss: 1.804 Test Acc: 0.600
Validation loss decreased (-0.181230 --> -0.599982).  Saving model ...
Epoch: 3 cost time: 0.6851367950439453
Epoch: 3, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.449 Vali Acc: 0.775 Test Loss: 1.449 Test Acc: 0.775
Validation loss decreased (-0.599982 --> -0.774986).  Saving model ...
Epoch: 4 cost time: 0.5670955181121826
Epoch: 4, Steps: 8 | Train Loss: 1.107 Vali Loss: 1.045 Vali Acc: 0.819 Test Loss: 1.045 Test Acc: 0.819
Validation loss decreased (-0.774986 --> -0.818740).  Saving model ...
Epoch: 5 cost time: 0.5891289710998535
Epoch: 5, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.714 Vali Acc: 0.834 Test Loss: 0.714 Test Acc: 0.834
Validation loss decreased (-0.818740 --> -0.834368).  Saving model ...
Epoch: 6 cost time: 0.5223631858825684
Epoch: 6, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4668750762939453
Epoch: 7, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
Validation loss decreased (-0.834368 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.6384708881378174
Epoch: 8, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 9 cost time: 0.6291005611419678
Epoch: 9, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5588874816894531
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7020962238311768
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7068567276000977
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6375699043273926
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6441969871520996
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6798422336578369
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.834 Test Loss: 0.565 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6331131458282471
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6730303764343262
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.838 Test Loss: 0.595 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6861691474914551
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.599 Vali Acc: 0.838 Test Loss: 0.599 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 661128
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8558592796325684
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.067 Vali Acc: 0.219 Test Loss: 2.067 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 0.5331416130065918
Epoch: 2, Steps: 8 | Train Loss: 1.962 Vali Loss: 1.880 Vali Acc: 0.484 Test Loss: 1.880 Test Acc: 0.484
Validation loss decreased (-0.218729 --> -0.484356).  Saving model ...
Epoch: 3 cost time: 0.6537361145019531
Epoch: 3, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.582 Vali Acc: 0.775 Test Loss: 1.582 Test Acc: 0.775
Validation loss decreased (-0.484356 --> -0.774984).  Saving model ...
Epoch: 4 cost time: 0.6921169757843018
Epoch: 4, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.217 Vali Acc: 0.791 Test Loss: 1.217 Test Acc: 0.791
Validation loss decreased (-0.774984 --> -0.790613).  Saving model ...
Epoch: 5 cost time: 0.7967729568481445
Epoch: 5, Steps: 8 | Train Loss: 0.936 Vali Loss: 0.874 Vali Acc: 0.812 Test Loss: 0.874 Test Acc: 0.812
Validation loss decreased (-0.790613 --> -0.812491).  Saving model ...
Epoch: 6 cost time: 0.6736307144165039
Epoch: 6, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
Validation loss decreased (-0.812491 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.7018775939941406
Epoch: 7, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.8046309947967529
Epoch: 8, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 0.6173455715179443
Epoch: 9, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6904754638671875
Epoch: 10, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859371).  Saving model ...
Epoch: 11 cost time: 0.7414610385894775
Epoch: 11, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.808140754699707
Epoch: 12, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6978905200958252
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6679635047912598
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7050902843475342
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7077717781066895
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6770634651184082
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7269289493560791
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7307798862457275
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7667849063873291
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 644744
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.68756103515625
Epoch: 1, Steps: 8 | Train Loss: 2.053 Vali Loss: 2.006 Vali Acc: 0.234 Test Loss: 2.006 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.670100212097168
Epoch: 2, Steps: 8 | Train Loss: 1.906 Vali Loss: 1.844 Vali Acc: 0.500 Test Loss: 1.844 Test Acc: 0.500
Validation loss decreased (-0.234355 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 0.6985206604003906
Epoch: 3, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.592 Vali Acc: 0.703 Test Loss: 1.592 Test Acc: 0.703
Validation loss decreased (-0.499982 --> -0.703109).  Saving model ...
Epoch: 4 cost time: 0.7078249454498291
Epoch: 4, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.284 Vali Acc: 0.762 Test Loss: 1.284 Test Acc: 0.762
Validation loss decreased (-0.703109 --> -0.762487).  Saving model ...
Epoch: 5 cost time: 0.6555790901184082
Epoch: 5, Steps: 8 | Train Loss: 1.042 Vali Loss: 0.963 Vali Acc: 0.800 Test Loss: 0.963 Test Acc: 0.800
Validation loss decreased (-0.762487 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.6680469512939453
Epoch: 6, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.721 Vali Acc: 0.819 Test Loss: 0.721 Test Acc: 0.819
Validation loss decreased (-0.799990 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 0.7035601139068604
Epoch: 7, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 0.7496764659881592
Epoch: 8, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.494 Vali Acc: 0.831 Test Loss: 0.494 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.6396782398223877
Epoch: 9, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.444 Vali Acc: 0.853 Test Loss: 0.444 Test Acc: 0.853
Validation loss decreased (-0.831245 --> -0.853121).  Saving model ...
Epoch: 10 cost time: 0.5628621578216553
Epoch: 10, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6269741058349609
Epoch: 11, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.430 Vali Acc: 0.847 Test Loss: 0.430 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7029881477355957
Epoch: 12, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6604514122009277
Epoch: 13, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5253987312316895
Epoch: 14, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7054777145385742
Epoch: 15, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7154998779296875
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6731641292572021
Epoch: 17, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6744048595428467
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6857051849365234
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 634376
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6783950328826904
Epoch: 1, Steps: 8 | Train Loss: 2.074 Vali Loss: 2.029 Vali Acc: 0.206 Test Loss: 2.029 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 0.650484561920166
Epoch: 2, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.881 Vali Acc: 0.428 Test Loss: 1.881 Test Acc: 0.428
Validation loss decreased (-0.206230 --> -0.428106).  Saving model ...
Epoch: 3 cost time: 0.6422183513641357
Epoch: 3, Steps: 8 | Train Loss: 1.716 Vali Loss: 1.648 Vali Acc: 0.644 Test Loss: 1.648 Test Acc: 0.644
Validation loss decreased (-0.428106 --> -0.643734).  Saving model ...
Epoch: 4 cost time: 0.6149983406066895
Epoch: 4, Steps: 8 | Train Loss: 1.428 Vali Loss: 1.373 Vali Acc: 0.709 Test Loss: 1.373 Test Acc: 0.709
Validation loss decreased (-0.643734 --> -0.709361).  Saving model ...
Epoch: 5 cost time: 0.6561949253082275
Epoch: 5, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.090 Vali Acc: 0.762 Test Loss: 1.090 Test Acc: 0.762
Validation loss decreased (-0.709361 --> -0.762489).  Saving model ...
Epoch: 6 cost time: 0.6746914386749268
Epoch: 6, Steps: 8 | Train Loss: 0.872 Vali Loss: 0.857 Vali Acc: 0.791 Test Loss: 0.857 Test Acc: 0.791
Validation loss decreased (-0.762489 --> -0.790616).  Saving model ...
Epoch: 7 cost time: 0.6662166118621826
Epoch: 7, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
Validation loss decreased (-0.790616 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.6220710277557373
Epoch: 8, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.5002140998840332
Epoch: 9, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
Validation loss decreased (-0.815619 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.6183040142059326
Epoch: 10, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.465 Vali Acc: 0.866 Test Loss: 0.465 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 0.6277878284454346
Epoch: 11, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6247305870056152
Epoch: 12, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6037039756774902
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.436 Vali Acc: 0.847 Test Loss: 0.436 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6937777996063232
Epoch: 14, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.433 Vali Acc: 0.856 Test Loss: 0.433 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6886582374572754
Epoch: 15, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6938090324401855
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6320669651031494
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6765387058258057
Epoch: 18, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6707713603973389
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.659296989440918
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 630280
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.678720235824585
Epoch: 1, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.959 Vali Acc: 0.356 Test Loss: 1.959 Test Acc: 0.356
Validation loss decreased (inf --> -0.356230).  Saving model ...
Epoch: 2 cost time: 0.5943381786346436
Epoch: 2, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.664 Vali Acc: 0.666 Test Loss: 1.664 Test Acc: 0.666
Validation loss decreased (-0.356230 --> -0.665608).  Saving model ...
Epoch: 3 cost time: 0.5877182483673096
Epoch: 3, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.213 Vali Acc: 0.797 Test Loss: 1.213 Test Acc: 0.797
Validation loss decreased (-0.665608 --> -0.796863).  Saving model ...
Epoch: 4 cost time: 0.5124914646148682
Epoch: 4, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.786 Vali Acc: 0.803 Test Loss: 0.786 Test Acc: 0.803
Validation loss decreased (-0.796863 --> -0.803117).  Saving model ...
Epoch: 5 cost time: 0.5187022686004639
Epoch: 5, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.803117 --> -0.840619).  Saving model ...
Epoch: 6 cost time: 0.5773966312408447
Epoch: 6, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.613633394241333
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5695793628692627
Epoch: 8, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5538463592529297
Epoch: 9, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5739200115203857
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6517953872680664
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.648 Vali Acc: 0.819 Test Loss: 0.648 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6015353202819824
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6241443157196045
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6059908866882324
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6424212455749512
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.710 Vali Acc: 0.819 Test Loss: 0.710 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6508316993713379
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.819 Test Loss: 0.717 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 278856
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6951892375946045
Epoch: 1, Steps: 8 | Train Loss: 2.059 Vali Loss: 2.010 Vali Acc: 0.234 Test Loss: 2.010 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.5329515933990479
Epoch: 2, Steps: 8 | Train Loss: 1.840 Vali Loss: 1.829 Vali Acc: 0.616 Test Loss: 1.829 Test Acc: 0.616
Validation loss decreased (-0.234355 --> -0.615607).  Saving model ...
Epoch: 3 cost time: 0.5561046600341797
Epoch: 3, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.519 Vali Acc: 0.762 Test Loss: 1.519 Test Acc: 0.762
Validation loss decreased (-0.615607 --> -0.762485).  Saving model ...
Epoch: 4 cost time: 0.5404152870178223
Epoch: 4, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.121 Vali Acc: 0.784 Test Loss: 1.121 Test Acc: 0.784
Validation loss decreased (-0.762485 --> -0.784364).  Saving model ...
Epoch: 5 cost time: 0.6010420322418213
Epoch: 5, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.779 Vali Acc: 0.828 Test Loss: 0.779 Test Acc: 0.828
Validation loss decreased (-0.784364 --> -0.828117).  Saving model ...
Epoch: 6 cost time: 0.5205690860748291
Epoch: 6, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
Validation loss decreased (-0.828117 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.48950839042663574
Epoch: 7, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.5192174911499023
Epoch: 8, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.464 Vali Acc: 0.859 Test Loss: 0.464 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 0.5485992431640625
Epoch: 9, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5394899845123291
Epoch: 10, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5801687240600586
Epoch: 11, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5490202903747559
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5200827121734619
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5933773517608643
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5634100437164307
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5659565925598145
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6160750389099121
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.838 Test Loss: 0.591 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5036063194274902
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 221000
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6111152172088623
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 2.072 Vali Acc: 0.147 Test Loss: 2.072 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.5285179615020752
Epoch: 2, Steps: 8 | Train Loss: 1.964 Vali Loss: 1.940 Vali Acc: 0.406 Test Loss: 1.940 Test Acc: 0.406
Validation loss decreased (-0.146854 --> -0.406231).  Saving model ...
Epoch: 3 cost time: 0.5518472194671631
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.731 Vali Acc: 0.694 Test Loss: 1.731 Test Acc: 0.694
Validation loss decreased (-0.406231 --> -0.693733).  Saving model ...
Epoch: 4 cost time: 0.5599970817565918
Epoch: 4, Steps: 8 | Train Loss: 1.452 Vali Loss: 1.447 Vali Acc: 0.784 Test Loss: 1.447 Test Acc: 0.784
Validation loss decreased (-0.693733 --> -0.784361).  Saving model ...
Epoch: 5 cost time: 0.585660457611084
Epoch: 5, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.114 Vali Acc: 0.791 Test Loss: 1.114 Test Acc: 0.791
Validation loss decreased (-0.784361 --> -0.790614).  Saving model ...
Epoch: 6 cost time: 0.5895569324493408
Epoch: 6, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.812 Vali Acc: 0.809 Test Loss: 0.812 Test Acc: 0.809
Validation loss decreased (-0.790614 --> -0.809367).  Saving model ...
Epoch: 7 cost time: 0.5416960716247559
Epoch: 7, Steps: 8 | Train Loss: 0.614 Vali Loss: 0.615 Vali Acc: 0.816 Test Loss: 0.615 Test Acc: 0.816
Validation loss decreased (-0.809367 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 0.5291976928710938
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
Validation loss decreased (-0.815619 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.5673239231109619
Epoch: 9, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.5340166091918945
Epoch: 10, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.5717170238494873
Epoch: 11, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.5546727180480957
Epoch: 12, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5833220481872559
Epoch: 13, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5350499153137207
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.603905200958252
Epoch: 15, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4470188617706299
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5037579536437988
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5867033004760742
Epoch: 18, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5585732460021973
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5364482402801514
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.54219651222229
Epoch: 21, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 200008
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6792199611663818
Epoch: 1, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.994 Vali Acc: 0.278 Test Loss: 1.994 Test Acc: 0.278
Validation loss decreased (inf --> -0.278105).  Saving model ...
Epoch: 2 cost time: 0.5517315864562988
Epoch: 2, Steps: 8 | Train Loss: 1.881 Vali Loss: 1.866 Vali Acc: 0.450 Test Loss: 1.866 Test Acc: 0.450
Validation loss decreased (-0.278105 --> -0.449981).  Saving model ...
Epoch: 3 cost time: 0.5513300895690918
Epoch: 3, Steps: 8 | Train Loss: 1.674 Vali Loss: 1.659 Vali Acc: 0.688 Test Loss: 1.659 Test Acc: 0.688
Validation loss decreased (-0.449981 --> -0.687483).  Saving model ...
Epoch: 4 cost time: 0.5782673358917236
Epoch: 4, Steps: 8 | Train Loss: 1.426 Vali Loss: 1.392 Vali Acc: 0.762 Test Loss: 1.392 Test Acc: 0.762
Validation loss decreased (-0.687483 --> -0.762486).  Saving model ...
Epoch: 5 cost time: 0.5473344326019287
Epoch: 5, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.105 Vali Acc: 0.778 Test Loss: 1.105 Test Acc: 0.778
Validation loss decreased (-0.762486 --> -0.778114).  Saving model ...
Epoch: 6 cost time: 0.5562417507171631
Epoch: 6, Steps: 8 | Train Loss: 0.898 Vali Loss: 0.855 Vali Acc: 0.803 Test Loss: 0.855 Test Acc: 0.803
Validation loss decreased (-0.778114 --> -0.803116).  Saving model ...
Epoch: 7 cost time: 0.5796163082122803
Epoch: 7, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 0.5892558097839355
Epoch: 8, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.5438270568847656
Epoch: 9, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.5384945869445801
Epoch: 10, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5938427448272705
Epoch: 11, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.5857236385345459
Epoch: 12, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5881597995758057
Epoch: 13, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5229177474975586
Epoch: 14, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.5752062797546387
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5953245162963867
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5506136417388916
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5614557266235352
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.490 Vali Acc: 0.834 Test Loss: 0.490 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5254170894622803
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5902369022369385
Epoch: 20, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.541558027267456
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5702083110809326
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.49475526809692383
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6745831966400146
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 191304
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.742849349975586
Epoch: 1, Steps: 8 | Train Loss: 2.069 Vali Loss: 2.053 Vali Acc: 0.169 Test Loss: 2.053 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 0.5861227512359619
Epoch: 2, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.958 Vali Acc: 0.294 Test Loss: 1.958 Test Acc: 0.294
Validation loss decreased (-0.168729 --> -0.293730).  Saving model ...
Epoch: 3 cost time: 0.532005786895752
Epoch: 3, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.812 Vali Acc: 0.597 Test Loss: 1.812 Test Acc: 0.597
Validation loss decreased (-0.293730 --> -0.596857).  Saving model ...
Epoch: 4 cost time: 0.5638518333435059
Epoch: 4, Steps: 8 | Train Loss: 1.666 Vali Loss: 1.620 Vali Acc: 0.738 Test Loss: 1.620 Test Acc: 0.738
Validation loss decreased (-0.596857 --> -0.737484).  Saving model ...
Epoch: 5 cost time: 0.526538610458374
Epoch: 5, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.394 Vali Acc: 0.797 Test Loss: 1.394 Test Acc: 0.797
Validation loss decreased (-0.737484 --> -0.796861).  Saving model ...
Epoch: 6 cost time: 0.5874595642089844
Epoch: 6, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.160 Vali Acc: 0.812 Test Loss: 1.160 Test Acc: 0.812
Validation loss decreased (-0.796861 --> -0.812488).  Saving model ...
Epoch: 7 cost time: 0.5427117347717285
Epoch: 7, Steps: 8 | Train Loss: 0.946 Vali Loss: 0.935 Vali Acc: 0.819 Test Loss: 0.935 Test Acc: 0.819
Validation loss decreased (-0.812488 --> -0.818741).  Saving model ...
Epoch: 8 cost time: 0.5383889675140381
Epoch: 8, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.752 Vali Acc: 0.825 Test Loss: 0.752 Test Acc: 0.825
Validation loss decreased (-0.818741 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.5659744739532471
Epoch: 9, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
Validation loss decreased (-0.824992 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 0.6865072250366211
Epoch: 10, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.536576509475708
Epoch: 11, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 0.5536885261535645
Epoch: 12, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5956752300262451
Epoch: 13, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4819808006286621
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5566904544830322
Epoch: 15, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6021208763122559
Epoch: 16, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6183888912200928
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5671200752258301
Epoch: 18, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5442306995391846
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5546448230743408
Epoch: 20, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5066444873809814
Epoch: 21, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 183112
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.723027229309082
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.098 Vali Acc: 0.072 Test Loss: 2.098 Test Acc: 0.072
Validation loss decreased (inf --> -0.071854).  Saving model ...
Epoch: 2 cost time: 0.5088016986846924
Epoch: 2, Steps: 8 | Train Loss: 2.107 Vali Loss: 2.031 Vali Acc: 0.134 Test Loss: 2.031 Test Acc: 0.134
Validation loss decreased (-0.071854 --> -0.134355).  Saving model ...
Epoch: 3 cost time: 0.5158090591430664
Epoch: 3, Steps: 8 | Train Loss: 1.962 Vali Loss: 1.912 Vali Acc: 0.291 Test Loss: 1.912 Test Acc: 0.291
Validation loss decreased (-0.134355 --> -0.290606).  Saving model ...
Epoch: 4 cost time: 0.5341622829437256
Epoch: 4, Steps: 8 | Train Loss: 1.817 Vali Loss: 1.756 Vali Acc: 0.631 Test Loss: 1.756 Test Acc: 0.631
Validation loss decreased (-0.290606 --> -0.631232).  Saving model ...
Epoch: 5 cost time: 0.5635168552398682
Epoch: 5, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.573 Vali Acc: 0.775 Test Loss: 1.573 Test Acc: 0.775
Validation loss decreased (-0.631232 --> -0.774984).  Saving model ...
Epoch: 6 cost time: 0.4881114959716797
Epoch: 6, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.367 Vali Acc: 0.787 Test Loss: 1.367 Test Acc: 0.787
Validation loss decreased (-0.774984 --> -0.787486).  Saving model ...
Epoch: 7 cost time: 0.5409867763519287
Epoch: 7, Steps: 8 | Train Loss: 1.207 Vali Loss: 1.155 Vali Acc: 0.791 Test Loss: 1.155 Test Acc: 0.791
Validation loss decreased (-0.787486 --> -0.790613).  Saving model ...
Epoch: 8 cost time: 0.5286350250244141
Epoch: 8, Steps: 8 | Train Loss: 1.009 Vali Loss: 0.957 Vali Acc: 0.797 Test Loss: 0.957 Test Acc: 0.797
Validation loss decreased (-0.790613 --> -0.796865).  Saving model ...
Epoch: 9 cost time: 0.5565428733825684
Epoch: 9, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.796865 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.5358960628509521
Epoch: 10, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 0.4955108165740967
Epoch: 11, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
Validation loss decreased (-0.809368 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 0.6001453399658203
Epoch: 12, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.5292623043060303
Epoch: 13, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.5360965728759766
Epoch: 14, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.471 Vali Acc: 0.828 Test Loss: 0.471 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5572259426116943
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.450 Vali Acc: 0.844 Test Loss: 0.450 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4911534786224365
Epoch: 16, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5616326332092285
Epoch: 17, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.435 Vali Acc: 0.859 Test Loss: 0.435 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859371).  Saving model ...
Epoch: 18 cost time: 0.5769364833831787
Epoch: 18, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.437 Vali Acc: 0.856 Test Loss: 0.437 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5285129547119141
Epoch: 19, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.437 Vali Acc: 0.847 Test Loss: 0.437 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5826907157897949
Epoch: 20, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.437 Vali Acc: 0.853 Test Loss: 0.437 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5436155796051025
Epoch: 21, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5706331729888916
Epoch: 22, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4926769733428955
Epoch: 23, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.445 Vali Acc: 0.859 Test Loss: 0.445 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5763273239135742
Epoch: 24, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.44676804542541504
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5164196491241455
Epoch: 26, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.43958449363708496
Epoch: 27, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 177928
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5211286544799805
Epoch: 1, Steps: 8 | Train Loss: 2.020 Vali Loss: 2.020 Vali Acc: 0.266 Test Loss: 2.020 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 0.5884299278259277
Epoch: 2, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.949 Vali Acc: 0.403 Test Loss: 1.949 Test Acc: 0.403
Validation loss decreased (-0.265605 --> -0.403106).  Saving model ...
Epoch: 3 cost time: 0.5041935443878174
Epoch: 3, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.837 Vali Acc: 0.566 Test Loss: 1.837 Test Acc: 0.566
Validation loss decreased (-0.403106 --> -0.565607).  Saving model ...
Epoch: 4 cost time: 0.6389081478118896
Epoch: 4, Steps: 8 | Train Loss: 1.725 Vali Loss: 1.695 Vali Acc: 0.675 Test Loss: 1.695 Test Acc: 0.675
Validation loss decreased (-0.565607 --> -0.674983).  Saving model ...
Epoch: 5 cost time: 0.43407106399536133
Epoch: 5, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.529 Vali Acc: 0.734 Test Loss: 1.529 Test Acc: 0.734
Validation loss decreased (-0.674983 --> -0.734360).  Saving model ...
Epoch: 6 cost time: 0.5945932865142822
Epoch: 6, Steps: 8 | Train Loss: 1.376 Vali Loss: 1.362 Vali Acc: 0.766 Test Loss: 1.362 Test Acc: 0.766
Validation loss decreased (-0.734360 --> -0.765611).  Saving model ...
Epoch: 7 cost time: 0.5034658908843994
Epoch: 7, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.187 Vali Acc: 0.778 Test Loss: 1.187 Test Acc: 0.778
Validation loss decreased (-0.765611 --> -0.778113).  Saving model ...
Epoch: 8 cost time: 0.5342621803283691
Epoch: 8, Steps: 8 | Train Loss: 1.049 Vali Loss: 1.017 Vali Acc: 0.794 Test Loss: 1.017 Test Acc: 0.794
Validation loss decreased (-0.778113 --> -0.793740).  Saving model ...
Epoch: 9 cost time: 0.49215102195739746
Epoch: 9, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.875 Vali Acc: 0.806 Test Loss: 0.875 Test Acc: 0.806
Validation loss decreased (-0.793740 --> -0.806241).  Saving model ...
Epoch: 10 cost time: 0.5876190662384033
Epoch: 10, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.758 Vali Acc: 0.822 Test Loss: 0.758 Test Acc: 0.822
Validation loss decreased (-0.806241 --> -0.821867).  Saving model ...
Epoch: 11 cost time: 0.5096771717071533
Epoch: 11, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.672 Vali Acc: 0.831 Test Loss: 0.672 Test Acc: 0.831
Validation loss decreased (-0.821867 --> -0.831243).  Saving model ...
Epoch: 12 cost time: 0.5297086238861084
Epoch: 12, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
Validation loss decreased (-0.831243 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 0.540593147277832
Epoch: 13, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.573500394821167
Epoch: 14, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.5087029933929443
Epoch: 15, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.575063943862915
Epoch: 16, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.5095596313476562
Epoch: 17, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 0.5445425510406494
Epoch: 18, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4900643825531006
Epoch: 19, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853121).  Saving model ...
Epoch: 20 cost time: 0.5118224620819092
Epoch: 20, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.444 Vali Acc: 0.869 Test Loss: 0.444 Test Acc: 0.869
Validation loss decreased (-0.853121 --> -0.868746).  Saving model ...
Epoch: 21 cost time: 0.564002513885498
Epoch: 21, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.436 Vali Acc: 0.859 Test Loss: 0.436 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5085983276367188
Epoch: 22, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.434 Vali Acc: 0.853 Test Loss: 0.434 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5838565826416016
Epoch: 23, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5029296875
Epoch: 24, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.434 Vali Acc: 0.853 Test Loss: 0.434 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5091350078582764
Epoch: 25, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.434 Vali Acc: 0.853 Test Loss: 0.434 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5624125003814697
Epoch: 26, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.440 Vali Acc: 0.853 Test Loss: 0.440 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5780127048492432
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.437 Vali Acc: 0.859 Test Loss: 0.437 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.516427755355835
Epoch: 28, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.436 Vali Acc: 0.859 Test Loss: 0.436 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5350956916809082
Epoch: 29, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.436 Vali Acc: 0.859 Test Loss: 0.436 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5863063335418701
Epoch: 30, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 175880
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6494665145874023
Epoch: 1, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.995 Vali Acc: 0.216 Test Loss: 1.995 Test Acc: 0.216
Validation loss decreased (inf --> -0.215605).  Saving model ...
Epoch: 2 cost time: 0.4644346237182617
Epoch: 2, Steps: 8 | Train Loss: 1.894 Vali Loss: 1.811 Vali Acc: 0.575 Test Loss: 1.811 Test Acc: 0.575
Validation loss decreased (-0.215605 --> -0.574982).  Saving model ...
Epoch: 3 cost time: 0.5229182243347168
Epoch: 3, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.539 Vali Acc: 0.722 Test Loss: 1.539 Test Acc: 0.722
Validation loss decreased (-0.574982 --> -0.721860).  Saving model ...
Epoch: 4 cost time: 0.5155806541442871
Epoch: 4, Steps: 8 | Train Loss: 1.231 Vali Loss: 1.205 Vali Acc: 0.794 Test Loss: 1.205 Test Acc: 0.794
Validation loss decreased (-0.721860 --> -0.793738).  Saving model ...
Epoch: 5 cost time: 0.545806884765625
Epoch: 5, Steps: 8 | Train Loss: 0.884 Vali Loss: 0.889 Vali Acc: 0.806 Test Loss: 0.889 Test Acc: 0.806
Validation loss decreased (-0.793738 --> -0.806241).  Saving model ...
Epoch: 6 cost time: 0.5168850421905518
Epoch: 6, Steps: 8 | Train Loss: 0.657 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.806241 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.5710501670837402
Epoch: 7, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.5379159450531006
Epoch: 8, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.5483403205871582
Epoch: 9, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.5394313335418701
Epoch: 10, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5278856754302979
Epoch: 11, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5470430850982666
Epoch: 12, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5124444961547852
Epoch: 13, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4922676086425781
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4751722812652588
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5067794322967529
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5336642265319824
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4811837673187256
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5209381580352783
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.825 Test Loss: 0.612 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 104616
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5860035419464111
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 2.061 Vali Acc: 0.194 Test Loss: 2.061 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.5505266189575195
Epoch: 2, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.968 Vali Acc: 0.312 Test Loss: 1.968 Test Acc: 0.312
Validation loss decreased (-0.193729 --> -0.312480).  Saving model ...
Epoch: 3 cost time: 0.5510189533233643
Epoch: 3, Steps: 8 | Train Loss: 1.845 Vali Loss: 1.809 Vali Acc: 0.566 Test Loss: 1.809 Test Acc: 0.566
Validation loss decreased (-0.312480 --> -0.565607).  Saving model ...
Epoch: 4 cost time: 0.4737813472747803
Epoch: 4, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.592 Vali Acc: 0.734 Test Loss: 1.592 Test Acc: 0.734
Validation loss decreased (-0.565607 --> -0.734359).  Saving model ...
Epoch: 5 cost time: 0.5421407222747803
Epoch: 5, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.336 Vali Acc: 0.781 Test Loss: 1.336 Test Acc: 0.781
Validation loss decreased (-0.734359 --> -0.781237).  Saving model ...
Epoch: 6 cost time: 0.4266664981842041
Epoch: 6, Steps: 8 | Train Loss: 1.122 Vali Loss: 1.077 Vali Acc: 0.809 Test Loss: 1.077 Test Acc: 0.809
Validation loss decreased (-0.781237 --> -0.809364).  Saving model ...
Epoch: 7 cost time: 0.5473926067352295
Epoch: 7, Steps: 8 | Train Loss: 0.876 Vali Loss: 0.853 Vali Acc: 0.816 Test Loss: 0.853 Test Acc: 0.816
Validation loss decreased (-0.809364 --> -0.815616).  Saving model ...
Epoch: 8 cost time: 0.5488910675048828
Epoch: 8, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.680 Vali Acc: 0.819 Test Loss: 0.680 Test Acc: 0.819
Validation loss decreased (-0.815616 --> -0.818743).  Saving model ...
Epoch: 9 cost time: 0.51877760887146
Epoch: 9, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5013144016265869
Epoch: 10, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
Validation loss decreased (-0.828119 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.5531537532806396
Epoch: 11, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.539940595626831
Epoch: 12, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5488672256469727
Epoch: 13, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5355532169342041
Epoch: 14, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6000020503997803
Epoch: 15, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6129050254821777
Epoch: 16, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5875537395477295
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5284891128540039
Epoch: 18, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5846357345581055
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5731055736541748
Epoch: 20, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 75688
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7606942653656006
Epoch: 1, Steps: 8 | Train Loss: 2.162 Vali Loss: 2.088 Vali Acc: 0.175 Test Loss: 2.088 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 0.5746912956237793
Epoch: 2, Steps: 8 | Train Loss: 2.080 Vali Loss: 2.027 Vali Acc: 0.219 Test Loss: 2.027 Test Acc: 0.219
Validation loss decreased (-0.174979 --> -0.218730).  Saving model ...
Epoch: 3 cost time: 0.5326988697052002
Epoch: 3, Steps: 8 | Train Loss: 1.972 Vali Loss: 1.921 Vali Acc: 0.388 Test Loss: 1.921 Test Acc: 0.388
Validation loss decreased (-0.218730 --> -0.387481).  Saving model ...
Epoch: 4 cost time: 0.5510039329528809
Epoch: 4, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.775 Vali Acc: 0.625 Test Loss: 1.775 Test Acc: 0.625
Validation loss decreased (-0.387481 --> -0.624982).  Saving model ...
Epoch: 5 cost time: 0.5076069831848145
Epoch: 5, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.586 Vali Acc: 0.734 Test Loss: 1.586 Test Acc: 0.734
Validation loss decreased (-0.624982 --> -0.734359).  Saving model ...
Epoch: 6 cost time: 0.5240986347198486
Epoch: 6, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.375 Vali Acc: 0.794 Test Loss: 1.375 Test Acc: 0.794
Validation loss decreased (-0.734359 --> -0.793736).  Saving model ...
Epoch: 7 cost time: 0.5332398414611816
Epoch: 7, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.153 Vali Acc: 0.812 Test Loss: 1.153 Test Acc: 0.812
Validation loss decreased (-0.793736 --> -0.812488).  Saving model ...
Epoch: 8 cost time: 0.5536594390869141
Epoch: 8, Steps: 8 | Train Loss: 0.952 Vali Loss: 0.940 Vali Acc: 0.831 Test Loss: 0.940 Test Acc: 0.831
Validation loss decreased (-0.812488 --> -0.831241).  Saving model ...
Epoch: 9 cost time: 0.5440754890441895
Epoch: 9, Steps: 8 | Train Loss: 0.785 Vali Loss: 0.761 Vali Acc: 0.838 Test Loss: 0.761 Test Acc: 0.838
Validation loss decreased (-0.831241 --> -0.837492).  Saving model ...
Epoch: 10 cost time: 0.5285711288452148
Epoch: 10, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.636 Vali Acc: 0.847 Test Loss: 0.636 Test Acc: 0.847
Validation loss decreased (-0.837492 --> -0.846869).  Saving model ...
Epoch: 11 cost time: 0.5790455341339111
Epoch: 11, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5466961860656738
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
Validation loss decreased (-0.846869 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 0.5240533351898193
Epoch: 13, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.476 Vali Acc: 0.869 Test Loss: 0.476 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 14 cost time: 0.4933953285217285
Epoch: 14, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 15 cost time: 0.4732484817504883
Epoch: 15, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.456 Vali Acc: 0.853 Test Loss: 0.456 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5564634799957275
Epoch: 16, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4958500862121582
Epoch: 17, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5688862800598145
Epoch: 18, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.564556360244751
Epoch: 19, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.556208610534668
Epoch: 20, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5326242446899414
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.586477518081665
Epoch: 22, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5436677932739258
Epoch: 23, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5514159202575684
Epoch: 24, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 65192
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.660614013671875
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.096 Vali Acc: 0.122 Test Loss: 2.096 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.5538330078125
Epoch: 2, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.055 Vali Acc: 0.197 Test Loss: 2.055 Test Acc: 0.197
Validation loss decreased (-0.121854 --> -0.196854).  Saving model ...
Epoch: 3 cost time: 0.4735424518585205
Epoch: 3, Steps: 8 | Train Loss: 2.022 Vali Loss: 1.979 Vali Acc: 0.362 Test Loss: 1.979 Test Acc: 0.362
Validation loss decreased (-0.196854 --> -0.362480).  Saving model ...
Epoch: 4 cost time: 0.46074533462524414
Epoch: 4, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.870 Vali Acc: 0.525 Test Loss: 1.870 Test Acc: 0.525
Validation loss decreased (-0.362480 --> -0.524981).  Saving model ...
Epoch: 5 cost time: 0.5474205017089844
Epoch: 5, Steps: 8 | Train Loss: 1.790 Vali Loss: 1.730 Vali Acc: 0.647 Test Loss: 1.730 Test Acc: 0.647
Validation loss decreased (-0.524981 --> -0.646858).  Saving model ...
Epoch: 6 cost time: 0.549020528793335
Epoch: 6, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.571 Vali Acc: 0.728 Test Loss: 1.571 Test Acc: 0.728
Validation loss decreased (-0.646858 --> -0.728109).  Saving model ...
Epoch: 7 cost time: 0.5264098644256592
Epoch: 7, Steps: 8 | Train Loss: 1.435 Vali Loss: 1.394 Vali Acc: 0.787 Test Loss: 1.394 Test Acc: 0.787
Validation loss decreased (-0.728109 --> -0.787486).  Saving model ...
Epoch: 8 cost time: 0.4826068878173828
Epoch: 8, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.205 Vali Acc: 0.800 Test Loss: 1.205 Test Acc: 0.800
Validation loss decreased (-0.787486 --> -0.799988).  Saving model ...
Epoch: 9 cost time: 0.5624134540557861
Epoch: 9, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.019 Vali Acc: 0.806 Test Loss: 1.019 Test Acc: 0.806
Validation loss decreased (-0.799988 --> -0.806240).  Saving model ...
Epoch: 10 cost time: 0.5203373432159424
Epoch: 10, Steps: 8 | Train Loss: 0.827 Vali Loss: 0.857 Vali Acc: 0.803 Test Loss: 0.857 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.557121992111206
Epoch: 11, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
Validation loss decreased (-0.806240 --> -0.806243).  Saving model ...
Epoch: 12 cost time: 0.5633823871612549
Epoch: 12, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 13 cost time: 0.5361843109130859
Epoch: 13, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 0.5133941173553467
Epoch: 14, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.5207655429840088
Epoch: 15, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.5061821937561035
Epoch: 16, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 0.5423815250396729
Epoch: 17, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 0.49237704277038574
Epoch: 18, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.5079615116119385
Epoch: 19, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 0.5355725288391113
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 21 cost time: 0.5415990352630615
Epoch: 21, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 22 cost time: 0.5372884273529053
Epoch: 22, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5661120414733887
Epoch: 23, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.582343578338623
Epoch: 24, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5575752258300781
Epoch: 25, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.462 Vali Acc: 0.838 Test Loss: 0.462 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5726110935211182
Epoch: 26, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.557086706161499
Epoch: 27, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5576901435852051
Epoch: 28, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5347354412078857
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5487806797027588
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5428364276885986
Epoch: 31, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 60840
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9561736583709717
Epoch: 1, Steps: 8 | Train Loss: 2.036 Vali Loss: 2.037 Vali Acc: 0.222 Test Loss: 2.037 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 0.5530643463134766
Epoch: 2, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.986 Vali Acc: 0.300 Test Loss: 1.986 Test Acc: 0.300
Validation loss decreased (-0.221855 --> -0.299980).  Saving model ...
Epoch: 3 cost time: 0.4999685287475586
Epoch: 3, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.907 Vali Acc: 0.394 Test Loss: 1.907 Test Acc: 0.394
Validation loss decreased (-0.299980 --> -0.393731).  Saving model ...
Epoch: 4 cost time: 0.5265367031097412
Epoch: 4, Steps: 8 | Train Loss: 1.824 Vali Loss: 1.805 Vali Acc: 0.566 Test Loss: 1.805 Test Acc: 0.566
Validation loss decreased (-0.393731 --> -0.565607).  Saving model ...
Epoch: 5 cost time: 0.5242323875427246
Epoch: 5, Steps: 8 | Train Loss: 1.701 Vali Loss: 1.687 Vali Acc: 0.647 Test Loss: 1.687 Test Acc: 0.647
Validation loss decreased (-0.565607 --> -0.646858).  Saving model ...
Epoch: 6 cost time: 0.5193676948547363
Epoch: 6, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.550 Vali Acc: 0.716 Test Loss: 1.550 Test Acc: 0.716
Validation loss decreased (-0.646858 --> -0.715610).  Saving model ...
Epoch: 7 cost time: 0.5394608974456787
Epoch: 7, Steps: 8 | Train Loss: 1.440 Vali Loss: 1.401 Vali Acc: 0.753 Test Loss: 1.401 Test Acc: 0.753
Validation loss decreased (-0.715610 --> -0.753111).  Saving model ...
Epoch: 8 cost time: 0.48095703125
Epoch: 8, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.238 Vali Acc: 0.775 Test Loss: 1.238 Test Acc: 0.775
Validation loss decreased (-0.753111 --> -0.774988).  Saving model ...
Epoch: 9 cost time: 0.6110987663269043
Epoch: 9, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.079 Vali Acc: 0.797 Test Loss: 1.079 Test Acc: 0.797
Validation loss decreased (-0.774988 --> -0.796864).  Saving model ...
Epoch: 10 cost time: 0.5544428825378418
Epoch: 10, Steps: 8 | Train Loss: 0.965 Vali Loss: 0.936 Vali Acc: 0.816 Test Loss: 0.936 Test Acc: 0.816
Validation loss decreased (-0.796864 --> -0.815616).  Saving model ...
Epoch: 11 cost time: 0.5685732364654541
Epoch: 11, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.815 Vali Acc: 0.822 Test Loss: 0.815 Test Acc: 0.822
Validation loss decreased (-0.815616 --> -0.821867).  Saving model ...
Epoch: 12 cost time: 0.5670087337493896
Epoch: 12, Steps: 8 | Train Loss: 0.677 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
Validation loss decreased (-0.821867 --> -0.824993).  Saving model ...
Epoch: 13 cost time: 0.4936521053314209
Epoch: 13, Steps: 8 | Train Loss: 0.607 Vali Loss: 0.637 Vali Acc: 0.834 Test Loss: 0.637 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 0.542163610458374
Epoch: 14, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 0.5771934986114502
Epoch: 15, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 0.5572726726531982
Epoch: 16, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.5147089958190918
Epoch: 17, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 0.49084019660949707
Epoch: 18, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5013730525970459
Epoch: 19, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 0.4796762466430664
Epoch: 20, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5023949146270752
Epoch: 21, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.450 Vali Acc: 0.856 Test Loss: 0.450 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4502403736114502
Epoch: 22, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 23 cost time: 0.5344376564025879
Epoch: 23, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6151788234710693
Epoch: 24, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.440 Vali Acc: 0.863 Test Loss: 0.440 Test Acc: 0.863
Validation loss decreased (-0.862496 --> -0.862496).  Saving model ...
Epoch: 25 cost time: 0.49219179153442383
Epoch: 25, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5055899620056152
Epoch: 26, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4816403388977051
Epoch: 27, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.553638219833374
Epoch: 28, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5257968902587891
Epoch: 29, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5716745853424072
Epoch: 30, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6087222099304199
Epoch: 31, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5150210857391357
Epoch: 32, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5567913055419922
Epoch: 33, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4895195960998535
Epoch: 34, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 56744
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.744358777999878
Epoch: 1, Steps: 8 | Train Loss: 2.097 Vali Loss: 2.068 Vali Acc: 0.191 Test Loss: 2.068 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 0.5494601726531982
Epoch: 2, Steps: 8 | Train Loss: 2.046 Vali Loss: 2.035 Vali Acc: 0.247 Test Loss: 2.035 Test Acc: 0.247
Validation loss decreased (-0.190604 --> -0.246855).  Saving model ...
Epoch: 3 cost time: 0.525810718536377
Epoch: 3, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.980 Vali Acc: 0.341 Test Loss: 1.980 Test Acc: 0.341
Validation loss decreased (-0.246855 --> -0.340605).  Saving model ...
Epoch: 4 cost time: 0.4667327404022217
Epoch: 4, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.908 Vali Acc: 0.416 Test Loss: 1.908 Test Acc: 0.416
Validation loss decreased (-0.340605 --> -0.415606).  Saving model ...
Epoch: 5 cost time: 0.49664902687072754
Epoch: 5, Steps: 8 | Train Loss: 1.837 Vali Loss: 1.820 Vali Acc: 0.531 Test Loss: 1.820 Test Acc: 0.531
Validation loss decreased (-0.415606 --> -0.531232).  Saving model ...
Epoch: 6 cost time: 0.5001735687255859
Epoch: 6, Steps: 8 | Train Loss: 1.743 Vali Loss: 1.721 Vali Acc: 0.609 Test Loss: 1.721 Test Acc: 0.609
Validation loss decreased (-0.531232 --> -0.609358).  Saving model ...
Epoch: 7 cost time: 0.5135233402252197
Epoch: 7, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.614 Vali Acc: 0.659 Test Loss: 1.614 Test Acc: 0.659
Validation loss decreased (-0.609358 --> -0.659359).  Saving model ...
Epoch: 8 cost time: 0.48462986946105957
Epoch: 8, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.494 Vali Acc: 0.700 Test Loss: 1.494 Test Acc: 0.700
Validation loss decreased (-0.659359 --> -0.699985).  Saving model ...
Epoch: 9 cost time: 0.49413514137268066
Epoch: 9, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.367 Vali Acc: 0.741 Test Loss: 1.367 Test Acc: 0.741
Validation loss decreased (-0.699985 --> -0.740611).  Saving model ...
Epoch: 10 cost time: 0.5081000328063965
Epoch: 10, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.234 Vali Acc: 0.772 Test Loss: 1.234 Test Acc: 0.772
Validation loss decreased (-0.740611 --> -0.771863).  Saving model ...
Epoch: 11 cost time: 0.4466538429260254
Epoch: 11, Steps: 8 | Train Loss: 1.098 Vali Loss: 1.104 Vali Acc: 0.791 Test Loss: 1.104 Test Acc: 0.791
Validation loss decreased (-0.771863 --> -0.790614).  Saving model ...
Epoch: 12 cost time: 0.5917079448699951
Epoch: 12, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.978 Vali Acc: 0.809 Test Loss: 0.978 Test Acc: 0.809
Validation loss decreased (-0.790614 --> -0.809365).  Saving model ...
Epoch: 13 cost time: 0.5062618255615234
Epoch: 13, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.871 Vali Acc: 0.809 Test Loss: 0.871 Test Acc: 0.809
Validation loss decreased (-0.809365 --> -0.809366).  Saving model ...
Epoch: 14 cost time: 0.487518310546875
Epoch: 14, Steps: 8 | Train Loss: 0.735 Vali Loss: 0.780 Vali Acc: 0.822 Test Loss: 0.780 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821867).  Saving model ...
Epoch: 15 cost time: 0.4970989227294922
Epoch: 15, Steps: 8 | Train Loss: 0.614 Vali Loss: 0.709 Vali Acc: 0.831 Test Loss: 0.709 Test Acc: 0.831
Validation loss decreased (-0.821867 --> -0.831243).  Saving model ...
Epoch: 16 cost time: 0.48108434677124023
Epoch: 16, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
Validation loss decreased (-0.831243 --> -0.840618).  Saving model ...
Epoch: 17 cost time: 0.5171787738800049
Epoch: 17, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.607 Vali Acc: 0.838 Test Loss: 0.607 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5207319259643555
Epoch: 18, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.575 Vali Acc: 0.847 Test Loss: 0.575 Test Acc: 0.847
Validation loss decreased (-0.840618 --> -0.846869).  Saving model ...
Epoch: 19 cost time: 0.5459709167480469
Epoch: 19, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.846869 --> -0.856245).  Saving model ...
Epoch: 20 cost time: 0.6087110042572021
Epoch: 20, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5125360488891602
Epoch: 21, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5294735431671143
Epoch: 22, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.49458813667297363
Epoch: 23, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5377621650695801
Epoch: 24, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5200831890106201
Epoch: 25, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4621598720550537
Epoch: 26, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.48216724395751953
Epoch: 27, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5173053741455078
Epoch: 28, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4617757797241211
Epoch: 29, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 54152
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5640408992767334
Epoch: 1, Steps: 8 | Train Loss: 2.161 Vali Loss: 2.112 Vali Acc: 0.144 Test Loss: 2.112 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 0.4905867576599121
Epoch: 2, Steps: 8 | Train Loss: 2.111 Vali Loss: 2.081 Vali Acc: 0.184 Test Loss: 2.081 Test Acc: 0.184
Validation loss decreased (-0.143729 --> -0.184354).  Saving model ...
Epoch: 3 cost time: 0.4825441837310791
Epoch: 3, Steps: 8 | Train Loss: 2.037 Vali Loss: 2.026 Vali Acc: 0.247 Test Loss: 2.026 Test Acc: 0.247
Validation loss decreased (-0.184354 --> -0.246855).  Saving model ...
Epoch: 4 cost time: 0.5181732177734375
Epoch: 4, Steps: 8 | Train Loss: 1.996 Vali Loss: 1.952 Vali Acc: 0.350 Test Loss: 1.952 Test Acc: 0.350
Validation loss decreased (-0.246855 --> -0.349980).  Saving model ...
Epoch: 5 cost time: 0.48343873023986816
Epoch: 5, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.868 Vali Acc: 0.494 Test Loss: 1.868 Test Acc: 0.494
Validation loss decreased (-0.349980 --> -0.493731).  Saving model ...
Epoch: 6 cost time: 0.47652435302734375
Epoch: 6, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.776 Vali Acc: 0.572 Test Loss: 1.776 Test Acc: 0.572
Validation loss decreased (-0.493731 --> -0.571857).  Saving model ...
Epoch: 7 cost time: 0.4929068088531494
Epoch: 7, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.683 Vali Acc: 0.622 Test Loss: 1.683 Test Acc: 0.622
Validation loss decreased (-0.571857 --> -0.621858).  Saving model ...
Epoch: 8 cost time: 0.5131025314331055
Epoch: 8, Steps: 8 | Train Loss: 1.625 Vali Loss: 1.582 Vali Acc: 0.681 Test Loss: 1.582 Test Acc: 0.681
Validation loss decreased (-0.621858 --> -0.681234).  Saving model ...
Epoch: 9 cost time: 0.5002012252807617
Epoch: 9, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.476 Vali Acc: 0.731 Test Loss: 1.476 Test Acc: 0.731
Validation loss decreased (-0.681234 --> -0.731235).  Saving model ...
Epoch: 10 cost time: 0.5233502388000488
Epoch: 10, Steps: 8 | Train Loss: 1.376 Vali Loss: 1.367 Vali Acc: 0.756 Test Loss: 1.367 Test Acc: 0.756
Validation loss decreased (-0.731235 --> -0.756236).  Saving model ...
Epoch: 11 cost time: 0.48673272132873535
Epoch: 11, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.254 Vali Acc: 0.775 Test Loss: 1.254 Test Acc: 0.775
Validation loss decreased (-0.756236 --> -0.774987).  Saving model ...
Epoch: 12 cost time: 0.5321557521820068
Epoch: 12, Steps: 8 | Train Loss: 1.129 Vali Loss: 1.143 Vali Acc: 0.781 Test Loss: 1.143 Test Acc: 0.781
Validation loss decreased (-0.774987 --> -0.781239).  Saving model ...
Epoch: 13 cost time: 0.5527694225311279
Epoch: 13, Steps: 8 | Train Loss: 1.020 Vali Loss: 1.037 Vali Acc: 0.791 Test Loss: 1.037 Test Acc: 0.791
Validation loss decreased (-0.781239 --> -0.790615).  Saving model ...
Epoch: 14 cost time: 0.5180444717407227
Epoch: 14, Steps: 8 | Train Loss: 0.911 Vali Loss: 0.941 Vali Acc: 0.797 Test Loss: 0.941 Test Acc: 0.797
Validation loss decreased (-0.790615 --> -0.796866).  Saving model ...
Epoch: 15 cost time: 0.46749258041381836
Epoch: 15, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.856 Vali Acc: 0.806 Test Loss: 0.856 Test Acc: 0.806
Validation loss decreased (-0.796866 --> -0.806241).  Saving model ...
Epoch: 16 cost time: 0.48833513259887695
Epoch: 16, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.782 Vali Acc: 0.812 Test Loss: 0.782 Test Acc: 0.812
Validation loss decreased (-0.806241 --> -0.812492).  Saving model ...
Epoch: 17 cost time: 0.5304620265960693
Epoch: 17, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4716360569000244
Epoch: 18, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821868).  Saving model ...
Epoch: 19 cost time: 0.5153312683105469
Epoch: 19, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 20 cost time: 0.46936511993408203
Epoch: 20, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.594 Vali Acc: 0.838 Test Loss: 0.594 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 21 cost time: 0.46008801460266113
Epoch: 21, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4291114807128906
Epoch: 22, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.45316267013549805
Epoch: 23, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4551982879638672
Epoch: 24, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5023186206817627
Epoch: 25, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 26 cost time: 0.555321216583252
Epoch: 26, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 27 cost time: 0.4910421371459961
Epoch: 27, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.500739574432373
Epoch: 28, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 29 cost time: 0.513629674911499
Epoch: 29, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 30 cost time: 0.5212929248809814
Epoch: 30, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4637923240661621
Epoch: 31, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.457 Vali Acc: 0.853 Test Loss: 0.457 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5160458087921143
Epoch: 32, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.46778440475463867
Epoch: 33, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 34 cost time: 0.47260141372680664
Epoch: 34, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4770355224609375
Epoch: 35, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5031700134277344
Epoch: 36, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5643737316131592
Epoch: 37, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5798921585083008
Epoch: 38, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.443 Vali Acc: 0.866 Test Loss: 0.443 Test Acc: 0.866
Validation loss decreased (-0.859371 --> -0.865621).  Saving model ...
Epoch: 39 cost time: 0.5207281112670898
Epoch: 39, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5153310298919678
Epoch: 40, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4275217056274414
Epoch: 41, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4479396343231201
Epoch: 42, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.529801607131958
Epoch: 43, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.451 Vali Acc: 0.866 Test Loss: 0.451 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5564470291137695
Epoch: 44, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.452 Vali Acc: 0.853 Test Loss: 0.452 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.45503711700439453
Epoch: 45, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5067849159240723
Epoch: 46, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5380153656005859
Epoch: 47, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4818568229675293
Epoch: 48, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 53128
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7785844802856445
Epoch: 1, Steps: 8 | Train Loss: 2.039 Vali Loss: 1.899 Vali Acc: 0.547 Test Loss: 1.899 Test Acc: 0.547
Validation loss decreased (inf --> -0.546856).  Saving model ...
Epoch: 2 cost time: 0.5638771057128906
Epoch: 2, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.316 Vali Acc: 0.794 Test Loss: 1.316 Test Acc: 0.794
Validation loss decreased (-0.546856 --> -0.793737).  Saving model ...
Epoch: 3 cost time: 0.6748099327087402
Epoch: 3, Steps: 8 | Train Loss: 0.769 Vali Loss: 0.745 Vali Acc: 0.819 Test Loss: 0.745 Test Acc: 0.819
Validation loss decreased (-0.793737 --> -0.818743).  Saving model ...
Epoch: 4 cost time: 0.5428404808044434
Epoch: 4, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.818743 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 0.664522647857666
Epoch: 5, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.667125940322876
Epoch: 6, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.577 Vali Acc: 0.834 Test Loss: 0.577 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.712935209274292
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.640 Vali Acc: 0.831 Test Loss: 0.640 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5882515907287598
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.669 Vali Acc: 0.819 Test Loss: 0.669 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6485962867736816
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.693 Vali Acc: 0.831 Test Loss: 0.693 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6690168380737305
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.766 Vali Acc: 0.831 Test Loss: 0.766 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6598992347717285
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.852 Vali Acc: 0.828 Test Loss: 0.852 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6709792613983154
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.825 Test Loss: 0.851 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7306613922119141
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.828 Test Loss: 0.844 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6236121654510498
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.828 Test Loss: 0.855 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 831624
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.77384614944458
Epoch: 1, Steps: 8 | Train Loss: 2.063 Vali Loss: 1.993 Vali Acc: 0.281 Test Loss: 1.993 Test Acc: 0.281
Validation loss decreased (inf --> -0.281230).  Saving model ...
Epoch: 2 cost time: 0.5825796127319336
Epoch: 2, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.625 Vali Acc: 0.766 Test Loss: 1.625 Test Acc: 0.766
Validation loss decreased (-0.281230 --> -0.765609).  Saving model ...
Epoch: 3 cost time: 0.5903167724609375
Epoch: 3, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.087 Vali Acc: 0.806 Test Loss: 1.087 Test Acc: 0.806
Validation loss decreased (-0.765609 --> -0.806239).  Saving model ...
Epoch: 4 cost time: 0.5760011672973633
Epoch: 4, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.645 Vali Acc: 0.838 Test Loss: 0.645 Test Acc: 0.838
Validation loss decreased (-0.806239 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 0.5811035633087158
Epoch: 5, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.5615720748901367
Epoch: 6, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
Validation loss decreased (-0.840620 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 0.5160846710205078
Epoch: 7, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.647794246673584
Epoch: 8, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6455287933349609
Epoch: 9, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5342473983764648
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5274407863616943
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5787761211395264
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.679 Vali Acc: 0.825 Test Loss: 0.679 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5008721351623535
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5260083675384521
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5641193389892578
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5387773513793945
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.831 Test Loss: 0.704 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 715912
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7592685222625732
Epoch: 1, Steps: 8 | Train Loss: 2.075 Vali Loss: 2.007 Vali Acc: 0.328 Test Loss: 2.007 Test Acc: 0.328
Validation loss decreased (inf --> -0.328105).  Saving model ...
Epoch: 2 cost time: 0.6071546077728271
Epoch: 2, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.739 Vali Acc: 0.681 Test Loss: 1.739 Test Acc: 0.681
Validation loss decreased (-0.328105 --> -0.681233).  Saving model ...
Epoch: 3 cost time: 0.5611579418182373
Epoch: 3, Steps: 8 | Train Loss: 1.366 Vali Loss: 1.317 Vali Acc: 0.794 Test Loss: 1.317 Test Acc: 0.794
Validation loss decreased (-0.681233 --> -0.793737).  Saving model ...
Epoch: 4 cost time: 0.5954840183258057
Epoch: 4, Steps: 8 | Train Loss: 0.897 Vali Loss: 0.878 Vali Acc: 0.822 Test Loss: 0.878 Test Acc: 0.822
Validation loss decreased (-0.793737 --> -0.821866).  Saving model ...
Epoch: 5 cost time: 0.5766556262969971
Epoch: 5, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
Validation loss decreased (-0.821866 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 0.5511229038238525
Epoch: 6, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.5872783660888672
Epoch: 7, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.446 Vali Acc: 0.869 Test Loss: 0.446 Test Acc: 0.869
Validation loss decreased (-0.837495 --> -0.868746).  Saving model ...
Epoch: 8 cost time: 0.6145730018615723
Epoch: 8, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5635671615600586
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6453280448913574
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5991621017456055
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5559349060058594
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5941898822784424
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6517934799194336
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6549363136291504
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6204924583435059
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.612 Vali Acc: 0.841 Test Loss: 0.612 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6209158897399902
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 673928
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7015371322631836
Epoch: 1, Steps: 8 | Train Loss: 2.073 Vali Loss: 2.010 Vali Acc: 0.325 Test Loss: 2.010 Test Acc: 0.325
Validation loss decreased (inf --> -0.324980).  Saving model ...
Epoch: 2 cost time: 0.5338993072509766
Epoch: 2, Steps: 8 | Train Loss: 1.855 Vali Loss: 1.788 Vali Acc: 0.719 Test Loss: 1.788 Test Acc: 0.719
Validation loss decreased (-0.324980 --> -0.718732).  Saving model ...
Epoch: 3 cost time: 0.5738565921783447
Epoch: 3, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.426 Vali Acc: 0.838 Test Loss: 1.426 Test Acc: 0.838
Validation loss decreased (-0.718732 --> -0.837486).  Saving model ...
Epoch: 4 cost time: 0.5685245990753174
Epoch: 4, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.003 Vali Acc: 0.834 Test Loss: 1.003 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5344674587249756
Epoch: 5, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
Validation loss decreased (-0.837486 --> -0.843743).  Saving model ...
Epoch: 6 cost time: 0.5429022312164307
Epoch: 6, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5555140972137451
Epoch: 7, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
Validation loss decreased (-0.843743 --> -0.859371).  Saving model ...
Epoch: 8 cost time: 0.5838108062744141
Epoch: 8, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.859371 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.541905403137207
Epoch: 9, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5474247932434082
Epoch: 10, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5327765941619873
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5691161155700684
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5101513862609863
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.569364070892334
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5153095722198486
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5304903984069824
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5664477348327637
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5904138088226318
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.847 Test Loss: 0.588 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 656520
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.73280930519104
Epoch: 1, Steps: 8 | Train Loss: 2.063 Vali Loss: 2.014 Vali Acc: 0.309 Test Loss: 2.014 Test Acc: 0.309
Validation loss decreased (inf --> -0.309355).  Saving model ...
Epoch: 2 cost time: 0.5825419425964355
Epoch: 2, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.818 Vali Acc: 0.634 Test Loss: 1.818 Test Acc: 0.634
Validation loss decreased (-0.309355 --> -0.634357).  Saving model ...
Epoch: 3 cost time: 0.6208159923553467
Epoch: 3, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.516 Vali Acc: 0.772 Test Loss: 1.516 Test Acc: 0.772
Validation loss decreased (-0.634357 --> -0.771860).  Saving model ...
Epoch: 4 cost time: 0.5709483623504639
Epoch: 4, Steps: 8 | Train Loss: 1.189 Vali Loss: 1.153 Vali Acc: 0.800 Test Loss: 1.153 Test Acc: 0.800
Validation loss decreased (-0.771860 --> -0.799988).  Saving model ...
Epoch: 5 cost time: 0.48136401176452637
Epoch: 5, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.822 Vali Acc: 0.812 Test Loss: 0.822 Test Acc: 0.812
Validation loss decreased (-0.799988 --> -0.812492).  Saving model ...
Epoch: 6 cost time: 0.5924544334411621
Epoch: 6, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
Validation loss decreased (-0.812492 --> -0.840619).  Saving model ...
Epoch: 7 cost time: 0.592578649520874
Epoch: 7, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.5759835243225098
Epoch: 8, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.6262319087982178
Epoch: 9, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.458 Vali Acc: 0.853 Test Loss: 0.458 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.6171150207519531
Epoch: 10, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.458 Vali Acc: 0.859 Test Loss: 0.458 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 0.5955567359924316
Epoch: 11, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.453 Vali Acc: 0.866 Test Loss: 0.453 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 0.596405029296875
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6874208450317383
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5705711841583252
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5751111507415771
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.592498779296875
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5954890251159668
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.569197416305542
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5319614410400391
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5728857517242432
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5599174499511719
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 640136
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6388514041900635
Epoch: 1, Steps: 8 | Train Loss: 2.079 Vali Loss: 2.062 Vali Acc: 0.172 Test Loss: 2.062 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.6102778911590576
Epoch: 2, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.898 Vali Acc: 0.466 Test Loss: 1.898 Test Acc: 0.466
Validation loss decreased (-0.171854 --> -0.465606).  Saving model ...
Epoch: 3 cost time: 0.659374475479126
Epoch: 3, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.633 Vali Acc: 0.734 Test Loss: 1.633 Test Acc: 0.734
Validation loss decreased (-0.465606 --> -0.734359).  Saving model ...
Epoch: 4 cost time: 0.5949630737304688
Epoch: 4, Steps: 8 | Train Loss: 1.354 Vali Loss: 1.309 Vali Acc: 0.794 Test Loss: 1.309 Test Acc: 0.794
Validation loss decreased (-0.734359 --> -0.793737).  Saving model ...
Epoch: 5 cost time: 0.5410048961639404
Epoch: 5, Steps: 8 | Train Loss: 1.029 Vali Loss: 0.993 Vali Acc: 0.806 Test Loss: 0.993 Test Acc: 0.806
Validation loss decreased (-0.793737 --> -0.806240).  Saving model ...
Epoch: 6 cost time: 0.534259557723999
Epoch: 6, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.739 Vali Acc: 0.819 Test Loss: 0.739 Test Acc: 0.819
Validation loss decreased (-0.806240 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 0.48663830757141113
Epoch: 7, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.589 Vali Acc: 0.819 Test Loss: 0.589 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 0.578279972076416
Epoch: 8, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
Validation loss decreased (-0.818744 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.5875101089477539
Epoch: 9, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
Validation loss decreased (-0.837495 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.5289111137390137
Epoch: 10, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5559310913085938
Epoch: 11, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856246).  Saving model ...
Epoch: 12 cost time: 0.600672721862793
Epoch: 12, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5991322994232178
Epoch: 13, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.437 Vali Acc: 0.863 Test Loss: 0.437 Test Acc: 0.863
Validation loss decreased (-0.856246 --> -0.862496).  Saving model ...
Epoch: 14 cost time: 0.6596627235412598
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.460 Vali Acc: 0.859 Test Loss: 0.460 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.612415075302124
Epoch: 15, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5812842845916748
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5689942836761475
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.469 Vali Acc: 0.859 Test Loss: 0.469 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5958740711212158
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.479 Vali Acc: 0.853 Test Loss: 0.479 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6803920269012451
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6308057308197021
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6112058162689209
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5749642848968506
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.49057984352111816
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 629768
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8401954174041748
Epoch: 1, Steps: 8 | Train Loss: 2.164 Vali Loss: 2.081 Vali Acc: 0.222 Test Loss: 2.081 Test Acc: 0.222
Validation loss decreased (inf --> -0.221854).  Saving model ...
Epoch: 2 cost time: 0.5596909523010254
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.930 Vali Acc: 0.362 Test Loss: 1.930 Test Acc: 0.362
Validation loss decreased (-0.221854 --> -0.362481).  Saving model ...
Epoch: 3 cost time: 0.5301711559295654
Epoch: 3, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.692 Vali Acc: 0.616 Test Loss: 1.692 Test Acc: 0.616
Validation loss decreased (-0.362481 --> -0.615608).  Saving model ...
Epoch: 4 cost time: 0.5343036651611328
Epoch: 4, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.391 Vali Acc: 0.775 Test Loss: 1.391 Test Acc: 0.775
Validation loss decreased (-0.615608 --> -0.774986).  Saving model ...
Epoch: 5 cost time: 0.564335823059082
Epoch: 5, Steps: 8 | Train Loss: 1.157 Vali Loss: 1.090 Vali Acc: 0.812 Test Loss: 1.090 Test Acc: 0.812
Validation loss decreased (-0.774986 --> -0.812489).  Saving model ...
Epoch: 6 cost time: 0.6126997470855713
Epoch: 6, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.832 Vali Acc: 0.822 Test Loss: 0.832 Test Acc: 0.822
Validation loss decreased (-0.812489 --> -0.821867).  Saving model ...
Epoch: 7 cost time: 0.5502603054046631
Epoch: 7, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.655 Vali Acc: 0.828 Test Loss: 0.655 Test Acc: 0.828
Validation loss decreased (-0.821867 --> -0.828118).  Saving model ...
Epoch: 8 cost time: 0.5492603778839111
Epoch: 8, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.6208302974700928
Epoch: 9, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.6179068088531494
Epoch: 10, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862496).  Saving model ...
Epoch: 11 cost time: 0.6316525936126709
Epoch: 11, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6315822601318359
Epoch: 12, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.433 Vali Acc: 0.853 Test Loss: 0.433 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6289122104644775
Epoch: 13, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.418 Vali Acc: 0.859 Test Loss: 0.418 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.63114333152771
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5838782787322998
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.425 Vali Acc: 0.853 Test Loss: 0.425 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5870616436004639
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.428 Vali Acc: 0.856 Test Loss: 0.428 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.604163646697998
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.445 Vali Acc: 0.853 Test Loss: 0.445 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5768105983734131
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6264133453369141
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5688257217407227
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 625672
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6782686710357666
Epoch: 1, Steps: 8 | Train Loss: 2.087 Vali Loss: 1.986 Vali Acc: 0.338 Test Loss: 1.986 Test Acc: 0.338
Validation loss decreased (inf --> -0.337480).  Saving model ...
Epoch: 2 cost time: 0.48342299461364746
Epoch: 2, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.694 Vali Acc: 0.694 Test Loss: 1.694 Test Acc: 0.694
Validation loss decreased (-0.337480 --> -0.693733).  Saving model ...
Epoch: 3 cost time: 0.5122799873352051
Epoch: 3, Steps: 8 | Train Loss: 1.288 Vali Loss: 1.254 Vali Acc: 0.791 Test Loss: 1.254 Test Acc: 0.791
Validation loss decreased (-0.693733 --> -0.790612).  Saving model ...
Epoch: 4 cost time: 0.5212867259979248
Epoch: 4, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.817 Vali Acc: 0.816 Test Loss: 0.817 Test Acc: 0.816
Validation loss decreased (-0.790612 --> -0.815617).  Saving model ...
Epoch: 5 cost time: 0.49906492233276367
Epoch: 5, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
Validation loss decreased (-0.815617 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 0.5112729072570801
Epoch: 6, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.5382564067840576
Epoch: 7, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.4942934513092041
Epoch: 8, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4645354747772217
Epoch: 9, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.49380064010620117
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.46486973762512207
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5207273960113525
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.516099214553833
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.812 Test Loss: 0.679 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4872448444366455
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.706 Vali Acc: 0.816 Test Loss: 0.706 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.582953691482544
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.819 Test Loss: 0.715 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5424501895904541
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.731 Vali Acc: 0.816 Test Loss: 0.731 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.46311187744140625
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.747 Vali Acc: 0.819 Test Loss: 0.747 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 276552
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5416324138641357
Epoch: 1, Steps: 8 | Train Loss: 2.074 Vali Loss: 2.038 Vali Acc: 0.253 Test Loss: 2.038 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 0.5865921974182129
Epoch: 2, Steps: 8 | Train Loss: 1.869 Vali Loss: 1.841 Vali Acc: 0.581 Test Loss: 1.841 Test Acc: 0.581
Validation loss decreased (-0.253105 --> -0.581232).  Saving model ...
Epoch: 3 cost time: 0.6146173477172852
Epoch: 3, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.517 Vali Acc: 0.766 Test Loss: 1.517 Test Acc: 0.766
Validation loss decreased (-0.581232 --> -0.765610).  Saving model ...
Epoch: 4 cost time: 0.6115086078643799
Epoch: 4, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.112 Vali Acc: 0.803 Test Loss: 1.112 Test Acc: 0.803
Validation loss decreased (-0.765610 --> -0.803114).  Saving model ...
Epoch: 5 cost time: 0.5607874393463135
Epoch: 5, Steps: 8 | Train Loss: 0.782 Vali Loss: 0.759 Vali Acc: 0.828 Test Loss: 0.759 Test Acc: 0.828
Validation loss decreased (-0.803114 --> -0.828117).  Saving model ...
Epoch: 6 cost time: 0.609257698059082
Epoch: 6, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
Validation loss decreased (-0.828117 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.533776044845581
Epoch: 7, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.5041553974151611
Epoch: 8, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.521683931350708
Epoch: 9, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.532696008682251
Epoch: 10, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5327949523925781
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5238094329833984
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5179953575134277
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5402705669403076
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5294754505157471
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5979282855987549
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6150095462799072
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5716917514801025
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 218696
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6417832374572754
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 2.066 Vali Acc: 0.172 Test Loss: 2.066 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.4544715881347656
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.942 Vali Acc: 0.381 Test Loss: 1.942 Test Acc: 0.381
Validation loss decreased (-0.171854 --> -0.381231).  Saving model ...
Epoch: 3 cost time: 0.48161864280700684
Epoch: 3, Steps: 8 | Train Loss: 1.748 Vali Loss: 1.735 Vali Acc: 0.706 Test Loss: 1.735 Test Acc: 0.706
Validation loss decreased (-0.381231 --> -0.706233).  Saving model ...
Epoch: 4 cost time: 0.5638253688812256
Epoch: 4, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.451 Vali Acc: 0.778 Test Loss: 1.451 Test Acc: 0.778
Validation loss decreased (-0.706233 --> -0.778110).  Saving model ...
Epoch: 5 cost time: 0.5911202430725098
Epoch: 5, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.110 Vali Acc: 0.809 Test Loss: 1.110 Test Acc: 0.809
Validation loss decreased (-0.778110 --> -0.809364).  Saving model ...
Epoch: 6 cost time: 0.5378024578094482
Epoch: 6, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.810 Vali Acc: 0.828 Test Loss: 0.810 Test Acc: 0.828
Validation loss decreased (-0.809364 --> -0.828117).  Saving model ...
Epoch: 7 cost time: 0.5306763648986816
Epoch: 7, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
Validation loss decreased (-0.828117 --> -0.843744).  Saving model ...
Epoch: 8 cost time: 0.5860984325408936
Epoch: 8, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.5184576511383057
Epoch: 9, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.5049192905426025
Epoch: 10, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.5728282928466797
Epoch: 11, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.542792558670044
Epoch: 12, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5257394313812256
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5472068786621094
Epoch: 14, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5168013572692871
Epoch: 15, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5515844821929932
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5310959815979004
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4983103275299072
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5818276405334473
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5610437393188477
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 197704
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.647345781326294
Epoch: 1, Steps: 8 | Train Loss: 2.069 Vali Loss: 2.024 Vali Acc: 0.184 Test Loss: 2.024 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 0.5553891658782959
Epoch: 2, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.910 Vali Acc: 0.459 Test Loss: 1.910 Test Acc: 0.459
Validation loss decreased (-0.184355 --> -0.459356).  Saving model ...
Epoch: 3 cost time: 0.5410275459289551
Epoch: 3, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.724 Vali Acc: 0.694 Test Loss: 1.724 Test Acc: 0.694
Validation loss decreased (-0.459356 --> -0.693733).  Saving model ...
Epoch: 4 cost time: 0.4988212585449219
Epoch: 4, Steps: 8 | Train Loss: 1.523 Vali Loss: 1.479 Vali Acc: 0.778 Test Loss: 1.479 Test Acc: 0.778
Validation loss decreased (-0.693733 --> -0.778110).  Saving model ...
Epoch: 5 cost time: 0.48676514625549316
Epoch: 5, Steps: 8 | Train Loss: 1.263 Vali Loss: 1.197 Vali Acc: 0.803 Test Loss: 1.197 Test Acc: 0.803
Validation loss decreased (-0.778110 --> -0.803113).  Saving model ...
Epoch: 6 cost time: 0.4440171718597412
Epoch: 6, Steps: 8 | Train Loss: 0.967 Vali Loss: 0.927 Vali Acc: 0.809 Test Loss: 0.927 Test Acc: 0.809
Validation loss decreased (-0.803113 --> -0.809366).  Saving model ...
Epoch: 7 cost time: 0.5678777694702148
Epoch: 7, Steps: 8 | Train Loss: 0.721 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 0.45391392707824707
Epoch: 8, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.821868 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 0.47701191902160645
Epoch: 9, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.843744 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.4415295124053955
Epoch: 10, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.45422887802124023
Epoch: 11, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.460 Vali Acc: 0.859 Test Loss: 0.460 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 0.5228443145751953
Epoch: 12, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5497896671295166
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4865295886993408
Epoch: 14, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5203444957733154
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 16 cost time: 0.5316824913024902
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5111520290374756
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.685875654220581
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5569055080413818
Epoch: 19, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6083528995513916
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6200470924377441
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5993294715881348
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6123721599578857
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6172549724578857
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5841591358184814
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 189000
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7379608154296875
Epoch: 1, Steps: 8 | Train Loss: 2.142 Vali Loss: 2.094 Vali Acc: 0.125 Test Loss: 2.094 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 0.5632152557373047
Epoch: 2, Steps: 8 | Train Loss: 2.055 Vali Loss: 2.001 Vali Acc: 0.172 Test Loss: 2.001 Test Acc: 0.172
Validation loss decreased (-0.124979 --> -0.171855).  Saving model ...
Epoch: 3 cost time: 0.5741355419158936
Epoch: 3, Steps: 8 | Train Loss: 1.911 Vali Loss: 1.849 Vali Acc: 0.450 Test Loss: 1.849 Test Acc: 0.450
Validation loss decreased (-0.171855 --> -0.449982).  Saving model ...
Epoch: 4 cost time: 0.5955102443695068
Epoch: 4, Steps: 8 | Train Loss: 1.693 Vali Loss: 1.653 Vali Acc: 0.734 Test Loss: 1.653 Test Acc: 0.734
Validation loss decreased (-0.449982 --> -0.734358).  Saving model ...
Epoch: 5 cost time: 0.5917797088623047
Epoch: 5, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.429 Vali Acc: 0.797 Test Loss: 1.429 Test Acc: 0.797
Validation loss decreased (-0.734358 --> -0.796861).  Saving model ...
Epoch: 6 cost time: 0.629101037979126
Epoch: 6, Steps: 8 | Train Loss: 1.231 Vali Loss: 1.188 Vali Acc: 0.816 Test Loss: 1.188 Test Acc: 0.816
Validation loss decreased (-0.796861 --> -0.815613).  Saving model ...
Epoch: 7 cost time: 0.546999454498291
Epoch: 7, Steps: 8 | Train Loss: 0.996 Vali Loss: 0.956 Vali Acc: 0.822 Test Loss: 0.956 Test Acc: 0.822
Validation loss decreased (-0.815613 --> -0.821865).  Saving model ...
Epoch: 8 cost time: 0.6838233470916748
Epoch: 8, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.764 Vali Acc: 0.838 Test Loss: 0.764 Test Acc: 0.838
Validation loss decreased (-0.821865 --> -0.837492).  Saving model ...
Epoch: 9 cost time: 0.5533161163330078
Epoch: 9, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.837492 --> -0.856244).  Saving model ...
Epoch: 10 cost time: 0.5727498531341553
Epoch: 10, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.6771886348724365
Epoch: 11, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.496 Vali Acc: 0.866 Test Loss: 0.496 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 0.5690841674804688
Epoch: 12, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 0.5203254222869873
Epoch: 13, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4960916042327881
Epoch: 14, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6441934108734131
Epoch: 15, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.447 Vali Acc: 0.866 Test Loss: 0.447 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5826659202575684
Epoch: 16, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5396709442138672
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.453 Vali Acc: 0.859 Test Loss: 0.453 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5949678421020508
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.551506519317627
Epoch: 19, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5584721565246582
Epoch: 20, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.49652600288391113
Epoch: 21, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5590305328369141
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 180808
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8403098583221436
Epoch: 1, Steps: 8 | Train Loss: 2.008 Vali Loss: 2.011 Vali Acc: 0.297 Test Loss: 2.011 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 0.5321457386016846
Epoch: 2, Steps: 8 | Train Loss: 1.941 Vali Loss: 1.926 Vali Acc: 0.466 Test Loss: 1.926 Test Acc: 0.466
Validation loss decreased (-0.296855 --> -0.465606).  Saving model ...
Epoch: 3 cost time: 0.5465877056121826
Epoch: 3, Steps: 8 | Train Loss: 1.813 Vali Loss: 1.799 Vali Acc: 0.613 Test Loss: 1.799 Test Acc: 0.613
Validation loss decreased (-0.465606 --> -0.612482).  Saving model ...
Epoch: 4 cost time: 0.5327563285827637
Epoch: 4, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.639 Vali Acc: 0.716 Test Loss: 1.639 Test Acc: 0.716
Validation loss decreased (-0.612482 --> -0.715609).  Saving model ...
Epoch: 5 cost time: 0.5462300777435303
Epoch: 5, Steps: 8 | Train Loss: 1.487 Vali Loss: 1.450 Vali Acc: 0.766 Test Loss: 1.450 Test Acc: 0.766
Validation loss decreased (-0.715609 --> -0.765610).  Saving model ...
Epoch: 6 cost time: 0.5632553100585938
Epoch: 6, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.249 Vali Acc: 0.787 Test Loss: 1.249 Test Acc: 0.787
Validation loss decreased (-0.765610 --> -0.787488).  Saving model ...
Epoch: 7 cost time: 0.5706024169921875
Epoch: 7, Steps: 8 | Train Loss: 1.131 Vali Loss: 1.053 Vali Acc: 0.800 Test Loss: 1.053 Test Acc: 0.800
Validation loss decreased (-0.787488 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.5893938541412354
Epoch: 8, Steps: 8 | Train Loss: 0.890 Vali Loss: 0.886 Vali Acc: 0.816 Test Loss: 0.886 Test Acc: 0.816
Validation loss decreased (-0.799989 --> -0.815616).  Saving model ...
Epoch: 9 cost time: 0.41703009605407715
Epoch: 9, Steps: 8 | Train Loss: 0.730 Vali Loss: 0.744 Vali Acc: 0.831 Test Loss: 0.744 Test Acc: 0.831
Validation loss decreased (-0.815616 --> -0.831243).  Saving model ...
Epoch: 10 cost time: 0.4910593032836914
Epoch: 10, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.642 Vali Acc: 0.841 Test Loss: 0.642 Test Acc: 0.841
Validation loss decreased (-0.831243 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 0.5220324993133545
Epoch: 11, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 0.5408504009246826
Epoch: 12, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.5401880741119385
Epoch: 13, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 14 cost time: 0.5278058052062988
Epoch: 14, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 15 cost time: 0.5305607318878174
Epoch: 15, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.467 Vali Acc: 0.853 Test Loss: 0.467 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.606879472732544
Epoch: 16, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.459 Vali Acc: 0.863 Test Loss: 0.459 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5362069606781006
Epoch: 17, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4866793155670166
Epoch: 18, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.48198890686035156
Epoch: 19, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5656590461730957
Epoch: 20, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.440 Vali Acc: 0.863 Test Loss: 0.440 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.612647294998169
Epoch: 21, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.440 Vali Acc: 0.856 Test Loss: 0.440 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5041944980621338
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.443 Vali Acc: 0.853 Test Loss: 0.443 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5825052261352539
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5516788959503174
Epoch: 24, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 175624
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6282718181610107
Epoch: 1, Steps: 8 | Train Loss: 2.066 Vali Loss: 2.046 Vali Acc: 0.156 Test Loss: 2.046 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 0.5178639888763428
Epoch: 2, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.976 Vali Acc: 0.253 Test Loss: 1.976 Test Acc: 0.253
Validation loss decreased (-0.156230 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 0.5051028728485107
Epoch: 3, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.863 Vali Acc: 0.466 Test Loss: 1.863 Test Acc: 0.466
Validation loss decreased (-0.253105 --> -0.465606).  Saving model ...
Epoch: 4 cost time: 0.5260360240936279
Epoch: 4, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.721 Vali Acc: 0.647 Test Loss: 1.721 Test Acc: 0.647
Validation loss decreased (-0.465606 --> -0.646858).  Saving model ...
Epoch: 5 cost time: 0.4586184024810791
Epoch: 5, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.555 Vali Acc: 0.716 Test Loss: 1.555 Test Acc: 0.716
Validation loss decreased (-0.646858 --> -0.715609).  Saving model ...
Epoch: 6 cost time: 0.586174726486206
Epoch: 6, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.380 Vali Acc: 0.753 Test Loss: 1.380 Test Acc: 0.753
Validation loss decreased (-0.715609 --> -0.753111).  Saving model ...
Epoch: 7 cost time: 0.5521736145019531
Epoch: 7, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.201 Vali Acc: 0.778 Test Loss: 1.201 Test Acc: 0.778
Validation loss decreased (-0.753111 --> -0.778113).  Saving model ...
Epoch: 8 cost time: 0.4872550964355469
Epoch: 8, Steps: 8 | Train Loss: 1.055 Vali Loss: 1.026 Vali Acc: 0.791 Test Loss: 1.026 Test Acc: 0.791
Validation loss decreased (-0.778113 --> -0.790615).  Saving model ...
Epoch: 9 cost time: 0.5111393928527832
Epoch: 9, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.878 Vali Acc: 0.806 Test Loss: 0.878 Test Acc: 0.806
Validation loss decreased (-0.790615 --> -0.806241).  Saving model ...
Epoch: 10 cost time: 0.575528621673584
Epoch: 10, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.759 Vali Acc: 0.812 Test Loss: 0.759 Test Acc: 0.812
Validation loss decreased (-0.806241 --> -0.812492).  Saving model ...
Epoch: 11 cost time: 0.5393619537353516
Epoch: 11, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.673 Vali Acc: 0.812 Test Loss: 0.673 Test Acc: 0.812
Validation loss decreased (-0.812492 --> -0.812493).  Saving model ...
Epoch: 12 cost time: 0.5597150325775146
Epoch: 12, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.604 Vali Acc: 0.834 Test Loss: 0.604 Test Acc: 0.834
Validation loss decreased (-0.812493 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 0.583885669708252
Epoch: 13, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5080575942993164
Epoch: 14, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 0.5853090286254883
Epoch: 15, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 0.5863296985626221
Epoch: 16, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 0.51885986328125
Epoch: 17, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5807287693023682
Epoch: 18, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 0.4241597652435303
Epoch: 19, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856246).  Saving model ...
Epoch: 20 cost time: 0.4800386428833008
Epoch: 20, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.443 Vali Acc: 0.859 Test Loss: 0.443 Test Acc: 0.859
Validation loss decreased (-0.856246 --> -0.859371).  Saving model ...
Epoch: 21 cost time: 0.5317056179046631
Epoch: 21, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4073784351348877
Epoch: 22, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4843101501464844
Epoch: 23, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.440 Vali Acc: 0.856 Test Loss: 0.440 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.48366522789001465
Epoch: 24, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5238456726074219
Epoch: 25, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.434 Vali Acc: 0.859 Test Loss: 0.434 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 26 cost time: 0.48961639404296875
Epoch: 26, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.427 Vali Acc: 0.856 Test Loss: 0.427 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5651803016662598
Epoch: 27, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.430 Vali Acc: 0.856 Test Loss: 0.430 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.551734209060669
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5052282810211182
Epoch: 29, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.524019718170166
Epoch: 30, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5482597351074219
Epoch: 31, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5427615642547607
Epoch: 32, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5201683044433594
Epoch: 33, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.464139461517334
Epoch: 34, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5186188220977783
Epoch: 35, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 173576
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6272883415222168
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.018 Vali Acc: 0.247 Test Loss: 2.018 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.446439266204834
Epoch: 2, Steps: 8 | Train Loss: 1.913 Vali Loss: 1.831 Vali Acc: 0.569 Test Loss: 1.831 Test Acc: 0.569
Validation loss decreased (-0.246855 --> -0.568732).  Saving model ...
Epoch: 3 cost time: 0.48957037925720215
Epoch: 3, Steps: 8 | Train Loss: 1.566 Vali Loss: 1.549 Vali Acc: 0.731 Test Loss: 1.549 Test Acc: 0.731
Validation loss decreased (-0.568732 --> -0.731235).  Saving model ...
Epoch: 4 cost time: 0.5898587703704834
Epoch: 4, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.193 Vali Acc: 0.778 Test Loss: 1.193 Test Acc: 0.778
Validation loss decreased (-0.731235 --> -0.778113).  Saving model ...
Epoch: 5 cost time: 0.535560131072998
Epoch: 5, Steps: 8 | Train Loss: 0.904 Vali Loss: 0.864 Vali Acc: 0.812 Test Loss: 0.864 Test Acc: 0.812
Validation loss decreased (-0.778113 --> -0.812491).  Saving model ...
Epoch: 6 cost time: 0.4744853973388672
Epoch: 6, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.651 Vali Acc: 0.825 Test Loss: 0.651 Test Acc: 0.825
Validation loss decreased (-0.812491 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.4576137065887451
Epoch: 7, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.49793291091918945
Epoch: 8, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.828120 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.5415160655975342
Epoch: 9, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.4424276351928711
Epoch: 10, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45660877227783203
Epoch: 11, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.43517518043518066
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4992048740386963
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4934241771697998
Epoch: 14, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.48011016845703125
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.48880910873413086
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4538397789001465
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4853360652923584
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5361816883087158
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.838 Test Loss: 0.613 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 103464
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5857295989990234
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 2.075 Vali Acc: 0.122 Test Loss: 2.075 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.47856783866882324
Epoch: 2, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.975 Vali Acc: 0.306 Test Loss: 1.975 Test Acc: 0.306
Validation loss decreased (-0.121854 --> -0.306230).  Saving model ...
Epoch: 3 cost time: 0.43824005126953125
Epoch: 3, Steps: 8 | Train Loss: 1.804 Vali Loss: 1.813 Vali Acc: 0.544 Test Loss: 1.813 Test Acc: 0.544
Validation loss decreased (-0.306230 --> -0.543732).  Saving model ...
Epoch: 4 cost time: 0.43035197257995605
Epoch: 4, Steps: 8 | Train Loss: 1.590 Vali Loss: 1.595 Vali Acc: 0.700 Test Loss: 1.595 Test Acc: 0.700
Validation loss decreased (-0.543732 --> -0.699984).  Saving model ...
Epoch: 5 cost time: 0.528799295425415
Epoch: 5, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.334 Vali Acc: 0.750 Test Loss: 1.334 Test Acc: 0.750
Validation loss decreased (-0.699984 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 0.4782898426055908
Epoch: 6, Steps: 8 | Train Loss: 1.098 Vali Loss: 1.071 Vali Acc: 0.769 Test Loss: 1.071 Test Acc: 0.769
Validation loss decreased (-0.749987 --> -0.768739).  Saving model ...
Epoch: 7 cost time: 0.4781665802001953
Epoch: 7, Steps: 8 | Train Loss: 0.838 Vali Loss: 0.854 Vali Acc: 0.781 Test Loss: 0.854 Test Acc: 0.781
Validation loss decreased (-0.768739 --> -0.781241).  Saving model ...
Epoch: 8 cost time: 0.48450803756713867
Epoch: 8, Steps: 8 | Train Loss: 0.612 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
Validation loss decreased (-0.781241 --> -0.803118).  Saving model ...
Epoch: 9 cost time: 0.4961550235748291
Epoch: 9, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.5645709037780762
Epoch: 10, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.5577821731567383
Epoch: 11, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.484818696975708
Epoch: 12, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 0.5266203880310059
Epoch: 13, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5014877319335938
Epoch: 14, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4726698398590088
Epoch: 15, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4521491527557373
Epoch: 16, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.44621944427490234
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4712996482849121
Epoch: 18, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4201657772064209
Epoch: 19, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.44286227226257324
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.49962496757507324
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4603252410888672
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 74536
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5856029987335205
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 2.063 Vali Acc: 0.166 Test Loss: 2.063 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 0.4561734199523926
Epoch: 2, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.993 Vali Acc: 0.250 Test Loss: 1.993 Test Acc: 0.250
Validation loss decreased (-0.165604 --> -0.249980).  Saving model ...
Epoch: 3 cost time: 0.479813814163208
Epoch: 3, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.879 Vali Acc: 0.419 Test Loss: 1.879 Test Acc: 0.419
Validation loss decreased (-0.249980 --> -0.418731).  Saving model ...
Epoch: 4 cost time: 0.49393677711486816
Epoch: 4, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.721 Vali Acc: 0.616 Test Loss: 1.721 Test Acc: 0.616
Validation loss decreased (-0.418731 --> -0.615608).  Saving model ...
Epoch: 5 cost time: 0.4833061695098877
Epoch: 5, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.526 Vali Acc: 0.722 Test Loss: 1.526 Test Acc: 0.722
Validation loss decreased (-0.615608 --> -0.721860).  Saving model ...
Epoch: 6 cost time: 0.4992530345916748
Epoch: 6, Steps: 8 | Train Loss: 1.342 Vali Loss: 1.310 Vali Acc: 0.766 Test Loss: 1.310 Test Acc: 0.766
Validation loss decreased (-0.721860 --> -0.765612).  Saving model ...
Epoch: 7 cost time: 0.515636682510376
Epoch: 7, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.093 Vali Acc: 0.787 Test Loss: 1.093 Test Acc: 0.787
Validation loss decreased (-0.765612 --> -0.787489).  Saving model ...
Epoch: 8 cost time: 0.44654011726379395
Epoch: 8, Steps: 8 | Train Loss: 0.895 Vali Loss: 0.895 Vali Acc: 0.816 Test Loss: 0.895 Test Acc: 0.816
Validation loss decreased (-0.787489 --> -0.815616).  Saving model ...
Epoch: 9 cost time: 0.4427945613861084
Epoch: 9, Steps: 8 | Train Loss: 0.697 Vali Loss: 0.737 Vali Acc: 0.819 Test Loss: 0.737 Test Acc: 0.819
Validation loss decreased (-0.815616 --> -0.818743).  Saving model ...
Epoch: 10 cost time: 0.47934818267822266
Epoch: 10, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.4974551200866699
Epoch: 11, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.5210981369018555
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.4643685817718506
Epoch: 13, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47360920906066895
Epoch: 14, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5070335865020752
Epoch: 15, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4873931407928467
Epoch: 16, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5452604293823242
Epoch: 17, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4239804744720459
Epoch: 18, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5020577907562256
Epoch: 19, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5600886344909668
Epoch: 20, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4168510437011719
Epoch: 21, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5017104148864746
Epoch: 22, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 64040
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6197991371154785
Epoch: 1, Steps: 8 | Train Loss: 2.081 Vali Loss: 2.059 Vali Acc: 0.188 Test Loss: 2.059 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 0.486008882522583
Epoch: 2, Steps: 8 | Train Loss: 2.003 Vali Loss: 2.007 Vali Acc: 0.281 Test Loss: 2.007 Test Acc: 0.281
Validation loss decreased (-0.187479 --> -0.281230).  Saving model ...
Epoch: 3 cost time: 0.53167724609375
Epoch: 3, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.920 Vali Acc: 0.409 Test Loss: 1.920 Test Acc: 0.409
Validation loss decreased (-0.281230 --> -0.409356).  Saving model ...
Epoch: 4 cost time: 0.5532314777374268
Epoch: 4, Steps: 8 | Train Loss: 1.814 Vali Loss: 1.801 Vali Acc: 0.544 Test Loss: 1.801 Test Acc: 0.544
Validation loss decreased (-0.409356 --> -0.543732).  Saving model ...
Epoch: 5 cost time: 0.45825672149658203
Epoch: 5, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.654 Vali Acc: 0.653 Test Loss: 1.654 Test Acc: 0.653
Validation loss decreased (-0.543732 --> -0.653108).  Saving model ...
Epoch: 6 cost time: 0.4437873363494873
Epoch: 6, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.485 Vali Acc: 0.741 Test Loss: 1.485 Test Acc: 0.741
Validation loss decreased (-0.653108 --> -0.740610).  Saving model ...
Epoch: 7 cost time: 0.4848787784576416
Epoch: 7, Steps: 8 | Train Loss: 1.314 Vali Loss: 1.295 Vali Acc: 0.784 Test Loss: 1.295 Test Acc: 0.784
Validation loss decreased (-0.740610 --> -0.784362).  Saving model ...
Epoch: 8 cost time: 0.5157864093780518
Epoch: 8, Steps: 8 | Train Loss: 1.138 Vali Loss: 1.102 Vali Acc: 0.800 Test Loss: 1.102 Test Acc: 0.800
Validation loss decreased (-0.784362 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.5574536323547363
Epoch: 9, Steps: 8 | Train Loss: 0.943 Vali Loss: 0.925 Vali Acc: 0.803 Test Loss: 0.925 Test Acc: 0.803
Validation loss decreased (-0.799989 --> -0.803116).  Saving model ...
Epoch: 10 cost time: 0.49863100051879883
Epoch: 10, Steps: 8 | Train Loss: 0.746 Vali Loss: 0.779 Vali Acc: 0.819 Test Loss: 0.779 Test Acc: 0.819
Validation loss decreased (-0.803116 --> -0.818742).  Saving model ...
Epoch: 11 cost time: 0.5751438140869141
Epoch: 11, Steps: 8 | Train Loss: 0.617 Vali Loss: 0.670 Vali Acc: 0.831 Test Loss: 0.670 Test Acc: 0.831
Validation loss decreased (-0.818742 --> -0.831243).  Saving model ...
Epoch: 12 cost time: 0.5429069995880127
Epoch: 12, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.600 Vali Acc: 0.834 Test Loss: 0.600 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 0.492295503616333
Epoch: 13, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.4824411869049072
Epoch: 14, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.49788689613342285
Epoch: 15, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.5252068042755127
Epoch: 16, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 17 cost time: 0.510753870010376
Epoch: 17, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 0.48856687545776367
Epoch: 18, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 19 cost time: 0.5333375930786133
Epoch: 19, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.517998218536377
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5930135250091553
Epoch: 21, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.447 Vali Acc: 0.847 Test Loss: 0.447 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4795534610748291
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.45424938201904297
Epoch: 23, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5861806869506836
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.526653528213501
Epoch: 25, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5062382221221924
Epoch: 26, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4602394104003906
Epoch: 27, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.46323394775390625
Epoch: 28, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 59688
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.632284164428711
Epoch: 1, Steps: 8 | Train Loss: 2.077 Vali Loss: 2.084 Vali Acc: 0.159 Test Loss: 2.084 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.5364811420440674
Epoch: 2, Steps: 8 | Train Loss: 2.046 Vali Loss: 2.045 Vali Acc: 0.212 Test Loss: 2.045 Test Acc: 0.212
Validation loss decreased (-0.159354 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 0.506364107131958
Epoch: 3, Steps: 8 | Train Loss: 1.964 Vali Loss: 1.975 Vali Acc: 0.362 Test Loss: 1.975 Test Acc: 0.362
Validation loss decreased (-0.212480 --> -0.362480).  Saving model ...
Epoch: 4 cost time: 0.5132150650024414
Epoch: 4, Steps: 8 | Train Loss: 1.877 Vali Loss: 1.880 Vali Acc: 0.469 Test Loss: 1.880 Test Acc: 0.469
Validation loss decreased (-0.362480 --> -0.468731).  Saving model ...
Epoch: 5 cost time: 0.503122091293335
Epoch: 5, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.762 Vali Acc: 0.606 Test Loss: 1.762 Test Acc: 0.606
Validation loss decreased (-0.468731 --> -0.606232).  Saving model ...
Epoch: 6 cost time: 0.497730016708374
Epoch: 6, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.627 Vali Acc: 0.669 Test Loss: 1.627 Test Acc: 0.669
Validation loss decreased (-0.606232 --> -0.668734).  Saving model ...
Epoch: 7 cost time: 0.5410189628601074
Epoch: 7, Steps: 8 | Train Loss: 1.475 Vali Loss: 1.477 Vali Acc: 0.722 Test Loss: 1.477 Test Acc: 0.722
Validation loss decreased (-0.668734 --> -0.721860).  Saving model ...
Epoch: 8 cost time: 0.5153183937072754
Epoch: 8, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.314 Vali Acc: 0.747 Test Loss: 1.314 Test Acc: 0.747
Validation loss decreased (-0.721860 --> -0.746862).  Saving model ...
Epoch: 9 cost time: 0.468613862991333
Epoch: 9, Steps: 8 | Train Loss: 1.151 Vali Loss: 1.151 Vali Acc: 0.772 Test Loss: 1.151 Test Acc: 0.772
Validation loss decreased (-0.746862 --> -0.771863).  Saving model ...
Epoch: 10 cost time: 0.4718813896179199
Epoch: 10, Steps: 8 | Train Loss: 0.996 Vali Loss: 0.995 Vali Acc: 0.784 Test Loss: 0.995 Test Acc: 0.784
Validation loss decreased (-0.771863 --> -0.784365).  Saving model ...
Epoch: 11 cost time: 0.46051788330078125
Epoch: 11, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.860 Vali Acc: 0.791 Test Loss: 0.860 Test Acc: 0.791
Validation loss decreased (-0.784365 --> -0.790616).  Saving model ...
Epoch: 12 cost time: 0.5643832683563232
Epoch: 12, Steps: 8 | Train Loss: 0.672 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.790616 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 0.4994497299194336
Epoch: 13, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
Validation loss decreased (-0.799993 --> -0.815618).  Saving model ...
Epoch: 14 cost time: 0.5262753963470459
Epoch: 14, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.611 Vali Acc: 0.819 Test Loss: 0.611 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 15 cost time: 0.5196573734283447
Epoch: 15, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 0.5205934047698975
Epoch: 16, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 0.48503637313842773
Epoch: 17, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 0.49657535552978516
Epoch: 18, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.5285000801086426
Epoch: 19, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5247244834899902
Epoch: 20, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4908182621002197
Epoch: 21, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5302300453186035
Epoch: 22, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5739760398864746
Epoch: 23, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.500147819519043
Epoch: 24, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.482 Vali Acc: 0.834 Test Loss: 0.482 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5363810062408447
Epoch: 25, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5155901908874512
Epoch: 26, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.474 Vali Acc: 0.834 Test Loss: 0.474 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.499619722366333
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5206499099731445
Epoch: 28, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 55592
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6575117111206055
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 2.088 Vali Acc: 0.150 Test Loss: 2.088 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 0.5182199478149414
Epoch: 2, Steps: 8 | Train Loss: 2.078 Vali Loss: 2.055 Vali Acc: 0.188 Test Loss: 2.055 Test Acc: 0.188
Validation loss decreased (-0.149979 --> -0.187479).  Saving model ...
Epoch: 3 cost time: 0.46936559677124023
Epoch: 3, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.998 Vali Acc: 0.247 Test Loss: 1.998 Test Acc: 0.247
Validation loss decreased (-0.187479 --> -0.246855).  Saving model ...
Epoch: 4 cost time: 0.5012283325195312
Epoch: 4, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.921 Vali Acc: 0.344 Test Loss: 1.921 Test Acc: 0.344
Validation loss decreased (-0.246855 --> -0.343731).  Saving model ...
Epoch: 5 cost time: 0.4707152843475342
Epoch: 5, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.829 Vali Acc: 0.484 Test Loss: 1.829 Test Acc: 0.484
Validation loss decreased (-0.343731 --> -0.484357).  Saving model ...
Epoch: 6 cost time: 0.4472179412841797
Epoch: 6, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.722 Vali Acc: 0.591 Test Loss: 1.722 Test Acc: 0.591
Validation loss decreased (-0.484357 --> -0.590608).  Saving model ...
Epoch: 7 cost time: 0.5153098106384277
Epoch: 7, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.602 Vali Acc: 0.647 Test Loss: 1.602 Test Acc: 0.647
Validation loss decreased (-0.590608 --> -0.646859).  Saving model ...
Epoch: 8 cost time: 0.5474107265472412
Epoch: 8, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.468 Vali Acc: 0.697 Test Loss: 1.468 Test Acc: 0.697
Validation loss decreased (-0.646859 --> -0.696860).  Saving model ...
Epoch: 9 cost time: 0.4691593647003174
Epoch: 9, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.329 Vali Acc: 0.741 Test Loss: 1.329 Test Acc: 0.741
Validation loss decreased (-0.696860 --> -0.740612).  Saving model ...
Epoch: 10 cost time: 0.4523956775665283
Epoch: 10, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.188 Vali Acc: 0.787 Test Loss: 1.188 Test Acc: 0.787
Validation loss decreased (-0.740612 --> -0.787488).  Saving model ...
Epoch: 11 cost time: 0.44166111946105957
Epoch: 11, Steps: 8 | Train Loss: 1.089 Vali Loss: 1.054 Vali Acc: 0.800 Test Loss: 1.054 Test Acc: 0.800
Validation loss decreased (-0.787488 --> -0.799989).  Saving model ...
Epoch: 12 cost time: 0.5517768859863281
Epoch: 12, Steps: 8 | Train Loss: 0.912 Vali Loss: 0.929 Vali Acc: 0.812 Test Loss: 0.929 Test Acc: 0.812
Validation loss decreased (-0.799989 --> -0.812491).  Saving model ...
Epoch: 13 cost time: 0.4398155212402344
Epoch: 13, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.821 Vali Acc: 0.812 Test Loss: 0.821 Test Acc: 0.812
Validation loss decreased (-0.812491 --> -0.812492).  Saving model ...
Epoch: 14 cost time: 0.42919087409973145
Epoch: 14, Steps: 8 | Train Loss: 0.712 Vali Loss: 0.729 Vali Acc: 0.819 Test Loss: 0.729 Test Acc: 0.819
Validation loss decreased (-0.812492 --> -0.818743).  Saving model ...
Epoch: 15 cost time: 0.4235038757324219
Epoch: 15, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.663 Vali Acc: 0.819 Test Loss: 0.663 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818743).  Saving model ...
Epoch: 16 cost time: 0.5136375427246094
Epoch: 16, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 17 cost time: 0.46599435806274414
Epoch: 17, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 18 cost time: 0.4983839988708496
Epoch: 18, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 19 cost time: 0.5270576477050781
Epoch: 19, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 20 cost time: 0.5232188701629639
Epoch: 20, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 0.4927246570587158
Epoch: 21, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 22 cost time: 0.5481142997741699
Epoch: 22, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 0.5182995796203613
Epoch: 23, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 0.50101637840271
Epoch: 24, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 0.548792839050293
Epoch: 25, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5524120330810547
Epoch: 26, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846871).  Saving model ...
Epoch: 27 cost time: 0.5005619525909424
Epoch: 27, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
Validation loss decreased (-0.846871 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 0.5734677314758301
Epoch: 28, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.443 Vali Acc: 0.859 Test Loss: 0.443 Test Acc: 0.859
Validation loss decreased (-0.849996 --> -0.859371).  Saving model ...
Epoch: 29 cost time: 0.5345325469970703
Epoch: 29, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5270168781280518
Epoch: 30, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4982438087463379
Epoch: 31, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.49135589599609375
Epoch: 32, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5289549827575684
Epoch: 33, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5231311321258545
Epoch: 34, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5331611633300781
Epoch: 35, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.456 Vali Acc: 0.859 Test Loss: 0.456 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.47608518600463867
Epoch: 36, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.453 Vali Acc: 0.859 Test Loss: 0.453 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.49619030952453613
Epoch: 37, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.49706268310546875
Epoch: 38, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 53000
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4742202758789062
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 2.088 Vali Acc: 0.128 Test Loss: 2.088 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 0.497495174407959
Epoch: 2, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.060 Vali Acc: 0.144 Test Loss: 2.060 Test Acc: 0.144
Validation loss decreased (-0.128104 --> -0.143729).  Saving model ...
Epoch: 3 cost time: 0.5821187496185303
Epoch: 3, Steps: 8 | Train Loss: 2.008 Vali Loss: 2.010 Vali Acc: 0.206 Test Loss: 2.010 Test Acc: 0.206
Validation loss decreased (-0.143729 --> -0.206230).  Saving model ...
Epoch: 4 cost time: 0.4595022201538086
Epoch: 4, Steps: 8 | Train Loss: 1.930 Vali Loss: 1.941 Vali Acc: 0.312 Test Loss: 1.941 Test Acc: 0.312
Validation loss decreased (-0.206230 --> -0.312481).  Saving model ...
Epoch: 5 cost time: 0.4760603904724121
Epoch: 5, Steps: 8 | Train Loss: 1.839 Vali Loss: 1.860 Vali Acc: 0.447 Test Loss: 1.860 Test Acc: 0.447
Validation loss decreased (-0.312481 --> -0.446856).  Saving model ...
Epoch: 6 cost time: 0.46202850341796875
Epoch: 6, Steps: 8 | Train Loss: 1.761 Vali Loss: 1.767 Vali Acc: 0.556 Test Loss: 1.767 Test Acc: 0.556
Validation loss decreased (-0.446856 --> -0.556232).  Saving model ...
Epoch: 7 cost time: 0.5601153373718262
Epoch: 7, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.671 Vali Acc: 0.609 Test Loss: 1.671 Test Acc: 0.609
Validation loss decreased (-0.556232 --> -0.609358).  Saving model ...
Epoch: 8 cost time: 0.4793741703033447
Epoch: 8, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.562 Vali Acc: 0.688 Test Loss: 1.562 Test Acc: 0.688
Validation loss decreased (-0.609358 --> -0.687484).  Saving model ...
Epoch: 9 cost time: 0.44086718559265137
Epoch: 9, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.444 Vali Acc: 0.709 Test Loss: 1.444 Test Acc: 0.709
Validation loss decreased (-0.687484 --> -0.709361).  Saving model ...
Epoch: 10 cost time: 0.5751004219055176
Epoch: 10, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.329 Vali Acc: 0.725 Test Loss: 1.329 Test Acc: 0.725
Validation loss decreased (-0.709361 --> -0.724987).  Saving model ...
Epoch: 11 cost time: 0.5029175281524658
Epoch: 11, Steps: 8 | Train Loss: 1.214 Vali Loss: 1.213 Vali Acc: 0.753 Test Loss: 1.213 Test Acc: 0.753
Validation loss decreased (-0.724987 --> -0.753113).  Saving model ...
Epoch: 12 cost time: 0.46619153022766113
Epoch: 12, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.095 Vali Acc: 0.772 Test Loss: 1.095 Test Acc: 0.772
Validation loss decreased (-0.753113 --> -0.771864).  Saving model ...
Epoch: 13 cost time: 0.6055459976196289
Epoch: 13, Steps: 8 | Train Loss: 0.940 Vali Loss: 0.987 Vali Acc: 0.791 Test Loss: 0.987 Test Acc: 0.791
Validation loss decreased (-0.771864 --> -0.790615).  Saving model ...
Epoch: 14 cost time: 0.5143847465515137
Epoch: 14, Steps: 8 | Train Loss: 0.879 Vali Loss: 0.892 Vali Acc: 0.797 Test Loss: 0.892 Test Acc: 0.797
Validation loss decreased (-0.790615 --> -0.796866).  Saving model ...
Epoch: 15 cost time: 0.48685598373413086
Epoch: 15, Steps: 8 | Train Loss: 0.721 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
Validation loss decreased (-0.796866 --> -0.803117).  Saving model ...
Epoch: 16 cost time: 0.4529991149902344
Epoch: 16, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.742 Vali Acc: 0.806 Test Loss: 0.742 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 17 cost time: 0.48284435272216797
Epoch: 17, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809368).  Saving model ...
Epoch: 18 cost time: 0.46689343452453613
Epoch: 18, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 19 cost time: 0.43856310844421387
Epoch: 19, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 20 cost time: 0.5381693840026855
Epoch: 20, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.559 Vali Acc: 0.834 Test Loss: 0.559 Test Acc: 0.834
Validation loss decreased (-0.818744 --> -0.834369).  Saving model ...
Epoch: 21 cost time: 0.5656938552856445
Epoch: 21, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 22 cost time: 0.5272464752197266
Epoch: 22, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 0.5162861347198486
Epoch: 23, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.49235105514526367
Epoch: 24, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 25 cost time: 0.510033130645752
Epoch: 25, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 26 cost time: 0.4624602794647217
Epoch: 26, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 27 cost time: 0.519132137298584
Epoch: 27, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5079143047332764
Epoch: 28, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.47934627532958984
Epoch: 29, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.439 Vali Acc: 0.841 Test Loss: 0.439 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4846057891845703
Epoch: 30, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.435 Vali Acc: 0.847 Test Loss: 0.435 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4506237506866455
Epoch: 31, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.433 Vali Acc: 0.847 Test Loss: 0.433 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.41302943229675293
Epoch: 32, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4377706050872803
Epoch: 33, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4445972442626953
Epoch: 34, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.429 Vali Acc: 0.847 Test Loss: 0.429 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5140464305877686
Epoch: 35, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.427 Vali Acc: 0.847 Test Loss: 0.427 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4539172649383545
Epoch: 36, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 51976
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.658212661743164
Epoch: 1, Steps: 8 | Train Loss: 1.833 Vali Loss: 1.497 Vali Acc: 0.719 Test Loss: 1.497 Test Acc: 0.719
Validation loss decreased (inf --> -0.718735).  Saving model ...
Epoch: 2 cost time: 0.559004545211792
Epoch: 2, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.565 Vali Acc: 0.834 Test Loss: 0.565 Test Acc: 0.834
Validation loss decreased (-0.718735 --> -0.834369).  Saving model ...
Epoch: 3 cost time: 0.5450589656829834
Epoch: 3, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840620).  Saving model ...
Epoch: 4 cost time: 0.6454296112060547
Epoch: 4, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5304975509643555
Epoch: 5, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.628 Vali Acc: 0.831 Test Loss: 0.628 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4817492961883545
Epoch: 6, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.687 Vali Acc: 0.812 Test Loss: 0.687 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4806387424468994
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.851 Vali Acc: 0.816 Test Loss: 0.851 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5692226886749268
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.917 Vali Acc: 0.809 Test Loss: 0.917 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5589590072631836
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.878 Vali Acc: 0.819 Test Loss: 0.878 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5769186019897461
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.834 Test Loss: 0.851 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5064871311187744
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.831 Test Loss: 0.844 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5911810398101807
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.841 Test Loss: 0.840 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5381226539611816
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.838 Test Loss: 0.844 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 900360
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6894595623016357
Epoch: 1, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.721 Vali Acc: 0.656 Test Loss: 1.721 Test Acc: 0.656
Validation loss decreased (inf --> -0.656233).  Saving model ...
Epoch: 2 cost time: 0.5212051868438721
Epoch: 2, Steps: 8 | Train Loss: 1.089 Vali Loss: 0.835 Vali Acc: 0.806 Test Loss: 0.835 Test Acc: 0.806
Validation loss decreased (-0.656233 --> -0.806242).  Saving model ...
Epoch: 3 cost time: 0.5808236598968506
Epoch: 3, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.514 Vali Acc: 0.859 Test Loss: 0.514 Test Acc: 0.859
Validation loss decreased (-0.806242 --> -0.859370).  Saving model ...
Epoch: 4 cost time: 0.5549328327178955
Epoch: 4, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5140578746795654
Epoch: 5, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5034909248352051
Epoch: 6, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5924255847930908
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5249605178833008
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5602915287017822
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5377943515777588
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5825376510620117
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.831 Test Loss: 0.647 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5248680114746094
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.834 Test Loss: 0.649 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5073990821838379
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.834 Test Loss: 0.657 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 662792
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6599433422088623
Epoch: 1, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.800 Vali Acc: 0.537 Test Loss: 1.800 Test Acc: 0.537
Validation loss decreased (inf --> -0.537482).  Saving model ...
Epoch: 2 cost time: 0.4489104747772217
Epoch: 2, Steps: 8 | Train Loss: 1.268 Vali Loss: 1.100 Vali Acc: 0.778 Test Loss: 1.100 Test Acc: 0.778
Validation loss decreased (-0.537482 --> -0.778114).  Saving model ...
Epoch: 3 cost time: 0.5246798992156982
Epoch: 3, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
Validation loss decreased (-0.778114 --> -0.843744).  Saving model ...
Epoch: 4 cost time: 0.5923366546630859
Epoch: 4, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.476 Vali Acc: 0.863 Test Loss: 0.476 Test Acc: 0.863
Validation loss decreased (-0.843744 --> -0.862495).  Saving model ...
Epoch: 5 cost time: 0.4961097240447998
Epoch: 5, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.459 Vali Acc: 0.869 Test Loss: 0.459 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 6 cost time: 0.48102521896362305
Epoch: 6, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49220967292785645
Epoch: 7, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5559682846069336
Epoch: 8, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5363659858703613
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5693004131317139
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4871702194213867
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5680224895477295
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5536692142486572
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5020499229431152
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.576 Vali Acc: 0.831 Test Loss: 0.576 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5488536357879639
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 584968
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5762279033660889
Epoch: 1, Steps: 8 | Train Loss: 2.070 Vali Loss: 1.910 Vali Acc: 0.347 Test Loss: 1.910 Test Acc: 0.347
Validation loss decreased (inf --> -0.346856).  Saving model ...
Epoch: 2 cost time: 0.4714808464050293
Epoch: 2, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.287 Vali Acc: 0.797 Test Loss: 1.287 Test Acc: 0.797
Validation loss decreased (-0.346856 --> -0.796862).  Saving model ...
Epoch: 3 cost time: 0.47191905975341797
Epoch: 3, Steps: 8 | Train Loss: 0.777 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
Validation loss decreased (-0.796862 --> -0.824992).  Saving model ...
Epoch: 4 cost time: 0.49528074264526367
Epoch: 4, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
Validation loss decreased (-0.824992 --> -0.834370).  Saving model ...
Epoch: 5 cost time: 0.4625248908996582
Epoch: 5, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.449 Vali Acc: 0.869 Test Loss: 0.449 Test Acc: 0.869
Validation loss decreased (-0.834370 --> -0.868746).  Saving model ...
Epoch: 6 cost time: 0.48314476013183594
Epoch: 6, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.440 Vali Acc: 0.863 Test Loss: 0.440 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5173647403717041
Epoch: 7, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.448 Vali Acc: 0.838 Test Loss: 0.448 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5736312866210938
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.472 Vali Acc: 0.834 Test Loss: 0.472 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4770963191986084
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5407829284667969
Epoch: 10, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.46082425117492676
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.535663366317749
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.47313904762268066
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.48483967781066895
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4681117534637451
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 544008
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.546114206314087
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 1.969 Vali Acc: 0.259 Test Loss: 1.969 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 0.494565486907959
Epoch: 2, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.488 Vali Acc: 0.713 Test Loss: 1.488 Test Acc: 0.713
Validation loss decreased (-0.259355 --> -0.712485).  Saving model ...
Epoch: 3 cost time: 0.5583672523498535
Epoch: 3, Steps: 8 | Train Loss: 1.017 Vali Loss: 0.961 Vali Acc: 0.791 Test Loss: 0.961 Test Acc: 0.791
Validation loss decreased (-0.712485 --> -0.790615).  Saving model ...
Epoch: 4 cost time: 0.5443286895751953
Epoch: 4, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.638 Vali Acc: 0.825 Test Loss: 0.638 Test Acc: 0.825
Validation loss decreased (-0.790615 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.5294585227966309
Epoch: 5, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
Validation loss decreased (-0.824994 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.5172419548034668
Epoch: 6, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.5504050254821777
Epoch: 7, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5277109146118164
Epoch: 8, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.49881577491760254
Epoch: 9, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5027282238006592
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.502887487411499
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4966611862182617
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.492 Vali Acc: 0.834 Test Loss: 0.492 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.48938894271850586
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.48783063888549805
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.511960506439209
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5168037414550781
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 511240
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.500340461730957
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.991 Vali Acc: 0.159 Test Loss: 1.991 Test Acc: 0.159
Validation loss decreased (inf --> -0.159355).  Saving model ...
Epoch: 2 cost time: 0.4508020877838135
Epoch: 2, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.632 Vali Acc: 0.628 Test Loss: 1.632 Test Acc: 0.628
Validation loss decreased (-0.159355 --> -0.628109).  Saving model ...
Epoch: 3 cost time: 0.5243258476257324
Epoch: 3, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.190 Vali Acc: 0.772 Test Loss: 1.190 Test Acc: 0.772
Validation loss decreased (-0.628109 --> -0.771863).  Saving model ...
Epoch: 4 cost time: 0.5351338386535645
Epoch: 4, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.820 Vali Acc: 0.841 Test Loss: 0.820 Test Acc: 0.841
Validation loss decreased (-0.771863 --> -0.840617).  Saving model ...
Epoch: 5 cost time: 0.4875829219818115
Epoch: 5, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.618 Vali Acc: 0.838 Test Loss: 0.618 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4468090534210205
Epoch: 6, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.840617 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 0.5270829200744629
Epoch: 7, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.5456063747406006
Epoch: 8, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.448 Vali Acc: 0.866 Test Loss: 0.448 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865621).  Saving model ...
Epoch: 9 cost time: 0.5412743091583252
Epoch: 9, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.473818302154541
Epoch: 10, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5408182144165039
Epoch: 11, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5254073143005371
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5150072574615479
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5122015476226807
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4757218360900879
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.48765087127685547
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5283277034759521
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.46641039848327637
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 490504
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4715254306793213
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 2.061 Vali Acc: 0.072 Test Loss: 2.061 Test Acc: 0.072
Validation loss decreased (inf --> -0.071854).  Saving model ...
Epoch: 2 cost time: 0.4668457508087158
Epoch: 2, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.745 Vali Acc: 0.528 Test Loss: 1.745 Test Acc: 0.528
Validation loss decreased (-0.071854 --> -0.528108).  Saving model ...
Epoch: 3 cost time: 0.45061755180358887
Epoch: 3, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.318 Vali Acc: 0.756 Test Loss: 1.318 Test Acc: 0.756
Validation loss decreased (-0.528108 --> -0.756237).  Saving model ...
Epoch: 4 cost time: 0.5100126266479492
Epoch: 4, Steps: 8 | Train Loss: 0.978 Vali Loss: 0.956 Vali Acc: 0.803 Test Loss: 0.956 Test Acc: 0.803
Validation loss decreased (-0.756237 --> -0.803115).  Saving model ...
Epoch: 5 cost time: 0.4710252285003662
Epoch: 5, Steps: 8 | Train Loss: 0.694 Vali Loss: 0.716 Vali Acc: 0.812 Test Loss: 0.716 Test Acc: 0.812
Validation loss decreased (-0.803115 --> -0.812493).  Saving model ...
Epoch: 6 cost time: 0.49857378005981445
Epoch: 6, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.581 Vali Acc: 0.831 Test Loss: 0.581 Test Acc: 0.831
Validation loss decreased (-0.812493 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.48288631439208984
Epoch: 7, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.4530608654022217
Epoch: 8, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.4568216800689697
Epoch: 9, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.5027246475219727
Epoch: 10, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.494368314743042
Epoch: 11, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 0.45322227478027344
Epoch: 12, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 0.46106529235839844
Epoch: 13, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
Validation loss decreased (-0.849996 --> -0.853121).  Saving model ...
Epoch: 14 cost time: 0.4271695613861084
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
Validation loss decreased (-0.853121 --> -0.859371).  Saving model ...
Epoch: 15 cost time: 0.49907827377319336
Epoch: 15, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.442 Vali Acc: 0.856 Test Loss: 0.442 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4655485153198242
Epoch: 16, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4420957565307617
Epoch: 17, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.444 Vali Acc: 0.856 Test Loss: 0.444 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5052683353424072
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.45126867294311523
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.46671485900878906
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4559149742126465
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.49846577644348145
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.466815710067749
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4661285877227783
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 482312
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7019340991973877
Epoch: 1, Steps: 8 | Train Loss: 2.025 Vali Loss: 1.736 Vali Acc: 0.600 Test Loss: 1.736 Test Acc: 0.600
Validation loss decreased (inf --> -0.599983).  Saving model ...
Epoch: 2 cost time: 0.4770622253417969
Epoch: 2, Steps: 8 | Train Loss: 1.045 Vali Loss: 0.890 Vali Acc: 0.797 Test Loss: 0.890 Test Acc: 0.797
Validation loss decreased (-0.599983 --> -0.796866).  Saving model ...
Epoch: 3 cost time: 0.4855821132659912
Epoch: 3, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
Validation loss decreased (-0.796866 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 0.5253064632415771
Epoch: 4, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
Validation loss decreased (-0.837495 --> -0.862495).  Saving model ...
Epoch: 5 cost time: 0.4653205871582031
Epoch: 5, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.45545363426208496
Epoch: 6, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4165182113647461
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.644 Vali Acc: 0.828 Test Loss: 0.644 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.49231505393981934
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4741225242614746
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.825 Test Loss: 0.615 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.48240208625793457
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4643564224243164
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5117571353912354
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4722318649291992
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.666 Vali Acc: 0.831 Test Loss: 0.666 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4733917713165283
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.825 Test Loss: 0.674 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 351880
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5670197010040283
Epoch: 1, Steps: 8 | Train Loss: 2.047 Vali Loss: 1.885 Vali Acc: 0.397 Test Loss: 1.885 Test Acc: 0.397
Validation loss decreased (inf --> -0.396856).  Saving model ...
Epoch: 2 cost time: 0.5461628437042236
Epoch: 2, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.281 Vali Acc: 0.809 Test Loss: 1.281 Test Acc: 0.809
Validation loss decreased (-0.396856 --> -0.809362).  Saving model ...
Epoch: 3 cost time: 0.4524705410003662
Epoch: 3, Steps: 8 | Train Loss: 0.747 Vali Loss: 0.752 Vali Acc: 0.853 Test Loss: 0.752 Test Acc: 0.853
Validation loss decreased (-0.809362 --> -0.853117).  Saving model ...
Epoch: 4 cost time: 0.45427417755126953
Epoch: 4, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
Validation loss decreased (-0.853117 --> -0.862495).  Saving model ...
Epoch: 5 cost time: 0.48101806640625
Epoch: 5, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.475 Vali Acc: 0.863 Test Loss: 0.475 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 6 cost time: 0.44737863540649414
Epoch: 6, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.480 Vali Acc: 0.834 Test Loss: 0.480 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4827697277069092
Epoch: 7, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5203900337219238
Epoch: 8, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.47239160537719727
Epoch: 9, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.48050880432128906
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.47397875785827637
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5760421752929688
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.513946533203125
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.540691614151001
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.561 Vali Acc: 0.828 Test Loss: 0.561 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5345859527587891
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 233096
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5771818161010742
Epoch: 1, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.929 Vali Acc: 0.297 Test Loss: 1.929 Test Acc: 0.297
Validation loss decreased (inf --> -0.296856).  Saving model ...
Epoch: 2 cost time: 0.46234726905822754
Epoch: 2, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.484 Vali Acc: 0.734 Test Loss: 1.484 Test Acc: 0.734
Validation loss decreased (-0.296856 --> -0.734360).  Saving model ...
Epoch: 3 cost time: 0.5296971797943115
Epoch: 3, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.993 Vali Acc: 0.794 Test Loss: 0.993 Test Acc: 0.794
Validation loss decreased (-0.734360 --> -0.793740).  Saving model ...
Epoch: 4 cost time: 0.4895048141479492
Epoch: 4, Steps: 8 | Train Loss: 0.617 Vali Loss: 0.685 Vali Acc: 0.822 Test Loss: 0.685 Test Acc: 0.822
Validation loss decreased (-0.793740 --> -0.821868).  Saving model ...
Epoch: 5 cost time: 0.46543002128601074
Epoch: 5, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.821868 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.5217287540435791
Epoch: 6, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 0.49770689010620117
Epoch: 7, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.460 Vali Acc: 0.859 Test Loss: 0.460 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4925038814544678
Epoch: 8, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4016997814178467
Epoch: 9, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.523212194442749
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.473 Vali Acc: 0.831 Test Loss: 0.473 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5026683807373047
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.480 Vali Acc: 0.828 Test Loss: 0.480 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.49800539016723633
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.45794057846069336
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5010650157928467
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5090880393981934
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.45419788360595703
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 194184
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4745662212371826
Epoch: 1, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.921 Vali Acc: 0.344 Test Loss: 1.921 Test Acc: 0.344
Validation loss decreased (inf --> -0.343731).  Saving model ...
Epoch: 2 cost time: 0.43960022926330566
Epoch: 2, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.556 Vali Acc: 0.644 Test Loss: 1.556 Test Acc: 0.644
Validation loss decreased (-0.343731 --> -0.643734).  Saving model ...
Epoch: 3 cost time: 0.47916150093078613
Epoch: 3, Steps: 8 | Train Loss: 1.107 Vali Loss: 1.126 Vali Acc: 0.753 Test Loss: 1.126 Test Acc: 0.753
Validation loss decreased (-0.643734 --> -0.753114).  Saving model ...
Epoch: 4 cost time: 0.44126200675964355
Epoch: 4, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.787 Vali Acc: 0.806 Test Loss: 0.787 Test Acc: 0.806
Validation loss decreased (-0.753114 --> -0.806242).  Saving model ...
Epoch: 5 cost time: 0.4735755920410156
Epoch: 5, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
Validation loss decreased (-0.806242 --> -0.856244).  Saving model ...
Epoch: 6 cost time: 0.44866394996643066
Epoch: 6, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4796631336212158
Epoch: 7, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.477 Vali Acc: 0.859 Test Loss: 0.477 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.45870065689086914
Epoch: 8, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5028688907623291
Epoch: 9, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.479 Vali Acc: 0.853 Test Loss: 0.479 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4205803871154785
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4391815662384033
Epoch: 11, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.45733022689819336
Epoch: 12, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.46710848808288574
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.43695712089538574
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4189605712890625
Epoch: 15, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.49085545539855957
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.497 Vali Acc: 0.834 Test Loss: 0.497 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4639284610748291
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.502 Vali Acc: 0.834 Test Loss: 0.502 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 173704
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4254827499389648
Epoch: 1, Steps: 8 | Train Loss: 2.140 Vali Loss: 2.032 Vali Acc: 0.259 Test Loss: 2.032 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 0.38136887550354004
Epoch: 2, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.769 Vali Acc: 0.438 Test Loss: 1.769 Test Acc: 0.438
Validation loss decreased (-0.259355 --> -0.437482).  Saving model ...
Epoch: 3 cost time: 0.4029042720794678
Epoch: 3, Steps: 8 | Train Loss: 1.465 Vali Loss: 1.392 Vali Acc: 0.662 Test Loss: 1.392 Test Acc: 0.662
Validation loss decreased (-0.437482 --> -0.662486).  Saving model ...
Epoch: 4 cost time: 0.40345215797424316
Epoch: 4, Steps: 8 | Train Loss: 1.026 Vali Loss: 1.032 Vali Acc: 0.787 Test Loss: 1.032 Test Acc: 0.787
Validation loss decreased (-0.662486 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 0.47704124450683594
Epoch: 5, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.771 Vali Acc: 0.797 Test Loss: 0.771 Test Acc: 0.797
Validation loss decreased (-0.787490 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 0.43553972244262695
Epoch: 6, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
Validation loss decreased (-0.796867 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.48564577102661133
Epoch: 7, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.4127628803253174
Epoch: 8, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.41309261322021484
Epoch: 9, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.39455366134643555
Epoch: 10, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.3880484104156494
Epoch: 11, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.438870906829834
Epoch: 12, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.35126233100891113
Epoch: 13, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.39109349250793457
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.35553765296936035
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.44365859031677246
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4157602787017822
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.37226057052612305
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4351029396057129
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.37949252128601074
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.473 Vali Acc: 0.847 Test Loss: 0.473 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.447554349899292
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4136502742767334
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 157320
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.3971068859100342
Epoch: 1, Steps: 8 | Train Loss: 1.950 Vali Loss: 1.939 Vali Acc: 0.291 Test Loss: 1.939 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 0.4167296886444092
Epoch: 2, Steps: 8 | Train Loss: 1.758 Vali Loss: 1.745 Vali Acc: 0.469 Test Loss: 1.745 Test Acc: 0.469
Validation loss decreased (-0.290606 --> -0.468733).  Saving model ...
Epoch: 3 cost time: 0.3666257858276367
Epoch: 3, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.460 Vali Acc: 0.669 Test Loss: 1.460 Test Acc: 0.669
Validation loss decreased (-0.468733 --> -0.668735).  Saving model ...
Epoch: 4 cost time: 0.4439120292663574
Epoch: 4, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.164 Vali Acc: 0.756 Test Loss: 1.164 Test Acc: 0.756
Validation loss decreased (-0.668735 --> -0.756238).  Saving model ...
Epoch: 5 cost time: 0.4061112403869629
Epoch: 5, Steps: 8 | Train Loss: 0.856 Vali Loss: 0.923 Vali Acc: 0.800 Test Loss: 0.923 Test Acc: 0.800
Validation loss decreased (-0.756238 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 0.4311845302581787
Epoch: 6, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.749 Vali Acc: 0.806 Test Loss: 0.749 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.806243).  Saving model ...
Epoch: 7 cost time: 0.41620969772338867
Epoch: 7, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.636 Vali Acc: 0.841 Test Loss: 0.636 Test Acc: 0.841
Validation loss decreased (-0.806243 --> -0.840619).  Saving model ...
Epoch: 8 cost time: 0.43479418754577637
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.3990206718444824
Epoch: 9, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.524 Vali Acc: 0.847 Test Loss: 0.524 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.38105344772338867
Epoch: 10, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.46160340309143066
Epoch: 11, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.4906916618347168
Epoch: 12, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4366872310638428
Epoch: 13, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.466 Vali Acc: 0.838 Test Loss: 0.466 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.408527135848999
Epoch: 14, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6048581600189209
Epoch: 15, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4190094470977783
Epoch: 16, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4466667175292969
Epoch: 17, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.451 Vali Acc: 0.838 Test Loss: 0.451 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4006226062774658
Epoch: 18, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.35429978370666504
Epoch: 19, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.450 Vali Acc: 0.844 Test Loss: 0.450 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.41747093200683594
Epoch: 20, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.453 Vali Acc: 0.838 Test Loss: 0.453 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.40061497688293457
Epoch: 21, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.445 Vali Acc: 0.847 Test Loss: 0.445 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 146952
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6046783924102783
Epoch: 1, Steps: 8 | Train Loss: 2.040 Vali Loss: 2.006 Vali Acc: 0.222 Test Loss: 2.006 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 0.45780062675476074
Epoch: 2, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.839 Vali Acc: 0.453 Test Loss: 1.839 Test Acc: 0.453
Validation loss decreased (-0.221855 --> -0.453107).  Saving model ...
Epoch: 3 cost time: 0.4714803695678711
Epoch: 3, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.592 Vali Acc: 0.672 Test Loss: 1.592 Test Acc: 0.672
Validation loss decreased (-0.453107 --> -0.671859).  Saving model ...
Epoch: 4 cost time: 0.4653651714324951
Epoch: 4, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.317 Vali Acc: 0.750 Test Loss: 1.317 Test Acc: 0.750
Validation loss decreased (-0.671859 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 0.42892909049987793
Epoch: 5, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.072 Vali Acc: 0.816 Test Loss: 1.072 Test Acc: 0.816
Validation loss decreased (-0.749987 --> -0.815614).  Saving model ...
Epoch: 6 cost time: 0.473583459854126
Epoch: 6, Steps: 8 | Train Loss: 0.827 Vali Loss: 0.882 Vali Acc: 0.822 Test Loss: 0.882 Test Acc: 0.822
Validation loss decreased (-0.815614 --> -0.821866).  Saving model ...
Epoch: 7 cost time: 0.4430527687072754
Epoch: 7, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.741 Vali Acc: 0.841 Test Loss: 0.741 Test Acc: 0.841
Validation loss decreased (-0.821866 --> -0.840618).  Saving model ...
Epoch: 8 cost time: 0.46749091148376465
Epoch: 8, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.650 Vali Acc: 0.838 Test Loss: 0.650 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4499073028564453
Epoch: 9, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.840618 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 0.44715356826782227
Epoch: 10, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.538 Vali Acc: 0.853 Test Loss: 0.538 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.46842408180236816
Epoch: 11, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.510 Vali Acc: 0.859 Test Loss: 0.510 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 0.425839900970459
Epoch: 12, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4361145496368408
Epoch: 13, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.42990946769714355
Epoch: 14, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.4376711845397949
Epoch: 15, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4376039505004883
Epoch: 16, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859371).  Saving model ...
Epoch: 17 cost time: 0.4440934658050537
Epoch: 17, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46141719818115234
Epoch: 18, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4363973140716553
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.42383360862731934
Epoch: 20, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5038020610809326
Epoch: 21, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4839322566986084
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4899413585662842
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.47632336616516113
Epoch: 24, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
Validation loss decreased (-0.859371 --> -0.859371).  Saving model ...
Epoch: 25 cost time: 0.49573564529418945
Epoch: 25, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4825570583343506
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.438 Vali Acc: 0.853 Test Loss: 0.438 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.44148969650268555
Epoch: 27, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5345664024353027
Epoch: 28, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.441 Vali Acc: 0.853 Test Loss: 0.441 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4530622959136963
Epoch: 29, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4558138847351074
Epoch: 30, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.443 Vali Acc: 0.853 Test Loss: 0.443 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4597923755645752
Epoch: 31, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.4766066074371338
Epoch: 32, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5258655548095703
Epoch: 33, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4493227005004883
Epoch: 34, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 142856
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4696059226989746
Epoch: 1, Steps: 8 | Train Loss: 2.086 Vali Loss: 1.868 Vali Acc: 0.412 Test Loss: 1.868 Test Acc: 0.412
Validation loss decreased (inf --> -0.412481).  Saving model ...
Epoch: 2 cost time: 0.41732192039489746
Epoch: 2, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.276 Vali Acc: 0.756 Test Loss: 1.276 Test Acc: 0.756
Validation loss decreased (-0.412481 --> -0.756237).  Saving model ...
Epoch: 3 cost time: 0.3992948532104492
Epoch: 3, Steps: 8 | Train Loss: 0.778 Vali Loss: 0.779 Vali Acc: 0.819 Test Loss: 0.779 Test Acc: 0.819
Validation loss decreased (-0.756237 --> -0.818742).  Saving model ...
Epoch: 4 cost time: 0.40432214736938477
Epoch: 4, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.561 Vali Acc: 0.847 Test Loss: 0.561 Test Acc: 0.847
Validation loss decreased (-0.818742 --> -0.846869).  Saving model ...
Epoch: 5 cost time: 0.39766979217529297
Epoch: 5, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 0.44868922233581543
Epoch: 6, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.40772151947021484
Epoch: 7, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.447293758392334
Epoch: 8, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.43177127838134766
Epoch: 9, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4079592227935791
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.43770313262939453
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.40734386444091797
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4332275390625
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4339921474456787
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4448728561401367
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5029573440551758
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.452350378036499
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 151368
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6060211658477783
Epoch: 1, Steps: 8 | Train Loss: 2.180 Vali Loss: 2.011 Vali Acc: 0.241 Test Loss: 2.011 Test Acc: 0.241
Validation loss decreased (inf --> -0.240605).  Saving model ...
Epoch: 2 cost time: 0.5024473667144775
Epoch: 2, Steps: 8 | Train Loss: 1.767 Vali Loss: 1.657 Vali Acc: 0.634 Test Loss: 1.657 Test Acc: 0.634
Validation loss decreased (-0.240605 --> -0.634358).  Saving model ...
Epoch: 3 cost time: 0.4522240161895752
Epoch: 3, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.187 Vali Acc: 0.797 Test Loss: 1.187 Test Acc: 0.797
Validation loss decreased (-0.634358 --> -0.796863).  Saving model ...
Epoch: 4 cost time: 0.45698046684265137
Epoch: 4, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.801 Vali Acc: 0.806 Test Loss: 0.801 Test Acc: 0.806
Validation loss decreased (-0.796863 --> -0.806242).  Saving model ...
Epoch: 5 cost time: 0.39977312088012695
Epoch: 5, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.606 Vali Acc: 0.838 Test Loss: 0.606 Test Acc: 0.838
Validation loss decreased (-0.806242 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.48956298828125
Epoch: 6, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.4883415699005127
Epoch: 7, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.4063291549682617
Epoch: 8, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.46324825286865234
Epoch: 9, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4918384552001953
Epoch: 10, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.462954044342041
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4951329231262207
Epoch: 12, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.482 Vali Acc: 0.831 Test Loss: 0.482 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4212026596069336
Epoch: 13, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4261784553527832
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4705789089202881
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.46529555320739746
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4274909496307373
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.46656012535095215
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 91976
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4475681781768799
Epoch: 1, Steps: 8 | Train Loss: 2.153 Vali Loss: 2.044 Vali Acc: 0.203 Test Loss: 2.044 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 0.5711922645568848
Epoch: 2, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.827 Vali Acc: 0.412 Test Loss: 1.827 Test Acc: 0.412
Validation loss decreased (-0.203105 --> -0.412482).  Saving model ...
Epoch: 3 cost time: 0.4878239631652832
Epoch: 3, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.483 Vali Acc: 0.681 Test Loss: 1.483 Test Acc: 0.681
Validation loss decreased (-0.412482 --> -0.681235).  Saving model ...
Epoch: 4 cost time: 0.518214225769043
Epoch: 4, Steps: 8 | Train Loss: 1.095 Vali Loss: 1.123 Vali Acc: 0.800 Test Loss: 1.123 Test Acc: 0.800
Validation loss decreased (-0.681235 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 0.4514904022216797
Epoch: 5, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.844 Vali Acc: 0.825 Test Loss: 0.844 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 0.4710521697998047
Epoch: 6, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.659 Vali Acc: 0.834 Test Loss: 0.659 Test Acc: 0.834
Validation loss decreased (-0.824992 --> -0.834368).  Saving model ...
Epoch: 7 cost time: 0.4062044620513916
Epoch: 7, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843744).  Saving model ...
Epoch: 8 cost time: 0.46216368675231934
Epoch: 8, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.41898250579833984
Epoch: 9, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.42130160331726074
Epoch: 10, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.469008207321167
Epoch: 11, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3929448127746582
Epoch: 12, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.48452043533325195
Epoch: 13, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.495 Vali Acc: 0.834 Test Loss: 0.495 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4586775302886963
Epoch: 14, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.42361879348754883
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.45249342918395996
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.42586255073547363
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.48897671699523926
Epoch: 18, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.40941905975341797
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 72520
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4523591995239258
Epoch: 1, Steps: 8 | Train Loss: 2.079 Vali Loss: 2.037 Vali Acc: 0.244 Test Loss: 2.037 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 0.42502450942993164
Epoch: 2, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.851 Vali Acc: 0.422 Test Loss: 1.851 Test Acc: 0.422
Validation loss decreased (-0.243730 --> -0.421856).  Saving model ...
Epoch: 3 cost time: 0.44811320304870605
Epoch: 3, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.560 Vali Acc: 0.566 Test Loss: 1.560 Test Acc: 0.566
Validation loss decreased (-0.421856 --> -0.565609).  Saving model ...
Epoch: 4 cost time: 0.4459514617919922
Epoch: 4, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.240 Vali Acc: 0.762 Test Loss: 1.240 Test Acc: 0.762
Validation loss decreased (-0.565609 --> -0.762488).  Saving model ...
Epoch: 5 cost time: 0.45040273666381836
Epoch: 5, Steps: 8 | Train Loss: 0.933 Vali Loss: 0.970 Vali Acc: 0.800 Test Loss: 0.970 Test Acc: 0.800
Validation loss decreased (-0.762488 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.43478894233703613
Epoch: 6, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
Validation loss decreased (-0.799990 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.44708800315856934
Epoch: 7, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.646 Vali Acc: 0.834 Test Loss: 0.646 Test Acc: 0.834
Validation loss decreased (-0.803117 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 0.49196887016296387
Epoch: 8, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 0.4757699966430664
Epoch: 9, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.44428110122680664
Epoch: 10, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4280128479003906
Epoch: 11, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.4588608741760254
Epoch: 12, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.4380350112915039
Epoch: 13, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45076966285705566
Epoch: 14, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.44358277320861816
Epoch: 15, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.471 Vali Acc: 0.834 Test Loss: 0.471 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5013906955718994
Epoch: 16, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4029698371887207
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.467 Vali Acc: 0.838 Test Loss: 0.467 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.43947315216064453
Epoch: 18, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4009068012237549
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.43538403511047363
Epoch: 20, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.39789891242980957
Epoch: 21, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.44455623626708984
Epoch: 22, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 62280
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6474833488464355
Epoch: 1, Steps: 8 | Train Loss: 2.201 Vali Loss: 2.091 Vali Acc: 0.097 Test Loss: 2.091 Test Acc: 0.097
Validation loss decreased (inf --> -0.096854).  Saving model ...
Epoch: 2 cost time: 0.4350452423095703
Epoch: 2, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.953 Vali Acc: 0.250 Test Loss: 1.953 Test Acc: 0.250
Validation loss decreased (-0.096854 --> -0.249980).  Saving model ...
Epoch: 3 cost time: 0.46491122245788574
Epoch: 3, Steps: 8 | Train Loss: 1.783 Vali Loss: 1.726 Vali Acc: 0.528 Test Loss: 1.726 Test Acc: 0.528
Validation loss decreased (-0.249980 --> -0.528108).  Saving model ...
Epoch: 4 cost time: 0.4762904644012451
Epoch: 4, Steps: 8 | Train Loss: 1.481 Vali Loss: 1.462 Vali Acc: 0.672 Test Loss: 1.462 Test Acc: 0.672
Validation loss decreased (-0.528108 --> -0.671860).  Saving model ...
Epoch: 5 cost time: 0.4116251468658447
Epoch: 5, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.206 Vali Acc: 0.769 Test Loss: 1.206 Test Acc: 0.769
Validation loss decreased (-0.671860 --> -0.768738).  Saving model ...
Epoch: 6 cost time: 0.44972944259643555
Epoch: 6, Steps: 8 | Train Loss: 0.987 Vali Loss: 0.995 Vali Acc: 0.803 Test Loss: 0.995 Test Acc: 0.803
Validation loss decreased (-0.768738 --> -0.803115).  Saving model ...
Epoch: 7 cost time: 0.43386220932006836
Epoch: 7, Steps: 8 | Train Loss: 0.783 Vali Loss: 0.833 Vali Acc: 0.806 Test Loss: 0.833 Test Acc: 0.806
Validation loss decreased (-0.803115 --> -0.806242).  Saving model ...
Epoch: 8 cost time: 0.4219932556152344
Epoch: 8, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.711 Vali Acc: 0.831 Test Loss: 0.711 Test Acc: 0.831
Validation loss decreased (-0.806242 --> -0.831243).  Saving model ...
Epoch: 9 cost time: 0.420320987701416
Epoch: 9, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
Validation loss decreased (-0.831243 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.45922088623046875
Epoch: 10, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.574 Vali Acc: 0.853 Test Loss: 0.574 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853119).  Saving model ...
Epoch: 11 cost time: 0.4288644790649414
Epoch: 11, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.41094970703125
Epoch: 12, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3741154670715332
Epoch: 13, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.44772791862487793
Epoch: 14, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.4591364860534668
Epoch: 15, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4598805904388428
Epoch: 16, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 0.4791867733001709
Epoch: 17, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46872973442077637
Epoch: 18, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4538695812225342
Epoch: 19, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 20 cost time: 0.44744014739990234
Epoch: 20, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.44819092750549316
Epoch: 21, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4633626937866211
Epoch: 22, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.41725873947143555
Epoch: 23, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4441814422607422
Epoch: 24, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4609806537628174
Epoch: 25, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.47776269912719727
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.43248605728149414
Epoch: 27, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5069952011108398
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4607124328613281
Epoch: 29, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 54088
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5219526290893555
Epoch: 1, Steps: 8 | Train Loss: 2.043 Vali Loss: 2.022 Vali Acc: 0.253 Test Loss: 2.022 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 0.42940378189086914
Epoch: 2, Steps: 8 | Train Loss: 1.934 Vali Loss: 1.914 Vali Acc: 0.309 Test Loss: 1.914 Test Acc: 0.309
Validation loss decreased (-0.253105 --> -0.309356).  Saving model ...
Epoch: 3 cost time: 0.4854929447174072
Epoch: 3, Steps: 8 | Train Loss: 1.761 Vali Loss: 1.744 Vali Acc: 0.475 Test Loss: 1.744 Test Acc: 0.475
Validation loss decreased (-0.309356 --> -0.474983).  Saving model ...
Epoch: 4 cost time: 0.4717848300933838
Epoch: 4, Steps: 8 | Train Loss: 1.566 Vali Loss: 1.540 Vali Acc: 0.694 Test Loss: 1.540 Test Acc: 0.694
Validation loss decreased (-0.474983 --> -0.693735).  Saving model ...
Epoch: 5 cost time: 0.4968085289001465
Epoch: 5, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.330 Vali Acc: 0.756 Test Loss: 1.330 Test Acc: 0.756
Validation loss decreased (-0.693735 --> -0.756237).  Saving model ...
Epoch: 6 cost time: 0.4217512607574463
Epoch: 6, Steps: 8 | Train Loss: 1.157 Vali Loss: 1.142 Vali Acc: 0.784 Test Loss: 1.142 Test Acc: 0.784
Validation loss decreased (-0.756237 --> -0.784364).  Saving model ...
Epoch: 7 cost time: 0.4240086078643799
Epoch: 7, Steps: 8 | Train Loss: 0.964 Vali Loss: 0.982 Vali Acc: 0.816 Test Loss: 0.982 Test Acc: 0.816
Validation loss decreased (-0.784364 --> -0.815615).  Saving model ...
Epoch: 8 cost time: 0.4571821689605713
Epoch: 8, Steps: 8 | Train Loss: 0.824 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.815615 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.4043772220611572
Epoch: 9, Steps: 8 | Train Loss: 0.680 Vali Loss: 0.759 Vali Acc: 0.838 Test Loss: 0.759 Test Acc: 0.838
Validation loss decreased (-0.824991 --> -0.837492).  Saving model ...
Epoch: 10 cost time: 0.41014528274536133
Epoch: 10, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.43302178382873535
Epoch: 11, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4126880168914795
Epoch: 12, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
Validation loss decreased (-0.837492 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 0.38075876235961914
Epoch: 13, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.862494).  Saving model ...
Epoch: 14 cost time: 0.39752864837646484
Epoch: 14, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.536 Vali Acc: 0.853 Test Loss: 0.536 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3907594680786133
Epoch: 15, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.521 Vali Acc: 0.853 Test Loss: 0.521 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4066627025604248
Epoch: 16, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4308202266693115
Epoch: 17, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.490 Vali Acc: 0.859 Test Loss: 0.490 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.42298030853271484
Epoch: 18, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.482 Vali Acc: 0.866 Test Loss: 0.482 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 0.432880163192749
Epoch: 19, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.469 Vali Acc: 0.859 Test Loss: 0.469 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.39531826972961426
Epoch: 20, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.44076085090637207
Epoch: 21, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.45468902587890625
Epoch: 22, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4315328598022461
Epoch: 23, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.44988465309143066
Epoch: 24, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.46815919876098633
Epoch: 25, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4993865489959717
Epoch: 26, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4652581214904785
Epoch: 27, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5052099227905273
Epoch: 28, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.441 Vali Acc: 0.844 Test Loss: 0.441 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 48904
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5900132656097412
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 2.020 Vali Acc: 0.244 Test Loss: 2.020 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 0.4345085620880127
Epoch: 2, Steps: 8 | Train Loss: 2.013 Vali Loss: 1.920 Vali Acc: 0.359 Test Loss: 1.920 Test Acc: 0.359
Validation loss decreased (-0.243730 --> -0.359356).  Saving model ...
Epoch: 3 cost time: 0.4694688320159912
Epoch: 3, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.772 Vali Acc: 0.506 Test Loss: 1.772 Test Acc: 0.506
Validation loss decreased (-0.359356 --> -0.506232).  Saving model ...
Epoch: 4 cost time: 0.42914390563964844
Epoch: 4, Steps: 8 | Train Loss: 1.674 Vali Loss: 1.595 Vali Acc: 0.628 Test Loss: 1.595 Test Acc: 0.628
Validation loss decreased (-0.506232 --> -0.628109).  Saving model ...
Epoch: 5 cost time: 0.39359593391418457
Epoch: 5, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.419 Vali Acc: 0.713 Test Loss: 1.419 Test Acc: 0.713
Validation loss decreased (-0.628109 --> -0.712486).  Saving model ...
Epoch: 6 cost time: 0.45093560218811035
Epoch: 6, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.253 Vali Acc: 0.747 Test Loss: 1.253 Test Acc: 0.747
Validation loss decreased (-0.712486 --> -0.746862).  Saving model ...
Epoch: 7 cost time: 0.4412250518798828
Epoch: 7, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.103 Vali Acc: 0.816 Test Loss: 1.103 Test Acc: 0.816
Validation loss decreased (-0.746862 --> -0.815614).  Saving model ...
Epoch: 8 cost time: 0.45746684074401855
Epoch: 8, Steps: 8 | Train Loss: 0.949 Vali Loss: 0.976 Vali Acc: 0.822 Test Loss: 0.976 Test Acc: 0.822
Validation loss decreased (-0.815614 --> -0.821865).  Saving model ...
Epoch: 9 cost time: 0.449721097946167
Epoch: 9, Steps: 8 | Train Loss: 0.821 Vali Loss: 0.868 Vali Acc: 0.822 Test Loss: 0.868 Test Acc: 0.822
Validation loss decreased (-0.821865 --> -0.821866).  Saving model ...
Epoch: 10 cost time: 0.47847819328308105
Epoch: 10, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.782 Vali Acc: 0.825 Test Loss: 0.782 Test Acc: 0.825
Validation loss decreased (-0.821866 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.45502138137817383
Epoch: 11, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.715 Vali Acc: 0.828 Test Loss: 0.715 Test Acc: 0.828
Validation loss decreased (-0.824992 --> -0.828118).  Saving model ...
Epoch: 12 cost time: 0.369309663772583
Epoch: 12, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.417863130569458
Epoch: 13, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.625 Vali Acc: 0.825 Test Loss: 0.625 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3931148052215576
Epoch: 14, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4071388244628906
Epoch: 15, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 0.40116071701049805
Epoch: 16, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 17 cost time: 0.4428119659423828
Epoch: 17, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 0.5021634101867676
Epoch: 18, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 0.44135379791259766
Epoch: 19, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 0.37796688079833984
Epoch: 20, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 0.45264458656311035
Epoch: 21, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 0.4464690685272217
Epoch: 22, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 23 cost time: 0.40044546127319336
Epoch: 23, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 24 cost time: 0.4006376266479492
Epoch: 24, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 0.4379770755767822
Epoch: 25, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 0.39269185066223145
Epoch: 26, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.40223193168640137
Epoch: 27, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.3732273578643799
Epoch: 28, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4221186637878418
Epoch: 29, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 30 cost time: 0.3857285976409912
Epoch: 30, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 31 cost time: 0.4158473014831543
Epoch: 31, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.38106751441955566
Epoch: 32, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5389719009399414
Epoch: 33, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.45130276679992676
Epoch: 34, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5113389492034912
Epoch: 35, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.40977025032043457
Epoch: 36, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.44626760482788086
Epoch: 37, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.39859962463378906
Epoch: 38, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4691765308380127
Epoch: 39, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.43824172019958496
Epoch: 40, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 46856
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.496565818786621
Epoch: 1, Steps: 8 | Train Loss: 2.114 Vali Loss: 1.991 Vali Acc: 0.250 Test Loss: 1.991 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 0.4516127109527588
Epoch: 2, Steps: 8 | Train Loss: 1.725 Vali Loss: 1.631 Vali Acc: 0.547 Test Loss: 1.631 Test Acc: 0.547
Validation loss decreased (-0.249980 --> -0.546859).  Saving model ...
Epoch: 3 cost time: 0.45519304275512695
Epoch: 3, Steps: 8 | Train Loss: 1.195 Vali Loss: 1.177 Vali Acc: 0.775 Test Loss: 1.177 Test Acc: 0.775
Validation loss decreased (-0.546859 --> -0.774988).  Saving model ...
Epoch: 4 cost time: 0.4519071578979492
Epoch: 4, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.818 Vali Acc: 0.803 Test Loss: 0.818 Test Acc: 0.803
Validation loss decreased (-0.774988 --> -0.803117).  Saving model ...
Epoch: 5 cost time: 0.4257023334503174
Epoch: 5, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.622 Vali Acc: 0.834 Test Loss: 0.622 Test Acc: 0.834
Validation loss decreased (-0.803117 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 0.5087635517120361
Epoch: 6, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
Validation loss decreased (-0.834369 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 0.4578697681427002
Epoch: 7, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4705507755279541
Epoch: 8, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4485471248626709
Epoch: 9, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.45183444023132324
Epoch: 10, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4682013988494873
Epoch: 11, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5081775188446045
Epoch: 12, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.45134830474853516
Epoch: 13, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4714198112487793
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5429880619049072
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.46492886543273926
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 69544
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.3556923866271973
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.026 Vali Acc: 0.234 Test Loss: 2.026 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.382080078125
Epoch: 2, Steps: 8 | Train Loss: 1.886 Vali Loss: 1.840 Vali Acc: 0.463 Test Loss: 1.840 Test Acc: 0.463
Validation loss decreased (-0.234355 --> -0.462482).  Saving model ...
Epoch: 3 cost time: 0.3914053440093994
Epoch: 3, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.556 Vali Acc: 0.669 Test Loss: 1.556 Test Acc: 0.669
Validation loss decreased (-0.462482 --> -0.668734).  Saving model ...
Epoch: 4 cost time: 0.385847806930542
Epoch: 4, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.242 Vali Acc: 0.756 Test Loss: 1.242 Test Acc: 0.756
Validation loss decreased (-0.668734 --> -0.756238).  Saving model ...
Epoch: 5 cost time: 0.48883056640625
Epoch: 5, Steps: 8 | Train Loss: 0.966 Vali Loss: 0.982 Vali Acc: 0.791 Test Loss: 0.982 Test Acc: 0.791
Validation loss decreased (-0.756238 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 0.39664387702941895
Epoch: 6, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.783 Vali Acc: 0.812 Test Loss: 0.783 Test Acc: 0.812
Validation loss decreased (-0.790615 --> -0.812492).  Saving model ...
Epoch: 7 cost time: 0.39859652519226074
Epoch: 7, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 0.4065582752227783
Epoch: 8, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
Validation loss decreased (-0.821868 --> -0.853119).  Saving model ...
Epoch: 9 cost time: 0.40094947814941406
Epoch: 9, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.411761999130249
Epoch: 10, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.4315321445465088
Epoch: 11, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4671900272369385
Epoch: 12, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.40178394317626953
Epoch: 13, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4100801944732666
Epoch: 14, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4005253314971924
Epoch: 15, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.41683268547058105
Epoch: 16, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4147164821624756
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.41533398628234863
Epoch: 18, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3862016201019287
Epoch: 19, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.3645319938659668
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4360024929046631
Epoch: 21, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4147348403930664
Epoch: 22, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 39848
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4013912677764893
Epoch: 1, Steps: 8 | Train Loss: 2.175 Vali Loss: 2.085 Vali Acc: 0.131 Test Loss: 2.085 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.41983938217163086
Epoch: 2, Steps: 8 | Train Loss: 2.083 Vali Loss: 1.984 Vali Acc: 0.209 Test Loss: 1.984 Test Acc: 0.209
Validation loss decreased (-0.131229 --> -0.209355).  Saving model ...
Epoch: 3 cost time: 0.4141254425048828
Epoch: 3, Steps: 8 | Train Loss: 1.839 Vali Loss: 1.799 Vali Acc: 0.459 Test Loss: 1.799 Test Acc: 0.459
Validation loss decreased (-0.209355 --> -0.459357).  Saving model ...
Epoch: 4 cost time: 0.36917757987976074
Epoch: 4, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.558 Vali Acc: 0.675 Test Loss: 1.558 Test Acc: 0.675
Validation loss decreased (-0.459357 --> -0.674984).  Saving model ...
Epoch: 5 cost time: 0.3994007110595703
Epoch: 5, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.305 Vali Acc: 0.772 Test Loss: 1.305 Test Acc: 0.772
Validation loss decreased (-0.674984 --> -0.771862).  Saving model ...
Epoch: 6 cost time: 0.3919646739959717
Epoch: 6, Steps: 8 | Train Loss: 1.084 Vali Loss: 1.074 Vali Acc: 0.803 Test Loss: 1.074 Test Acc: 0.803
Validation loss decreased (-0.771862 --> -0.803114).  Saving model ...
Epoch: 7 cost time: 0.4238877296447754
Epoch: 7, Steps: 8 | Train Loss: 0.859 Vali Loss: 0.892 Vali Acc: 0.819 Test Loss: 0.892 Test Acc: 0.819
Validation loss decreased (-0.803114 --> -0.818741).  Saving model ...
Epoch: 8 cost time: 0.40825939178466797
Epoch: 8, Steps: 8 | Train Loss: 0.698 Vali Loss: 0.762 Vali Acc: 0.828 Test Loss: 0.762 Test Acc: 0.828
Validation loss decreased (-0.818741 --> -0.828117).  Saving model ...
Epoch: 9 cost time: 0.4176025390625
Epoch: 9, Steps: 8 | Train Loss: 0.575 Vali Loss: 0.663 Vali Acc: 0.841 Test Loss: 0.663 Test Acc: 0.841
Validation loss decreased (-0.828117 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 0.4823324680328369
Epoch: 10, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
Validation loss decreased (-0.840618 --> -0.856244).  Saving model ...
Epoch: 11 cost time: 0.4025912284851074
Epoch: 11, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.41448092460632324
Epoch: 12, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4482107162475586
Epoch: 13, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4619638919830322
Epoch: 14, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.36357951164245605
Epoch: 15, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.436016321182251
Epoch: 16, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5294919013977051
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.43027710914611816
Epoch: 18, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4565873146057129
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4390869140625
Epoch: 20, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps24_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 30120
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.428652286529541
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 2.052 Vali Acc: 0.062 Test Loss: 2.052 Test Acc: 0.062
Validation loss decreased (inf --> -0.062479).  Saving model ...
Epoch: 2 cost time: 0.446927547454834
Epoch: 2, Steps: 8 | Train Loss: 2.059 Vali Loss: 1.970 Vali Acc: 0.156 Test Loss: 1.970 Test Acc: 0.156
Validation loss decreased (-0.062479 --> -0.156230).  Saving model ...
Epoch: 3 cost time: 0.4092731475830078
Epoch: 3, Steps: 8 | Train Loss: 1.836 Vali Loss: 1.820 Vali Acc: 0.375 Test Loss: 1.820 Test Acc: 0.375
Validation loss decreased (-0.156230 --> -0.374982).  Saving model ...
Epoch: 4 cost time: 0.40231895446777344
Epoch: 4, Steps: 8 | Train Loss: 1.630 Vali Loss: 1.622 Vali Acc: 0.613 Test Loss: 1.622 Test Acc: 0.613
Validation loss decreased (-0.374982 --> -0.612484).  Saving model ...
Epoch: 5 cost time: 0.45862770080566406
Epoch: 5, Steps: 8 | Train Loss: 1.444 Vali Loss: 1.414 Vali Acc: 0.697 Test Loss: 1.414 Test Acc: 0.697
Validation loss decreased (-0.612484 --> -0.696861).  Saving model ...
Epoch: 6 cost time: 0.43195414543151855
Epoch: 6, Steps: 8 | Train Loss: 1.212 Vali Loss: 1.217 Vali Acc: 0.753 Test Loss: 1.217 Test Acc: 0.753
Validation loss decreased (-0.696861 --> -0.753113).  Saving model ...
Epoch: 7 cost time: 0.47031307220458984
Epoch: 7, Steps: 8 | Train Loss: 1.020 Vali Loss: 1.042 Vali Acc: 0.775 Test Loss: 1.042 Test Acc: 0.775
Validation loss decreased (-0.753113 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.381711483001709
Epoch: 8, Steps: 8 | Train Loss: 0.841 Vali Loss: 0.903 Vali Acc: 0.784 Test Loss: 0.903 Test Acc: 0.784
Validation loss decreased (-0.774990 --> -0.784366).  Saving model ...
Epoch: 9 cost time: 0.4911770820617676
Epoch: 9, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.793 Vali Acc: 0.794 Test Loss: 0.793 Test Acc: 0.794
Validation loss decreased (-0.784366 --> -0.793742).  Saving model ...
Epoch: 10 cost time: 0.41400909423828125
Epoch: 10, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
Validation loss decreased (-0.793742 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 0.3935859203338623
Epoch: 11, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821868).  Saving model ...
Epoch: 12 cost time: 0.40270280838012695
Epoch: 12, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 0.4014568328857422
Epoch: 13, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 14 cost time: 0.4192342758178711
Epoch: 14, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.565 Vali Acc: 0.838 Test Loss: 0.565 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 0.42319369316101074
Epoch: 15, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 0.501960277557373
Epoch: 16, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 0.44564104080200195
Epoch: 17, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5172305107116699
Epoch: 18, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.45252203941345215
Epoch: 19, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4280726909637451
Epoch: 20, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.45604681968688965
Epoch: 21, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.418365478515625
Epoch: 22, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4599881172180176
Epoch: 23, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4542865753173828
Epoch: 24, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.485 Vali Acc: 0.834 Test Loss: 0.485 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.41538095474243164
Epoch: 25, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.485 Vali Acc: 0.834 Test Loss: 0.485 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.48520541191101074
Epoch: 26, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.485 Vali Acc: 0.831 Test Loss: 0.485 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps32_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 25000
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.516442060470581
Epoch: 1, Steps: 8 | Train Loss: 2.258 Vali Loss: 2.137 Vali Acc: 0.087 Test Loss: 2.137 Test Acc: 0.087
Validation loss decreased (inf --> -0.087479).  Saving model ...
Epoch: 2 cost time: 0.38526344299316406
Epoch: 2, Steps: 8 | Train Loss: 2.152 Vali Loss: 2.077 Vali Acc: 0.141 Test Loss: 2.077 Test Acc: 0.141
Validation loss decreased (-0.087479 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 0.3848884105682373
Epoch: 3, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.965 Vali Acc: 0.237 Test Loss: 1.965 Test Acc: 0.237
Validation loss decreased (-0.140604 --> -0.237480).  Saving model ...
Epoch: 4 cost time: 0.477872371673584
Epoch: 4, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.815 Vali Acc: 0.391 Test Loss: 1.815 Test Acc: 0.391
Validation loss decreased (-0.237480 --> -0.390607).  Saving model ...
Epoch: 5 cost time: 0.3763439655303955
Epoch: 5, Steps: 8 | Train Loss: 1.674 Vali Loss: 1.641 Vali Acc: 0.562 Test Loss: 1.641 Test Acc: 0.562
Validation loss decreased (-0.390607 --> -0.562484).  Saving model ...
Epoch: 6 cost time: 0.3775801658630371
Epoch: 6, Steps: 8 | Train Loss: 1.480 Vali Loss: 1.462 Vali Acc: 0.675 Test Loss: 1.462 Test Acc: 0.675
Validation loss decreased (-0.562484 --> -0.674985).  Saving model ...
Epoch: 7 cost time: 0.3631894588470459
Epoch: 7, Steps: 8 | Train Loss: 1.297 Vali Loss: 1.298 Vali Acc: 0.719 Test Loss: 1.298 Test Acc: 0.719
Validation loss decreased (-0.674985 --> -0.718737).  Saving model ...
Epoch: 8 cost time: 0.39508724212646484
Epoch: 8, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.150 Vali Acc: 0.747 Test Loss: 1.150 Test Acc: 0.747
Validation loss decreased (-0.718737 --> -0.746863).  Saving model ...
Epoch: 9 cost time: 0.3629903793334961
Epoch: 9, Steps: 8 | Train Loss: 0.984 Vali Loss: 1.019 Vali Acc: 0.794 Test Loss: 1.019 Test Acc: 0.794
Validation loss decreased (-0.746863 --> -0.793740).  Saving model ...
Epoch: 10 cost time: 0.38306593894958496
Epoch: 10, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.911 Vali Acc: 0.819 Test Loss: 0.911 Test Acc: 0.819
Validation loss decreased (-0.793740 --> -0.818741).  Saving model ...
Epoch: 11 cost time: 0.3327372074127197
Epoch: 11, Steps: 8 | Train Loss: 0.696 Vali Loss: 0.819 Vali Acc: 0.816 Test Loss: 0.819 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.37868213653564453
Epoch: 12, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.745 Vali Acc: 0.822 Test Loss: 0.745 Test Acc: 0.822
Validation loss decreased (-0.818741 --> -0.821868).  Saving model ...
Epoch: 13 cost time: 0.39536428451538086
Epoch: 13, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.689 Vali Acc: 0.831 Test Loss: 0.689 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831243).  Saving model ...
Epoch: 14 cost time: 0.3240547180175781
Epoch: 14, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.650 Vali Acc: 0.831 Test Loss: 0.650 Test Acc: 0.831
Validation loss decreased (-0.831243 --> -0.831243).  Saving model ...
Epoch: 15 cost time: 0.34474778175354004
Epoch: 15, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
Validation loss decreased (-0.831243 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 0.36449670791625977
Epoch: 16, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.591 Vali Acc: 0.838 Test Loss: 0.591 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 17 cost time: 0.45406007766723633
Epoch: 17, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846869).  Saving model ...
Epoch: 18 cost time: 0.38240647315979004
Epoch: 18, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 0.36869239807128906
Epoch: 19, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 0.3679234981536865
Epoch: 20, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.521 Vali Acc: 0.853 Test Loss: 0.521 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 0.35946178436279297
Epoch: 21, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 22 cost time: 0.36423635482788086
Epoch: 22, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 23 cost time: 0.3813176155090332
Epoch: 23, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.494 Vali Acc: 0.863 Test Loss: 0.494 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 24 cost time: 0.37078094482421875
Epoch: 24, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.491 Vali Acc: 0.859 Test Loss: 0.491 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.36301493644714355
Epoch: 25, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.36930227279663086
Epoch: 26, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.36818933486938477
Epoch: 27, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.3483920097351074
Epoch: 28, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.3361823558807373
Epoch: 29, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.36206769943237305
Epoch: 30, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.39452171325683594
Epoch: 31, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.39162230491638184
Epoch: 32, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.37253761291503906
Epoch: 33, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps48_str24_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 20904
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5866246223449707
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 2.063 Vali Acc: 0.222 Test Loss: 2.063 Test Acc: 0.222
Validation loss decreased (inf --> -0.221854).  Saving model ...
Epoch: 2 cost time: 0.4025754928588867
Epoch: 2, Steps: 8 | Train Loss: 2.057 Vali Loss: 2.009 Vali Acc: 0.256 Test Loss: 2.009 Test Acc: 0.256
Validation loss decreased (-0.221854 --> -0.256230).  Saving model ...
Epoch: 3 cost time: 0.3839421272277832
Epoch: 3, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.919 Vali Acc: 0.300 Test Loss: 1.919 Test Acc: 0.300
Validation loss decreased (-0.256230 --> -0.299981).  Saving model ...
Epoch: 4 cost time: 0.4012632369995117
Epoch: 4, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.804 Vali Acc: 0.412 Test Loss: 1.804 Test Acc: 0.412
Validation loss decreased (-0.299981 --> -0.412482).  Saving model ...
Epoch: 5 cost time: 0.43788623809814453
Epoch: 5, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.678 Vali Acc: 0.541 Test Loss: 1.678 Test Acc: 0.541
Validation loss decreased (-0.412482 --> -0.540608).  Saving model ...
Epoch: 6 cost time: 0.39983439445495605
Epoch: 6, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.544 Vali Acc: 0.606 Test Loss: 1.544 Test Acc: 0.606
Validation loss decreased (-0.540608 --> -0.606235).  Saving model ...
Epoch: 7 cost time: 0.4069645404815674
Epoch: 7, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.412 Vali Acc: 0.700 Test Loss: 1.412 Test Acc: 0.700
Validation loss decreased (-0.606235 --> -0.699986).  Saving model ...
Epoch: 8 cost time: 0.4757273197174072
Epoch: 8, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.280 Vali Acc: 0.734 Test Loss: 1.280 Test Acc: 0.734
Validation loss decreased (-0.699986 --> -0.734362).  Saving model ...
Epoch: 9 cost time: 0.40211033821105957
Epoch: 9, Steps: 8 | Train Loss: 1.145 Vali Loss: 1.156 Vali Acc: 0.781 Test Loss: 1.156 Test Acc: 0.781
Validation loss decreased (-0.734362 --> -0.781238).  Saving model ...
Epoch: 10 cost time: 0.4273824691772461
Epoch: 10, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.046 Vali Acc: 0.787 Test Loss: 1.046 Test Acc: 0.787
Validation loss decreased (-0.781238 --> -0.787490).  Saving model ...
Epoch: 11 cost time: 0.41190338134765625
Epoch: 11, Steps: 8 | Train Loss: 0.908 Vali Loss: 0.950 Vali Acc: 0.806 Test Loss: 0.950 Test Acc: 0.806
Validation loss decreased (-0.787490 --> -0.806241).  Saving model ...
Epoch: 12 cost time: 0.4135000705718994
Epoch: 12, Steps: 8 | Train Loss: 0.801 Vali Loss: 0.871 Vali Acc: 0.812 Test Loss: 0.871 Test Acc: 0.812
Validation loss decreased (-0.806241 --> -0.812491).  Saving model ...
Epoch: 13 cost time: 0.44728827476501465
Epoch: 13, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.804 Vali Acc: 0.822 Test Loss: 0.804 Test Acc: 0.822
Validation loss decreased (-0.812491 --> -0.821867).  Saving model ...
Epoch: 14 cost time: 0.425952672958374
Epoch: 14, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.750 Vali Acc: 0.828 Test Loss: 0.750 Test Acc: 0.828
Validation loss decreased (-0.821867 --> -0.828117).  Saving model ...
Epoch: 15 cost time: 0.4578676223754883
Epoch: 15, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.706 Vali Acc: 0.838 Test Loss: 0.706 Test Acc: 0.838
Validation loss decreased (-0.828117 --> -0.837493).  Saving model ...
Epoch: 16 cost time: 0.40148186683654785
Epoch: 16, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.667 Vali Acc: 0.838 Test Loss: 0.667 Test Acc: 0.838
Validation loss decreased (-0.837493 --> -0.837493).  Saving model ...
Epoch: 17 cost time: 0.39205265045166016
Epoch: 17, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.638 Vali Acc: 0.834 Test Loss: 0.638 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.42545104026794434
Epoch: 18, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.610 Vali Acc: 0.838 Test Loss: 0.610 Test Acc: 0.838
Validation loss decreased (-0.837493 --> -0.837494).  Saving model ...
Epoch: 19 cost time: 0.41420555114746094
Epoch: 19, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853119).  Saving model ...
Epoch: 20 cost time: 0.47289013862609863
Epoch: 20, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.570 Vali Acc: 0.853 Test Loss: 0.570 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853119).  Saving model ...
Epoch: 21 cost time: 0.42568159103393555
Epoch: 21, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3907465934753418
Epoch: 22, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4184579849243164
Epoch: 23, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.38457798957824707
Epoch: 24, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4334750175476074
Epoch: 25, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.37338805198669434
Epoch: 26, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.40256166458129883
Epoch: 27, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.45295023918151855
Epoch: 28, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4484403133392334
Epoch: 29, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4044349193572998
Epoch: 30, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 18312
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.3538885116577148
Epoch: 1, Steps: 8 | Train Loss: 2.317 Vali Loss: 2.165 Vali Acc: 0.159 Test Loss: 2.165 Test Acc: 0.159
Validation loss decreased (inf --> -0.159353).  Saving model ...
Epoch: 2 cost time: 0.4551432132720947
Epoch: 2, Steps: 8 | Train Loss: 2.279 Vali Loss: 2.131 Vali Acc: 0.181 Test Loss: 2.131 Test Acc: 0.181
Validation loss decreased (-0.159353 --> -0.181229).  Saving model ...
Epoch: 3 cost time: 0.4009413719177246
Epoch: 3, Steps: 8 | Train Loss: 2.131 Vali Loss: 2.057 Vali Acc: 0.228 Test Loss: 2.057 Test Acc: 0.228
Validation loss decreased (-0.181229 --> -0.228104).  Saving model ...
Epoch: 4 cost time: 0.42713356018066406
Epoch: 4, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.944 Vali Acc: 0.309 Test Loss: 1.944 Test Acc: 0.309
Validation loss decreased (-0.228104 --> -0.309356).  Saving model ...
Epoch: 5 cost time: 0.49504828453063965
Epoch: 5, Steps: 8 | Train Loss: 1.893 Vali Loss: 1.812 Vali Acc: 0.425 Test Loss: 1.812 Test Acc: 0.425
Validation loss decreased (-0.309356 --> -0.424982).  Saving model ...
Epoch: 6 cost time: 0.4010429382324219
Epoch: 6, Steps: 8 | Train Loss: 1.721 Vali Loss: 1.677 Vali Acc: 0.534 Test Loss: 1.677 Test Acc: 0.534
Validation loss decreased (-0.424982 --> -0.534358).  Saving model ...
Epoch: 7 cost time: 0.4931635856628418
Epoch: 7, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.540 Vali Acc: 0.622 Test Loss: 1.540 Test Acc: 0.622
Validation loss decreased (-0.534358 --> -0.621860).  Saving model ...
Epoch: 8 cost time: 0.4291369915008545
Epoch: 8, Steps: 8 | Train Loss: 1.452 Vali Loss: 1.411 Vali Acc: 0.678 Test Loss: 1.411 Test Acc: 0.678
Validation loss decreased (-0.621860 --> -0.678111).  Saving model ...
Epoch: 9 cost time: 0.41167283058166504
Epoch: 9, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.294 Vali Acc: 0.744 Test Loss: 1.294 Test Acc: 0.744
Validation loss decreased (-0.678111 --> -0.743737).  Saving model ...
Epoch: 10 cost time: 0.40957140922546387
Epoch: 10, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.185 Vali Acc: 0.781 Test Loss: 1.185 Test Acc: 0.781
Validation loss decreased (-0.743737 --> -0.781238).  Saving model ...
Epoch: 11 cost time: 0.41405439376831055
Epoch: 11, Steps: 8 | Train Loss: 1.079 Vali Loss: 1.088 Vali Acc: 0.797 Test Loss: 1.088 Test Acc: 0.797
Validation loss decreased (-0.781238 --> -0.796864).  Saving model ...
Epoch: 12 cost time: 0.4431335926055908
Epoch: 12, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.001 Vali Acc: 0.812 Test Loss: 1.001 Test Acc: 0.812
Validation loss decreased (-0.796864 --> -0.812490).  Saving model ...
Epoch: 13 cost time: 0.38935041427612305
Epoch: 13, Steps: 8 | Train Loss: 0.868 Vali Loss: 0.927 Vali Acc: 0.819 Test Loss: 0.927 Test Acc: 0.819
Validation loss decreased (-0.812490 --> -0.818741).  Saving model ...
Epoch: 14 cost time: 0.48189353942871094
Epoch: 14, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.865 Vali Acc: 0.828 Test Loss: 0.865 Test Acc: 0.828
Validation loss decreased (-0.818741 --> -0.828116).  Saving model ...
Epoch: 15 cost time: 0.40761327743530273
Epoch: 15, Steps: 8 | Train Loss: 0.740 Vali Loss: 0.808 Vali Acc: 0.834 Test Loss: 0.808 Test Acc: 0.834
Validation loss decreased (-0.828116 --> -0.834367).  Saving model ...
Epoch: 16 cost time: 0.4381382465362549
Epoch: 16, Steps: 8 | Train Loss: 0.651 Vali Loss: 0.765 Vali Acc: 0.834 Test Loss: 0.765 Test Acc: 0.834
Validation loss decreased (-0.834367 --> -0.834367).  Saving model ...
Epoch: 17 cost time: 0.41204094886779785
Epoch: 17, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.728 Vali Acc: 0.834 Test Loss: 0.728 Test Acc: 0.834
Validation loss decreased (-0.834367 --> -0.834368).  Saving model ...
Epoch: 18 cost time: 0.39078545570373535
Epoch: 18, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840618).  Saving model ...
Epoch: 19 cost time: 0.37259793281555176
Epoch: 19, Steps: 8 | Train Loss: 0.515 Vali Loss: 0.665 Vali Acc: 0.853 Test Loss: 0.665 Test Acc: 0.853
Validation loss decreased (-0.840618 --> -0.853118).  Saving model ...
Epoch: 20 cost time: 0.46408820152282715
Epoch: 20, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.640 Vali Acc: 0.863 Test Loss: 0.640 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862494).  Saving model ...
Epoch: 21 cost time: 0.36064887046813965
Epoch: 21, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.616 Vali Acc: 0.869 Test Loss: 0.616 Test Acc: 0.869
Validation loss decreased (-0.862494 --> -0.868744).  Saving model ...
Epoch: 22 cost time: 0.423358678817749
Epoch: 22, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871869).  Saving model ...
Epoch: 23 cost time: 0.39150547981262207
Epoch: 23, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.42691588401794434
Epoch: 24, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.570 Vali Acc: 0.869 Test Loss: 0.570 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4415411949157715
Epoch: 25, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.558 Vali Acc: 0.863 Test Loss: 0.558 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3678758144378662
Epoch: 26, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.544 Vali Acc: 0.866 Test Loss: 0.544 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4134864807128906
Epoch: 27, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4235413074493408
Epoch: 28, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.523 Vali Acc: 0.866 Test Loss: 0.523 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.40830516815185547
Epoch: 29, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4331777095794678
Epoch: 30, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.508 Vali Acc: 0.859 Test Loss: 0.508 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.43058300018310547
Epoch: 31, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.499 Vali Acc: 0.869 Test Loss: 0.499 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3715221881866455
Epoch: 32, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.489 Vali Acc: 0.869 Test Loss: 0.489 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ModernTCN_UEA_ftM_sl315_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps79_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 17288
model size : 0.08MB
