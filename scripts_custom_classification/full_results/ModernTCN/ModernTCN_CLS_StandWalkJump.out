Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8492579460144043
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.341510534286499
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3558652400970459
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3339197635650635
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.32973313331604004
Epoch: 5, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3372509479522705
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.34206223487854004
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.3385741710662842
Epoch: 8, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.34605884552001953
Epoch: 9, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.34606122970581055
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.34003138542175293
Epoch: 11, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.36482858657836914
Epoch: 12, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.3389890193939209
Epoch: 13, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.3294661045074463
Epoch: 14, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.38649702072143555
Epoch: 15, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.3251993656158447
Epoch: 16, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.3288114070892334
Epoch: 17, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.35680580139160156
Epoch: 18, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.3246607780456543
Epoch: 19, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.33918142318725586
Epoch: 20, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.33994078636169434
Epoch: 21, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.35721635818481445
Epoch: 22, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.3511183261871338
Epoch: 23, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.322176456451416
Epoch: 24, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4188711643218994
Epoch: 25, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3649430274963379
Epoch: 26, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.3502225875854492
Epoch: 27, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.35151028633117676
Epoch: 28, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.373859167098999
Epoch: 29, Steps: 1 | Train Loss: 0.235 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.35715413093566895
Epoch: 30, Steps: 1 | Train Loss: 0.210 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.3380577564239502
Epoch: 31, Steps: 1 | Train Loss: 0.201 Vali Loss: 0.999 Vali Acc: 0.400 Test Loss: 0.999 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.3805079460144043
Epoch: 32, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.000 Vali Acc: 0.400 Test Loss: 1.000 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.35770416259765625
Epoch: 33, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.001 Vali Acc: 0.400 Test Loss: 1.001 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.3619260787963867
Epoch: 34, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.3846726417541504
Epoch: 35, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.3286631107330322
Epoch: 36, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.389021635055542
Epoch: 37, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 799619
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5673346519470215
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3262162208557129
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3331260681152344
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.38455796241760254
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3506960868835449
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3970630168914795
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.38921689987182617
Epoch: 7, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3756825923919678
Epoch: 8, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.39673447608947754
Epoch: 9, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.34885454177856445
Epoch: 10, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4028923511505127
Epoch: 11, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4205441474914551
Epoch: 12, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.35211634635925293
Epoch: 13, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3952009677886963
Epoch: 14, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.37965917587280273
Epoch: 15, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.38771724700927734
Epoch: 16, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.35614943504333496
Epoch: 17, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.3827850818634033
Epoch: 18, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3276340961456299
Epoch: 19, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3500640392303467
Epoch: 20, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.37615394592285156
Epoch: 21, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.4071311950683594
Epoch: 22, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.35706377029418945
Epoch: 23, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.4836747646331787
Epoch: 24, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.40050411224365234
Epoch: 25, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.35568737983703613
Epoch: 26, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.36772823333740234
Epoch: 27, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.35943055152893066
Epoch: 28, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.3180203437805176
Epoch: 29, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.43540048599243164
Epoch: 30, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.3443117141723633
Epoch: 31, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 32 cost time: 0.3693222999572754
Epoch: 32, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.35430288314819336
Epoch: 33, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4230165481567383
Epoch: 34, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.3469820022583008
Epoch: 35, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.4028182029724121
Epoch: 36, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.3526785373687744
Epoch: 37, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.3370804786682129
Epoch: 38, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.3970506191253662
Epoch: 39, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.35901308059692383
Epoch: 40, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.41443800926208496
Epoch: 41, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 786243
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8061888217926025
Epoch: 1, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.37415266036987305
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.38469934463500977
Epoch: 3, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.38130664825439453
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.36524224281311035
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.39446210861206055
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.3630344867706299
Epoch: 7, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.36893343925476074
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.3478679656982422
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.3565249443054199
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.33252859115600586
Epoch: 11, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.39824628829956055
Epoch: 12, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.4124126434326172
Epoch: 13, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.3529541492462158
Epoch: 14, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.42365407943725586
Epoch: 15, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.38068270683288574
Epoch: 16, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.3539144992828369
Epoch: 17, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 18 cost time: 0.4065895080566406
Epoch: 18, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 19 cost time: 0.41187381744384766
Epoch: 19, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 0.6010887622833252
Epoch: 20, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.40015411376953125
Epoch: 21, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.47907209396362305
Epoch: 22, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 23 cost time: 0.34933948516845703
Epoch: 23, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.028 Vali Acc: 0.333 Test Loss: 1.028 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3656132221221924
Epoch: 24, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.026 Vali Acc: 0.333 Test Loss: 1.026 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3421452045440674
Epoch: 25, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.025 Vali Acc: 0.333 Test Loss: 1.025 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.42644357681274414
Epoch: 26, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.023 Vali Acc: 0.333 Test Loss: 1.023 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.42332959175109863
Epoch: 27, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.021 Vali Acc: 0.333 Test Loss: 1.021 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.40642213821411133
Epoch: 28, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.020 Vali Acc: 0.333 Test Loss: 1.020 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.42044639587402344
Epoch: 29, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.018 Vali Acc: 0.333 Test Loss: 1.018 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4183483123779297
Epoch: 30, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.017 Vali Acc: 0.333 Test Loss: 1.017 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.46754026412963867
Epoch: 31, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.016 Vali Acc: 0.333 Test Loss: 1.016 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3549184799194336
Epoch: 32, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.015 Vali Acc: 0.333 Test Loss: 1.015 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 783651
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.561413049697876
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.3257155418395996
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.448915958404541
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.38222622871398926
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.37023186683654785
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.45085692405700684
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.4902365207672119
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.3869762420654297
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.4808957576751709
Epoch: 9, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.3968946933746338
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.3897266387939453
Epoch: 11, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4808661937713623
Epoch: 12, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.36835527420043945
Epoch: 13, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.39542078971862793
Epoch: 14, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.474520206451416
Epoch: 15, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.42491722106933594
Epoch: 16, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.39878201484680176
Epoch: 17, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.41771960258483887
Epoch: 18, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.3871786594390869
Epoch: 19, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.380720853805542
Epoch: 20, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 782563
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.616546869277954
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4170658588409424
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.39821290969848633
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.43680357933044434
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.35289430618286133
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3580172061920166
Epoch: 6, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.3475222587585449
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3596529960632324
Epoch: 8, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3793797492980957
Epoch: 9, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3432652950286865
Epoch: 10, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3942692279815674
Epoch: 11, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.42926645278930664
Epoch: 12, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.344754695892334
Epoch: 13, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3914048671722412
Epoch: 14, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3657066822052002
Epoch: 15, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.34730005264282227
Epoch: 16, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3504149913787842
Epoch: 17, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3800058364868164
Epoch: 18, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3188819885253906
Epoch: 19, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.3802018165588379
Epoch: 20, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.31885290145874023
Epoch: 21, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3271324634552002
Epoch: 22, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3185088634490967
Epoch: 23, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.2910304069519043
Epoch: 24, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3086228370666504
Epoch: 25, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.30895280838012695
Epoch: 26, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.33080482482910156
Epoch: 27, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.35091233253479004
Epoch: 28, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.4347517490386963
Epoch: 29, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.3359847068786621
Epoch: 30, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.3881382942199707
Epoch: 31, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.3778355121612549
Epoch: 32, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.3911318778991699
Epoch: 33, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 0.39759159088134766
Epoch: 34, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 35 cost time: 0.39661622047424316
Epoch: 35, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 0.3598194122314453
Epoch: 36, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 37 cost time: 0.3830759525299072
Epoch: 37, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 38 cost time: 0.41625118255615234
Epoch: 38, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 39 cost time: 0.35789942741394043
Epoch: 39, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 40 cost time: 0.3361372947692871
Epoch: 40, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 41 cost time: 0.37408995628356934
Epoch: 41, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 42 cost time: 0.34522223472595215
Epoch: 42, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 43 cost time: 0.3444547653198242
Epoch: 43, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 44 cost time: 0.3374135494232178
Epoch: 44, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 45 cost time: 0.35103368759155273
Epoch: 45, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.3532378673553467
Epoch: 46, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4011802673339844
Epoch: 47, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.34433531761169434
Epoch: 48, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.38457655906677246
Epoch: 49, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.3328063488006592
Epoch: 50, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 785027
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5653860569000244
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.37450408935546875
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3772318363189697
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.35068488121032715
Epoch: 4, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4044780731201172
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3985607624053955
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3660314083099365
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4444115161895752
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.378415584564209
Epoch: 9, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3869497776031494
Epoch: 10, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3750603199005127
Epoch: 11, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.3607027530670166
Epoch: 12, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4782752990722656
Epoch: 13, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.3831171989440918
Epoch: 14, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4034428596496582
Epoch: 15, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.3871188163757324
Epoch: 16, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.40131568908691406
Epoch: 17, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.3680417537689209
Epoch: 18, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.48304176330566406
Epoch: 19, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.3969449996948242
Epoch: 20, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 787491
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5071680545806885
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.37265825271606445
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.32922935485839844
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.40467166900634766
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3653578758239746
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.39617228507995605
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.48235464096069336
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3546586036682129
Epoch: 8, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3442502021789551
Epoch: 9, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.3151082992553711
Epoch: 10, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.31903791427612305
Epoch: 11, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3543586730957031
Epoch: 12, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4212820529937744
Epoch: 13, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.3191263675689697
Epoch: 14, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.3837471008300781
Epoch: 15, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.36168432235717773
Epoch: 16, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.33324480056762695
Epoch: 17, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.3238387107849121
Epoch: 18, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 789955
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.664893627166748
Epoch: 1, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.39333581924438477
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4543445110321045
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3280143737792969
Epoch: 4, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.3472414016723633
Epoch: 5, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3517904281616211
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.43561410903930664
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3624885082244873
Epoch: 8, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3835124969482422
Epoch: 9, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.40409040451049805
Epoch: 10, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.4014582633972168
Epoch: 11, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.40651535987854004
Epoch: 12, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.33864307403564453
Epoch: 13, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.43648791313171387
Epoch: 14, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.35094189643859863
Epoch: 15, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.38689398765563965
Epoch: 16, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.42759227752685547
Epoch: 17, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.34406137466430664
Epoch: 18, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.4851219654083252
Epoch: 19, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4702122211456299
Epoch: 20, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4690706729888916
Epoch: 21, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4208495616912842
Epoch: 22, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.44130611419677734
Epoch: 23, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.5072152614593506
Epoch: 24, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.4553236961364746
Epoch: 25, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.38164567947387695
Epoch: 26, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.4252746105194092
Epoch: 27, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.3973541259765625
Epoch: 28, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.3864626884460449
Epoch: 29, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4691314697265625
Epoch: 30, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.44867396354675293
Epoch: 31, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4599173069000244
Epoch: 32, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.35548973083496094
Epoch: 33, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.37215113639831543
Epoch: 34, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.3755607604980469
Epoch: 35, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.4595518112182617
Epoch: 36, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.4333517551422119
Epoch: 37, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4748575687408447
Epoch: 38, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 796035
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7536046504974365
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.127 Vali Acc: 0.133 Test Loss: 1.127 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.3885073661804199
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.129 Vali Acc: 0.067 Test Loss: 1.129 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4033057689666748
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.131 Vali Acc: 0.067 Test Loss: 1.131 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.41594910621643066
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.133 Vali Acc: 0.067 Test Loss: 1.133 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42126965522766113
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.136 Vali Acc: 0.067 Test Loss: 1.136 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.44400548934936523
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.138 Vali Acc: 0.067 Test Loss: 1.138 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.38695383071899414
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.141 Vali Acc: 0.067 Test Loss: 1.141 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.47024989128112793
Epoch: 8, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.144 Vali Acc: 0.067 Test Loss: 1.144 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3608589172363281
Epoch: 9, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.38823938369750977
Epoch: 10, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4536173343658447
Epoch: 11, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 782659
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.739546537399292
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.378537654876709
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.4437100887298584
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.4137740135192871
Epoch: 4, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4477066993713379
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.40317296981811523
Epoch: 6, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.43976306915283203
Epoch: 7, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.4061715602874756
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.4189605712890625
Epoch: 9, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.3688089847564697
Epoch: 10, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.3891448974609375
Epoch: 11, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.39282727241516113
Epoch: 12, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.4652371406555176
Epoch: 13, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3835258483886719
Epoch: 14, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.4048314094543457
Epoch: 15, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.4803457260131836
Epoch: 16, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.36234021186828613
Epoch: 17, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.3581199645996094
Epoch: 18, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.4011516571044922
Epoch: 19, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.3918900489807129
Epoch: 20, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.4598042964935303
Epoch: 21, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.44498610496520996
Epoch: 22, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.37200212478637695
Epoch: 23, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.386979341506958
Epoch: 24, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.42888927459716797
Epoch: 25, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.3657219409942627
Epoch: 26, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.3844785690307617
Epoch: 27, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.38511157035827637
Epoch: 28, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.48461151123046875
Epoch: 29, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.5210082530975342
Epoch: 30, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.42119359970092773
Epoch: 31, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 32 cost time: 0.46219444274902344
Epoch: 32, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 33 cost time: 0.39451050758361816
Epoch: 33, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.4735071659088135
Epoch: 34, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 0.40674495697021484
Epoch: 35, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.44884824752807617
Epoch: 36, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 0.40909242630004883
Epoch: 37, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.4049060344696045
Epoch: 38, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 0.36078715324401855
Epoch: 39, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 0.4026520252227783
Epoch: 40, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.44682836532592773
Epoch: 41, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.49883294105529785
Epoch: 42, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.40401315689086914
Epoch: 43, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.37403297424316406
Epoch: 44, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.3915989398956299
Epoch: 45, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4015934467315674
Epoch: 46, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 47 cost time: 0.44780421257019043
Epoch: 47, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.39145708084106445
Epoch: 48, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.3759908676147461
Epoch: 49, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5304484367370605
Epoch: 50, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 780067
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.597280740737915
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3548102378845215
Epoch: 2, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39458560943603516
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3452932834625244
Epoch: 4, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4107036590576172
Epoch: 5, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.35292577743530273
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.40254759788513184
Epoch: 7, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3260681629180908
Epoch: 8, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.425004243850708
Epoch: 9, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3984074592590332
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.34352540969848633
Epoch: 11, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4611203670501709
Epoch: 12, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3823709487915039
Epoch: 13, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.36650919914245605
Epoch: 14, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.36649084091186523
Epoch: 15, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.3534846305847168
Epoch: 16, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4102182388305664
Epoch: 17, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4422767162322998
Epoch: 18, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.43816065788269043
Epoch: 19, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.3808624744415283
Epoch: 20, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.432049036026001
Epoch: 21, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.36871767044067383
Epoch: 22, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.3765983581542969
Epoch: 23, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.39125633239746094
Epoch: 24, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.42499876022338867
Epoch: 25, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 778979
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6842236518859863
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3597888946533203
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37799668312072754
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3780243396759033
Epoch: 4, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42528247833251953
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4190101623535156
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3546938896179199
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3432579040527344
Epoch: 8, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3794991970062256
Epoch: 9, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.100 Vali Acc: 0.133 Test Loss: 1.100 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3591785430908203
Epoch: 10, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.37448835372924805
Epoch: 11, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 781443
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5142481327056885
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.31624507904052734
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3284931182861328
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4811427593231201
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.355302095413208
Epoch: 5, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.45429325103759766
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.43398475646972656
Epoch: 7, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.35158824920654297
Epoch: 8, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.39687228202819824
Epoch: 9, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.35370564460754395
Epoch: 10, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.3780641555786133
Epoch: 11, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.3466911315917969
Epoch: 12, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.37508487701416016
Epoch: 13, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.38442254066467285
Epoch: 14, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.35671138763427734
Epoch: 15, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3547542095184326
Epoch: 16, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4237332344055176
Epoch: 17, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 18 cost time: 0.4260721206665039
Epoch: 18, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.4010777473449707
Epoch: 19, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 20 cost time: 0.4054429531097412
Epoch: 20, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 21 cost time: 0.3986835479736328
Epoch: 21, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.36527228355407715
Epoch: 22, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.3263876438140869
Epoch: 23, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.3795888423919678
Epoch: 24, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.4322206974029541
Epoch: 25, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.37471723556518555
Epoch: 26, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.3704946041107178
Epoch: 27, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 0.3387889862060547
Epoch: 28, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3315258026123047
Epoch: 29, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.3836221694946289
Epoch: 30, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.36143040657043457
Epoch: 31, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.3642458915710449
Epoch: 32, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.3943037986755371
Epoch: 33, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4398677349090576
Epoch: 34, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.35344958305358887
Epoch: 35, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.33623337745666504
Epoch: 36, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.41790223121643066
Epoch: 37, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 783907
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7751758098602295
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3962516784667969
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.4332571029663086
Epoch: 3, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.3200974464416504
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.399608850479126
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.4036445617675781
Epoch: 6, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.3915238380432129
Epoch: 7, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.3378267288208008
Epoch: 8, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.3627047538757324
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.3439676761627197
Epoch: 10, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.35340213775634766
Epoch: 11, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4376401901245117
Epoch: 12, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.090 Vali Acc: 0.133 Test Loss: 1.090 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.35629796981811523
Epoch: 13, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.090 Vali Acc: 0.133 Test Loss: 1.090 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.3601837158203125
Epoch: 14, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.090 Vali Acc: 0.133 Test Loss: 1.090 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3543233871459961
Epoch: 15, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.090 Vali Acc: 0.133 Test Loss: 1.090 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.34947872161865234
Epoch: 16, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.090 Vali Acc: 0.133 Test Loss: 1.090 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.36554956436157227
Epoch: 17, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4541356563568115
Epoch: 18, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.3286287784576416
Epoch: 19, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.3870120048522949
Epoch: 20, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 786371
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6217374801635742
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4438931941986084
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4034097194671631
Epoch: 3, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3756108283996582
Epoch: 4, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.45589423179626465
Epoch: 5, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3642385005950928
Epoch: 6, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3559713363647461
Epoch: 7, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.47003793716430664
Epoch: 8, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.37052440643310547
Epoch: 9, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4061744213104248
Epoch: 10, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4768412113189697
Epoch: 11, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.36806344985961914
Epoch: 12, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.37876129150390625
Epoch: 13, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.3697526454925537
Epoch: 14, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3618166446685791
Epoch: 15, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.36139965057373047
Epoch: 16, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4251747131347656
Epoch: 17, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4814026355743408
Epoch: 18, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.42856574058532715
Epoch: 19, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.43856167793273926
Epoch: 20, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4221515655517578
Epoch: 21, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4359011650085449
Epoch: 22, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.38350653648376465
Epoch: 23, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2914819
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6229572296142578
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3776559829711914
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3409616947174072
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.389782190322876
Epoch: 4, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.37372756004333496
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4349489212036133
Epoch: 6, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4459395408630371
Epoch: 7, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.39417457580566406
Epoch: 8, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.39636969566345215
Epoch: 9, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.34809160232543945
Epoch: 10, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3868527412414551
Epoch: 11, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.3496382236480713
Epoch: 12, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.43068408966064453
Epoch: 13, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.35680699348449707
Epoch: 14, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.35238218307495117
Epoch: 15, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.3827958106994629
Epoch: 16, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.406768798828125
Epoch: 17, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.45690274238586426
Epoch: 18, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.37022948265075684
Epoch: 19, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.3866455554962158
Epoch: 20, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4032924175262451
Epoch: 21, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3566904067993164
Epoch: 22, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.40241479873657227
Epoch: 23, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4082920551300049
Epoch: 24, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4022035598754883
Epoch: 25, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.4056975841522217
Epoch: 26, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3760190010070801
Epoch: 27, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.3632490634918213
Epoch: 28, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4134845733642578
Epoch: 29, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5284028053283691
Epoch: 30, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4279611110687256
Epoch: 31, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.38524866104125977
Epoch: 32, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.142 Vali Acc: 0.533 Test Loss: 1.142 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.3766214847564697
Epoch: 33, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4507420063018799
Epoch: 34, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.3670928478240967
Epoch: 35, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.176 Vali Acc: 0.533 Test Loss: 1.176 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2864387
model size : 10.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6908915042877197
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3684818744659424
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43673205375671387
Epoch: 3, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.35643601417541504
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3807353973388672
Epoch: 5, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3615849018096924
Epoch: 6, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3947899341583252
Epoch: 7, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4591042995452881
Epoch: 8, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4050333499908447
Epoch: 9, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.38057470321655273
Epoch: 10, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.43047285079956055
Epoch: 11, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2850947
model size : 10.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5500409603118896
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.3803215026855469
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.409548282623291
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.3869814872741699
Epoch: 4, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4258589744567871
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.4037294387817383
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.42340755462646484
Epoch: 7, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.40314435958862305
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4078371524810791
Epoch: 9, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.4258570671081543
Epoch: 10, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.3704543113708496
Epoch: 11, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.47231149673461914
Epoch: 12, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3859517574310303
Epoch: 13, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.45592808723449707
Epoch: 14, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.44135141372680664
Epoch: 15, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.35277509689331055
Epoch: 16, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.44013261795043945
Epoch: 17, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.40429091453552246
Epoch: 18, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.39359021186828613
Epoch: 19, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3666820526123047
Epoch: 20, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.43848180770874023
Epoch: 21, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.3814058303833008
Epoch: 22, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.37430500984191895
Epoch: 23, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.385575532913208
Epoch: 24, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.43160533905029297
Epoch: 25, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.34413862228393555
Epoch: 26, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.39907407760620117
Epoch: 27, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.3921957015991211
Epoch: 28, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2849667
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5869355201721191
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3875694274902344
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41909360885620117
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.41840171813964844
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4580378532409668
Epoch: 5, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.42682719230651855
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4556691646575928
Epoch: 7, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.45382094383239746
Epoch: 8, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.425983190536499
Epoch: 9, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3732113838195801
Epoch: 10, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.40805959701538086
Epoch: 11, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2856451
model size : 10.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6588311195373535
Epoch: 1, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.38204455375671387
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4146084785461426
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3975808620452881
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3441333770751953
Epoch: 5, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4230921268463135
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3577861785888672
Epoch: 7, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.33567166328430176
Epoch: 8, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.41442203521728516
Epoch: 9, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4136381149291992
Epoch: 10, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.43249988555908203
Epoch: 11, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.37352442741394043
Epoch: 12, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4008030891418457
Epoch: 13, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3971590995788574
Epoch: 14, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3611297607421875
Epoch: 15, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.43846750259399414
Epoch: 16, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3494911193847656
Epoch: 17, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.406461238861084
Epoch: 18, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4857513904571533
Epoch: 19, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.39446401596069336
Epoch: 20, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.349254846572876
Epoch: 21, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.3775148391723633
Epoch: 22, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2866307
model size : 10.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4684085845947266
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.34810304641723633
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.35931396484375
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44077205657958984
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.33939504623413086
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.38826942443847656
Epoch: 6, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3579847812652588
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.405407190322876
Epoch: 8, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4282090663909912
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.38589954376220703
Epoch: 10, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.38717150688171387
Epoch: 11, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.39032602310180664
Epoch: 12, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.36689281463623047
Epoch: 13, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.34008193016052246
Epoch: 14, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4050323963165283
Epoch: 15, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3825051784515381
Epoch: 16, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.35569190979003906
Epoch: 17, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.37628865242004395
Epoch: 18, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.450756311416626
Epoch: 19, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.3941009044647217
Epoch: 20, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.3484184741973877
Epoch: 21, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.44337892532348633
Epoch: 22, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.35003113746643066
Epoch: 23, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3339362144470215
Epoch: 24, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.41011571884155273
Epoch: 25, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5609822273254395
Epoch: 26, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5408265590667725
Epoch: 27, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4108462333679199
Epoch: 28, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.412308931350708
Epoch: 29, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.48700618743896484
Epoch: 30, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5089809894561768
Epoch: 31, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.512392520904541
Epoch: 32, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5064244270324707
Epoch: 33, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4464993476867676
Epoch: 34, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2879235
model size : 11.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5504891872406006
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.047 Vali Acc: 0.733 Test Loss: 1.047 Test Acc: 0.733
Validation loss decreased (inf --> -0.733323).  Saving model ...
Epoch: 2 cost time: 0.3640482425689697
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.044 Vali Acc: 0.667 Test Loss: 1.044 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.416546106338501
Epoch: 3, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.040 Vali Acc: 0.667 Test Loss: 1.040 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4041604995727539
Epoch: 4, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.037 Vali Acc: 0.667 Test Loss: 1.037 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.36767148971557617
Epoch: 5, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.034 Vali Acc: 0.667 Test Loss: 1.034 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.38884878158569336
Epoch: 6, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.030 Vali Acc: 0.733 Test Loss: 1.030 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 7 cost time: 0.36158084869384766
Epoch: 7, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 0.3519248962402344
Epoch: 8, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 0.32729434967041016
Epoch: 9, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.017 Vali Acc: 0.733 Test Loss: 1.017 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.41791224479675293
Epoch: 10, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.012 Vali Acc: 0.800 Test Loss: 1.012 Test Acc: 0.800
Validation loss decreased (-0.733323 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.3464529514312744
Epoch: 11, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.006 Vali Acc: 0.800 Test Loss: 1.006 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 0.3519322872161865
Epoch: 12, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.000 Vali Acc: 0.733 Test Loss: 1.000 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4300050735473633
Epoch: 13, Steps: 1 | Train Loss: 0.541 Vali Loss: 0.994 Vali Acc: 0.733 Test Loss: 0.994 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.36400318145751953
Epoch: 14, Steps: 1 | Train Loss: 0.477 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.37653303146362305
Epoch: 15, Steps: 1 | Train Loss: 0.459 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.37874817848205566
Epoch: 16, Steps: 1 | Train Loss: 0.386 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.41463375091552734
Epoch: 17, Steps: 1 | Train Loss: 0.355 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.40342068672180176
Epoch: 18, Steps: 1 | Train Loss: 0.316 Vali Loss: 0.968 Vali Acc: 0.467 Test Loss: 0.968 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.34708642959594727
Epoch: 19, Steps: 1 | Train Loss: 0.283 Vali Loss: 0.964 Vali Acc: 0.467 Test Loss: 0.964 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.35152673721313477
Epoch: 20, Steps: 1 | Train Loss: 0.253 Vali Loss: 0.962 Vali Acc: 0.467 Test Loss: 0.962 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.40869617462158203
Epoch: 21, Steps: 1 | Train Loss: 0.213 Vali Loss: 0.960 Vali Acc: 0.467 Test Loss: 0.960 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.8
model parameter : 785667
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6134600639343262
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.060 Vali Acc: 0.267 Test Loss: 1.060 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.41278910636901855
Epoch: 2, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.059 Vali Acc: 0.267 Test Loss: 1.059 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.37813735008239746
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.38058948516845703
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3922233581542969
Epoch: 5, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3897883892059326
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.38004469871520996
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5007290840148926
Epoch: 8, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3868110179901123
Epoch: 9, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3913397789001465
Epoch: 10, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.46435070037841797
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.36359453201293945
Epoch: 12, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.3752923011779785
Epoch: 13, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.3749079704284668
Epoch: 14, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.4528481960296631
Epoch: 15, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.3854029178619385
Epoch: 16, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.40625810623168945
Epoch: 17, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.021 Vali Acc: 0.667 Test Loss: 1.021 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 18 cost time: 0.4333329200744629
Epoch: 18, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.019 Vali Acc: 0.667 Test Loss: 1.019 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 0.3961961269378662
Epoch: 19, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.016 Vali Acc: 0.667 Test Loss: 1.016 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 20 cost time: 0.3701009750366211
Epoch: 20, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.3794693946838379
Epoch: 21, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.42662596702575684
Epoch: 22, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4364461898803711
Epoch: 23, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.3861110210418701
Epoch: 24, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4053661823272705
Epoch: 25, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4212028980255127
Epoch: 26, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4004199504852295
Epoch: 27, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.45958375930786133
Epoch: 28, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.45585107803344727
Epoch: 29, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 760451
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7261583805084229
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.39902687072753906
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38672924041748047
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38726305961608887
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.38216233253479004
Epoch: 5, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4057333469390869
Epoch: 6, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4308583736419678
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.386521577835083
Epoch: 8, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.34241461753845215
Epoch: 9, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.350536584854126
Epoch: 10, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3858625888824463
Epoch: 11, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3990170955657959
Epoch: 12, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.41472697257995605
Epoch: 13, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.34500575065612793
Epoch: 14, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.37851452827453613
Epoch: 15, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.35423874855041504
Epoch: 16, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.3613607883453369
Epoch: 17, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4281575679779053
Epoch: 18, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.3458092212677002
Epoch: 19, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 753731
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.559248447418213
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.37956857681274414
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3862900733947754
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.37727952003479004
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.31922221183776855
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3399958610534668
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4254930019378662
Epoch: 7, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.33900904655456543
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.383573055267334
Epoch: 9, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.32136082649230957
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3707389831542969
Epoch: 11, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.34139394760131836
Epoch: 12, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.33172607421875
Epoch: 13, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.31452250480651855
Epoch: 14, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3324770927429199
Epoch: 15, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.38245415687561035
Epoch: 16, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.32923102378845215
Epoch: 17, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.39229631423950195
Epoch: 18, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.38338422775268555
Epoch: 19, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.35881471633911133
Epoch: 20, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.43689632415771484
Epoch: 21, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.45243096351623535
Epoch: 22, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.3764646053314209
Epoch: 23, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.35878586769104004
Epoch: 24, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.38863134384155273
Epoch: 25, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.38151025772094727
Epoch: 26, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.38339948654174805
Epoch: 27, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4137871265411377
Epoch: 28, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.41974711418151855
Epoch: 29, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.3753337860107422
Epoch: 30, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.3305976390838623
Epoch: 31, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.35510754585266113
Epoch: 32, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 33 cost time: 0.3374361991882324
Epoch: 33, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.35108232498168945
Epoch: 34, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.378190279006958
Epoch: 35, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.3627340793609619
Epoch: 36, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3329184055328369
Epoch: 37, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3628654479980469
Epoch: 38, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4795255661010742
Epoch: 39, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.42898035049438477
Epoch: 40, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.3114440441131592
Epoch: 41, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.39865946769714355
Epoch: 42, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 753091
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6555054187774658
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.40850019454956055
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.3557300567626953
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.37303924560546875
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.35817599296569824
Epoch: 5, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.34760570526123047
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3928253650665283
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.33577609062194824
Epoch: 8, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3823082447052002
Epoch: 9, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.35798144340515137
Epoch: 10, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.341780424118042
Epoch: 11, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.35138535499572754
Epoch: 12, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.3722553253173828
Epoch: 13, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.35906457901000977
Epoch: 14, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.3373527526855469
Epoch: 15, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.40044713020324707
Epoch: 16, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.38915538787841797
Epoch: 17, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.43707847595214844
Epoch: 18, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.42550039291381836
Epoch: 19, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3657984733581543
Epoch: 20, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4392378330230713
Epoch: 21, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.3274650573730469
Epoch: 22, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.339599609375
Epoch: 23, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.3984816074371338
Epoch: 24, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 756483
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4813299179077148
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.344926118850708
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.39219117164611816
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.3620913028717041
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.36159729957580566
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.372769832611084
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.3683173656463623
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.364368200302124
Epoch: 8, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.38427257537841797
Epoch: 9, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.367220401763916
Epoch: 10, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.36658620834350586
Epoch: 11, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.34396815299987793
Epoch: 12, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.3760197162628174
Epoch: 13, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.39395976066589355
Epoch: 14, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.384629487991333
Epoch: 15, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.3632831573486328
Epoch: 16, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.37557101249694824
Epoch: 17, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.39009523391723633
Epoch: 18, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.3335442543029785
Epoch: 19, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.36213207244873047
Epoch: 20, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.3672499656677246
Epoch: 21, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42122817039489746
Epoch: 22, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.41643214225769043
Epoch: 23, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5355689525604248
Epoch: 24, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4101533889770508
Epoch: 25, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3977189064025879
Epoch: 26, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4413950443267822
Epoch: 27, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.39158129692077637
Epoch: 28, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.47414302825927734
Epoch: 29, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.3743448257446289
Epoch: 30, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 761411
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5117356777191162
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3563563823699951
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3680853843688965
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3412814140319824
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3740692138671875
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.37815260887145996
Epoch: 6, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.38997960090637207
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4206368923187256
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3663759231567383
Epoch: 9, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.33621740341186523
Epoch: 10, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.35689568519592285
Epoch: 11, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 767875
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6365833282470703
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3890554904937744
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4038658142089844
Epoch: 3, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.401090145111084
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3804912567138672
Epoch: 5, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3908398151397705
Epoch: 6, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.36171650886535645
Epoch: 7, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.37018585205078125
Epoch: 8, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3831210136413574
Epoch: 9, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4217031002044678
Epoch: 10, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.3666689395904541
Epoch: 11, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.378925085067749
Epoch: 12, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3800342082977295
Epoch: 13, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.3883047103881836
Epoch: 14, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.34381628036499023
Epoch: 15, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.34078121185302734
Epoch: 16, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.3435366153717041
Epoch: 17, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.3499641418457031
Epoch: 18, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3279697895050049
Epoch: 19, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3765265941619873
Epoch: 20, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.34421563148498535
Epoch: 21, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.37258291244506836
Epoch: 22, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.36025452613830566
Epoch: 23, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.367870569229126
Epoch: 24, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.3800971508026123
Epoch: 25, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.39686131477355957
Epoch: 26, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.3696448802947998
Epoch: 27, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.46064019203186035
Epoch: 28, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.39562344551086426
Epoch: 29, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.35265302658081055
Epoch: 30, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.362518310546875
Epoch: 31, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.34070801734924316
Epoch: 32, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.3906521797180176
Epoch: 33, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.37723851203918457
Epoch: 34, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.3414952754974365
Epoch: 35, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.432267427444458
Epoch: 36, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 224899
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6516146659851074
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.33471083641052246
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.3795003890991211
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.37069082260131836
Epoch: 4, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.31784486770629883
Epoch: 5, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.3797943592071533
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.3911020755767822
Epoch: 7, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.3762390613555908
Epoch: 8, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3702378273010254
Epoch: 9, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3526451587677002
Epoch: 10, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3455030918121338
Epoch: 11, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.377835750579834
Epoch: 12, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.33801937103271484
Epoch: 13, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3523111343383789
Epoch: 14, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3462100028991699
Epoch: 15, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.37108588218688965
Epoch: 16, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3579545021057129
Epoch: 17, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.35904860496520996
Epoch: 18, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.40314793586730957
Epoch: 19, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.36333274841308594
Epoch: 20, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4089488983154297
Epoch: 21, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.37681031227111816
Epoch: 22, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.35832905769348145
Epoch: 23, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.33693599700927734
Epoch: 24, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.36525607109069824
Epoch: 25, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.40173983573913574
Epoch: 26, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4333076477050781
Epoch: 27, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.345644474029541
Epoch: 28, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.369661808013916
Epoch: 29, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 212291
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7466511726379395
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3767082691192627
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.3823835849761963
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.4252941608428955
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.36583423614501953
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.49747157096862793
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.36413025856018066
Epoch: 7, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.3750879764556885
Epoch: 8, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.36017727851867676
Epoch: 9, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4218902587890625
Epoch: 10, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.3529846668243408
Epoch: 11, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.37679243087768555
Epoch: 12, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4225606918334961
Epoch: 13, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 208931
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.573643684387207
Epoch: 1, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.140 Vali Acc: 0.067 Test Loss: 1.140 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.38790392875671387
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.141 Vali Acc: 0.067 Test Loss: 1.141 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5365123748779297
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.142 Vali Acc: 0.067 Test Loss: 1.142 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.429365873336792
Epoch: 4, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.143 Vali Acc: 0.067 Test Loss: 1.143 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.375152587890625
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.144 Vali Acc: 0.067 Test Loss: 1.144 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40717267990112305
Epoch: 6, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.146 Vali Acc: 0.067 Test Loss: 1.146 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.42971086502075195
Epoch: 7, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.147 Vali Acc: 0.067 Test Loss: 1.147 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3678452968597412
Epoch: 8, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.148 Vali Acc: 0.067 Test Loss: 1.148 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3421196937561035
Epoch: 9, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
Validation loss decreased (-0.066655 --> -0.133322).  Saving model ...
Epoch: 10 cost time: 0.36974406242370605
Epoch: 10, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.440568208694458
Epoch: 11, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.35084009170532227
Epoch: 12, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.41579508781433105
Epoch: 13, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.38423657417297363
Epoch: 14, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.38075900077819824
Epoch: 15, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5656185150146484
Epoch: 16, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.3398916721343994
Epoch: 17, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.37470293045043945
Epoch: 18, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.3590991497039795
Epoch: 19, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 208611
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5759713649749756
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.37566614151000977
Epoch: 2, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.4022371768951416
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.4786550998687744
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.35398221015930176
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.5358662605285645
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.3982853889465332
Epoch: 7, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.4694085121154785
Epoch: 8, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.35237741470336914
Epoch: 9, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.3677229881286621
Epoch: 10, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.43404245376586914
Epoch: 11, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.3193538188934326
Epoch: 12, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.44842028617858887
Epoch: 13, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 14 cost time: 0.4561116695404053
Epoch: 14, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.3970921039581299
Epoch: 15, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 16 cost time: 0.5348291397094727
Epoch: 16, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.4383218288421631
Epoch: 17, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 18 cost time: 0.40760159492492676
Epoch: 18, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 19 cost time: 0.3868558406829834
Epoch: 19, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.37258434295654297
Epoch: 20, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.3872487545013428
Epoch: 21, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.4205477237701416
Epoch: 22, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 23 cost time: 0.3693873882293701
Epoch: 23, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.33290553092956543
Epoch: 24, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.3595764636993408
Epoch: 25, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.32795190811157227
Epoch: 26, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.3829796314239502
Epoch: 27, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.43986940383911133
Epoch: 28, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.3702516555786133
Epoch: 29, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.4285295009613037
Epoch: 30, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.3841285705566406
Epoch: 31, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.38993096351623535
Epoch: 32, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.40245795249938965
Epoch: 33, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 0.44521093368530273
Epoch: 34, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 0.4113919734954834
Epoch: 35, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.4460926055908203
Epoch: 36, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 0.3452925682067871
Epoch: 37, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.46156859397888184
Epoch: 38, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 0.4575533866882324
Epoch: 39, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3944680690765381
Epoch: 40, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.43839025497436523
Epoch: 41, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.41077351570129395
Epoch: 42, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4126877784729004
Epoch: 43, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4544558525085449
Epoch: 44, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.3875620365142822
Epoch: 45, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.43833041191101074
Epoch: 46, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.48314833641052246
Epoch: 47, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4396193027496338
Epoch: 48, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 210307
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5996499061584473
Epoch: 1, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3636312484741211
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.368884801864624
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4127843379974365
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4089686870574951
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3920607566833496
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.40768003463745117
Epoch: 7, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.3651387691497803
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.31797075271606445
Epoch: 9, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3131439685821533
Epoch: 10, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.39367103576660156
Epoch: 11, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.35889720916748047
Epoch: 12, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3961782455444336
Epoch: 13, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3614194393157959
Epoch: 14, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3572678565979004
Epoch: 15, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.38220787048339844
Epoch: 16, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.34749722480773926
Epoch: 17, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3990750312805176
Epoch: 18, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3353407382965088
Epoch: 19, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.34149718284606934
Epoch: 20, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.405458927154541
Epoch: 21, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3721456527709961
Epoch: 22, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.39360594749450684
Epoch: 23, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.3917202949523926
Epoch: 24, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.3553965091705322
Epoch: 25, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.36406397819519043
Epoch: 26, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.36919116973876953
Epoch: 27, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.3438575267791748
Epoch: 28, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.38065242767333984
Epoch: 29, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.34302449226379395
Epoch: 30, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.36333203315734863
Epoch: 31, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 212771
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7539806365966797
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.34531164169311523
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3938765525817871
Epoch: 3, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38915061950683594
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.35673952102661133
Epoch: 5, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.37296247482299805
Epoch: 6, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3586080074310303
Epoch: 7, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3504307270050049
Epoch: 8, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.40014171600341797
Epoch: 9, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3571627140045166
Epoch: 10, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3850715160369873
Epoch: 11, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 216003
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6089708805084229
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3825533390045166
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.34572434425354004
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.39368462562561035
Epoch: 4, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4892442226409912
Epoch: 5, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.38207197189331055
Epoch: 6, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4693737030029297
Epoch: 7, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.40178942680358887
Epoch: 8, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3537416458129883
Epoch: 9, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.3570847511291504
Epoch: 10, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.40280652046203613
Epoch: 11, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4768226146697998
Epoch: 12, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4487111568450928
Epoch: 13, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.47509264945983887
Epoch: 14, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.027 Vali Acc: 0.333 Test Loss: 1.027 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4044210910797119
Epoch: 15, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.026 Vali Acc: 0.333 Test Loss: 1.026 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4223494529724121
Epoch: 16, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.406329870223999
Epoch: 17, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.3838794231414795
Epoch: 18, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.44156527519226074
Epoch: 19, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2908675
model size : 11.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6320445537567139
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.40352296829223633
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.35571742057800293
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.39432787895202637
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4791107177734375
Epoch: 5, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.38388800621032715
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.403123140335083
Epoch: 7, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.40404391288757324
Epoch: 8, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3834569454193115
Epoch: 9, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45868349075317383
Epoch: 10, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.38526225090026855
Epoch: 11, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.401106595993042
Epoch: 12, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.45634937286376953
Epoch: 13, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.47178101539611816
Epoch: 14, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.426389217376709
Epoch: 15, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.40638160705566406
Epoch: 16, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.38935422897338867
Epoch: 17, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.39328980445861816
Epoch: 18, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4102010726928711
Epoch: 19, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.38585591316223145
Epoch: 20, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.41051292419433594
Epoch: 21, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.4956631660461426
Epoch: 22, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 23 cost time: 0.4257166385650635
Epoch: 23, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.40991997718811035
Epoch: 24, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.37541651725769043
Epoch: 25, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4118051528930664
Epoch: 26, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5012891292572021
Epoch: 27, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3832087516784668
Epoch: 28, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.3809375762939453
Epoch: 29, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.3678770065307617
Epoch: 30, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.419832706451416
Epoch: 31, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4938528537750244
Epoch: 32, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2858243
model size : 10.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5098888874053955
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.41726255416870117
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42166638374328613
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5391569137573242
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.40570497512817383
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4380333423614502
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4075949192047119
Epoch: 7, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.37589025497436523
Epoch: 8, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4567222595214844
Epoch: 9, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.439835786819458
Epoch: 10, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.4323415756225586
Epoch: 11, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.39859890937805176
Epoch: 12, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.41336750984191895
Epoch: 13, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.35092830657958984
Epoch: 14, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4582369327545166
Epoch: 15, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.40740036964416504
Epoch: 16, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.47731947898864746
Epoch: 17, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.40618348121643066
Epoch: 18, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.42838525772094727
Epoch: 19, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4022235870361328
Epoch: 20, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.3755671977996826
Epoch: 21, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2844803
model size : 10.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6110057830810547
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.39623451232910156
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40529632568359375
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4457850456237793
Epoch: 4, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.35480237007141113
Epoch: 5, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.365048885345459
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3648369312286377
Epoch: 7, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4218728542327881
Epoch: 8, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.41689443588256836
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.430222749710083
Epoch: 10, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.41051292419433594
Epoch: 11, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2843523
model size : 10.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6024723052978516
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4958384037017822
Epoch: 2, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4528181552886963
Epoch: 3, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.35080790519714355
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4300343990325928
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.42159271240234375
Epoch: 6, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.38045477867126465
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.37835097312927246
Epoch: 8, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4105043411254883
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.381854772567749
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4237549304962158
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.417665958404541
Epoch: 12, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.37554383277893066
Epoch: 13, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3827171325683594
Epoch: 14, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.37741756439208984
Epoch: 15, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.38957762718200684
Epoch: 16, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4257547855377197
Epoch: 17, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.39977264404296875
Epoch: 18, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.3897085189819336
Epoch: 19, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.4003124237060547
Epoch: 20, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.4158351421356201
Epoch: 21, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.41022205352783203
Epoch: 22, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.4167935848236084
Epoch: 23, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.39728617668151855
Epoch: 24, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.45945310592651367
Epoch: 25, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.3874320983886719
Epoch: 26, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4362063407897949
Epoch: 27, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.3916046619415283
Epoch: 28, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.40884852409362793
Epoch: 29, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.43814563751220703
Epoch: 30, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.3799910545349121
Epoch: 31, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.48583555221557617
Epoch: 32, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.37480735778808594
Epoch: 33, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2850307
model size : 10.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7339017391204834
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.34607481956481934
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.35715818405151367
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.35961246490478516
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.39905405044555664
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3810245990753174
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3939070701599121
Epoch: 7, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3551642894744873
Epoch: 8, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4087107181549072
Epoch: 9, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.3415486812591553
Epoch: 10, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.36913084983825684
Epoch: 11, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.33475732803344727
Epoch: 12, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.3215646743774414
Epoch: 13, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3721628189086914
Epoch: 14, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.34250783920288086
Epoch: 15, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.38640332221984863
Epoch: 16, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.38251233100891113
Epoch: 17, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.3916783332824707
Epoch: 18, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5021133422851562
Epoch: 19, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4562363624572754
Epoch: 20, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.42310357093811035
Epoch: 21, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.3863050937652588
Epoch: 22, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2860163
model size : 10.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7061011791229248
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3724327087402344
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43682146072387695
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4229917526245117
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3877129554748535
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4448058605194092
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.37212443351745605
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4024651050567627
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4652867317199707
Epoch: 9, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4496164321899414
Epoch: 10, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.421872615814209
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.41741061210632324
Epoch: 12, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.45403218269348145
Epoch: 13, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3907921314239502
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.4055018424987793
Epoch: 15, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.40960049629211426
Epoch: 16, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.3810756206512451
Epoch: 17, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4128282070159912
Epoch: 18, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.4436779022216797
Epoch: 19, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.41972947120666504
Epoch: 20, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.37578439712524414
Epoch: 21, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.39964890480041504
Epoch: 22, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.38607335090637207
Epoch: 23, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4373910427093506
Epoch: 24, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.41988229751586914
Epoch: 25, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.46161937713623047
Epoch: 26, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.3919985294342041
Epoch: 27, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5207960605621338
Epoch: 28, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2873091
model size : 11.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7000415325164795
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3334219455718994
Epoch: 2, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.37086915969848633
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.36802005767822266
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.36647820472717285
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.46813464164733887
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.38831424713134766
Epoch: 7, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3748612403869629
Epoch: 8, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4944765567779541
Epoch: 9, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4577181339263916
Epoch: 10, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.34345078468322754
Epoch: 11, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4337174892425537
Epoch: 12, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3445580005645752
Epoch: 13, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.34775876998901367
Epoch: 14, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.39210057258605957
Epoch: 15, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.41261982917785645
Epoch: 16, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.37319374084472656
Epoch: 17, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.47661709785461426
Epoch: 18, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.37293267250061035
Epoch: 19, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.029 Vali Acc: 0.333 Test Loss: 1.029 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4291198253631592
Epoch: 20, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.027 Vali Acc: 0.267 Test Loss: 1.027 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.41950511932373047
Epoch: 21, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.026 Vali Acc: 0.267 Test Loss: 1.026 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.47040796279907227
Epoch: 22, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.026 Vali Acc: 0.267 Test Loss: 1.026 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.44814634323120117
Epoch: 23, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.027 Vali Acc: 0.267 Test Loss: 1.027 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.3698294162750244
Epoch: 24, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.029 Vali Acc: 0.267 Test Loss: 1.029 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4378173351287842
Epoch: 25, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.032 Vali Acc: 0.267 Test Loss: 1.032 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.40059733390808105
Epoch: 26, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.35306525230407715
Epoch: 27, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 782595
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7959315776824951
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.37816309928894043
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.3670320510864258
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.409559965133667
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.40838003158569336
Epoch: 5, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.4948420524597168
Epoch: 6, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.39619016647338867
Epoch: 7, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.41137051582336426
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.4474818706512451
Epoch: 9, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.4190235137939453
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.3732888698577881
Epoch: 11, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.38272571563720703
Epoch: 12, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.42055320739746094
Epoch: 13, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.4091651439666748
Epoch: 14, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3763103485107422
Epoch: 15, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.43906426429748535
Epoch: 16, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.36820244789123535
Epoch: 17, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.35466742515563965
Epoch: 18, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4823787212371826
Epoch: 19, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.34264636039733887
Epoch: 20, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.36832165718078613
Epoch: 21, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.3514118194580078
Epoch: 22, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4005892276763916
Epoch: 23, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 757379
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5796411037445068
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3935708999633789
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4793057441711426
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3714425563812256
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4183783531188965
Epoch: 5, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3426029682159424
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.33245229721069336
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.46852946281433105
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.38259291648864746
Epoch: 9, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.40979671478271484
Epoch: 10, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4268927574157715
Epoch: 11, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3600435256958008
Epoch: 12, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.38625335693359375
Epoch: 13, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3368546962738037
Epoch: 14, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4083828926086426
Epoch: 15, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.39191246032714844
Epoch: 16, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.3989419937133789
Epoch: 17, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4295811653137207
Epoch: 18, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.42665839195251465
Epoch: 19, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.48308277130126953
Epoch: 20, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5319054126739502
Epoch: 21, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.37732958793640137
Epoch: 22, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.3939242362976074
Epoch: 23, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.46802258491516113
Epoch: 24, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.46363162994384766
Epoch: 25, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.3897671699523926
Epoch: 26, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.136 Vali Acc: 0.533 Test Loss: 1.136 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 27 cost time: 0.39631199836730957
Epoch: 27, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.139 Vali Acc: 0.533 Test Loss: 1.139 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3863697052001953
Epoch: 28, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.143 Vali Acc: 0.533 Test Loss: 1.143 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4540066719055176
Epoch: 29, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.37380123138427734
Epoch: 30, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.46225786209106445
Epoch: 31, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.3698101043701172
Epoch: 32, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.3685290813446045
Epoch: 33, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.33323073387145996
Epoch: 34, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4504423141479492
Epoch: 35, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.3690452575683594
Epoch: 36, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 750659
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6460447311401367
Epoch: 1, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3941981792449951
Epoch: 2, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41321253776550293
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47711706161499023
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.39592552185058594
Epoch: 5, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3687174320220947
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.40218043327331543
Epoch: 7, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.37012481689453125
Epoch: 8, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4160635471343994
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.3879685401916504
Epoch: 10, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4126121997833252
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.34444618225097656
Epoch: 12, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.37648630142211914
Epoch: 13, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.4369080066680908
Epoch: 14, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.3576383590698242
Epoch: 15, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.4030616283416748
Epoch: 16, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.36658620834350586
Epoch: 17, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.5151636600494385
Epoch: 18, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.3597524166107178
Epoch: 19, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.3793752193450928
Epoch: 20, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.4796411991119385
Epoch: 21, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.5014467239379883
Epoch: 22, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.464369535446167
Epoch: 23, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.4302389621734619
Epoch: 24, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 0.4618523120880127
Epoch: 25, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 0.38323473930358887
Epoch: 26, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 27 cost time: 0.367830753326416
Epoch: 27, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 28 cost time: 0.3686544895172119
Epoch: 28, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.45723986625671387
Epoch: 29, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4156632423400879
Epoch: 30, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.32775115966796875
Epoch: 31, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.3878912925720215
Epoch: 32, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.47032618522644043
Epoch: 33, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.3501429557800293
Epoch: 34, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.33010005950927734
Epoch: 35, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.3162567615509033
Epoch: 36, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.3937201499938965
Epoch: 37, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.3570084571838379
Epoch: 38, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4280130863189697
Epoch: 39, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.34091997146606445
Epoch: 40, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 750019
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6782326698303223
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3746776580810547
Epoch: 2, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3673124313354492
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3921506404876709
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.39815521240234375
Epoch: 5, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.46143651008605957
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.38968777656555176
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.389056921005249
Epoch: 8, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.4462728500366211
Epoch: 9, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.35477733612060547
Epoch: 10, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.34683823585510254
Epoch: 11, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3554701805114746
Epoch: 12, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.34479808807373047
Epoch: 13, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5747823715209961
Epoch: 14, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4835793972015381
Epoch: 15, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4438929557800293
Epoch: 16, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.39209747314453125
Epoch: 17, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.41558146476745605
Epoch: 18, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 753411
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6637215614318848
Epoch: 1, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.475053071975708
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4830310344696045
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.36050915718078613
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4696178436279297
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.399432897567749
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.36676764488220215
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3246588706970215
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.3384997844696045
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.3518037796020508
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4301738739013672
Epoch: 11, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3844339847564697
Epoch: 12, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.37674784660339355
Epoch: 13, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.31429195404052734
Epoch: 14, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.3551604747772217
Epoch: 15, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.3803584575653076
Epoch: 16, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.3638031482696533
Epoch: 17, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.328153133392334
Epoch: 18, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 758339
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6452419757843018
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.087 Vali Acc: 0.133 Test Loss: 1.087 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.385542631149292
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.088 Vali Acc: 0.133 Test Loss: 1.088 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48083925247192383
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.088 Vali Acc: 0.133 Test Loss: 1.088 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.37537097930908203
Epoch: 4, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.088 Vali Acc: 0.133 Test Loss: 1.088 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.36470842361450195
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.088 Vali Acc: 0.133 Test Loss: 1.088 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.42275571823120117
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.088 Vali Acc: 0.133 Test Loss: 1.088 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.40285730361938477
Epoch: 7, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.088 Vali Acc: 0.133 Test Loss: 1.088 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.40346693992614746
Epoch: 8, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.3608856201171875
Epoch: 9, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.4017767906188965
Epoch: 10, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.45230650901794434
Epoch: 11, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.3790159225463867
Epoch: 12, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.49153709411621094
Epoch: 13, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.40044093132019043
Epoch: 14, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.5205807685852051
Epoch: 15, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.4077637195587158
Epoch: 16, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.39342689514160156
Epoch: 17, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.49752044677734375
Epoch: 18, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.41154050827026367
Epoch: 19, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 0.41524600982666016
Epoch: 20, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 0.37217259407043457
Epoch: 21, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.34786200523376465
Epoch: 22, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.4017198085784912
Epoch: 23, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.37180447578430176
Epoch: 24, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.3935873508453369
Epoch: 25, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.4065077304840088
Epoch: 26, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.3845651149749756
Epoch: 27, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.4338409900665283
Epoch: 28, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.46442675590515137
Epoch: 29, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.40659356117248535
Epoch: 30, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.38816022872924805
Epoch: 31, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 0.36637425422668457
Epoch: 32, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.3803684711456299
Epoch: 33, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.3992304801940918
Epoch: 34, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.36742496490478516
Epoch: 35, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.33440327644348145
Epoch: 36, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.39148592948913574
Epoch: 37, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.345304012298584
Epoch: 38, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.3366250991821289
Epoch: 39, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.44498610496520996
Epoch: 40, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.37639689445495605
Epoch: 41, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 764803
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5976688861846924
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3981790542602539
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.395277738571167
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.40665626525878906
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4196615219116211
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3968667984008789
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.38411569595336914
Epoch: 7, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.40383410453796387
Epoch: 8, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.44097185134887695
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.45374441146850586
Epoch: 10, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.42127227783203125
Epoch: 11, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3977382183074951
Epoch: 12, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3944683074951172
Epoch: 13, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.331190824508667
Epoch: 14, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3778235912322998
Epoch: 15, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.44983625411987305
Epoch: 16, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4821155071258545
Epoch: 17, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.36309266090393066
Epoch: 18, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.40370821952819824
Epoch: 19, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.49313902854919434
Epoch: 20, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.36713290214538574
Epoch: 21, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3382542133331299
Epoch: 22, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.4107954502105713
Epoch: 23, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3530716896057129
Epoch: 24, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3317573070526123
Epoch: 25, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.41011953353881836
Epoch: 26, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.35236644744873047
Epoch: 27, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3815450668334961
Epoch: 28, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.41677427291870117
Epoch: 29, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4168400764465332
Epoch: 30, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.42727136611938477
Epoch: 31, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.43338871002197266
Epoch: 32, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 223363
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6855230331420898
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.135 Vali Acc: 0.067 Test Loss: 1.135 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.3681159019470215
Epoch: 2, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.136 Vali Acc: 0.067 Test Loss: 1.136 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3783731460571289
Epoch: 3, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.137 Vali Acc: 0.067 Test Loss: 1.137 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3633887767791748
Epoch: 4, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.138 Vali Acc: 0.067 Test Loss: 1.138 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4777371883392334
Epoch: 5, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.138 Vali Acc: 0.067 Test Loss: 1.138 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3297755718231201
Epoch: 6, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.139 Vali Acc: 0.067 Test Loss: 1.139 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3245735168457031
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.140 Vali Acc: 0.067 Test Loss: 1.140 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4499492645263672
Epoch: 8, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
Validation loss decreased (-0.066655 --> -0.133322).  Saving model ...
Epoch: 9 cost time: 0.4031941890716553
Epoch: 9, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.3493790626525879
Epoch: 10, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.32819151878356934
Epoch: 11, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3400850296020508
Epoch: 12, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.3473794460296631
Epoch: 13, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4083714485168457
Epoch: 14, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.3556065559387207
Epoch: 15, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4029972553253174
Epoch: 16, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.38440418243408203
Epoch: 17, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.3912220001220703
Epoch: 18, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 210755
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5511178970336914
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36945486068725586
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3152174949645996
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.32935023307800293
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.46164989471435547
Epoch: 5, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.34374547004699707
Epoch: 6, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.32369065284729004
Epoch: 7, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.41486310958862305
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.3439619541168213
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.35053324699401855
Epoch: 10, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.32784366607666016
Epoch: 11, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.4609110355377197
Epoch: 12, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.35523319244384766
Epoch: 13, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.32088446617126465
Epoch: 14, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.3391144275665283
Epoch: 15, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.30423951148986816
Epoch: 16, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.36331820487976074
Epoch: 17, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.3769395351409912
Epoch: 18, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.35263776779174805
Epoch: 19, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 0.4333820343017578
Epoch: 20, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 0.3457310199737549
Epoch: 21, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 22 cost time: 0.383852481842041
Epoch: 22, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 23 cost time: 0.3402419090270996
Epoch: 23, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 24 cost time: 0.33759474754333496
Epoch: 24, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 25 cost time: 0.4140651226043701
Epoch: 25, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 26 cost time: 0.3978312015533447
Epoch: 26, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 27 cost time: 0.37250423431396484
Epoch: 27, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 28 cost time: 0.40055322647094727
Epoch: 28, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 29 cost time: 0.4534304141998291
Epoch: 29, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 30 cost time: 0.3752748966217041
Epoch: 30, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 31 cost time: 0.32793498039245605
Epoch: 31, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 32 cost time: 0.35489320755004883
Epoch: 32, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 33 cost time: 0.44442319869995117
Epoch: 33, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 0.388669490814209
Epoch: 34, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.38871049880981445
Epoch: 35, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 0.34879040718078613
Epoch: 36, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.48638081550598145
Epoch: 37, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 38 cost time: 0.40718555450439453
Epoch: 38, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 0.34471797943115234
Epoch: 39, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 40 cost time: 0.38387608528137207
Epoch: 40, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.40759801864624023
Epoch: 41, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4423251152038574
Epoch: 42, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.41316771507263184
Epoch: 43, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.35443878173828125
Epoch: 44, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 45 cost time: 0.34815001487731934
Epoch: 45, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.32750630378723145
Epoch: 46, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.3550755977630615
Epoch: 47, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.33396220207214355
Epoch: 48, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.3655271530151367
Epoch: 49, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.3846855163574219
Epoch: 50, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 207395
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5320987701416016
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3661000728607178
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.395876407623291
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.3805985450744629
Epoch: 4, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.096 Vali Acc: 0.133 Test Loss: 1.096 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3964810371398926
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.095 Vali Acc: 0.133 Test Loss: 1.095 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3299577236175537
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.095 Vali Acc: 0.133 Test Loss: 1.095 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.3787403106689453
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.3706052303314209
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.37955260276794434
Epoch: 9, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.42188119888305664
Epoch: 10, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 11 cost time: 0.318584680557251
Epoch: 11, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 12 cost time: 0.3677980899810791
Epoch: 12, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 13 cost time: 0.3385920524597168
Epoch: 13, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 14 cost time: 0.5151455402374268
Epoch: 14, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 15 cost time: 0.39603543281555176
Epoch: 15, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 16 cost time: 0.39550304412841797
Epoch: 16, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 17 cost time: 0.34328746795654297
Epoch: 17, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 18 cost time: 0.36786699295043945
Epoch: 18, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 19 cost time: 0.33963942527770996
Epoch: 19, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3919692039489746
Epoch: 20, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 21 cost time: 0.34358930587768555
Epoch: 21, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.41539549827575684
Epoch: 22, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3737354278564453
Epoch: 23, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3749418258666992
Epoch: 24, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3255805969238281
Epoch: 25, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.39097023010253906
Epoch: 26, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.39824604988098145
Epoch: 27, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.3962376117706299
Epoch: 28, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4023582935333252
Epoch: 29, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.3992652893066406
Epoch: 30, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 207075
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6569702625274658
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.43618273735046387
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4249100685119629
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.36249399185180664
Epoch: 4, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.37877368927001953
Epoch: 5, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.42394399642944336
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4048194885253906
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.44023799896240234
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3747749328613281
Epoch: 9, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.42096877098083496
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4161078929901123
Epoch: 11, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4165632724761963
Epoch: 12, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3970615863800049
Epoch: 13, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4575159549713135
Epoch: 14, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.39930272102355957
Epoch: 15, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.35703468322753906
Epoch: 16, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.4379689693450928
Epoch: 17, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.3806791305541992
Epoch: 18, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.39091968536376953
Epoch: 19, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.4126255512237549
Epoch: 20, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.4208049774169922
Epoch: 21, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.488222599029541
Epoch: 22, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.3814249038696289
Epoch: 23, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3868858814239502
Epoch: 24, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.39142656326293945
Epoch: 25, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4313371181488037
Epoch: 26, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.3463728427886963
Epoch: 27, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.38608622550964355
Epoch: 28, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4019956588745117
Epoch: 29, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.39276838302612305
Epoch: 30, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.3654348850250244
Epoch: 31, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.3810539245605469
Epoch: 32, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.452315092086792
Epoch: 33, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.3296928405761719
Epoch: 34, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 35 cost time: 0.392611026763916
Epoch: 35, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 36 cost time: 0.42115306854248047
Epoch: 36, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 37 cost time: 0.4080648422241211
Epoch: 37, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 38 cost time: 0.45815324783325195
Epoch: 38, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 39 cost time: 0.401200532913208
Epoch: 39, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.035 Vali Acc: 0.667 Test Loss: 1.035 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 40 cost time: 0.4047236442565918
Epoch: 40, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.034 Vali Acc: 0.667 Test Loss: 1.034 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 41 cost time: 0.4640614986419678
Epoch: 41, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 42 cost time: 0.36827921867370605
Epoch: 42, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 43 cost time: 0.4446377754211426
Epoch: 43, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 44 cost time: 0.38964009284973145
Epoch: 44, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 45 cost time: 0.41438746452331543
Epoch: 45, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 46 cost time: 0.43961501121520996
Epoch: 46, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.37967896461486816
Epoch: 47, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4446256160736084
Epoch: 48, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.379058837890625
Epoch: 49, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.38234758377075195
Epoch: 50, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 208771
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6900920867919922
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36911630630493164
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37981653213500977
Epoch: 3, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.39765357971191406
Epoch: 4, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.36896300315856934
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3691682815551758
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3368875980377197
Epoch: 7, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.36148834228515625
Epoch: 8, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.336944580078125
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3975660800933838
Epoch: 10, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3342461585998535
Epoch: 11, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 211235
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.692314863204956
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3820071220397949
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3560061454772949
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3384974002838135
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3696279525756836
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3312809467315674
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3864114284515381
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4503810405731201
Epoch: 8, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.32132959365844727
Epoch: 9, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.36371827125549316
Epoch: 10, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.36881160736083984
Epoch: 11, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.34040284156799316
Epoch: 12, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3320021629333496
Epoch: 13, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.39632487297058105
Epoch: 14, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3072671890258789
Epoch: 15, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3426206111907959
Epoch: 16, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.3531625270843506
Epoch: 17, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.3973579406738281
Epoch: 18, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.3362133502960205
Epoch: 19, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.3735313415527344
Epoch: 20, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.36617255210876465
Epoch: 21, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.3607797622680664
Epoch: 22, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.3623373508453369
Epoch: 23, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.31464242935180664
Epoch: 24, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3428184986114502
Epoch: 25, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.39627742767333984
Epoch: 26, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.41130542755126953
Epoch: 27, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4105644226074219
Epoch: 28, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.33178067207336426
Epoch: 29, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4105031490325928
Epoch: 30, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.33684849739074707
Epoch: 31, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3287332057952881
Epoch: 32, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 33 cost time: 0.35419464111328125
Epoch: 33, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.36759138107299805
Epoch: 34, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.34962987899780273
Epoch: 35, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.38712120056152344
Epoch: 36, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3306715488433838
Epoch: 37, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.36380720138549805
Epoch: 38, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.3848762512207031
Epoch: 39, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.36141419410705566
Epoch: 40, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.3518800735473633
Epoch: 41, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.3600432872772217
Epoch: 42, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 214467
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6901943683624268
Epoch: 1, Steps: 1 | Train Loss: 1.403 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.3985106945037842
Epoch: 2, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.41081976890563965
Epoch: 3, Steps: 1 | Train Loss: 0.966 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.32874536514282227
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.41813182830810547
Epoch: 5, Steps: 1 | Train Loss: 0.771 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.41893935203552246
Epoch: 6, Steps: 1 | Train Loss: 0.623 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.3488588333129883
Epoch: 7, Steps: 1 | Train Loss: 0.507 Vali Loss: 0.937 Vali Acc: 0.533 Test Loss: 0.937 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.39169979095458984
Epoch: 8, Steps: 1 | Train Loss: 0.374 Vali Loss: 0.922 Vali Acc: 0.600 Test Loss: 0.922 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 9 cost time: 0.3765895366668701
Epoch: 9, Steps: 1 | Train Loss: 0.259 Vali Loss: 0.914 Vali Acc: 0.533 Test Loss: 0.914 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45280909538269043
Epoch: 10, Steps: 1 | Train Loss: 0.185 Vali Loss: 0.914 Vali Acc: 0.533 Test Loss: 0.914 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4623575210571289
Epoch: 11, Steps: 1 | Train Loss: 0.114 Vali Loss: 0.924 Vali Acc: 0.467 Test Loss: 0.924 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4372224807739258
Epoch: 12, Steps: 1 | Train Loss: 0.066 Vali Loss: 0.946 Vali Acc: 0.467 Test Loss: 0.946 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4018692970275879
Epoch: 13, Steps: 1 | Train Loss: 0.033 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.38417792320251465
Epoch: 14, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4458906650543213
Epoch: 15, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.40068936347961426
Epoch: 16, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.3569350242614746
Epoch: 17, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.180 Vali Acc: 0.533 Test Loss: 1.180 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4244070053100586
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.239 Vali Acc: 0.533 Test Loss: 1.239 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2419715
model size : 9.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5332677364349365
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.37720513343811035
Epoch: 2, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37642455101013184
Epoch: 3, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.3634161949157715
Epoch: 4, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.34604382514953613
Epoch: 5, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.376126766204834
Epoch: 6, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.3605990409851074
Epoch: 7, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.35273218154907227
Epoch: 8, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.3924751281738281
Epoch: 9, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.333848237991333
Epoch: 10, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.4555232524871826
Epoch: 11, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.158 Vali Acc: 0.533 Test Loss: 1.158 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.39931392669677734
Epoch: 12, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3427278995513916
Epoch: 13, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.342113733291626
Epoch: 14, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.454085111618042
Epoch: 15, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5863790512084961
Epoch: 16, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.3860940933227539
Epoch: 17, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.258 Vali Acc: 0.533 Test Loss: 1.258 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4092090129852295
Epoch: 18, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.289 Vali Acc: 0.533 Test Loss: 1.289 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.37717199325561523
Epoch: 19, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.321 Vali Acc: 0.533 Test Loss: 1.321 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.3507254123687744
Epoch: 20, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.355 Vali Acc: 0.533 Test Loss: 1.355 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.3541584014892578
Epoch: 21, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.390 Vali Acc: 0.533 Test Loss: 1.390 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2315779
model size : 8.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5264661312103271
Epoch: 1, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.34918975830078125
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4561748504638672
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.357255220413208
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.3881518840789795
Epoch: 5, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.39853763580322266
Epoch: 6, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.3797285556793213
Epoch: 7, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.4137897491455078
Epoch: 8, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4760866165161133
Epoch: 9, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4714064598083496
Epoch: 10, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.45048999786376953
Epoch: 11, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3742973804473877
Epoch: 12, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4069395065307617
Epoch: 13, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.3576512336730957
Epoch: 14, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.35306882858276367
Epoch: 15, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4052853584289551
Epoch: 16, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.3993873596191406
Epoch: 17, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2291971
model size : 8.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7409031391143799
Epoch: 1, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.35100436210632324
Epoch: 2, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.326171875
Epoch: 3, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.3158745765686035
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.34950971603393555
Epoch: 5, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.35930442810058594
Epoch: 6, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3737330436706543
Epoch: 7, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3186647891998291
Epoch: 8, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.36627793312072754
Epoch: 9, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.38506388664245605
Epoch: 10, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3345808982849121
Epoch: 11, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.39565587043762207
Epoch: 12, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.450089693069458
Epoch: 13, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.35102081298828125
Epoch: 14, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.30603599548339844
Epoch: 15, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.33258843421936035
Epoch: 16, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.39276814460754395
Epoch: 17, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.39801764488220215
Epoch: 18, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4085092544555664
Epoch: 19, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3353760242462158
Epoch: 20, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.35292696952819824
Epoch: 21, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.3179020881652832
Epoch: 22, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.157 Vali Acc: 0.533 Test Loss: 1.157 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 23 cost time: 0.35867786407470703
Epoch: 23, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.175 Vali Acc: 0.533 Test Loss: 1.175 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.34202146530151367
Epoch: 24, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.193 Vali Acc: 0.533 Test Loss: 1.193 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.37866830825805664
Epoch: 25, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.212 Vali Acc: 0.533 Test Loss: 1.212 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3981943130493164
Epoch: 26, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.3433420658111572
Epoch: 27, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.250 Vali Acc: 0.467 Test Loss: 1.250 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3445165157318115
Epoch: 28, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.269 Vali Acc: 0.467 Test Loss: 1.269 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.31731343269348145
Epoch: 29, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.287 Vali Acc: 0.467 Test Loss: 1.287 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.32337474822998047
Epoch: 30, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.305 Vali Acc: 0.467 Test Loss: 1.305 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.329498291015625
Epoch: 31, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.322 Vali Acc: 0.467 Test Loss: 1.322 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.37047719955444336
Epoch: 32, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.339 Vali Acc: 0.467 Test Loss: 1.339 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2289411
model size : 8.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6073272228240967
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.3692622184753418
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.031 Vali Acc: 0.333 Test Loss: 1.031 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.34131860733032227
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.027 Vali Acc: 0.333 Test Loss: 1.027 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.35221076011657715
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.3847925662994385
Epoch: 5, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.020 Vali Acc: 0.333 Test Loss: 1.020 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.34238648414611816
Epoch: 6, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.017 Vali Acc: 0.333 Test Loss: 1.017 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.3416588306427002
Epoch: 7, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.3560338020324707
Epoch: 8, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.35959625244140625
Epoch: 9, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.388782262802124
Epoch: 10, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.003 Vali Acc: 0.600 Test Loss: 1.003 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.47168946266174316
Epoch: 11, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.3331730365753174
Epoch: 12, Steps: 1 | Train Loss: 0.428 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3383362293243408
Epoch: 13, Steps: 1 | Train Loss: 0.400 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49147915840148926
Epoch: 14, Steps: 1 | Train Loss: 0.343 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.385936975479126
Epoch: 15, Steps: 1 | Train Loss: 0.305 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.36473512649536133
Epoch: 16, Steps: 1 | Train Loss: 0.263 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.39795994758605957
Epoch: 17, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.37535643577575684
Epoch: 18, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3322579860687256
Epoch: 19, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5075740814208984
Epoch: 20, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.43836092948913574
Epoch: 21, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2299907
model size : 8.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6868746280670166
Epoch: 1, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4034903049468994
Epoch: 2, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.4211103916168213
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.3827841281890869
Epoch: 4, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.35425281524658203
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.33916640281677246
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.3760993480682373
Epoch: 7, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.384979248046875
Epoch: 8, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3506655693054199
Epoch: 9, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.40320634841918945
Epoch: 10, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.34840822219848633
Epoch: 11, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.36829638481140137
Epoch: 12, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3837757110595703
Epoch: 13, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.343397855758667
Epoch: 14, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.36291027069091797
Epoch: 15, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.3906412124633789
Epoch: 16, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.38636302947998047
Epoch: 17, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3862881660461426
Epoch: 18, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.3915886878967285
Epoch: 19, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3517482280731201
Epoch: 20, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.36112236976623535
Epoch: 21, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.35070204734802246
Epoch: 22, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.30536699295043945
Epoch: 23, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.38747215270996094
Epoch: 24, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.40389347076416016
Epoch: 25, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.34246277809143066
Epoch: 26, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.36405086517333984
Epoch: 27, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4030280113220215
Epoch: 28, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.159 Vali Acc: 0.533 Test Loss: 1.159 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2322691
model size : 8.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6167340278625488
Epoch: 1, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.3692307472229004
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.36551642417907715
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.34111571311950684
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3845956325531006
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3861978054046631
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.39380598068237305
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.32712745666503906
Epoch: 8, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.35273241996765137
Epoch: 9, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4109065532684326
Epoch: 10, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.34285831451416016
Epoch: 11, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2345475
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.488312005996704
Epoch: 1, Steps: 1 | Train Loss: 1.359 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.46860766410827637
Epoch: 2, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.38872694969177246
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.35918474197387695
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4250321388244629
Epoch: 5, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.35250067710876465
Epoch: 6, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.32798314094543457
Epoch: 7, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.36485815048217773
Epoch: 8, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.3802003860473633
Epoch: 9, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.38080883026123047
Epoch: 10, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4506561756134033
Epoch: 11, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.38744115829467773
Epoch: 12, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3607006072998047
Epoch: 13, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.37289953231811523
Epoch: 14, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.36659717559814453
Epoch: 15, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.3690786361694336
Epoch: 16, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.41455531120300293
Epoch: 17, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.36931276321411133
Epoch: 18, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.152 Vali Acc: 0.533 Test Loss: 1.152 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.547351598739624
Epoch: 19, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.36257410049438477
Epoch: 20, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.205 Vali Acc: 0.533 Test Loss: 1.205 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.44492650032043457
Epoch: 21, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.234 Vali Acc: 0.533 Test Loss: 1.234 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.39992570877075195
Epoch: 22, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.265 Vali Acc: 0.600 Test Loss: 1.265 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599987).  Saving model ...
Epoch: 23 cost time: 0.37331414222717285
Epoch: 23, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.296 Vali Acc: 0.600 Test Loss: 1.296 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.38998866081237793
Epoch: 24, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.376448392868042
Epoch: 25, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.358 Vali Acc: 0.600 Test Loss: 1.358 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3292872905731201
Epoch: 26, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.389 Vali Acc: 0.533 Test Loss: 1.389 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.38709139823913574
Epoch: 27, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.419 Vali Acc: 0.533 Test Loss: 1.419 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3424549102783203
Epoch: 28, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.448 Vali Acc: 0.533 Test Loss: 1.448 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.3845052719116211
Epoch: 29, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.533 Test Loss: 1.477 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.3323631286621094
Epoch: 30, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.533 Test Loss: 1.504 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.3275015354156494
Epoch: 31, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.600 Test Loss: 1.530 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.328951358795166
Epoch: 32, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.600 Test Loss: 1.555 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 685571
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5874950885772705
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.3462841510772705
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3343677520751953
Epoch: 3, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.3340480327606201
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.41223812103271484
Epoch: 5, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.40590357780456543
Epoch: 6, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.3559086322784424
Epoch: 7, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.37319016456604004
Epoch: 8, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.5237352848052979
Epoch: 9, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.35692548751831055
Epoch: 10, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.3499794006347656
Epoch: 11, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.3616321086883545
Epoch: 12, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.34038448333740234
Epoch: 13, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.3207685947418213
Epoch: 14, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3260669708251953
Epoch: 15, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.40358972549438477
Epoch: 16, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.33646082878112793
Epoch: 17, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.36664247512817383
Epoch: 18, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.41774487495422363
Epoch: 19, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.36984848976135254
Epoch: 20, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 633603
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6085903644561768
Epoch: 1, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.33841419219970703
Epoch: 2, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.3333759307861328
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.32060933113098145
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.3491642475128174
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.46268606185913086
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.3402547836303711
Epoch: 7, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.34803342819213867
Epoch: 8, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3631601333618164
Epoch: 9, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3395049571990967
Epoch: 10, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.41074395179748535
Epoch: 11, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3538682460784912
Epoch: 12, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3485581874847412
Epoch: 13, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.33705902099609375
Epoch: 14, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.35695338249206543
Epoch: 15, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3550412654876709
Epoch: 16, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3582794666290283
Epoch: 17, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4018890857696533
Epoch: 18, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.390958309173584
Epoch: 19, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4324491024017334
Epoch: 20, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.39977216720581055
Epoch: 21, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3910810947418213
Epoch: 22, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.403517484664917
Epoch: 23, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.3736245632171631
Epoch: 24, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.43814754486083984
Epoch: 25, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 621699
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6150920391082764
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.37668538093566895
Epoch: 2, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3690826892852783
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3452184200286865
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3518788814544678
Epoch: 5, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.36612653732299805
Epoch: 6, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.35053515434265137
Epoch: 7, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4474458694458008
Epoch: 8, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.3484232425689697
Epoch: 9, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.33576011657714844
Epoch: 10, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.345963716506958
Epoch: 11, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.36030030250549316
Epoch: 12, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.3525235652923584
Epoch: 13, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.35330963134765625
Epoch: 14, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4771261215209961
Epoch: 15, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.32956957817077637
Epoch: 16, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3594858646392822
Epoch: 17, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3925294876098633
Epoch: 18, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3942997455596924
Epoch: 19, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.38001489639282227
Epoch: 20, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.3924427032470703
Epoch: 21, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.3636765480041504
Epoch: 22, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.080 Vali Acc: 0.667 Test Loss: 1.080 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 23 cost time: 0.38437318801879883
Epoch: 23, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.088 Vali Acc: 0.667 Test Loss: 1.088 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3157048225402832
Epoch: 24, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.096 Vali Acc: 0.667 Test Loss: 1.096 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.33110928535461426
Epoch: 25, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.31493234634399414
Epoch: 26, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.3806276321411133
Epoch: 27, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3627200126647949
Epoch: 28, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.135 Vali Acc: 0.533 Test Loss: 1.135 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.3674602508544922
Epoch: 29, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.33974242210388184
Epoch: 30, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.155 Vali Acc: 0.533 Test Loss: 1.155 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.3713541030883789
Epoch: 31, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.165 Vali Acc: 0.533 Test Loss: 1.165 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3613722324371338
Epoch: 32, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.175 Vali Acc: 0.533 Test Loss: 1.175 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 620419
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5172371864318848
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.46806764602661133
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.41996169090270996
Epoch: 3, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.4850752353668213
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3747978210449219
Epoch: 5, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.39997148513793945
Epoch: 6, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4357283115386963
Epoch: 7, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.3898804187774658
Epoch: 8, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.4460482597351074
Epoch: 9, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.37693095207214355
Epoch: 10, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.38840198516845703
Epoch: 11, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4667975902557373
Epoch: 12, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4878501892089844
Epoch: 13, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.38665151596069336
Epoch: 14, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.429462194442749
Epoch: 15, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.3843352794647217
Epoch: 16, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.3845961093902588
Epoch: 17, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4288802146911621
Epoch: 18, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 625667
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5628948211669922
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.32912111282348633
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.38095998764038086
Epoch: 3, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.3816864490509033
Epoch: 4, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.3239867687225342
Epoch: 5, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.47942256927490234
Epoch: 6, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3873624801635742
Epoch: 7, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3667948246002197
Epoch: 8, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4044945240020752
Epoch: 9, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.33990931510925293
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.3696126937866211
Epoch: 11, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.32837390899658203
Epoch: 12, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.3875124454498291
Epoch: 13, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3571925163269043
Epoch: 14, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.40427160263061523
Epoch: 15, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.34787607192993164
Epoch: 16, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.36684203147888184
Epoch: 17, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4036130905151367
Epoch: 18, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.3494386672973633
Epoch: 19, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.34654808044433594
Epoch: 20, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.38969969749450684
Epoch: 21, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.43227481842041016
Epoch: 22, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.43332481384277344
Epoch: 23, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.35629725456237793
Epoch: 24, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.33025336265563965
Epoch: 25, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.34804463386535645
Epoch: 26, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4260721206665039
Epoch: 27, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.32538890838623047
Epoch: 28, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 29 cost time: 0.37894749641418457
Epoch: 29, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 0.3108854293823242
Epoch: 30, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.3972206115722656
Epoch: 31, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4650278091430664
Epoch: 32, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4605228900909424
Epoch: 33, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4081423282623291
Epoch: 34, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.42644476890563965
Epoch: 35, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4215281009674072
Epoch: 36, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.3485524654388428
Epoch: 37, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.209 Vali Acc: 0.600 Test Loss: 1.209 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.3352034091949463
Epoch: 38, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.217 Vali Acc: 0.600 Test Loss: 1.217 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.3429696559906006
Epoch: 39, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.225 Vali Acc: 0.600 Test Loss: 1.225 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 637059
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5122089385986328
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.31292128562927246
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3415517807006836
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.34452056884765625
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3034219741821289
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4031708240509033
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.39725589752197266
Epoch: 7, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.3686699867248535
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.38590502738952637
Epoch: 9, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3951418399810791
Epoch: 10, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3241715431213379
Epoch: 11, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.3399503231048584
Epoch: 12, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.34277987480163574
Epoch: 13, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3314034938812256
Epoch: 14, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3934054374694824
Epoch: 15, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.3032708168029785
Epoch: 16, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.34232378005981445
Epoch: 17, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.35042905807495117
Epoch: 18, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.41539502143859863
Epoch: 19, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.3410012722015381
Epoch: 20, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.3243122100830078
Epoch: 21, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3905770778656006
Epoch: 22, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.3358190059661865
Epoch: 23, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.3356468677520752
Epoch: 24, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.34438657760620117
Epoch: 25, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 648451
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6487274169921875
Epoch: 1, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.39141178131103516
Epoch: 2, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5151674747467041
Epoch: 3, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3643355369567871
Epoch: 4, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.39807939529418945
Epoch: 5, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.36622166633605957
Epoch: 6, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.35398030281066895
Epoch: 7, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.33853673934936523
Epoch: 8, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.4484083652496338
Epoch: 9, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.3985416889190674
Epoch: 10, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.3511512279510498
Epoch: 11, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.4007852077484131
Epoch: 12, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.3551924228668213
Epoch: 13, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.083 Vali Acc: 0.600 Test Loss: 1.083 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.3217473030090332
Epoch: 14, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.31577110290527344
Epoch: 15, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3930931091308594
Epoch: 16, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.38295745849609375
Epoch: 17, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.38504624366760254
Epoch: 18, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.37006688117980957
Epoch: 19, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.3397204875946045
Epoch: 20, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.137 Vali Acc: 0.600 Test Loss: 1.137 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4193992614746094
Epoch: 21, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.36780714988708496
Epoch: 22, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.169 Vali Acc: 0.600 Test Loss: 1.169 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4325525760650635
Epoch: 23, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.186 Vali Acc: 0.600 Test Loss: 1.186 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 211715
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6384716033935547
Epoch: 1, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.38622212409973145
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3690147399902344
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.31681323051452637
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.39168405532836914
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3525223731994629
Epoch: 6, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.37803006172180176
Epoch: 7, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4137754440307617
Epoch: 8, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3675823211669922
Epoch: 9, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.31471729278564453
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.36830759048461914
Epoch: 11, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.33753132820129395
Epoch: 12, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.39215946197509766
Epoch: 13, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.41988158226013184
Epoch: 14, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.37526416778564453
Epoch: 15, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3776278495788574
Epoch: 16, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.37209439277648926
Epoch: 17, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3682706356048584
Epoch: 18, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.37534308433532715
Epoch: 19, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.39884519577026367
Epoch: 20, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.4005606174468994
Epoch: 21, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.35683441162109375
Epoch: 22, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3618040084838867
Epoch: 23, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.33973145484924316
Epoch: 24, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.36496853828430176
Epoch: 25, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3709299564361572
Epoch: 26, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3264787197113037
Epoch: 27, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.3238818645477295
Epoch: 28, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.40746116638183594
Epoch: 29, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.3855245113372803
Epoch: 30, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 185731
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5767362117767334
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.32567358016967773
Epoch: 2, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.37470102310180664
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.35537266731262207
Epoch: 4, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.33589982986450195
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.33403921127319336
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3540165424346924
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3874344825744629
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.28877735137939453
Epoch: 9, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.33059191703796387
Epoch: 10, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.3216578960418701
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.3416881561279297
Epoch: 12, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.3245551586151123
Epoch: 13, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.3915529251098633
Epoch: 14, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.39200735092163086
Epoch: 15, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3463289737701416
Epoch: 16, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.3573763370513916
Epoch: 17, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.39951586723327637
Epoch: 18, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.359879732131958
Epoch: 19, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3587665557861328
Epoch: 20, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4522850513458252
Epoch: 21, Steps: 1 | Train Loss: 0.396 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.3281588554382324
Epoch: 22, Steps: 1 | Train Loss: 0.328 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.34243273735046387
Epoch: 23, Steps: 1 | Train Loss: 0.293 Vali Loss: 0.984 Vali Acc: 0.467 Test Loss: 0.984 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.38670778274536133
Epoch: 24, Steps: 1 | Train Loss: 0.294 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3526787757873535
Epoch: 25, Steps: 1 | Train Loss: 0.272 Vali Loss: 0.974 Vali Acc: 0.467 Test Loss: 0.974 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4409162998199463
Epoch: 26, Steps: 1 | Train Loss: 0.230 Vali Loss: 0.971 Vali Acc: 0.467 Test Loss: 0.971 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.3614652156829834
Epoch: 27, Steps: 1 | Train Loss: 0.206 Vali Loss: 0.968 Vali Acc: 0.467 Test Loss: 0.968 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3770270347595215
Epoch: 28, Steps: 1 | Train Loss: 0.192 Vali Loss: 0.965 Vali Acc: 0.467 Test Loss: 0.965 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.3733689785003662
Epoch: 29, Steps: 1 | Train Loss: 0.180 Vali Loss: 0.964 Vali Acc: 0.467 Test Loss: 0.964 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.35413479804992676
Epoch: 30, Steps: 1 | Train Loss: 0.158 Vali Loss: 0.963 Vali Acc: 0.533 Test Loss: 0.963 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 31 cost time: 0.34824705123901367
Epoch: 31, Steps: 1 | Train Loss: 0.136 Vali Loss: 0.962 Vali Acc: 0.533 Test Loss: 0.962 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 32 cost time: 0.35183000564575195
Epoch: 32, Steps: 1 | Train Loss: 0.123 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.3872871398925781
Epoch: 33, Steps: 1 | Train Loss: 0.114 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.40500402450561523
Epoch: 34, Steps: 1 | Train Loss: 0.102 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4234955310821533
Epoch: 35, Steps: 1 | Train Loss: 0.094 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.34749460220336914
Epoch: 36, Steps: 1 | Train Loss: 0.079 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.36038827896118164
Epoch: 37, Steps: 1 | Train Loss: 0.071 Vali Loss: 0.969 Vali Acc: 0.667 Test Loss: 0.969 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 38 cost time: 0.40895557403564453
Epoch: 38, Steps: 1 | Train Loss: 0.064 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3364880084991455
Epoch: 39, Steps: 1 | Train Loss: 0.059 Vali Loss: 0.974 Vali Acc: 0.667 Test Loss: 0.974 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.3419806957244873
Epoch: 40, Steps: 1 | Train Loss: 0.051 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4315049648284912
Epoch: 41, Steps: 1 | Train Loss: 0.047 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.3615901470184326
Epoch: 42, Steps: 1 | Train Loss: 0.043 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.3707997798919678
Epoch: 43, Steps: 1 | Train Loss: 0.040 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4142277240753174
Epoch: 44, Steps: 1 | Train Loss: 0.036 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.34815502166748047
Epoch: 45, Steps: 1 | Train Loss: 0.036 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.4287097454071045
Epoch: 46, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.3516654968261719
Epoch: 47, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 179779
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6943244934082031
Epoch: 1, Steps: 1 | Train Loss: 1.376 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.38853979110717773
Epoch: 2, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3338038921356201
Epoch: 3, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3272054195404053
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.344576358795166
Epoch: 5, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3220646381378174
Epoch: 6, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.31137871742248535
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.34827589988708496
Epoch: 8, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.33307766914367676
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.3905203342437744
Epoch: 10, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.3261129856109619
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.36939358711242676
Epoch: 12, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.33483028411865234
Epoch: 13, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.3390161991119385
Epoch: 14, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.34349966049194336
Epoch: 15, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.3502919673919678
Epoch: 16, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.383969783782959
Epoch: 17, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.32530832290649414
Epoch: 18, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.3329765796661377
Epoch: 19, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.3711376190185547
Epoch: 20, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.36118292808532715
Epoch: 21, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.40691256523132324
Epoch: 22, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.35741496086120605
Epoch: 23, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.4055638313293457
Epoch: 24, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4194300174713135
Epoch: 25, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.457857608795166
Epoch: 26, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3542912006378174
Epoch: 27, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 0.4604027271270752
Epoch: 28, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.46978139877319336
Epoch: 29, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.39429163932800293
Epoch: 30, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.38858938217163086
Epoch: 31, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.3916134834289551
Epoch: 32, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.3954143524169922
Epoch: 33, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.35124850273132324
Epoch: 34, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.3255045413970947
Epoch: 35, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.44480180740356445
Epoch: 36, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.41120481491088867
Epoch: 37, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 179139
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.500962495803833
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 0.3264896869659424
Epoch: 2, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 0.37883591651916504
Epoch: 3, Steps: 1 | Train Loss: 1.170 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.38681912422180176
Epoch: 4, Steps: 1 | Train Loss: 1.173 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 5 cost time: 0.36612772941589355
Epoch: 5, Steps: 1 | Train Loss: 1.123 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 0.34221696853637695
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 0.4447319507598877
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.3918421268463135
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 0.984 Vali Acc: 0.467 Test Loss: 0.984 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 9 cost time: 0.33522963523864746
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 0.980 Vali Acc: 0.467 Test Loss: 0.980 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 10 cost time: 0.4140903949737549
Epoch: 10, Steps: 1 | Train Loss: 0.965 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 11 cost time: 0.3903050422668457
Epoch: 11, Steps: 1 | Train Loss: 0.847 Vali Loss: 0.973 Vali Acc: 0.400 Test Loss: 0.973 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40006065368652344
Epoch: 12, Steps: 1 | Train Loss: 0.912 Vali Loss: 0.969 Vali Acc: 0.400 Test Loss: 0.969 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3903622627258301
Epoch: 13, Steps: 1 | Train Loss: 0.837 Vali Loss: 0.965 Vali Acc: 0.400 Test Loss: 0.965 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4346604347229004
Epoch: 14, Steps: 1 | Train Loss: 0.821 Vali Loss: 0.961 Vali Acc: 0.400 Test Loss: 0.961 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.37705397605895996
Epoch: 15, Steps: 1 | Train Loss: 0.748 Vali Loss: 0.957 Vali Acc: 0.400 Test Loss: 0.957 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.36650681495666504
Epoch: 16, Steps: 1 | Train Loss: 0.761 Vali Loss: 0.953 Vali Acc: 0.400 Test Loss: 0.953 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.30035829544067383
Epoch: 17, Steps: 1 | Train Loss: 0.671 Vali Loss: 0.948 Vali Acc: 0.400 Test Loss: 0.948 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.42391347885131836
Epoch: 18, Steps: 1 | Train Loss: 0.630 Vali Loss: 0.944 Vali Acc: 0.400 Test Loss: 0.944 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.3305962085723877
Epoch: 19, Steps: 1 | Train Loss: 0.618 Vali Loss: 0.939 Vali Acc: 0.400 Test Loss: 0.939 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.37319445610046387
Epoch: 20, Steps: 1 | Train Loss: 0.548 Vali Loss: 0.934 Vali Acc: 0.400 Test Loss: 0.934 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 181763
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5377202033996582
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.338604211807251
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3703789710998535
Epoch: 3, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3526601791381836
Epoch: 4, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.43291234970092773
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.3431539535522461
Epoch: 6, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.37799930572509766
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.38821911811828613
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.36774468421936035
Epoch: 9, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3600776195526123
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.38668346405029297
Epoch: 11, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5136594772338867
Epoch: 12, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3394322395324707
Epoch: 13, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.39289259910583496
Epoch: 14, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.3176248073577881
Epoch: 15, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.36953020095825195
Epoch: 16, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.3820607662200928
Epoch: 17, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.3561372756958008
Epoch: 18, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.3663332462310791
Epoch: 19, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.3387444019317627
Epoch: 20, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.3462643623352051
Epoch: 21, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.40400242805480957
Epoch: 22, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.39537930488586426
Epoch: 23, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4136641025543213
Epoch: 24, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.35610342025756836
Epoch: 25, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 0.37850022315979004
Epoch: 26, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 0.45178866386413574
Epoch: 27, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.38614320755004883
Epoch: 28, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 29 cost time: 0.3436264991760254
Epoch: 29, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 0.36966514587402344
Epoch: 30, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 0.4212157726287842
Epoch: 31, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 32 cost time: 0.3501152992248535
Epoch: 32, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 33 cost time: 0.40688014030456543
Epoch: 33, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 34 cost time: 0.3872814178466797
Epoch: 34, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 35 cost time: 0.3439784049987793
Epoch: 35, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 36 cost time: 0.3983650207519531
Epoch: 36, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.39955711364746094
Epoch: 37, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.3225862979888916
Epoch: 38, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.383866548538208
Epoch: 39, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4004371166229248
Epoch: 40, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.40342020988464355
Epoch: 41, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.43917369842529297
Epoch: 42, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.3756561279296875
Epoch: 43, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.37343287467956543
Epoch: 44, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.42685627937316895
Epoch: 45, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 46 cost time: 0.3281521797180176
Epoch: 46, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4061768054962158
Epoch: 47, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.3331332206726074
Epoch: 48, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.37338829040527344
Epoch: 49, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4112532138824463
Epoch: 50, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 187459
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5194849967956543
Epoch: 1, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.39382338523864746
Epoch: 2, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37671422958374023
Epoch: 3, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.34222412109375
Epoch: 4, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.382657527923584
Epoch: 5, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3794593811035156
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.36694908142089844
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.330639123916626
Epoch: 8, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.41869091987609863
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.45828771591186523
Epoch: 10, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.32721638679504395
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.36808347702026367
Epoch: 12, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.36118578910827637
Epoch: 13, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.3207526206970215
Epoch: 14, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.143 Vali Acc: 0.533 Test Loss: 1.143 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3290400505065918
Epoch: 15, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.144 Vali Acc: 0.533 Test Loss: 1.144 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.40114665031433105
Epoch: 16, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.29506993293762207
Epoch: 17, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.37220239639282227
Epoch: 18, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.149 Vali Acc: 0.533 Test Loss: 1.149 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.45453596115112305
Epoch: 19, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.32985520362854004
Epoch: 20, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.39902162551879883
Epoch: 21, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.3489038944244385
Epoch: 22, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.31551241874694824
Epoch: 23, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 193155
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.542754888534546
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3510615825653076
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3867316246032715
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3296031951904297
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.37516117095947266
Epoch: 5, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3382298946380615
Epoch: 6, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.32472848892211914
Epoch: 7, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.41773128509521484
Epoch: 8, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.33224058151245117
Epoch: 9, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.34018802642822266
Epoch: 10, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3090534210205078
Epoch: 11, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.3306307792663574
Epoch: 12, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.30454063415527344
Epoch: 13, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.31926584243774414
Epoch: 14, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.2917168140411377
Epoch: 15, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3305497169494629
Epoch: 16, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.36327576637268066
Epoch: 17, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3455023765563965
Epoch: 18, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3815922737121582
Epoch: 19, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.004 Vali Acc: 0.400 Test Loss: 1.004 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.36390042304992676
Epoch: 20, Steps: 1 | Train Loss: 0.284 Vali Loss: 0.998 Vali Acc: 0.400 Test Loss: 0.998 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4512817859649658
Epoch: 21, Steps: 1 | Train Loss: 0.242 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.3805680274963379
Epoch: 22, Steps: 1 | Train Loss: 0.217 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.3107640743255615
Epoch: 23, Steps: 1 | Train Loss: 0.189 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.3227100372314453
Epoch: 24, Steps: 1 | Train Loss: 0.172 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.36135387420654297
Epoch: 25, Steps: 1 | Train Loss: 0.154 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.398176908493042
Epoch: 26, Steps: 1 | Train Loss: 0.133 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3678593635559082
Epoch: 27, Steps: 1 | Train Loss: 0.113 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.37186193466186523
Epoch: 28, Steps: 1 | Train Loss: 0.100 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.42650461196899414
Epoch: 29, Steps: 1 | Train Loss: 0.092 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.35831356048583984
Epoch: 30, Steps: 1 | Train Loss: 0.071 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.34511852264404297
Epoch: 31, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4442157745361328
Epoch: 32, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.3820617198944092
Epoch: 33, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.37305426597595215
Epoch: 34, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4189174175262451
Epoch: 35, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 73091
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7769079208374023
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.34042787551879883
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.3825387954711914
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.3469960689544678
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.3341686725616455
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.3450961112976074
Epoch: 6, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.40194034576416016
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.3612332344055176
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.40967416763305664
Epoch: 9, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.4289662837982178
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.3885312080383301
Epoch: 11, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3932013511657715
Epoch: 12, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.4161050319671631
Epoch: 13, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3990147113800049
Epoch: 14, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.3625614643096924
Epoch: 15, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.3913133144378662
Epoch: 16, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.4050133228302002
Epoch: 17, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.38221049308776855
Epoch: 18, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.3809382915496826
Epoch: 19, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.44583630561828613
Epoch: 20, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.3674454689025879
Epoch: 21, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3736147880554199
Epoch: 22, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.456989049911499
Epoch: 23, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3414132595062256
Epoch: 24, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.31955814361572266
Epoch: 25, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3846116065979004
Epoch: 26, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.3474431037902832
Epoch: 27, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.38750624656677246
Epoch: 28, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.34291744232177734
Epoch: 29, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.3617844581604004
Epoch: 30, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.3698422908782959
Epoch: 31, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4414949417114258
Epoch: 32, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.3768148422241211
Epoch: 33, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.3984518051147461
Epoch: 34, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4095022678375244
Epoch: 35, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.41261720657348633
Epoch: 36, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.37514734268188477
Epoch: 37, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.43956851959228516
Epoch: 38, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.3991692066192627
Epoch: 39, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 60099
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6249160766601562
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.34183430671691895
Epoch: 2, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4343562126159668
Epoch: 3, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3625764846801758
Epoch: 4, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3591482639312744
Epoch: 5, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3469555377960205
Epoch: 6, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.32625842094421387
Epoch: 7, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.41755056381225586
Epoch: 8, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.3581357002258301
Epoch: 9, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.38816237449645996
Epoch: 10, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3458442687988281
Epoch: 11, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.44820189476013184
Epoch: 12, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 57123
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6647937297821045
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3871431350708008
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3834969997406006
Epoch: 3, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3511638641357422
Epoch: 4, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3944814205169678
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4061763286590576
Epoch: 6, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.36064672470092773
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.45626258850097656
Epoch: 8, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3460254669189453
Epoch: 9, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5150103569030762
Epoch: 10, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.33425068855285645
Epoch: 11, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.37017011642456055
Epoch: 12, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.47607898712158203
Epoch: 13, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.41823673248291016
Epoch: 14, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.32888197898864746
Epoch: 15, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.41112756729125977
Epoch: 16, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.4018549919128418
Epoch: 17, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 18 cost time: 0.32184791564941406
Epoch: 18, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.3813939094543457
Epoch: 19, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.3393571376800537
Epoch: 20, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.37835192680358887
Epoch: 21, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.3237013816833496
Epoch: 22, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.45920610427856445
Epoch: 23, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.35570216178894043
Epoch: 24, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.052 Vali Acc: 0.667 Test Loss: 1.052 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 25 cost time: 0.41944289207458496
Epoch: 25, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4461047649383545
Epoch: 26, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.36452651023864746
Epoch: 27, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.44242024421691895
Epoch: 28, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3258509635925293
Epoch: 29, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4541499614715576
Epoch: 30, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.3836205005645752
Epoch: 31, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.35510945320129395
Epoch: 32, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.36124515533447266
Epoch: 33, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.45009279251098633
Epoch: 34, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 56803
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.577439785003662
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.3497319221496582
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.192 Vali Acc: 0.133 Test Loss: 1.192 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39299964904785156
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.193 Vali Acc: 0.133 Test Loss: 1.193 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3674139976501465
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.194 Vali Acc: 0.067 Test Loss: 1.194 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.37755918502807617
Epoch: 5, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.195 Vali Acc: 0.067 Test Loss: 1.195 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4638090133666992
Epoch: 6, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.197 Vali Acc: 0.067 Test Loss: 1.197 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.43274998664855957
Epoch: 7, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.199 Vali Acc: 0.067 Test Loss: 1.199 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.37015366554260254
Epoch: 8, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.200 Vali Acc: 0.067 Test Loss: 1.200 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.37212681770324707
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.202 Vali Acc: 0.067 Test Loss: 1.202 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.44237446784973145
Epoch: 10, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.203 Vali Acc: 0.067 Test Loss: 1.203 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3257436752319336
Epoch: 11, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.203 Vali Acc: 0.067 Test Loss: 1.203 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 58115
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.77298903465271
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3462245464324951
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3890340328216553
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3467888832092285
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.37076544761657715
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.32726573944091797
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.343555212020874
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3978583812713623
Epoch: 8, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3153865337371826
Epoch: 9, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.34946489334106445
Epoch: 10, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.34924960136413574
Epoch: 11, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 60963
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5848784446716309
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.2986478805541992
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.35250020027160645
Epoch: 3, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3502368927001953
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.3329737186431885
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.35016298294067383
Epoch: 6, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.38822245597839355
Epoch: 7, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3411242961883545
Epoch: 8, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3152618408203125
Epoch: 9, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.37888598442077637
Epoch: 10, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.38674473762512207
Epoch: 11, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.33023500442504883
Epoch: 12, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3401312828063965
Epoch: 13, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.37183570861816406
Epoch: 14, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.33118581771850586
Epoch: 15, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.36653804779052734
Epoch: 16, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.33016037940979004
Epoch: 17, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3822958469390869
Epoch: 18, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3433842658996582
Epoch: 19, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.32484960556030273
Epoch: 20, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.342273473739624
Epoch: 21, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.346113920211792
Epoch: 22, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.33403992652893066
Epoch: 23, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.36714982986450195
Epoch: 24, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.3839070796966553
Epoch: 25, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.3478107452392578
Epoch: 26, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.38146042823791504
Epoch: 27, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.35792040824890137
Epoch: 28, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 29 cost time: 0.2924661636352539
Epoch: 29, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 30 cost time: 0.3022732734680176
Epoch: 30, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 31 cost time: 0.27768421173095703
Epoch: 31, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 32 cost time: 0.433516263961792
Epoch: 32, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 33 cost time: 0.33242273330688477
Epoch: 33, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 34 cost time: 0.2857074737548828
Epoch: 34, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 35 cost time: 0.44739389419555664
Epoch: 35, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.3053102493286133
Epoch: 36, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 0.33565306663513184
Epoch: 37, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.31474947929382324
Epoch: 38, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.2981750965118408
Epoch: 39, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 0.31685924530029297
Epoch: 40, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 41 cost time: 0.34990882873535156
Epoch: 41, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 42 cost time: 0.35220932960510254
Epoch: 42, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 0.4277644157409668
Epoch: 43, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 44 cost time: 0.3471064567565918
Epoch: 44, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 45 cost time: 0.3836960792541504
Epoch: 45, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 46 cost time: 0.33007216453552246
Epoch: 46, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 47 cost time: 0.4050307273864746
Epoch: 47, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.30887365341186523
Epoch: 48, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.3070831298828125
Epoch: 49, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.31280946731567383
Epoch: 50, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 63811
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.520756483078003
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.35825490951538086
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.39238858222961426
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4727158546447754
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.346454381942749
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.42330050468444824
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.37272095680236816
Epoch: 7, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4115629196166992
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.35878515243530273
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.3672804832458496
Epoch: 10, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.3684210777282715
Epoch: 11, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.3513169288635254
Epoch: 12, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.35947656631469727
Epoch: 13, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.43798041343688965
Epoch: 14, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3449409008026123
Epoch: 15, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4124007225036621
Epoch: 16, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3180263042449951
Epoch: 17, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.41416001319885254
Epoch: 18, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.41873621940612793
Epoch: 19, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.42444419860839844
Epoch: 20, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.4268622398376465
Epoch: 21, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.4297513961791992
Epoch: 22, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.4118504524230957
Epoch: 23, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4378938674926758
Epoch: 24, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.39409399032592773
Epoch: 25, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3677947521209717
Epoch: 26, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4539625644683838
Epoch: 27, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4288444519042969
Epoch: 28, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.42557287216186523
Epoch: 29, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.3498094081878662
Epoch: 30, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.45294761657714844
Epoch: 31, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4050159454345703
Epoch: 32, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 437635
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9004125595092773
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3879241943359375
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4515211582183838
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3587353229522705
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.34755516052246094
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4042186737060547
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.36525678634643555
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.37152719497680664
Epoch: 8, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.43172717094421387
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4742469787597656
Epoch: 10, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4204225540161133
Epoch: 11, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.41727590560913086
Epoch: 12, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.35726332664489746
Epoch: 13, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.49182677268981934
Epoch: 14, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.3996448516845703
Epoch: 15, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.3996102809906006
Epoch: 16, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.3666422367095947
Epoch: 17, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.37628984451293945
Epoch: 18, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.38340163230895996
Epoch: 19, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.36238741874694824
Epoch: 20, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.066 Vali Acc: 0.667 Test Loss: 1.066 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 0.38022446632385254
Epoch: 21, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.41849493980407715
Epoch: 22, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.381561279296875
Epoch: 23, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4480283260345459
Epoch: 24, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.36608195304870605
Epoch: 25, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3992180824279785
Epoch: 26, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.38106703758239746
Epoch: 27, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.3385014533996582
Epoch: 28, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5106174945831299
Epoch: 29, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4252645969390869
Epoch: 30, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 424259
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.73866605758667
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3602280616760254
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38364553451538086
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3666360378265381
Epoch: 4, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40355539321899414
Epoch: 5, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3702974319458008
Epoch: 6, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.41131591796875
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.40456676483154297
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.445526123046875
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4071469306945801
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.3531527519226074
Epoch: 11, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.47757625579833984
Epoch: 12, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4360198974609375
Epoch: 13, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4089665412902832
Epoch: 14, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.44106245040893555
Epoch: 15, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.3999180793762207
Epoch: 16, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 421667
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.628551721572876
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4268343448638916
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45630836486816406
Epoch: 3, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3943359851837158
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40874767303466797
Epoch: 5, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.39384913444519043
Epoch: 6, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.37105870246887207
Epoch: 7, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.47945570945739746
Epoch: 8, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5291619300842285
Epoch: 9, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4634852409362793
Epoch: 10, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4985649585723877
Epoch: 11, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 420579
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5965001583099365
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3996295928955078
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.43000268936157227
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4561173915863037
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47847890853881836
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4209411144256592
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4224715232849121
Epoch: 7, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.41018128395080566
Epoch: 8, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4244115352630615
Epoch: 9, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.44266653060913086
Epoch: 10, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.48891520500183105
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.414837121963501
Epoch: 12, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 423043
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5518221855163574
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4364166259765625
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.44139695167541504
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4574921131134033
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.39414119720458984
Epoch: 5, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4053819179534912
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.44290733337402344
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.48949766159057617
Epoch: 8, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.4007580280303955
Epoch: 9, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.34194397926330566
Epoch: 10, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.36394333839416504
Epoch: 11, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.39976978302001953
Epoch: 12, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.38029909133911133
Epoch: 13, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.37760210037231445
Epoch: 14, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.34658002853393555
Epoch: 15, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.35793566703796387
Epoch: 16, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.45258140563964844
Epoch: 17, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.359375
Epoch: 18, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 425507
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6888771057128906
Epoch: 1, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3782041072845459
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.37773585319519043
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.3835868835449219
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.37607264518737793
Epoch: 5, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.3360617160797119
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.4099538326263428
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.39231014251708984
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.3505699634552002
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.3971364498138428
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.3619697093963623
Epoch: 11, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.4529757499694824
Epoch: 12, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.3533766269683838
Epoch: 13, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.3881106376647949
Epoch: 14, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.4686548709869385
Epoch: 15, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.42886877059936523
Epoch: 16, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.4884920120239258
Epoch: 17, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.3229992389678955
Epoch: 18, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.3719482421875
Epoch: 19, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.40346622467041016
Epoch: 20, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.35567307472229004
Epoch: 21, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.3567183017730713
Epoch: 22, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4809896945953369
Epoch: 23, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.37984132766723633
Epoch: 24, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.35691404342651367
Epoch: 25, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.40090155601501465
Epoch: 26, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.3449676036834717
Epoch: 27, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.42967963218688965
Epoch: 28, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.34192585945129395
Epoch: 29, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 427971
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.592395305633545
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3674156665802002
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37227511405944824
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.34424901008605957
Epoch: 4, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3984036445617676
Epoch: 5, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3725571632385254
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3887045383453369
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.3669242858886719
Epoch: 8, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4062991142272949
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.387087345123291
Epoch: 10, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.44904303550720215
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.33443117141723633
Epoch: 12, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.3451387882232666
Epoch: 13, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.3026251792907715
Epoch: 14, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.3547859191894531
Epoch: 15, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.3848099708557129
Epoch: 16, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.33855581283569336
Epoch: 17, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4618949890136719
Epoch: 18, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4142742156982422
Epoch: 19, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3582627773284912
Epoch: 20, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.34481072425842285
Epoch: 21, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.3535950183868408
Epoch: 22, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.38855886459350586
Epoch: 23, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4403810501098633
Epoch: 24, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.39428210258483887
Epoch: 25, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.41481661796569824
Epoch: 26, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 434051
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8037643432617188
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.3876917362213135
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.435413122177124
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.419025182723999
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.35207343101501465
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.42346692085266113
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.35503172874450684
Epoch: 7, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.38764524459838867
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.34378886222839355
Epoch: 9, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.387310266494751
Epoch: 10, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.41709041595458984
Epoch: 11, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.49535441398620605
Epoch: 12, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.461134672164917
Epoch: 13, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.3837132453918457
Epoch: 14, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.44286012649536133
Epoch: 15, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.4313533306121826
Epoch: 16, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.054 Vali Acc: 0.267 Test Loss: 1.054 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.35675549507141113
Epoch: 17, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.052 Vali Acc: 0.267 Test Loss: 1.052 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3794717788696289
Epoch: 18, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.051 Vali Acc: 0.267 Test Loss: 1.051 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.41835641860961914
Epoch: 19, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.050 Vali Acc: 0.267 Test Loss: 1.050 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4173862934112549
Epoch: 20, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 0.38355326652526855
Epoch: 21, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 22 cost time: 0.4636678695678711
Epoch: 22, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 23 cost time: 0.4349555969238281
Epoch: 23, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 24 cost time: 0.42767333984375
Epoch: 24, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 25 cost time: 0.3817894458770752
Epoch: 25, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 26 cost time: 0.3561694622039795
Epoch: 26, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 27 cost time: 0.3741593360900879
Epoch: 27, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.045 Vali Acc: 0.267 Test Loss: 1.045 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.41488027572631836
Epoch: 28, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.045 Vali Acc: 0.267 Test Loss: 1.045 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.3722667694091797
Epoch: 29, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.045 Vali Acc: 0.267 Test Loss: 1.045 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.38713550567626953
Epoch: 30, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.046 Vali Acc: 0.267 Test Loss: 1.046 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4182441234588623
Epoch: 31, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.046 Vali Acc: 0.267 Test Loss: 1.046 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4580650329589844
Epoch: 32, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.047 Vali Acc: 0.267 Test Loss: 1.047 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.389667272567749
Epoch: 33, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.049 Vali Acc: 0.267 Test Loss: 1.049 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.3623838424682617
Epoch: 34, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.050 Vali Acc: 0.267 Test Loss: 1.050 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.3761742115020752
Epoch: 35, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.052 Vali Acc: 0.267 Test Loss: 1.052 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4334712028503418
Epoch: 36, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.054 Vali Acc: 0.267 Test Loss: 1.054 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 420675
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.642115592956543
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.35048484802246094
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37502312660217285
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3530728816986084
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4198801517486572
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.39095044136047363
Epoch: 6, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.46417808532714844
Epoch: 7, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4327359199523926
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.3781588077545166
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.3801259994506836
Epoch: 10, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.42406439781188965
Epoch: 11, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.425734281539917
Epoch: 12, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5179729461669922
Epoch: 13, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5482254028320312
Epoch: 14, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4007096290588379
Epoch: 15, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 418083
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5853452682495117
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4789586067199707
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45655369758605957
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4437248706817627
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.147 Vali Acc: 0.133 Test Loss: 1.147 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4690537452697754
Epoch: 5, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5565507411956787
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.49288368225097656
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4725992679595947
Epoch: 8, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5036940574645996
Epoch: 9, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4876120090484619
Epoch: 10, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47105884552001953
Epoch: 11, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 12 cost time: 0.5329022407531738
Epoch: 12, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3999180793762207
Epoch: 13, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.42353200912475586
Epoch: 14, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.4450252056121826
Epoch: 15, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4844472408294678
Epoch: 16, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.43111109733581543
Epoch: 17, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.43756866455078125
Epoch: 18, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5282313823699951
Epoch: 19, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.49300575256347656
Epoch: 20, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.545917272567749
Epoch: 21, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4134244918823242
Epoch: 22, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.41553354263305664
Epoch: 23, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4235846996307373
Epoch: 24, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.38534116744995117
Epoch: 25, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4168968200683594
Epoch: 26, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 416995
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6837520599365234
Epoch: 1, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.37010955810546875
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3946225643157959
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.503978967666626
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.38892030715942383
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4067344665527344
Epoch: 6, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.43171119689941406
Epoch: 7, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4254732131958008
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.520559549331665
Epoch: 9, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4398839473724365
Epoch: 10, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4071688652038574
Epoch: 11, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.45157909393310547
Epoch: 12, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.47802734375
Epoch: 13, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.4433155059814453
Epoch: 14, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.40561914443969727
Epoch: 15, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.5188925266265869
Epoch: 16, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.39748167991638184
Epoch: 17, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.41580891609191895
Epoch: 18, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.4489455223083496
Epoch: 19, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.40252232551574707
Epoch: 20, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.5216686725616455
Epoch: 21, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.4729433059692383
Epoch: 22, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.37543392181396484
Epoch: 23, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.43408775329589844
Epoch: 24, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.45714282989501953
Epoch: 25, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.4261472225189209
Epoch: 26, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3698091506958008
Epoch: 27, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.3588383197784424
Epoch: 28, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.3337070941925049
Epoch: 29, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.3687407970428467
Epoch: 30, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.3798956871032715
Epoch: 31, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4217052459716797
Epoch: 32, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.44118499755859375
Epoch: 33, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.384929895401001
Epoch: 34, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.3955717086791992
Epoch: 35, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 419459
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5790562629699707
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.48345351219177246
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40988993644714355
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.39382219314575195
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.36291980743408203
Epoch: 5, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40695691108703613
Epoch: 6, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.40627455711364746
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3851478099822998
Epoch: 8, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.40269947052001953
Epoch: 9, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4460768699645996
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3889329433441162
Epoch: 11, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 421923
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6935501098632812
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.39389824867248535
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.38501596450805664
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.40465307235717773
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3861997127532959
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4356074333190918
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3494071960449219
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.3816967010498047
Epoch: 8, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.365509033203125
Epoch: 9, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3341355323791504
Epoch: 10, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5179784297943115
Epoch: 11, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.41666746139526367
Epoch: 12, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.45260119438171387
Epoch: 13, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4526710510253906
Epoch: 14, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4985783100128174
Epoch: 15, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3551950454711914
Epoch: 16, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3967704772949219
Epoch: 17, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3722541332244873
Epoch: 18, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.5263562202453613
Epoch: 19, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3999288082122803
Epoch: 20, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.43791794776916504
Epoch: 21, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.38503265380859375
Epoch: 22, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4274892807006836
Epoch: 23, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3646068572998047
Epoch: 24, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.45801711082458496
Epoch: 25, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4361388683319092
Epoch: 26, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.3563840389251709
Epoch: 27, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.43421483039855957
Epoch: 28, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 424387
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5197126865386963
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.036 Vali Acc: 0.667 Test Loss: 1.036 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.396712064743042
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 0.46614789962768555
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4082510471343994
Epoch: 4, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.35957860946655273
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4044785499572754
Epoch: 6, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.016 Vali Acc: 0.667 Test Loss: 1.016 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 7 cost time: 0.35173797607421875
Epoch: 7, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3933265209197998
Epoch: 8, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.007 Vali Acc: 0.667 Test Loss: 1.007 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 0.3574674129486084
Epoch: 9, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.001 Vali Acc: 0.667 Test Loss: 1.001 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.3735923767089844
Epoch: 10, Steps: 1 | Train Loss: 0.539 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.3572208881378174
Epoch: 11, Steps: 1 | Train Loss: 0.480 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.3967432975769043
Epoch: 12, Steps: 1 | Train Loss: 0.414 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.35486674308776855
Epoch: 13, Steps: 1 | Train Loss: 0.341 Vali Loss: 0.984 Vali Acc: 0.467 Test Loss: 0.984 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4079246520996094
Epoch: 14, Steps: 1 | Train Loss: 0.290 Vali Loss: 0.982 Vali Acc: 0.467 Test Loss: 0.982 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3649406433105469
Epoch: 15, Steps: 1 | Train Loss: 0.249 Vali Loss: 0.981 Vali Acc: 0.400 Test Loss: 0.981 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4190642833709717
Epoch: 16, Steps: 1 | Train Loss: 0.201 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4266645908355713
Epoch: 17, Steps: 1 | Train Loss: 0.158 Vali Loss: 0.984 Vali Acc: 0.400 Test Loss: 0.984 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4007706642150879
Epoch: 18, Steps: 1 | Train Loss: 0.123 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4026458263397217
Epoch: 19, Steps: 1 | Train Loss: 0.098 Vali Loss: 0.998 Vali Acc: 0.400 Test Loss: 0.998 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.39269018173217773
Epoch: 20, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 1573379
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7234852313995361
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.47496891021728516
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.43663620948791504
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.43059492111206055
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4281139373779297
Epoch: 5, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.41474246978759766
Epoch: 6, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4561924934387207
Epoch: 7, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3744344711303711
Epoch: 8, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.4109055995941162
Epoch: 9, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4188258647918701
Epoch: 10, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4017355442047119
Epoch: 11, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.35737013816833496
Epoch: 12, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.3569507598876953
Epoch: 13, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.49144434928894043
Epoch: 14, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.3967907428741455
Epoch: 15, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.373187780380249
Epoch: 16, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.39914989471435547
Epoch: 17, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3510136604309082
Epoch: 18, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.45010852813720703
Epoch: 19, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4094388484954834
Epoch: 20, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.42162656784057617
Epoch: 21, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.40062427520751953
Epoch: 22, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4043149948120117
Epoch: 23, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.39382266998291016
Epoch: 24, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.3402290344238281
Epoch: 25, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.3669853210449219
Epoch: 26, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1522947
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6001036167144775
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.33127284049987793
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.3285555839538574
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.3721177577972412
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.3595731258392334
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.086 Vali Acc: 0.133 Test Loss: 1.086 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.41728949546813965
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.085 Vali Acc: 0.133 Test Loss: 1.085 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3787393569946289
Epoch: 7, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.084 Vali Acc: 0.133 Test Loss: 1.084 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.35433530807495117
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.083 Vali Acc: 0.133 Test Loss: 1.083 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4051086902618408
Epoch: 9, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.081 Vali Acc: 0.133 Test Loss: 1.081 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.36635255813598633
Epoch: 10, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.3918776512145996
Epoch: 11, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.3918757438659668
Epoch: 12, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.44588565826416016
Epoch: 13, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.4770371913909912
Epoch: 14, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.42266273498535156
Epoch: 15, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.4523806571960449
Epoch: 16, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.39817023277282715
Epoch: 17, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.36194610595703125
Epoch: 18, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.3562748432159424
Epoch: 19, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3763735294342041
Epoch: 20, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.36470484733581543
Epoch: 21, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3627636432647705
Epoch: 22, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.46759653091430664
Epoch: 23, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.35067057609558105
Epoch: 24, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.3714563846588135
Epoch: 25, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.42856597900390625
Epoch: 26, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.36279296875
Epoch: 27, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.3617398738861084
Epoch: 28, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4194941520690918
Epoch: 29, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.42692065238952637
Epoch: 30, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.43477725982666016
Epoch: 31, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1509507
model size : 5.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6986510753631592
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.3466184139251709
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41789889335632324
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3637814521789551
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.148 Vali Acc: 0.533 Test Loss: 1.148 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.407029390335083
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4264559745788574
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.40265321731567383
Epoch: 7, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.39093685150146484
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.149 Vali Acc: 0.533 Test Loss: 1.149 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3670380115509033
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3824131488800049
Epoch: 10, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3914682865142822
Epoch: 11, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1508227
model size : 5.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6732003688812256
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4325547218322754
Epoch: 2, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3843538761138916
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4142019748687744
Epoch: 4, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3942244052886963
Epoch: 5, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4361546039581299
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45189952850341797
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4033844470977783
Epoch: 8, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.41516923904418945
Epoch: 9, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4326493740081787
Epoch: 10, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.3976733684539795
Epoch: 11, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.46527528762817383
Epoch: 12, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4115746021270752
Epoch: 13, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.3898806571960449
Epoch: 14, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4436187744140625
Epoch: 15, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.43996429443359375
Epoch: 16, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4953162670135498
Epoch: 17, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.4534628391265869
Epoch: 18, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.42653608322143555
Epoch: 19, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.45955491065979004
Epoch: 20, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 21 cost time: 0.4787912368774414
Epoch: 21, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6038088798522949
Epoch: 22, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4131190776824951
Epoch: 23, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.42504048347473145
Epoch: 24, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4521324634552002
Epoch: 25, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4124126434326172
Epoch: 26, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3954334259033203
Epoch: 27, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5125141143798828
Epoch: 28, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.44951939582824707
Epoch: 29, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4486997127532959
Epoch: 30, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1515011
model size : 5.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5916626453399658
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.37679219245910645
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.36703991889953613
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.4087793827056885
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4086949825286865
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.392686128616333
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.38837456703186035
Epoch: 7, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.42465996742248535
Epoch: 8, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.4215531349182129
Epoch: 9, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4359924793243408
Epoch: 10, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.38044166564941406
Epoch: 11, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.42039918899536133
Epoch: 12, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.43964314460754395
Epoch: 13, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.46387314796447754
Epoch: 14, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.42606282234191895
Epoch: 15, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.41711997985839844
Epoch: 16, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4317011833190918
Epoch: 17, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4223930835723877
Epoch: 18, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.45186495780944824
Epoch: 19, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4339292049407959
Epoch: 20, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.42153143882751465
Epoch: 21, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.40669822692871094
Epoch: 22, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4203207492828369
Epoch: 23, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4502599239349365
Epoch: 24, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3752579689025879
Epoch: 25, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4017062187194824
Epoch: 26, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.3885021209716797
Epoch: 27, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.41402101516723633
Epoch: 28, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1524867
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.593932867050171
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.41961097717285156
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44638729095458984
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.436755895614624
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5510492324829102
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3560974597930908
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4020557403564453
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3717226982116699
Epoch: 8, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.39917778968811035
Epoch: 9, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.5353739261627197
Epoch: 10, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.357196569442749
Epoch: 11, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.4341766834259033
Epoch: 12, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3436291217803955
Epoch: 13, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3816244602203369
Epoch: 14, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.350278377532959
Epoch: 15, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.31395840644836426
Epoch: 16, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4564850330352783
Epoch: 17, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.35811567306518555
Epoch: 18, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.35534214973449707
Epoch: 19, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.40013909339904785
Epoch: 20, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.3675699234008789
Epoch: 21, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.422990083694458
Epoch: 22, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.35900211334228516
Epoch: 23, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.3623185157775879
Epoch: 24, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4319496154785156
Epoch: 25, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 26 cost time: 0.40113306045532227
Epoch: 26, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.42813968658447266
Epoch: 27, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4576892852783203
Epoch: 28, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4260435104370117
Epoch: 29, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4120051860809326
Epoch: 30, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.41576504707336426
Epoch: 31, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4281046390533447
Epoch: 32, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.37885618209838867
Epoch: 33, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.135 Vali Acc: 0.533 Test Loss: 1.135 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4587404727935791
Epoch: 34, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.43907642364501953
Epoch: 35, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.41684675216674805
Epoch: 36, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.151 Vali Acc: 0.533 Test Loss: 1.151 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1537795
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5969412326812744
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.43842172622680664
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.32346177101135254
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.45017075538635254
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.40009355545043945
Epoch: 5, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.3897514343261719
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.3910698890686035
Epoch: 7, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.38619256019592285
Epoch: 8, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.36377382278442383
Epoch: 9, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3228456974029541
Epoch: 10, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.40911412239074707
Epoch: 11, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3659806251525879
Epoch: 12, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.094 Vali Acc: 0.133 Test Loss: 1.094 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.38687896728515625
Epoch: 13, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.3701615333557129
Epoch: 14, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.3933370113372803
Epoch: 15, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.083 Vali Acc: 0.200 Test Loss: 1.083 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.41822242736816406
Epoch: 16, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.080 Vali Acc: 0.200 Test Loss: 1.080 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.36369943618774414
Epoch: 17, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.077 Vali Acc: 0.200 Test Loss: 1.077 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.35936546325683594
Epoch: 18, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4069087505340576
Epoch: 19, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 442627
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.675293207168579
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3649637699127197
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3977823257446289
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.37002086639404297
Epoch: 4, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3439297676086426
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4349842071533203
Epoch: 6, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3708491325378418
Epoch: 7, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.39507508277893066
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.44558262825012207
Epoch: 9, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.32886791229248047
Epoch: 10, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4232156276702881
Epoch: 11, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 417411
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6002576351165771
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.34850573539733887
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5081396102905273
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3983614444732666
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4251861572265625
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.44611644744873047
Epoch: 6, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.436617374420166
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.385012149810791
Epoch: 8, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4730875492095947
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.44564151763916016
Epoch: 10, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4972085952758789
Epoch: 11, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 410691
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7649052143096924
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3792424201965332
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3720579147338867
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.42778754234313965
Epoch: 4, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.37984776496887207
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4360044002532959
Epoch: 6, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4248983860015869
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4275660514831543
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3851182460784912
Epoch: 9, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.3899376392364502
Epoch: 10, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.40076136589050293
Epoch: 11, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.36333155632019043
Epoch: 12, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.401029109954834
Epoch: 13, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.41535139083862305
Epoch: 14, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.38783812522888184
Epoch: 15, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.419888973236084
Epoch: 16, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.3313140869140625
Epoch: 17, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.36716794967651367
Epoch: 18, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.3556177616119385
Epoch: 19, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.36492395401000977
Epoch: 20, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.3690369129180908
Epoch: 21, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.42046093940734863
Epoch: 22, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.41273069381713867
Epoch: 23, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.3999342918395996
Epoch: 24, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.3764219284057617
Epoch: 25, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.3640773296356201
Epoch: 26, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3529825210571289
Epoch: 27, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4007248878479004
Epoch: 28, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.3809659481048584
Epoch: 29, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.36263394355773926
Epoch: 30, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.45218324661254883
Epoch: 31, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4146418571472168
Epoch: 32, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.3501896858215332
Epoch: 33, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 410051
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5747787952423096
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.45256567001342773
Epoch: 2, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3435099124908447
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.336956262588501
Epoch: 4, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3411858081817627
Epoch: 5, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3655836582183838
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.39125943183898926
Epoch: 7, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.3746519088745117
Epoch: 8, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3784058094024658
Epoch: 9, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4461688995361328
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4128258228302002
Epoch: 11, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.34505128860473633
Epoch: 12, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3599731922149658
Epoch: 13, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.41887712478637695
Epoch: 14, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4144449234008789
Epoch: 15, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.36031103134155273
Epoch: 16, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.37247204780578613
Epoch: 17, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3433842658996582
Epoch: 18, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3122899532318115
Epoch: 19, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.36385130882263184
Epoch: 20, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.31316065788269043
Epoch: 21, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 22 cost time: 0.38028860092163086
Epoch: 22, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 23 cost time: 0.4085536003112793
Epoch: 23, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 24 cost time: 0.35581111907958984
Epoch: 24, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.407092809677124
Epoch: 25, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.34671759605407715
Epoch: 26, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.36540722846984863
Epoch: 27, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.33597421646118164
Epoch: 28, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.3595244884490967
Epoch: 29, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.35146379470825195
Epoch: 30, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.3874337673187256
Epoch: 31, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.38365721702575684
Epoch: 32, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.34188079833984375
Epoch: 33, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 413443
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4120237827301025
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.33103251457214355
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42135095596313477
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.36342906951904297
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3908958435058594
Epoch: 5, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3495457172393799
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3892195224761963
Epoch: 7, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.3587803840637207
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3973057270050049
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.44144248962402344
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3644382953643799
Epoch: 11, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.3801615238189697
Epoch: 12, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3360443115234375
Epoch: 13, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.5196709632873535
Epoch: 14, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4088444709777832
Epoch: 15, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.33395838737487793
Epoch: 16, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.36493444442749023
Epoch: 17, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.3293492794036865
Epoch: 18, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.404935359954834
Epoch: 19, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.3618645668029785
Epoch: 20, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.35692262649536133
Epoch: 21, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3945620059967041
Epoch: 22, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.4331209659576416
Epoch: 23, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.39918017387390137
Epoch: 24, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.37219667434692383
Epoch: 25, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.47286438941955566
Epoch: 26, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.39388370513916016
Epoch: 27, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.39835619926452637
Epoch: 28, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.3527240753173828
Epoch: 29, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.3504345417022705
Epoch: 30, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.35897278785705566
Epoch: 31, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.3919069766998291
Epoch: 32, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.3990025520324707
Epoch: 33, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 0.34790730476379395
Epoch: 34, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.44045090675354004
Epoch: 35, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.39994263648986816
Epoch: 36, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.3624563217163086
Epoch: 37, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.36722660064697266
Epoch: 38, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.35657763481140137
Epoch: 39, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.41658520698547363
Epoch: 40, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4080088138580322
Epoch: 41, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.3606994152069092
Epoch: 42, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.3693971633911133
Epoch: 43, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 418371
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4785101413726807
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.34200382232666016
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3721950054168701
Epoch: 3, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3694486618041992
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3498542308807373
Epoch: 5, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3412492275238037
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.34940218925476074
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3779468536376953
Epoch: 8, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3439614772796631
Epoch: 9, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.32625412940979004
Epoch: 10, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.404681921005249
Epoch: 11, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 424835
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6706817150115967
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.3396339416503906
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.3476850986480713
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.43096256256103516
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.4374690055847168
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.3735475540161133
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.33944272994995117
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.34546327590942383
Epoch: 8, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.34844398498535156
Epoch: 9, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3591172695159912
Epoch: 10, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.35564756393432617
Epoch: 11, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.3375113010406494
Epoch: 12, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.3476536273956299
Epoch: 13, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.3205130100250244
Epoch: 14, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.33675670623779297
Epoch: 15, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.3221583366394043
Epoch: 16, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.4107694625854492
Epoch: 17, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.30066990852355957
Epoch: 18, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.33089327812194824
Epoch: 19, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.37116169929504395
Epoch: 20, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.3350050449371338
Epoch: 21, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.41124820709228516
Epoch: 22, Steps: 1 | Train Loss: 0.439 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.30585741996765137
Epoch: 23, Steps: 1 | Train Loss: 0.406 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.43335652351379395
Epoch: 24, Steps: 1 | Train Loss: 0.379 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.4169929027557373
Epoch: 25, Steps: 1 | Train Loss: 0.358 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.3117787837982178
Epoch: 26, Steps: 1 | Train Loss: 0.333 Vali Loss: 0.981 Vali Acc: 0.600 Test Loss: 0.981 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.3862299919128418
Epoch: 27, Steps: 1 | Train Loss: 0.317 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 0.31652355194091797
Epoch: 28, Steps: 1 | Train Loss: 0.294 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.34450864791870117
Epoch: 29, Steps: 1 | Train Loss: 0.273 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 0.2886197566986084
Epoch: 30, Steps: 1 | Train Loss: 0.244 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 0.35738563537597656
Epoch: 31, Steps: 1 | Train Loss: 0.230 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.3503859043121338
Epoch: 32, Steps: 1 | Train Loss: 0.208 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.40825581550598145
Epoch: 33, Steps: 1 | Train Loss: 0.184 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.36023426055908203
Epoch: 34, Steps: 1 | Train Loss: 0.174 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.3322763442993164
Epoch: 35, Steps: 1 | Train Loss: 0.159 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.37435436248779297
Epoch: 36, Steps: 1 | Train Loss: 0.143 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4037959575653076
Epoch: 37, Steps: 1 | Train Loss: 0.129 Vali Loss: 0.980 Vali Acc: 0.600 Test Loss: 0.980 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.3322126865386963
Epoch: 38, Steps: 1 | Train Loss: 0.119 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.37354588508605957
Epoch: 39, Steps: 1 | Train Loss: 0.105 Vali Loss: 0.986 Vali Acc: 0.600 Test Loss: 0.986 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4087793827056885
Epoch: 40, Steps: 1 | Train Loss: 0.100 Vali Loss: 0.989 Vali Acc: 0.600 Test Loss: 0.989 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.3388252258300781
Epoch: 41, Steps: 1 | Train Loss: 0.089 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 135299
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6373388767242432
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.3266279697418213
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.3801887035369873
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.37520527839660645
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.36359691619873047
Epoch: 5, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.3337249755859375
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.3949458599090576
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.36926937103271484
Epoch: 8, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.35225796699523926
Epoch: 9, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.34284353256225586
Epoch: 10, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4116950035095215
Epoch: 11, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.37409162521362305
Epoch: 12, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.37265515327453613
Epoch: 13, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.38582277297973633
Epoch: 14, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4048027992248535
Epoch: 15, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.3516209125518799
Epoch: 16, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.4162745475769043
Epoch: 17, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.3824121952056885
Epoch: 18, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.4022390842437744
Epoch: 19, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.3633267879486084
Epoch: 20, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.4119882583618164
Epoch: 21, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.38263630867004395
Epoch: 22, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.39852094650268555
Epoch: 23, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3758251667022705
Epoch: 24, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3986337184906006
Epoch: 25, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.37008118629455566
Epoch: 26, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3426518440246582
Epoch: 27, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 0.41932249069213867
Epoch: 28, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.3782370090484619
Epoch: 29, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4284532070159912
Epoch: 30, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5260939598083496
Epoch: 31, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.3707895278930664
Epoch: 32, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.3642759323120117
Epoch: 33, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.35445713996887207
Epoch: 34, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.35957980155944824
Epoch: 35, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.37131738662719727
Epoch: 36, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.3725311756134033
Epoch: 37, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.3802759647369385
Epoch: 38, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.39575719833374023
Epoch: 39, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.36605286598205566
Epoch: 40, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.3856644630432129
Epoch: 41, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.3989074230194092
Epoch: 42, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.3963963985443115
Epoch: 43, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 122691
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8130245208740234
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.36298060417175293
Epoch: 2, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.48621177673339844
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.3680839538574219
Epoch: 4, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.3588881492614746
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.44946980476379395
Epoch: 6, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.38277173042297363
Epoch: 7, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5056123733520508
Epoch: 8, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.4104740619659424
Epoch: 9, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.35542750358581543
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.4286613464355469
Epoch: 11, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.4000425338745117
Epoch: 12, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.4276142120361328
Epoch: 13, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.42946434020996094
Epoch: 14, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.37798261642456055
Epoch: 15, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.4035379886627197
Epoch: 16, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.4768543243408203
Epoch: 17, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.4048802852630615
Epoch: 18, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.024 Vali Acc: 0.667 Test Loss: 1.024 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 0.4344048500061035
Epoch: 19, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.024 Vali Acc: 0.667 Test Loss: 1.024 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 20 cost time: 0.42682385444641113
Epoch: 20, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.023 Vali Acc: 0.667 Test Loss: 1.023 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 0.39692044258117676
Epoch: 21, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4791266918182373
Epoch: 22, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3633251190185547
Epoch: 23, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.436201810836792
Epoch: 24, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3959078788757324
Epoch: 25, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4261937141418457
Epoch: 26, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.49215078353881836
Epoch: 27, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.40482211112976074
Epoch: 28, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.418992280960083
Epoch: 29, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.3723635673522949
Epoch: 30, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 119331
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6351559162139893
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.45342087745666504
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47965121269226074
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.39540600776672363
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3723452091217041
Epoch: 5, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4463920593261719
Epoch: 6, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.42078232765197754
Epoch: 7, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.46239161491394043
Epoch: 8, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.43252110481262207
Epoch: 9, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4676382541656494
Epoch: 10, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.41916370391845703
Epoch: 11, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4598269462585449
Epoch: 12, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5117838382720947
Epoch: 13, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 119011
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5886867046356201
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.33258581161499023
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.35569214820861816
Epoch: 3, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.3577249050140381
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.41535449028015137
Epoch: 5, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.3819746971130371
Epoch: 6, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.40947651863098145
Epoch: 7, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4285266399383545
Epoch: 8, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3450198173522949
Epoch: 9, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3450431823730469
Epoch: 10, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3385031223297119
Epoch: 11, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.3425743579864502
Epoch: 12, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.348308801651001
Epoch: 13, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4820437431335449
Epoch: 14, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3591129779815674
Epoch: 15, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.31404995918273926
Epoch: 16, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4338994026184082
Epoch: 17, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3714432716369629
Epoch: 18, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3536543846130371
Epoch: 19, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.3691439628601074
Epoch: 20, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.35064268112182617
Epoch: 21, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.3556098937988281
Epoch: 22, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.3351755142211914
Epoch: 23, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.3603944778442383
Epoch: 24, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.3917996883392334
Epoch: 25, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.42607688903808594
Epoch: 26, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.3570866584777832
Epoch: 27, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.3884000778198242
Epoch: 28, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.3990609645843506
Epoch: 29, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.3947322368621826
Epoch: 30, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.39429235458374023
Epoch: 31, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.43651604652404785
Epoch: 32, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4261474609375
Epoch: 33, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.38253164291381836
Epoch: 34, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.3589804172515869
Epoch: 35, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.38854455947875977
Epoch: 36, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.3810141086578369
Epoch: 37, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.43227553367614746
Epoch: 38, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.3646728992462158
Epoch: 39, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 120707
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5645315647125244
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36444568634033203
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.39017438888549805
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.37114691734313965
Epoch: 4, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.46094512939453125
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.39902257919311523
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.41013526916503906
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.362123966217041
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3704521656036377
Epoch: 9, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4434630870819092
Epoch: 10, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.37613868713378906
Epoch: 11, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.41965723037719727
Epoch: 12, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3249356746673584
Epoch: 13, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3509852886199951
Epoch: 14, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.39928507804870605
Epoch: 15, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.33843016624450684
Epoch: 16, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4010465145111084
Epoch: 17, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3865628242492676
Epoch: 18, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3770487308502197
Epoch: 19, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.42625999450683594
Epoch: 20, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.3663465976715088
Epoch: 21, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.35236167907714844
Epoch: 22, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.349395751953125
Epoch: 23, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.40909695625305176
Epoch: 24, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.4235270023345947
Epoch: 25, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.35470056533813477
Epoch: 26, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.3868682384490967
Epoch: 27, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.40905070304870605
Epoch: 28, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.3409230709075928
Epoch: 29, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.37859201431274414
Epoch: 30, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.5193004608154297
Epoch: 31, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.37683868408203125
Epoch: 32, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.37126660346984863
Epoch: 33, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 0.37752509117126465
Epoch: 34, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 35 cost time: 0.3618450164794922
Epoch: 35, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.5078465938568115
Epoch: 36, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 0.37135791778564453
Epoch: 37, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.41954827308654785
Epoch: 38, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 0.3427433967590332
Epoch: 39, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 0.40924954414367676
Epoch: 40, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 41 cost time: 0.4431631565093994
Epoch: 41, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 42 cost time: 0.4123878479003906
Epoch: 42, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 0.3683946132659912
Epoch: 43, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 44 cost time: 0.4754674434661865
Epoch: 44, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 45 cost time: 0.40647387504577637
Epoch: 45, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.43288683891296387
Epoch: 46, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4417600631713867
Epoch: 47, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.44788217544555664
Epoch: 48, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.410419225692749
Epoch: 49, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5035672187805176
Epoch: 50, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 123171
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6925764083862305
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.35181117057800293
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3619077205657959
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.351320743560791
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.37665820121765137
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3483142852783203
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3776378631591797
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4096500873565674
Epoch: 8, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3587050437927246
Epoch: 9, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.45181941986083984
Epoch: 10, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3384835720062256
Epoch: 11, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4047281742095947
Epoch: 12, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3475825786590576
Epoch: 13, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.47184133529663086
Epoch: 14, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.37885522842407227
Epoch: 15, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.357067346572876
Epoch: 16, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4136180877685547
Epoch: 17, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.32361435890197754
Epoch: 18, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.32416653633117676
Epoch: 19, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.41989731788635254
Epoch: 20, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3668217658996582
Epoch: 21, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.34302544593811035
Epoch: 22, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.3379077911376953
Epoch: 23, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4380762577056885
Epoch: 24, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 126403
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.70157790184021
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4001188278198242
Epoch: 2, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4367372989654541
Epoch: 3, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3981621265411377
Epoch: 4, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.37577390670776367
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4461643695831299
Epoch: 6, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4341433048248291
Epoch: 7, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.41277289390563965
Epoch: 8, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4632387161254883
Epoch: 9, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.37332844734191895
Epoch: 10, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.37998533248901367
Epoch: 11, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.463306188583374
Epoch: 12, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.44675326347351074
Epoch: 13, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1567235
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6299934387207031
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.40297603607177734
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.435711145401001
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.450223445892334
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42693638801574707
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.4679708480834961
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.425304651260376
Epoch: 7, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.3841888904571533
Epoch: 8, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4217691421508789
Epoch: 9, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.38347387313842773
Epoch: 10, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.4256412982940674
Epoch: 11, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.41040563583374023
Epoch: 12, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.47305822372436523
Epoch: 13, Steps: 1 | Train Loss: 0.523 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.42986631393432617
Epoch: 14, Steps: 1 | Train Loss: 0.467 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.3771061897277832
Epoch: 15, Steps: 1 | Train Loss: 0.427 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.403484582901001
Epoch: 16, Steps: 1 | Train Loss: 0.382 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3937034606933594
Epoch: 17, Steps: 1 | Train Loss: 0.352 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.41666698455810547
Epoch: 18, Steps: 1 | Train Loss: 0.314 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.39804792404174805
Epoch: 19, Steps: 1 | Train Loss: 0.275 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.36000609397888184
Epoch: 20, Steps: 1 | Train Loss: 0.233 Vali Loss: 0.989 Vali Acc: 0.400 Test Loss: 0.989 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.38098669052124023
Epoch: 21, Steps: 1 | Train Loss: 0.214 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.42267465591430664
Epoch: 22, Steps: 1 | Train Loss: 0.180 Vali Loss: 0.998 Vali Acc: 0.400 Test Loss: 0.998 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.3865468502044678
Epoch: 23, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.41857194900512695
Epoch: 24, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1516803
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6622095108032227
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.394197940826416
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43111681938171387
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4424002170562744
Epoch: 4, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4874000549316406
Epoch: 5, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4044923782348633
Epoch: 6, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.443892240524292
Epoch: 7, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.35506224632263184
Epoch: 8, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.37134337425231934
Epoch: 9, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4733428955078125
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.3837556838989258
Epoch: 11, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4456305503845215
Epoch: 12, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.44858860969543457
Epoch: 13, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4126296043395996
Epoch: 14, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1503363
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7117643356323242
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.46352648735046387
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.3958163261413574
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.49768686294555664
Epoch: 4, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.45114827156066895
Epoch: 5, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.41733479499816895
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.351407527923584
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.43082451820373535
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.365750789642334
Epoch: 9, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4161360263824463
Epoch: 10, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.45577263832092285
Epoch: 11, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.36698031425476074
Epoch: 12, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4937889575958252
Epoch: 13, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.38913416862487793
Epoch: 14, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.3813447952270508
Epoch: 15, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.394057035446167
Epoch: 16, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4225320816040039
Epoch: 17, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4146425724029541
Epoch: 18, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1502083
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7829673290252686
Epoch: 1, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.3803534507751465
Epoch: 2, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.38567161560058594
Epoch: 3, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3929460048675537
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.41646242141723633
Epoch: 5, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.39542245864868164
Epoch: 6, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.43061351776123047
Epoch: 7, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.37302708625793457
Epoch: 8, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.3961491584777832
Epoch: 9, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.3948359489440918
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.35294294357299805
Epoch: 11, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.44582104682922363
Epoch: 12, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.38646912574768066
Epoch: 13, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.43101954460144043
Epoch: 14, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.44725990295410156
Epoch: 15, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4135255813598633
Epoch: 16, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.422588586807251
Epoch: 17, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.3586862087249756
Epoch: 18, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4278686046600342
Epoch: 19, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.48851537704467773
Epoch: 20, Steps: 1 | Train Loss: 0.402 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1508867
model size : 5.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.575880765914917
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4730701446533203
Epoch: 2, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5534212589263916
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.4272150993347168
Epoch: 4, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.35394740104675293
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.421893835067749
Epoch: 6, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.4247548580169678
Epoch: 7, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.4747300148010254
Epoch: 8, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.47625732421875
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.4777030944824219
Epoch: 10, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.4059438705444336
Epoch: 11, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.42499876022338867
Epoch: 12, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.45475053787231445
Epoch: 13, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 14 cost time: 0.6491239070892334
Epoch: 14, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.3580958843231201
Epoch: 15, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 16 cost time: 0.3950483798980713
Epoch: 16, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.45316600799560547
Epoch: 17, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 18 cost time: 0.4702920913696289
Epoch: 18, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5040018558502197
Epoch: 19, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.35889434814453125
Epoch: 20, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.45418262481689453
Epoch: 21, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.39681243896484375
Epoch: 22, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.38608217239379883
Epoch: 23, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4591069221496582
Epoch: 24, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4249575138092041
Epoch: 25, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.43048763275146484
Epoch: 26, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 27 cost time: 0.4720609188079834
Epoch: 27, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4057338237762451
Epoch: 28, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5456254482269287
Epoch: 29, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4241297245025635
Epoch: 30, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4565391540527344
Epoch: 31, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.3998429775238037
Epoch: 32, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4426591396331787
Epoch: 33, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4301459789276123
Epoch: 34, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.39232468605041504
Epoch: 35, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.3876650333404541
Epoch: 36, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1518723
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6890318393707275
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3642308712005615
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4453582763671875
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.39205360412597656
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4464421272277832
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3934156894683838
Epoch: 6, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4346191883087158
Epoch: 7, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4080202579498291
Epoch: 8, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.36123013496398926
Epoch: 9, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.49208807945251465
Epoch: 10, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3999166488647461
Epoch: 11, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.36101341247558594
Epoch: 12, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.34718799591064453
Epoch: 13, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.35364723205566406
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.43609142303466797
Epoch: 15, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.371657133102417
Epoch: 16, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3971538543701172
Epoch: 17, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4310002326965332
Epoch: 18, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3515510559082031
Epoch: 19, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.409207820892334
Epoch: 20, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.43607521057128906
Epoch: 21, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.36962366104125977
Epoch: 22, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1531651
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5773916244506836
Epoch: 1, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3617439270019531
Epoch: 2, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.41289472579956055
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.3371922969818115
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.385378360748291
Epoch: 5, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.3255932331085205
Epoch: 6, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.3704407215118408
Epoch: 7, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.3467831611633301
Epoch: 8, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3320455551147461
Epoch: 9, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3405485153198242
Epoch: 10, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.39324021339416504
Epoch: 11, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.40900325775146484
Epoch: 12, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.44184112548828125
Epoch: 13, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.515275239944458
Epoch: 14, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4236257076263428
Epoch: 15, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3547019958496094
Epoch: 16, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.4905517101287842
Epoch: 17, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.5362472534179688
Epoch: 18, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.38907527923583984
Epoch: 19, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.46294665336608887
Epoch: 20, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.3781106472015381
Epoch: 21, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.32219982147216797
Epoch: 22, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.3326148986816406
Epoch: 23, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.39157915115356445
Epoch: 24, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.37105321884155273
Epoch: 25, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.3892033100128174
Epoch: 26, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.3715989589691162
Epoch: 27, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 439555
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6802008152008057
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3951570987701416
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.49770259857177734
Epoch: 3, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.37536072731018066
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.38580989837646484
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.40776681900024414
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.414961576461792
Epoch: 7, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4150204658508301
Epoch: 8, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4042024612426758
Epoch: 9, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.39492344856262207
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.40759992599487305
Epoch: 11, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.41955065727233887
Epoch: 12, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.4861154556274414
Epoch: 13, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.40723752975463867
Epoch: 14, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.34867167472839355
Epoch: 15, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4699399471282959
Epoch: 16, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3876950740814209
Epoch: 17, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.38461875915527344
Epoch: 18, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.48529767990112305
Epoch: 19, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.39556217193603516
Epoch: 20, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.39023780822753906
Epoch: 21, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.3883085250854492
Epoch: 22, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.3762037754058838
Epoch: 23, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4739522933959961
Epoch: 24, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4650559425354004
Epoch: 25, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4611978530883789
Epoch: 26, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 414339
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7252275943756104
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.054 Vali Acc: 0.667 Test Loss: 1.054 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.35399937629699707
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.052 Vali Acc: 0.667 Test Loss: 1.052 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 0.3988339900970459
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4146864414215088
Epoch: 4, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5218644142150879
Epoch: 5, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3808896541595459
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.47174715995788574
Epoch: 7, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.44072508811950684
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.420884370803833
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.38953375816345215
Epoch: 10, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4468262195587158
Epoch: 11, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.36862850189208984
Epoch: 12, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 407619
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.64023756980896
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.3859994411468506
Epoch: 2, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.396806001663208
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.395221471786499
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3969695568084717
Epoch: 5, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.31752729415893555
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3938133716583252
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.40328264236450195
Epoch: 8, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.36006784439086914
Epoch: 9, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4601306915283203
Epoch: 10, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.38114142417907715
Epoch: 11, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.40247416496276855
Epoch: 12, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 406979
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5891838073730469
Epoch: 1, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3830130100250244
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3773467540740967
Epoch: 3, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4122312068939209
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.39473795890808105
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.37618494033813477
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4118015766143799
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3648817539215088
Epoch: 8, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4369845390319824
Epoch: 9, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.36551785469055176
Epoch: 10, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3657989501953125
Epoch: 11, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 410371
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.584322452545166
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.346937894821167
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.36559271812438965
Epoch: 3, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.37126708030700684
Epoch: 4, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.41015124320983887
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4466249942779541
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3690359592437744
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4214789867401123
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.34320807456970215
Epoch: 9, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.34475016593933105
Epoch: 10, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.35393595695495605
Epoch: 11, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4509239196777344
Epoch: 12, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.34851527214050293
Epoch: 13, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.36162328720092773
Epoch: 14, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3613452911376953
Epoch: 15, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3453700542449951
Epoch: 16, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3891630172729492
Epoch: 17, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3850827217102051
Epoch: 18, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3537304401397705
Epoch: 19, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4093775749206543
Epoch: 20, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.3337438106536865
Epoch: 21, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.34206533432006836
Epoch: 22, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4148557186126709
Epoch: 23, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3462104797363281
Epoch: 24, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3741323947906494
Epoch: 25, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.35902905464172363
Epoch: 26, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.3901519775390625
Epoch: 27, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.32474637031555176
Epoch: 28, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.3968806266784668
Epoch: 29, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.34149956703186035
Epoch: 30, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.41314053535461426
Epoch: 31, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.49059462547302246
Epoch: 32, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.36672496795654297
Epoch: 33, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.40083861351013184
Epoch: 34, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4081871509552002
Epoch: 35, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.32590460777282715
Epoch: 36, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.33636903762817383
Epoch: 37, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.37714362144470215
Epoch: 38, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.34418654441833496
Epoch: 39, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.47308897972106934
Epoch: 40, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 415299
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6285161972045898
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.38308024406433105
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37298035621643066
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4083070755004883
Epoch: 4, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.153 Vali Acc: 0.067 Test Loss: 1.153 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.39430856704711914
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.155 Vali Acc: 0.067 Test Loss: 1.155 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.39639735221862793
Epoch: 6, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4577755928039551
Epoch: 7, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.37674593925476074
Epoch: 8, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.42626094818115234
Epoch: 9, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3756566047668457
Epoch: 10, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3228294849395752
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 421763
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4580535888671875
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.38967061042785645
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.33036208152770996
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3638763427734375
Epoch: 4, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.43522119522094727
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.43037867546081543
Epoch: 6, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5127601623535156
Epoch: 7, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.39951181411743164
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3619246482849121
Epoch: 9, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.40091443061828613
Epoch: 10, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3363656997680664
Epoch: 11, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.39194345474243164
Epoch: 12, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.38404369354248047
Epoch: 13, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3648984432220459
Epoch: 14, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3278939723968506
Epoch: 15, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.3895688056945801
Epoch: 16, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3995199203491211
Epoch: 17, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3680438995361328
Epoch: 18, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.435394287109375
Epoch: 19, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.3693060874938965
Epoch: 20, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.3941476345062256
Epoch: 21, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.39345622062683105
Epoch: 22, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.34844517707824707
Epoch: 23, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4096658229827881
Epoch: 24, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.3627195358276367
Epoch: 25, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 133763
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5217926502227783
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.35523414611816406
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.3712501525878906
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.3515281677246094
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.38210582733154297
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.47405314445495605
Epoch: 6, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3841218948364258
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.34986257553100586
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5223071575164795
Epoch: 9, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.3937392234802246
Epoch: 10, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.42449378967285156
Epoch: 11, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.4103415012359619
Epoch: 12, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.381633996963501
Epoch: 13, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 14 cost time: 0.46506381034851074
Epoch: 14, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.42764925956726074
Epoch: 15, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 16 cost time: 0.42771148681640625
Epoch: 16, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.4082193374633789
Epoch: 17, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 18 cost time: 0.39668846130371094
Epoch: 18, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 19 cost time: 0.43491077423095703
Epoch: 19, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 20 cost time: 0.4007265567779541
Epoch: 20, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 21 cost time: 0.4198343753814697
Epoch: 21, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 22 cost time: 0.38543224334716797
Epoch: 22, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 23 cost time: 0.349717378616333
Epoch: 23, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.3612699508666992
Epoch: 24, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 0.4288158416748047
Epoch: 25, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 0.41496920585632324
Epoch: 26, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.4135324954986572
Epoch: 27, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.39856624603271484
Epoch: 28, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.41155552864074707
Epoch: 29, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.4954946041107178
Epoch: 30, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.47806549072265625
Epoch: 31, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.3751099109649658
Epoch: 32, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.3614194393157959
Epoch: 33, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.36893272399902344
Epoch: 34, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.46825647354125977
Epoch: 35, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.46692824363708496
Epoch: 36, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.40326833724975586
Epoch: 37, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.3565502166748047
Epoch: 38, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.35737061500549316
Epoch: 39, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.39275050163269043
Epoch: 40, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.38241052627563477
Epoch: 41, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.36397314071655273
Epoch: 42, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.39159297943115234
Epoch: 43, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 121155
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.607048511505127
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.42811107635498047
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.44683194160461426
Epoch: 3, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.38893818855285645
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.42237401008605957
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.41828274726867676
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.35858917236328125
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.39376068115234375
Epoch: 8, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5927515029907227
Epoch: 9, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.45320653915405273
Epoch: 10, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.33472609519958496
Epoch: 11, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.42990684509277344
Epoch: 12, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.4696779251098633
Epoch: 13, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.4265725612640381
Epoch: 14, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.40432000160217285
Epoch: 15, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.3876678943634033
Epoch: 16, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.4711008071899414
Epoch: 17, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 18 cost time: 0.4411351680755615
Epoch: 18, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.38867807388305664
Epoch: 19, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 20 cost time: 0.4430687427520752
Epoch: 20, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4313771724700928
Epoch: 21, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.46718907356262207
Epoch: 22, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.3904838562011719
Epoch: 23, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4953310489654541
Epoch: 24, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4371345043182373
Epoch: 25, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5130414962768555
Epoch: 26, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.49607253074645996
Epoch: 27, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.37845897674560547
Epoch: 28, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.3798036575317383
Epoch: 29, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 117795
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5203735828399658
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4371066093444824
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.36293673515319824
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.446852445602417
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.43122148513793945
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.41191959381103516
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.38738059997558594
Epoch: 7, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4190855026245117
Epoch: 8, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3849613666534424
Epoch: 9, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.38673925399780273
Epoch: 10, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.36159420013427734
Epoch: 11, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.3894171714782715
Epoch: 12, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3632316589355469
Epoch: 13, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.41082072257995605
Epoch: 14, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.44432592391967773
Epoch: 15, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5045700073242188
Epoch: 16, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.42882370948791504
Epoch: 17, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.3531785011291504
Epoch: 18, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.4264392852783203
Epoch: 19, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.4429805278778076
Epoch: 20, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.3990299701690674
Epoch: 21, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.40310096740722656
Epoch: 22, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.40808773040771484
Epoch: 23, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.4161093235015869
Epoch: 24, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.3801720142364502
Epoch: 25, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.4836456775665283
Epoch: 26, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.4116091728210449
Epoch: 27, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.375993013381958
Epoch: 28, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.3624234199523926
Epoch: 29, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.39464402198791504
Epoch: 30, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.36728763580322266
Epoch: 31, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 0.3614382743835449
Epoch: 32, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 0.4149441719055176
Epoch: 33, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 0.3639984130859375
Epoch: 34, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 0.3685421943664551
Epoch: 35, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.31439661979675293
Epoch: 36, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.36922693252563477
Epoch: 37, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4180183410644531
Epoch: 38, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4120204448699951
Epoch: 39, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4701721668243408
Epoch: 40, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5049388408660889
Epoch: 41, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4018702507019043
Epoch: 42, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.40114545822143555
Epoch: 43, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.45696091651916504
Epoch: 44, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 117475
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6142287254333496
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3793528079986572
Epoch: 2, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.35967254638671875
Epoch: 3, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.33296704292297363
Epoch: 4, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.33783912658691406
Epoch: 5, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.36478424072265625
Epoch: 6, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.39986252784729004
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.3724977970123291
Epoch: 8, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.3913912773132324
Epoch: 9, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.3824453353881836
Epoch: 10, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.39467787742614746
Epoch: 11, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.347898006439209
Epoch: 12, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.3472123146057129
Epoch: 13, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 14 cost time: 0.3471546173095703
Epoch: 14, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.3856494426727295
Epoch: 15, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 16 cost time: 0.3850114345550537
Epoch: 16, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.37332987785339355
Epoch: 17, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 18 cost time: 0.3215475082397461
Epoch: 18, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 19 cost time: 0.3704409599304199
Epoch: 19, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 20 cost time: 0.42822933197021484
Epoch: 20, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 21 cost time: 0.33591389656066895
Epoch: 21, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 22 cost time: 0.40141820907592773
Epoch: 22, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 23 cost time: 0.38541722297668457
Epoch: 23, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.3303506374359131
Epoch: 24, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.41761255264282227
Epoch: 25, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.3683145046234131
Epoch: 26, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.40952491760253906
Epoch: 27, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4288654327392578
Epoch: 28, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.35077381134033203
Epoch: 29, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.41744232177734375
Epoch: 30, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4402189254760742
Epoch: 31, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.40813207626342773
Epoch: 32, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.3713572025299072
Epoch: 33, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 119171
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4887385368347168
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4197685718536377
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3882443904876709
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.36974525451660156
Epoch: 4, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.35036611557006836
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47382330894470215
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4297313690185547
Epoch: 7, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.41158080101013184
Epoch: 8, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3948099613189697
Epoch: 9, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3880801200866699
Epoch: 10, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3879094123840332
Epoch: 11, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 121635
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6330416202545166
Epoch: 1, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3795959949493408
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.090 Vali Acc: 0.133 Test Loss: 1.090 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3653299808502197
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.456204891204834
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.4200935363769531
Epoch: 5, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.4222261905670166
Epoch: 6, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.411271333694458
Epoch: 7, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.4178740978240967
Epoch: 8, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.4139237403869629
Epoch: 9, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.4335014820098877
Epoch: 10, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.43584513664245605
Epoch: 11, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4626455307006836
Epoch: 12, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.37980198860168457
Epoch: 13, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4005885124206543
Epoch: 14, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4228036403656006
Epoch: 15, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.4107787609100342
Epoch: 16, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.48268604278564453
Epoch: 17, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4507584571838379
Epoch: 18, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.37997937202453613
Epoch: 19, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3644390106201172
Epoch: 20, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4804668426513672
Epoch: 21, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.35529494285583496
Epoch: 22, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.3780663013458252
Epoch: 23, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.42539072036743164
Epoch: 24, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3819429874420166
Epoch: 25, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.38329339027404785
Epoch: 26, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.45488405227661133
Epoch: 27, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4574704170227051
Epoch: 28, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4114549160003662
Epoch: 29, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.39226818084716797
Epoch: 30, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.44686269760131836
Epoch: 31, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.42221856117248535
Epoch: 32, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4926483631134033
Epoch: 33, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4332566261291504
Epoch: 34, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.38289833068847656
Epoch: 35, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.37398767471313477
Epoch: 36, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4591693878173828
Epoch: 37, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.36019372940063477
Epoch: 38, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.3449673652648926
Epoch: 39, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.48746800422668457
Epoch: 40, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4795811176300049
Epoch: 41, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 124867
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6439521312713623
Epoch: 1, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4054989814758301
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.39426159858703613
Epoch: 3, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.34826231002807617
Epoch: 4, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.45184874534606934
Epoch: 5, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.3620612621307373
Epoch: 6, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.3520650863647461
Epoch: 7, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.39423203468322754
Epoch: 8, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.36409854888916016
Epoch: 9, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.39472270011901855
Epoch: 10, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3665890693664551
Epoch: 11, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4145214557647705
Epoch: 12, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.34868478775024414
Epoch: 13, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.36715054512023926
Epoch: 14, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.237 Vali Acc: 0.467 Test Loss: 1.237 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.34406089782714844
Epoch: 15, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.290 Vali Acc: 0.467 Test Loss: 1.290 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.3645501136779785
Epoch: 16, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.34830713272094727
Epoch: 17, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.3610260486602783
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.472 Vali Acc: 0.400 Test Loss: 1.472 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4221217632293701
Epoch: 19, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.400 Test Loss: 1.535 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.381040096282959
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.400 Test Loss: 1.598 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1350659
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6430833339691162
Epoch: 1, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3659672737121582
Epoch: 2, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3890383243560791
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.35884594917297363
Epoch: 4, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.36101222038269043
Epoch: 5, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.42527055740356445
Epoch: 6, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.38353490829467773
Epoch: 7, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3843719959259033
Epoch: 8, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.3602917194366455
Epoch: 9, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.38176417350769043
Epoch: 10, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3312108516693115
Epoch: 11, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3334667682647705
Epoch: 12, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.35926342010498047
Epoch: 13, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.3433523178100586
Epoch: 14, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.37847018241882324
Epoch: 15, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.32451510429382324
Epoch: 16, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.42949438095092773
Epoch: 17, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.139 Vali Acc: 0.600 Test Loss: 1.139 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.34978294372558594
Epoch: 18, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.34735655784606934
Epoch: 19, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.192 Vali Acc: 0.533 Test Loss: 1.192 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1246723
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7054994106292725
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.35477685928344727
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.34681177139282227
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4177064895629883
Epoch: 4, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.3798031806945801
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.41700243949890137
Epoch: 6, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.35492849349975586
Epoch: 7, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.027 Vali Acc: 0.333 Test Loss: 1.027 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3540627956390381
Epoch: 8, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.019 Vali Acc: 0.333 Test Loss: 1.019 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.40981292724609375
Epoch: 9, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.012 Vali Acc: 0.333 Test Loss: 1.012 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.35404157638549805
Epoch: 10, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 11 cost time: 0.348982572555542
Epoch: 11, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.3494277000427246
Epoch: 12, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.33985042572021484
Epoch: 13, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.33997011184692383
Epoch: 14, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.30811643600463867
Epoch: 15, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.35657191276550293
Epoch: 16, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.33277392387390137
Epoch: 17, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3966183662414551
Epoch: 18, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.35120677947998047
Epoch: 19, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.38944268226623535
Epoch: 20, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.34458422660827637
Epoch: 21, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.134 Vali Acc: 0.600 Test Loss: 1.134 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.3459043502807617
Epoch: 22, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.3837110996246338
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.186 Vali Acc: 0.533 Test Loss: 1.186 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1222915
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5436890125274658
Epoch: 1, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.43022942543029785
Epoch: 2, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.3569045066833496
Epoch: 3, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.3892226219177246
Epoch: 4, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.3657102584838867
Epoch: 5, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.37979984283447266
Epoch: 6, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 0.3304719924926758
Epoch: 7, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.4101405143737793
Epoch: 8, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.000 Vali Acc: 0.400 Test Loss: 1.000 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4058256149291992
Epoch: 9, Steps: 1 | Train Loss: 0.507 Vali Loss: 0.996 Vali Acc: 0.400 Test Loss: 0.996 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.366441011428833
Epoch: 10, Steps: 1 | Train Loss: 0.433 Vali Loss: 0.993 Vali Acc: 0.400 Test Loss: 0.993 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.46322059631347656
Epoch: 11, Steps: 1 | Train Loss: 0.388 Vali Loss: 0.991 Vali Acc: 0.400 Test Loss: 0.991 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3959832191467285
Epoch: 12, Steps: 1 | Train Loss: 0.334 Vali Loss: 0.991 Vali Acc: 0.400 Test Loss: 0.991 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4101524353027344
Epoch: 13, Steps: 1 | Train Loss: 0.287 Vali Loss: 0.993 Vali Acc: 0.467 Test Loss: 0.993 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 14 cost time: 0.34940552711486816
Epoch: 14, Steps: 1 | Train Loss: 0.240 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.35813093185424805
Epoch: 15, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.41640377044677734
Epoch: 16, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4400622844696045
Epoch: 17, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.37427544593811035
Epoch: 18, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.33893609046936035
Epoch: 19, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.3955845832824707
Epoch: 20, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.36608409881591797
Epoch: 21, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.38658905029296875
Epoch: 22, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.40798115730285645
Epoch: 23, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.38381171226501465
Epoch: 24, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.151 Vali Acc: 0.533 Test Loss: 1.151 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.42847299575805664
Epoch: 25, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.173 Vali Acc: 0.533 Test Loss: 1.173 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4246084690093994
Epoch: 26, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.3615269660949707
Epoch: 27, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.216 Vali Acc: 0.533 Test Loss: 1.216 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.492828369140625
Epoch: 28, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.237 Vali Acc: 0.533 Test Loss: 1.237 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.3550748825073242
Epoch: 29, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.257 Vali Acc: 0.533 Test Loss: 1.257 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1220355
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5630106925964355
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.39513707160949707
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.34008121490478516
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.39718174934387207
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.3401007652282715
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.3574254512786865
Epoch: 6, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3851277828216553
Epoch: 7, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4054262638092041
Epoch: 8, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4573991298675537
Epoch: 9, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.37978529930114746
Epoch: 10, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.44054698944091797
Epoch: 11, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.38765883445739746
Epoch: 12, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4022519588470459
Epoch: 13, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.3914773464202881
Epoch: 14, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.38616037368774414
Epoch: 15, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1230851
model size : 4.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4429984092712402
Epoch: 1, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.39220190048217773
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.35408544540405273
Epoch: 3, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.3459439277648926
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.4232785701751709
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.34035396575927734
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.41705775260925293
Epoch: 7, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.3366994857788086
Epoch: 8, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.41896963119506836
Epoch: 9, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.143 Vali Acc: 0.533 Test Loss: 1.143 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.3780210018157959
Epoch: 10, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.3813364505767822
Epoch: 11, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.3431265354156494
Epoch: 12, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.136 Vali Acc: 0.533 Test Loss: 1.136 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.3499257564544678
Epoch: 13, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.4323105812072754
Epoch: 14, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.36806368827819824
Epoch: 15, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.134 Vali Acc: 0.600 Test Loss: 1.134 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.39826321601867676
Epoch: 16, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3425781726837158
Epoch: 17, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3668231964111328
Epoch: 18, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.368213415145874
Epoch: 19, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3581523895263672
Epoch: 20, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.39308762550354004
Epoch: 21, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.169 Vali Acc: 0.600 Test Loss: 1.169 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.41106605529785156
Epoch: 22, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.180 Vali Acc: 0.600 Test Loss: 1.180 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.38773608207702637
Epoch: 23, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.192 Vali Acc: 0.667 Test Loss: 1.192 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666655).  Saving model ...
Epoch: 24 cost time: 0.4221208095550537
Epoch: 24, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.3216586112976074
Epoch: 25, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.218 Vali Acc: 0.667 Test Loss: 1.218 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.3863351345062256
Epoch: 26, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.232 Vali Acc: 0.667 Test Loss: 1.232 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.39534950256347656
Epoch: 27, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.246 Vali Acc: 0.667 Test Loss: 1.246 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4393749237060547
Epoch: 28, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.259 Vali Acc: 0.667 Test Loss: 1.259 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.3466989994049072
Epoch: 29, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.273 Vali Acc: 0.600 Test Loss: 1.273 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.38094234466552734
Epoch: 30, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.287 Vali Acc: 0.600 Test Loss: 1.287 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4372696876525879
Epoch: 31, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.300 Vali Acc: 0.533 Test Loss: 1.300 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.37905192375183105
Epoch: 32, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.314 Vali Acc: 0.533 Test Loss: 1.314 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.40375494956970215
Epoch: 33, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.326 Vali Acc: 0.533 Test Loss: 1.326 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 1253635
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.471662998199463
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4060177803039551
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42928528785705566
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.40184903144836426
Epoch: 4, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.36627960205078125
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.39089250564575195
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.38735270500183105
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4210522174835205
Epoch: 8, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.4978504180908203
Epoch: 9, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.3652925491333008
Epoch: 10, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.4432258605957031
Epoch: 11, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.4356963634490967
Epoch: 12, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.4514460563659668
Epoch: 13, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.4151580333709717
Epoch: 14, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.48897767066955566
Epoch: 15, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4501512050628662
Epoch: 16, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.44838643074035645
Epoch: 17, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.4371681213378906
Epoch: 18, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.42989206314086914
Epoch: 19, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4786558151245117
Epoch: 20, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.5145735740661621
Epoch: 21, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5315465927124023
Epoch: 22, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.44087672233581543
Epoch: 23, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5257115364074707
Epoch: 24, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5042190551757812
Epoch: 25, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4985525608062744
Epoch: 26, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4541311264038086
Epoch: 27, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5110983848571777
Epoch: 28, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.45070815086364746
Epoch: 29, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4458632469177246
Epoch: 30, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1276419
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5886385440826416
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 0.996 Vali Acc: 0.400 Test Loss: 0.996 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.3972196578979492
Epoch: 2, Steps: 1 | Train Loss: 0.986 Vali Loss: 0.989 Vali Acc: 0.400 Test Loss: 0.989 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.3414006233215332
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.36720967292785645
Epoch: 4, Steps: 1 | Train Loss: 0.834 Vali Loss: 0.975 Vali Acc: 0.400 Test Loss: 0.975 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.3606758117675781
Epoch: 5, Steps: 1 | Train Loss: 0.736 Vali Loss: 0.968 Vali Acc: 0.400 Test Loss: 0.968 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.34502196311950684
Epoch: 6, Steps: 1 | Train Loss: 0.665 Vali Loss: 0.960 Vali Acc: 0.400 Test Loss: 0.960 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.39282774925231934
Epoch: 7, Steps: 1 | Train Loss: 0.595 Vali Loss: 0.951 Vali Acc: 0.467 Test Loss: 0.951 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.32787251472473145
Epoch: 8, Steps: 1 | Train Loss: 0.491 Vali Loss: 0.944 Vali Acc: 0.467 Test Loss: 0.944 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 9 cost time: 0.43816089630126953
Epoch: 9, Steps: 1 | Train Loss: 0.429 Vali Loss: 0.938 Vali Acc: 0.533 Test Loss: 0.938 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 10 cost time: 0.3550751209259033
Epoch: 10, Steps: 1 | Train Loss: 0.337 Vali Loss: 0.936 Vali Acc: 0.467 Test Loss: 0.936 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.38690638542175293
Epoch: 11, Steps: 1 | Train Loss: 0.265 Vali Loss: 0.937 Vali Acc: 0.467 Test Loss: 0.937 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3709425926208496
Epoch: 12, Steps: 1 | Train Loss: 0.208 Vali Loss: 0.941 Vali Acc: 0.400 Test Loss: 0.941 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3583559989929199
Epoch: 13, Steps: 1 | Train Loss: 0.157 Vali Loss: 0.950 Vali Acc: 0.400 Test Loss: 0.950 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4550189971923828
Epoch: 14, Steps: 1 | Train Loss: 0.121 Vali Loss: 0.964 Vali Acc: 0.400 Test Loss: 0.964 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.40230584144592285
Epoch: 15, Steps: 1 | Train Loss: 0.085 Vali Loss: 0.983 Vali Acc: 0.400 Test Loss: 0.983 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.43389415740966797
Epoch: 16, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.007 Vali Acc: 0.400 Test Loss: 1.007 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5317471027374268
Epoch: 17, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.3967468738555908
Epoch: 18, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.3914055824279785
Epoch: 19, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 413187
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4868643283843994
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.44454383850097656
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4413273334503174
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.39682817459106445
Epoch: 4, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4164762496948242
Epoch: 5, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.39713239669799805
Epoch: 6, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.36830615997314453
Epoch: 7, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4220895767211914
Epoch: 8, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.4720187187194824
Epoch: 9, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4275689125061035
Epoch: 10, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4176485538482666
Epoch: 11, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.40688467025756836
Epoch: 12, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5259075164794922
Epoch: 13, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.38541102409362793
Epoch: 14, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4046657085418701
Epoch: 15, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.36882638931274414
Epoch: 16, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.39290332794189453
Epoch: 17, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3858790397644043
Epoch: 18, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.365372896194458
Epoch: 19, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 20 cost time: 0.396712064743042
Epoch: 20, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.41311025619506836
Epoch: 21, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3589506149291992
Epoch: 22, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.137 Vali Acc: 0.600 Test Loss: 1.137 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4254281520843506
Epoch: 23, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4351077079772949
Epoch: 24, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.38463330268859863
Epoch: 25, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.42333412170410156
Epoch: 26, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.212 Vali Acc: 0.600 Test Loss: 1.212 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4059174060821533
Epoch: 27, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.34378838539123535
Epoch: 28, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.250 Vali Acc: 0.600 Test Loss: 1.250 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.40645313262939453
Epoch: 29, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.269 Vali Acc: 0.600 Test Loss: 1.269 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.37109899520874023
Epoch: 30, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.287 Vali Acc: 0.600 Test Loss: 1.287 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 361219
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4903337955474854
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.31838417053222656
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.056 Vali Acc: 0.667 Test Loss: 1.056 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 0.3605048656463623
Epoch: 3, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.051 Vali Acc: 0.667 Test Loss: 1.051 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.44348764419555664
Epoch: 4, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.41200828552246094
Epoch: 5, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.042 Vali Acc: 0.667 Test Loss: 1.042 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 0.453204870223999
Epoch: 6, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.038 Vali Acc: 0.667 Test Loss: 1.038 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.3419334888458252
Epoch: 7, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.034 Vali Acc: 0.667 Test Loss: 1.034 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 0.3665485382080078
Epoch: 8, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.33306384086608887
Epoch: 9, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3422122001647949
Epoch: 10, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.34592652320861816
Epoch: 11, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.013 Vali Acc: 0.667 Test Loss: 1.013 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 0.4748876094818115
Epoch: 12, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.389451265335083
Epoch: 13, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4259171485900879
Epoch: 14, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3909792900085449
Epoch: 15, Steps: 1 | Train Loss: 0.350 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.37077879905700684
Epoch: 16, Steps: 1 | Train Loss: 0.313 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.42276835441589355
Epoch: 17, Steps: 1 | Train Loss: 0.272 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4211568832397461
Epoch: 18, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.38567543029785156
Epoch: 19, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.37941431999206543
Epoch: 20, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.36281466484069824
Epoch: 21, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 349315
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4848604202270508
Epoch: 1, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.3810544013977051
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.3957808017730713
Epoch: 3, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4151949882507324
Epoch: 4, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.39110565185546875
Epoch: 5, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.33167552947998047
Epoch: 6, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.035 Vali Acc: 0.667 Test Loss: 1.035 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.39704275131225586
Epoch: 7, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.034 Vali Acc: 0.733 Test Loss: 1.034 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 0.36830711364746094
Epoch: 8, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3976457118988037
Epoch: 9, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3596789836883545
Epoch: 10, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.41285276412963867
Epoch: 11, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3321421146392822
Epoch: 12, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.38869214057922363
Epoch: 13, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.3227558135986328
Epoch: 14, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4251134395599365
Epoch: 15, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.37036728858947754
Epoch: 16, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.37772154808044434
Epoch: 17, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 348035
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6502881050109863
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3755311965942383
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3852865695953369
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.413832426071167
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4229617118835449
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4309711456298828
Epoch: 6, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.37719202041625977
Epoch: 7, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.32393598556518555
Epoch: 8, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.3924827575683594
Epoch: 9, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4887509346008301
Epoch: 10, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3259847164154053
Epoch: 11, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.32280969619750977
Epoch: 12, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.41959547996520996
Epoch: 13, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3862614631652832
Epoch: 14, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4342517852783203
Epoch: 15, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.466480016708374
Epoch: 16, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.34403133392333984
Epoch: 17, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.34600090980529785
Epoch: 18, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.455920934677124
Epoch: 19, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.44072818756103516
Epoch: 20, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4672267436981201
Epoch: 21, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.39777493476867676
Epoch: 22, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4647197723388672
Epoch: 23, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.39589548110961914
Epoch: 24, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.43845534324645996
Epoch: 25, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 353283
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.548079252243042
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.39850497245788574
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.39756083488464355
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.42461609840393066
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.42377400398254395
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.4680156707763672
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.3637583255767822
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.47940778732299805
Epoch: 8, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.44794750213623047
Epoch: 9, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.001 Vali Acc: 0.667 Test Loss: 1.001 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.4466536045074463
Epoch: 10, Steps: 1 | Train Loss: 0.797 Vali Loss: 0.998 Vali Acc: 0.667 Test Loss: 0.998 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.4114086627960205
Epoch: 11, Steps: 1 | Train Loss: 0.750 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 0.4251136779785156
Epoch: 12, Steps: 1 | Train Loss: 0.668 Vali Loss: 0.992 Vali Acc: 0.667 Test Loss: 0.992 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 0.3934977054595947
Epoch: 13, Steps: 1 | Train Loss: 0.621 Vali Loss: 0.989 Vali Acc: 0.667 Test Loss: 0.989 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 14 cost time: 0.4082648754119873
Epoch: 14, Steps: 1 | Train Loss: 0.599 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 15 cost time: 0.3587830066680908
Epoch: 15, Steps: 1 | Train Loss: 0.552 Vali Loss: 0.985 Vali Acc: 0.667 Test Loss: 0.985 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 0.310222864151001
Epoch: 16, Steps: 1 | Train Loss: 0.469 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 17 cost time: 0.33020973205566406
Epoch: 17, Steps: 1 | Train Loss: 0.473 Vali Loss: 0.981 Vali Acc: 0.667 Test Loss: 0.981 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 18 cost time: 0.47830939292907715
Epoch: 18, Steps: 1 | Train Loss: 0.433 Vali Loss: 0.980 Vali Acc: 0.667 Test Loss: 0.980 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 19 cost time: 0.46567344665527344
Epoch: 19, Steps: 1 | Train Loss: 0.380 Vali Loss: 0.979 Vali Acc: 0.667 Test Loss: 0.979 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 20 cost time: 0.4253227710723877
Epoch: 20, Steps: 1 | Train Loss: 0.357 Vali Loss: 0.979 Vali Acc: 0.667 Test Loss: 0.979 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 0.40866661071777344
Epoch: 21, Steps: 1 | Train Loss: 0.327 Vali Loss: 0.980 Vali Acc: 0.600 Test Loss: 0.980 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.388958215713501
Epoch: 22, Steps: 1 | Train Loss: 0.305 Vali Loss: 0.981 Vali Acc: 0.600 Test Loss: 0.981 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4013044834136963
Epoch: 23, Steps: 1 | Train Loss: 0.263 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4493732452392578
Epoch: 24, Steps: 1 | Train Loss: 0.237 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.38862013816833496
Epoch: 25, Steps: 1 | Train Loss: 0.224 Vali Loss: 0.991 Vali Acc: 0.667 Test Loss: 0.991 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.42554354667663574
Epoch: 26, Steps: 1 | Train Loss: 0.192 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3930540084838867
Epoch: 27, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4700319766998291
Epoch: 28, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.3578526973724365
Epoch: 29, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.45300865173339844
Epoch: 30, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.018 Vali Acc: 0.667 Test Loss: 1.018 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 364675
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6236965656280518
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.38399219512939453
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.38553452491760254
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.39745354652404785
Epoch: 4, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.391124963760376
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.42296719551086426
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.38259363174438477
Epoch: 7, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.42827653884887695
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.36399269104003906
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.41727590560913086
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4201204776763916
Epoch: 11, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.34469008445739746
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3487401008605957
Epoch: 13, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.35909271240234375
Epoch: 14, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4206252098083496
Epoch: 15, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.38505101203918457
Epoch: 16, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.390627384185791
Epoch: 17, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3775203227996826
Epoch: 18, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.34410953521728516
Epoch: 19, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.35872769355773926
Epoch: 20, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4657132625579834
Epoch: 21, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4018216133117676
Epoch: 22, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.3382575511932373
Epoch: 23, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3198528289794922
Epoch: 24, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.43593668937683105
Epoch: 25, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4688720703125
Epoch: 26, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.45130252838134766
Epoch: 27, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5065934658050537
Epoch: 28, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 376067
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6218352317810059
Epoch: 1, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.3716704845428467
Epoch: 2, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.41010141372680664
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.3573145866394043
Epoch: 4, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.3574216365814209
Epoch: 5, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.157 Vali Acc: 0.533 Test Loss: 1.157 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.47017717361450195
Epoch: 6, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.155 Vali Acc: 0.533 Test Loss: 1.155 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.526484489440918
Epoch: 7, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.150 Vali Acc: 0.533 Test Loss: 1.150 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.3657684326171875
Epoch: 8, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.3635447025299072
Epoch: 9, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.139 Vali Acc: 0.533 Test Loss: 1.139 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.3659939765930176
Epoch: 10, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.3300771713256836
Epoch: 11, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.128 Vali Acc: 0.600 Test Loss: 1.128 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.3794901371002197
Epoch: 12, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.3631277084350586
Epoch: 13, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3593015670776367
Epoch: 14, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.2987501621246338
Epoch: 15, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.34834885597229004
Epoch: 16, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3978250026702881
Epoch: 17, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.507929801940918
Epoch: 18, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3859734535217285
Epoch: 19, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.356158971786499
Epoch: 20, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.46034932136535645
Epoch: 21, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.3264639377593994
Epoch: 22, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 141059
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.604154109954834
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3953735828399658
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.39096999168395996
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.43068528175354004
Epoch: 4, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.4321784973144531
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4525299072265625
Epoch: 6, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.44277024269104004
Epoch: 7, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5095865726470947
Epoch: 8, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.42708349227905273
Epoch: 9, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.44420647621154785
Epoch: 10, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.44945192337036133
Epoch: 11, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4174020290374756
Epoch: 12, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.37075233459472656
Epoch: 13, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.4305243492126465
Epoch: 14, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.417586088180542
Epoch: 15, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.37570738792419434
Epoch: 16, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4261739253997803
Epoch: 17, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.39665794372558594
Epoch: 18, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.43131327629089355
Epoch: 19, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.4019598960876465
Epoch: 20, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.37691569328308105
Epoch: 21, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.4569094181060791
Epoch: 22, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.003 Vali Acc: 0.667 Test Loss: 1.003 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 23 cost time: 0.41463685035705566
Epoch: 23, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4059414863586426
Epoch: 24, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.008 Vali Acc: 0.667 Test Loss: 1.008 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4988739490509033
Epoch: 25, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3898766040802002
Epoch: 26, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.47260284423828125
Epoch: 27, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5211043357849121
Epoch: 28, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.42464137077331543
Epoch: 29, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4202287197113037
Epoch: 30, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.37866735458374023
Epoch: 31, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4164540767669678
Epoch: 32, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 115075
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6170916557312012
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3737058639526367
Epoch: 2, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4630725383758545
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3870840072631836
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.49445486068725586
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3992788791656494
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.35927367210388184
Epoch: 7, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.42668867111206055
Epoch: 8, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.39838480949401855
Epoch: 9, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.41618847846984863
Epoch: 10, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.370830774307251
Epoch: 11, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.386446475982666
Epoch: 12, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.3800537586212158
Epoch: 13, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.37584567070007324
Epoch: 14, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.39862990379333496
Epoch: 15, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3091883659362793
Epoch: 16, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.38541221618652344
Epoch: 17, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.3669395446777344
Epoch: 18, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.39841699600219727
Epoch: 19, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.4045400619506836
Epoch: 20, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.3697671890258789
Epoch: 21, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.44882845878601074
Epoch: 22, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.45397329330444336
Epoch: 23, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.45635461807250977
Epoch: 24, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.40415263175964355
Epoch: 25, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.3093092441558838
Epoch: 26, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4445502758026123
Epoch: 27, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.320009708404541
Epoch: 28, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4038529396057129
Epoch: 29, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.3245725631713867
Epoch: 30, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.3631556034088135
Epoch: 31, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.39885473251342773
Epoch: 32, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.3979625701904297
Epoch: 33, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.391049861907959
Epoch: 34, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.3384521007537842
Epoch: 35, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 109123
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7645103931427002
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.34415292739868164
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.3934454917907715
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.3759489059448242
Epoch: 4, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4273402690887451
Epoch: 5, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.3710823059082031
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.3284595012664795
Epoch: 7, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.2991621494293213
Epoch: 8, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.44792962074279785
Epoch: 9, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3937861919403076
Epoch: 10, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.41998982429504395
Epoch: 11, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.40822911262512207
Epoch: 12, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.3486177921295166
Epoch: 13, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.34568095207214355
Epoch: 14, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3945627212524414
Epoch: 15, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.41082239151000977
Epoch: 16, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.30689501762390137
Epoch: 17, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.44117069244384766
Epoch: 18, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.360353946685791
Epoch: 19, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.39255332946777344
Epoch: 20, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 21 cost time: 0.39063191413879395
Epoch: 21, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 22 cost time: 0.40312767028808594
Epoch: 22, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.41920924186706543
Epoch: 23, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.30079054832458496
Epoch: 24, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.38273119926452637
Epoch: 25, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.43341732025146484
Epoch: 26, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4422881603240967
Epoch: 27, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.43227148056030273
Epoch: 28, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.41898608207702637
Epoch: 29, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.35283350944519043
Epoch: 30, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.39159631729125977
Epoch: 31, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 108483
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.513052225112915
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.35666489601135254
Epoch: 2, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.30817747116088867
Epoch: 3, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.40480613708496094
Epoch: 4, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.33094239234924316
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3373703956604004
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.33672642707824707
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.33901143074035645
Epoch: 8, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.32120561599731445
Epoch: 9, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.29114198684692383
Epoch: 10, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.33199548721313477
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 111107
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4891934394836426
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4740579128265381
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3238346576690674
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.33899402618408203
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.33378100395202637
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3684206008911133
Epoch: 6, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3283407688140869
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.3428924083709717
Epoch: 8, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3357253074645996
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.40582847595214844
Epoch: 10, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4306297302246094
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.35021352767944336
Epoch: 12, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.34557557106018066
Epoch: 13, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.3606283664703369
Epoch: 14, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.31867551803588867
Epoch: 15, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3487584590911865
Epoch: 16, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.38963818550109863
Epoch: 17, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.41353273391723633
Epoch: 18, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.41685986518859863
Epoch: 19, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3494277000427246
Epoch: 20, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3555920124053955
Epoch: 21, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.38881373405456543
Epoch: 22, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.3795795440673828
Epoch: 23, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.3544635772705078
Epoch: 24, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 116803
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.523113489151001
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4004628658294678
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.36624932289123535
Epoch: 3, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3914213180541992
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4878883361816406
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40723443031311035
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.44158482551574707
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3774235248565674
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.44095277786254883
Epoch: 9, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4313688278198242
Epoch: 10, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.37746143341064453
Epoch: 11, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 122499
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.638364553451538
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4349226951599121
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4460930824279785
Epoch: 3, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3852672576904297
Epoch: 4, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.415757417678833
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.30928754806518555
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.39436841011047363
Epoch: 7, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.42532825469970703
Epoch: 8, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.39051175117492676
Epoch: 9, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3576183319091797
Epoch: 10, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4924912452697754
Epoch: 11, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 54147
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6255478858947754
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3092827796936035
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.33367919921875
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.31760239601135254
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3359839916229248
Epoch: 5, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.41205453872680664
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3310706615447998
Epoch: 7, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3759603500366211
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4072089195251465
Epoch: 9, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.408954381942749
Epoch: 10, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.3389272689819336
Epoch: 11, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.3074676990509033
Epoch: 12, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.3030359745025635
Epoch: 13, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.34793519973754883
Epoch: 14, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.31794047355651855
Epoch: 15, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.2797253131866455
Epoch: 16, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.3575730323791504
Epoch: 17, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.33934664726257324
Epoch: 18, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.4105813503265381
Epoch: 19, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.36456775665283203
Epoch: 20, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.33582091331481934
Epoch: 21, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.3046121597290039
Epoch: 22, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.3673665523529053
Epoch: 23, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.3040132522583008
Epoch: 24, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.36162662506103516
Epoch: 25, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.3303072452545166
Epoch: 26, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.36582136154174805
Epoch: 27, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.33607959747314453
Epoch: 28, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.48402881622314453
Epoch: 29, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.3862643241882324
Epoch: 30, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.39720869064331055
Epoch: 31, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.33400797843933105
Epoch: 32, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.3410675525665283
Epoch: 33, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.40383005142211914
Epoch: 34, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.2927439212799072
Epoch: 35, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.3305845260620117
Epoch: 36, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 41155
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7032816410064697
Epoch: 1, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.3145432472229004
Epoch: 2, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.3372790813446045
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.4562540054321289
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.3327600955963135
Epoch: 5, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.44310617446899414
Epoch: 6, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.34215545654296875
Epoch: 7, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.3171844482421875
Epoch: 8, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.31313228607177734
Epoch: 9, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.3129580020904541
Epoch: 10, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.3399333953857422
Epoch: 11, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.3442654609680176
Epoch: 12, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.3683128356933594
Epoch: 13, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.28862833976745605
Epoch: 14, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.39473819732666016
Epoch: 15, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 16 cost time: 0.30701518058776855
Epoch: 16, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.3571147918701172
Epoch: 17, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 18 cost time: 0.3405153751373291
Epoch: 18, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 19 cost time: 0.3809638023376465
Epoch: 19, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 20 cost time: 0.3043782711029053
Epoch: 20, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 0.3646728992462158
Epoch: 21, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 0.3739590644836426
Epoch: 22, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 0.42113447189331055
Epoch: 23, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 0.4184877872467041
Epoch: 24, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 0.42145752906799316
Epoch: 25, Steps: 1 | Train Loss: 0.425 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 26 cost time: 0.43567538261413574
Epoch: 26, Steps: 1 | Train Loss: 0.393 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 27 cost time: 0.364177942276001
Epoch: 27, Steps: 1 | Train Loss: 0.368 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.41678380966186523
Epoch: 28, Steps: 1 | Train Loss: 0.365 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.32430219650268555
Epoch: 29, Steps: 1 | Train Loss: 0.334 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 0.38198399543762207
Epoch: 30, Steps: 1 | Train Loss: 0.327 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 0.3436155319213867
Epoch: 31, Steps: 1 | Train Loss: 0.315 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.3021705150604248
Epoch: 32, Steps: 1 | Train Loss: 0.288 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.3204629421234131
Epoch: 33, Steps: 1 | Train Loss: 0.275 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.40416431427001953
Epoch: 34, Steps: 1 | Train Loss: 0.247 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.34955930709838867
Epoch: 35, Steps: 1 | Train Loss: 0.244 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.33600950241088867
Epoch: 36, Steps: 1 | Train Loss: 0.252 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4222404956817627
Epoch: 37, Steps: 1 | Train Loss: 0.212 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3155536651611328
Epoch: 38, Steps: 1 | Train Loss: 0.209 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.3025209903717041
Epoch: 39, Steps: 1 | Train Loss: 0.189 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.33736133575439453
Epoch: 40, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.382312536239624
Epoch: 41, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.3735768795013428
Epoch: 42, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 38179
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4678030014038086
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.327603816986084
Epoch: 2, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.41579484939575195
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3546631336212158
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.41764211654663086
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.368973970413208
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.30886006355285645
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4242417812347412
Epoch: 8, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.35152602195739746
Epoch: 9, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4750401973724365
Epoch: 10, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3331620693206787
Epoch: 11, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.3661978244781494
Epoch: 12, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3953988552093506
Epoch: 13, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.360501766204834
Epoch: 14, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.383389949798584
Epoch: 15, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3290860652923584
Epoch: 16, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.32148241996765137
Epoch: 17, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.42034268379211426
Epoch: 18, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3549497127532959
Epoch: 19, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.3155176639556885
Epoch: 20, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.3819761276245117
Epoch: 21, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4186527729034424
Epoch: 22, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3084571361541748
Epoch: 23, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4622073173522949
Epoch: 24, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3517484664916992
Epoch: 25, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.35143589973449707
Epoch: 26, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.48395729064941406
Epoch: 27, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.32701826095581055
Epoch: 28, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.368316650390625
Epoch: 29, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.42430925369262695
Epoch: 30, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.4791085720062256
Epoch: 31, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.41430115699768066
Epoch: 32, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.44577574729919434
Epoch: 33, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.3607480525970459
Epoch: 34, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.369415283203125
Epoch: 35, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.3796555995941162
Epoch: 36, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.41682887077331543
Epoch: 37, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.3354034423828125
Epoch: 38, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.35950303077697754
Epoch: 39, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.35041213035583496
Epoch: 40, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 37859
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4609756469726562
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4193432331085205
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3989851474761963
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.35559821128845215
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.106 Vali Acc: 0.133 Test Loss: 1.106 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3548922538757324
Epoch: 5, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.107 Vali Acc: 0.133 Test Loss: 1.107 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3732740879058838
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.107 Vali Acc: 0.133 Test Loss: 1.107 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4611058235168457
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.108 Vali Acc: 0.133 Test Loss: 1.108 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3155992031097412
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.109 Vali Acc: 0.133 Test Loss: 1.109 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.43096423149108887
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.109 Vali Acc: 0.133 Test Loss: 1.109 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.38069605827331543
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.110 Vali Acc: 0.133 Test Loss: 1.110 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.38927221298217773
Epoch: 11, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.110 Vali Acc: 0.133 Test Loss: 1.110 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 39171
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6594741344451904
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.40784382820129395
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.3493926525115967
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.083 Vali Acc: 0.200 Test Loss: 1.083 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.3418910503387451
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.34552454948425293
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.35031914710998535
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.3321833610534668
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.3784935474395752
Epoch: 8, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.31645679473876953
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.3520357608795166
Epoch: 10, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.3927605152130127
Epoch: 11, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.38743138313293457
Epoch: 12, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.3368372917175293
Epoch: 13, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.3326728343963623
Epoch: 14, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.32774829864501953
Epoch: 15, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.32434606552124023
Epoch: 16, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.3480184078216553
Epoch: 17, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.37300872802734375
Epoch: 18, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.3249194622039795
Epoch: 19, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 0.37683701515197754
Epoch: 20, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.3179755210876465
Epoch: 21, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.37957191467285156
Epoch: 22, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 23 cost time: 0.3230602741241455
Epoch: 23, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 24 cost time: 0.42740845680236816
Epoch: 24, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.4137108325958252
Epoch: 25, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.4280993938446045
Epoch: 26, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.3191962242126465
Epoch: 27, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.34601640701293945
Epoch: 28, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 29 cost time: 0.3015015125274658
Epoch: 29, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 30 cost time: 0.33100461959838867
Epoch: 30, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 31 cost time: 0.37434959411621094
Epoch: 31, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 32 cost time: 0.3027465343475342
Epoch: 32, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 33 cost time: 0.30229902267456055
Epoch: 33, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.3288846015930176
Epoch: 34, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.3420290946960449
Epoch: 35, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4858715534210205
Epoch: 36, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3637821674346924
Epoch: 37, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.40653324127197266
Epoch: 38, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.3799877166748047
Epoch: 39, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.3697476387023926
Epoch: 40, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4210050106048584
Epoch: 41, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.3843119144439697
Epoch: 42, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 0.37166905403137207
Epoch: 43, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.34506964683532715
Epoch: 44, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.365673303604126
Epoch: 45, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.375720739364624
Epoch: 46, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.38689446449279785
Epoch: 47, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.3646361827850342
Epoch: 48, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.38678407669067383
Epoch: 49, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.3187406063079834
Epoch: 50, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 42019
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.603734016418457
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.045 Vali Acc: 0.667 Test Loss: 1.045 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.3820688724517822
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4006195068359375
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.500105619430542
Epoch: 4, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.33617615699768066
Epoch: 5, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3706398010253906
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.42299938201904297
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4125211238861084
Epoch: 8, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.035 Vali Acc: 0.667 Test Loss: 1.035 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.3302597999572754
Epoch: 9, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.034 Vali Acc: 0.667 Test Loss: 1.034 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 0.39345240592956543
Epoch: 10, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 0.363391637802124
Epoch: 11, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 12 cost time: 0.3210787773132324
Epoch: 12, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 0.3644704818725586
Epoch: 13, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 0.3522779941558838
Epoch: 14, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 15 cost time: 0.3410177230834961
Epoch: 15, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.33759021759033203
Epoch: 16, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 17 cost time: 0.33959507942199707
Epoch: 17, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 18 cost time: 0.35083436965942383
Epoch: 18, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 0.40599513053894043
Epoch: 19, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.026 Vali Acc: 0.667 Test Loss: 1.026 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 20 cost time: 0.35731959342956543
Epoch: 20, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.026 Vali Acc: 0.667 Test Loss: 1.026 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 0.419050931930542
Epoch: 21, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.34015798568725586
Epoch: 22, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3882460594177246
Epoch: 23, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3997037410736084
Epoch: 24, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4157984256744385
Epoch: 25, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.36751294136047363
Epoch: 26, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.38141298294067383
Epoch: 27, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4336411952972412
Epoch: 28, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.3896305561065674
Epoch: 29, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.37696385383605957
Epoch: 30, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 44867
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.636087417602539
Epoch: 1, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4568805694580078
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.47684550285339355
Epoch: 3, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3987574577331543
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.44341588020324707
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.47191381454467773
Epoch: 6, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.415879487991333
Epoch: 7, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.3695545196533203
Epoch: 8, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5185215473175049
Epoch: 9, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.42151856422424316
Epoch: 10, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4064962863922119
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3540322780609131
Epoch: 12, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.33280420303344727
Epoch: 13, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.3522317409515381
Epoch: 14, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.37754392623901367
Epoch: 15, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.421642541885376
Epoch: 16, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.36429810523986816
Epoch: 17, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 256643
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8509163856506348
Epoch: 1, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.43537092208862305
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.45549941062927246
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.40169715881347656
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.390735387802124
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4232025146484375
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.40931034088134766
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.41258859634399414
Epoch: 8, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.35318803787231445
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.37102437019348145
Epoch: 10, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.47818708419799805
Epoch: 11, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.427901029586792
Epoch: 12, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.39882349967956543
Epoch: 13, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.3857285976409912
Epoch: 14, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.36000847816467285
Epoch: 15, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.39577150344848633
Epoch: 16, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.36409568786621094
Epoch: 17, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.39031219482421875
Epoch: 18, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5083403587341309
Epoch: 19, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.42064356803894043
Epoch: 20, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4454622268676758
Epoch: 21, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.37983036041259766
Epoch: 22, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4335923194885254
Epoch: 23, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 243267
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6762280464172363
Epoch: 1, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36997437477111816
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.32424473762512207
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5068204402923584
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.35512208938598633
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3786759376525879
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4962944984436035
Epoch: 7, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5613405704498291
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.39019250869750977
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3918759822845459
Epoch: 10, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.45232653617858887
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 240675
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6082372665405273
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.356830358505249
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.46799492835998535
Epoch: 3, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3497002124786377
Epoch: 4, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3715860843658447
Epoch: 5, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3827652931213379
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.42686939239501953
Epoch: 7, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4625990390777588
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4171152114868164
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.3909180164337158
Epoch: 10, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4441812038421631
Epoch: 11, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4427347183227539
Epoch: 12, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.36113786697387695
Epoch: 13, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.361616849899292
Epoch: 14, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 239587
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6372325420379639
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.40101122856140137
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3837010860443115
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.44357848167419434
Epoch: 4, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.392164945602417
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4571540355682373
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3872208595275879
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.45406436920166016
Epoch: 8, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.42242980003356934
Epoch: 9, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3818540573120117
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48314547538757324
Epoch: 11, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4936373233795166
Epoch: 12, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3498692512512207
Epoch: 13, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4326183795928955
Epoch: 14, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.38631129264831543
Epoch: 15, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.36222267150878906
Epoch: 16, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.4055352210998535
Epoch: 17, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4289438724517822
Epoch: 18, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4964933395385742
Epoch: 19, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4258737564086914
Epoch: 20, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.37732386589050293
Epoch: 21, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.3750038146972656
Epoch: 22, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.40402770042419434
Epoch: 23, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.47954630851745605
Epoch: 24, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.4373197555541992
Epoch: 25, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.4081404209136963
Epoch: 26, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.3901350498199463
Epoch: 27, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4354827404022217
Epoch: 28, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.43460917472839355
Epoch: 29, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.37145400047302246
Epoch: 30, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.41104960441589355
Epoch: 31, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4166836738586426
Epoch: 32, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4097144603729248
Epoch: 33, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.42810797691345215
Epoch: 34, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4047811031341553
Epoch: 35, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.39052844047546387
Epoch: 36, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 242051
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6550965309143066
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.33505892753601074
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42114949226379395
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4029097557067871
Epoch: 4, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.41736769676208496
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3713250160217285
Epoch: 6, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.36055922508239746
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.40071749687194824
Epoch: 8, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4115293025970459
Epoch: 9, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5326154232025146
Epoch: 10, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.46428608894348145
Epoch: 11, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4694976806640625
Epoch: 12, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3737332820892334
Epoch: 13, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.4100015163421631
Epoch: 14, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.5240159034729004
Epoch: 15, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5689971446990967
Epoch: 16, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.46050477027893066
Epoch: 17, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.4258558750152588
Epoch: 18, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3893451690673828
Epoch: 19, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.4728989601135254
Epoch: 20, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.42070865631103516
Epoch: 21, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.437854528427124
Epoch: 22, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.37328600883483887
Epoch: 23, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.3590691089630127
Epoch: 24, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.42325735092163086
Epoch: 25, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.384566068649292
Epoch: 26, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.39099907875061035
Epoch: 27, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 0.44202685356140137
Epoch: 28, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.41636109352111816
Epoch: 29, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 0.3765254020690918
Epoch: 30, Steps: 1 | Train Loss: 0.627 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 0.35225772857666016
Epoch: 31, Steps: 1 | Train Loss: 0.575 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.3935368061065674
Epoch: 32, Steps: 1 | Train Loss: 0.567 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.3502490520477295
Epoch: 33, Steps: 1 | Train Loss: 0.546 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.3972432613372803
Epoch: 34, Steps: 1 | Train Loss: 0.544 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 35 cost time: 0.3698251247406006
Epoch: 35, Steps: 1 | Train Loss: 0.509 Vali Loss: 0.985 Vali Acc: 0.667 Test Loss: 0.985 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 36 cost time: 0.40065646171569824
Epoch: 36, Steps: 1 | Train Loss: 0.495 Vali Loss: 0.982 Vali Acc: 0.667 Test Loss: 0.982 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 37 cost time: 0.3648409843444824
Epoch: 37, Steps: 1 | Train Loss: 0.490 Vali Loss: 0.980 Vali Acc: 0.733 Test Loss: 0.980 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733324).  Saving model ...
Epoch: 38 cost time: 0.3703947067260742
Epoch: 38, Steps: 1 | Train Loss: 0.471 Vali Loss: 0.977 Vali Acc: 0.733 Test Loss: 0.977 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 39 cost time: 0.38965392112731934
Epoch: 39, Steps: 1 | Train Loss: 0.454 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5577447414398193
Epoch: 40, Steps: 1 | Train Loss: 0.437 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4358813762664795
Epoch: 41, Steps: 1 | Train Loss: 0.401 Vali Loss: 0.970 Vali Acc: 0.667 Test Loss: 0.970 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.43969249725341797
Epoch: 42, Steps: 1 | Train Loss: 0.404 Vali Loss: 0.968 Vali Acc: 0.667 Test Loss: 0.968 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4192228317260742
Epoch: 43, Steps: 1 | Train Loss: 0.396 Vali Loss: 0.966 Vali Acc: 0.667 Test Loss: 0.966 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.45606207847595215
Epoch: 44, Steps: 1 | Train Loss: 0.375 Vali Loss: 0.964 Vali Acc: 0.667 Test Loss: 0.964 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.48375439643859863
Epoch: 45, Steps: 1 | Train Loss: 0.370 Vali Loss: 0.962 Vali Acc: 0.667 Test Loss: 0.962 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.3600609302520752
Epoch: 46, Steps: 1 | Train Loss: 0.354 Vali Loss: 0.960 Vali Acc: 0.667 Test Loss: 0.960 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.3979790210723877
Epoch: 47, Steps: 1 | Train Loss: 0.335 Vali Loss: 0.958 Vali Acc: 0.667 Test Loss: 0.958 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4831719398498535
Epoch: 48, Steps: 1 | Train Loss: 0.327 Vali Loss: 0.956 Vali Acc: 0.667 Test Loss: 0.956 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 244515
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6001200675964355
Epoch: 1, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.42075586318969727
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39569091796875
Epoch: 3, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43044233322143555
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3746633529663086
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3797750473022461
Epoch: 6, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4914512634277344
Epoch: 7, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.330977201461792
Epoch: 8, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3413558006286621
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.34877443313598633
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4228379726409912
Epoch: 11, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 246979
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6109256744384766
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3775138854980469
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3968648910522461
Epoch: 3, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3722860813140869
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4425802230834961
Epoch: 5, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3892514705657959
Epoch: 6, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3979341983795166
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.338214635848999
Epoch: 8, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.41174840927124023
Epoch: 9, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.39382290840148926
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.35390663146972656
Epoch: 11, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.42200350761413574
Epoch: 12, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.3695344924926758
Epoch: 13, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.36182522773742676
Epoch: 14, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.39455151557922363
Epoch: 15, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.3702223300933838
Epoch: 16, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.4022202491760254
Epoch: 17, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4032418727874756
Epoch: 18, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.34947943687438965
Epoch: 19, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.40393924713134766
Epoch: 20, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.42655396461486816
Epoch: 21, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.39096856117248535
Epoch: 22, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4042947292327881
Epoch: 23, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.3672657012939453
Epoch: 24, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.464339017868042
Epoch: 25, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.43738889694213867
Epoch: 26, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 253059
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5859320163726807
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3833186626434326
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3666801452636719
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.42961549758911133
Epoch: 4, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48705148696899414
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.43064379692077637
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.38808345794677734
Epoch: 7, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4042050838470459
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.467989444732666
Epoch: 9, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.35672760009765625
Epoch: 10, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.44536733627319336
Epoch: 11, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4297652244567871
Epoch: 12, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.093 Vali Acc: 0.133 Test Loss: 1.093 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.41003870964050293
Epoch: 13, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.092 Vali Acc: 0.133 Test Loss: 1.092 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 239683
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5394604206085205
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.32091832160949707
Epoch: 2, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3396914005279541
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.44936323165893555
Epoch: 4, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.34278154373168945
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3978393077850342
Epoch: 6, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.38666772842407227
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3707582950592041
Epoch: 8, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3675079345703125
Epoch: 9, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3207666873931885
Epoch: 10, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.35644984245300293
Epoch: 11, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.34134507179260254
Epoch: 12, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.3541421890258789
Epoch: 13, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.3771672248840332
Epoch: 14, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.3940761089324951
Epoch: 15, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.40023183822631836
Epoch: 16, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3280975818634033
Epoch: 17, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.33749890327453613
Epoch: 18, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.30120396614074707
Epoch: 19, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.3451242446899414
Epoch: 20, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.35567522048950195
Epoch: 21, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.35785460472106934
Epoch: 22, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.3110501766204834
Epoch: 23, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.40843749046325684
Epoch: 24, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4375321865081787
Epoch: 25, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.31263279914855957
Epoch: 26, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.43087196350097656
Epoch: 27, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.004 Vali Acc: 0.400 Test Loss: 1.004 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.3769354820251465
Epoch: 28, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.3642098903656006
Epoch: 29, Steps: 1 | Train Loss: 0.555 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.33150720596313477
Epoch: 30, Steps: 1 | Train Loss: 0.562 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.3196239471435547
Epoch: 31, Steps: 1 | Train Loss: 0.530 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 237091
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.462207555770874
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3716115951538086
Epoch: 2, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3665354251861572
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.39857983589172363
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3339393138885498
Epoch: 5, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3614201545715332
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3304262161254883
Epoch: 7, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.34785985946655273
Epoch: 8, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4185957908630371
Epoch: 9, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3305625915527344
Epoch: 10, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.36014628410339355
Epoch: 11, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.33713269233703613
Epoch: 12, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.40557861328125
Epoch: 13, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3366730213165283
Epoch: 14, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.40795111656188965
Epoch: 15, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.4047067165374756
Epoch: 16, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.3648228645324707
Epoch: 17, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.34096837043762207
Epoch: 18, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.33335018157958984
Epoch: 19, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.3470494747161865
Epoch: 20, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.34648871421813965
Epoch: 21, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.30926084518432617
Epoch: 22, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.33961009979248047
Epoch: 23, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.3554975986480713
Epoch: 24, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.3198263645172119
Epoch: 25, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.35338401794433594
Epoch: 26, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3618049621582031
Epoch: 27, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.32739996910095215
Epoch: 28, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.3722701072692871
Epoch: 29, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.48636436462402344
Epoch: 30, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.3826777935028076
Epoch: 31, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.33953189849853516
Epoch: 32, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.35082173347473145
Epoch: 33, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 236003
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.596308946609497
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3153560161590576
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.34491896629333496
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.37708282470703125
Epoch: 4, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.39696431159973145
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3526337146759033
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3600335121154785
Epoch: 7, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.39154648780822754
Epoch: 8, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.3740122318267822
Epoch: 9, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.36298108100891113
Epoch: 10, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.34771084785461426
Epoch: 11, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.3509345054626465
Epoch: 12, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.3371703624725342
Epoch: 13, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.325925350189209
Epoch: 14, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3864445686340332
Epoch: 15, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.36385083198547363
Epoch: 16, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.34728574752807617
Epoch: 17, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.3541562557220459
Epoch: 18, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.388333797454834
Epoch: 19, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.35455894470214844
Epoch: 20, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.3618936538696289
Epoch: 21, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3539879322052002
Epoch: 22, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.4046976566314697
Epoch: 23, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.33293581008911133
Epoch: 24, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.39356422424316406
Epoch: 25, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.3775014877319336
Epoch: 26, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.3516225814819336
Epoch: 27, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.37337398529052734
Epoch: 28, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.34937429428100586
Epoch: 29, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.2978696823120117
Epoch: 30, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.33176612854003906
Epoch: 31, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.3109617233276367
Epoch: 32, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.30542516708374023
Epoch: 33, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.34542083740234375
Epoch: 34, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.33706068992614746
Epoch: 35, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.4058108329772949
Epoch: 36, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.37473344802856445
Epoch: 37, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.36520934104919434
Epoch: 38, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.3297412395477295
Epoch: 39, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.3631477355957031
Epoch: 40, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.37001609802246094
Epoch: 41, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 238467
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6360275745391846
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3884310722351074
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4029521942138672
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.39116811752319336
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3741872310638428
Epoch: 5, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5117356777191162
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3454921245574951
Epoch: 7, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4233579635620117
Epoch: 8, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.34400081634521484
Epoch: 9, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.374788761138916
Epoch: 10, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.37671780586242676
Epoch: 11, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 240931
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5021483898162842
Epoch: 1, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.38454747200012207
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5538654327392578
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4257204532623291
Epoch: 4, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4458427429199219
Epoch: 5, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4283730983734131
Epoch: 6, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3814210891723633
Epoch: 7, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.36020421981811523
Epoch: 8, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.37684154510498047
Epoch: 9, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.34575963020324707
Epoch: 10, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.35893750190734863
Epoch: 11, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4268686771392822
Epoch: 12, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.36617040634155273
Epoch: 13, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.36466479301452637
Epoch: 14, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.39185595512390137
Epoch: 15, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.4032876491546631
Epoch: 16, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.3711977005004883
Epoch: 17, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.3745293617248535
Epoch: 18, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.3439910411834717
Epoch: 19, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 0.46029186248779297
Epoch: 20, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 0.33881640434265137
Epoch: 21, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 22 cost time: 0.36356258392333984
Epoch: 22, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 23 cost time: 0.44020581245422363
Epoch: 23, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.35114169120788574
Epoch: 24, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.34881067276000977
Epoch: 25, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.4350414276123047
Epoch: 26, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.39946460723876953
Epoch: 27, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.37227416038513184
Epoch: 28, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.3517606258392334
Epoch: 29, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 30 cost time: 0.3429543972015381
Epoch: 30, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 31 cost time: 0.370227575302124
Epoch: 31, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.4221036434173584
Epoch: 32, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.5051181316375732
Epoch: 33, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 0.3548543453216553
Epoch: 34, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 35 cost time: 0.40509033203125
Epoch: 35, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 0.30806612968444824
Epoch: 36, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 37 cost time: 0.32954955101013184
Epoch: 37, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.35195422172546387
Epoch: 38, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 0.3447761535644531
Epoch: 39, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.32517027854919434
Epoch: 40, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4094879627227783
Epoch: 41, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.39168620109558105
Epoch: 42, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.36054372787475586
Epoch: 43, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.023 Vali Acc: 0.333 Test Loss: 1.023 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.3816564083099365
Epoch: 44, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.021 Vali Acc: 0.333 Test Loss: 1.021 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.3945581912994385
Epoch: 45, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.020 Vali Acc: 0.333 Test Loss: 1.020 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.3950066566467285
Epoch: 46, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.019 Vali Acc: 0.333 Test Loss: 1.019 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4623086452484131
Epoch: 47, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.017 Vali Acc: 0.333 Test Loss: 1.017 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.34337520599365234
Epoch: 48, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 243395
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.70790696144104
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.41042184829711914
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.4421405792236328
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4080617427825928
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.396909236907959
Epoch: 5, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.037 Vali Acc: 0.333 Test Loss: 1.037 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3807971477508545
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.34960103034973145
Epoch: 7, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3603549003601074
Epoch: 8, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3532891273498535
Epoch: 9, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3463764190673828
Epoch: 10, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3955245018005371
Epoch: 11, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 12 cost time: 0.4228494167327881
Epoch: 12, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 13 cost time: 0.33210206031799316
Epoch: 13, Steps: 1 | Train Loss: 0.359 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 14 cost time: 0.4289212226867676
Epoch: 14, Steps: 1 | Train Loss: 0.304 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.33743786811828613
Epoch: 15, Steps: 1 | Train Loss: 0.261 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3955843448638916
Epoch: 16, Steps: 1 | Train Loss: 0.205 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.46651744842529297
Epoch: 17, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3315591812133789
Epoch: 18, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3977339267730713
Epoch: 19, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.36882758140563965
Epoch: 20, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3166472911834717
Epoch: 21, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.3287014961242676
Epoch: 22, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.3855104446411133
Epoch: 23, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4099857807159424
Epoch: 24, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 902659
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.594557285308838
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3548450469970703
Epoch: 2, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3454771041870117
Epoch: 3, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.361663818359375
Epoch: 4, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.34293198585510254
Epoch: 5, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.46958112716674805
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.35763072967529297
Epoch: 7, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3537130355834961
Epoch: 8, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.359175443649292
Epoch: 9, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.33759093284606934
Epoch: 10, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.34336209297180176
Epoch: 11, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4698984622955322
Epoch: 12, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3450131416320801
Epoch: 13, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.5139904022216797
Epoch: 14, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.35450124740600586
Epoch: 15, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3694591522216797
Epoch: 16, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.350494384765625
Epoch: 17, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4110584259033203
Epoch: 18, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3288745880126953
Epoch: 19, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4282491207122803
Epoch: 20, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.3496537208557129
Epoch: 21, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.37053585052490234
Epoch: 22, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.43666839599609375
Epoch: 23, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 852227
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4897868633270264
Epoch: 1, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.33932971954345703
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37305164337158203
Epoch: 3, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3535768985748291
Epoch: 4, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3947923183441162
Epoch: 5, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3381812572479248
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4604635238647461
Epoch: 7, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.35325074195861816
Epoch: 8, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3644235134124756
Epoch: 9, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4219238758087158
Epoch: 10, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.32790279388427734
Epoch: 11, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 838787
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5531094074249268
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.39725828170776367
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3562150001525879
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3378000259399414
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.36896705627441406
Epoch: 5, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.34049320220947266
Epoch: 6, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.36623716354370117
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.40265846252441406
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.33463621139526367
Epoch: 9, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.39528441429138184
Epoch: 10, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3261420726776123
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.31817126274108887
Epoch: 12, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.33032798767089844
Epoch: 13, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.3337740898132324
Epoch: 14, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.37272000312805176
Epoch: 15, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3874337673187256
Epoch: 16, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.31981825828552246
Epoch: 17, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.37125325202941895
Epoch: 18, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3903200626373291
Epoch: 19, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.39423084259033203
Epoch: 20, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.3541736602783203
Epoch: 21, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3693215847015381
Epoch: 22, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4045588970184326
Epoch: 23, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.35291147232055664
Epoch: 24, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.3251931667327881
Epoch: 25, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 837507
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5215351581573486
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.39591431617736816
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3781929016113281
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3909919261932373
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.45058298110961914
Epoch: 5, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.45271992683410645
Epoch: 6, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.34845924377441406
Epoch: 7, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.3393397331237793
Epoch: 8, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.36547017097473145
Epoch: 9, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3438558578491211
Epoch: 10, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.44965505599975586
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.3658483028411865
Epoch: 12, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3548848628997803
Epoch: 13, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.35310888290405273
Epoch: 14, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4204721450805664
Epoch: 15, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.36978864669799805
Epoch: 16, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.48616981506347656
Epoch: 17, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.38313746452331543
Epoch: 18, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3362143039703369
Epoch: 19, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.34674692153930664
Epoch: 20, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4135758876800537
Epoch: 21, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.36399269104003906
Epoch: 22, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.41377997398376465
Epoch: 23, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.38613176345825195
Epoch: 24, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.41754603385925293
Epoch: 25, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.3806338310241699
Epoch: 26, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.42644405364990234
Epoch: 27, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 844291
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5227274894714355
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.37953782081604004
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.39920783042907715
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.37851548194885254
Epoch: 4, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.4192543029785156
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.3772125244140625
Epoch: 6, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.35297465324401855
Epoch: 7, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.4138309955596924
Epoch: 8, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.47310328483581543
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3796870708465576
Epoch: 10, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.40574026107788086
Epoch: 11, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4030723571777344
Epoch: 12, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.36440300941467285
Epoch: 13, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.4677467346191406
Epoch: 14, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5619642734527588
Epoch: 15, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47039151191711426
Epoch: 16, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.42592382431030273
Epoch: 17, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.41321444511413574
Epoch: 18, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3903367519378662
Epoch: 19, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.37532639503479004
Epoch: 20, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.3543698787689209
Epoch: 21, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.38006162643432617
Epoch: 22, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.35550785064697266
Epoch: 23, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 854147
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6163511276245117
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.37097668647766113
Epoch: 2, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4576754570007324
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.124 Vali Acc: 0.067 Test Loss: 1.124 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.42158937454223633
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.124 Vali Acc: 0.067 Test Loss: 1.124 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40777158737182617
Epoch: 5, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.124 Vali Acc: 0.067 Test Loss: 1.124 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4116346836090088
Epoch: 6, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.124 Vali Acc: 0.067 Test Loss: 1.124 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.37175989151000977
Epoch: 7, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.123 Vali Acc: 0.067 Test Loss: 1.123 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.417102575302124
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.122 Vali Acc: 0.067 Test Loss: 1.122 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.35404181480407715
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.122 Vali Acc: 0.067 Test Loss: 1.122 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.42572522163391113
Epoch: 10, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.121 Vali Acc: 0.133 Test Loss: 1.121 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.44134950637817383
Epoch: 11, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.119 Vali Acc: 0.133 Test Loss: 1.119 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 867075
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7129313945770264
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.36811089515686035
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.37778759002685547
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.34857940673828125
Epoch: 4, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.43295836448669434
Epoch: 5, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.3714768886566162
Epoch: 6, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.36784815788269043
Epoch: 7, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3537771701812744
Epoch: 8, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4199233055114746
Epoch: 9, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4739675521850586
Epoch: 10, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.130 Vali Acc: 0.133 Test Loss: 1.130 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3972952365875244
Epoch: 11, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.39652466773986816
Epoch: 12, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3591587543487549
Epoch: 13, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.391618013381958
Epoch: 14, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.38938069343566895
Epoch: 15, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.3846268653869629
Epoch: 16, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.3823091983795166
Epoch: 17, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 271107
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.573617696762085
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.37312865257263184
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.3598954677581787
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.3224968910217285
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3906397819519043
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3996121883392334
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.047 Vali Acc: 0.267 Test Loss: 1.047 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4610574245452881
Epoch: 7, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.045 Vali Acc: 0.267 Test Loss: 1.045 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.40311431884765625
Epoch: 8, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.043 Vali Acc: 0.267 Test Loss: 1.043 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.3394193649291992
Epoch: 9, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.041 Vali Acc: 0.267 Test Loss: 1.041 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.39087343215942383
Epoch: 10, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.039 Vali Acc: 0.333 Test Loss: 1.039 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.32656002044677734
Epoch: 11, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.037 Vali Acc: 0.333 Test Loss: 1.037 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.3452475070953369
Epoch: 12, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.30942320823669434
Epoch: 13, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 245891
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5559659004211426
Epoch: 1, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.347090482711792
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.35689425468444824
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.413590669631958
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.3337411880493164
Epoch: 5, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.32736873626708984
Epoch: 6, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3446941375732422
Epoch: 7, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 0.43891358375549316
Epoch: 8, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.31389451026916504
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3194458484649658
Epoch: 10, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.32587337493896484
Epoch: 11, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.3349134922027588
Epoch: 12, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.3245968818664551
Epoch: 13, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3239405155181885
Epoch: 14, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.39041733741760254
Epoch: 15, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.3029348850250244
Epoch: 16, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3438575267791748
Epoch: 17, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.38824892044067383
Epoch: 18, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3195929527282715
Epoch: 19, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.36471986770629883
Epoch: 20, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.39221715927124023
Epoch: 21, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.31530094146728516
Epoch: 22, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.36975598335266113
Epoch: 23, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.35474228858947754
Epoch: 24, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.35547780990600586
Epoch: 25, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.37806153297424316
Epoch: 26, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4434478282928467
Epoch: 27, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.3407785892486572
Epoch: 28, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3750324249267578
Epoch: 29, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.46471357345581055
Epoch: 30, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.3558475971221924
Epoch: 31, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.3585524559020996
Epoch: 32, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.3478231430053711
Epoch: 33, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.3536813259124756
Epoch: 34, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 239171
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.519237756729126
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3560061454772949
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4179050922393799
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.33812761306762695
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.35577988624572754
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3928546905517578
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.34649109840393066
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3612380027770996
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.4222850799560547
Epoch: 9, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.32888150215148926
Epoch: 10, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3385326862335205
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.42969536781311035
Epoch: 12, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3490169048309326
Epoch: 13, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3462390899658203
Epoch: 14, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.36837220191955566
Epoch: 15, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3970463275909424
Epoch: 16, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.35460543632507324
Epoch: 17, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.3614792823791504
Epoch: 18, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.35738325119018555
Epoch: 19, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4273707866668701
Epoch: 20, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.3599679470062256
Epoch: 21, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4271354675292969
Epoch: 22, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.3949878215789795
Epoch: 23, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3689291477203369
Epoch: 24, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4379692077636719
Epoch: 25, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.37481260299682617
Epoch: 26, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.44690585136413574
Epoch: 27, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.43448591232299805
Epoch: 28, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 238531
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.526473045349121
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.36458730697631836
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.33724260330200195
Epoch: 3, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3163630962371826
Epoch: 4, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.35384464263916016
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.44190049171447754
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.36452364921569824
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.42678308486938477
Epoch: 8, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.32750511169433594
Epoch: 9, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.3381781578063965
Epoch: 10, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3926811218261719
Epoch: 11, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.3162858486175537
Epoch: 12, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 241923
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5325078964233398
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4095296859741211
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3896036148071289
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3575704097747803
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4105522632598877
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3866579532623291
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3493506908416748
Epoch: 7, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.45729756355285645
Epoch: 8, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5044898986816406
Epoch: 9, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.3700399398803711
Epoch: 10, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.37346982955932617
Epoch: 11, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.45693063735961914
Epoch: 12, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4284050464630127
Epoch: 13, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.35836243629455566
Epoch: 14, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3268618583679199
Epoch: 15, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.36234211921691895
Epoch: 16, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3626542091369629
Epoch: 17, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.399183988571167
Epoch: 18, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3363664150238037
Epoch: 19, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.4832000732421875
Epoch: 20, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.379925012588501
Epoch: 21, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4281880855560303
Epoch: 22, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3800678253173828
Epoch: 23, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4457113742828369
Epoch: 24, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5081446170806885
Epoch: 25, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.35799074172973633
Epoch: 26, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4271368980407715
Epoch: 27, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4591333866119385
Epoch: 28, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4671499729156494
Epoch: 29, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.3959617614746094
Epoch: 30, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.40964221954345703
Epoch: 31, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4613523483276367
Epoch: 32, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4179990291595459
Epoch: 33, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.504594087600708
Epoch: 34, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.35633134841918945
Epoch: 35, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.39125847816467285
Epoch: 36, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.37503933906555176
Epoch: 37, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.41034626960754395
Epoch: 38, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4295034408569336
Epoch: 39, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.41126346588134766
Epoch: 40, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 246851
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4468646049499512
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.4330458641052246
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4196488857269287
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.516150712966919
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.44614267349243164
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43443775177001953
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3481011390686035
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.35334253311157227
Epoch: 8, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.412416934967041
Epoch: 9, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3754715919494629
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3966984748840332
Epoch: 11, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 253315
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.622284173965454
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3305680751800537
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.36942291259765625
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.37492966651916504
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.35994863510131836
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.36992716789245605
Epoch: 6, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.35594868659973145
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.3413262367248535
Epoch: 8, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.3238492012023926
Epoch: 9, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.3191201686859131
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.32950544357299805
Epoch: 11, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.3440220355987549
Epoch: 12, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.34725308418273926
Epoch: 13, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.34946537017822266
Epoch: 14, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.002 Vali Acc: 0.667 Test Loss: 1.002 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 15 cost time: 0.33429741859436035
Epoch: 15, Steps: 1 | Train Loss: 0.677 Vali Loss: 0.997 Vali Acc: 0.667 Test Loss: 0.997 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 0.3299367427825928
Epoch: 16, Steps: 1 | Train Loss: 0.659 Vali Loss: 0.992 Vali Acc: 0.667 Test Loss: 0.992 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 17 cost time: 0.36803174018859863
Epoch: 17, Steps: 1 | Train Loss: 0.609 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 18 cost time: 0.3406662940979004
Epoch: 18, Steps: 1 | Train Loss: 0.583 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 19 cost time: 0.3871297836303711
Epoch: 19, Steps: 1 | Train Loss: 0.556 Vali Loss: 0.978 Vali Acc: 0.667 Test Loss: 0.978 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 20 cost time: 0.4448511600494385
Epoch: 20, Steps: 1 | Train Loss: 0.511 Vali Loss: 0.973 Vali Acc: 0.667 Test Loss: 0.973 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 0.373124361038208
Epoch: 21, Steps: 1 | Train Loss: 0.484 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4606449604034424
Epoch: 22, Steps: 1 | Train Loss: 0.459 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.340242862701416
Epoch: 23, Steps: 1 | Train Loss: 0.413 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3817315101623535
Epoch: 24, Steps: 1 | Train Loss: 0.383 Vali Loss: 0.958 Vali Acc: 0.600 Test Loss: 0.958 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3680267333984375
Epoch: 25, Steps: 1 | Train Loss: 0.369 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3537886142730713
Epoch: 26, Steps: 1 | Train Loss: 0.334 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.33103084564208984
Epoch: 27, Steps: 1 | Train Loss: 0.309 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.45772528648376465
Epoch: 28, Steps: 1 | Train Loss: 0.305 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.35100531578063965
Epoch: 29, Steps: 1 | Train Loss: 0.273 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.353348970413208
Epoch: 30, Steps: 1 | Train Loss: 0.255 Vali Loss: 0.946 Vali Acc: 0.600 Test Loss: 0.946 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 90499
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5380854606628418
Epoch: 1, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3869514465332031
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.45195913314819336
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.3927617073059082
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.399385929107666
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.4563477039337158
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.3880598545074463
Epoch: 7, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.48392772674560547
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.3957638740539551
Epoch: 9, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.42893314361572266
Epoch: 10, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.4550318717956543
Epoch: 11, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.42375969886779785
Epoch: 12, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.41558194160461426
Epoch: 13, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.33421850204467773
Epoch: 14, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.38716602325439453
Epoch: 15, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.3660252094268799
Epoch: 16, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.38176655769348145
Epoch: 17, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.064 Vali Acc: 0.267 Test Loss: 1.064 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.44543004035949707
Epoch: 18, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3694155216217041
Epoch: 19, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.060 Vali Acc: 0.267 Test Loss: 1.060 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4825873374938965
Epoch: 20, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.059 Vali Acc: 0.267 Test Loss: 1.059 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4186246395111084
Epoch: 21, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.057 Vali Acc: 0.267 Test Loss: 1.057 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.40737247467041016
Epoch: 22, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.055 Vali Acc: 0.267 Test Loss: 1.055 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4313929080963135
Epoch: 23, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.054 Vali Acc: 0.267 Test Loss: 1.054 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.36510205268859863
Epoch: 24, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 25 cost time: 0.4504883289337158
Epoch: 25, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 26 cost time: 0.5304365158081055
Epoch: 26, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 27 cost time: 0.42290616035461426
Epoch: 27, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 28 cost time: 0.4358186721801758
Epoch: 28, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 29 cost time: 0.4040248394012451
Epoch: 29, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 30 cost time: 0.4544188976287842
Epoch: 30, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 31 cost time: 0.3867061138153076
Epoch: 31, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 32 cost time: 0.3824944496154785
Epoch: 32, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 33 cost time: 0.37814927101135254
Epoch: 33, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4535999298095703
Epoch: 34, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.42952823638916016
Epoch: 35, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4178133010864258
Epoch: 36, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.49858713150024414
Epoch: 37, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4315454959869385
Epoch: 38, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5102372169494629
Epoch: 39, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5430939197540283
Epoch: 40, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.501950740814209
Epoch: 41, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.440143346786499
Epoch: 42, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 77891
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3853120803833008
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.45668458938598633
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3775358200073242
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3816044330596924
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4107828140258789
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3900291919708252
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4085209369659424
Epoch: 7, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4201240539550781
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.38561272621154785
Epoch: 9, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.37436461448669434
Epoch: 10, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.33496761322021484
Epoch: 11, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 74531
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5062286853790283
Epoch: 1, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4082498550415039
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3509986400604248
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3193235397338867
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.45680785179138184
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.3226165771484375
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.37387919425964355
Epoch: 7, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.3242042064666748
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.37042236328125
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.32941293716430664
Epoch: 10, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.29404544830322266
Epoch: 11, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.30483317375183105
Epoch: 12, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3273136615753174
Epoch: 13, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.44258999824523926
Epoch: 14, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.3299534320831299
Epoch: 15, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.37201476097106934
Epoch: 16, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.34012770652770996
Epoch: 17, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 18 cost time: 0.32366085052490234
Epoch: 18, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.30974268913269043
Epoch: 19, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.43015480041503906
Epoch: 20, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.3542499542236328
Epoch: 21, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.3630988597869873
Epoch: 22, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.34138011932373047
Epoch: 23, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3466029167175293
Epoch: 24, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3397228717803955
Epoch: 25, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.38657069206237793
Epoch: 26, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.40378713607788086
Epoch: 27, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.34945249557495117
Epoch: 28, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 74211
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.542335033416748
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3627345561981201
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3907499313354492
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.344332218170166
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.34847521781921387
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.327517032623291
Epoch: 6, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3425579071044922
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.34558534622192383
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.39394187927246094
Epoch: 9, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.37319469451904297
Epoch: 10, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4470176696777344
Epoch: 11, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.407167911529541
Epoch: 12, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.35469937324523926
Epoch: 13, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.3921351432800293
Epoch: 14, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3692755699157715
Epoch: 15, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3730332851409912
Epoch: 16, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.3610343933105469
Epoch: 17, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.3803431987762451
Epoch: 18, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.42118144035339355
Epoch: 19, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.4151041507720947
Epoch: 20, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.38501477241516113
Epoch: 21, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3829519748687744
Epoch: 22, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.36315083503723145
Epoch: 23, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.3789546489715576
Epoch: 24, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.4001123905181885
Epoch: 25, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.3867807388305664
Epoch: 26, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.3532426357269287
Epoch: 27, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.4422798156738281
Epoch: 28, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.37624406814575195
Epoch: 29, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.37511157989501953
Epoch: 30, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.35835766792297363
Epoch: 31, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.37243008613586426
Epoch: 32, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.38483285903930664
Epoch: 33, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.3789350986480713
Epoch: 34, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.3958547115325928
Epoch: 35, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.36690211296081543
Epoch: 36, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.4160466194152832
Epoch: 37, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.3704547882080078
Epoch: 38, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 75907
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5302238464355469
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.33806633949279785
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.37894606590270996
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.339097261428833
Epoch: 4, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.37032341957092285
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.3780515193939209
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.3653273582458496
Epoch: 7, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.34339427947998047
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.3491687774658203
Epoch: 9, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.345869779586792
Epoch: 10, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.3333718776702881
Epoch: 11, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.32823610305786133
Epoch: 12, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.3925948143005371
Epoch: 13, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.3138408660888672
Epoch: 14, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.4141244888305664
Epoch: 15, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.34090113639831543
Epoch: 16, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.33712220191955566
Epoch: 17, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.39235973358154297
Epoch: 18, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.38559460639953613
Epoch: 19, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.4387626647949219
Epoch: 20, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.3974149227142334
Epoch: 21, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.37399911880493164
Epoch: 22, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.4170873165130615
Epoch: 23, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.35513925552368164
Epoch: 24, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.3936641216278076
Epoch: 25, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.381746768951416
Epoch: 26, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.41132211685180664
Epoch: 27, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 0.385711669921875
Epoch: 28, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.4237802028656006
Epoch: 29, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.003 Vali Acc: 0.600 Test Loss: 1.003 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 0.3612957000732422
Epoch: 30, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 0.3691978454589844
Epoch: 31, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.4198620319366455
Epoch: 32, Steps: 1 | Train Loss: 0.627 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.3813295364379883
Epoch: 33, Steps: 1 | Train Loss: 0.614 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.38875532150268555
Epoch: 34, Steps: 1 | Train Loss: 0.611 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.41783785820007324
Epoch: 35, Steps: 1 | Train Loss: 0.558 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.3813357353210449
Epoch: 36, Steps: 1 | Train Loss: 0.584 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3314526081085205
Epoch: 37, Steps: 1 | Train Loss: 0.552 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.40392136573791504
Epoch: 38, Steps: 1 | Train Loss: 0.525 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.3881409168243408
Epoch: 39, Steps: 1 | Train Loss: 0.519 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.3886568546295166
Epoch: 40, Steps: 1 | Train Loss: 0.506 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.36806273460388184
Epoch: 41, Steps: 1 | Train Loss: 0.506 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.4395747184753418
Epoch: 42, Steps: 1 | Train Loss: 0.499 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 78371
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5557363033294678
Epoch: 1, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.41149163246154785
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.380939245223999
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.36646366119384766
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.34822869300842285
Epoch: 5, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3631265163421631
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3411595821380615
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.34859132766723633
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.3504154682159424
Epoch: 9, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.34366655349731445
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.35353946685791016
Epoch: 11, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.43710827827453613
Epoch: 12, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 81603
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3973264694213867
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3368868827819824
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.36925292015075684
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3531513214111328
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.40024590492248535
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.37160468101501465
Epoch: 6, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.36473512649536133
Epoch: 7, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.3587672710418701
Epoch: 8, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.38222384452819824
Epoch: 9, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.3580756187438965
Epoch: 10, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3600754737854004
Epoch: 11, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.39244961738586426
Epoch: 12, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3400890827178955
Epoch: 13, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.39735865592956543
Epoch: 14, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.3658928871154785
Epoch: 15, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.34230709075927734
Epoch: 16, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.36129045486450195
Epoch: 17, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.023 Vali Acc: 0.333 Test Loss: 1.023 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.39794254302978516
Epoch: 18, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.029 Vali Acc: 0.333 Test Loss: 1.029 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4356822967529297
Epoch: 19, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 896515
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7329561710357666
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3518404960632324
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41497254371643066
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3341073989868164
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.135 Vali Acc: 0.133 Test Loss: 1.135 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42493271827697754
Epoch: 5, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.3880748748779297
Epoch: 6, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.37136387825012207
Epoch: 7, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.40507936477661133
Epoch: 8, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.395219087600708
Epoch: 9, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3791670799255371
Epoch: 10, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.3961775302886963
Epoch: 11, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3696722984313965
Epoch: 12, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.41324567794799805
Epoch: 13, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.405259370803833
Epoch: 14, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.39598774909973145
Epoch: 15, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.361436128616333
Epoch: 16, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.3795027732849121
Epoch: 17, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.37180590629577637
Epoch: 18, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3614075183868408
Epoch: 19, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.37274789810180664
Epoch: 20, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.43476033210754395
Epoch: 21, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 846083
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4782648086547852
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.341705322265625
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.407686710357666
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3617589473724365
Epoch: 4, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.32242321968078613
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.4316089153289795
Epoch: 6, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4157700538635254
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.35534095764160156
Epoch: 8, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3107895851135254
Epoch: 9, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4061429500579834
Epoch: 10, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3594801425933838
Epoch: 11, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.47200942039489746
Epoch: 12, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.33311915397644043
Epoch: 13, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.3855009078979492
Epoch: 14, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.4119279384613037
Epoch: 15, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.384113073348999
Epoch: 16, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.342315673828125
Epoch: 17, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.39301252365112305
Epoch: 18, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.38904762268066406
Epoch: 19, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.45131540298461914
Epoch: 20, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.37076377868652344
Epoch: 21, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.3202798366546631
Epoch: 22, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.346691370010376
Epoch: 23, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.3231632709503174
Epoch: 24, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.3670196533203125
Epoch: 25, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.3795945644378662
Epoch: 26, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 832643
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5493497848510742
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3427300453186035
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3958141803741455
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3854243755340576
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4392979145050049
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3883664608001709
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.37108588218688965
Epoch: 7, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3711421489715576
Epoch: 8, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.40827488899230957
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.39618492126464844
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.41741466522216797
Epoch: 11, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 831363
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7991306781768799
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.40583181381225586
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.401885986328125
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.37584686279296875
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.393801212310791
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.40952205657958984
Epoch: 6, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.38900113105773926
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.49314379692077637
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.3822968006134033
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3269026279449463
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3885915279388428
Epoch: 11, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4394075870513916
Epoch: 12, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4487142562866211
Epoch: 13, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4000661373138428
Epoch: 14, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3620128631591797
Epoch: 15, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3650546073913574
Epoch: 16, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.41724586486816406
Epoch: 17, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.34298157691955566
Epoch: 18, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.4017329216003418
Epoch: 19, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.44745826721191406
Epoch: 20, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.3822951316833496
Epoch: 21, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.41307544708251953
Epoch: 22, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.4980032444000244
Epoch: 23, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.4209780693054199
Epoch: 24, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.3945803642272949
Epoch: 25, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.391491174697876
Epoch: 26, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.4667651653289795
Epoch: 27, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.43102598190307617
Epoch: 28, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4250154495239258
Epoch: 29, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.42966270446777344
Epoch: 30, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.3584892749786377
Epoch: 31, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.3991818428039551
Epoch: 32, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.31420135498046875
Epoch: 33, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.3516097068786621
Epoch: 34, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.35747790336608887
Epoch: 35, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4776911735534668
Epoch: 36, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 838147
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7061049938201904
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.36443209648132324
Epoch: 2, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.45749402046203613
Epoch: 3, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.41120171546936035
Epoch: 4, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.36905670166015625
Epoch: 5, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3799755573272705
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.537790060043335
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3686249256134033
Epoch: 8, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.4460177421569824
Epoch: 9, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.48670148849487305
Epoch: 10, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4219496250152588
Epoch: 11, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.39411401748657227
Epoch: 12, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4584932327270508
Epoch: 13, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.40772271156311035
Epoch: 14, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.413250207901001
Epoch: 15, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.38245439529418945
Epoch: 16, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3537778854370117
Epoch: 17, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4865281581878662
Epoch: 18, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.43132519721984863
Epoch: 19, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.401857852935791
Epoch: 20, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.4739711284637451
Epoch: 21, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.4110281467437744
Epoch: 22, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.364987850189209
Epoch: 23, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.4538717269897461
Epoch: 24, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.3647613525390625
Epoch: 25, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.33782291412353516
Epoch: 26, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5167067050933838
Epoch: 27, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4640631675720215
Epoch: 28, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.36348509788513184
Epoch: 29, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.36385297775268555
Epoch: 30, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.41615819931030273
Epoch: 31, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.3413245677947998
Epoch: 32, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4551427364349365
Epoch: 33, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.41625070571899414
Epoch: 34, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 848003
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.495798110961914
Epoch: 1, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4070587158203125
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.36160778999328613
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4041776657104492
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4075627326965332
Epoch: 5, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.41214466094970703
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3931851387023926
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4059336185455322
Epoch: 8, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3761115074157715
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4151933193206787
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.40200209617614746
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.3848228454589844
Epoch: 12, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3713381290435791
Epoch: 13, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.390087366104126
Epoch: 14, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.3860619068145752
Epoch: 15, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.453932523727417
Epoch: 16, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4132826328277588
Epoch: 17, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.4155256748199463
Epoch: 18, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.40535664558410645
Epoch: 19, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.3922750949859619
Epoch: 20, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.32759737968444824
Epoch: 21, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.39865970611572266
Epoch: 22, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.4172060489654541
Epoch: 23, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.36733245849609375
Epoch: 24, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.3718910217285156
Epoch: 25, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.3755989074707031
Epoch: 26, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3974783420562744
Epoch: 27, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.33057117462158203
Epoch: 28, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.343250036239624
Epoch: 29, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.41312313079833984
Epoch: 30, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.3538525104522705
Epoch: 31, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.3797469139099121
Epoch: 32, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.3822503089904785
Epoch: 33, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 860931
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4927423000335693
Epoch: 1, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.38629674911499023
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.37561893463134766
Epoch: 3, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.33853816986083984
Epoch: 4, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4083859920501709
Epoch: 5, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.37636590003967285
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3573482036590576
Epoch: 7, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.29694342613220215
Epoch: 8, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.34080982208251953
Epoch: 9, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.37771177291870117
Epoch: 10, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.3936746120452881
Epoch: 11, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.45540285110473633
Epoch: 12, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4123656749725342
Epoch: 13, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.3293032646179199
Epoch: 14, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3218729496002197
Epoch: 15, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4339463710784912
Epoch: 16, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.34258127212524414
Epoch: 17, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.3470427989959717
Epoch: 18, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.36118030548095703
Epoch: 19, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.3454430103302002
Epoch: 20, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 268035
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6286258697509766
Epoch: 1, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.43322229385375977
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3581576347351074
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3881704807281494
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.3809630870819092
Epoch: 5, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.371934175491333
Epoch: 6, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.385617733001709
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.34424543380737305
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.32815098762512207
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3493154048919678
Epoch: 10, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3350405693054199
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.3938157558441162
Epoch: 12, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.36657047271728516
Epoch: 13, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.30224084854125977
Epoch: 14, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.31557440757751465
Epoch: 15, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.34305477142333984
Epoch: 16, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3940303325653076
Epoch: 17, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3343803882598877
Epoch: 18, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.42760324478149414
Epoch: 19, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3511531352996826
Epoch: 20, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.3533143997192383
Epoch: 21, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.3779280185699463
Epoch: 22, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.5157465934753418
Epoch: 23, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.47199082374572754
Epoch: 24, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4400138854980469
Epoch: 25, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.44602108001708984
Epoch: 26, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.34601783752441406
Epoch: 27, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.3418915271759033
Epoch: 28, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.37703442573547363
Epoch: 29, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.33533763885498047
Epoch: 30, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.41416430473327637
Epoch: 31, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4180762767791748
Epoch: 32, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.37474608421325684
Epoch: 33, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 242819
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6357617378234863
Epoch: 1, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3782799243927002
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3604617118835449
Epoch: 3, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3531818389892578
Epoch: 4, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4312403202056885
Epoch: 5, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40421605110168457
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.40480780601501465
Epoch: 7, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.33006978034973145
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.34408020973205566
Epoch: 9, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.36638498306274414
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.42987823486328125
Epoch: 11, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 236099
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5403923988342285
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.43418288230895996
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.44832682609558105
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3928380012512207
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.35675549507141113
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3484938144683838
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.3777487277984619
Epoch: 7, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.41851115226745605
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3578369617462158
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.5059528350830078
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5246074199676514
Epoch: 11, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.35309362411499023
Epoch: 12, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.40453433990478516
Epoch: 13, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.37557005882263184
Epoch: 14, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.36821866035461426
Epoch: 15, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4173593521118164
Epoch: 16, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.35733795166015625
Epoch: 17, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5586128234863281
Epoch: 18, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.48404431343078613
Epoch: 19, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.44364190101623535
Epoch: 20, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.3385350704193115
Epoch: 21, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4249258041381836
Epoch: 22, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 235459
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6125702857971191
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4384610652923584
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.3776969909667969
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.4063117504119873
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.3467557430267334
Epoch: 5, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3573281764984131
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.35474181175231934
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.3133862018585205
Epoch: 8, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4311234951019287
Epoch: 9, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.37662744522094727
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.38613152503967285
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.371776819229126
Epoch: 12, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3990137577056885
Epoch: 13, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4360191822052002
Epoch: 14, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4031505584716797
Epoch: 15, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.44766950607299805
Epoch: 16, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4003126621246338
Epoch: 17, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.083 Vali Acc: 0.200 Test Loss: 1.083 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.3771209716796875
Epoch: 18, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.081 Vali Acc: 0.200 Test Loss: 1.081 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3722991943359375
Epoch: 19, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.079 Vali Acc: 0.200 Test Loss: 1.079 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.3457200527191162
Epoch: 20, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.077 Vali Acc: 0.200 Test Loss: 1.077 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.395780086517334
Epoch: 21, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.076 Vali Acc: 0.200 Test Loss: 1.076 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 238851
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6739816665649414
Epoch: 1, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.3700854778289795
Epoch: 2, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4020206928253174
Epoch: 3, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38550353050231934
Epoch: 4, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3945305347442627
Epoch: 5, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.183 Vali Acc: 0.133 Test Loss: 1.183 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3509678840637207
Epoch: 6, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.35494565963745117
Epoch: 7, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.188 Vali Acc: 0.133 Test Loss: 1.188 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.39598822593688965
Epoch: 8, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.32478880882263184
Epoch: 9, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.193 Vali Acc: 0.133 Test Loss: 1.193 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.36559605598449707
Epoch: 10, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 11 cost time: 0.37608981132507324
Epoch: 11, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40055036544799805
Epoch: 12, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4413468837738037
Epoch: 13, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.35834407806396484
Epoch: 14, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.36206674575805664
Epoch: 15, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.34610962867736816
Epoch: 16, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.3343546390533447
Epoch: 17, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.34958314895629883
Epoch: 18, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.4217650890350342
Epoch: 19, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4893484115600586
Epoch: 20, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.40978121757507324
Epoch: 21, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.49175119400024414
Epoch: 22, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.3746919631958008
Epoch: 23, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4055967330932617
Epoch: 24, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.43917417526245117
Epoch: 25, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.41135144233703613
Epoch: 26, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4663574695587158
Epoch: 27, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.387831449508667
Epoch: 28, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 243779
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.71494722366333
Epoch: 1, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.40589189529418945
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.40982675552368164
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3826863765716553
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4399600028991699
Epoch: 5, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.33968591690063477
Epoch: 6, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.39749884605407715
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.38555240631103516
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3321361541748047
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3319716453552246
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.39461398124694824
Epoch: 11, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.40138721466064453
Epoch: 12, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3870847225189209
Epoch: 13, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.4079453945159912
Epoch: 14, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.39374613761901855
Epoch: 15, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.34830784797668457
Epoch: 16, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.44310760498046875
Epoch: 17, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.37390661239624023
Epoch: 18, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5417373180389404
Epoch: 19, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.36481714248657227
Epoch: 20, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.3592391014099121
Epoch: 21, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3295605182647705
Epoch: 22, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.35657382011413574
Epoch: 23, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.43237876892089844
Epoch: 24, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.35075902938842773
Epoch: 25, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.43700361251831055
Epoch: 26, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.4328622817993164
Epoch: 27, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 0.34952402114868164
Epoch: 28, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3442192077636719
Epoch: 29, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.36423254013061523
Epoch: 30, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4644150733947754
Epoch: 31, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4062638282775879
Epoch: 32, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4531996250152588
Epoch: 33, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.38303494453430176
Epoch: 34, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.3488309383392334
Epoch: 35, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.3744640350341797
Epoch: 36, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4400362968444824
Epoch: 37, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 250243
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.477665662765503
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3431220054626465
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3296802043914795
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38078832626342773
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.38865041732788086
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3945009708404541
Epoch: 6, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.3883512020111084
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.3342478275299072
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.3659074306488037
Epoch: 9, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.5047388076782227
Epoch: 10, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.39589953422546387
Epoch: 11, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4330003261566162
Epoch: 12, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.40245532989501953
Epoch: 13, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.344024658203125
Epoch: 14, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.32804322242736816
Epoch: 15, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3954157829284668
Epoch: 16, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.36412572860717773
Epoch: 17, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4243488311767578
Epoch: 18, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.4044959545135498
Epoch: 19, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.458345890045166
Epoch: 20, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.35144829750061035
Epoch: 21, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4067702293395996
Epoch: 22, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.37067389488220215
Epoch: 23, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4113175868988037
Epoch: 24, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3527991771697998
Epoch: 25, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3791842460632324
Epoch: 26, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3865346908569336
Epoch: 27, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4359586238861084
Epoch: 28, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.38678812980651855
Epoch: 29, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.44137096405029297
Epoch: 30, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.042 Vali Acc: 0.267 Test Loss: 1.042 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 88963
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5039749145507812
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.33693742752075195
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.35047483444213867
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.3939790725708008
Epoch: 4, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.3667886257171631
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.37215495109558105
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.39788389205932617
Epoch: 7, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.3706798553466797
Epoch: 8, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3578968048095703
Epoch: 9, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.48610615730285645
Epoch: 10, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.35245180130004883
Epoch: 11, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.3806018829345703
Epoch: 12, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.44213271141052246
Epoch: 13, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.3169972896575928
Epoch: 14, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.3835577964782715
Epoch: 15, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.4447777271270752
Epoch: 16, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.34946441650390625
Epoch: 17, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.3388791084289551
Epoch: 18, Steps: 1 | Train Loss: 0.794 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.4844510555267334
Epoch: 19, Steps: 1 | Train Loss: 0.783 Vali Loss: 0.997 Vali Acc: 0.667 Test Loss: 0.997 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 20 cost time: 0.3440680503845215
Epoch: 20, Steps: 1 | Train Loss: 0.743 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 0.3897230625152588
Epoch: 21, Steps: 1 | Train Loss: 0.693 Vali Loss: 0.991 Vali Acc: 0.733 Test Loss: 0.991 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733323).  Saving model ...
Epoch: 22 cost time: 0.3537416458129883
Epoch: 22, Steps: 1 | Train Loss: 0.667 Vali Loss: 0.989 Vali Acc: 0.733 Test Loss: 0.989 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 23 cost time: 0.39722728729248047
Epoch: 23, Steps: 1 | Train Loss: 0.647 Vali Loss: 0.986 Vali Acc: 0.733 Test Loss: 0.986 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 24 cost time: 0.31582069396972656
Epoch: 24, Steps: 1 | Train Loss: 0.617 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.3592805862426758
Epoch: 25, Steps: 1 | Train Loss: 0.572 Vali Loss: 0.981 Vali Acc: 0.600 Test Loss: 0.981 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4607691764831543
Epoch: 26, Steps: 1 | Train Loss: 0.571 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6114933490753174
Epoch: 27, Steps: 1 | Train Loss: 0.580 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4626498222351074
Epoch: 28, Steps: 1 | Train Loss: 0.512 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4004383087158203
Epoch: 29, Steps: 1 | Train Loss: 0.500 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4326052665710449
Epoch: 30, Steps: 1 | Train Loss: 0.452 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4209010601043701
Epoch: 31, Steps: 1 | Train Loss: 0.477 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4593617916107178
Epoch: 32, Steps: 1 | Train Loss: 0.448 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.48015809059143066
Epoch: 33, Steps: 1 | Train Loss: 0.419 Vali Loss: 0.968 Vali Acc: 0.600 Test Loss: 0.968 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 76355
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5033190250396729
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.37256789207458496
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.41106700897216797
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.44408583641052246
Epoch: 4, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.5413820743560791
Epoch: 5, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.026 Vali Acc: 0.667 Test Loss: 1.026 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 0.3368213176727295
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.025 Vali Acc: 0.667 Test Loss: 1.025 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.39250779151916504
Epoch: 7, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.023 Vali Acc: 0.667 Test Loss: 1.023 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 0.47640514373779297
Epoch: 8, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.021 Vali Acc: 0.733 Test Loss: 1.021 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 0.4033939838409424
Epoch: 9, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.019 Vali Acc: 0.733 Test Loss: 1.019 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.35108399391174316
Epoch: 10, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 0.4296741485595703
Epoch: 11, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.016 Vali Acc: 0.733 Test Loss: 1.016 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 0.4211413860321045
Epoch: 12, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.014 Vali Acc: 0.733 Test Loss: 1.014 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 0.3503696918487549
Epoch: 13, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.013 Vali Acc: 0.733 Test Loss: 1.013 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 0.35712313652038574
Epoch: 14, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.011 Vali Acc: 0.733 Test Loss: 1.011 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 0.37676453590393066
Epoch: 15, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.010 Vali Acc: 0.733 Test Loss: 1.010 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 16 cost time: 0.33547067642211914
Epoch: 16, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.008 Vali Acc: 0.667 Test Loss: 1.008 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.45911216735839844
Epoch: 17, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.007 Vali Acc: 0.667 Test Loss: 1.007 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3780496120452881
Epoch: 18, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.006 Vali Acc: 0.667 Test Loss: 1.006 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4864177703857422
Epoch: 19, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.3405797481536865
Epoch: 20, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.003 Vali Acc: 0.667 Test Loss: 1.003 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.43689537048339844
Epoch: 21, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.002 Vali Acc: 0.667 Test Loss: 1.002 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.44204068183898926
Epoch: 22, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.001 Vali Acc: 0.667 Test Loss: 1.001 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4344630241394043
Epoch: 23, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.3499624729156494
Epoch: 24, Steps: 1 | Train Loss: 0.621 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 25 cost time: 0.4154083728790283
Epoch: 25, Steps: 1 | Train Loss: 0.627 Vali Loss: 0.998 Vali Acc: 0.733 Test Loss: 0.998 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 26 cost time: 0.44126391410827637
Epoch: 26, Steps: 1 | Train Loss: 0.615 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 27 cost time: 0.405536413192749
Epoch: 27, Steps: 1 | Train Loss: 0.580 Vali Loss: 0.996 Vali Acc: 0.733 Test Loss: 0.996 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 28 cost time: 0.38782310485839844
Epoch: 28, Steps: 1 | Train Loss: 0.572 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 29 cost time: 0.3977062702178955
Epoch: 29, Steps: 1 | Train Loss: 0.554 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 30 cost time: 0.3753390312194824
Epoch: 30, Steps: 1 | Train Loss: 0.531 Vali Loss: 0.994 Vali Acc: 0.733 Test Loss: 0.994 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 31 cost time: 0.36339735984802246
Epoch: 31, Steps: 1 | Train Loss: 0.516 Vali Loss: 0.993 Vali Acc: 0.733 Test Loss: 0.993 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 32 cost time: 0.3927795886993408
Epoch: 32, Steps: 1 | Train Loss: 0.502 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 33 cost time: 0.33588075637817383
Epoch: 33, Steps: 1 | Train Loss: 0.475 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 34 cost time: 0.4023745059967041
Epoch: 34, Steps: 1 | Train Loss: 0.460 Vali Loss: 0.991 Vali Acc: 0.733 Test Loss: 0.991 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 35 cost time: 0.33554959297180176
Epoch: 35, Steps: 1 | Train Loss: 0.456 Vali Loss: 0.991 Vali Acc: 0.667 Test Loss: 0.991 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.3731045722961426
Epoch: 36, Steps: 1 | Train Loss: 0.440 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.3956451416015625
Epoch: 37, Steps: 1 | Train Loss: 0.420 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4323127269744873
Epoch: 38, Steps: 1 | Train Loss: 0.405 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.39766788482666016
Epoch: 39, Steps: 1 | Train Loss: 0.405 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.39754176139831543
Epoch: 40, Steps: 1 | Train Loss: 0.375 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.3777761459350586
Epoch: 41, Steps: 1 | Train Loss: 0.364 Vali Loss: 0.991 Vali Acc: 0.667 Test Loss: 0.991 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4067366123199463
Epoch: 42, Steps: 1 | Train Loss: 0.352 Vali Loss: 0.992 Vali Acc: 0.667 Test Loss: 0.992 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.45332956314086914
Epoch: 43, Steps: 1 | Train Loss: 0.346 Vali Loss: 0.993 Vali Acc: 0.667 Test Loss: 0.993 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.37511730194091797
Epoch: 44, Steps: 1 | Train Loss: 0.324 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 72995
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5916051864624023
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.42948341369628906
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4077425003051758
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3754849433898926
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.41907835006713867
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.43630242347717285
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.401202917098999
Epoch: 7, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.43947291374206543
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4362168312072754
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.35152339935302734
Epoch: 10, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.37227392196655273
Epoch: 11, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.36127138137817383
Epoch: 12, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.38635993003845215
Epoch: 13, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3475914001464844
Epoch: 14, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3929014205932617
Epoch: 15, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3573112487792969
Epoch: 16, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.3835935592651367
Epoch: 17, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.4238102436065674
Epoch: 18, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.36061644554138184
Epoch: 19, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.3819241523742676
Epoch: 20, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.38164854049682617
Epoch: 21, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3919203281402588
Epoch: 22, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.38484954833984375
Epoch: 23, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.504040002822876
Epoch: 24, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.3341526985168457
Epoch: 25, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 26 cost time: 0.4086167812347412
Epoch: 26, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 27 cost time: 0.46514129638671875
Epoch: 27, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 0.38680529594421387
Epoch: 28, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 29 cost time: 0.37262892723083496
Epoch: 29, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 30 cost time: 0.3343017101287842
Epoch: 30, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 31 cost time: 0.4105687141418457
Epoch: 31, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 32 cost time: 0.36560654640197754
Epoch: 32, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 33 cost time: 0.36164236068725586
Epoch: 33, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 34 cost time: 0.36910080909729004
Epoch: 34, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 35 cost time: 0.43564414978027344
Epoch: 35, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.3650343418121338
Epoch: 36, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 0.382232666015625
Epoch: 37, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.38614988327026367
Epoch: 38, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 0.3932485580444336
Epoch: 39, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 0.46277642250061035
Epoch: 40, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 41 cost time: 0.3858160972595215
Epoch: 41, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 42 cost time: 0.3806111812591553
Epoch: 42, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 0.44603705406188965
Epoch: 43, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 44 cost time: 0.536787748336792
Epoch: 44, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 45 cost time: 0.4035053253173828
Epoch: 45, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4336996078491211
Epoch: 46, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.41997623443603516
Epoch: 47, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.3965034484863281
Epoch: 48, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.37979626655578613
Epoch: 49, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4132957458496094
Epoch: 50, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 72675
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.573875904083252
Epoch: 1, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4205336570739746
Epoch: 2, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.44947075843811035
Epoch: 3, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.45151829719543457
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.36681437492370605
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.39058470726013184
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3820352554321289
Epoch: 7, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3571791648864746
Epoch: 8, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4623532295227051
Epoch: 9, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3414003849029541
Epoch: 10, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.36643528938293457
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.33867335319519043
Epoch: 12, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.41617417335510254
Epoch: 13, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3941805362701416
Epoch: 14, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4819767475128174
Epoch: 15, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.39074158668518066
Epoch: 16, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4026305675506592
Epoch: 17, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.40877461433410645
Epoch: 18, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4137229919433594
Epoch: 19, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4332728385925293
Epoch: 20, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.42819929122924805
Epoch: 21, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 74371
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4727451801300049
Epoch: 1, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.32400965690612793
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.40485048294067383
Epoch: 3, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.4093177318572998
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.4165947437286377
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.3537929058074951
Epoch: 6, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.3547677993774414
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.4230372905731201
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.40660691261291504
Epoch: 9, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.3496417999267578
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 11 cost time: 0.3485443592071533
Epoch: 11, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 12 cost time: 0.373185396194458
Epoch: 12, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 13 cost time: 0.3464198112487793
Epoch: 13, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 14 cost time: 0.3497943878173828
Epoch: 14, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 15 cost time: 0.372295618057251
Epoch: 15, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 16 cost time: 0.33215808868408203
Epoch: 16, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.3755819797515869
Epoch: 17, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 18 cost time: 0.322312593460083
Epoch: 18, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 19 cost time: 0.35990357398986816
Epoch: 19, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 20 cost time: 0.3605458736419678
Epoch: 20, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 21 cost time: 0.42131733894348145
Epoch: 21, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 22 cost time: 0.3509056568145752
Epoch: 22, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 23 cost time: 0.390472412109375
Epoch: 23, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 24 cost time: 0.38245201110839844
Epoch: 24, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 25 cost time: 0.364713191986084
Epoch: 25, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 26 cost time: 0.3897998332977295
Epoch: 26, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 27 cost time: 0.397702693939209
Epoch: 27, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 28 cost time: 0.39135289192199707
Epoch: 28, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 29 cost time: 0.3657543659210205
Epoch: 29, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 30 cost time: 0.39745068550109863
Epoch: 30, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 31 cost time: 0.3740828037261963
Epoch: 31, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 32 cost time: 0.5181770324707031
Epoch: 32, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 33 cost time: 0.3166327476501465
Epoch: 33, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 34 cost time: 0.36794257164001465
Epoch: 34, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 35 cost time: 0.3351311683654785
Epoch: 35, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 36 cost time: 0.480755090713501
Epoch: 36, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 37 cost time: 0.3883688449859619
Epoch: 37, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 38 cost time: 0.383929967880249
Epoch: 38, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 39 cost time: 0.382249116897583
Epoch: 39, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 40 cost time: 0.34067440032958984
Epoch: 40, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 41 cost time: 0.34328389167785645
Epoch: 41, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 42 cost time: 0.38342833518981934
Epoch: 42, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.030 Vali Acc: 0.333 Test Loss: 1.030 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 43 cost time: 0.38710761070251465
Epoch: 43, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.028 Vali Acc: 0.333 Test Loss: 1.028 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 44 cost time: 0.33716344833374023
Epoch: 44, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.026 Vali Acc: 0.333 Test Loss: 1.026 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 45 cost time: 0.3503282070159912
Epoch: 45, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 46 cost time: 0.37392282485961914
Epoch: 46, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 47 cost time: 0.4127035140991211
Epoch: 47, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 48 cost time: 0.3812732696533203
Epoch: 48, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 49 cost time: 0.34078550338745117
Epoch: 49, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 50 cost time: 0.3613436222076416
Epoch: 50, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 76835
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5190343856811523
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.3443021774291992
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.3389747142791748
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.3491659164428711
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.4181385040283203
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.3314323425292969
Epoch: 6, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.32589006423950195
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.4564528465270996
Epoch: 8, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.37975215911865234
Epoch: 9, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.39643311500549316
Epoch: 10, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.43113207817077637
Epoch: 11, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.3621389865875244
Epoch: 12, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.3489377498626709
Epoch: 13, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.37002038955688477
Epoch: 14, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.39312267303466797
Epoch: 15, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.3687429428100586
Epoch: 16, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.34845948219299316
Epoch: 17, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.3471980094909668
Epoch: 18, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.3626718521118164
Epoch: 19, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.3580036163330078
Epoch: 20, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.3344099521636963
Epoch: 21, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.3750772476196289
Epoch: 22, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.3252542018890381
Epoch: 23, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.3375885486602783
Epoch: 24, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.3121323585510254
Epoch: 25, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.4477565288543701
Epoch: 26, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.40752744674682617
Epoch: 27, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.3149838447570801
Epoch: 28, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.3992164134979248
Epoch: 29, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.4322202205657959
Epoch: 30, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.35306620597839355
Epoch: 31, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4244346618652344
Epoch: 32, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.41143274307250977
Epoch: 33, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.3893730640411377
Epoch: 34, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 0.3899540901184082
Epoch: 35, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.34164905548095703
Epoch: 36, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 0.3418593406677246
Epoch: 37, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.40938377380371094
Epoch: 38, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3278920650482178
Epoch: 39, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.34795141220092773
Epoch: 40, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.358964204788208
Epoch: 41, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.39171648025512695
Epoch: 42, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.36210036277770996
Epoch: 43, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.35659217834472656
Epoch: 44, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.30582761764526367
Epoch: 45, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.3540616035461426
Epoch: 46, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.3092041015625
Epoch: 47, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 80067
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6309483051300049
Epoch: 1, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.38766980171203613
Epoch: 2, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.38903379440307617
Epoch: 3, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3893263339996338
Epoch: 4, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.39947056770324707
Epoch: 5, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.386584997177124
Epoch: 6, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.35494041442871094
Epoch: 7, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3893928527832031
Epoch: 8, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.35721278190612793
Epoch: 9, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4019896984100342
Epoch: 10, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.44170403480529785
Epoch: 11, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.46588921546936035
Epoch: 12, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.35530996322631836
Epoch: 13, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5417814254760742
Epoch: 14, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5059957504272461
Epoch: 15, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.3973197937011719
Epoch: 16, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.362 Vali Acc: 0.333 Test Loss: 1.362 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 816131
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.671151876449585
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.35343432426452637
Epoch: 2, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5158121585845947
Epoch: 3, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.37140369415283203
Epoch: 4, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3994181156158447
Epoch: 5, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.33353638648986816
Epoch: 6, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.358198881149292
Epoch: 7, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.35746312141418457
Epoch: 8, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3482952117919922
Epoch: 9, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4234941005706787
Epoch: 10, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3189089298248291
Epoch: 11, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.41924357414245605
Epoch: 12, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.33033204078674316
Epoch: 13, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.2985231876373291
Epoch: 14, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.37535667419433594
Epoch: 15, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4799351692199707
Epoch: 16, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.33687806129455566
Epoch: 17, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 712195
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5955758094787598
Epoch: 1, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4007382392883301
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.3725581169128418
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.356372594833374
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.38304829597473145
Epoch: 5, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.3860435485839844
Epoch: 6, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.39290952682495117
Epoch: 7, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3576467037200928
Epoch: 8, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.42619895935058594
Epoch: 9, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.38749003410339355
Epoch: 10, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3515188694000244
Epoch: 11, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3881673812866211
Epoch: 12, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3769228458404541
Epoch: 13, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.3952960968017578
Epoch: 14, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.48247575759887695
Epoch: 15, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3839290142059326
Epoch: 16, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4248228073120117
Epoch: 17, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.40109753608703613
Epoch: 18, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.42587995529174805
Epoch: 19, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.47350502014160156
Epoch: 20, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.34564924240112305
Epoch: 21, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3912515640258789
Epoch: 22, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.41634273529052734
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.36722636222839355
Epoch: 24, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.35280537605285645
Epoch: 25, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 688387
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6398224830627441
Epoch: 1, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.441758394241333
Epoch: 2, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.319136381149292
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.32201433181762695
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.3263094425201416
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3584160804748535
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3330972194671631
Epoch: 7, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.33951878547668457
Epoch: 8, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 9 cost time: 0.386671781539917
Epoch: 9, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 10 cost time: 0.32851147651672363
Epoch: 10, Steps: 1 | Train Loss: 0.557 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 11 cost time: 0.3388838768005371
Epoch: 11, Steps: 1 | Train Loss: 0.448 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 12 cost time: 0.3154423236846924
Epoch: 12, Steps: 1 | Train Loss: 0.419 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.34329795837402344
Epoch: 13, Steps: 1 | Train Loss: 0.350 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.37645673751831055
Epoch: 14, Steps: 1 | Train Loss: 0.300 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3653678894042969
Epoch: 15, Steps: 1 | Train Loss: 0.250 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3395876884460449
Epoch: 16, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.43774962425231934
Epoch: 17, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3315908908843994
Epoch: 18, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3338661193847656
Epoch: 19, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.3775765895843506
Epoch: 20, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.34844970703125
Epoch: 21, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.3386549949645996
Epoch: 22, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4297173023223877
Epoch: 23, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 685827
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5422868728637695
Epoch: 1, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.3378429412841797
Epoch: 2, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.38830065727233887
Epoch: 3, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.34475278854370117
Epoch: 4, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.33391427993774414
Epoch: 5, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3760678768157959
Epoch: 6, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.38157081604003906
Epoch: 7, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.3356351852416992
Epoch: 8, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.3291952610015869
Epoch: 9, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.431903600692749
Epoch: 10, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3983316421508789
Epoch: 11, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.356170654296875
Epoch: 12, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.374495267868042
Epoch: 13, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.35832691192626953
Epoch: 14, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.3982727527618408
Epoch: 15, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.37062954902648926
Epoch: 16, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.35070300102233887
Epoch: 17, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.3549668788909912
Epoch: 18, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 696323
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5647432804107666
Epoch: 1, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.35985398292541504
Epoch: 2, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3483555316925049
Epoch: 3, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4454045295715332
Epoch: 4, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3689565658569336
Epoch: 5, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.3618142604827881
Epoch: 6, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.3553311824798584
Epoch: 7, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.339402437210083
Epoch: 8, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.40462589263916016
Epoch: 9, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.403583288192749
Epoch: 10, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.3675570487976074
Epoch: 11, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.3400893211364746
Epoch: 12, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.3256261348724365
Epoch: 13, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.3752422332763672
Epoch: 14, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.3694789409637451
Epoch: 15, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.40355968475341797
Epoch: 16, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 719107
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.399366855621338
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3592844009399414
Epoch: 2, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3961186408996582
Epoch: 3, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3415515422821045
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3820013999938965
Epoch: 5, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.41652846336364746
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3914611339569092
Epoch: 7, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3632972240447998
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.3306255340576172
Epoch: 9, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.3221471309661865
Epoch: 10, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.42676281929016113
Epoch: 11, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3252713680267334
Epoch: 12, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.44184350967407227
Epoch: 13, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.45055556297302246
Epoch: 14, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.37119340896606445
Epoch: 15, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.4377593994140625
Epoch: 16, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.39297962188720703
Epoch: 17, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3938584327697754
Epoch: 18, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4437117576599121
Epoch: 19, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3973233699798584
Epoch: 20, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.3267974853515625
Epoch: 21, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.3619058132171631
Epoch: 22, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.3435549736022949
Epoch: 23, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.36179423332214355
Epoch: 24, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.42047834396362305
Epoch: 25, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.36398911476135254
Epoch: 26, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 741891
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7183172702789307
Epoch: 1, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.40241146087646484
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.3559305667877197
Epoch: 3, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.34477829933166504
Epoch: 4, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.39874911308288574
Epoch: 5, Steps: 1 | Train Loss: 0.819 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.36766481399536133
Epoch: 6, Steps: 1 | Train Loss: 0.686 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4295353889465332
Epoch: 7, Steps: 1 | Train Loss: 0.627 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.33138585090637207
Epoch: 8, Steps: 1 | Train Loss: 0.516 Vali Loss: 0.970 Vali Acc: 0.467 Test Loss: 0.970 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.3749504089355469
Epoch: 9, Steps: 1 | Train Loss: 0.411 Vali Loss: 0.962 Vali Acc: 0.467 Test Loss: 0.962 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.32573747634887695
Epoch: 10, Steps: 1 | Train Loss: 0.333 Vali Loss: 0.957 Vali Acc: 0.467 Test Loss: 0.957 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3663036823272705
Epoch: 11, Steps: 1 | Train Loss: 0.281 Vali Loss: 0.954 Vali Acc: 0.600 Test Loss: 0.954 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.37320852279663086
Epoch: 12, Steps: 1 | Train Loss: 0.219 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.356830358505249
Epoch: 13, Steps: 1 | Train Loss: 0.156 Vali Loss: 0.960 Vali Acc: 0.467 Test Loss: 0.960 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.327392578125
Epoch: 14, Steps: 1 | Train Loss: 0.115 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.348752498626709
Epoch: 15, Steps: 1 | Train Loss: 0.080 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4207117557525635
Epoch: 16, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4607384204864502
Epoch: 17, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.3789849281311035
Epoch: 18, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.36437296867370605
Epoch: 19, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.33605384826660156
Epoch: 20, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.44583892822265625
Epoch: 21, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 276995
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4687373638153076
Epoch: 1, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.37013936042785645
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3443164825439453
Epoch: 3, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3697211742401123
Epoch: 4, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4825136661529541
Epoch: 5, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.41251707077026367
Epoch: 6, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.41204190254211426
Epoch: 7, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3517777919769287
Epoch: 8, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4148595333099365
Epoch: 9, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.378969669342041
Epoch: 10, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4454822540283203
Epoch: 11, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.41178369522094727
Epoch: 12, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3431205749511719
Epoch: 13, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.3299589157104492
Epoch: 14, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.433880090713501
Epoch: 15, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.3411886692047119
Epoch: 16, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.43682241439819336
Epoch: 17, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4110860824584961
Epoch: 18, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.32447171211242676
Epoch: 19, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3481884002685547
Epoch: 20, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.39188361167907715
Epoch: 21, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.397183895111084
Epoch: 22, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.3923609256744385
Epoch: 23, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.39547038078308105
Epoch: 24, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.181 Vali Acc: 0.533 Test Loss: 1.181 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.3811008930206299
Epoch: 25, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.199 Vali Acc: 0.533 Test Loss: 1.199 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.3540985584259033
Epoch: 26, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.218 Vali Acc: 0.533 Test Loss: 1.218 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 225027
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5467233657836914
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.3912019729614258
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.35213422775268555
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.425384521484375
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.3695096969604492
Epoch: 5, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.3893117904663086
Epoch: 6, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.405515193939209
Epoch: 7, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.027 Vali Acc: 0.333 Test Loss: 1.027 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.415454626083374
Epoch: 8, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.3818361759185791
Epoch: 9, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.38713526725769043
Epoch: 10, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.012 Vali Acc: 0.333 Test Loss: 1.012 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3930017948150635
Epoch: 11, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.007 Vali Acc: 0.333 Test Loss: 1.007 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3828279972076416
Epoch: 12, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.002 Vali Acc: 0.333 Test Loss: 1.002 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3424830436706543
Epoch: 13, Steps: 1 | Train Loss: 0.423 Vali Loss: 0.999 Vali Acc: 0.333 Test Loss: 0.999 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.38933515548706055
Epoch: 14, Steps: 1 | Train Loss: 0.375 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 15 cost time: 0.34993553161621094
Epoch: 15, Steps: 1 | Train Loss: 0.342 Vali Loss: 0.993 Vali Acc: 0.333 Test Loss: 0.993 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4126467704772949
Epoch: 16, Steps: 1 | Train Loss: 0.289 Vali Loss: 0.992 Vali Acc: 0.333 Test Loss: 0.992 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3999030590057373
Epoch: 17, Steps: 1 | Train Loss: 0.260 Vali Loss: 0.993 Vali Acc: 0.333 Test Loss: 0.993 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.493593692779541
Epoch: 18, Steps: 1 | Train Loss: 0.238 Vali Loss: 0.994 Vali Acc: 0.333 Test Loss: 0.994 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3978395462036133
Epoch: 19, Steps: 1 | Train Loss: 0.198 Vali Loss: 0.996 Vali Acc: 0.333 Test Loss: 0.996 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4229717254638672
Epoch: 20, Steps: 1 | Train Loss: 0.183 Vali Loss: 0.999 Vali Acc: 0.333 Test Loss: 0.999 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3592379093170166
Epoch: 21, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.004 Vali Acc: 0.333 Test Loss: 1.004 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4071505069732666
Epoch: 22, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.009 Vali Acc: 0.333 Test Loss: 1.009 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.42652320861816406
Epoch: 23, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.016 Vali Acc: 0.333 Test Loss: 1.016 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.375866174697876
Epoch: 24, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 213123
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5019397735595703
Epoch: 1, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.34751439094543457
Epoch: 2, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3780055046081543
Epoch: 3, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.42921876907348633
Epoch: 4, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.33907413482666016
Epoch: 5, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.3708486557006836
Epoch: 6, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.40106916427612305
Epoch: 7, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.34685540199279785
Epoch: 8, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3635084629058838
Epoch: 9, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.38449645042419434
Epoch: 10, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4224817752838135
Epoch: 11, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.36336302757263184
Epoch: 12, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3917522430419922
Epoch: 13, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.37557053565979004
Epoch: 14, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.37520861625671387
Epoch: 15, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.37615442276000977
Epoch: 16, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.3979499340057373
Epoch: 17, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.3952343463897705
Epoch: 18, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3475799560546875
Epoch: 19, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4019734859466553
Epoch: 20, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.37345123291015625
Epoch: 21, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 211843
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4527907371520996
Epoch: 1, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3386201858520508
Epoch: 2, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4113929271697998
Epoch: 3, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.32799386978149414
Epoch: 4, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.32941675186157227
Epoch: 5, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.32892656326293945
Epoch: 6, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.4237191677093506
Epoch: 7, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 0.32751965522766113
Epoch: 8, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.36132192611694336
Epoch: 9, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.4543895721435547
Epoch: 10, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.30776023864746094
Epoch: 11, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.32668161392211914
Epoch: 12, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.3117082118988037
Epoch: 13, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.3453981876373291
Epoch: 14, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3054823875427246
Epoch: 15, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.36154937744140625
Epoch: 16, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.3099491596221924
Epoch: 17, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.367417573928833
Epoch: 18, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.37605810165405273
Epoch: 19, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4830920696258545
Epoch: 20, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4249269962310791
Epoch: 21, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.001 Vali Acc: 0.400 Test Loss: 1.001 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.3768341541290283
Epoch: 22, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.000 Vali Acc: 0.400 Test Loss: 1.000 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.34868836402893066
Epoch: 23, Steps: 1 | Train Loss: 0.183 Vali Loss: 0.999 Vali Acc: 0.400 Test Loss: 0.999 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.40194010734558105
Epoch: 24, Steps: 1 | Train Loss: 0.178 Vali Loss: 0.998 Vali Acc: 0.400 Test Loss: 0.998 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.40427708625793457
Epoch: 25, Steps: 1 | Train Loss: 0.155 Vali Loss: 0.998 Vali Acc: 0.400 Test Loss: 0.998 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.35855865478515625
Epoch: 26, Steps: 1 | Train Loss: 0.137 Vali Loss: 0.999 Vali Acc: 0.400 Test Loss: 0.999 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.3753652572631836
Epoch: 27, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.000 Vali Acc: 0.400 Test Loss: 1.000 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 217091
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5756275653839111
Epoch: 1, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.096 Vali Acc: 0.133 Test Loss: 1.096 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.36875176429748535
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.095 Vali Acc: 0.133 Test Loss: 1.095 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.379014253616333
Epoch: 3, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.093 Vali Acc: 0.133 Test Loss: 1.093 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 4 cost time: 0.4807896614074707
Epoch: 4, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.36559414863586426
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.39455389976501465
Epoch: 6, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.38859009742736816
Epoch: 7, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.38480544090270996
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.086 Vali Acc: 0.200 Test Loss: 1.086 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.41344761848449707
Epoch: 9, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.34053945541381836
Epoch: 10, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.45142149925231934
Epoch: 11, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.3903224468231201
Epoch: 12, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.3327152729034424
Epoch: 13, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 14 cost time: 0.3981211185455322
Epoch: 14, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.4275679588317871
Epoch: 15, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.35192251205444336
Epoch: 16, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.40233755111694336
Epoch: 17, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.42100024223327637
Epoch: 18, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.371596097946167
Epoch: 19, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.37938475608825684
Epoch: 20, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.37923097610473633
Epoch: 21, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.38163089752197266
Epoch: 22, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.38333821296691895
Epoch: 23, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.42973923683166504
Epoch: 24, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.40924882888793945
Epoch: 25, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.39824819564819336
Epoch: 26, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3703958988189697
Epoch: 27, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.38053321838378906
Epoch: 28, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4383258819580078
Epoch: 29, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.3391454219818115
Epoch: 30, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.40381479263305664
Epoch: 31, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.3849189281463623
Epoch: 32, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.4703049659729004
Epoch: 33, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 228483
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6138195991516113
Epoch: 1, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.37839794158935547
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37877798080444336
Epoch: 3, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.39715576171875
Epoch: 4, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.34050607681274414
Epoch: 5, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3566782474517822
Epoch: 6, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3479461669921875
Epoch: 7, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.44850707054138184
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3539702892303467
Epoch: 9, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.34820985794067383
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4101603031158447
Epoch: 11, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 239875
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6012232303619385
Epoch: 1, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4159579277038574
Epoch: 2, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3735959529876709
Epoch: 3, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3821380138397217
Epoch: 4, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.3315277099609375
Epoch: 5, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.4363820552825928
Epoch: 6, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.3890986442565918
Epoch: 7, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.39227890968322754
Epoch: 8, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.36036157608032227
Epoch: 9, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3796379566192627
Epoch: 10, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3881490230560303
Epoch: 11, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.3704409599304199
Epoch: 12, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.34349989891052246
Epoch: 13, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.39911913871765137
Epoch: 14, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.41831278800964355
Epoch: 15, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43038463592529297
Epoch: 16, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.34458065032958984
Epoch: 17, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3482050895690918
Epoch: 18, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3874650001525879
Epoch: 19, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3959767818450928
Epoch: 20, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3918936252593994
Epoch: 21, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.36588096618652344
Epoch: 22, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.3877990245819092
Epoch: 23, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.34151744842529297
Epoch: 24, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 105731
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4865167140960693
Epoch: 1, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.3507862091064453
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.3671839237213135
Epoch: 3, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.36774206161499023
Epoch: 4, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.40302324295043945
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.38698267936706543
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.3692753314971924
Epoch: 7, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.3765261173248291
Epoch: 8, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.4311187267303467
Epoch: 9, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.37973856925964355
Epoch: 10, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.4269576072692871
Epoch: 11, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.3488171100616455
Epoch: 12, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3608238697052002
Epoch: 13, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3483695983886719
Epoch: 14, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3607172966003418
Epoch: 15, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.37504124641418457
Epoch: 16, Steps: 1 | Train Loss: 0.411 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.3517487049102783
Epoch: 17, Steps: 1 | Train Loss: 0.358 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.37491464614868164
Epoch: 18, Steps: 1 | Train Loss: 0.320 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3827781677246094
Epoch: 19, Steps: 1 | Train Loss: 0.296 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.41794800758361816
Epoch: 20, Steps: 1 | Train Loss: 0.275 Vali Loss: 0.984 Vali Acc: 0.400 Test Loss: 0.984 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.34710073471069336
Epoch: 21, Steps: 1 | Train Loss: 0.235 Vali Loss: 0.983 Vali Acc: 0.400 Test Loss: 0.983 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 79747
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.571092128753662
Epoch: 1, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.34383273124694824
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41258692741394043
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4143214225769043
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.3436591625213623
Epoch: 5, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.40781712532043457
Epoch: 6, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.30832529067993164
Epoch: 7, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.40869879722595215
Epoch: 8, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.002 Vali Acc: 0.400 Test Loss: 1.002 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4356355667114258
Epoch: 9, Steps: 1 | Train Loss: 0.727 Vali Loss: 0.997 Vali Acc: 0.400 Test Loss: 0.997 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.39415764808654785
Epoch: 10, Steps: 1 | Train Loss: 0.648 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.3756387233734131
Epoch: 11, Steps: 1 | Train Loss: 0.682 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.34943580627441406
Epoch: 12, Steps: 1 | Train Loss: 0.648 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 13 cost time: 0.3793058395385742
Epoch: 13, Steps: 1 | Train Loss: 0.570 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 14 cost time: 0.367678165435791
Epoch: 14, Steps: 1 | Train Loss: 0.549 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 15 cost time: 0.3998725414276123
Epoch: 15, Steps: 1 | Train Loss: 0.520 Vali Loss: 0.967 Vali Acc: 0.467 Test Loss: 0.967 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.38779449462890625
Epoch: 16, Steps: 1 | Train Loss: 0.493 Vali Loss: 0.962 Vali Acc: 0.467 Test Loss: 0.962 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.41213369369506836
Epoch: 17, Steps: 1 | Train Loss: 0.463 Vali Loss: 0.958 Vali Acc: 0.467 Test Loss: 0.958 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5310206413269043
Epoch: 18, Steps: 1 | Train Loss: 0.414 Vali Loss: 0.954 Vali Acc: 0.467 Test Loss: 0.954 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.36399292945861816
Epoch: 19, Steps: 1 | Train Loss: 0.383 Vali Loss: 0.949 Vali Acc: 0.467 Test Loss: 0.949 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3713719844818115
Epoch: 20, Steps: 1 | Train Loss: 0.364 Vali Loss: 0.945 Vali Acc: 0.467 Test Loss: 0.945 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4583311080932617
Epoch: 21, Steps: 1 | Train Loss: 0.341 Vali Loss: 0.942 Vali Acc: 0.533 Test Loss: 0.942 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 22 cost time: 0.35871076583862305
Epoch: 22, Steps: 1 | Train Loss: 0.311 Vali Loss: 0.939 Vali Acc: 0.533 Test Loss: 0.939 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 23 cost time: 0.4503779411315918
Epoch: 23, Steps: 1 | Train Loss: 0.284 Vali Loss: 0.937 Vali Acc: 0.467 Test Loss: 0.937 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3792605400085449
Epoch: 24, Steps: 1 | Train Loss: 0.254 Vali Loss: 0.934 Vali Acc: 0.467 Test Loss: 0.934 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4203472137451172
Epoch: 25, Steps: 1 | Train Loss: 0.236 Vali Loss: 0.933 Vali Acc: 0.467 Test Loss: 0.933 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3623671531677246
Epoch: 26, Steps: 1 | Train Loss: 0.214 Vali Loss: 0.932 Vali Acc: 0.467 Test Loss: 0.932 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.45447611808776855
Epoch: 27, Steps: 1 | Train Loss: 0.197 Vali Loss: 0.932 Vali Acc: 0.467 Test Loss: 0.932 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3683125972747803
Epoch: 28, Steps: 1 | Train Loss: 0.177 Vali Loss: 0.932 Vali Acc: 0.533 Test Loss: 0.932 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 29 cost time: 0.3687264919281006
Epoch: 29, Steps: 1 | Train Loss: 0.150 Vali Loss: 0.933 Vali Acc: 0.533 Test Loss: 0.933 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.38796401023864746
Epoch: 30, Steps: 1 | Train Loss: 0.139 Vali Loss: 0.935 Vali Acc: 0.533 Test Loss: 0.935 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.3622252941131592
Epoch: 31, Steps: 1 | Train Loss: 0.122 Vali Loss: 0.937 Vali Acc: 0.533 Test Loss: 0.937 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.41686129570007324
Epoch: 32, Steps: 1 | Train Loss: 0.112 Vali Loss: 0.940 Vali Acc: 0.600 Test Loss: 0.940 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599991).  Saving model ...
Epoch: 33 cost time: 0.3837902545928955
Epoch: 33, Steps: 1 | Train Loss: 0.106 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.33685874938964844
Epoch: 34, Steps: 1 | Train Loss: 0.091 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4139683246612549
Epoch: 35, Steps: 1 | Train Loss: 0.078 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.35593080520629883
Epoch: 36, Steps: 1 | Train Loss: 0.077 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3538947105407715
Epoch: 37, Steps: 1 | Train Loss: 0.067 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.38648176193237305
Epoch: 38, Steps: 1 | Train Loss: 0.059 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.415895938873291
Epoch: 39, Steps: 1 | Train Loss: 0.054 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4561140537261963
Epoch: 40, Steps: 1 | Train Loss: 0.049 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4127388000488281
Epoch: 41, Steps: 1 | Train Loss: 0.044 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.3838212490081787
Epoch: 42, Steps: 1 | Train Loss: 0.038 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 73795
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6161227226257324
Epoch: 1, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.41330862045288086
Epoch: 2, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.34618711471557617
Epoch: 3, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3996701240539551
Epoch: 4, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3733506202697754
Epoch: 5, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3450314998626709
Epoch: 6, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4063270092010498
Epoch: 7, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.33959531784057617
Epoch: 8, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3407468795776367
Epoch: 9, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.36933469772338867
Epoch: 10, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.352799654006958
Epoch: 11, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3555796146392822
Epoch: 12, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.4503920078277588
Epoch: 13, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.31603312492370605
Epoch: 14, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.37102270126342773
Epoch: 15, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.3619816303253174
Epoch: 16, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.38666558265686035
Epoch: 17, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.3243849277496338
Epoch: 18, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.33406996726989746
Epoch: 19, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.39376306533813477
Epoch: 20, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.3255014419555664
Epoch: 21, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.3519320487976074
Epoch: 22, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.3823719024658203
Epoch: 23, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.33939528465270996
Epoch: 24, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.36939001083374023
Epoch: 25, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4434986114501953
Epoch: 26, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.39798784255981445
Epoch: 27, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.3505709171295166
Epoch: 28, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.47016286849975586
Epoch: 29, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.3701953887939453
Epoch: 30, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.32293248176574707
Epoch: 31, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3719756603240967
Epoch: 32, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 73155
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6299071311950684
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.31127405166625977
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3787720203399658
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.33225464820861816
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.35101890563964844
Epoch: 5, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.45336055755615234
Epoch: 6, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4048500061035156
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.31360602378845215
Epoch: 8, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.31502318382263184
Epoch: 9, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.32216358184814453
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.32734203338623047
Epoch: 11, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 75779
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4013056755065918
Epoch: 1, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3494398593902588
Epoch: 2, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.37557315826416016
Epoch: 3, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.47486257553100586
Epoch: 4, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.40021491050720215
Epoch: 5, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.33809947967529297
Epoch: 6, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4750804901123047
Epoch: 7, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.38730907440185547
Epoch: 8, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3788938522338867
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.3302323818206787
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4072387218475342
Epoch: 11, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.35796594619750977
Epoch: 12, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.36309361457824707
Epoch: 13, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.3952035903930664
Epoch: 14, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.38495588302612305
Epoch: 15, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3871757984161377
Epoch: 16, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.3896820545196533
Epoch: 17, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.32262110710144043
Epoch: 18, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.3538241386413574
Epoch: 19, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.38611841201782227
Epoch: 20, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.4059925079345703
Epoch: 21, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.36589908599853516
Epoch: 22, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.33826303482055664
Epoch: 23, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.3433248996734619
Epoch: 24, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.4012107849121094
Epoch: 25, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.35056138038635254
Epoch: 26, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.44525671005249023
Epoch: 27, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4076056480407715
Epoch: 28, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.39311909675598145
Epoch: 29, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.3483612537384033
Epoch: 30, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.42160868644714355
Epoch: 31, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.3939950466156006
Epoch: 32, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.34989213943481445
Epoch: 33, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.42872118949890137
Epoch: 34, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.36711835861206055
Epoch: 35, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.36458396911621094
Epoch: 36, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.29909253120422363
Epoch: 37, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3506016731262207
Epoch: 38, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.38345861434936523
Epoch: 39, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.3696930408477783
Epoch: 40, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.3941218852996826
Epoch: 41, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.42431187629699707
Epoch: 42, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 81475
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4767258167266846
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.36546897888183594
Epoch: 2, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3708035945892334
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3949408531188965
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3429844379425049
Epoch: 5, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.45253944396972656
Epoch: 6, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.35462331771850586
Epoch: 7, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.31995320320129395
Epoch: 8, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3699002265930176
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3369109630584717
Epoch: 10, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3365306854248047
Epoch: 11, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.352597713470459
Epoch: 12, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.30860304832458496
Epoch: 13, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3261857032775879
Epoch: 14, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3802361488342285
Epoch: 15, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4038538932800293
Epoch: 16, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3389618396759033
Epoch: 17, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.32914161682128906
Epoch: 18, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.33838629722595215
Epoch: 19, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.3263545036315918
Epoch: 20, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.41564464569091797
Epoch: 21, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.38161468505859375
Epoch: 22, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 87171
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4837186336517334
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.3569374084472656
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.43467211723327637
Epoch: 3, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.3873763084411621
Epoch: 4, Steps: 1 | Train Loss: 0.959 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4573543071746826
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.3981757164001465
Epoch: 6, Steps: 1 | Train Loss: 0.874 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.3871603012084961
Epoch: 7, Steps: 1 | Train Loss: 0.794 Vali Loss: 0.984 Vali Acc: 0.667 Test Loss: 0.984 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.3557615280151367
Epoch: 8, Steps: 1 | Train Loss: 0.814 Vali Loss: 0.979 Vali Acc: 0.667 Test Loss: 0.979 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 0.39612245559692383
Epoch: 9, Steps: 1 | Train Loss: 0.709 Vali Loss: 0.973 Vali Acc: 0.667 Test Loss: 0.973 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.3669753074645996
Epoch: 10, Steps: 1 | Train Loss: 0.698 Vali Loss: 0.968 Vali Acc: 0.667 Test Loss: 0.968 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.37908005714416504
Epoch: 11, Steps: 1 | Train Loss: 0.644 Vali Loss: 0.963 Vali Acc: 0.733 Test Loss: 0.963 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 0.5179059505462646
Epoch: 12, Steps: 1 | Train Loss: 0.602 Vali Loss: 0.957 Vali Acc: 0.733 Test Loss: 0.957 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 0.3553192615509033
Epoch: 13, Steps: 1 | Train Loss: 0.563 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.38067102432250977
Epoch: 14, Steps: 1 | Train Loss: 0.499 Vali Loss: 0.947 Vali Acc: 0.733 Test Loss: 0.947 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.38277363777160645
Epoch: 15, Steps: 1 | Train Loss: 0.464 Vali Loss: 0.942 Vali Acc: 0.733 Test Loss: 0.942 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 0.3256821632385254
Epoch: 16, Steps: 1 | Train Loss: 0.438 Vali Loss: 0.938 Vali Acc: 0.733 Test Loss: 0.938 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.4141268730163574
Epoch: 17, Steps: 1 | Train Loss: 0.411 Vali Loss: 0.935 Vali Acc: 0.800 Test Loss: 0.935 Test Acc: 0.800
Validation loss decreased (-0.733324 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 0.3330345153808594
Epoch: 18, Steps: 1 | Train Loss: 0.369 Vali Loss: 0.932 Vali Acc: 0.667 Test Loss: 0.932 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4583306312561035
Epoch: 19, Steps: 1 | Train Loss: 0.312 Vali Loss: 0.930 Vali Acc: 0.667 Test Loss: 0.930 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.45658206939697266
Epoch: 20, Steps: 1 | Train Loss: 0.288 Vali Loss: 0.929 Vali Acc: 0.600 Test Loss: 0.929 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.34749555587768555
Epoch: 21, Steps: 1 | Train Loss: 0.258 Vali Loss: 0.929 Vali Acc: 0.600 Test Loss: 0.929 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.3854336738586426
Epoch: 22, Steps: 1 | Train Loss: 0.249 Vali Loss: 0.930 Vali Acc: 0.600 Test Loss: 0.930 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.33458757400512695
Epoch: 23, Steps: 1 | Train Loss: 0.201 Vali Loss: 0.932 Vali Acc: 0.600 Test Loss: 0.932 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.34446096420288086
Epoch: 24, Steps: 1 | Train Loss: 0.185 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.3735663890838623
Epoch: 25, Steps: 1 | Train Loss: 0.174 Vali Loss: 0.938 Vali Acc: 0.600 Test Loss: 0.938 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.36663269996643066
Epoch: 26, Steps: 1 | Train Loss: 0.142 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.37563371658325195
Epoch: 27, Steps: 1 | Train Loss: 0.119 Vali Loss: 0.948 Vali Acc: 0.533 Test Loss: 0.948 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps63_str32_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.8
model parameter : 44675
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5898399353027344
Epoch: 1, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.223 Vali Acc: 0.067 Test Loss: 1.223 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 0.3572235107421875
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.225 Vali Acc: 0.067 Test Loss: 1.225 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3583240509033203
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.228 Vali Acc: 0.067 Test Loss: 1.228 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4371917247772217
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.230 Vali Acc: 0.067 Test Loss: 1.230 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.32849836349487305
Epoch: 5, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.232 Vali Acc: 0.067 Test Loss: 1.232 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3522627353668213
Epoch: 6, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.236 Vali Acc: 0.067 Test Loss: 1.236 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3527522087097168
Epoch: 7, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.239 Vali Acc: 0.067 Test Loss: 1.239 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3465735912322998
Epoch: 8, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.241 Vali Acc: 0.067 Test Loss: 1.241 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.29647326469421387
Epoch: 9, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.243 Vali Acc: 0.067 Test Loss: 1.243 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3081824779510498
Epoch: 10, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.245 Vali Acc: 0.067 Test Loss: 1.245 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.380324125289917
Epoch: 11, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.247 Vali Acc: 0.067 Test Loss: 1.247 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps125_str63_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.06666666666666667
model parameter : 31683
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.549983024597168
Epoch: 1, Steps: 1 | Train Loss: 1.380 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4050605297088623
Epoch: 2, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.32633209228515625
Epoch: 3, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.3408808708190918
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.36411380767822266
Epoch: 5, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.35746240615844727
Epoch: 6, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3611595630645752
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3728923797607422
Epoch: 8, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.30556583404541016
Epoch: 9, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.3359103202819824
Epoch: 10, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.3155665397644043
Epoch: 11, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.30908632278442383
Epoch: 12, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.3449544906616211
Epoch: 13, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3630352020263672
Epoch: 14, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.3503451347351074
Epoch: 15, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.39531517028808594
Epoch: 16, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.33873748779296875
Epoch: 17, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.33594393730163574
Epoch: 18, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.3213074207305908
Epoch: 19, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.39899253845214844
Epoch: 20, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.33411598205566406
Epoch: 21, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4227743148803711
Epoch: 22, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.2964639663696289
Epoch: 23, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3742797374725342
Epoch: 24, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.36173295974731445
Epoch: 25, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3056802749633789
Epoch: 26, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.38204383850097656
Epoch: 27, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.34087181091308594
Epoch: 28, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.3365945816040039
Epoch: 29, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.396517276763916
Epoch: 30, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps188_str94_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 28707
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5889990329742432
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3624587059020996
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3652026653289795
Epoch: 3, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.39376354217529297
Epoch: 4, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.41007089614868164
Epoch: 5, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3676333427429199
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.34500765800476074
Epoch: 7, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3388552665710449
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.35436248779296875
Epoch: 9, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3785419464111328
Epoch: 10, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3609647750854492
Epoch: 11, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps250_str125_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 28387
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5050058364868164
Epoch: 1, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.360426664352417
Epoch: 2, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.34143495559692383
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4319334030151367
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.444779634475708
Epoch: 5, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.34987878799438477
Epoch: 6, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3523228168487549
Epoch: 7, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.33248257637023926
Epoch: 8, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.35344934463500977
Epoch: 9, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.43819332122802734
Epoch: 10, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.358046293258667
Epoch: 11, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3763246536254883
Epoch: 12, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.3704874515533447
Epoch: 13, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.36371779441833496
Epoch: 14, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.33743906021118164
Epoch: 15, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.39161038398742676
Epoch: 16, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.5155036449432373
Epoch: 17, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.451462984085083
Epoch: 18, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.4210672378540039
Epoch: 19, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.40172839164733887
Epoch: 20, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4446530342102051
Epoch: 21, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4776313304901123
Epoch: 22, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.44008922576904297
Epoch: 23, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.39287328720092773
Epoch: 24, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.34233856201171875
Epoch: 25, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3418877124786377
Epoch: 26, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.33757758140563965
Epoch: 27, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.38586926460266113
Epoch: 28, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.41052865982055664
Epoch: 29, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.3538646697998047
Epoch: 30, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.3735930919647217
Epoch: 31, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3098468780517578
Epoch: 32, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps375_str188_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 29699
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5432982444763184
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.35933542251586914
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.36934733390808105
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.38017940521240234
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.33731937408447266
Epoch: 5, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3714172840118408
Epoch: 6, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.35976099967956543
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.3916912078857422
Epoch: 8, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.37286806106567383
Epoch: 9, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.3541605472564697
Epoch: 10, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.46024489402770996
Epoch: 11, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.3682582378387451
Epoch: 12, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.37896060943603516
Epoch: 13, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.3375823497772217
Epoch: 14, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.3810594081878662
Epoch: 15, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.34299349784851074
Epoch: 16, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.3966543674468994
Epoch: 17, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.351743221282959
Epoch: 18, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.4243154525756836
Epoch: 19, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 0.4189326763153076
Epoch: 20, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 0.411060094833374
Epoch: 21, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.4474368095397949
Epoch: 22, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.3956153392791748
Epoch: 23, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.39266395568847656
Epoch: 24, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.35480833053588867
Epoch: 25, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.38481831550598145
Epoch: 26, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4052109718322754
Epoch: 27, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.025 Vali Acc: 0.333 Test Loss: 1.025 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.38055849075317383
Epoch: 28, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.023 Vali Acc: 0.333 Test Loss: 1.023 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.31939244270324707
Epoch: 29, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.38277316093444824
Epoch: 30, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.36301088333129883
Epoch: 31, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.39460086822509766
Epoch: 32, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.38292503356933594
Epoch: 33, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4811081886291504
Epoch: 34, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps500_str250_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 32547
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4255850315093994
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3120408058166504
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3032059669494629
Epoch: 3, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.35654497146606445
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3224143981933594
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.33415865898132324
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.39226412773132324
Epoch: 7, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3655271530151367
Epoch: 8, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.33094310760498047
Epoch: 9, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.35350680351257324
Epoch: 10, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.33547544479370117
Epoch: 11, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ModernTCN_UEA_ftM_sl2500_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps625_str313_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 35395
model size : 0.15MB
