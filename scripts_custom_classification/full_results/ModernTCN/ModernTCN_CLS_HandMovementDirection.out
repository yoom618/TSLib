Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3636929988861084
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.6345195770263672
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.368 Vali Acc: 0.365 Test Loss: 1.368 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.6171703338623047
Epoch: 3, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.341 Vali Acc: 0.351 Test Loss: 1.341 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7271385192871094
Epoch: 4, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.312 Vali Acc: 0.365 Test Loss: 1.312 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.9962878227233887
Epoch: 5, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.0129330158233643
Epoch: 6, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.928828477859497
Epoch: 7, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.210 Vali Acc: 0.473 Test Loss: 1.210 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 2.1137380599975586
Epoch: 8, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 2.0290088653564453
Epoch: 9, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.264 Vali Acc: 0.486 Test Loss: 1.264 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.252424716949463
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.303 Vali Acc: 0.514 Test Loss: 1.303 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8732876777648926
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.065730094909668
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0117838382720947
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.375 Vali Acc: 0.514 Test Loss: 1.375 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.045992136001587
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.397 Vali Acc: 0.514 Test Loss: 1.397 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.002902030944824
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0943045616149902
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.418 Vali Acc: 0.500 Test Loss: 1.418 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0061802864074707
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.431 Vali Acc: 0.541 Test Loss: 1.431 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.11372447013855
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 2095332
model size : 8.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.055100679397583
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.371 Vali Acc: 0.378 Test Loss: 1.371 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.721158742904663
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.344 Vali Acc: 0.432 Test Loss: 1.344 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.617741346359253
Epoch: 3, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.297 Vali Acc: 0.459 Test Loss: 1.297 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 1.7095379829406738
Epoch: 4, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.6771996021270752
Epoch: 5, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.7181785106658936
Epoch: 6, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.596407175064087
Epoch: 7, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8088655471801758
Epoch: 8, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.095 Vali Acc: 0.514 Test Loss: 1.095 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.613692045211792
Epoch: 9, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.6042883396148682
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6535656452178955
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6273353099822998
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6568963527679443
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6812450885772705
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7042601108551025
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.144 Vali Acc: 0.527 Test Loss: 1.144 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.718956708908081
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.800915241241455
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6576597690582275
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5601606369018555
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.188 Vali Acc: 0.541 Test Loss: 1.188 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2044452
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9132180213928223
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.396 Vali Acc: 0.230 Test Loss: 1.396 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.6762135028839111
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.371 Vali Acc: 0.270 Test Loss: 1.371 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 1.6612107753753662
Epoch: 3, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.333 Vali Acc: 0.351 Test Loss: 1.333 Test Acc: 0.351
Validation loss decreased (-0.270257 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.6583950519561768
Epoch: 4, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.297 Vali Acc: 0.446 Test Loss: 1.297 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.5107438564300537
Epoch: 5, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.7572336196899414
Epoch: 6, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.6621158123016357
Epoch: 7, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.6829993724822998
Epoch: 8, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.506648063659668
Epoch: 9, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.7216734886169434
Epoch: 10, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6042087078094482
Epoch: 11, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.6787075996398926
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6167962551116943
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7728610038757324
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5789992809295654
Epoch: 15, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7064988613128662
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5038690567016602
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.197 Vali Acc: 0.554 Test Loss: 1.197 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7690658569335938
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.644510269165039
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.244 Vali Acc: 0.568 Test Loss: 1.244 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6047205924987793
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.246 Vali Acc: 0.554 Test Loss: 1.246 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.385749340057373
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.257 Vali Acc: 0.554 Test Loss: 1.257 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2029412
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.850973606109619
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.5652449131011963
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.374 Vali Acc: 0.324 Test Loss: 1.374 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.3553481101989746
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.340 Vali Acc: 0.365 Test Loss: 1.340 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.353020191192627
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.309 Vali Acc: 0.405 Test Loss: 1.309 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.5434226989746094
Epoch: 5, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.275 Vali Acc: 0.392 Test Loss: 1.275 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5265893936157227
Epoch: 6, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.251 Vali Acc: 0.419 Test Loss: 1.251 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 1.3715789318084717
Epoch: 7, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.221 Vali Acc: 0.473 Test Loss: 1.221 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.6986229419708252
Epoch: 8, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.182 Vali Acc: 0.432 Test Loss: 1.182 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4558520317077637
Epoch: 9, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.167 Vali Acc: 0.432 Test Loss: 1.167 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.686539649963379
Epoch: 10, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.155 Vali Acc: 0.459 Test Loss: 1.155 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6373035907745361
Epoch: 11, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.142 Vali Acc: 0.473 Test Loss: 1.142 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 12 cost time: 1.5798134803771973
Epoch: 12, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.154 Vali Acc: 0.432 Test Loss: 1.154 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3071396350860596
Epoch: 13, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.6666312217712402
Epoch: 14, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.4727153778076172
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.5797066688537598
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3686561584472656
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6677210330963135
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.574389934539795
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6090717315673828
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.287724256515503
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4040746688842773
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3750035762786865
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1691205501556396
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3126981258392334
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 2019492
model size : 7.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.782522439956665
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.393 Vali Acc: 0.203 Test Loss: 1.393 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.5194473266601562
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.381 Vali Acc: 0.297 Test Loss: 1.381 Test Acc: 0.297
Validation loss decreased (-0.202689 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 1.3447685241699219
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.360 Vali Acc: 0.311 Test Loss: 1.360 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.6327998638153076
Epoch: 4, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.328 Vali Acc: 0.446 Test Loss: 1.328 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.3918511867523193
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.302 Vali Acc: 0.446 Test Loss: 1.302 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.516813039779663
Epoch: 6, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.2705950736999512
Epoch: 7, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5858967304229736
Epoch: 8, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4124352931976318
Epoch: 9, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.5405611991882324
Epoch: 10, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4088621139526367
Epoch: 11, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.452759027481079
Epoch: 12, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.143 Vali Acc: 0.554 Test Loss: 1.143 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.3747994899749756
Epoch: 13, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.277806043624878
Epoch: 14, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4689195156097412
Epoch: 15, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.143 Vali Acc: 0.541 Test Loss: 1.143 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3498456478118896
Epoch: 16, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5231890678405762
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1080636978149414
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.190 Vali Acc: 0.554 Test Loss: 1.190 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.376659631729126
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.199 Vali Acc: 0.554 Test Loss: 1.199 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3540501594543457
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.207 Vali Acc: 0.527 Test Loss: 1.207 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3735942840576172
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5147905349731445
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.237 Vali Acc: 0.541 Test Loss: 1.237 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2015012
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.977802276611328
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.370 Vali Acc: 0.338 Test Loss: 1.370 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.5244340896606445
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.360 Vali Acc: 0.365 Test Loss: 1.360 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.596452236175537
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.340 Vali Acc: 0.365 Test Loss: 1.340 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.462414264678955
Epoch: 4, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.320 Vali Acc: 0.419 Test Loss: 1.320 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.3756873607635498
Epoch: 5, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.290 Vali Acc: 0.419 Test Loss: 1.290 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.567305088043213
Epoch: 6, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.265 Vali Acc: 0.473 Test Loss: 1.265 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 1.6031177043914795
Epoch: 7, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.6297931671142578
Epoch: 8, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.3812601566314697
Epoch: 9, Steps: 10 | Train Loss: 0.734 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.6551740169525146
Epoch: 10, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5235223770141602
Epoch: 11, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.359738826751709
Epoch: 12, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.116 Vali Acc: 0.473 Test Loss: 1.116 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2755990028381348
Epoch: 13, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.108 Vali Acc: 0.486 Test Loss: 1.108 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4476127624511719
Epoch: 14, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 1.279414415359497
Epoch: 15, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.088 Vali Acc: 0.527 Test Loss: 1.088 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 1.2943129539489746
Epoch: 16, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.452791690826416
Epoch: 17, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 1.485719919204712
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6921348571777344
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5471045970916748
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.109 Vali Acc: 0.581 Test Loss: 1.109 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 21 cost time: 1.5542361736297607
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5502245426177979
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.647369623184204
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.163 Vali Acc: 0.568 Test Loss: 1.163 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3543126583099365
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.182 Vali Acc: 0.554 Test Loss: 1.182 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5799334049224854
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5196993350982666
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6079838275909424
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3530235290527344
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.232 Vali Acc: 0.581 Test Loss: 1.232 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4986772537231445
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.247 Vali Acc: 0.554 Test Loss: 1.247 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3657541275024414
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.271 Vali Acc: 0.568 Test Loss: 1.271 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2010532
model size : 7.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.581416130065918
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.398 Vali Acc: 0.230 Test Loss: 1.398 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.4729247093200684
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
Validation loss decreased (-0.229716 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.3663671016693115
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.382 Vali Acc: 0.311 Test Loss: 1.382 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.5083136558532715
Epoch: 4, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.355 Vali Acc: 0.378 Test Loss: 1.355 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.4382660388946533
Epoch: 5, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.325 Vali Acc: 0.419 Test Loss: 1.325 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.4446215629577637
Epoch: 6, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.3644089698791504
Epoch: 7, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.261 Vali Acc: 0.473 Test Loss: 1.261 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4510881900787354
Epoch: 8, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.3902060985565186
Epoch: 9, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.378476619720459
Epoch: 10, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.175 Vali Acc: 0.486 Test Loss: 1.175 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3491265773773193
Epoch: 11, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.152 Vali Acc: 0.459 Test Loss: 1.152 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4328439235687256
Epoch: 12, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.135 Vali Acc: 0.459 Test Loss: 1.135 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4789972305297852
Epoch: 13, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.2591519355773926
Epoch: 14, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1353728771209717
Epoch: 15, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 1.133636236190796
Epoch: 16, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2688171863555908
Epoch: 17, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3740532398223877
Epoch: 18, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.166670799255371
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3969271183013916
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3839106559753418
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513501).  Saving model ...
Epoch: 22 cost time: 1.46600341796875
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.456693172454834
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.277 Vali Acc: 0.527 Test Loss: 1.277 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 24 cost time: 1.4479320049285889
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.304 Vali Acc: 0.500 Test Loss: 1.304 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5214664936065674
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3419156074523926
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.352 Vali Acc: 0.500 Test Loss: 1.352 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3871808052062988
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.328972578048706
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.415 Vali Acc: 0.473 Test Loss: 1.415 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5838830471038818
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.440 Vali Acc: 0.473 Test Loss: 1.440 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.401855707168579
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.454 Vali Acc: 0.473 Test Loss: 1.454 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3738417625427246
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2900919914245605
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5215582847595215
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.508 Vali Acc: 0.486 Test Loss: 1.508 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2006052
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.286888837814331
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.363 Vali Acc: 0.392 Test Loss: 1.363 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.885756015777588
Epoch: 2, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.322 Vali Acc: 0.446 Test Loss: 1.322 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.9929888248443604
Epoch: 3, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.6773021221160889
Epoch: 4, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8546481132507324
Epoch: 5, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.9395172595977783
Epoch: 6, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.119 Vali Acc: 0.473 Test Loss: 1.119 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6256096363067627
Epoch: 7, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.8216063976287842
Epoch: 8, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8146767616271973
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 2.003460645675659
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9241564273834229
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0805466175079346
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.036597490310669
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.867746114730835
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.239 Vali Acc: 0.541 Test Loss: 1.239 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9227542877197266
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.254 Vali Acc: 0.541 Test Loss: 1.254 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6531901359558105
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.263 Vali Acc: 0.541 Test Loss: 1.263 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7165720462799072
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.276 Vali Acc: 0.541 Test Loss: 1.276 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7217822074890137
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.287 Vali Acc: 0.541 Test Loss: 1.287 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5948145389556885
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2086372
model size : 8.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.659734010696411
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.382 Vali Acc: 0.243 Test Loss: 1.382 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.4821033477783203
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.347 Vali Acc: 0.365 Test Loss: 1.347 Test Acc: 0.365
Validation loss decreased (-0.243229 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.5363361835479736
Epoch: 3, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.305 Vali Acc: 0.365 Test Loss: 1.305 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.550696849822998
Epoch: 4, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.259 Vali Acc: 0.419 Test Loss: 1.259 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.6223182678222656
Epoch: 5, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.231 Vali Acc: 0.419 Test Loss: 1.231 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 6 cost time: 1.7174477577209473
Epoch: 6, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.152 Vali Acc: 0.446 Test Loss: 1.152 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 1.6623520851135254
Epoch: 7, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.7448501586914062
Epoch: 8, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.7293834686279297
Epoch: 9, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.118 Vali Acc: 0.486 Test Loss: 1.118 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7198631763458252
Epoch: 10, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.6285247802734375
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8006417751312256
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6815533638000488
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.138 Vali Acc: 0.473 Test Loss: 1.138 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6999640464782715
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7900066375732422
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.713054895401001
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6833186149597168
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6380095481872559
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8463904857635498
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.346416711807251
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2035492
model size : 7.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9785099029541016
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.387 Vali Acc: 0.297 Test Loss: 1.387 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.7785682678222656
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.370 Vali Acc: 0.338 Test Loss: 1.370 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.5157678127288818
Epoch: 3, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.334 Vali Acc: 0.351 Test Loss: 1.334 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.5924475193023682
Epoch: 4, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.308 Vali Acc: 0.405 Test Loss: 1.308 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.4773204326629639
Epoch: 5, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.268 Vali Acc: 0.473 Test Loss: 1.268 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.6436352729797363
Epoch: 6, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.4270613193511963
Epoch: 7, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.6401004791259766
Epoch: 8, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.662707805633545
Epoch: 9, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.731891393661499
Epoch: 10, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.3775691986083984
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 1.3226628303527832
Epoch: 12, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2473695278167725
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.160 Vali Acc: 0.554 Test Loss: 1.160 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 14 cost time: 1.2570509910583496
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2213568687438965
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0194926261901855
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3682372570037842
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.560448169708252
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.203 Vali Acc: 0.527 Test Loss: 1.203 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7204532623291016
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.210 Vali Acc: 0.527 Test Loss: 1.210 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4875476360321045
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.229 Vali Acc: 0.527 Test Loss: 1.229 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5710291862487793
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.256 Vali Acc: 0.568 Test Loss: 1.256 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 22 cost time: 1.5808405876159668
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.255 Vali Acc: 0.527 Test Loss: 1.255 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6009180545806885
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.265 Vali Acc: 0.527 Test Loss: 1.265 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.433626651763916
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.272 Vali Acc: 0.527 Test Loss: 1.272 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7242441177368164
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.292 Vali Acc: 0.527 Test Loss: 1.292 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4512646198272705
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.308 Vali Acc: 0.527 Test Loss: 1.308 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5330548286437988
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.312 Vali Acc: 0.527 Test Loss: 1.312 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5947816371917725
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.320 Vali Acc: 0.527 Test Loss: 1.320 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.535707950592041
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7155964374542236
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.344 Vali Acc: 0.541 Test Loss: 1.344 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6111550331115723
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.527 Test Loss: 1.352 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2020452
model size : 7.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.611292839050293
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.404 Vali Acc: 0.257 Test Loss: 1.404 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.368504524230957
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.388 Vali Acc: 0.311 Test Loss: 1.388 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.4540557861328125
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.348 Vali Acc: 0.284 Test Loss: 1.348 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3468520641326904
Epoch: 4, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.318 Vali Acc: 0.351 Test Loss: 1.318 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.586700677871704
Epoch: 5, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.288 Vali Acc: 0.446 Test Loss: 1.288 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.1538455486297607
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.260 Vali Acc: 0.419 Test Loss: 1.260 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4919328689575195
Epoch: 7, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.230 Vali Acc: 0.432 Test Loss: 1.230 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5396366119384766
Epoch: 8, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.202 Vali Acc: 0.419 Test Loss: 1.202 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5050745010375977
Epoch: 9, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.4080848693847656
Epoch: 10, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.171 Vali Acc: 0.432 Test Loss: 1.171 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5277836322784424
Epoch: 11, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.180 Vali Acc: 0.419 Test Loss: 1.180 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3258357048034668
Epoch: 12, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 1.4930839538574219
Epoch: 13, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4824717044830322
Epoch: 14, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.175 Vali Acc: 0.446 Test Loss: 1.175 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6327722072601318
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.152 Vali Acc: 0.459 Test Loss: 1.152 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.394632339477539
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.4674923419952393
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 18 cost time: 1.4089679718017578
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.180 Vali Acc: 0.473 Test Loss: 1.180 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.444249153137207
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.189 Vali Acc: 0.459 Test Loss: 1.189 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.28977632522583
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5054748058319092
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3702335357666016
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4235079288482666
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3926639556884766
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.234 Vali Acc: 0.486 Test Loss: 1.234 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2694611549377441
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1290717124938965
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.251 Vali Acc: 0.473 Test Loss: 1.251 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2800664901733398
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.259 Vali Acc: 0.486 Test Loss: 1.259 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2010532
model size : 7.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.38592791557312
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.378 Vali Acc: 0.243 Test Loss: 1.378 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.307433843612671
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.355 Vali Acc: 0.392 Test Loss: 1.355 Test Acc: 0.392
Validation loss decreased (-0.243229 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.4341154098510742
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.329 Vali Acc: 0.473 Test Loss: 1.329 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.187044620513916
Epoch: 4, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.297 Vali Acc: 0.541 Test Loss: 1.297 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 1.6154835224151611
Epoch: 5, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.276 Vali Acc: 0.527 Test Loss: 1.276 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.607252597808838
Epoch: 6, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.250 Vali Acc: 0.514 Test Loss: 1.250 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3984436988830566
Epoch: 7, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.213 Vali Acc: 0.541 Test Loss: 1.213 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 1.504624843597412
Epoch: 8, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3683958053588867
Epoch: 9, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3927216529846191
Epoch: 10, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.133 Vali Acc: 0.554 Test Loss: 1.133 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.3800063133239746
Epoch: 11, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4970474243164062
Epoch: 12, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2358975410461426
Epoch: 13, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.094 Vali Acc: 0.541 Test Loss: 1.094 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2969472408294678
Epoch: 14, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.099 Vali Acc: 0.527 Test Loss: 1.099 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4370834827423096
Epoch: 15, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.344081163406372
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.107 Vali Acc: 0.527 Test Loss: 1.107 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6918091773986816
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 18 cost time: 1.4808244705200195
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5618484020233154
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4256772994995117
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.554394245147705
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4988751411437988
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5008633136749268
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.181 Vali Acc: 0.554 Test Loss: 1.181 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.597992181777954
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.192 Vali Acc: 0.554 Test Loss: 1.192 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5370676517486572
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.206 Vali Acc: 0.568 Test Loss: 1.206 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5045723915100098
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.213 Vali Acc: 0.568 Test Loss: 1.213 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.324333906173706
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.218 Vali Acc: 0.568 Test Loss: 1.218 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2006052
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.669210195541382
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.376 Vali Acc: 0.351 Test Loss: 1.376 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.5934715270996094
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.367 Vali Acc: 0.378 Test Loss: 1.367 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.4959728717803955
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.347 Vali Acc: 0.432 Test Loss: 1.347 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.5337975025177002
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.320 Vali Acc: 0.432 Test Loss: 1.320 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.483445405960083
Epoch: 5, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.304 Vali Acc: 0.419 Test Loss: 1.304 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.183973789215088
Epoch: 6, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.275 Vali Acc: 0.446 Test Loss: 1.275 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.3201613426208496
Epoch: 7, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.255 Vali Acc: 0.459 Test Loss: 1.255 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.425307273864746
Epoch: 8, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4146041870117188
Epoch: 9, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 1.2478175163269043
Epoch: 10, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.5044512748718262
Epoch: 11, Steps: 10 | Train Loss: 0.525 Vali Loss: 1.175 Vali Acc: 0.446 Test Loss: 1.175 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4770393371582031
Epoch: 12, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4935169219970703
Epoch: 13, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.153 Vali Acc: 0.459 Test Loss: 1.153 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4707140922546387
Epoch: 14, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.241058349609375
Epoch: 15, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.312654972076416
Epoch: 16, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1681160926818848
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.289626121520996
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.155972957611084
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3696823120117188
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.237 Vali Acc: 0.486 Test Loss: 1.237 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2529397010803223
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 22 cost time: 1.428438663482666
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.259 Vali Acc: 0.486 Test Loss: 1.259 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3158395290374756
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.291 Vali Acc: 0.473 Test Loss: 1.291 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0718834400177002
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.311 Vali Acc: 0.473 Test Loss: 1.311 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5135385990142822
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 26 cost time: 1.1576995849609375
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.339 Vali Acc: 0.486 Test Loss: 1.339 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2704412937164307
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.350 Vali Acc: 0.486 Test Loss: 1.350 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3154280185699463
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.373 Vali Acc: 0.473 Test Loss: 1.373 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3866338729858398
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.397 Vali Acc: 0.459 Test Loss: 1.397 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4287889003753662
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.417 Vali Acc: 0.459 Test Loss: 1.417 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3881042003631592
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.433 Vali Acc: 0.459 Test Loss: 1.433 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4397706985473633
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.445 Vali Acc: 0.459 Test Loss: 1.445 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1747498512268066
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.448 Vali Acc: 0.459 Test Loss: 1.448 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.463761568069458
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.466 Vali Acc: 0.459 Test Loss: 1.466 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4684360027313232
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.485 Vali Acc: 0.459 Test Loss: 1.485 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2001572
model size : 7.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6535706520080566
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.394 Vali Acc: 0.176 Test Loss: 1.394 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 1.4112184047698975
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.384 Vali Acc: 0.297 Test Loss: 1.384 Test Acc: 0.297
Validation loss decreased (-0.175662 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 1.6143085956573486
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.363 Vali Acc: 0.351 Test Loss: 1.363 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.3393640518188477
Epoch: 4, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.336 Vali Acc: 0.405 Test Loss: 1.336 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.639578104019165
Epoch: 5, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.308 Vali Acc: 0.432 Test Loss: 1.308 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 1.5919599533081055
Epoch: 6, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.3675217628479004
Epoch: 7, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.249 Vali Acc: 0.432 Test Loss: 1.249 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3914051055908203
Epoch: 8, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.218 Vali Acc: 0.514 Test Loss: 1.218 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 1.3310668468475342
Epoch: 9, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.190 Vali Acc: 0.473 Test Loss: 1.190 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1892585754394531
Epoch: 10, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.3585658073425293
Epoch: 11, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4862418174743652
Epoch: 12, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.466392993927002
Epoch: 13, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 1.5051422119140625
Epoch: 14, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5370521545410156
Epoch: 15, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2665081024169922
Epoch: 16, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5702812671661377
Epoch: 17, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4468681812286377
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4528594017028809
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.446605920791626
Epoch: 20, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4951813220977783
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3299989700317383
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.590512990951538
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1997092
model size : 7.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.281896591186523
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 3.12272310256958
Epoch: 2, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.180 Vali Acc: 0.541 Test Loss: 1.180 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540529).  Saving model ...
Epoch: 3 cost time: 3.337993860244751
Epoch: 3, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.573802947998047
Epoch: 4, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.807978391647339
Epoch: 5, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.382 Vali Acc: 0.541 Test Loss: 1.382 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.711036443710327
Epoch: 6, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.551 Vali Acc: 0.541 Test Loss: 1.551 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3060243129730225
Epoch: 7, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.616 Vali Acc: 0.527 Test Loss: 1.616 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3867149353027344
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.613 Vali Acc: 0.486 Test Loss: 1.613 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0044360160827637
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.486 Test Loss: 1.641 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.239384651184082
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.500 Test Loss: 1.676 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.176438093185425
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.541 Test Loss: 1.694 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.183793306350708
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.541 Test Loss: 1.696 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 7461764
model size : 28.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.599473714828491
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.328 Vali Acc: 0.419 Test Loss: 1.328 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 2.300551652908325
Epoch: 2, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 2.376638889312744
Epoch: 3, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 2.410944700241089
Epoch: 4, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.056 Vali Acc: 0.527 Test Loss: 1.056 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0325682163238525
Epoch: 5, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 6 cost time: 2.525683879852295
Epoch: 6, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.081 Vali Acc: 0.527 Test Loss: 1.081 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.336027145385742
Epoch: 7, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4470691680908203
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5374553203582764
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.161 Vali Acc: 0.595 Test Loss: 1.161 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 2.461610794067383
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.175 Vali Acc: 0.595 Test Loss: 1.175 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4682586193084717
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.190 Vali Acc: 0.568 Test Loss: 1.190 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5071380138397217
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.182 Vali Acc: 0.581 Test Loss: 1.182 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1891987323760986
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.284067392349243
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.214 Vali Acc: 0.581 Test Loss: 1.214 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4110190868377686
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.226 Vali Acc: 0.581 Test Loss: 1.226 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1914169788360596
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.047713041305542
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.568 Test Loss: 1.240 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5666615962982178
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.568 Test Loss: 1.240 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.500067949295044
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.568 Test Loss: 1.252 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 7258244
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9887301921844482
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.370 Vali Acc: 0.365 Test Loss: 1.370 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.8061892986297607
Epoch: 2, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.286 Vali Acc: 0.419 Test Loss: 1.286 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.9064383506774902
Epoch: 3, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 2.171971082687378
Epoch: 4, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.121 Vali Acc: 0.459 Test Loss: 1.121 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1161317825317383
Epoch: 5, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.959923267364502
Epoch: 6, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.063 Vali Acc: 0.541 Test Loss: 1.063 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.036287546157837
Epoch: 7, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.929229497909546
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.117 Vali Acc: 0.581 Test Loss: 1.117 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 2.1007139682769775
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.189 Vali Acc: 0.581 Test Loss: 1.189 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1849260330200195
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.071322441101074
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.193 Vali Acc: 0.581 Test Loss: 1.193 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1158533096313477
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.234 Vali Acc: 0.568 Test Loss: 1.234 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0764200687408447
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.236 Vali Acc: 0.554 Test Loss: 1.236 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0124123096466064
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.240 Vali Acc: 0.554 Test Loss: 1.240 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1058666706085205
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.234 Vali Acc: 0.554 Test Loss: 1.234 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0554583072662354
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.248 Vali Acc: 0.554 Test Loss: 1.248 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1156136989593506
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.260 Vali Acc: 0.554 Test Loss: 1.260 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.07194185256958
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 7187844
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.055737257003784
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.368 Vali Acc: 0.338 Test Loss: 1.368 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 2.0003502368927
Epoch: 2, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
Validation loss decreased (-0.337824 --> -0.527014).  Saving model ...
Epoch: 3 cost time: 1.831864595413208
Epoch: 3, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.207 Vali Acc: 0.473 Test Loss: 1.207 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.327416181564331
Epoch: 4, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5643198490142822
Epoch: 5, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.088 Vali Acc: 0.514 Test Loss: 1.088 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4980416297912598
Epoch: 6, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.4587974548339844
Epoch: 7, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7409138679504395
Epoch: 8, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.843109369277954
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.6813766956329346
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.153 Vali Acc: 0.554 Test Loss: 1.153 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7877323627471924
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.182 Vali Acc: 0.554 Test Loss: 1.182 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7757444381713867
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.199 Vali Acc: 0.554 Test Loss: 1.199 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.68206787109375
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.208 Vali Acc: 0.568 Test Loss: 1.208 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9207170009613037
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.228 Vali Acc: 0.568 Test Loss: 1.228 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6941239833831787
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.245 Vali Acc: 0.554 Test Loss: 1.245 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0416181087493896
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.253 Vali Acc: 0.568 Test Loss: 1.253 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9939770698547363
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.259 Vali Acc: 0.568 Test Loss: 1.259 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8111860752105713
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.281 Vali Acc: 0.554 Test Loss: 1.281 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0284383296966553
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.296 Vali Acc: 0.568 Test Loss: 1.296 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 7158404
model size : 27.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.049332618713379
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.385 Vali Acc: 0.284 Test Loss: 1.385 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.9417665004730225
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.311 Vali Acc: 0.392 Test Loss: 1.311 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.9122467041015625
Epoch: 3, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.89306640625
Epoch: 4, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.165 Vali Acc: 0.446 Test Loss: 1.165 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.741480827331543
Epoch: 5, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 1.942786455154419
Epoch: 6, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.075 Vali Acc: 0.527 Test Loss: 1.075 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.016890287399292
Epoch: 7, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7148971557617188
Epoch: 8, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 1.4799408912658691
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.959313154220581
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.749340534210205
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.086 Vali Acc: 0.541 Test Loss: 1.086 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9481775760650635
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.858285665512085
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.022763252258301
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9387173652648926
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.848343849182129
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.982835054397583
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6962049007415771
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.172 Vali Acc: 0.541 Test Loss: 1.172 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 7130244
model size : 27.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.131059169769287
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.390 Vali Acc: 0.311 Test Loss: 1.390 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.8120684623718262
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.330 Vali Acc: 0.459 Test Loss: 1.330 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.902881383895874
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.628021240234375
Epoch: 4, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.188 Vali Acc: 0.541 Test Loss: 1.188 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.8171753883361816
Epoch: 5, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6984083652496338
Epoch: 6, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7276744842529297
Epoch: 7, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.050 Vali Acc: 0.541 Test Loss: 1.050 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.733349323272705
Epoch: 8, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.027 Vali Acc: 0.554 Test Loss: 1.027 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 2.0031797885894775
Epoch: 9, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.995 Vali Acc: 0.581 Test Loss: 0.995 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.8177454471588135
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.034 Vali Acc: 0.568 Test Loss: 1.034 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9563581943511963
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.027 Vali Acc: 0.554 Test Loss: 1.027 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0044357776641846
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.058 Vali Acc: 0.554 Test Loss: 1.058 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7670361995697021
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.925079584121704
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8240270614624023
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9535460472106934
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.115 Vali Acc: 0.568 Test Loss: 1.115 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9032158851623535
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.135 Vali Acc: 0.568 Test Loss: 1.135 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9140470027923584
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9732444286346436
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 7112324
model size : 27.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9667677879333496
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.6664395332336426
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.58720064163208
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.264 Vali Acc: 0.392 Test Loss: 1.264 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.5875840187072754
Epoch: 4, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.52413010597229
Epoch: 5, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.6832563877105713
Epoch: 6, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.93202543258667
Epoch: 7, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 1.929023027420044
Epoch: 8, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 1.7587475776672363
Epoch: 9, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7730484008789062
Epoch: 10, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.072 Vali Acc: 0.486 Test Loss: 1.072 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7637865543365479
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6580820083618164
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.801058053970337
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.743114948272705
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8347837924957275
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.171 Vali Acc: 0.527 Test Loss: 1.171 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8452467918395996
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.201 Vali Acc: 0.554 Test Loss: 1.201 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 17 cost time: 1.55332612991333
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.209 Vali Acc: 0.514 Test Loss: 1.209 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4334893226623535
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6752464771270752
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5270185470581055
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.255 Vali Acc: 0.527 Test Loss: 1.255 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7248873710632324
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.266 Vali Acc: 0.514 Test Loss: 1.266 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7991609573364258
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.274 Vali Acc: 0.514 Test Loss: 1.274 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9373693466186523
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.290 Vali Acc: 0.527 Test Loss: 1.290 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8706591129302979
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7613070011138916
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.312 Vali Acc: 0.514 Test Loss: 1.312 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9146397113800049
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.323 Vali Acc: 0.514 Test Loss: 1.323 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 7104644
model size : 27.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2668306827545166
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.372 Vali Acc: 0.324 Test Loss: 1.372 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.022198438644409
Epoch: 2, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.276 Vali Acc: 0.419 Test Loss: 1.276 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 2.1751253604888916
Epoch: 3, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 2.351109027862549
Epoch: 4, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 2.168302297592163
Epoch: 5, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1717777252197266
Epoch: 6, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.223991632461548
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.201 Vali Acc: 0.541 Test Loss: 1.201 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 2.089186429977417
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2611353397369385
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.261 Vali Acc: 0.554 Test Loss: 1.261 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 2.2086362838745117
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.291 Vali Acc: 0.554 Test Loss: 1.291 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0699079036712646
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.312 Vali Acc: 0.581 Test Loss: 1.312 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581068).  Saving model ...
Epoch: 12 cost time: 1.92189359664917
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.568 Test Loss: 1.321 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7955186367034912
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.328 Vali Acc: 0.554 Test Loss: 1.328 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.961939811706543
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.554 Test Loss: 1.343 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5957071781158447
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.554 Test Loss: 1.348 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8234665393829346
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.568 Test Loss: 1.359 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5553436279296875
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.581 Test Loss: 1.371 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8198425769805908
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.378 Vali Acc: 0.541 Test Loss: 1.378 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.844681978225708
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.389 Vali Acc: 0.541 Test Loss: 1.389 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9843566417694092
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.554 Test Loss: 1.397 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.157289743423462
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.554 Test Loss: 1.406 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2076100
model size : 7.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7892889976501465
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.376 Vali Acc: 0.311 Test Loss: 1.376 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.5881338119506836
Epoch: 2, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.317 Vali Acc: 0.378 Test Loss: 1.317 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.4679479598999023
Epoch: 3, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.4532859325408936
Epoch: 4, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.178 Vali Acc: 0.419 Test Loss: 1.178 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6029143333435059
Epoch: 5, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.4576921463012695
Epoch: 6, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.5265781879425049
Epoch: 7, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.053 Vali Acc: 0.527 Test Loss: 1.053 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.500828504562378
Epoch: 8, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.062 Vali Acc: 0.527 Test Loss: 1.062 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.495131254196167
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.058 Vali Acc: 0.541 Test Loss: 1.058 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6239256858825684
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.097 Vali Acc: 0.568 Test Loss: 1.097 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 1.4787771701812744
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4786865711212158
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.108 Vali Acc: 0.568 Test Loss: 1.108 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3686821460723877
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 1.5732150077819824
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.499086856842041
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4093427658081055
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3861150741577148
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.170 Vali Acc: 0.541 Test Loss: 1.170 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4664669036865234
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5104775428771973
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2757103443145752
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.205 Vali Acc: 0.554 Test Loss: 1.205 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4460840225219727
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3680319786071777
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.216 Vali Acc: 0.541 Test Loss: 1.216 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6670174598693848
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1974340
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6487395763397217
Epoch: 1, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.367 Vali Acc: 0.324 Test Loss: 1.367 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.4935564994812012
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.321 Vali Acc: 0.432 Test Loss: 1.321 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.399709701538086
Epoch: 3, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.263 Vali Acc: 0.419 Test Loss: 1.263 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3617548942565918
Epoch: 4, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.200 Vali Acc: 0.446 Test Loss: 1.200 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.2175023555755615
Epoch: 5, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.3587379455566406
Epoch: 6, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.3676025867462158
Epoch: 7, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.1832473278045654
Epoch: 8, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.056 Vali Acc: 0.527 Test Loss: 1.056 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5174334049224854
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4612882137298584
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.093 Vali Acc: 0.527 Test Loss: 1.093 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3626232147216797
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.18375563621521
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3587629795074463
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3412704467773438
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5591485500335693
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2113962173461914
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.175 Vali Acc: 0.554 Test Loss: 1.175 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6313462257385254
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.185 Vali Acc: 0.554 Test Loss: 1.185 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1939140
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.228651285171509
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.385 Vali Acc: 0.230 Test Loss: 1.385 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.2154653072357178
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.346 Vali Acc: 0.311 Test Loss: 1.346 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.477982759475708
Epoch: 3, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.293 Vali Acc: 0.432 Test Loss: 1.293 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.3307647705078125
Epoch: 4, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.2444169521331787
Epoch: 5, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.4374120235443115
Epoch: 6, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.4221796989440918
Epoch: 7, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.4383742809295654
Epoch: 8, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.2799813747406006
Epoch: 9, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.090 Vali Acc: 0.514 Test Loss: 1.090 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4450113773345947
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.092 Vali Acc: 0.514 Test Loss: 1.092 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4144420623779297
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 1.3843388557434082
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2167537212371826
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.381659746170044
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 1.4139013290405273
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3546137809753418
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.166 Vali Acc: 0.527 Test Loss: 1.166 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2977948188781738
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4175407886505127
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.182 Vali Acc: 0.541 Test Loss: 1.182 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4239463806152344
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4534451961517334
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.333162546157837
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4962475299835205
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.214 Vali Acc: 0.541 Test Loss: 1.214 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3329896926879883
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4025235176086426
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.247 Vali Acc: 0.541 Test Loss: 1.247 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1924420
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7103707790374756
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.3180620670318604
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.349 Vali Acc: 0.351 Test Loss: 1.349 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.2932782173156738
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.295 Vali Acc: 0.446 Test Loss: 1.295 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.1823019981384277
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.0686898231506348
Epoch: 5, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7956268787384033
Epoch: 6, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.9801380634307861
Epoch: 7, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.0307657718658447
Epoch: 8, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.045 Vali Acc: 0.568 Test Loss: 1.045 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.7374868392944336
Epoch: 9, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.020 Vali Acc: 0.595 Test Loss: 1.020 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 0.9551899433135986
Epoch: 10, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 11 cost time: 1.0182015895843506
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 1.1314005851745605
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.972 Vali Acc: 0.622 Test Loss: 0.972 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 13 cost time: 1.1522610187530518
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.993 Vali Acc: 0.622 Test Loss: 0.993 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0986723899841309
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2994294166564941
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.008 Vali Acc: 0.635 Test Loss: 1.008 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 16 cost time: 1.326195240020752
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.005 Vali Acc: 0.635 Test Loss: 1.005 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 1.050363302230835
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 18 cost time: 1.2775068283081055
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3623692989349365
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.048 Vali Acc: 0.635 Test Loss: 1.048 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2577340602874756
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.068 Vali Acc: 0.635 Test Loss: 1.068 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.364969253540039
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.061 Vali Acc: 0.622 Test Loss: 1.061 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.273862600326538
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.074 Vali Acc: 0.622 Test Loss: 1.074 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2909770011901855
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.082 Vali Acc: 0.635 Test Loss: 1.082 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2141704559326172
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.102 Vali Acc: 0.649 Test Loss: 1.102 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2246544361114502
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.112 Vali Acc: 0.635 Test Loss: 1.112 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3515269756317139
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.123 Vali Acc: 0.622 Test Loss: 1.123 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.162797212600708
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.135 Vali Acc: 0.635 Test Loss: 1.135 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1910340
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6261813640594482
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.378 Vali Acc: 0.284 Test Loss: 1.378 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.2990317344665527
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.350 Vali Acc: 0.338 Test Loss: 1.350 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.245222806930542
Epoch: 3, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.310 Vali Acc: 0.473 Test Loss: 1.310 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.1821417808532715
Epoch: 4, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.2797174453735352
Epoch: 5, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.157688856124878
Epoch: 6, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.180 Vali Acc: 0.541 Test Loss: 1.180 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.138089895248413
Epoch: 7, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2694165706634521
Epoch: 8, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.121 Vali Acc: 0.514 Test Loss: 1.121 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.260873794555664
Epoch: 9, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.0796868801116943
Epoch: 10, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2387840747833252
Epoch: 11, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2331862449645996
Epoch: 12, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.062 Vali Acc: 0.527 Test Loss: 1.062 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1192755699157715
Epoch: 13, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.068 Vali Acc: 0.541 Test Loss: 1.068 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 14 cost time: 1.2510697841644287
Epoch: 14, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.073 Vali Acc: 0.514 Test Loss: 1.073 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3013536930084229
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.092 Vali Acc: 0.514 Test Loss: 1.092 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2221097946166992
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0831575393676758
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0740764141082764
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1224915981292725
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0408329963684082
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0499515533447266
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1063165664672852
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.165 Vali Acc: 0.541 Test Loss: 1.165 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1672863960266113
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1901380
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5190131664276123
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.2793986797332764
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.267118215560913
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.327 Vali Acc: 0.378 Test Loss: 1.327 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.169834852218628
Epoch: 4, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.291 Vali Acc: 0.486 Test Loss: 1.291 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.2493667602539062
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.3100993633270264
Epoch: 6, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.222 Vali Acc: 0.527 Test Loss: 1.222 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.2856419086456299
Epoch: 7, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1593117713928223
Epoch: 8, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.3139433860778809
Epoch: 9, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.118 Vali Acc: 0.527 Test Loss: 1.118 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.3044753074645996
Epoch: 10, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.106 Vali Acc: 0.527 Test Loss: 1.106 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.990302562713623
Epoch: 11, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1216838359832764
Epoch: 12, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.0438966751098633
Epoch: 13, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8965964317321777
Epoch: 14, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0703129768371582
Epoch: 15, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9467482566833496
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1907992362976074
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1602182388305664
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.183 Vali Acc: 0.527 Test Loss: 1.183 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.022871971130371
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4720194339752197
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.253772497177124
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3242616653442383
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1897540
model size : 7.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.630331516265869
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0365657806396484
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.327 Vali Acc: 0.351 Test Loss: 1.327 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.6958165168762207
Epoch: 3, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.271 Vali Acc: 0.378 Test Loss: 1.271 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 1.518481731414795
Epoch: 4, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.208 Vali Acc: 0.459 Test Loss: 1.208 Test Acc: 0.459
Validation loss decreased (-0.378366 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.4954743385314941
Epoch: 5, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.6664149761199951
Epoch: 6, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.4111783504486084
Epoch: 7, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.6631662845611572
Epoch: 8, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.6317360401153564
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.135 Vali Acc: 0.568 Test Loss: 1.135 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4406177997589111
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6112561225891113
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.591771125793457
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.213 Vali Acc: 0.581 Test Loss: 1.213 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3992695808410645
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6716067790985107
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.247 Vali Acc: 0.554 Test Loss: 1.247 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6840167045593262
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.255 Vali Acc: 0.581 Test Loss: 1.255 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3985981941223145
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.276 Vali Acc: 0.568 Test Loss: 1.276 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6367568969726562
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.672696590423584
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.304 Vali Acc: 0.541 Test Loss: 1.304 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 624356
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4928171634674072
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.355 Vali Acc: 0.297 Test Loss: 1.355 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.0416784286499023
Epoch: 2, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.303 Vali Acc: 0.459 Test Loss: 1.303 Test Acc: 0.459
Validation loss decreased (-0.297284 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.9973623752593994
Epoch: 3, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.245 Vali Acc: 0.554 Test Loss: 1.245 Test Acc: 0.554
Validation loss decreased (-0.459446 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 1.11783766746521
Epoch: 4, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.190 Vali Acc: 0.581 Test Loss: 1.190 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 5 cost time: 1.0501108169555664
Epoch: 5, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0855298042297363
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 1.1414730548858643
Epoch: 7, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3232908248901367
Epoch: 8, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.039 Vali Acc: 0.568 Test Loss: 1.039 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2515709400177002
Epoch: 9, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.010 Vali Acc: 0.595 Test Loss: 1.010 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.220266342163086
Epoch: 10, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.023 Vali Acc: 0.581 Test Loss: 1.023 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3887956142425537
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.005 Vali Acc: 0.568 Test Loss: 1.005 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2235617637634277
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.021 Vali Acc: 0.595 Test Loss: 1.021 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2288343906402588
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.009 Vali Acc: 0.581 Test Loss: 1.009 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1696696281433105
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3986971378326416
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.039 Vali Acc: 0.595 Test Loss: 1.039 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3182017803192139
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.050 Vali Acc: 0.595 Test Loss: 1.050 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1764543056488037
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.052 Vali Acc: 0.595 Test Loss: 1.052 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2664682865142822
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.271569013595581
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.066 Vali Acc: 0.595 Test Loss: 1.066 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 573476
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.448301315307617
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.374 Vali Acc: 0.311 Test Loss: 1.374 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.141608715057373
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.355 Vali Acc: 0.338 Test Loss: 1.355 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.1785640716552734
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.321 Vali Acc: 0.419 Test Loss: 1.321 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.2814717292785645
Epoch: 4, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.147995948791504
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.252 Vali Acc: 0.459 Test Loss: 1.252 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.235694408416748
Epoch: 6, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.2674973011016846
Epoch: 7, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.176 Vali Acc: 0.446 Test Loss: 1.176 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9986667633056641
Epoch: 8, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.2373168468475342
Epoch: 9, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.1749484539031982
Epoch: 10, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.1105170249938965
Epoch: 11, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.147751808166504
Epoch: 12, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 0.9235782623291016
Epoch: 13, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0917744636535645
Epoch: 14, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.119 Vali Acc: 0.554 Test Loss: 1.119 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1368675231933594
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.124 Vali Acc: 0.581 Test Loss: 1.124 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0165352821350098
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.137 Vali Acc: 0.568 Test Loss: 1.137 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3475148677825928
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.143 Vali Acc: 0.581 Test Loss: 1.143 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3482296466827393
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.271772861480713
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.195 Vali Acc: 0.568 Test Loss: 1.195 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3828251361846924
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.176 Vali Acc: 0.568 Test Loss: 1.176 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4524798393249512
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.185 Vali Acc: 0.568 Test Loss: 1.185 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2603826522827148
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.217 Vali Acc: 0.554 Test Loss: 1.217 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 555876
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4378035068511963
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.385 Vali Acc: 0.230 Test Loss: 1.385 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.2931172847747803
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.367 Vali Acc: 0.270 Test Loss: 1.367 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 1.2646327018737793
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.345 Vali Acc: 0.351 Test Loss: 1.345 Test Acc: 0.351
Validation loss decreased (-0.270257 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.1931982040405273
Epoch: 4, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.314 Vali Acc: 0.365 Test Loss: 1.314 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.1093363761901855
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.274 Vali Acc: 0.405 Test Loss: 1.274 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 1.1727473735809326
Epoch: 6, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.230 Vali Acc: 0.514 Test Loss: 1.230 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.0466492176055908
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.203 Vali Acc: 0.473 Test Loss: 1.203 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1414241790771484
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0943591594696045
Epoch: 9, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1242995262145996
Epoch: 10, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.088 Vali Acc: 0.541 Test Loss: 1.088 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.3023698329925537
Epoch: 11, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 1.3078274726867676
Epoch: 12, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.070343017578125
Epoch: 13, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.052 Vali Acc: 0.554 Test Loss: 1.052 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.295940637588501
Epoch: 14, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.039 Vali Acc: 0.568 Test Loss: 1.039 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 1.230837345123291
Epoch: 15, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.036 Vali Acc: 0.554 Test Loss: 1.036 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0706443786621094
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.032 Vali Acc: 0.554 Test Loss: 1.032 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1808452606201172
Epoch: 17, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.026 Vali Acc: 0.568 Test Loss: 1.026 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 18 cost time: 1.2061903476715088
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.032 Vali Acc: 0.568 Test Loss: 1.032 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1500470638275146
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.041 Vali Acc: 0.581 Test Loss: 1.041 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 20 cost time: 0.8696856498718262
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 21 cost time: 1.2036418914794922
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.055 Vali Acc: 0.595 Test Loss: 1.055 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1866648197174072
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1731204986572266
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3296911716461182
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.390204668045044
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.077 Vali Acc: 0.595 Test Loss: 1.077 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2069218158721924
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4453234672546387
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.106 Vali Acc: 0.595 Test Loss: 1.106 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3343579769134521
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.104 Vali Acc: 0.595 Test Loss: 1.104 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.445021629333496
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.115 Vali Acc: 0.595 Test Loss: 1.115 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4180450439453125
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.116 Vali Acc: 0.595 Test Loss: 1.116 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 548516
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.467735767364502
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.406 Vali Acc: 0.230 Test Loss: 1.406 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.180877923965454
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.2497782707214355
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.370 Vali Acc: 0.324 Test Loss: 1.370 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.311119794845581
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.345 Vali Acc: 0.405 Test Loss: 1.345 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.179231882095337
Epoch: 5, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.317 Vali Acc: 0.486 Test Loss: 1.317 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486473).  Saving model ...
Epoch: 6 cost time: 1.2254738807678223
Epoch: 6, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.3395426273345947
Epoch: 7, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.261 Vali Acc: 0.514 Test Loss: 1.261 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.187657356262207
Epoch: 8, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.3298578262329102
Epoch: 9, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 1.3054101467132568
Epoch: 10, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1680800914764404
Epoch: 11, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3291146755218506
Epoch: 12, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.125 Vali Acc: 0.527 Test Loss: 1.125 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.2627592086791992
Epoch: 13, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.1698894500732422
Epoch: 14, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 1.073718547821045
Epoch: 15, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 16 cost time: 1.1316180229187012
Epoch: 16, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 17 cost time: 1.1104698181152344
Epoch: 17, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0132720470428467
Epoch: 18, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.115 Vali Acc: 0.568 Test Loss: 1.115 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 19 cost time: 1.0551297664642334
Epoch: 19, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0889532566070557
Epoch: 20, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1556568145751953
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2409517765045166
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0080206394195557
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.168 Vali Acc: 0.554 Test Loss: 1.168 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1344516277313232
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.176 Vali Acc: 0.568 Test Loss: 1.176 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1399853229522705
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.186 Vali Acc: 0.568 Test Loss: 1.186 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0443589687347412
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.193 Vali Acc: 0.554 Test Loss: 1.193 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2311203479766846
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.200 Vali Acc: 0.568 Test Loss: 1.200 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.274749755859375
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.223 Vali Acc: 0.568 Test Loss: 1.223 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 541476
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.513482093811035
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0795562267303467
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 1.1491646766662598
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.385 Vali Acc: 0.270 Test Loss: 1.385 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2987990379333496
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.362 Vali Acc: 0.324 Test Loss: 1.362 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 0.9764869213104248
Epoch: 5, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.336 Vali Acc: 0.351 Test Loss: 1.336 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.165776014328003
Epoch: 6, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.321 Vali Acc: 0.351 Test Loss: 1.321 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 7 cost time: 1.2175779342651367
Epoch: 7, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.300 Vali Acc: 0.378 Test Loss: 1.300 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 8 cost time: 1.1408939361572266
Epoch: 8, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.287 Vali Acc: 0.419 Test Loss: 1.287 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 9 cost time: 1.1593303680419922
Epoch: 9, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.277 Vali Acc: 0.405 Test Loss: 1.277 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3323373794555664
Epoch: 10, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 11 cost time: 1.2063519954681396
Epoch: 11, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 12 cost time: 1.1138639450073242
Epoch: 12, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 13 cost time: 1.3258612155914307
Epoch: 13, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.1979353427886963
Epoch: 14, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1629419326782227
Epoch: 15, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.198 Vali Acc: 0.446 Test Loss: 1.198 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9802496433258057
Epoch: 16, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.164046049118042
Epoch: 17, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.181 Vali Acc: 0.432 Test Loss: 1.181 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3706114292144775
Epoch: 18, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.175 Vali Acc: 0.459 Test Loss: 1.175 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1426630020141602
Epoch: 19, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.188 Vali Acc: 0.446 Test Loss: 1.188 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3003966808319092
Epoch: 20, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.177 Vali Acc: 0.473 Test Loss: 1.177 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2514233589172363
Epoch: 21, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1446478366851807
Epoch: 22, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3068156242370605
Epoch: 23, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 536996
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6052322387695312
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.390 Vali Acc: 0.338 Test Loss: 1.390 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0134005546569824
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.381 Vali Acc: 0.351 Test Loss: 1.381 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.9721720218658447
Epoch: 3, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.365 Vali Acc: 0.351 Test Loss: 1.365 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.1217563152313232
Epoch: 4, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.344 Vali Acc: 0.365 Test Loss: 1.344 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.054771900177002
Epoch: 5, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.321 Vali Acc: 0.419 Test Loss: 1.321 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.9961185455322266
Epoch: 6, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.297 Vali Acc: 0.446 Test Loss: 1.297 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.1024093627929688
Epoch: 7, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1449244022369385
Epoch: 8, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.249 Vali Acc: 0.432 Test Loss: 1.249 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0860471725463867
Epoch: 9, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.229 Vali Acc: 0.459 Test Loss: 1.229 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 1.1912767887115479
Epoch: 10, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.204 Vali Acc: 0.432 Test Loss: 1.204 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.152205467224121
Epoch: 11, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.178 Vali Acc: 0.459 Test Loss: 1.178 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 12 cost time: 1.177812099456787
Epoch: 12, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 1.2393114566802979
Epoch: 13, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.156 Vali Acc: 0.459 Test Loss: 1.156 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1012825965881348
Epoch: 14, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.141 Vali Acc: 0.473 Test Loss: 1.141 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0600898265838623
Epoch: 15, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.135 Vali Acc: 0.473 Test Loss: 1.135 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2195274829864502
Epoch: 16, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.140 Vali Acc: 0.446 Test Loss: 1.140 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.177398681640625
Epoch: 17, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.132 Vali Acc: 0.473 Test Loss: 1.132 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2204771041870117
Epoch: 18, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.131 Vali Acc: 0.473 Test Loss: 1.131 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0492973327636719
Epoch: 19, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.144 Vali Acc: 0.473 Test Loss: 1.144 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9661531448364258
Epoch: 20, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.163 Vali Acc: 0.459 Test Loss: 1.163 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1218290328979492
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.155 Vali Acc: 0.473 Test Loss: 1.155 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1758768558502197
Epoch: 22, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 535076
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.703815460205078
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.337 Vali Acc: 0.338 Test Loss: 1.337 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 3.654249668121338
Epoch: 2, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 4.0705718994140625
Epoch: 3, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.146 Vali Acc: 0.486 Test Loss: 1.146 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 4.218486547470093
Epoch: 4, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.176 Vali Acc: 0.459 Test Loss: 1.176 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.837127208709717
Epoch: 5, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.300 Vali Acc: 0.554 Test Loss: 1.300 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554041).  Saving model ...
Epoch: 6 cost time: 3.815865993499756
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.487 Vali Acc: 0.527 Test Loss: 1.487 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8682446479797363
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.514 Test Loss: 1.551 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.67793869972229
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.500 Test Loss: 1.578 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.760406732559204
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.596 Vali Acc: 0.500 Test Loss: 1.596 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.223139524459839
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.614 Vali Acc: 0.500 Test Loss: 1.614 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.09189248085022
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.500 Test Loss: 1.621 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9220213890075684
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.527 Test Loss: 1.630 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.9890077114105225
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.527 Test Loss: 1.635 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.049389123916626
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.541 Test Loss: 1.636 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.131718873977661
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.527 Test Loss: 1.639 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 7446404
model size : 28.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.54905366897583
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.317 Vali Acc: 0.405 Test Loss: 1.317 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 2.5208628177642822
Epoch: 2, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513501).  Saving model ...
Epoch: 3 cost time: 2.474431037902832
Epoch: 3, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5044569969177246
Epoch: 4, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.052 Vali Acc: 0.581 Test Loss: 1.052 Test Acc: 0.581
Validation loss decreased (-0.513501 --> -0.581071).  Saving model ...
Epoch: 5 cost time: 2.2134552001953125
Epoch: 5, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.065 Vali Acc: 0.581 Test Loss: 1.065 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.282193422317505
Epoch: 6, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2819647789001465
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.597961902618408
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.14336895942688
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5155792236328125
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.204 Vali Acc: 0.514 Test Loss: 1.204 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.098231315612793
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.214 Vali Acc: 0.527 Test Loss: 1.214 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3402867317199707
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.228 Vali Acc: 0.514 Test Loss: 1.228 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3190951347351074
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.39806866645813
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.514 Test Loss: 1.254 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 7242884
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.389617443084717
Epoch: 1, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.3924601078033447
Epoch: 2, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.253 Vali Acc: 0.473 Test Loss: 1.253 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 2.403045177459717
Epoch: 3, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.2955987453460693
Epoch: 4, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 2.430668830871582
Epoch: 5, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.076 Vali Acc: 0.486 Test Loss: 1.076 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486476).  Saving model ...
Epoch: 6 cost time: 2.214785099029541
Epoch: 6, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.049 Vali Acc: 0.554 Test Loss: 1.049 Test Acc: 0.554
Validation loss decreased (-0.486476 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 2.051146984100342
Epoch: 7, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 2.0617337226867676
Epoch: 8, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9256746768951416
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.299 Vali Acc: 0.541 Test Loss: 1.299 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.241090774536133
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.372746706008911
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.257100820541382
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.230 Vali Acc: 0.568 Test Loss: 1.230 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2404608726501465
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.292417049407959
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.267 Vali Acc: 0.568 Test Loss: 1.267 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2778186798095703
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.263 Vali Acc: 0.568 Test Loss: 1.263 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.352210521697998
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.283 Vali Acc: 0.568 Test Loss: 1.283 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0201668739318848
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.581 Test Loss: 1.291 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581068).  Saving model ...
Epoch: 18 cost time: 2.275127410888672
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.296 Vali Acc: 0.568 Test Loss: 1.296 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1076295375823975
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.304 Vali Acc: 0.568 Test Loss: 1.304 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1724324226379395
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.568 Test Loss: 1.317 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9204716682434082
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.568 Test Loss: 1.332 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2498836517333984
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.568 Test Loss: 1.328 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2898268699645996
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.335 Vali Acc: 0.568 Test Loss: 1.335 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2819056510925293
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.568 Test Loss: 1.345 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.300964593887329
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.362 Vali Acc: 0.568 Test Loss: 1.362 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2196238040924072
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.370 Vali Acc: 0.568 Test Loss: 1.370 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4719223976135254
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.568 Test Loss: 1.368 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 7172484
model size : 27.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.253504991531372
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.390 Vali Acc: 0.203 Test Loss: 1.390 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.8813812732696533
Epoch: 2, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.300 Vali Acc: 0.432 Test Loss: 1.300 Test Acc: 0.432
Validation loss decreased (-0.202689 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.9916582107543945
Epoch: 3, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.222 Vali Acc: 0.473 Test Loss: 1.222 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.999094009399414
Epoch: 4, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.957808017730713
Epoch: 5, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 2.151618242263794
Epoch: 6, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 2.0634703636169434
Epoch: 7, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.123 Vali Acc: 0.568 Test Loss: 1.123 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 2.121990203857422
Epoch: 8, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.172 Vali Acc: 0.581 Test Loss: 1.172 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 2.195979118347168
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.170 Vali Acc: 0.595 Test Loss: 1.170 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 1.9205329418182373
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.217 Vali Acc: 0.568 Test Loss: 1.217 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2266898155212402
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.225 Vali Acc: 0.581 Test Loss: 1.225 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1757731437683105
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.236 Vali Acc: 0.568 Test Loss: 1.236 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.843238353729248
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.258 Vali Acc: 0.568 Test Loss: 1.258 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7619550228118896
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.285 Vali Acc: 0.568 Test Loss: 1.285 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6955366134643555
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.307 Vali Acc: 0.568 Test Loss: 1.307 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7365927696228027
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.306 Vali Acc: 0.568 Test Loss: 1.306 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.061507225036621
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.316 Vali Acc: 0.568 Test Loss: 1.316 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1097843647003174
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.331 Vali Acc: 0.568 Test Loss: 1.331 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1558892726898193
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 7143044
model size : 27.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.254866361618042
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.371 Vali Acc: 0.351 Test Loss: 1.371 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.8962464332580566
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.9960546493530273
Epoch: 3, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.204 Vali Acc: 0.486 Test Loss: 1.204 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.1600818634033203
Epoch: 4, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.162 Vali Acc: 0.459 Test Loss: 1.162 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.899723768234253
Epoch: 5, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.097 Vali Acc: 0.473 Test Loss: 1.097 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.04355788230896
Epoch: 6, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.970339298248291
Epoch: 7, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.9496619701385498
Epoch: 8, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.022 Vali Acc: 0.568 Test Loss: 1.022 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.9932477474212646
Epoch: 9, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.034 Vali Acc: 0.541 Test Loss: 1.034 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9536120891571045
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.055 Vali Acc: 0.581 Test Loss: 1.055 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 2.056441068649292
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.056 Vali Acc: 0.595 Test Loss: 1.056 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 2.042083978652954
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9083566665649414
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.094 Vali Acc: 0.581 Test Loss: 1.094 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.077263832092285
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.12376070022583
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8306593894958496
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0475385189056396
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.144 Vali Acc: 0.581 Test Loss: 1.144 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7932097911834717
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7766530513763428
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.165 Vali Acc: 0.581 Test Loss: 1.165 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.882408618927002
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.175 Vali Acc: 0.595 Test Loss: 1.175 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8836867809295654
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.185 Vali Acc: 0.568 Test Loss: 1.185 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 7114884
model size : 27.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.70121169090271
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.9440526962280273
Epoch: 2, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.319 Vali Acc: 0.459 Test Loss: 1.319 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.8162670135498047
Epoch: 3, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.784630298614502
Epoch: 4, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.7550675868988037
Epoch: 5, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.71586275100708
Epoch: 6, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.049 Vali Acc: 0.595 Test Loss: 1.049 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 1.941486120223999
Epoch: 7, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.008 Vali Acc: 0.581 Test Loss: 1.008 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.992051601409912
Epoch: 8, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.995 Vali Acc: 0.608 Test Loss: 0.995 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 2.0528833866119385
Epoch: 9, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 1.8394215106964111
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.043074607849121
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.022 Vali Acc: 0.608 Test Loss: 1.022 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9164314270019531
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 1.9472055435180664
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.038 Vali Acc: 0.608 Test Loss: 1.038 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8691880702972412
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.071 Vali Acc: 0.608 Test Loss: 1.071 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8555288314819336
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0065510272979736
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.088 Vali Acc: 0.608 Test Loss: 1.088 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8847002983093262
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.097 Vali Acc: 0.595 Test Loss: 1.097 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8696129322052002
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9347333908081055
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.130 Vali Acc: 0.595 Test Loss: 1.130 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7312955856323242
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.135 Vali Acc: 0.608 Test Loss: 1.135 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9480526447296143
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.146 Vali Acc: 0.622 Test Loss: 1.146 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4998300075531006
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.151 Vali Acc: 0.608 Test Loss: 1.151 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 7096964
model size : 27.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2373197078704834
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.890723466873169
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.344 Vali Acc: 0.351 Test Loss: 1.344 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.9830026626586914
Epoch: 3, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.821814775466919
Epoch: 4, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.202 Vali Acc: 0.459 Test Loss: 1.202 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.8353300094604492
Epoch: 5, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.150 Vali Acc: 0.459 Test Loss: 1.150 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.8346681594848633
Epoch: 6, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.9876482486724854
Epoch: 7, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.068 Vali Acc: 0.514 Test Loss: 1.068 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 1.9571478366851807
Epoch: 8, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.044 Vali Acc: 0.554 Test Loss: 1.044 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 1.984626054763794
Epoch: 9, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.045 Vali Acc: 0.514 Test Loss: 1.045 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8387622833251953
Epoch: 10, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.044 Vali Acc: 0.554 Test Loss: 1.044 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 11 cost time: 2.032872438430786
Epoch: 11, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.049 Vali Acc: 0.554 Test Loss: 1.049 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7078630924224854
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.999016284942627
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8975632190704346
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0060083866119385
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.932140588760376
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9230880737304688
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.160 Vali Acc: 0.554 Test Loss: 1.160 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9547536373138428
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.849482536315918
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6801271438598633
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 7089284
model size : 27.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.309774398803711
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.370 Vali Acc: 0.257 Test Loss: 1.370 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.2723121643066406
Epoch: 2, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.283 Vali Acc: 0.419 Test Loss: 1.283 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 2.0179953575134277
Epoch: 3, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.179 Vali Acc: 0.446 Test Loss: 1.179 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.7054905891418457
Epoch: 4, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 1.7520346641540527
Epoch: 5, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.7486121654510498
Epoch: 6, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.171 Vali Acc: 0.527 Test Loss: 1.171 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.790271282196045
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.247 Vali Acc: 0.514 Test Loss: 1.247 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.305685520172119
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.308 Vali Acc: 0.554 Test Loss: 1.308 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554041).  Saving model ...
Epoch: 9 cost time: 2.3651323318481445
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.375 Vali Acc: 0.541 Test Loss: 1.375 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3123905658721924
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.371 Vali Acc: 0.554 Test Loss: 1.371 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2579030990600586
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.360 Vali Acc: 0.514 Test Loss: 1.360 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.400951385498047
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2193408012390137
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.393343448638916
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.541 Test Loss: 1.400 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3991706371307373
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.541 Test Loss: 1.404 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2088358402252197
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.541 Test Loss: 1.412 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3170783519744873
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.541 Test Loss: 1.416 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3417270183563232
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.541 Test Loss: 1.425 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2068420
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6765308380126953
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.379 Vali Acc: 0.311 Test Loss: 1.379 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.5734763145446777
Epoch: 2, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.5941588878631592
Epoch: 3, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.245 Vali Acc: 0.486 Test Loss: 1.245 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.604478359222412
Epoch: 4, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.712019920349121
Epoch: 5, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.539224624633789
Epoch: 6, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.4536612033843994
Epoch: 7, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.3728852272033691
Epoch: 8, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3199069499969482
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3773293495178223
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3853635787963867
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5143871307373047
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.531430721282959
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.159 Vali Acc: 0.527 Test Loss: 1.159 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.536468744277954
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6774184703826904
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.191 Vali Acc: 0.568 Test Loss: 1.191 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5565311908721924
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7190470695495605
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1966660
model size : 7.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.707094430923462
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.353 Vali Acc: 0.405 Test Loss: 1.353 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.6241271495819092
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.302 Vali Acc: 0.486 Test Loss: 1.302 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486473).  Saving model ...
Epoch: 3 cost time: 1.5401005744934082
Epoch: 3, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.243 Vali Acc: 0.527 Test Loss: 1.243 Test Acc: 0.527
Validation loss decreased (-0.486473 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 1.5963568687438965
Epoch: 4, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.472069263458252
Epoch: 5, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.117 Vali Acc: 0.581 Test Loss: 1.117 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 1.6047606468200684
Epoch: 6, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4526760578155518
Epoch: 7, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.081 Vali Acc: 0.527 Test Loss: 1.081 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5307526588439941
Epoch: 8, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.038 Vali Acc: 0.527 Test Loss: 1.038 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4124202728271484
Epoch: 9, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.052 Vali Acc: 0.541 Test Loss: 1.052 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5294184684753418
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 1.1720378398895264
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2326953411102295
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3934743404388428
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1248652935028076
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.125 Vali Acc: 0.541 Test Loss: 1.125 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3127872943878174
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.16269850730896
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5568931102752686
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.167 Vali Acc: 0.554 Test Loss: 1.167 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.398181438446045
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.549100399017334
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.414405107498169
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1931460
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.412760019302368
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.396 Vali Acc: 0.189 Test Loss: 1.396 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.3019673824310303
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.351 Vali Acc: 0.324 Test Loss: 1.351 Test Acc: 0.324
Validation loss decreased (-0.189175 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.2253146171569824
Epoch: 3, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.2985713481903076
Epoch: 4, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.251 Vali Acc: 0.486 Test Loss: 1.251 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.285315990447998
Epoch: 5, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.3763983249664307
Epoch: 6, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.146 Vali Acc: 0.459 Test Loss: 1.146 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3405897617340088
Epoch: 7, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.124 Vali Acc: 0.446 Test Loss: 1.124 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.105501651763916
Epoch: 8, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.111 Vali Acc: 0.473 Test Loss: 1.111 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.24969482421875
Epoch: 9, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.112 Vali Acc: 0.486 Test Loss: 1.112 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.404921531677246
Epoch: 10, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.3297209739685059
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3358006477355957
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3306658267974854
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4482929706573486
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3270535469055176
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3941423892974854
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2927980422973633
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.276158332824707
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4580953121185303
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2815136909484863
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.210 Vali Acc: 0.541 Test Loss: 1.210 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1916740
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4923105239868164
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.1759412288665771
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.341 Vali Acc: 0.351 Test Loss: 1.341 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.315140724182129
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.286 Vali Acc: 0.486 Test Loss: 1.286 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.1083238124847412
Epoch: 4, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2315139770507812
Epoch: 5, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.1484947204589844
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.145 Vali Acc: 0.473 Test Loss: 1.145 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9490399360656738
Epoch: 7, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.1950206756591797
Epoch: 8, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.053 Vali Acc: 0.541 Test Loss: 1.053 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0016562938690186
Epoch: 9, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.039 Vali Acc: 0.595 Test Loss: 1.039 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.1553499698638916
Epoch: 10, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.2530105113983154
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.975 Vali Acc: 0.581 Test Loss: 0.975 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2826695442199707
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.035 Vali Acc: 0.622 Test Loss: 1.035 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2491681575775146
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3455264568328857
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.012 Vali Acc: 0.608 Test Loss: 1.012 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2123854160308838
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.030 Vali Acc: 0.622 Test Loss: 1.030 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3145833015441895
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3095359802246094
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.052 Vali Acc: 0.595 Test Loss: 1.052 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2434873580932617
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.072 Vali Acc: 0.622 Test Loss: 1.072 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1697800159454346
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.083 Vali Acc: 0.635 Test Loss: 1.083 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635124).  Saving model ...
Epoch: 20 cost time: 1.2816791534423828
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.080 Vali Acc: 0.608 Test Loss: 1.080 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2022490501403809
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.093 Vali Acc: 0.608 Test Loss: 1.093 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3813986778259277
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.121 Vali Acc: 0.635 Test Loss: 1.121 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.285109043121338
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.133 Vali Acc: 0.649 Test Loss: 1.133 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648637).  Saving model ...
Epoch: 24 cost time: 1.3126628398895264
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.137 Vali Acc: 0.635 Test Loss: 1.137 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.19126296043396
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.137 Vali Acc: 0.635 Test Loss: 1.137 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3421728610992432
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.156 Vali Acc: 0.622 Test Loss: 1.156 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2639646530151367
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.155 Vali Acc: 0.635 Test Loss: 1.155 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3447225093841553
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.170 Vali Acc: 0.635 Test Loss: 1.170 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3143310546875
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.187 Vali Acc: 0.635 Test Loss: 1.187 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2991318702697754
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.186 Vali Acc: 0.635 Test Loss: 1.186 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3807306289672852
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.193 Vali Acc: 0.622 Test Loss: 1.193 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.313814401626587
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.205 Vali Acc: 0.635 Test Loss: 1.205 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3717350959777832
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.204 Vali Acc: 0.649 Test Loss: 1.204 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1902660
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5089404582977295
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.350 Vali Acc: 0.297 Test Loss: 1.350 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.2446551322937012
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.327 Vali Acc: 0.365 Test Loss: 1.327 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.1564483642578125
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.301 Vali Acc: 0.405 Test Loss: 1.301 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.2993724346160889
Epoch: 4, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.2304069995880127
Epoch: 5, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.1920130252838135
Epoch: 6, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1991336345672607
Epoch: 7, Steps: 10 | Train Loss: 0.800 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.251668930053711
Epoch: 8, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.1673688888549805
Epoch: 9, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1853153705596924
Epoch: 10, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.3061299324035645
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.052 Vali Acc: 0.541 Test Loss: 1.052 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2388269901275635
Epoch: 12, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 1.3742694854736328
Epoch: 13, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.294097900390625
Epoch: 14, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.045 Vali Acc: 0.568 Test Loss: 1.045 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.191357135772705
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2051630020141602
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3242881298065186
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.064 Vali Acc: 0.581 Test Loss: 1.064 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2150146961212158
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.071 Vali Acc: 0.554 Test Loss: 1.071 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2772367000579834
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1685528755187988
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2873215675354004
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1535499095916748
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1893700
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4224696159362793
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.2699317932128906
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.369 Vali Acc: 0.338 Test Loss: 1.369 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.2247707843780518
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.337 Vali Acc: 0.419 Test Loss: 1.337 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.1912994384765625
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.295 Vali Acc: 0.473 Test Loss: 1.295 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.1583433151245117
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.0866937637329102
Epoch: 6, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.2075424194335938
Epoch: 7, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.1362125873565674
Epoch: 8, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.1296277046203613
Epoch: 9, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.135 Vali Acc: 0.595 Test Loss: 1.135 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 1.1348850727081299
Epoch: 10, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2233505249023438
Epoch: 11, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.077 Vali Acc: 0.608 Test Loss: 1.077 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 1.1383366584777832
Epoch: 12, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.075 Vali Acc: 0.595 Test Loss: 1.075 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1761512756347656
Epoch: 13, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2011668682098389
Epoch: 14, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1202630996704102
Epoch: 15, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.065 Vali Acc: 0.581 Test Loss: 1.065 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1611058712005615
Epoch: 16, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1918611526489258
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2388510704040527
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1526498794555664
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2323024272918701
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1832129955291748
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1889860
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6906754970550537
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.378 Vali Acc: 0.338 Test Loss: 1.378 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.5118272304534912
Epoch: 2, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.325 Vali Acc: 0.365 Test Loss: 1.325 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.4647865295410156
Epoch: 3, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.272 Vali Acc: 0.419 Test Loss: 1.272 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.4917047023773193
Epoch: 4, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.5055177211761475
Epoch: 5, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.2041785717010498
Epoch: 6, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.120 Vali Acc: 0.473 Test Loss: 1.120 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 7 cost time: 1.568929672241211
Epoch: 7, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.4266250133514404
Epoch: 8, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.203066349029541
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.141 Vali Acc: 0.568 Test Loss: 1.141 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.2513701915740967
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1337451934814453
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0553650856018066
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2305757999420166
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.212 Vali Acc: 0.541 Test Loss: 1.212 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9876046180725098
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2381935119628906
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2864112854003906
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.262 Vali Acc: 0.541 Test Loss: 1.262 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3001840114593506
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.267 Vali Acc: 0.527 Test Loss: 1.267 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1783695220947266
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.276 Vali Acc: 0.527 Test Loss: 1.276 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3349874019622803
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.291 Vali Acc: 0.554 Test Loss: 1.291 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 620516
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6008243560791016
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.341 Vali Acc: 0.392 Test Loss: 1.341 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.2951157093048096
Epoch: 2, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.308 Vali Acc: 0.419 Test Loss: 1.308 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0533297061920166
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.2240893840789795
Epoch: 4, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.0565862655639648
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.9355087280273438
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.2551929950714111
Epoch: 7, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1570446491241455
Epoch: 8, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.050 Vali Acc: 0.608 Test Loss: 1.050 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 1.3080945014953613
Epoch: 9, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1915369033813477
Epoch: 10, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.019 Vali Acc: 0.622 Test Loss: 1.019 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 1.2105717658996582
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.013 Vali Acc: 0.608 Test Loss: 1.013 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1800541877746582
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1725571155548096
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1233563423156738
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.058 Vali Acc: 0.608 Test Loss: 1.058 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1868736743927002
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.082 Vali Acc: 0.581 Test Loss: 1.082 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2419734001159668
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.230668544769287
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.086 Vali Acc: 0.595 Test Loss: 1.086 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2412981986999512
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2920665740966797
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.106 Vali Acc: 0.608 Test Loss: 1.106 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1033618450164795
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.098 Vali Acc: 0.595 Test Loss: 1.098 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 569636
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1838393211364746
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9884591102600098
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.383 Vali Acc: 0.311 Test Loss: 1.383 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.1146693229675293
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.355 Vali Acc: 0.365 Test Loss: 1.355 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.9343204498291016
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.2601428031921387
Epoch: 5, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.0994822978973389
Epoch: 6, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.245 Vali Acc: 0.446 Test Loss: 1.245 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0923736095428467
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 0.9481005668640137
Epoch: 8, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0755271911621094
Epoch: 9, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 0.9820165634155273
Epoch: 10, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0717833042144775
Epoch: 11, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 0.9024055004119873
Epoch: 12, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.1446163654327393
Epoch: 13, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.094 Vali Acc: 0.595 Test Loss: 1.094 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 1.1411738395690918
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.180506706237793
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.112 Vali Acc: 0.581 Test Loss: 1.112 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1830060482025146
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.140 Vali Acc: 0.581 Test Loss: 1.140 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.242994785308838
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.151 Vali Acc: 0.568 Test Loss: 1.151 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1072454452514648
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0511419773101807
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.184 Vali Acc: 0.581 Test Loss: 1.184 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2471282482147217
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.197 Vali Acc: 0.581 Test Loss: 1.197 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9119646549224854
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.218 Vali Acc: 0.581 Test Loss: 1.218 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2383124828338623
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1501648426055908
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 552036
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4824764728546143
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.1203584671020508
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.365 Vali Acc: 0.378 Test Loss: 1.365 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.0935442447662354
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.332 Vali Acc: 0.419 Test Loss: 1.332 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.051454782485962
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.297 Vali Acc: 0.432 Test Loss: 1.297 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.0149993896484375
Epoch: 5, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.8348960876464844
Epoch: 6, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.215 Vali Acc: 0.459 Test Loss: 1.215 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.042985200881958
Epoch: 7, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.179 Vali Acc: 0.446 Test Loss: 1.179 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0446293354034424
Epoch: 8, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.0809357166290283
Epoch: 9, Steps: 10 | Train Loss: 0.635 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.201265573501587
Epoch: 10, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.072 Vali Acc: 0.486 Test Loss: 1.072 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0294270515441895
Epoch: 11, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.048 Vali Acc: 0.514 Test Loss: 1.048 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8095879554748535
Epoch: 12, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0770134925842285
Epoch: 13, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.028 Vali Acc: 0.527 Test Loss: 1.028 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527017).  Saving model ...
Epoch: 14 cost time: 0.9575634002685547
Epoch: 14, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.002 Vali Acc: 0.527 Test Loss: 1.002 Test Acc: 0.527
Validation loss decreased (-0.527017 --> -0.527017).  Saving model ...
Epoch: 15 cost time: 1.0944013595581055
Epoch: 15, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.995 Vali Acc: 0.541 Test Loss: 0.995 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540531).  Saving model ...
Epoch: 16 cost time: 1.0419056415557861
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.995 Vali Acc: 0.541 Test Loss: 0.995 Test Acc: 0.541
Validation loss decreased (-0.540531 --> -0.540531).  Saving model ...
Epoch: 17 cost time: 1.0828824043273926
Epoch: 17, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.993 Vali Acc: 0.554 Test Loss: 0.993 Test Acc: 0.554
Validation loss decreased (-0.540531 --> -0.554044).  Saving model ...
Epoch: 18 cost time: 1.2014470100402832
Epoch: 18, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.998 Vali Acc: 0.554 Test Loss: 0.998 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.169424295425415
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.013 Vali Acc: 0.568 Test Loss: 1.013 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 20 cost time: 1.1551337242126465
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.996 Vali Acc: 0.581 Test Loss: 0.996 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 1.2107038497924805
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.006 Vali Acc: 0.554 Test Loss: 1.006 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0872361660003662
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.017 Vali Acc: 0.568 Test Loss: 1.017 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2337756156921387
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.024 Vali Acc: 0.554 Test Loss: 1.024 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1121046543121338
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1777725219726562
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2216951847076416
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.032 Vali Acc: 0.568 Test Loss: 1.032 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1641249656677246
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1810557842254639
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1351900100708008
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1841323375701904
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 544676
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5267035961151123
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.9339373111724854
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.383 Vali Acc: 0.324 Test Loss: 1.383 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.1243932247161865
Epoch: 3, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.875969648361206
Epoch: 4, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.331 Vali Acc: 0.378 Test Loss: 1.331 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.1002037525177002
Epoch: 5, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.297 Vali Acc: 0.459 Test Loss: 1.297 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459446).  Saving model ...
Epoch: 6 cost time: 1.0309205055236816
Epoch: 6, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.273 Vali Acc: 0.446 Test Loss: 1.273 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.082338571548462
Epoch: 7, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.000352144241333
Epoch: 8, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 1.0761222839355469
Epoch: 9, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9784228801727295
Epoch: 10, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.0028576850891113
Epoch: 11, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.0866789817810059
Epoch: 12, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.0034570693969727
Epoch: 13, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.072 Vali Acc: 0.568 Test Loss: 1.072 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 1.0387415885925293
Epoch: 14, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0620741844177246
Epoch: 15, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 1.0147297382354736
Epoch: 16, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 17 cost time: 0.9725315570831299
Epoch: 17, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.045 Vali Acc: 0.581 Test Loss: 1.045 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 18 cost time: 1.0514154434204102
Epoch: 18, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 19 cost time: 1.0454821586608887
Epoch: 19, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.055 Vali Acc: 0.554 Test Loss: 1.055 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.050175666809082
Epoch: 20, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.049 Vali Acc: 0.595 Test Loss: 1.049 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 21 cost time: 0.9899063110351562
Epoch: 21, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.045 Vali Acc: 0.568 Test Loss: 1.045 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.108536958694458
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.15645432472229
Epoch: 23, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1565053462982178
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.205190896987915
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.064100742340088
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.085 Vali Acc: 0.568 Test Loss: 1.085 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0838327407836914
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0768260955810547
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9665908813476562
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0781381130218506
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.104 Vali Acc: 0.581 Test Loss: 1.104 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 537636
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3277642726898193
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.370 Vali Acc: 0.324 Test Loss: 1.370 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.012422800064087
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.358 Vali Acc: 0.338 Test Loss: 1.358 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.0987699031829834
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.343 Vali Acc: 0.365 Test Loss: 1.343 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.0740492343902588
Epoch: 4, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.326 Vali Acc: 0.432 Test Loss: 1.326 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.1746995449066162
Epoch: 5, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.310 Vali Acc: 0.446 Test Loss: 1.310 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.8889331817626953
Epoch: 6, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.0156440734863281
Epoch: 7, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.9878802299499512
Epoch: 8, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9493775367736816
Epoch: 9, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.214 Vali Acc: 0.486 Test Loss: 1.214 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0014369487762451
Epoch: 10, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.9862854480743408
Epoch: 11, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.0008652210235596
Epoch: 12, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.8089995384216309
Epoch: 13, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9608330726623535
Epoch: 14, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8984668254852295
Epoch: 15, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 1.0090818405151367
Epoch: 16, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.101 Vali Acc: 0.527 Test Loss: 1.101 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 17 cost time: 1.085451602935791
Epoch: 17, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 0.9934630393981934
Epoch: 18, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 1.0934906005859375
Epoch: 19, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.071 Vali Acc: 0.514 Test Loss: 1.071 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1193227767944336
Epoch: 20, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0246214866638184
Epoch: 21, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0858478546142578
Epoch: 22, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.099 Vali Acc: 0.541 Test Loss: 1.099 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1492822170257568
Epoch: 23, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.179612398147583
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.111 Vali Acc: 0.527 Test Loss: 1.111 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0554418563842773
Epoch: 25, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9198040962219238
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9253730773925781
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9825479984283447
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 533156
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.178661823272705
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.385 Vali Acc: 0.378 Test Loss: 1.385 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.148787021636963
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.370 Vali Acc: 0.365 Test Loss: 1.370 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9965906143188477
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.350 Vali Acc: 0.392 Test Loss: 1.350 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 1.0732219219207764
Epoch: 4, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.327 Vali Acc: 0.473 Test Loss: 1.327 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.0275583267211914
Epoch: 5, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.299 Vali Acc: 0.554 Test Loss: 1.299 Test Acc: 0.554
Validation loss decreased (-0.472960 --> -0.554041).  Saving model ...
Epoch: 6 cost time: 1.001133680343628
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.268 Vali Acc: 0.527 Test Loss: 1.268 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8288273811340332
Epoch: 7, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.245 Vali Acc: 0.581 Test Loss: 1.245 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581069).  Saving model ...
Epoch: 8 cost time: 1.114715814590454
Epoch: 8, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.221 Vali Acc: 0.581 Test Loss: 1.221 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 0.9189150333404541
Epoch: 9, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.191 Vali Acc: 0.581 Test Loss: 1.191 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 1.034747838973999
Epoch: 10, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.163 Vali Acc: 0.581 Test Loss: 1.163 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 0.9367148876190186
Epoch: 11, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.140 Vali Acc: 0.568 Test Loss: 1.140 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0021002292633057
Epoch: 12, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0621252059936523
Epoch: 13, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0381922721862793
Epoch: 14, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9180488586425781
Epoch: 15, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.085 Vali Acc: 0.527 Test Loss: 1.085 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0587387084960938
Epoch: 16, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.081 Vali Acc: 0.527 Test Loss: 1.081 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0867576599121094
Epoch: 17, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.080 Vali Acc: 0.514 Test Loss: 1.080 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0559625625610352
Epoch: 18, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.09588623046875
Epoch: 19, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0453197956085205
Epoch: 20, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 531236
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.017009735107422
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.382 Vali Acc: 0.338 Test Loss: 1.382 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 3.903573513031006
Epoch: 2, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.435 Vali Acc: 0.446 Test Loss: 1.435 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 4.108293533325195
Epoch: 3, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
Validation loss decreased (-0.445932 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 3.9344310760498047
Epoch: 4, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.695 Vali Acc: 0.554 Test Loss: 1.695 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554037).  Saving model ...
Epoch: 5 cost time: 3.9428138732910156
Epoch: 5, Steps: 10 | Train Loss: 0.091 Vali Loss: 2.357 Vali Acc: 0.486 Test Loss: 2.357 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.835853099822998
Epoch: 6, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.537 Vali Acc: 0.446 Test Loss: 2.537 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6988604068756104
Epoch: 7, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.326 Vali Acc: 0.486 Test Loss: 2.326 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.48388147354126
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.144 Vali Acc: 0.459 Test Loss: 3.144 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.41996431350708
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.791 Vali Acc: 0.473 Test Loss: 3.791 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.324649810791016
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.444 Vali Acc: 0.432 Test Loss: 3.444 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.7819414138793945
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.844 Vali Acc: 0.500 Test Loss: 3.844 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.288026809692383
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.424 Vali Acc: 0.405 Test Loss: 5.424 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.3668384552001953
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.190 Vali Acc: 0.486 Test Loss: 4.190 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.4995386600494385
Epoch: 14, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.841 Vali Acc: 0.432 Test Loss: 4.841 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 6352644
model size : 24.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3847601413726807
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.275 Vali Acc: 0.351 Test Loss: 1.275 Test Acc: 0.351
Validation loss decreased (inf --> -0.351339).  Saving model ...
Epoch: 2 cost time: 2.223374605178833
Epoch: 2, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.083 Vali Acc: 0.581 Test Loss: 1.083 Test Acc: 0.581
Validation loss decreased (-0.351339 --> -0.581070).  Saving model ...
Epoch: 3 cost time: 2.287311315536499
Epoch: 3, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.259 Vali Acc: 0.486 Test Loss: 1.259 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3631513118743896
Epoch: 4, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.192 Vali Acc: 0.554 Test Loss: 1.192 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2259445190429688
Epoch: 5, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.444 Vali Acc: 0.541 Test Loss: 1.444 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9982993602752686
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.497 Vali Acc: 0.527 Test Loss: 1.497 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2424850463867188
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.427 Vali Acc: 0.568 Test Loss: 1.427 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.018359899520874
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.482 Vali Acc: 0.554 Test Loss: 1.482 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3114733695983887
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.568 Test Loss: 1.578 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.279160976409912
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.393 Vali Acc: 0.581 Test Loss: 1.393 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.081777334213257
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.568 Test Loss: 1.372 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3371381759643555
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.554 Test Loss: 1.387 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 5945604
model size : 22.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.327807903289795
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.302 Vali Acc: 0.392 Test Loss: 1.302 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.9279615879058838
Epoch: 2, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.176 Vali Acc: 0.486 Test Loss: 1.176 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 2.1013638973236084
Epoch: 3, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.122 Vali Acc: 0.486 Test Loss: 1.122 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.9228332042694092
Epoch: 4, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.095 Vali Acc: 0.608 Test Loss: 1.095 Test Acc: 0.608
Validation loss decreased (-0.486475 --> -0.608097).  Saving model ...
Epoch: 5 cost time: 1.8678381443023682
Epoch: 5, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9536006450653076
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.915440320968628
Epoch: 7, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.225 Vali Acc: 0.541 Test Loss: 1.225 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7852694988250732
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.234 Vali Acc: 0.554 Test Loss: 1.234 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8906633853912354
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.256 Vali Acc: 0.541 Test Loss: 1.256 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0709590911865234
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.568 Test Loss: 1.270 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9236440658569336
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.269 Vali Acc: 0.541 Test Loss: 1.269 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.006666898727417
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.541 Test Loss: 1.276 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0051093101501465
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9513728618621826
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.299 Vali Acc: 0.541 Test Loss: 1.299 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 5804804
model size : 22.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.941981554031372
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.322 Vali Acc: 0.365 Test Loss: 1.322 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.5597121715545654
Epoch: 2, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.280 Vali Acc: 0.405 Test Loss: 1.280 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.5431952476501465
Epoch: 3, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
Validation loss decreased (-0.405393 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 1.6225383281707764
Epoch: 4, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.235 Vali Acc: 0.432 Test Loss: 1.235 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4879693984985352
Epoch: 5, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.092 Vali Acc: 0.568 Test Loss: 1.092 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.5545287132263184
Epoch: 6, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.154 Vali Acc: 0.554 Test Loss: 1.154 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5158400535583496
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5610158443450928
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6273229122161865
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6102559566497803
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.212 Vali Acc: 0.554 Test Loss: 1.212 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5477700233459473
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.221 Vali Acc: 0.541 Test Loss: 1.221 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.689892292022705
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.223 Vali Acc: 0.554 Test Loss: 1.223 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6185266971588135
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6013925075531006
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5225787162780762
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.239 Vali Acc: 0.581 Test Loss: 1.239 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 16 cost time: 1.566638708114624
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.568 Test Loss: 1.249 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5933687686920166
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6280591487884521
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.554 Test Loss: 1.263 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3779828548431396
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.541 Test Loss: 1.274 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3648152351379395
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.554 Test Loss: 1.278 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2925207614898682
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.581 Test Loss: 1.279 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2930634021759033
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.581 Test Loss: 1.281 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2477264404296875
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.554 Test Loss: 1.300 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0823943614959717
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.554 Test Loss: 1.309 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3647451400756836
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.554 Test Loss: 1.312 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 5745924
model size : 21.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9657704830169678
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.337 Vali Acc: 0.324 Test Loss: 1.337 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.6448943614959717
Epoch: 2, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.5991644859313965
Epoch: 3, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.6653227806091309
Epoch: 4, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 1.6540086269378662
Epoch: 5, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.044 Vali Acc: 0.581 Test Loss: 1.044 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 6 cost time: 1.6213257312774658
Epoch: 6, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.107 Vali Acc: 0.527 Test Loss: 1.107 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6254732608795166
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.117 Vali Acc: 0.595 Test Loss: 1.117 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 1.5110816955566406
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.104 Vali Acc: 0.608 Test Loss: 1.104 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.4159889221191406
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.114 Vali Acc: 0.581 Test Loss: 1.114 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6514637470245361
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.152 Vali Acc: 0.568 Test Loss: 1.152 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4620192050933838
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.134 Vali Acc: 0.581 Test Loss: 1.134 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6450512409210205
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.129 Vali Acc: 0.595 Test Loss: 1.129 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6275568008422852
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.140 Vali Acc: 0.581 Test Loss: 1.140 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.364408254623413
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.151 Vali Acc: 0.568 Test Loss: 1.151 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.627807855606079
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.167 Vali Acc: 0.595 Test Loss: 1.167 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6373825073242188
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.167 Vali Acc: 0.581 Test Loss: 1.167 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4600961208343506
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.164 Vali Acc: 0.568 Test Loss: 1.164 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5755887031555176
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.179 Vali Acc: 0.568 Test Loss: 1.179 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 5679364
model size : 21.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.661942958831787
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.418 Vali Acc: 0.203 Test Loss: 1.418 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.4650070667266846
Epoch: 2, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.301 Vali Acc: 0.338 Test Loss: 1.301 Test Acc: 0.338
Validation loss decreased (-0.202689 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.425806999206543
Epoch: 3, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.193 Vali Acc: 0.432 Test Loss: 1.193 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432421).  Saving model ...
Epoch: 4 cost time: 1.4257771968841553
Epoch: 4, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.141 Vali Acc: 0.459 Test Loss: 1.141 Test Acc: 0.459
Validation loss decreased (-0.432421 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.393721342086792
Epoch: 5, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.127 Vali Acc: 0.459 Test Loss: 1.127 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.142897129058838
Epoch: 6, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 1.403719186782837
Epoch: 7, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.169 Vali Acc: 0.486 Test Loss: 1.169 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3689186573028564
Epoch: 8, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.151 Vali Acc: 0.541 Test Loss: 1.151 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.2418162822723389
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.127 Vali Acc: 0.473 Test Loss: 1.127 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2174057960510254
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2237257957458496
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 1.4837932586669922
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.569753646850586
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.153 Vali Acc: 0.541 Test Loss: 1.153 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5582761764526367
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3551740646362305
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4696128368377686
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5950720310211182
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4711320400238037
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5702404975891113
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.193 Vali Acc: 0.527 Test Loss: 1.193 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5685837268829346
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2773065567016602
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 5653764
model size : 21.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.703944444656372
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.409 Vali Acc: 0.176 Test Loss: 1.409 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 1.517604112625122
Epoch: 2, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.305 Vali Acc: 0.392 Test Loss: 1.305 Test Acc: 0.392
Validation loss decreased (-0.175662 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.5485174655914307
Epoch: 3, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.5100102424621582
Epoch: 4, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.137 Vali Acc: 0.486 Test Loss: 1.137 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.5271661281585693
Epoch: 5, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.5524723529815674
Epoch: 6, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.094 Vali Acc: 0.486 Test Loss: 1.094 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486476).  Saving model ...
Epoch: 7 cost time: 1.5063385963439941
Epoch: 7, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.080 Vali Acc: 0.486 Test Loss: 1.080 Test Acc: 0.486
Validation loss decreased (-0.486476 --> -0.486476).  Saving model ...
Epoch: 8 cost time: 1.5536861419677734
Epoch: 8, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.486476 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.3516526222229004
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.2722764015197754
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5103809833526611
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4569642543792725
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3161118030548096
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3671579360961914
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 1.464374303817749
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4406781196594238
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.606785774230957
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5909547805786133
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.216 Vali Acc: 0.527 Test Loss: 1.216 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4297287464141846
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.220 Vali Acc: 0.527 Test Loss: 1.220 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4101862907409668
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.235 Vali Acc: 0.527 Test Loss: 1.235 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5484368801116943
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.244 Vali Acc: 0.527 Test Loss: 1.244 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3125805854797363
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.242 Vali Acc: 0.527 Test Loss: 1.242 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3844897747039795
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.255 Vali Acc: 0.527 Test Loss: 1.255 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3334553241729736
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 5638404
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.395949363708496
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 2.6225814819335938
Epoch: 2, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 2.4553327560424805
Epoch: 3, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 4 cost time: 2.651153802871704
Epoch: 4, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6858134269714355
Epoch: 5, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.328 Vali Acc: 0.541 Test Loss: 1.328 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.373785972595215
Epoch: 6, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.370 Vali Acc: 0.541 Test Loss: 1.370 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6472725868225098
Epoch: 7, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.554 Test Loss: 1.380 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2587697505950928
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.514 Test Loss: 1.381 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6779730319976807
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.389 Vali Acc: 0.514 Test Loss: 1.389 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.388627767562866
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.527 Test Loss: 1.405 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6011898517608643
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5504109859466553
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.527 Test Loss: 1.417 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3909690380096436
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.527 Test Loss: 1.422 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1865604
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5887320041656494
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.338 Vali Acc: 0.392 Test Loss: 1.338 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.3701825141906738
Epoch: 2, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.4328536987304688
Epoch: 3, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.377150535583496
Epoch: 4, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.312 Vali Acc: 0.432 Test Loss: 1.312 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3599462509155273
Epoch: 5, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.065 Vali Acc: 0.527 Test Loss: 1.065 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.4062964916229248
Epoch: 6, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.3966474533081055
Epoch: 7, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.440708875656128
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4609699249267578
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3072535991668701
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.181 Vali Acc: 0.554 Test Loss: 1.181 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3159797191619873
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.190 Vali Acc: 0.554 Test Loss: 1.190 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4320094585418701
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3702237606048584
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3691682815551758
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.206 Vali Acc: 0.554 Test Loss: 1.206 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4182753562927246
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4463527202606201
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.554 Test Loss: 1.220 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3550610542297363
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1662084
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2290377616882324
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.327 Vali Acc: 0.351 Test Loss: 1.327 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.166163444519043
Epoch: 2, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.200 Vali Acc: 0.459 Test Loss: 1.200 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.229942798614502
Epoch: 3, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.135 Vali Acc: 0.446 Test Loss: 1.135 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.373274564743042
Epoch: 4, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.061 Vali Acc: 0.608 Test Loss: 1.061 Test Acc: 0.608
Validation loss decreased (-0.459447 --> -0.608097).  Saving model ...
Epoch: 5 cost time: 1.3449833393096924
Epoch: 5, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.062 Vali Acc: 0.541 Test Loss: 1.062 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3106811046600342
Epoch: 6, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4249098300933838
Epoch: 7, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3533482551574707
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.121 Vali Acc: 0.595 Test Loss: 1.121 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3228106498718262
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3274059295654297
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.134 Vali Acc: 0.595 Test Loss: 1.134 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2827560901641846
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.139 Vali Acc: 0.608 Test Loss: 1.139 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2997736930847168
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.160 Vali Acc: 0.608 Test Loss: 1.160 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0614871978759766
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2989706993103027
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.166 Vali Acc: 0.595 Test Loss: 1.166 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1591684
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6510345935821533
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.354 Vali Acc: 0.378 Test Loss: 1.354 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.1822433471679688
Epoch: 2, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.264 Vali Acc: 0.419 Test Loss: 1.264 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.2945411205291748
Epoch: 3, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.201 Vali Acc: 0.419 Test Loss: 1.201 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.1732888221740723
Epoch: 4, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
Validation loss decreased (-0.418907 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.1422433853149414
Epoch: 5, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.1826372146606445
Epoch: 6, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.1774582862854004
Epoch: 7, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2545912265777588
Epoch: 8, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.0388753414154053
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.138 Vali Acc: 0.581 Test Loss: 1.138 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.1905994415283203
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.237705945968628
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.182 Vali Acc: 0.568 Test Loss: 1.182 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1348018646240234
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.169 Vali Acc: 0.595 Test Loss: 1.169 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 1.2217378616333008
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2260863780975342
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.568 Test Loss: 1.199 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0805811882019043
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.205 Vali Acc: 0.568 Test Loss: 1.205 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.111506462097168
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.221 Vali Acc: 0.581 Test Loss: 1.221 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2525737285614014
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.223 Vali Acc: 0.568 Test Loss: 1.223 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0574195384979248
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.220 Vali Acc: 0.581 Test Loss: 1.220 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2128326892852783
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.234 Vali Acc: 0.581 Test Loss: 1.234 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0604007244110107
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0826416015625
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.247 Vali Acc: 0.581 Test Loss: 1.247 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1823525428771973
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1562244
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.163684368133545
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.366 Vali Acc: 0.351 Test Loss: 1.366 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.0298514366149902
Epoch: 2, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
Validation loss decreased (-0.351338 --> -0.527014).  Saving model ...
Epoch: 3 cost time: 1.0430617332458496
Epoch: 3, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1571104526519775
Epoch: 4, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2007694244384766
Epoch: 5, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 0.9882380962371826
Epoch: 6, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.1179945468902588
Epoch: 7, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.128143072128296
Epoch: 8, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.075 Vali Acc: 0.527 Test Loss: 1.075 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.043050765991211
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 0.9931313991546631
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.098 Vali Acc: 0.527 Test Loss: 1.098 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1519155502319336
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.081 Vali Acc: 0.595 Test Loss: 1.081 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.0753567218780518
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.99845290184021
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1690797805786133
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0801100730895996
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0599572658538818
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.128 Vali Acc: 0.568 Test Loss: 1.128 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.253061056137085
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2754547595977783
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0880701541900635
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1947195529937744
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.150392770767212
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.151 Vali Acc: 0.568 Test Loss: 1.151 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1528964
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2644059658050537
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.1957855224609375
Epoch: 2, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0128681659698486
Epoch: 3, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.0748059749603271
Epoch: 4, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.113 Vali Acc: 0.568 Test Loss: 1.113 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 1.067990779876709
Epoch: 5, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.090 Vali Acc: 0.514 Test Loss: 1.090 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8878366947174072
Epoch: 6, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.034 Vali Acc: 0.541 Test Loss: 1.034 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9513938426971436
Epoch: 7, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.040 Vali Acc: 0.568 Test Loss: 1.040 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.0417790412902832
Epoch: 8, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.013 Vali Acc: 0.527 Test Loss: 1.013 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1316163539886475
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.031 Vali Acc: 0.581 Test Loss: 1.031 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.165949821472168
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0843446254730225
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.034 Vali Acc: 0.541 Test Loss: 1.034 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0793330669403076
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.057 Vali Acc: 0.541 Test Loss: 1.057 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.169194221496582
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.064 Vali Acc: 0.554 Test Loss: 1.064 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1744720935821533
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9864754676818848
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.086 Vali Acc: 0.527 Test Loss: 1.086 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0386250019073486
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.144296407699585
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0098683834075928
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0538313388824463
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1516164
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2743282318115234
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 0.9954195022583008
Epoch: 2, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.289 Vali Acc: 0.365 Test Loss: 1.289 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0537030696868896
Epoch: 3, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.217 Vali Acc: 0.541 Test Loss: 1.217 Test Acc: 0.541
Validation loss decreased (-0.391879 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.1567070484161377
Epoch: 4, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0165867805480957
Epoch: 5, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0791828632354736
Epoch: 6, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0266644954681396
Epoch: 7, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.1143956184387207
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.090 Vali Acc: 0.514 Test Loss: 1.090 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.038149356842041
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0818052291870117
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1046366691589355
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9703950881958008
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.107238531112671
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0607631206512451
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9824910163879395
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1046316623687744
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.103872537612915
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1508484
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.530348777770996
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.4892501831054688
Epoch: 2, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.161 Vali Acc: 0.459 Test Loss: 1.161 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7011289596557617
Epoch: 3, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 1.7258777618408203
Epoch: 4, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 1.7250118255615234
Epoch: 5, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6780719757080078
Epoch: 6, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5406348705291748
Epoch: 7, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8006656169891357
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.237 Vali Acc: 0.554 Test Loss: 1.237 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.76765775680542
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5917112827301025
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6730146408081055
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4239675998687744
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.231 Vali Acc: 0.541 Test Loss: 1.231 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6248316764831543
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.645740270614624
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.244 Vali Acc: 0.527 Test Loss: 1.244 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 605124
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.394893169403076
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.365 Vali Acc: 0.324 Test Loss: 1.365 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.1879234313964844
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.275 Vali Acc: 0.432 Test Loss: 1.275 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.2171192169189453
Epoch: 3, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.211 Vali Acc: 0.446 Test Loss: 1.211 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.2584741115570068
Epoch: 4, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.155 Vali Acc: 0.459 Test Loss: 1.155 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.1079423427581787
Epoch: 5, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2177987098693848
Epoch: 6, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.2082207202911377
Epoch: 7, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.266 Vali Acc: 0.446 Test Loss: 1.266 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.043766975402832
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.18300199508667
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.2313823699951172
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1270599365234375
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1487088203430176
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1124839782714844
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.960120439529419
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.177 Vali Acc: 0.527 Test Loss: 1.177 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.114670753479004
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0295729637145996
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9538750648498535
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1780743598937988
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2145321369171143
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 503364
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3356480598449707
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.337 Vali Acc: 0.284 Test Loss: 1.337 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9477803707122803
Epoch: 2, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.277 Vali Acc: 0.473 Test Loss: 1.277 Test Acc: 0.473
Validation loss decreased (-0.283770 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.1099982261657715
Epoch: 3, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.196 Vali Acc: 0.554 Test Loss: 1.196 Test Acc: 0.554
Validation loss decreased (-0.472960 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 1.1702625751495361
Epoch: 4, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9975888729095459
Epoch: 5, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.1430315971374512
Epoch: 6, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1676404476165771
Epoch: 7, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.036764144897461
Epoch: 8, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.066 Vali Acc: 0.527 Test Loss: 1.066 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9488935470581055
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.056 Vali Acc: 0.527 Test Loss: 1.056 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0143890380859375
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.068 Vali Acc: 0.541 Test Loss: 1.068 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1114747524261475
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.079 Vali Acc: 0.554 Test Loss: 1.079 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.92610764503479
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1686408519744873
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1326289176940918
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9896981716156006
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 468164
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1388471126556396
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.326 Vali Acc: 0.405 Test Loss: 1.326 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 0.9420206546783447
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.265 Vali Acc: 0.473 Test Loss: 1.265 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.8050739765167236
Epoch: 3, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.8159976005554199
Epoch: 4, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.8556225299835205
Epoch: 5, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.115 Vali Acc: 0.473 Test Loss: 1.115 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8535521030426025
Epoch: 6, Steps: 10 | Train Loss: 0.482 Vali Loss: 1.125 Vali Acc: 0.473 Test Loss: 1.125 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8090720176696777
Epoch: 7, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.069 Vali Acc: 0.527 Test Loss: 1.069 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.882861852645874
Epoch: 8, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0198962688446045
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.093 Vali Acc: 0.473 Test Loss: 1.093 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9135444164276123
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.061 Vali Acc: 0.527 Test Loss: 1.061 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.9071877002716064
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8350262641906738
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.869692325592041
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.094 Vali Acc: 0.527 Test Loss: 1.094 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0662436485290527
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9722561836242676
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.109 Vali Acc: 0.527 Test Loss: 1.109 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9229750633239746
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 0.9318089485168457
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9136874675750732
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.136 Vali Acc: 0.527 Test Loss: 1.136 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9869062900543213
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9197230339050293
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9365150928497314
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.159 Vali Acc: 0.527 Test Loss: 1.159 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.925961971282959
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.810004472732544
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0585408210754395
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.166 Vali Acc: 0.527 Test Loss: 1.166 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9242880344390869
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8740453720092773
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 453444
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0864198207855225
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.390 Vali Acc: 0.297 Test Loss: 1.390 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.9261138439178467
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.363 Vali Acc: 0.311 Test Loss: 1.363 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.9033339023590088
Epoch: 3, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.298 Vali Acc: 0.419 Test Loss: 1.298 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.8035223484039307
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.9050724506378174
Epoch: 5, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.8884150981903076
Epoch: 6, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.8436694145202637
Epoch: 7, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.117 Vali Acc: 0.568 Test Loss: 1.117 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.9250283241271973
Epoch: 8, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 0.813586950302124
Epoch: 9, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.097 Vali Acc: 0.581 Test Loss: 1.097 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8231143951416016
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.9665398597717285
Epoch: 11, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.065 Vali Acc: 0.581 Test Loss: 1.065 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7801821231842041
Epoch: 12, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.066 Vali Acc: 0.595 Test Loss: 1.066 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 0.7060043811798096
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 0.8396553993225098
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.055 Vali Acc: 0.608 Test Loss: 1.055 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 0.852719783782959
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7374632358551025
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.092 Vali Acc: 0.595 Test Loss: 1.092 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9007978439331055
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.811396598815918
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.109 Vali Acc: 0.595 Test Loss: 1.109 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.833895206451416
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.904728889465332
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.114 Vali Acc: 0.595 Test Loss: 1.114 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8378653526306152
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.112 Vali Acc: 0.595 Test Loss: 1.112 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.898212194442749
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.863065242767334
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8806061744689941
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.126 Vali Acc: 0.581 Test Loss: 1.126 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 436804
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2109758853912354
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.371 Vali Acc: 0.324 Test Loss: 1.371 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.997516393661499
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.334 Vali Acc: 0.378 Test Loss: 1.334 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.7225525379180908
Epoch: 3, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.303 Vali Acc: 0.446 Test Loss: 1.303 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.875917911529541
Epoch: 4, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9299285411834717
Epoch: 5, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.180 Vali Acc: 0.432 Test Loss: 1.180 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8693885803222656
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.150 Vali Acc: 0.459 Test Loss: 1.150 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 0.9536936283111572
Epoch: 7, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.9560339450836182
Epoch: 8, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.103 Vali Acc: 0.486 Test Loss: 1.103 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 0.899071455001831
Epoch: 9, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.085 Vali Acc: 0.486 Test Loss: 1.085 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486476).  Saving model ...
Epoch: 10 cost time: 0.917259931564331
Epoch: 10, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.068 Vali Acc: 0.527 Test Loss: 1.068 Test Acc: 0.527
Validation loss decreased (-0.486476 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.9263119697570801
Epoch: 11, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8594820499420166
Epoch: 12, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.054 Vali Acc: 0.527 Test Loss: 1.054 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.8865208625793457
Epoch: 13, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 0.9056136608123779
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.064 Vali Acc: 0.554 Test Loss: 1.064 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8037002086639404
Epoch: 15, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 16 cost time: 0.7465276718139648
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.075 Vali Acc: 0.554 Test Loss: 1.075 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8397781848907471
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8380386829376221
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8066656589508057
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.097 Vali Acc: 0.581 Test Loss: 1.097 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7928290367126465
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8717782497406006
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9185373783111572
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8293716907501221
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8286263942718506
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.132 Vali Acc: 0.595 Test Loss: 1.132 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9238829612731934
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 430404
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1932334899902344
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.407 Vali Acc: 0.230 Test Loss: 1.407 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.91304612159729
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.369 Vali Acc: 0.311 Test Loss: 1.369 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.8535611629486084
Epoch: 3, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.330 Vali Acc: 0.324 Test Loss: 1.330 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.9483578205108643
Epoch: 4, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.284 Vali Acc: 0.419 Test Loss: 1.284 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.9351930618286133
Epoch: 5, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.242 Vali Acc: 0.405 Test Loss: 1.242 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7859764099121094
Epoch: 6, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 0.809166431427002
Epoch: 7, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.8762059211730957
Epoch: 8, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.8198814392089844
Epoch: 9, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.144 Vali Acc: 0.432 Test Loss: 1.144 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7329916954040527
Epoch: 10, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.103 Vali Acc: 0.514 Test Loss: 1.103 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.726172685623169
Epoch: 11, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8312137126922607
Epoch: 12, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.114 Vali Acc: 0.486 Test Loss: 1.114 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.747917652130127
Epoch: 13, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.085 Vali Acc: 0.527 Test Loss: 1.085 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 0.9216744899749756
Epoch: 14, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9009852409362793
Epoch: 15, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8106489181518555
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9129388332366943
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.922762393951416
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8628277778625488
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9565894603729248
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9092521667480469
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.838343620300293
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.773428201675415
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 426564
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8860554695129395
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.353 Vali Acc: 0.392 Test Loss: 1.353 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.8222455978393555
Epoch: 2, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.391878 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.845853328704834
Epoch: 3, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.066084384918213
Epoch: 4, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.9757671356201172
Epoch: 5, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.145 Vali Acc: 0.514 Test Loss: 1.145 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0370254516601562
Epoch: 6, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.9197402000427246
Epoch: 7, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7074456214904785
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9551093578338623
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8931519985198975
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0306003093719482
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.049189567565918
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0222947597503662
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1460626125335693
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1446640491485596
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.116150140762329
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 220644
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0653817653656006
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.9759087562561035
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.327 Vali Acc: 0.419 Test Loss: 1.327 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0184996128082275
Epoch: 3, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.9113550186157227
Epoch: 4, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.7790074348449707
Epoch: 5, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.165 Vali Acc: 0.486 Test Loss: 1.165 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.9443788528442383
Epoch: 6, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.8706414699554443
Epoch: 7, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.114 Vali Acc: 0.486 Test Loss: 1.114 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9631173610687256
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.103 Vali Acc: 0.514 Test Loss: 1.103 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8984222412109375
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.956298828125
Epoch: 10, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.088 Vali Acc: 0.514 Test Loss: 1.088 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0014569759368896
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.934004545211792
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0215725898742676
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 14 cost time: 1.0612256526947021
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9863665103912354
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0122644901275635
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8989455699920654
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9060091972351074
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.890864372253418
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.154 Vali Acc: 0.554 Test Loss: 1.154 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 20 cost time: 0.9489953517913818
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.006645679473877
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9080257415771484
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8941094875335693
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.166 Vali Acc: 0.527 Test Loss: 1.166 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.74920654296875
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8936984539031982
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.182 Vali Acc: 0.541 Test Loss: 1.182 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9455456733703613
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.95279860496521
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9124400615692139
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9546759128570557
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 169764
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.069011688232422
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.372 Vali Acc: 0.338 Test Loss: 1.372 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.9273936748504639
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.8993477821350098
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.897913932800293
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8789873123168945
Epoch: 5, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.191 Vali Acc: 0.527 Test Loss: 1.191 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.8946535587310791
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.854994535446167
Epoch: 7, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.0087101459503174
Epoch: 8, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9145381450653076
Epoch: 9, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.076 Vali Acc: 0.554 Test Loss: 1.076 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.0179340839385986
Epoch: 10, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.9753115177154541
Epoch: 11, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.062 Vali Acc: 0.541 Test Loss: 1.062 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9757874011993408
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.034327745437622
Epoch: 13, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8516201972961426
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 1.0022571086883545
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.085 Vali Acc: 0.568 Test Loss: 1.085 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.92966628074646
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9656836986541748
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0359725952148438
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9374525547027588
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9828073978424072
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9652400016784668
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.115 Vali Acc: 0.568 Test Loss: 1.115 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9974992275238037
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9474658966064453
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9546809196472168
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 152164
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.113826274871826
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.8300318717956543
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.7422926425933838
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.394 Vali Acc: 0.351 Test Loss: 1.394 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 0.8347117900848389
Epoch: 4, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.357 Vali Acc: 0.405 Test Loss: 1.357 Test Acc: 0.405
Validation loss decreased (-0.351337 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.6679375171661377
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.295 Vali Acc: 0.432 Test Loss: 1.295 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 0.686823844909668
Epoch: 6, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.272 Vali Acc: 0.419 Test Loss: 1.272 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6324102878570557
Epoch: 7, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.244 Vali Acc: 0.446 Test Loss: 1.244 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.667332649230957
Epoch: 8, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.230 Vali Acc: 0.419 Test Loss: 1.230 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7337386608123779
Epoch: 9, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 0.6653637886047363
Epoch: 10, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6687462329864502
Epoch: 11, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.6598236560821533
Epoch: 12, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.176 Vali Acc: 0.473 Test Loss: 1.176 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6434683799743652
Epoch: 13, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.172 Vali Acc: 0.459 Test Loss: 1.172 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8296821117401123
Epoch: 14, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8539888858795166
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.158 Vali Acc: 0.486 Test Loss: 1.158 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7879555225372314
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9180548191070557
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.879417896270752
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 19 cost time: 0.8262631893157959
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.189 Vali Acc: 0.486 Test Loss: 1.189 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.878427267074585
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7884044647216797
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9142158031463623
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7327406406402588
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8285534381866455
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.213 Vali Acc: 0.514 Test Loss: 1.213 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8945071697235107
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8286945819854736
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 27 cost time: 0.8547995090484619
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.230 Vali Acc: 0.514 Test Loss: 1.230 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6343221664428711
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.235 Vali Acc: 0.527 Test Loss: 1.235 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8075077533721924
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.246 Vali Acc: 0.527 Test Loss: 1.246 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8762433528900146
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.251 Vali Acc: 0.527 Test Loss: 1.251 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8786742687225342
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.248 Vali Acc: 0.527 Test Loss: 1.248 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8037865161895752
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.263 Vali Acc: 0.527 Test Loss: 1.263 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6482670307159424
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.277 Vali Acc: 0.527 Test Loss: 1.277 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8625693321228027
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8798115253448486
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6899175643920898
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.286 Vali Acc: 0.514 Test Loss: 1.286 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 144804
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0951662063598633
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.396 Vali Acc: 0.284 Test Loss: 1.396 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9005348682403564
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.7743368148803711
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.367 Vali Acc: 0.338 Test Loss: 1.367 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.6870417594909668
Epoch: 4, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.328 Vali Acc: 0.378 Test Loss: 1.328 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.8742368221282959
Epoch: 5, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.294 Vali Acc: 0.392 Test Loss: 1.294 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.9230294227600098
Epoch: 6, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.251 Vali Acc: 0.473 Test Loss: 1.251 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 0.9077322483062744
Epoch: 7, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.7433552742004395
Epoch: 8, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.209 Vali Acc: 0.514 Test Loss: 1.209 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 0.8134365081787109
Epoch: 9, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 0.8231663703918457
Epoch: 10, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.176 Vali Acc: 0.541 Test Loss: 1.176 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9320521354675293
Epoch: 11, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7532501220703125
Epoch: 12, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8149676322937012
Epoch: 13, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.112 Vali Acc: 0.581 Test Loss: 1.112 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 0.7623436450958252
Epoch: 14, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7817397117614746
Epoch: 15, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6942133903503418
Epoch: 16, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.111 Vali Acc: 0.581 Test Loss: 1.111 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 0.6322357654571533
Epoch: 17, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.107 Vali Acc: 0.527 Test Loss: 1.107 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6823911666870117
Epoch: 18, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6724898815155029
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.105 Vali Acc: 0.527 Test Loss: 1.105 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6864783763885498
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8255751132965088
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7740423679351807
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8267631530761719
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.126 Vali Acc: 0.595 Test Loss: 1.126 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 24 cost time: 0.9210903644561768
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.139 Vali Acc: 0.581 Test Loss: 1.139 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8902556896209717
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.144 Vali Acc: 0.595 Test Loss: 1.144 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.97412109375
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9453830718994141
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.154 Vali Acc: 0.581 Test Loss: 1.154 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8961150646209717
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.165 Vali Acc: 0.581 Test Loss: 1.165 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.905860424041748
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.166 Vali Acc: 0.568 Test Loss: 1.166 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8625619411468506
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9521400928497314
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.178 Vali Acc: 0.581 Test Loss: 1.178 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8194985389709473
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.181 Vali Acc: 0.581 Test Loss: 1.181 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9501347541809082
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.185 Vali Acc: 0.581 Test Loss: 1.185 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 136484
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.838118076324463
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.8578023910522461
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8505158424377441
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.325 Vali Acc: 0.324 Test Loss: 1.325 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8174960613250732
Epoch: 4, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.287 Vali Acc: 0.392 Test Loss: 1.287 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.9075002670288086
Epoch: 5, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.260 Vali Acc: 0.419 Test Loss: 1.260 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.86102294921875
Epoch: 6, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.236 Vali Acc: 0.446 Test Loss: 1.236 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.7787191867828369
Epoch: 7, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.198 Vali Acc: 0.432 Test Loss: 1.198 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7408769130706787
Epoch: 8, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.181 Vali Acc: 0.446 Test Loss: 1.181 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 0.7750391960144043
Epoch: 9, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 0.8203909397125244
Epoch: 10, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.140 Vali Acc: 0.473 Test Loss: 1.140 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 11 cost time: 0.696861982345581
Epoch: 11, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 0.7991619110107422
Epoch: 12, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.091 Vali Acc: 0.486 Test Loss: 1.091 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.896559476852417
Epoch: 13, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.088 Vali Acc: 0.527 Test Loss: 1.088 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 0.6614408493041992
Epoch: 14, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.081 Vali Acc: 0.527 Test Loss: 1.081 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 0.7571549415588379
Epoch: 15, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 16 cost time: 0.7530732154846191
Epoch: 16, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.055 Vali Acc: 0.473 Test Loss: 1.055 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8093171119689941
Epoch: 17, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 18 cost time: 0.8954501152038574
Epoch: 18, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7274322509765625
Epoch: 19, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.066 Vali Acc: 0.514 Test Loss: 1.066 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8608450889587402
Epoch: 20, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.067 Vali Acc: 0.514 Test Loss: 1.067 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7650928497314453
Epoch: 21, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.072 Vali Acc: 0.486 Test Loss: 1.072 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.892319917678833
Epoch: 22, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8949859142303467
Epoch: 23, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8064603805541992
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.080 Vali Acc: 0.514 Test Loss: 1.080 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8456103801727295
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8101181983947754
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.100 Vali Acc: 0.514 Test Loss: 1.100 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9179353713989258
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 133284
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0350351333618164
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.7089834213256836
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.373 Vali Acc: 0.324 Test Loss: 1.373 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.7686736583709717
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.345 Vali Acc: 0.324 Test Loss: 1.345 Test Acc: 0.324
Validation loss decreased (-0.324311 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.6963744163513184
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.318 Vali Acc: 0.378 Test Loss: 1.318 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.7302761077880859
Epoch: 5, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.293 Vali Acc: 0.378 Test Loss: 1.293 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 0.7209410667419434
Epoch: 6, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.269 Vali Acc: 0.392 Test Loss: 1.269 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 0.7568991184234619
Epoch: 7, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 0.9069311618804932
Epoch: 8, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.938504695892334
Epoch: 9, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.7987828254699707
Epoch: 10, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.800128698348999
Epoch: 11, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 0.7677311897277832
Epoch: 12, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 0.8655352592468262
Epoch: 13, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7647018432617188
Epoch: 14, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 0.8414888381958008
Epoch: 15, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.082 Vali Acc: 0.486 Test Loss: 1.082 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8085992336273193
Epoch: 16, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.086 Vali Acc: 0.473 Test Loss: 1.086 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8051044940948486
Epoch: 17, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8350315093994141
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.045 Vali Acc: 0.514 Test Loss: 1.045 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8550941944122314
Epoch: 19, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9215865135192871
Epoch: 20, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.050 Vali Acc: 0.486 Test Loss: 1.050 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8265519142150879
Epoch: 21, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.049 Vali Acc: 0.514 Test Loss: 1.049 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8580737113952637
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.041 Vali Acc: 0.527 Test Loss: 1.041 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9397902488708496
Epoch: 23, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.046 Vali Acc: 0.500 Test Loss: 1.046 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8246684074401855
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.050 Vali Acc: 0.514 Test Loss: 1.050 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 131364
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.923332691192627
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.4306504726409912
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.345 Vali Acc: 0.392 Test Loss: 1.345 Test Acc: 0.392
Validation loss decreased (-0.243229 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.598897933959961
Epoch: 3, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.305 Vali Acc: 0.378 Test Loss: 1.305 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3731017112731934
Epoch: 4, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.247 Vali Acc: 0.459 Test Loss: 1.247 Test Acc: 0.459
Validation loss decreased (-0.391878 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.182265281677246
Epoch: 5, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.2776377201080322
Epoch: 6, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0315437316894531
Epoch: 7, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.267113447189331
Epoch: 8, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.3636267185211182
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.702937364578247
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5837738513946533
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.274 Vali Acc: 0.541 Test Loss: 1.274 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 1.465825080871582
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.264 Vali Acc: 0.527 Test Loss: 1.264 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5404670238494873
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.300 Vali Acc: 0.514 Test Loss: 1.300 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5170989036560059
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.342853307723999
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6085898876190186
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.341 Vali Acc: 0.514 Test Loss: 1.341 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5959749221801758
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.342 Vali Acc: 0.527 Test Loss: 1.342 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5350077152252197
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.353 Vali Acc: 0.527 Test Loss: 1.353 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.641908884048462
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.360 Vali Acc: 0.514 Test Loss: 1.360 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4475553035736084
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3789870738983154
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1136612
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.637700080871582
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.371 Vali Acc: 0.351 Test Loss: 1.371 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.5316228866577148
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.344 Vali Acc: 0.459 Test Loss: 1.344 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.5565013885498047
Epoch: 3, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.297 Vali Acc: 0.446 Test Loss: 1.297 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3986873626708984
Epoch: 4, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.466522216796875
Epoch: 5, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.194 Vali Acc: 0.459 Test Loss: 1.194 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.5669758319854736
Epoch: 6, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.165 Vali Acc: 0.473 Test Loss: 1.165 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.3692262172698975
Epoch: 7, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.114 Vali Acc: 0.527 Test Loss: 1.114 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.4528594017028809
Epoch: 8, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.478644609451294
Epoch: 9, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5471622943878174
Epoch: 10, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.082 Vali Acc: 0.527 Test Loss: 1.082 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.45782470703125
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.4285879135131836
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.4472079277038574
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3032217025756836
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.494762659072876
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4902911186218262
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.33803391456604
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.158 Vali Acc: 0.541 Test Loss: 1.158 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6419849395751953
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4589054584503174
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4831202030181885
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.164 Vali Acc: 0.541 Test Loss: 1.164 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4066658020019531
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4263498783111572
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1085732
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4006118774414062
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.381 Vali Acc: 0.297 Test Loss: 1.381 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.5810878276824951
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.370 Vali Acc: 0.351 Test Loss: 1.370 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.2375271320343018
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.336 Vali Acc: 0.432 Test Loss: 1.336 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.385516881942749
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.4314491748809814
Epoch: 5, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.283 Vali Acc: 0.473 Test Loss: 1.283 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.3994581699371338
Epoch: 6, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.654094934463501
Epoch: 7, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.3192884922027588
Epoch: 8, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.211519718170166
Epoch: 9, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3816208839416504
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2116529941558838
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.2873024940490723
Epoch: 12, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.126 Vali Acc: 0.527 Test Loss: 1.126 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2807655334472656
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.479557752609253
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3046090602874756
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3628644943237305
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5506784915924072
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4923503398895264
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4738073348999023
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4401721954345703
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.222 Vali Acc: 0.527 Test Loss: 1.222 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4208691120147705
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1070692
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7013449668884277
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.370 Vali Acc: 0.338 Test Loss: 1.370 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.2757055759429932
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.346 Vali Acc: 0.392 Test Loss: 1.346 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.43648099899292
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.320 Vali Acc: 0.459 Test Loss: 1.320 Test Acc: 0.459
Validation loss decreased (-0.391878 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 1.4022846221923828
Epoch: 4, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.286 Vali Acc: 0.419 Test Loss: 1.286 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2345030307769775
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.270 Vali Acc: 0.432 Test Loss: 1.270 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4448978900909424
Epoch: 6, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.235 Vali Acc: 0.446 Test Loss: 1.235 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2883732318878174
Epoch: 7, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.3219130039215088
Epoch: 8, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.201 Vali Acc: 0.405 Test Loss: 1.201 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.297905445098877
Epoch: 9, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.0743374824523926
Epoch: 10, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.3155639171600342
Epoch: 11, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.2637996673583984
Epoch: 12, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.159 Vali Acc: 0.473 Test Loss: 1.159 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2142658233642578
Epoch: 13, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.3054039478302002
Epoch: 14, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2579913139343262
Epoch: 15, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2760684490203857
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4106075763702393
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5723025798797607
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3389625549316406
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3805880546569824
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4370086193084717
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2628505229949951
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5354835987091064
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1060772
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5221118927001953
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.387 Vali Acc: 0.324 Test Loss: 1.387 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.5330379009246826
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5242319107055664
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.372 Vali Acc: 0.378 Test Loss: 1.372 Test Acc: 0.378
Validation loss decreased (-0.324310 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.2064530849456787
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.348 Vali Acc: 0.392 Test Loss: 1.348 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391878).  Saving model ...
Epoch: 5 cost time: 1.3798747062683105
Epoch: 5, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.325 Vali Acc: 0.473 Test Loss: 1.325 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.2965378761291504
Epoch: 6, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.294 Vali Acc: 0.514 Test Loss: 1.294 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.2152087688446045
Epoch: 7, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0877745151519775
Epoch: 8, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2237167358398438
Epoch: 9, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 1.076509952545166
Epoch: 10, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.177 Vali Acc: 0.541 Test Loss: 1.177 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.0665504932403564
Epoch: 11, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.160834550857544
Epoch: 12, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.162 Vali Acc: 0.581 Test Loss: 1.162 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581069).  Saving model ...
Epoch: 13 cost time: 1.3613674640655518
Epoch: 13, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0822091102600098
Epoch: 14, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.162 Vali Acc: 0.568 Test Loss: 1.162 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4298295974731445
Epoch: 15, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3806321620941162
Epoch: 16, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.173304796218872
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.192 Vali Acc: 0.554 Test Loss: 1.192 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2949144840240479
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2709314823150635
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.232 Vali Acc: 0.554 Test Loss: 1.232 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.224088430404663
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4268255233764648
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.254 Vali Acc: 0.554 Test Loss: 1.254 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.30952787399292
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.272 Vali Acc: 0.554 Test Loss: 1.272 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1056292
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5383245944976807
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.391 Vali Acc: 0.203 Test Loss: 1.391 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.23207426071167
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.389 Vali Acc: 0.203 Test Loss: 1.389 Test Acc: 0.203
Validation loss decreased (-0.202689 --> -0.202689).  Saving model ...
Epoch: 3 cost time: 1.5038840770721436
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.376 Vali Acc: 0.311 Test Loss: 1.376 Test Acc: 0.311
Validation loss decreased (-0.202689 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.2971296310424805
Epoch: 4, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.362 Vali Acc: 0.284 Test Loss: 1.362 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4088637828826904
Epoch: 5, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 6 cost time: 1.2668538093566895
Epoch: 6, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.306 Vali Acc: 0.324 Test Loss: 1.306 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.508805751800537
Epoch: 7, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.278 Vali Acc: 0.351 Test Loss: 1.278 Test Acc: 0.351
Validation loss decreased (-0.337825 --> -0.351339).  Saving model ...
Epoch: 8 cost time: 1.3282291889190674
Epoch: 8, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.256 Vali Acc: 0.365 Test Loss: 1.256 Test Acc: 0.365
Validation loss decreased (-0.351339 --> -0.364852).  Saving model ...
Epoch: 9 cost time: 1.269848346710205
Epoch: 9, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.254 Vali Acc: 0.392 Test Loss: 1.254 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 10 cost time: 1.3859803676605225
Epoch: 10, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.215 Vali Acc: 0.392 Test Loss: 1.215 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391880).  Saving model ...
Epoch: 11 cost time: 1.1772034168243408
Epoch: 11, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.193 Vali Acc: 0.405 Test Loss: 1.193 Test Acc: 0.405
Validation loss decreased (-0.391880 --> -0.405393).  Saving model ...
Epoch: 12 cost time: 1.269528865814209
Epoch: 12, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.170 Vali Acc: 0.419 Test Loss: 1.170 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 13 cost time: 1.2823493480682373
Epoch: 13, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.176 Vali Acc: 0.392 Test Loss: 1.176 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3227758407592773
Epoch: 14, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.194 Vali Acc: 0.405 Test Loss: 1.194 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2967257499694824
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.197 Vali Acc: 0.419 Test Loss: 1.197 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.335270643234253
Epoch: 16, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.195 Vali Acc: 0.419 Test Loss: 1.195 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3469815254211426
Epoch: 17, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.216 Vali Acc: 0.432 Test Loss: 1.216 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432420).  Saving model ...
Epoch: 18 cost time: 1.3402836322784424
Epoch: 18, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.238 Vali Acc: 0.432 Test Loss: 1.238 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.404742956161499
Epoch: 19, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.256 Vali Acc: 0.432 Test Loss: 1.256 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.190277099609375
Epoch: 20, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.287 Vali Acc: 0.432 Test Loss: 1.287 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2134661674499512
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1011240482330322
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.340 Vali Acc: 0.432 Test Loss: 1.340 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0824072360992432
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.353 Vali Acc: 0.432 Test Loss: 1.353 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2111809253692627
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.369 Vali Acc: 0.432 Test Loss: 1.369 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3502321243286133
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.394 Vali Acc: 0.432 Test Loss: 1.394 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2709400653839111
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.420 Vali Acc: 0.432 Test Loss: 1.420 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2749073505401611
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.435 Vali Acc: 0.432 Test Loss: 1.435 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 1051812
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.345540761947632
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.383 Vali Acc: 0.324 Test Loss: 1.383 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.3529949188232422
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.374 Vali Acc: 0.324 Test Loss: 1.374 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.183363437652588
Epoch: 3, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.356 Vali Acc: 0.392 Test Loss: 1.356 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 1.228804349899292
Epoch: 4, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.336 Vali Acc: 0.419 Test Loss: 1.336 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.1136043071746826
Epoch: 5, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.306 Vali Acc: 0.446 Test Loss: 1.306 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.355797290802002
Epoch: 6, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.275 Vali Acc: 0.514 Test Loss: 1.275 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.1834967136383057
Epoch: 7, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.237799882888794
Epoch: 8, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2833139896392822
Epoch: 9, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1346499919891357
Epoch: 10, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.181 Vali Acc: 0.473 Test Loss: 1.181 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3828988075256348
Epoch: 11, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.155524492263794
Epoch: 12, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.153 Vali Acc: 0.459 Test Loss: 1.153 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2734935283660889
Epoch: 13, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.148 Vali Acc: 0.446 Test Loss: 1.148 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3093464374542236
Epoch: 14, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.147 Vali Acc: 0.446 Test Loss: 1.147 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.112501621246338
Epoch: 15, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.147 Vali Acc: 0.459 Test Loss: 1.147 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2855150699615479
Epoch: 16, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.146 Vali Acc: 0.459 Test Loss: 1.146 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1047332
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.628495693206787
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.376 Vali Acc: 0.338 Test Loss: 1.376 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.29184889793396
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.338 Vali Acc: 0.311 Test Loss: 1.338 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2668910026550293
Epoch: 3, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.298 Vali Acc: 0.446 Test Loss: 1.298 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.261033296585083
Epoch: 4, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.244 Vali Acc: 0.432 Test Loss: 1.244 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2515699863433838
Epoch: 5, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.174 Vali Acc: 0.459 Test Loss: 1.174 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.2098329067230225
Epoch: 6, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.5387907028198242
Epoch: 7, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.1765117645263672
Epoch: 8, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4283673763275146
Epoch: 9, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.0498840808868408
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.214 Vali Acc: 0.541 Test Loss: 1.214 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3530447483062744
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.227 Vali Acc: 0.527 Test Loss: 1.227 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.065096139907837
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.228 Vali Acc: 0.554 Test Loss: 1.228 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 1.282564640045166
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.270 Vali Acc: 0.541 Test Loss: 1.270 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.131352186203003
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.282 Vali Acc: 0.554 Test Loss: 1.282 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3997840881347656
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3252649307250977
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.302 Vali Acc: 0.554 Test Loss: 1.302 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5621843338012695
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.319 Vali Acc: 0.554 Test Loss: 1.319 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4760618209838867
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.321 Vali Acc: 0.554 Test Loss: 1.321 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3766484260559082
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.329 Vali Acc: 0.554 Test Loss: 1.329 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3684165477752686
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.337 Vali Acc: 0.554 Test Loss: 1.337 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.562211513519287
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.347 Vali Acc: 0.554 Test Loss: 1.347 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2499353885650635
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.356 Vali Acc: 0.554 Test Loss: 1.356 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1127652
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.768930435180664
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.363 Vali Acc: 0.365 Test Loss: 1.363 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.6000776290893555
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.337 Vali Acc: 0.459 Test Loss: 1.337 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.3937559127807617
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.283 Vali Acc: 0.459 Test Loss: 1.283 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.4550602436065674
Epoch: 4, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.2936046123504639
Epoch: 5, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1437702178955078
Epoch: 6, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.141 Vali Acc: 0.554 Test Loss: 1.141 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.3184046745300293
Epoch: 7, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.100 Vali Acc: 0.514 Test Loss: 1.100 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1647191047668457
Epoch: 8, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2085084915161133
Epoch: 9, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.067 Vali Acc: 0.527 Test Loss: 1.067 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2592430114746094
Epoch: 10, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.084 Vali Acc: 0.486 Test Loss: 1.084 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0945112705230713
Epoch: 11, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1569175720214844
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.082 Vali Acc: 0.500 Test Loss: 1.082 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1480002403259277
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.2940373420715332
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.099 Vali Acc: 0.527 Test Loss: 1.099 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.166013479232788
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1899044513702393
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3848133087158203
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3035848140716553
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.160 Vali Acc: 0.568 Test Loss: 1.160 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 19 cost time: 1.3981332778930664
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5011119842529297
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4886419773101807
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.176 Vali Acc: 0.541 Test Loss: 1.176 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2119948863983154
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.172795057296753
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3263652324676514
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2693583965301514
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3588833808898926
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3885271549224854
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.225 Vali Acc: 0.541 Test Loss: 1.225 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3793790340423584
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.231 Vali Acc: 0.541 Test Loss: 1.231 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1076772
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4135286808013916
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.371 Vali Acc: 0.378 Test Loss: 1.371 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.173222303390503
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.350 Vali Acc: 0.419 Test Loss: 1.350 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.3836205005645752
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.322 Vali Acc: 0.405 Test Loss: 1.322 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.346329689025879
Epoch: 4, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.418905 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.4400858879089355
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.251 Vali Acc: 0.446 Test Loss: 1.251 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2840547561645508
Epoch: 6, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.4235560894012451
Epoch: 7, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.411921501159668
Epoch: 8, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.300199270248413
Epoch: 9, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.3122756481170654
Epoch: 10, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3981187343597412
Epoch: 11, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.125 Vali Acc: 0.541 Test Loss: 1.125 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4282519817352295
Epoch: 12, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.107 Vali Acc: 0.595 Test Loss: 1.107 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 1.251422643661499
Epoch: 13, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3905994892120361
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.150 Vali Acc: 0.595 Test Loss: 1.150 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.393949270248413
Epoch: 15, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.162 Vali Acc: 0.595 Test Loss: 1.162 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.349778652191162
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.178 Vali Acc: 0.595 Test Loss: 1.178 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2670378684997559
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.176 Vali Acc: 0.581 Test Loss: 1.176 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.530879020690918
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.197 Vali Acc: 0.595 Test Loss: 1.197 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3667263984680176
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2007148265838623
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.234 Vali Acc: 0.608 Test Loss: 1.234 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608096).  Saving model ...
Epoch: 21 cost time: 1.2310874462127686
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.241 Vali Acc: 0.595 Test Loss: 1.241 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2672016620635986
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.254 Vali Acc: 0.581 Test Loss: 1.254 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2969260215759277
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.273 Vali Acc: 0.581 Test Loss: 1.273 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2837648391723633
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.291 Vali Acc: 0.608 Test Loss: 1.291 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4586257934570312
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.300 Vali Acc: 0.608 Test Loss: 1.300 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2646617889404297
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1216797828674316
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.321 Vali Acc: 0.581 Test Loss: 1.321 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0676403045654297
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.334 Vali Acc: 0.595 Test Loss: 1.334 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.328265905380249
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.215515375137329
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.359 Vali Acc: 0.568 Test Loss: 1.359 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1061732
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8831515312194824
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.370 Vali Acc: 0.297 Test Loss: 1.370 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.641456127166748
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.356 Vali Acc: 0.311 Test Loss: 1.356 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.527130126953125
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.331 Vali Acc: 0.459 Test Loss: 1.331 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 1.3158700466156006
Epoch: 4, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.303 Vali Acc: 0.459 Test Loss: 1.303 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 1.4172627925872803
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.258 Vali Acc: 0.514 Test Loss: 1.258 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.516913890838623
Epoch: 6, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.221 Vali Acc: 0.514 Test Loss: 1.221 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.5790400505065918
Epoch: 7, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5896854400634766
Epoch: 8, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6484642028808594
Epoch: 9, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.158 Vali Acc: 0.486 Test Loss: 1.158 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.691962480545044
Epoch: 10, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.118 Vali Acc: 0.473 Test Loss: 1.118 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3983097076416016
Epoch: 11, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.109 Vali Acc: 0.527 Test Loss: 1.109 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 1.406116247177124
Epoch: 12, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.6091899871826172
Epoch: 13, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3596627712249756
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6158840656280518
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7426793575286865
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4949657917022705
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3984920978546143
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.121 Vali Acc: 0.486 Test Loss: 1.121 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.429318904876709
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.121 Vali Acc: 0.473 Test Loss: 1.121 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5834016799926758
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3901114463806152
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.123 Vali Acc: 0.527 Test Loss: 1.123 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5964932441711426
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1051812
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6274852752685547
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.368 Vali Acc: 0.351 Test Loss: 1.368 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.6999588012695312
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.355 Vali Acc: 0.365 Test Loss: 1.355 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.5068612098693848
Epoch: 3, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.340 Vali Acc: 0.378 Test Loss: 1.340 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.6460967063903809
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.323 Vali Acc: 0.405 Test Loss: 1.323 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.2693636417388916
Epoch: 5, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.288 Vali Acc: 0.473 Test Loss: 1.288 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.6115374565124512
Epoch: 6, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.256 Vali Acc: 0.432 Test Loss: 1.256 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4602837562561035
Epoch: 7, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.6252026557922363
Epoch: 8, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.204 Vali Acc: 0.486 Test Loss: 1.204 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.438887357711792
Epoch: 9, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.181 Vali Acc: 0.554 Test Loss: 1.181 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.5235404968261719
Epoch: 10, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.164 Vali Acc: 0.527 Test Loss: 1.164 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5590596199035645
Epoch: 11, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2872188091278076
Epoch: 12, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.1441593170166016
Epoch: 13, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.433105230331421
Epoch: 14, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.39644193649292
Epoch: 15, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2822182178497314
Epoch: 16, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3489110469818115
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6519057750701904
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6188161373138428
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4904534816741943
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4778618812561035
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5840198993682861
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6129817962646484
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1047332
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9506454467773438
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.368 Vali Acc: 0.270 Test Loss: 1.368 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.7790961265563965
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (-0.270257 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.781409502029419
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.335 Vali Acc: 0.378 Test Loss: 1.335 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.5586183071136475
Epoch: 4, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.311 Vali Acc: 0.392 Test Loss: 1.311 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.7109384536743164
Epoch: 5, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.277 Vali Acc: 0.459 Test Loss: 1.277 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.7080881595611572
Epoch: 6, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.248 Vali Acc: 0.514 Test Loss: 1.248 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.66178560256958
Epoch: 7, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6299383640289307
Epoch: 8, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7686076164245605
Epoch: 9, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.677191972732544
Epoch: 10, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.752777338027954
Epoch: 11, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.5326483249664307
Epoch: 12, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 1.7199888229370117
Epoch: 13, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.712618112564087
Epoch: 14, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6133511066436768
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6041452884674072
Epoch: 16, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.769836664199829
Epoch: 17, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7409937381744385
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7084143161773682
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5568854808807373
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6601617336273193
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5039310455322266
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.245 Vali Acc: 0.486 Test Loss: 1.245 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1042852
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5742578506469727
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.400 Vali Acc: 0.135 Test Loss: 1.400 Test Acc: 0.135
Validation loss decreased (inf --> -0.135121).  Saving model ...
Epoch: 2 cost time: 1.447373390197754
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.393 Vali Acc: 0.203 Test Loss: 1.393 Test Acc: 0.203
Validation loss decreased (-0.135121 --> -0.202689).  Saving model ...
Epoch: 3 cost time: 1.7016496658325195
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.375 Vali Acc: 0.243 Test Loss: 1.375 Test Acc: 0.243
Validation loss decreased (-0.202689 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 1.5624701976776123
Epoch: 4, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.345 Vali Acc: 0.311 Test Loss: 1.345 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 1.664299726486206
Epoch: 5, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.311 Vali Acc: 0.351 Test Loss: 1.311 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.5803003311157227
Epoch: 6, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.282 Vali Acc: 0.378 Test Loss: 1.282 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378366).  Saving model ...
Epoch: 7 cost time: 1.494175910949707
Epoch: 7, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.243 Vali Acc: 0.446 Test Loss: 1.243 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 1.6848647594451904
Epoch: 8, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.219 Vali Acc: 0.419 Test Loss: 1.219 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6480906009674072
Epoch: 9, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.198 Vali Acc: 0.459 Test Loss: 1.198 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 1.489910364151001
Epoch: 10, Steps: 10 | Train Loss: 0.771 Vali Loss: 1.164 Vali Acc: 0.459 Test Loss: 1.164 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 11 cost time: 1.5948312282562256
Epoch: 11, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 1.3633301258087158
Epoch: 12, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.141 Vali Acc: 0.446 Test Loss: 1.141 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5377168655395508
Epoch: 13, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.125 Vali Acc: 0.446 Test Loss: 1.125 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6535367965698242
Epoch: 14, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.126 Vali Acc: 0.432 Test Loss: 1.126 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.390639066696167
Epoch: 15, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.127 Vali Acc: 0.419 Test Loss: 1.127 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5446579456329346
Epoch: 16, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.135 Vali Acc: 0.419 Test Loss: 1.135 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5570495128631592
Epoch: 17, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.137 Vali Acc: 0.459 Test Loss: 1.137 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5751640796661377
Epoch: 18, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.148 Vali Acc: 0.446 Test Loss: 1.148 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6215968132019043
Epoch: 19, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.165 Vali Acc: 0.446 Test Loss: 1.165 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4909965991973877
Epoch: 20, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.670708417892456
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.179 Vali Acc: 0.473 Test Loss: 1.179 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 1038372
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4780802726745605
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.288 Vali Acc: 0.473 Test Loss: 1.288 Test Acc: 0.473
Validation loss decreased (inf --> -0.472960).  Saving model ...
Epoch: 2 cost time: 2.76434588432312
Epoch: 2, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.170 Vali Acc: 0.459 Test Loss: 1.170 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6964271068573
Epoch: 3, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.080 Vali Acc: 0.514 Test Loss: 1.080 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513503).  Saving model ...
Epoch: 4 cost time: 2.853114604949951
Epoch: 4, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.384 Vali Acc: 0.473 Test Loss: 1.384 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.594458818435669
Epoch: 5, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527014).  Saving model ...
Epoch: 6 cost time: 2.677622079849243
Epoch: 6, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.374 Vali Acc: 0.568 Test Loss: 1.374 Test Acc: 0.568
Validation loss decreased (-0.527014 --> -0.567554).  Saving model ...
Epoch: 7 cost time: 2.743067979812622
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.449 Vali Acc: 0.581 Test Loss: 1.449 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 8 cost time: 2.498969554901123
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.554 Test Loss: 1.503 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4257006645202637
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.478 Vali Acc: 0.554 Test Loss: 1.478 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.382091999053955
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.541 Test Loss: 1.505 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3113200664520264
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6668834686279297
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.541 Test Loss: 1.529 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7155003547668457
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.541 Test Loss: 1.527 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.721151828765869
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.554 Test Loss: 1.531 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5627615451812744
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.568 Test Loss: 1.537 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.768986940383911
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.554 Test Loss: 1.539 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9142255783081055
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.554 Test Loss: 1.547 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 4016004
model size : 15.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0862085819244385
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.338 Vali Acc: 0.351 Test Loss: 1.338 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.960719347000122
Epoch: 2, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.351338 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 2.1207916736602783
Epoch: 3, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 2.075735092163086
Epoch: 4, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.070 Vali Acc: 0.527 Test Loss: 1.070 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 2.0321738719940186
Epoch: 5, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.981642484664917
Epoch: 6, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.067 Vali Acc: 0.568 Test Loss: 1.067 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 2.1027517318725586
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.076993227005005
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0990312099456787
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.186 Vali Acc: 0.568 Test Loss: 1.186 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.921447992324829
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.209 Vali Acc: 0.568 Test Loss: 1.209 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.058274030685425
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.232 Vali Acc: 0.568 Test Loss: 1.232 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9170353412628174
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.13486647605896
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.554 Test Loss: 1.263 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9293584823608398
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2012317180633545
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.275 Vali Acc: 0.568 Test Loss: 1.275 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0983712673187256
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.581 Test Loss: 1.281 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581068).  Saving model ...
Epoch: 17 cost time: 2.1045992374420166
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.554 Test Loss: 1.288 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0437397956848145
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.541 Test Loss: 1.300 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1631851196289062
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.554 Test Loss: 1.312 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1989128589630127
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.568 Test Loss: 1.317 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.108938694000244
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.326 Vali Acc: 0.541 Test Loss: 1.326 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0408732891082764
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.541 Test Loss: 1.331 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.998699426651001
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.554 Test Loss: 1.343 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9603445529937744
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.554 Test Loss: 1.353 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.987288475036621
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.541 Test Loss: 1.356 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9098286628723145
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.541 Test Loss: 1.364 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3812484
model size : 14.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9075677394866943
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.353 Vali Acc: 0.365 Test Loss: 1.353 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.7177953720092773
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.285 Vali Acc: 0.378 Test Loss: 1.285 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378366).  Saving model ...
Epoch: 3 cost time: 1.6352462768554688
Epoch: 3, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.192 Vali Acc: 0.405 Test Loss: 1.192 Test Acc: 0.405
Validation loss decreased (-0.378366 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.6895945072174072
Epoch: 4, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.138 Vali Acc: 0.459 Test Loss: 1.138 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 2.0093202590942383
Epoch: 5, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.773155927658081
Epoch: 6, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.923818826675415
Epoch: 7, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.7282078266143799
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9395639896392822
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6966264247894287
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.210 Vali Acc: 0.541 Test Loss: 1.210 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8863210678100586
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8023700714111328
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0291688442230225
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.265 Vali Acc: 0.568 Test Loss: 1.265 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5723841190338135
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.281 Vali Acc: 0.568 Test Loss: 1.281 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.868506669998169
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.285 Vali Acc: 0.568 Test Loss: 1.285 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.902440071105957
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.304 Vali Acc: 0.581 Test Loss: 1.304 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 17 cost time: 1.6754920482635498
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.302 Vali Acc: 0.568 Test Loss: 1.302 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9543123245239258
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.581 Test Loss: 1.321 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7796900272369385
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.337 Vali Acc: 0.581 Test Loss: 1.337 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.895658254623413
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.581 Test Loss: 1.348 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6218514442443848
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.356 Vali Acc: 0.581 Test Loss: 1.356 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9289937019348145
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.361 Vali Acc: 0.581 Test Loss: 1.361 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6585452556610107
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.581 Test Loss: 1.373 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9499106407165527
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.581 Test Loss: 1.386 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.662731647491455
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.581 Test Loss: 1.398 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7418453693389893
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.581 Test Loss: 1.408 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3742084
model size : 14.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9695522785186768
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.376 Vali Acc: 0.284 Test Loss: 1.376 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.7066600322723389
Epoch: 2, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.287 Vali Acc: 0.419 Test Loss: 1.287 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.8898942470550537
Epoch: 3, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.219 Vali Acc: 0.459 Test Loss: 1.219 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.7255780696868896
Epoch: 4, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.124 Vali Acc: 0.486 Test Loss: 1.124 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.8627266883850098
Epoch: 5, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.6922111511230469
Epoch: 6, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.845782995223999
Epoch: 7, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.067 Vali Acc: 0.514 Test Loss: 1.067 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 1.5827863216400146
Epoch: 8, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.076 Vali Acc: 0.554 Test Loss: 1.076 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.651639461517334
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7468616962432861
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8999295234680176
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 1.7645106315612793
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7614562511444092
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7201504707336426
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8644218444824219
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.235 Vali Acc: 0.568 Test Loss: 1.235 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6224961280822754
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.256 Vali Acc: 0.554 Test Loss: 1.256 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7061371803283691
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.274 Vali Acc: 0.554 Test Loss: 1.274 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5777561664581299
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.277 Vali Acc: 0.554 Test Loss: 1.277 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8050737380981445
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6474051475524902
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.300 Vali Acc: 0.554 Test Loss: 1.300 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8029885292053223
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.313 Vali Acc: 0.554 Test Loss: 1.313 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3712644
model size : 14.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0028016567230225
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.5616466999053955
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.300 Vali Acc: 0.432 Test Loss: 1.300 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.6592822074890137
Epoch: 3, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.7718896865844727
Epoch: 4, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.145 Vali Acc: 0.459 Test Loss: 1.145 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.6029367446899414
Epoch: 5, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.100 Vali Acc: 0.514 Test Loss: 1.100 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513503).  Saving model ...
Epoch: 6 cost time: 1.4757659435272217
Epoch: 6, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.043 Vali Acc: 0.554 Test Loss: 1.043 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 1.4310545921325684
Epoch: 7, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4553115367889404
Epoch: 8, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.009 Vali Acc: 0.568 Test Loss: 1.009 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.4922370910644531
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.020 Vali Acc: 0.568 Test Loss: 1.020 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6743652820587158
Epoch: 10, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.039 Vali Acc: 0.595 Test Loss: 1.039 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 1.6023483276367188
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.037 Vali Acc: 0.595 Test Loss: 1.037 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.6957817077636719
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.045 Vali Acc: 0.595 Test Loss: 1.045 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7071590423583984
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.064 Vali Acc: 0.581 Test Loss: 1.064 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5108075141906738
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6069872379302979
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5492544174194336
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.107 Vali Acc: 0.581 Test Loss: 1.107 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.721731185913086
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.114 Vali Acc: 0.581 Test Loss: 1.114 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4052977561950684
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.608957052230835
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.134 Vali Acc: 0.581 Test Loss: 1.134 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4479238986968994
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5821378231048584
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 3684484
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.969393491744995
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.379 Vali Acc: 0.257 Test Loss: 1.379 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.7977664470672607
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.317 Vali Acc: 0.432 Test Loss: 1.317 Test Acc: 0.432
Validation loss decreased (-0.256743 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.7044634819030762
Epoch: 3, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.228 Vali Acc: 0.608 Test Loss: 1.228 Test Acc: 0.608
Validation loss decreased (-0.432419 --> -0.608096).  Saving model ...
Epoch: 4 cost time: 1.764777660369873
Epoch: 4, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.178 Vali Acc: 0.568 Test Loss: 1.178 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8080050945281982
Epoch: 5, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8464889526367188
Epoch: 6, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.059 Vali Acc: 0.581 Test Loss: 1.059 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8187272548675537
Epoch: 7, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.005 Vali Acc: 0.527 Test Loss: 1.005 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7808353900909424
Epoch: 8, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.013 Vali Acc: 0.568 Test Loss: 1.013 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8131132125854492
Epoch: 9, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.985 Vali Acc: 0.541 Test Loss: 0.985 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7879533767700195
Epoch: 10, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.964 Vali Acc: 0.595 Test Loss: 0.964 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8122951984405518
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.981 Vali Acc: 0.581 Test Loss: 0.981 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8529689311981201
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.983 Vali Acc: 0.595 Test Loss: 0.983 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8768115043640137
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 3666564
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7701737880706787
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.393 Vali Acc: 0.230 Test Loss: 1.393 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.4906878471374512
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.358 Vali Acc: 0.351 Test Loss: 1.358 Test Acc: 0.351
Validation loss decreased (-0.229716 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.4806931018829346
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.297 Vali Acc: 0.392 Test Loss: 1.297 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.809272289276123
Epoch: 4, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.220 Vali Acc: 0.419 Test Loss: 1.220 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 1.6221907138824463
Epoch: 5, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.178 Vali Acc: 0.459 Test Loss: 1.178 Test Acc: 0.459
Validation loss decreased (-0.418907 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.8055667877197266
Epoch: 6, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.146 Vali Acc: 0.473 Test Loss: 1.146 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 7 cost time: 1.7136797904968262
Epoch: 7, Steps: 10 | Train Loss: 0.509 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.7799174785614014
Epoch: 8, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.073 Vali Acc: 0.486 Test Loss: 1.073 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7565889358520508
Epoch: 9, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.088 Vali Acc: 0.514 Test Loss: 1.088 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 10 cost time: 1.7822258472442627
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.089 Vali Acc: 0.514 Test Loss: 1.089 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6660850048065186
Epoch: 11, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.066 Vali Acc: 0.514 Test Loss: 1.066 Test Acc: 0.514
Validation loss decreased (-0.513503 --> -0.513503).  Saving model ...
Epoch: 12 cost time: 1.8282299041748047
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.092 Vali Acc: 0.514 Test Loss: 1.092 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7190337181091309
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8167757987976074
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6948707103729248
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.160 Vali Acc: 0.527 Test Loss: 1.160 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527015).  Saving model ...
Epoch: 16 cost time: 1.7385733127593994
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7612299919128418
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.181 Vali Acc: 0.527 Test Loss: 1.181 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7930829524993896
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6254115104675293
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.842219352722168
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.228 Vali Acc: 0.541 Test Loss: 1.228 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 21 cost time: 1.8076958656311035
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.839313268661499
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.241 Vali Acc: 0.527 Test Loss: 1.241 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9098339080810547
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.249 Vali Acc: 0.514 Test Loss: 1.249 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7235517501831055
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.259 Vali Acc: 0.541 Test Loss: 1.259 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8737032413482666
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.271 Vali Acc: 0.541 Test Loss: 1.271 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7059485912322998
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.277 Vali Acc: 0.541 Test Loss: 1.277 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7713351249694824
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.285 Vali Acc: 0.527 Test Loss: 1.285 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5581176280975342
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.292 Vali Acc: 0.527 Test Loss: 1.292 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7216742038726807
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.304 Vali Acc: 0.554 Test Loss: 1.304 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 30 cost time: 1.5367670059204102
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.305 Vali Acc: 0.541 Test Loss: 1.305 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6527130603790283
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.312 Vali Acc: 0.527 Test Loss: 1.312 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8341760635375977
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.325 Vali Acc: 0.541 Test Loss: 1.325 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8703434467315674
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9486637115478516
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.339 Vali Acc: 0.541 Test Loss: 1.339 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8159701824188232
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.541 Test Loss: 1.350 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7814404964447021
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.361 Vali Acc: 0.554 Test Loss: 1.361 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7712211608886719
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.366 Vali Acc: 0.554 Test Loss: 1.366 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9277174472808838
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.376 Vali Acc: 0.554 Test Loss: 1.376 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.75748872756958
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.541 Test Loss: 1.386 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 3658884
model size : 14.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.615842580795288
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.361 Vali Acc: 0.311 Test Loss: 1.361 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.6527326107025146
Epoch: 2, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.276 Vali Acc: 0.405 Test Loss: 1.276 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.3977124691009521
Epoch: 3, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.179 Vali Acc: 0.419 Test Loss: 1.179 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.1686925888061523
Epoch: 4, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
Validation loss decreased (-0.418907 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.0579392910003662
Epoch: 5, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.113 Vali Acc: 0.541 Test Loss: 1.113 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.988814115524292
Epoch: 6, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.948876142501831
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8682088851928711
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.229 Vali Acc: 0.541 Test Loss: 1.229 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2485787868499756
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.323 Vali Acc: 0.527 Test Loss: 1.323 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1710786819458008
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.346 Vali Acc: 0.541 Test Loss: 1.346 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4902427196502686
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.348 Vali Acc: 0.527 Test Loss: 1.348 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.587158203125
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.356 Vali Acc: 0.527 Test Loss: 1.356 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.525789737701416
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6109118461608887
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.554 Test Loss: 1.388 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554040).  Saving model ...
Epoch: 15 cost time: 1.6860482692718506
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.541 Test Loss: 1.397 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6806392669677734
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.541 Test Loss: 1.403 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3719158172607422
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.541 Test Loss: 1.410 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.637420892715454
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.554 Test Loss: 1.419 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4193851947784424
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.554 Test Loss: 1.430 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.567281723022461
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.541 Test Loss: 1.435 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6149022579193115
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.449 Vali Acc: 0.541 Test Loss: 1.449 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5563488006591797
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.458 Vali Acc: 0.554 Test Loss: 1.458 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5667672157287598
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.554 Test Loss: 1.460 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5423712730407715
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.554 Test Loss: 1.466 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1172420
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.739825487136841
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.372 Vali Acc: 0.270 Test Loss: 1.372 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.529883861541748
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.292 Vali Acc: 0.419 Test Loss: 1.292 Test Acc: 0.419
Validation loss decreased (-0.270257 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.5563225746154785
Epoch: 3, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.4671146869659424
Epoch: 4, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.4720616340637207
Epoch: 5, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.3643889427185059
Epoch: 6, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.4399054050445557
Epoch: 7, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.3185334205627441
Epoch: 8, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.460207223892212
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3463621139526367
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.143 Vali Acc: 0.541 Test Loss: 1.143 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4813272953033447
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.141 Vali Acc: 0.541 Test Loss: 1.141 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4394733905792236
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.160 Vali Acc: 0.554 Test Loss: 1.160 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4999308586120605
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5394487380981445
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3996169567108154
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.194 Vali Acc: 0.554 Test Loss: 1.194 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7417116165161133
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3419265747070312
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.228 Vali Acc: 0.554 Test Loss: 1.228 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1070660
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.854008436203003
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.372 Vali Acc: 0.270 Test Loss: 1.372 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.3240342140197754
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.327 Vali Acc: 0.405 Test Loss: 1.327 Test Acc: 0.405
Validation loss decreased (-0.270257 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.3921082019805908
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.2727348804473877
Epoch: 4, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.3665673732757568
Epoch: 5, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.4019620418548584
Epoch: 6, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.086 Vali Acc: 0.554 Test Loss: 1.086 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.4175503253936768
Epoch: 7, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.202012062072754
Epoch: 8, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.278151035308838
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.045 Vali Acc: 0.541 Test Loss: 1.045 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4125251770019531
Epoch: 10, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1959123611450195
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3875842094421387
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3650834560394287
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.407099962234497
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.352339506149292
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2339057922363281
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2856206893920898
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.193 Vali Acc: 0.554 Test Loss: 1.193 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.266488790512085
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1035460
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6432154178619385
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.371 Vali Acc: 0.243 Test Loss: 1.371 Test Acc: 0.243
Validation loss decreased (inf --> -0.243230).  Saving model ...
Epoch: 2 cost time: 1.3592872619628906
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.334 Vali Acc: 0.324 Test Loss: 1.334 Test Acc: 0.324
Validation loss decreased (-0.243230 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.2785398960113525
Epoch: 3, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.290 Vali Acc: 0.392 Test Loss: 1.290 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.4913394451141357
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.230 Vali Acc: 0.459 Test Loss: 1.230 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.1445794105529785
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.178 Vali Acc: 0.473 Test Loss: 1.178 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.3641877174377441
Epoch: 6, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.3170645236968994
Epoch: 7, Steps: 10 | Train Loss: 0.497 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.4056811332702637
Epoch: 8, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.108 Vali Acc: 0.473 Test Loss: 1.108 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3410193920135498
Epoch: 9, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.21419358253479
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.3738329410552979
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.114 Vali Acc: 0.527 Test Loss: 1.114 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 1.2930729389190674
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.4466991424560547
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.39558744430542
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.367112398147583
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.422656774520874
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3631019592285156
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3157107830047607
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.217 Vali Acc: 0.514 Test Loss: 1.217 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1582844257354736
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3339922428131104
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.237 Vali Acc: 0.514 Test Loss: 1.237 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.322429895401001
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.250 Vali Acc: 0.514 Test Loss: 1.250 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.31235933303833
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.258 Vali Acc: 0.514 Test Loss: 1.258 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1020740
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6551270484924316
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.374 Vali Acc: 0.311 Test Loss: 1.374 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.3816938400268555
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.324 Vali Acc: 0.432 Test Loss: 1.324 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.323768138885498
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.263 Vali Acc: 0.486 Test Loss: 1.263 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.2435576915740967
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.230 Vali Acc: 0.459 Test Loss: 1.230 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3286073207855225
Epoch: 5, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2588038444519043
Epoch: 6, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.198026180267334
Epoch: 7, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.074 Vali Acc: 0.514 Test Loss: 1.074 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 1.1811513900756836
Epoch: 8, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
Validation loss decreased (-0.513503 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.1509802341461182
Epoch: 9, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.023 Vali Acc: 0.568 Test Loss: 1.023 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.204577922821045
Epoch: 10, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.006 Vali Acc: 0.608 Test Loss: 1.006 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 1.182159185409546
Epoch: 11, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.978 Vali Acc: 0.608 Test Loss: 0.978 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.3578314781188965
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.009 Vali Acc: 0.622 Test Loss: 1.009 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 13 cost time: 1.2355351448059082
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.984 Vali Acc: 0.635 Test Loss: 0.984 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 1.3218655586242676
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.043 Vali Acc: 0.649 Test Loss: 1.043 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 15 cost time: 1.111994743347168
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.027 Vali Acc: 0.649 Test Loss: 1.027 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 16 cost time: 1.2611262798309326
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.014 Vali Acc: 0.649 Test Loss: 1.014 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 17 cost time: 1.2487049102783203
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.053 Vali Acc: 0.649 Test Loss: 1.053 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1709351539611816
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.072 Vali Acc: 0.649 Test Loss: 1.072 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3832073211669922
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.071 Vali Acc: 0.649 Test Loss: 1.071 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2330925464630127
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.088 Vali Acc: 0.649 Test Loss: 1.088 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3186745643615723
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.088 Vali Acc: 0.649 Test Loss: 1.088 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2606332302093506
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.111 Vali Acc: 0.662 Test Loss: 1.111 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662151).  Saving model ...
Epoch: 23 cost time: 1.161130666732788
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.121 Vali Acc: 0.662 Test Loss: 1.121 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.316960334777832
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.139 Vali Acc: 0.662 Test Loss: 1.139 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0801119804382324
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.150 Vali Acc: 0.662 Test Loss: 1.150 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3015272617340088
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.155 Vali Acc: 0.662 Test Loss: 1.155 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.273900032043457
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.160 Vali Acc: 0.649 Test Loss: 1.160 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2580204010009766
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.181 Vali Acc: 0.662 Test Loss: 1.181 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.311781644821167
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.191 Vali Acc: 0.649 Test Loss: 1.191 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2881672382354736
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.182 Vali Acc: 0.649 Test Loss: 1.182 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.266113519668579
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.191 Vali Acc: 0.635 Test Loss: 1.191 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2292802333831787
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.205 Vali Acc: 0.649 Test Loss: 1.205 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1006660
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4378209114074707
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.374 Vali Acc: 0.216 Test Loss: 1.374 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.2770709991455078
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
Validation loss decreased (-0.216202 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.2914352416992188
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.299 Vali Acc: 0.392 Test Loss: 1.299 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.1719775199890137
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.2574443817138672
Epoch: 5, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.1992826461791992
Epoch: 6, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.193 Vali Acc: 0.527 Test Loss: 1.193 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.3290326595306396
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2533164024353027
Epoch: 8, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.170206069946289
Epoch: 9, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.2151100635528564
Epoch: 10, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.1826395988464355
Epoch: 11, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.070 Vali Acc: 0.514 Test Loss: 1.070 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2421927452087402
Epoch: 12, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2951128482818604
Epoch: 13, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.036 Vali Acc: 0.527 Test Loss: 1.036 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1507978439331055
Epoch: 14, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.253821849822998
Epoch: 15, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0608980655670166
Epoch: 16, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.069 Vali Acc: 0.527 Test Loss: 1.069 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2439169883728027
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.083 Vali Acc: 0.527 Test Loss: 1.083 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3039250373840332
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.250136375427246
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3534526824951172
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 997700
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.591235876083374
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.378 Vali Acc: 0.243 Test Loss: 1.378 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.1837191581726074
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.364 Vali Acc: 0.284 Test Loss: 1.364 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.3621556758880615
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.331 Vali Acc: 0.324 Test Loss: 1.331 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.2725927829742432
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.300 Vali Acc: 0.365 Test Loss: 1.300 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.2471957206726074
Epoch: 5, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.266 Vali Acc: 0.392 Test Loss: 1.266 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.303985834121704
Epoch: 6, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.2521696090698242
Epoch: 7, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.199 Vali Acc: 0.473 Test Loss: 1.199 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.3968710899353027
Epoch: 8, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.4284930229187012
Epoch: 9, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.142 Vali Acc: 0.486 Test Loss: 1.142 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9882404804229736
Epoch: 10, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 1.2498886585235596
Epoch: 11, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.1611075401306152
Epoch: 12, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.2794246673583984
Epoch: 13, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.077 Vali Acc: 0.527 Test Loss: 1.077 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.0724985599517822
Epoch: 14, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1846883296966553
Epoch: 15, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.131364345550537
Epoch: 16, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.106 Vali Acc: 0.486 Test Loss: 1.106 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1599383354187012
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.109 Vali Acc: 0.486 Test Loss: 1.109 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9914910793304443
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3517954349517822
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.257361650466919
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.163 Vali Acc: 0.486 Test Loss: 1.163 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3647193908691406
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4208736419677734
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1945364475250244
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 993860
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7869865894317627
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.358 Vali Acc: 0.459 Test Loss: 1.358 Test Acc: 0.459
Validation loss decreased (inf --> -0.459446).  Saving model ...
Epoch: 2 cost time: 1.1796305179595947
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.329 Vali Acc: 0.419 Test Loss: 1.329 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3099939823150635
Epoch: 3, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.268 Vali Acc: 0.459 Test Loss: 1.268 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.2819266319274902
Epoch: 4, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.2140772342681885
Epoch: 5, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.166 Vali Acc: 0.446 Test Loss: 1.166 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.371234655380249
Epoch: 6, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.125 Vali Acc: 0.473 Test Loss: 1.125 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.217301368713379
Epoch: 7, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.8872058391571045
Epoch: 8, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.2470996379852295
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0832374095916748
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.0669164657592773
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.205 Vali Acc: 0.541 Test Loss: 1.205 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.086094617843628
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.231 Vali Acc: 0.568 Test Loss: 1.231 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 13 cost time: 1.0608811378479004
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.235 Vali Acc: 0.568 Test Loss: 1.235 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9403791427612305
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.234 Vali Acc: 0.568 Test Loss: 1.234 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0461657047271729
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.253 Vali Acc: 0.568 Test Loss: 1.253 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0811004638671875
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.270 Vali Acc: 0.568 Test Loss: 1.270 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1797523498535156
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.277 Vali Acc: 0.568 Test Loss: 1.277 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2625479698181152
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.290 Vali Acc: 0.568 Test Loss: 1.290 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2182679176330566
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.568 Test Loss: 1.294 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.325061321258545
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.298 Vali Acc: 0.568 Test Loss: 1.298 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.173192024230957
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.309 Vali Acc: 0.568 Test Loss: 1.309 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.203857660293579
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.327 Vali Acc: 0.568 Test Loss: 1.327 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 377316
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2828447818756104
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.377 Vali Acc: 0.311 Test Loss: 1.377 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.144322156906128
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.1695899963378906
Epoch: 3, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.294 Vali Acc: 0.432 Test Loss: 1.294 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.220827579498291
Epoch: 4, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
Validation loss decreased (-0.432419 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.1774158477783203
Epoch: 5, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0561320781707764
Epoch: 6, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1750059127807617
Epoch: 7, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.124 Vali Acc: 0.486 Test Loss: 1.124 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0970594882965088
Epoch: 8, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.1459226608276367
Epoch: 9, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.085 Vali Acc: 0.527 Test Loss: 1.085 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1725242137908936
Epoch: 10, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 0.9921226501464844
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 1.088778018951416
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0997028350830078
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.083 Vali Acc: 0.527 Test Loss: 1.083 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9810342788696289
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 1.078155279159546
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.119 Vali Acc: 0.595 Test Loss: 1.119 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9123883247375488
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.058612585067749
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0230152606964111
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0038084983825684
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.150 Vali Acc: 0.568 Test Loss: 1.150 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1060092449188232
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.174 Vali Acc: 0.595 Test Loss: 1.174 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.100078821182251
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.173 Vali Acc: 0.568 Test Loss: 1.173 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1353261470794678
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.176 Vali Acc: 0.568 Test Loss: 1.176 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2256641387939453
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.185 Vali Acc: 0.581 Test Loss: 1.185 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0937864780426025
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.190 Vali Acc: 0.568 Test Loss: 1.190 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 326436
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.455109119415283
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.359 Vali Acc: 0.324 Test Loss: 1.359 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.2486848831176758
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.329 Vali Acc: 0.473 Test Loss: 1.329 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.0482995510101318
Epoch: 3, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.304 Vali Acc: 0.486 Test Loss: 1.304 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 1.2249436378479004
Epoch: 4, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.270 Vali Acc: 0.486 Test Loss: 1.270 Test Acc: 0.486
Validation loss decreased (-0.486473 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.1681439876556396
Epoch: 5, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.241 Vali Acc: 0.527 Test Loss: 1.241 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.1577847003936768
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.1865906715393066
Epoch: 7, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.160 Vali Acc: 0.554 Test Loss: 1.160 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 0.9498279094696045
Epoch: 8, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.102720022201538
Epoch: 9, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.310683250427246
Epoch: 10, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.9965322017669678
Epoch: 11, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 1.1271347999572754
Epoch: 12, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.087 Vali Acc: 0.581 Test Loss: 1.087 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.0640132427215576
Epoch: 13, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 0.9889147281646729
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1697618961334229
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0823047161102295
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.143 Vali Acc: 0.568 Test Loss: 1.143 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.029975175857544
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.189 Vali Acc: 0.541 Test Loss: 1.189 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1806435585021973
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1059527397155762
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1209557056427002
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.210 Vali Acc: 0.541 Test Loss: 1.210 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2392427921295166
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.228 Vali Acc: 0.541 Test Loss: 1.228 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0950098037719727
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.256 Vali Acc: 0.514 Test Loss: 1.256 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2042312622070312
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.258 Vali Acc: 0.527 Test Loss: 1.258 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 308836
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1907732486724854
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.367 Vali Acc: 0.392 Test Loss: 1.367 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.8562242984771729
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.342 Vali Acc: 0.392 Test Loss: 1.342 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 0.8570213317871094
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.307 Vali Acc: 0.392 Test Loss: 1.307 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8737845420837402
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.7839279174804688
Epoch: 5, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.241 Vali Acc: 0.527 Test Loss: 1.241 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.8274867534637451
Epoch: 6, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.195 Vali Acc: 0.554 Test Loss: 1.195 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.9114692211151123
Epoch: 7, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.162 Vali Acc: 0.541 Test Loss: 1.162 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9490242004394531
Epoch: 8, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0333976745605469
Epoch: 9, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.2194621562957764
Epoch: 10, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.074 Vali Acc: 0.554 Test Loss: 1.074 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.1952672004699707
Epoch: 11, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0165455341339111
Epoch: 12, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.026 Vali Acc: 0.568 Test Loss: 1.026 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.040705680847168
Epoch: 13, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.008 Vali Acc: 0.595 Test Loss: 1.008 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594585).  Saving model ...
Epoch: 14 cost time: 1.0369181632995605
Epoch: 14, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.997 Vali Acc: 0.581 Test Loss: 0.997 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0683233737945557
Epoch: 15, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.096815586090088
Epoch: 16, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 17 cost time: 0.9382779598236084
Epoch: 17, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1485657691955566
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1037874221801758
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.020 Vali Acc: 0.581 Test Loss: 1.020 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.090965747833252
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0756652355194092
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.030 Vali Acc: 0.581 Test Loss: 1.030 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.162294626235962
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.038 Vali Acc: 0.581 Test Loss: 1.038 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1925067901611328
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0093469619750977
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1065220832824707
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.071 Vali Acc: 0.568 Test Loss: 1.071 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.843146562576294
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 301476
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1495635509490967
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.352 Vali Acc: 0.392 Test Loss: 1.352 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.90035080909729
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.342 Vali Acc: 0.378 Test Loss: 1.342 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9943909645080566
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.321 Vali Acc: 0.405 Test Loss: 1.321 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.0288009643554688
Epoch: 4, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.299 Vali Acc: 0.432 Test Loss: 1.299 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.138322114944458
Epoch: 5, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.281 Vali Acc: 0.473 Test Loss: 1.281 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.13456130027771
Epoch: 6, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.0552680492401123
Epoch: 7, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.221 Vali Acc: 0.541 Test Loss: 1.221 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 1.0717418193817139
Epoch: 8, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1975409984588623
Epoch: 9, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.055513620376587
Epoch: 10, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.0461997985839844
Epoch: 11, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 0.9095287322998047
Epoch: 12, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.0602102279663086
Epoch: 13, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9808855056762695
Epoch: 14, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.081 Vali Acc: 0.595 Test Loss: 1.081 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 1.055783987045288
Epoch: 15, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9941887855529785
Epoch: 16, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.069 Vali Acc: 0.554 Test Loss: 1.069 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.111022710800171
Epoch: 17, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0374987125396729
Epoch: 18, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1330986022949219
Epoch: 19, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0208353996276855
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.138413667678833
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9360942840576172
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0723392963409424
Epoch: 23, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1189804077148438
Epoch: 24, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.107 Vali Acc: 0.581 Test Loss: 1.107 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 294436
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2701215744018555
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.393 Vali Acc: 0.284 Test Loss: 1.393 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.007758378982544
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.101236343383789
Epoch: 3, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.365 Vali Acc: 0.324 Test Loss: 1.365 Test Acc: 0.324
Validation loss decreased (-0.324311 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.0127975940704346
Epoch: 4, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.347 Vali Acc: 0.419 Test Loss: 1.347 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418905).  Saving model ...
Epoch: 5 cost time: 1.0648539066314697
Epoch: 5, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.327 Vali Acc: 0.446 Test Loss: 1.327 Test Acc: 0.446
Validation loss decreased (-0.418905 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.0025312900543213
Epoch: 6, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.309 Vali Acc: 0.432 Test Loss: 1.309 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.120774507522583
Epoch: 7, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.284 Vali Acc: 0.446 Test Loss: 1.284 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.0388352870941162
Epoch: 8, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.264 Vali Acc: 0.473 Test Loss: 1.264 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 1.0004935264587402
Epoch: 9, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9853577613830566
Epoch: 10, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.223 Vali Acc: 0.473 Test Loss: 1.223 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 0.919135570526123
Epoch: 11, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 0.9199557304382324
Epoch: 12, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8506040573120117
Epoch: 13, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.179 Vali Acc: 0.473 Test Loss: 1.179 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 14 cost time: 0.9380083084106445
Epoch: 14, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.169 Vali Acc: 0.459 Test Loss: 1.169 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9915690422058105
Epoch: 15, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.156 Vali Acc: 0.486 Test Loss: 1.156 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 16 cost time: 0.9574906826019287
Epoch: 16, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.160 Vali Acc: 0.473 Test Loss: 1.160 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9454240798950195
Epoch: 17, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.159 Vali Acc: 0.473 Test Loss: 1.159 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9817032814025879
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.153 Vali Acc: 0.459 Test Loss: 1.153 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9131431579589844
Epoch: 19, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0168499946594238
Epoch: 20, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8930740356445312
Epoch: 21, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 22 cost time: 0.8968474864959717
Epoch: 22, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 23 cost time: 0.9310669898986816
Epoch: 23, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8546080589294434
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.206 Vali Acc: 0.514 Test Loss: 1.206 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8816640377044678
Epoch: 25, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9299435615539551
Epoch: 26, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0096156597137451
Epoch: 27, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.232 Vali Acc: 0.514 Test Loss: 1.232 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9996182918548584
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9716215133666992
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0444436073303223
Epoch: 30, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8272621631622314
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0656869411468506
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.294 Vali Acc: 0.486 Test Loss: 1.294 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 289956
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.245882034301758
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.366 Vali Acc: 0.392 Test Loss: 1.366 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.9875328540802002
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.358 Vali Acc: 0.419 Test Loss: 1.358 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 0.8387212753295898
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.342 Vali Acc: 0.378 Test Loss: 1.342 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9958889484405518
Epoch: 4, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.322 Vali Acc: 0.446 Test Loss: 1.322 Test Acc: 0.446
Validation loss decreased (-0.418905 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.0016701221466064
Epoch: 5, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.300 Vali Acc: 0.459 Test Loss: 1.300 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459446).  Saving model ...
Epoch: 6 cost time: 0.9611339569091797
Epoch: 6, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.277 Vali Acc: 0.486 Test Loss: 1.277 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.9965107440948486
Epoch: 7, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.248 Vali Acc: 0.541 Test Loss: 1.248 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 0.9694724082946777
Epoch: 8, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 0.952347993850708
Epoch: 9, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.062042474746704
Epoch: 10, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9367215633392334
Epoch: 11, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.141 Vali Acc: 0.554 Test Loss: 1.141 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 0.9129660129547119
Epoch: 12, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8783528804779053
Epoch: 13, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9411695003509521
Epoch: 14, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 0.9443058967590332
Epoch: 15, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 1.0058789253234863
Epoch: 16, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.074 Vali Acc: 0.541 Test Loss: 1.074 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0117621421813965
Epoch: 17, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.074 Vali Acc: 0.541 Test Loss: 1.074 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0657217502593994
Epoch: 18, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.071 Vali Acc: 0.554 Test Loss: 1.071 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 19 cost time: 0.8962812423706055
Epoch: 19, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0277833938598633
Epoch: 20, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.080 Vali Acc: 0.541 Test Loss: 1.080 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0469584465026855
Epoch: 21, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.091 Vali Acc: 0.486 Test Loss: 1.091 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8705768585205078
Epoch: 22, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9018402099609375
Epoch: 23, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8807163238525391
Epoch: 24, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9713437557220459
Epoch: 25, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.876476526260376
Epoch: 26, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8495082855224609
Epoch: 27, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8765239715576172
Epoch: 28, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 288036
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.358029842376709
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.306 Vali Acc: 0.351 Test Loss: 1.306 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.27730131149292
Epoch: 2, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 2.249783992767334
Epoch: 3, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.107 Vali Acc: 0.473 Test Loss: 1.107 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472962).  Saving model ...
Epoch: 4 cost time: 1.9441988468170166
Epoch: 4, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.896033525466919
Epoch: 5, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554041).  Saving model ...
Epoch: 6 cost time: 2.0350911617279053
Epoch: 6, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.526 Vali Acc: 0.514 Test Loss: 1.526 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1246469020843506
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.615 Vali Acc: 0.527 Test Loss: 1.615 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0910589694976807
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.625 Vali Acc: 0.514 Test Loss: 1.625 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.059138536453247
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.692 Vali Acc: 0.473 Test Loss: 1.692 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0478854179382324
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.473 Test Loss: 1.771 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5795743465423584
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.459 Test Loss: 1.773 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0297818183898926
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.486 Test Loss: 1.772 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2073633670806885
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.486 Test Loss: 1.767 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.107842445373535
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.500 Test Loss: 1.762 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1359801292419434
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.500 Test Loss: 1.763 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 4000644
model size : 15.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.842791795730591
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.357 Vali Acc: 0.338 Test Loss: 1.357 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.789989948272705
Epoch: 2, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.7040247917175293
Epoch: 3, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.537400245666504
Epoch: 4, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513503).  Saving model ...
Epoch: 5 cost time: 1.3224859237670898
Epoch: 5, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 1.3946855068206787
Epoch: 6, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5504801273345947
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.581329107284546
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6761834621429443
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.230 Vali Acc: 0.541 Test Loss: 1.230 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6060426235198975
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.253 Vali Acc: 0.527 Test Loss: 1.253 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5322778224945068
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.241 Vali Acc: 0.514 Test Loss: 1.241 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5453312397003174
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.262 Vali Acc: 0.514 Test Loss: 1.262 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6647701263427734
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.271 Vali Acc: 0.514 Test Loss: 1.271 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6178624629974365
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.514 Test Loss: 1.288 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.435448408126831
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.514 Test Loss: 1.296 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 3797124
model size : 14.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8625710010528564
Epoch: 1, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.344 Vali Acc: 0.405 Test Loss: 1.344 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.6269145011901855
Epoch: 2, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.291 Vali Acc: 0.392 Test Loss: 1.291 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7256124019622803
Epoch: 3, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.6438369750976562
Epoch: 4, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.101 Vali Acc: 0.514 Test Loss: 1.101 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 5 cost time: 1.6129937171936035
Epoch: 5, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.069 Vali Acc: 0.514 Test Loss: 1.069 Test Acc: 0.514
Validation loss decreased (-0.513503 --> -0.513503).  Saving model ...
Epoch: 6 cost time: 1.5834426879882812
Epoch: 6, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.6117253303527832
Epoch: 7, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.633910894393921
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5828421115875244
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.183 Vali Acc: 0.581 Test Loss: 1.183 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 1.507220983505249
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.186 Vali Acc: 0.581 Test Loss: 1.186 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6229021549224854
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.192 Vali Acc: 0.554 Test Loss: 1.192 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6463797092437744
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.212 Vali Acc: 0.554 Test Loss: 1.212 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.705916166305542
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.231 Vali Acc: 0.554 Test Loss: 1.231 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.732898473739624
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.231 Vali Acc: 0.568 Test Loss: 1.231 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6176011562347412
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.236 Vali Acc: 0.568 Test Loss: 1.236 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7655179500579834
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.662815809249878
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.264 Vali Acc: 0.568 Test Loss: 1.264 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.636061429977417
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.274 Vali Acc: 0.568 Test Loss: 1.274 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6135413646697998
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.280 Vali Acc: 0.581 Test Loss: 1.280 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3726724
model size : 14.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.591437339782715
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.383 Vali Acc: 0.311 Test Loss: 1.383 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.1861891746520996
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.290 Vali Acc: 0.459 Test Loss: 1.290 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.2368650436401367
Epoch: 3, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.230 Vali Acc: 0.514 Test Loss: 1.230 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.0881993770599365
Epoch: 4, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3406686782836914
Epoch: 5, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.118 Vali Acc: 0.514 Test Loss: 1.118 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.5419421195983887
Epoch: 6, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.531999111175537
Epoch: 7, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4107551574707031
Epoch: 8, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.4257709980010986
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.170 Vali Acc: 0.527 Test Loss: 1.170 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4795708656311035
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5174012184143066
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.267 Vali Acc: 0.527 Test Loss: 1.267 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5331270694732666
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.268 Vali Acc: 0.527 Test Loss: 1.268 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5027084350585938
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.263 Vali Acc: 0.527 Test Loss: 1.263 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3009541034698486
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.283 Vali Acc: 0.527 Test Loss: 1.283 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5599794387817383
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.299 Vali Acc: 0.527 Test Loss: 1.299 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5482113361358643
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.317 Vali Acc: 0.541 Test Loss: 1.317 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6228547096252441
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4768600463867188
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3697284
model size : 14.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6589813232421875
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.357 Vali Acc: 0.392 Test Loss: 1.357 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.5561871528625488
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.267 Vali Acc: 0.527 Test Loss: 1.267 Test Acc: 0.527
Validation loss decreased (-0.391878 --> -0.527014).  Saving model ...
Epoch: 3 cost time: 1.422255516052246
Epoch: 3, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2861859798431396
Epoch: 4, Steps: 10 | Train Loss: 0.879 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.527014 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.2310831546783447
Epoch: 5, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.5150964260101318
Epoch: 6, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.5210304260253906
Epoch: 7, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.036 Vali Acc: 0.527 Test Loss: 1.036 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4532995223999023
Epoch: 8, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.006 Vali Acc: 0.608 Test Loss: 1.006 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 1.5025665760040283
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4696059226989746
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.535165786743164
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.057 Vali Acc: 0.595 Test Loss: 1.057 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5562646389007568
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.067 Vali Acc: 0.581 Test Loss: 1.067 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4805378913879395
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.088 Vali Acc: 0.568 Test Loss: 1.088 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.477109432220459
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.562337875366211
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.112 Vali Acc: 0.581 Test Loss: 1.112 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5551443099975586
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.621070146560669
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.141 Vali Acc: 0.581 Test Loss: 1.141 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.507775068283081
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.153 Vali Acc: 0.554 Test Loss: 1.153 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 3669124
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5804145336151123
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.386 Vali Acc: 0.257 Test Loss: 1.386 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.4425907135009766
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.256743 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.4853711128234863
Epoch: 3, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.239 Vali Acc: 0.527 Test Loss: 1.239 Test Acc: 0.527
Validation loss decreased (-0.378365 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 1.3799872398376465
Epoch: 4, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.5064997673034668
Epoch: 5, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.5326752662658691
Epoch: 6, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.074 Vali Acc: 0.500 Test Loss: 1.074 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4889063835144043
Epoch: 7, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.5101006031036377
Epoch: 8, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.013 Vali Acc: 0.500 Test Loss: 1.013 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.489175796508789
Epoch: 9, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.003 Vali Acc: 0.541 Test Loss: 1.003 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540531).  Saving model ...
Epoch: 10 cost time: 1.534196138381958
Epoch: 10, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
Validation loss decreased (-0.540531 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 1.4919967651367188
Epoch: 11, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.012 Vali Acc: 0.568 Test Loss: 1.012 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 1.532069206237793
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.037 Vali Acc: 0.527 Test Loss: 1.037 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.546571969985962
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5148506164550781
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2608399391174316
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.076 Vali Acc: 0.541 Test Loss: 1.076 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.250835657119751
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2530043125152588
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.105 Vali Acc: 0.554 Test Loss: 1.105 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.329854965209961
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2479698657989502
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4403727054595947
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.140 Vali Acc: 0.568 Test Loss: 1.140 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3824434280395508
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.151 Vali Acc: 0.568 Test Loss: 1.151 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 3651204
model size : 14.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5481932163238525
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.386 Vali Acc: 0.284 Test Loss: 1.386 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1633970737457275
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.339 Vali Acc: 0.432 Test Loss: 1.339 Test Acc: 0.432
Validation loss decreased (-0.283770 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.46799898147583
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.285 Vali Acc: 0.486 Test Loss: 1.285 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.447582483291626
Epoch: 4, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.4151906967163086
Epoch: 5, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.3516476154327393
Epoch: 6, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.122 Vali Acc: 0.486 Test Loss: 1.122 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3799397945404053
Epoch: 7, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3918266296386719
Epoch: 8, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.063 Vali Acc: 0.486 Test Loss: 1.063 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3568909168243408
Epoch: 9, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.054 Vali Acc: 0.527 Test Loss: 1.054 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.3546512126922607
Epoch: 10, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527017).  Saving model ...
Epoch: 11 cost time: 1.28289794921875
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.044 Vali Acc: 0.541 Test Loss: 1.044 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 1.3456060886383057
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2582640647888184
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.2351398468017578
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 1.2668941020965576
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0923593044281006
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.157038688659668
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.249638557434082
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.129 Vali Acc: 0.595 Test Loss: 1.129 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 19 cost time: 1.3264310359954834
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.143 Vali Acc: 0.568 Test Loss: 1.143 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1734600067138672
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.157 Vali Acc: 0.568 Test Loss: 1.157 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1559410095214844
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.432079792022705
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.175 Vali Acc: 0.568 Test Loss: 1.175 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3738179206848145
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.182 Vali Acc: 0.581 Test Loss: 1.182 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.294231653213501
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.193 Vali Acc: 0.581 Test Loss: 1.193 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3403873443603516
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.200 Vali Acc: 0.595 Test Loss: 1.200 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3959028720855713
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.209 Vali Acc: 0.581 Test Loss: 1.209 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.361581802368164
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.219 Vali Acc: 0.581 Test Loss: 1.219 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3738124370574951
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.235 Vali Acc: 0.581 Test Loss: 1.235 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 3643524
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.334575891494751
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.361 Vali Acc: 0.338 Test Loss: 1.361 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.2946276664733887
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.250 Vali Acc: 0.486 Test Loss: 1.250 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.2773141860961914
Epoch: 3, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2561917304992676
Epoch: 4, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.3353629112243652
Epoch: 5, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.345350742340088
Epoch: 6, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.299497365951538
Epoch: 7, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.182335615158081
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.195 Vali Acc: 0.541 Test Loss: 1.195 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.086723804473877
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.238 Vali Acc: 0.568 Test Loss: 1.238 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567555).  Saving model ...
Epoch: 10 cost time: 0.9536921977996826
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.274 Vali Acc: 0.568 Test Loss: 1.274 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0014407634735107
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.290 Vali Acc: 0.581 Test Loss: 1.290 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581068).  Saving model ...
Epoch: 12 cost time: 1.1979753971099854
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.581 Test Loss: 1.291 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3309476375579834
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.305 Vali Acc: 0.595 Test Loss: 1.305 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594582).  Saving model ...
Epoch: 14 cost time: 1.3435218334197998
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.321 Vali Acc: 0.581 Test Loss: 1.321 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4107394218444824
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3884797096252441
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.581 Test Loss: 1.340 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3260209560394287
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.346 Vali Acc: 0.595 Test Loss: 1.346 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.246901273727417
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.581 Test Loss: 1.357 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1344122886657715
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.374 Vali Acc: 0.595 Test Loss: 1.374 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1202630996704102
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.595 Test Loss: 1.379 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2356593608856201
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.595 Test Loss: 1.390 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.370884656906128
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.581 Test Loss: 1.397 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.420264482498169
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.581 Test Loss: 1.406 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1164740
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.36971116065979
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.349 Vali Acc: 0.338 Test Loss: 1.349 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.2310984134674072
Epoch: 2, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.275 Vali Acc: 0.514 Test Loss: 1.275 Test Acc: 0.514
Validation loss decreased (-0.337824 --> -0.513501).  Saving model ...
Epoch: 3 cost time: 1.1482501029968262
Epoch: 3, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.211 Vali Acc: 0.514 Test Loss: 1.211 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.9930391311645508
Epoch: 4, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.144 Vali Acc: 0.527 Test Loss: 1.144 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.0560104846954346
Epoch: 5, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.210359811782837
Epoch: 6, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.067 Vali Acc: 0.527 Test Loss: 1.067 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.1949141025543213
Epoch: 7, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 1.2121868133544922
Epoch: 8, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.054 Vali Acc: 0.568 Test Loss: 1.054 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.1771695613861084
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1016597747802734
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0270440578460693
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0145478248596191
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0881762504577637
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.162 Vali Acc: 0.541 Test Loss: 1.162 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0927751064300537
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0724453926086426
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.188 Vali Acc: 0.527 Test Loss: 1.188 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2152183055877686
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1692450046539307
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.211 Vali Acc: 0.527 Test Loss: 1.211 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.296799659729004
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.224 Vali Acc: 0.527 Test Loss: 1.224 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1062980
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2501864433288574
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.368 Vali Acc: 0.270 Test Loss: 1.368 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.178309440612793
Epoch: 2, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.326 Vali Acc: 0.405 Test Loss: 1.326 Test Acc: 0.405
Validation loss decreased (-0.270257 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.1902592182159424
Epoch: 3, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.264 Vali Acc: 0.486 Test Loss: 1.264 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.9599032402038574
Epoch: 4, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9993245601654053
Epoch: 5, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.153 Vali Acc: 0.486 Test Loss: 1.153 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.1200041770935059
Epoch: 6, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.127061367034912
Epoch: 7, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.1290855407714844
Epoch: 8, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.070 Vali Acc: 0.527 Test Loss: 1.070 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0646100044250488
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.042 Vali Acc: 0.568 Test Loss: 1.042 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.041240930557251
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1864564418792725
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.112001895904541
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0557961463928223
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9533853530883789
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0265007019042969
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.142 Vali Acc: 0.581 Test Loss: 1.142 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 1.0472750663757324
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.159 Vali Acc: 0.581 Test Loss: 1.159 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0993046760559082
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.171 Vali Acc: 0.581 Test Loss: 1.171 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.146440029144287
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.179 Vali Acc: 0.568 Test Loss: 1.179 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1266686916351318
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.184 Vali Acc: 0.581 Test Loss: 1.184 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1948349475860596
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.581 Test Loss: 1.199 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1574475765228271
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.213 Vali Acc: 0.568 Test Loss: 1.213 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.211078405380249
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.218 Vali Acc: 0.581 Test Loss: 1.218 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1364455223083496
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.232 Vali Acc: 0.581 Test Loss: 1.232 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.115696907043457
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.249 Vali Acc: 0.568 Test Loss: 1.249 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0500915050506592
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1027780
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2331738471984863
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.351 Vali Acc: 0.378 Test Loss: 1.351 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.1630609035491943
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.317 Vali Acc: 0.365 Test Loss: 1.317 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0607280731201172
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.1429555416107178
Epoch: 4, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.205 Vali Acc: 0.459 Test Loss: 1.205 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0971877574920654
Epoch: 5, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.169 Vali Acc: 0.473 Test Loss: 1.169 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0245349407196045
Epoch: 6, Steps: 10 | Train Loss: 0.665 Vali Loss: 1.126 Vali Acc: 0.473 Test Loss: 1.126 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0226426124572754
Epoch: 7, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.9617376327514648
Epoch: 8, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.076 Vali Acc: 0.486 Test Loss: 1.076 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0688366889953613
Epoch: 9, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0833392143249512
Epoch: 10, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.0199999809265137
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1252293586730957
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1189613342285156
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1942899227142334
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2036840915679932
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.135380744934082
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1199853420257568
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.174025535583496
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.165485143661499
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1673271656036377
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.212 Vali Acc: 0.541 Test Loss: 1.212 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1013060
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.152902364730835
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.422 Vali Acc: 0.230 Test Loss: 1.422 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.054199457168579
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.387 Vali Acc: 0.297 Test Loss: 1.387 Test Acc: 0.297
Validation loss decreased (-0.229716 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.9011750221252441
Epoch: 3, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.332 Vali Acc: 0.419 Test Loss: 1.332 Test Acc: 0.419
Validation loss decreased (-0.297283 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.0274977684020996
Epoch: 4, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.270 Vali Acc: 0.432 Test Loss: 1.270 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.0954875946044922
Epoch: 5, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.0774304866790771
Epoch: 6, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.0966687202453613
Epoch: 7, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.2491683959960938
Epoch: 8, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.077 Vali Acc: 0.568 Test Loss: 1.077 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.2781085968017578
Epoch: 9, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 1.1616034507751465
Epoch: 10, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.063 Vali Acc: 0.595 Test Loss: 1.063 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.166985273361206
Epoch: 11, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.025 Vali Acc: 0.595 Test Loss: 1.025 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1356117725372314
Epoch: 12, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2004766464233398
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1248314380645752
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.038 Vali Acc: 0.608 Test Loss: 1.038 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1974525451660156
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1957132816314697
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1434285640716553
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.094 Vali Acc: 0.595 Test Loss: 1.094 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2361457347869873
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2585070133209229
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 998980
model size : 3.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.332204818725586
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.1108975410461426
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.386 Vali Acc: 0.284 Test Loss: 1.386 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.0729804039001465
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.362 Vali Acc: 0.351 Test Loss: 1.362 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.0634055137634277
Epoch: 4, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.321 Vali Acc: 0.392 Test Loss: 1.321 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.2717363834381104
Epoch: 5, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.282 Vali Acc: 0.432 Test Loss: 1.282 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.0550153255462646
Epoch: 6, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.2816762924194336
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.200 Vali Acc: 0.446 Test Loss: 1.200 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2733533382415771
Epoch: 8, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.2628414630889893
Epoch: 9, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.2967820167541504
Epoch: 10, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2755837440490723
Epoch: 11, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.130 Vali Acc: 0.473 Test Loss: 1.130 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2715699672698975
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 1.1780917644500732
Epoch: 13, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.116 Vali Acc: 0.486 Test Loss: 1.116 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1266319751739502
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.122 Vali Acc: 0.486 Test Loss: 1.122 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.156348705291748
Epoch: 15, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.120 Vali Acc: 0.473 Test Loss: 1.120 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2944605350494385
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.142 Vali Acc: 0.486 Test Loss: 1.142 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.175910472869873
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3133089542388916
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0824990272521973
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.181 Vali Acc: 0.446 Test Loss: 1.181 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2358767986297607
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.186 Vali Acc: 0.446 Test Loss: 1.186 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.251535415649414
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.196 Vali Acc: 0.446 Test Loss: 1.196 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.308640956878662
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 990020
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.523841142654419
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.407 Vali Acc: 0.270 Test Loss: 1.407 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0581820011138916
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.377 Vali Acc: 0.297 Test Loss: 1.377 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.1360011100769043
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.344 Vali Acc: 0.324 Test Loss: 1.344 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.0237987041473389
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.300 Vali Acc: 0.419 Test Loss: 1.300 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.1760625839233398
Epoch: 5, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.262 Vali Acc: 0.405 Test Loss: 1.262 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2382428646087646
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.2538905143737793
Epoch: 7, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.194826602935791
Epoch: 8, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1636102199554443
Epoch: 9, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1930394172668457
Epoch: 10, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.0814833641052246
Epoch: 11, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1614813804626465
Epoch: 12, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.1489121913909912
Epoch: 13, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.188877820968628
Epoch: 14, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0206844806671143
Epoch: 15, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 16 cost time: 1.2201805114746094
Epoch: 16, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1057395935058594
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3675470352172852
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1794726848602295
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1174452304840088
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1061546802520752
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.109786033630371
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0691492557525635
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0176782608032227
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.170 Vali Acc: 0.541 Test Loss: 1.170 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.104358434677124
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 986180
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.44297194480896
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.371 Vali Acc: 0.284 Test Loss: 1.371 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1888096332550049
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.342 Vali Acc: 0.392 Test Loss: 1.342 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.341085433959961
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.275 Vali Acc: 0.432 Test Loss: 1.275 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.2209327220916748
Epoch: 4, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.3113908767700195
Epoch: 5, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.164 Vali Acc: 0.581 Test Loss: 1.164 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581069).  Saving model ...
Epoch: 6 cost time: 1.0484592914581299
Epoch: 6, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2998571395874023
Epoch: 7, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.104579210281372
Epoch: 8, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.291961431503296
Epoch: 9, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1347341537475586
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2677645683288574
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.222428798675537
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.193 Vali Acc: 0.568 Test Loss: 1.193 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9745688438415527
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.203 Vali Acc: 0.581 Test Loss: 1.203 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2372934818267822
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.216 Vali Acc: 0.568 Test Loss: 1.216 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2731690406799316
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.231 Vali Acc: 0.568 Test Loss: 1.231 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1687798500061035
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.247 Vali Acc: 0.568 Test Loss: 1.247 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3371052742004395
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.258 Vali Acc: 0.568 Test Loss: 1.258 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1672289371490479
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.270 Vali Acc: 0.581 Test Loss: 1.270 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 373476
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.606511116027832
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.363 Vali Acc: 0.392 Test Loss: 1.363 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.9438581466674805
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.332 Vali Acc: 0.405 Test Loss: 1.332 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.2862074375152588
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
Validation loss decreased (-0.405392 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.1266179084777832
Epoch: 4, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.223 Vali Acc: 0.514 Test Loss: 1.223 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.275982141494751
Epoch: 5, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.106964111328125
Epoch: 6, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2702548503875732
Epoch: 7, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.101 Vali Acc: 0.527 Test Loss: 1.101 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.1476318836212158
Epoch: 8, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 1.1166496276855469
Epoch: 9, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.046 Vali Acc: 0.541 Test Loss: 1.046 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.0403692722320557
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9982078075408936
Epoch: 11, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.046 Vali Acc: 0.554 Test Loss: 1.046 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 12 cost time: 0.9931542873382568
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.064 Vali Acc: 0.554 Test Loss: 1.064 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8738729953765869
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.071 Vali Acc: 0.568 Test Loss: 1.071 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 1.1352956295013428
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8695220947265625
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9924948215484619
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.104 Vali Acc: 0.568 Test Loss: 1.104 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9025058746337891
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 18 cost time: 1.0165932178497314
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.959752082824707
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.138 Vali Acc: 0.581 Test Loss: 1.138 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.961653470993042
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.144 Vali Acc: 0.581 Test Loss: 1.144 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9978258609771729
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.151 Vali Acc: 0.581 Test Loss: 1.151 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1157593727111816
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.159 Vali Acc: 0.581 Test Loss: 1.159 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2050518989562988
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.982111930847168
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1376936435699463
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.183 Vali Acc: 0.568 Test Loss: 1.183 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0910003185272217
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2371063232421875
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.199 Vali Acc: 0.581 Test Loss: 1.199 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 322596
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.235743284225464
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.388 Vali Acc: 0.284 Test Loss: 1.388 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.079056739807129
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.369 Vali Acc: 0.351 Test Loss: 1.369 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.1928067207336426
Epoch: 3, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.343 Vali Acc: 0.419 Test Loss: 1.343 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 1.0539803504943848
Epoch: 4, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.306 Vali Acc: 0.405 Test Loss: 1.306 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1969201564788818
Epoch: 5, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
Validation loss decreased (-0.418905 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.0798475742340088
Epoch: 6, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.230 Vali Acc: 0.514 Test Loss: 1.230 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 0.7982733249664307
Epoch: 7, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.6852314472198486
Epoch: 8, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.170 Vali Acc: 0.514 Test Loss: 1.170 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.8369858264923096
Epoch: 9, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.7725560665130615
Epoch: 10, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.8589446544647217
Epoch: 11, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8091995716094971
Epoch: 12, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6377196311950684
Epoch: 13, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 0.6625101566314697
Epoch: 14, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7598562240600586
Epoch: 15, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6562848091125488
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.159 Vali Acc: 0.554 Test Loss: 1.159 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5619955062866211
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9016227722167969
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9467513561248779
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9908671379089355
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0758874416351318
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.242 Vali Acc: 0.514 Test Loss: 1.242 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0538630485534668
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2545080184936523
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.246 Vali Acc: 0.514 Test Loss: 1.246 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 304996
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.075798273086548
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.361 Vali Acc: 0.392 Test Loss: 1.361 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.0137121677398682
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.342 Vali Acc: 0.419 Test Loss: 1.342 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 0.8813736438751221
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.310 Vali Acc: 0.486 Test Loss: 1.310 Test Acc: 0.486
Validation loss decreased (-0.418905 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 1.0356323719024658
Epoch: 4, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.280 Vali Acc: 0.541 Test Loss: 1.280 Test Acc: 0.541
Validation loss decreased (-0.486473 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 1.026900053024292
Epoch: 5, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.245 Vali Acc: 0.554 Test Loss: 1.245 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 1.0461175441741943
Epoch: 6, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.0992603302001953
Epoch: 7, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.182 Vali Acc: 0.541 Test Loss: 1.182 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9755518436431885
Epoch: 8, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0426387786865234
Epoch: 9, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.100 Vali Acc: 0.622 Test Loss: 1.100 Test Acc: 0.622
Validation loss decreased (-0.554042 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 0.7332069873809814
Epoch: 10, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9431641101837158
Epoch: 11, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9406247138977051
Epoch: 12, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.023 Vali Acc: 0.595 Test Loss: 1.023 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8924398422241211
Epoch: 13, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.042 Vali Acc: 0.568 Test Loss: 1.042 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9252052307128906
Epoch: 14, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9391958713531494
Epoch: 15, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.011 Vali Acc: 0.581 Test Loss: 1.011 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8649933338165283
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.005 Vali Acc: 0.608 Test Loss: 1.005 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9514560699462891
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 18 cost time: 0.9994678497314453
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.023522138595581
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9336354732513428
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1168217658996582
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.024 Vali Acc: 0.608 Test Loss: 1.024 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9359421730041504
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9937534332275391
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.032 Vali Acc: 0.622 Test Loss: 1.032 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9450957775115967
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.038 Vali Acc: 0.622 Test Loss: 1.038 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0438241958618164
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.041 Vali Acc: 0.622 Test Loss: 1.041 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0955417156219482
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.051 Vali Acc: 0.622 Test Loss: 1.051 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9533982276916504
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.062 Vali Acc: 0.622 Test Loss: 1.062 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 297636
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0938920974731445
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.360 Vali Acc: 0.257 Test Loss: 1.360 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.792738676071167
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.330 Vali Acc: 0.338 Test Loss: 1.330 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 0.9561254978179932
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.306 Vali Acc: 0.419 Test Loss: 1.306 Test Acc: 0.419
Validation loss decreased (-0.337825 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.9048483371734619
Epoch: 4, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.281 Vali Acc: 0.446 Test Loss: 1.281 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.9548170566558838
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.248 Vali Acc: 0.541 Test Loss: 1.248 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540528).  Saving model ...
Epoch: 6 cost time: 0.9318149089813232
Epoch: 6, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.225 Vali Acc: 0.541 Test Loss: 1.225 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 7 cost time: 1.0251543521881104
Epoch: 7, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.8594844341278076
Epoch: 8, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.168 Vali Acc: 0.554 Test Loss: 1.168 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 0.9531815052032471
Epoch: 9, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.124 Vali Acc: 0.581 Test Loss: 1.124 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 0.8285963535308838
Epoch: 10, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.097 Vali Acc: 0.595 Test Loss: 1.097 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.8576085567474365
Epoch: 11, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.078 Vali Acc: 0.581 Test Loss: 1.078 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.001007318496704
Epoch: 12, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.054 Vali Acc: 0.595 Test Loss: 1.054 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 0.9119148254394531
Epoch: 13, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.026 Vali Acc: 0.608 Test Loss: 1.026 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 1.003321647644043
Epoch: 14, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 15 cost time: 0.9922595024108887
Epoch: 15, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.004 Vali Acc: 0.608 Test Loss: 1.004 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9217419624328613
Epoch: 16, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.033 Vali Acc: 0.595 Test Loss: 1.033 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9363582134246826
Epoch: 17, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.015 Vali Acc: 0.581 Test Loss: 1.015 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0242865085601807
Epoch: 18, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9671037197113037
Epoch: 19, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.922379732131958
Epoch: 20, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.117243766784668
Epoch: 21, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8128855228424072
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.042 Vali Acc: 0.608 Test Loss: 1.042 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0155246257781982
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.048 Vali Acc: 0.608 Test Loss: 1.048 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.831641435623169
Epoch: 24, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 290596
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2972593307495117
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.393 Vali Acc: 0.284 Test Loss: 1.393 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9144861698150635
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.9458329677581787
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.381 Vali Acc: 0.284 Test Loss: 1.381 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7042348384857178
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.367 Vali Acc: 0.338 Test Loss: 1.367 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 0.8609519004821777
Epoch: 5, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9542899131774902
Epoch: 6, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 7 cost time: 0.9141941070556641
Epoch: 7, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.318 Vali Acc: 0.351 Test Loss: 1.318 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 8 cost time: 1.0424301624298096
Epoch: 8, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.302 Vali Acc: 0.351 Test Loss: 1.302 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 9 cost time: 1.021169900894165
Epoch: 9, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.281 Vali Acc: 0.419 Test Loss: 1.281 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 10 cost time: 1.011099100112915
Epoch: 10, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.260 Vali Acc: 0.405 Test Loss: 1.260 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9659469127655029
Epoch: 11, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.246 Vali Acc: 0.419 Test Loss: 1.246 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 12 cost time: 1.0277702808380127
Epoch: 12, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 13 cost time: 1.0364971160888672
Epoch: 13, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 14 cost time: 1.1145782470703125
Epoch: 14, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.216 Vali Acc: 0.432 Test Loss: 1.216 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 15 cost time: 0.9177966117858887
Epoch: 15, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 16 cost time: 1.137840986251831
Epoch: 16, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.188 Vali Acc: 0.459 Test Loss: 1.188 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0773530006408691
Epoch: 17, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.193 Vali Acc: 0.432 Test Loss: 1.193 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0864593982696533
Epoch: 18, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.210 Vali Acc: 0.419 Test Loss: 1.210 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.10658860206604
Epoch: 19, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.183 Vali Acc: 0.459 Test Loss: 1.183 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0749499797821045
Epoch: 20, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.192 Vali Acc: 0.419 Test Loss: 1.192 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9902534484863281
Epoch: 21, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.053853988647461
Epoch: 22, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.206 Vali Acc: 0.432 Test Loss: 1.206 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0901403427124023
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.220 Vali Acc: 0.459 Test Loss: 1.220 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.022082805633545
Epoch: 24, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0456995964050293
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.235 Vali Acc: 0.446 Test Loss: 1.235 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 286116
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.209003448486328
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.414 Vali Acc: 0.230 Test Loss: 1.414 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.9299931526184082
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.407 Vali Acc: 0.230 Test Loss: 1.407 Test Acc: 0.230
Validation loss decreased (-0.229716 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 1.010246992111206
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.389 Vali Acc: 0.257 Test Loss: 1.389 Test Acc: 0.257
Validation loss decreased (-0.229716 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 1.0627727508544922
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 1.0294675827026367
Epoch: 5, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.348 Vali Acc: 0.419 Test Loss: 1.348 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418905).  Saving model ...
Epoch: 6 cost time: 1.0932204723358154
Epoch: 6, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.316 Vali Acc: 0.419 Test Loss: 1.316 Test Acc: 0.419
Validation loss decreased (-0.418905 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.9400444030761719
Epoch: 7, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.296 Vali Acc: 0.459 Test Loss: 1.296 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459446).  Saving model ...
Epoch: 8 cost time: 1.1077885627746582
Epoch: 8, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.271 Vali Acc: 0.473 Test Loss: 1.271 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 0.9766345024108887
Epoch: 9, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.1278691291809082
Epoch: 10, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 1.012847661972046
Epoch: 11, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1067628860473633
Epoch: 12, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.185 Vali Acc: 0.459 Test Loss: 1.185 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9390509128570557
Epoch: 13, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0469918251037598
Epoch: 14, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.152 Vali Acc: 0.446 Test Loss: 1.152 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9466791152954102
Epoch: 15, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.141 Vali Acc: 0.432 Test Loss: 1.141 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0420522689819336
Epoch: 16, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.138 Vali Acc: 0.432 Test Loss: 1.138 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0142145156860352
Epoch: 17, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.134 Vali Acc: 0.486 Test Loss: 1.134 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0830817222595215
Epoch: 18, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.134 Vali Acc: 0.446 Test Loss: 1.134 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.900587797164917
Epoch: 19, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.133 Vali Acc: 0.446 Test Loss: 1.133 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0050392150878906
Epoch: 20, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.136 Vali Acc: 0.473 Test Loss: 1.136 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 284196
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.811424732208252
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
Validation loss decreased (inf --> -0.486474).  Saving model ...
Epoch: 2 cost time: 1.5420253276824951
Epoch: 2, Steps: 10 | Train Loss: 0.635 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 1.499103307723999
Epoch: 3, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5453379154205322
Epoch: 4, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.646 Vali Acc: 0.554 Test Loss: 1.646 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554038).  Saving model ...
Epoch: 5 cost time: 1.5721628665924072
Epoch: 5, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.853 Vali Acc: 0.541 Test Loss: 1.853 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.11191725730896
Epoch: 6, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.914 Vali Acc: 0.514 Test Loss: 1.914 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7659416198730469
Epoch: 7, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.319 Vali Acc: 0.527 Test Loss: 2.319 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5951306819915771
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.415 Vali Acc: 0.500 Test Loss: 2.415 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3028688430786133
Epoch: 9, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.411018133163452
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.527 Test Loss: 2.129 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2738473415374756
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.554 Test Loss: 2.131 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4760520458221436
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.541 Test Loss: 2.120 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.190920114517212
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.108 Vali Acc: 0.554 Test Loss: 2.108 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.401259660720825
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.568 Test Loss: 2.107 Test Acc: 0.568
Validation loss decreased (-0.554038 --> -0.567546).  Saving model ...
Epoch: 15 cost time: 2.4347035884857178
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.101 Vali Acc: 0.554 Test Loss: 2.101 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4141459465026855
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.093 Vali Acc: 0.554 Test Loss: 2.093 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4674248695373535
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.554 Test Loss: 2.092 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3432118892669678
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.554 Test Loss: 2.088 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2564032077789307
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.554 Test Loss: 2.092 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4095513820648193
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.554 Test Loss: 2.089 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3536341190338135
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.554 Test Loss: 2.089 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.451864242553711
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.084 Vali Acc: 0.554 Test Loss: 2.084 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3041751384735107
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.554 Test Loss: 2.083 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2193779945373535
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.554 Test Loss: 2.086 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 3618564
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.435542345046997
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.256 Vali Acc: 0.446 Test Loss: 1.256 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 1.3922030925750732
Epoch: 2, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.172 Vali Acc: 0.432 Test Loss: 1.172 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3957221508026123
Epoch: 3, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.079 Vali Acc: 0.581 Test Loss: 1.079 Test Acc: 0.581
Validation loss decreased (-0.445933 --> -0.581070).  Saving model ...
Epoch: 4 cost time: 1.5499529838562012
Epoch: 4, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.570183515548706
Epoch: 5, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.163 Vali Acc: 0.581 Test Loss: 1.163 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5136287212371826
Epoch: 6, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.358 Vali Acc: 0.527 Test Loss: 1.358 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5900287628173828
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.307 Vali Acc: 0.473 Test Loss: 1.307 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4644107818603516
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.514 Test Loss: 1.384 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.631669282913208
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.541 Test Loss: 1.357 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4476196765899658
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.389 Vali Acc: 0.514 Test Loss: 1.389 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4801585674285889
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.514 Test Loss: 1.346 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1871521472930908
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.514 Test Loss: 1.326 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.411458969116211
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.527 Test Loss: 1.329 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3211524
model size : 12.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4787209033966064
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.288 Vali Acc: 0.459 Test Loss: 1.288 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 1.1602325439453125
Epoch: 2, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.173 Vali Acc: 0.446 Test Loss: 1.173 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.246004343032837
Epoch: 3, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 1.1404829025268555
Epoch: 4, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.352182149887085
Epoch: 5, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.160 Vali Acc: 0.554 Test Loss: 1.160 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2567734718322754
Epoch: 6, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.298424243927002
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.275 Vali Acc: 0.554 Test Loss: 1.275 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.314725637435913
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.313 Vali Acc: 0.568 Test Loss: 1.313 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567554).  Saving model ...
Epoch: 9 cost time: 1.3948862552642822
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
Validation loss decreased (-0.567554 --> -0.567555).  Saving model ...
Epoch: 10 cost time: 1.2413461208343506
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.257 Vali Acc: 0.581 Test Loss: 1.257 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 1.230699062347412
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.581 Test Loss: 1.263 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3402211666107178
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.581 Test Loss: 1.270 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3357539176940918
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.581 Test Loss: 1.273 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3187282085418701
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.568 Test Loss: 1.276 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3240454196929932
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.595 Test Loss: 1.286 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 16 cost time: 1.3596749305725098
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.283 Vali Acc: 0.568 Test Loss: 1.283 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.396540880203247
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.581 Test Loss: 1.293 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1369655132293701
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.304 Vali Acc: 0.581 Test Loss: 1.304 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1932377815246582
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.581 Test Loss: 1.301 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1645169258117676
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.595 Test Loss: 1.304 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.198500394821167
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.568 Test Loss: 1.309 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.212409257888794
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.568 Test Loss: 1.313 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2014472484588623
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.581 Test Loss: 1.318 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3385684490203857
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.568 Test Loss: 1.319 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2206294536590576
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.568 Test Loss: 1.328 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 3070724
model size : 11.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4275362491607666
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.345 Vali Acc: 0.351 Test Loss: 1.345 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.0258820056915283
Epoch: 2, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.182 Vali Acc: 0.446 Test Loss: 1.182 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 1.379080057144165
Epoch: 3, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.119 Vali Acc: 0.459 Test Loss: 1.119 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 1.218095302581787
Epoch: 4, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 1.3329780101776123
Epoch: 5, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.323636531829834
Epoch: 6, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3201136589050293
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.330223798751831
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.149 Vali Acc: 0.581 Test Loss: 1.149 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.2885150909423828
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 1.2803826332092285
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.201 Vali Acc: 0.568 Test Loss: 1.201 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1777148246765137
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.192 Vali Acc: 0.581 Test Loss: 1.192 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2350587844848633
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.189 Vali Acc: 0.595 Test Loss: 1.189 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0927903652191162
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.199 Vali Acc: 0.595 Test Loss: 1.199 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3185572624206543
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2406268119812012
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3299336433410645
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.234 Vali Acc: 0.581 Test Loss: 1.234 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2732503414154053
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.581 Test Loss: 1.240 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.298572063446045
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.247 Vali Acc: 0.568 Test Loss: 1.247 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2865643501281738
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 3011844
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3821487426757812
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.358 Vali Acc: 0.311 Test Loss: 1.358 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0886828899383545
Epoch: 2, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.1321187019348145
Epoch: 3, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.1383039951324463
Epoch: 4, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 1.2434723377227783
Epoch: 5, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1660568714141846
Epoch: 6, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1953434944152832
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0942087173461914
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1091201305389404
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.099 Vali Acc: 0.527 Test Loss: 1.099 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0884056091308594
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1081161499023438
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2008397579193115
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1809260845184326
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2982773780822754
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.144 Vali Acc: 0.527 Test Loss: 1.144 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2945284
model size : 11.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2659249305725098
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.1909246444702148
Epoch: 2, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.261 Vali Acc: 0.473 Test Loss: 1.261 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.1216049194335938
Epoch: 3, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2358677387237549
Epoch: 4, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 1.1769723892211914
Epoch: 5, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.086 Vali Acc: 0.527 Test Loss: 1.086 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.2662208080291748
Epoch: 6, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.2198007106781006
Epoch: 7, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.109 Vali Acc: 0.459 Test Loss: 1.109 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1018850803375244
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.085 Vali Acc: 0.514 Test Loss: 1.085 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0451438426971436
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.16163969039917
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0699217319488525
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0243055820465088
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.125 Vali Acc: 0.527 Test Loss: 1.125 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6562139987945557
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2439594268798828
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1065382957458496
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 16 cost time: 1.2332797050476074
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.041694164276123
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1152985095977783
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.186 Vali Acc: 0.554 Test Loss: 1.186 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.132467269897461
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.194 Vali Acc: 0.554 Test Loss: 1.194 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0855810642242432
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.203 Vali Acc: 0.554 Test Loss: 1.203 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.10298490524292
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9794130325317383
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2027463912963867
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.215 Vali Acc: 0.554 Test Loss: 1.215 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2351915836334229
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2492706775665283
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2919684
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2446858882904053
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.387 Vali Acc: 0.338 Test Loss: 1.387 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0193595886230469
Epoch: 2, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.277 Vali Acc: 0.473 Test Loss: 1.277 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.0313289165496826
Epoch: 3, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.021153211593628
Epoch: 4, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.9995653629302979
Epoch: 5, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8766918182373047
Epoch: 6, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.7964308261871338
Epoch: 7, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 1.2087609767913818
Epoch: 8, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2339789867401123
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2107818126678467
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0635254383087158
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2167747020721436
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1877069473266602
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.185 Vali Acc: 0.554 Test Loss: 1.185 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2182512283325195
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.181 Vali Acc: 0.541 Test Loss: 1.181 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1685919761657715
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.188 Vali Acc: 0.541 Test Loss: 1.188 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1922388076782227
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.209 Vali Acc: 0.527 Test Loss: 1.209 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1530382633209229
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.214 Vali Acc: 0.541 Test Loss: 1.214 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2904324
model size : 11.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1253767013549805
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.331 Vali Acc: 0.365 Test Loss: 1.331 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.2004268169403076
Epoch: 2, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.195 Vali Acc: 0.419 Test Loss: 1.195 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418907).  Saving model ...
Epoch: 3 cost time: 1.2657830715179443
Epoch: 3, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.248 Vali Acc: 0.446 Test Loss: 1.248 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.313260793685913
Epoch: 4, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.539 Vali Acc: 0.446 Test Loss: 1.539 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1485464572906494
Epoch: 5, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.605 Vali Acc: 0.486 Test Loss: 1.605 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486470).  Saving model ...
Epoch: 6 cost time: 1.0964863300323486
Epoch: 6, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.566 Vali Acc: 0.541 Test Loss: 1.566 Test Acc: 0.541
Validation loss decreased (-0.486470 --> -0.540525).  Saving model ...
Epoch: 7 cost time: 1.0547006130218506
Epoch: 7, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.531 Vali Acc: 0.514 Test Loss: 1.531 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1722302436828613
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9701008796691895
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.486 Test Loss: 1.585 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8226058483123779
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3549468517303467
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.235405683517456
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.486 Test Loss: 1.586 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3303534984588623
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.500 Test Loss: 1.582 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2451965808868408
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.486 Test Loss: 1.584 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3488657474517822
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1349563598632812
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1153924
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.192244291305542
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.292 Vali Acc: 0.432 Test Loss: 1.292 Test Acc: 0.432
Validation loss decreased (inf --> -0.432420).  Saving model ...
Epoch: 2 cost time: 0.9348211288452148
Epoch: 2, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.9995214939117432
Epoch: 3, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 0.9890501499176025
Epoch: 4, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9335448741912842
Epoch: 5, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 1.0457019805908203
Epoch: 6, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9377498626708984
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9910883903503418
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9409253597259521
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0078513622283936
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.137 Vali Acc: 0.554 Test Loss: 1.137 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9747135639190674
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9744336605072021
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8325774669647217
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.876300573348999
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6971173286437988
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 950404
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.117828607559204
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.354 Vali Acc: 0.351 Test Loss: 1.354 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.8193001747131348
Epoch: 2, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.266 Vali Acc: 0.459 Test Loss: 1.266 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 0.8991625308990479
Epoch: 3, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 0.8532967567443848
Epoch: 4, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 0.9024114608764648
Epoch: 5, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8552868366241455
Epoch: 6, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.8510582447052002
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9217300415039062
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8574156761169434
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 0.833111047744751
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.198 Vali Acc: 0.595 Test Loss: 1.198 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 11 cost time: 0.8440690040588379
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.196 Vali Acc: 0.568 Test Loss: 1.196 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9192700386047363
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.203 Vali Acc: 0.554 Test Loss: 1.203 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.947603702545166
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.199 Vali Acc: 0.568 Test Loss: 1.199 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8975393772125244
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.211 Vali Acc: 0.595 Test Loss: 1.211 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9674322605133057
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.224 Vali Acc: 0.581 Test Loss: 1.224 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8669064044952393
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.240 Vali Acc: 0.554 Test Loss: 1.240 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.000866174697876
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.233 Vali Acc: 0.568 Test Loss: 1.233 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8944027423858643
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8810327053070068
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.259 Vali Acc: 0.554 Test Loss: 1.259 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7982814311981201
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.267 Vali Acc: 0.554 Test Loss: 1.267 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 880004
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.12666392326355
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.342 Vali Acc: 0.297 Test Loss: 1.342 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.9285271167755127
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
Validation loss decreased (-0.297284 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.9116382598876953
Epoch: 3, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 0.9421586990356445
Epoch: 4, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 0.9558470249176025
Epoch: 5, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.081 Vali Acc: 0.514 Test Loss: 1.081 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8384652137756348
Epoch: 6, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.035 Vali Acc: 0.541 Test Loss: 1.035 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.9653379917144775
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.8194572925567627
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.105 Vali Acc: 0.527 Test Loss: 1.105 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8735659122467041
Epoch: 9, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.099 Vali Acc: 0.527 Test Loss: 1.099 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8806324005126953
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.0236310958862305
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9073328971862793
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9738705158233643
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9043121337890625
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9450080394744873
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7849645614624023
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8735861778259277
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.138 Vali Acc: 0.554 Test Loss: 1.138 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9179556369781494
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9341578483581543
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9231903553009033
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.158 Vali Acc: 0.568 Test Loss: 1.158 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 850564
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0425171852111816
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.409 Vali Acc: 0.230 Test Loss: 1.409 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.8052854537963867
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.299 Vali Acc: 0.338 Test Loss: 1.299 Test Acc: 0.338
Validation loss decreased (-0.229716 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 0.852043628692627
Epoch: 3, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.200 Vali Acc: 0.432 Test Loss: 1.200 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.799994707107544
Epoch: 4, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8523476123809814
Epoch: 5, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.084 Vali Acc: 0.486 Test Loss: 1.084 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9317793846130371
Epoch: 6, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.050 Vali Acc: 0.500 Test Loss: 1.050 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.015805959701538
Epoch: 7, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.028 Vali Acc: 0.527 Test Loss: 1.028 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527017).  Saving model ...
Epoch: 8 cost time: 0.8483829498291016
Epoch: 8, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.028 Vali Acc: 0.541 Test Loss: 1.028 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 0.9591255187988281
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.049 Vali Acc: 0.527 Test Loss: 1.049 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9545533657073975
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.034 Vali Acc: 0.554 Test Loss: 1.034 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 11 cost time: 0.9435040950775146
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9002633094787598
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 0.8390281200408936
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.045 Vali Acc: 0.581 Test Loss: 1.045 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 0.8780288696289062
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9453809261322021
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7518441677093506
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.074 Vali Acc: 0.608 Test Loss: 1.074 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608097).  Saving model ...
Epoch: 17 cost time: 0.9745211601257324
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9398126602172852
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.079 Vali Acc: 0.595 Test Loss: 1.079 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8921792507171631
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.087 Vali Acc: 0.595 Test Loss: 1.087 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8928718566894531
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.090 Vali Acc: 0.595 Test Loss: 1.090 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9603109359741211
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9222502708435059
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.103 Vali Acc: 0.595 Test Loss: 1.103 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9629306793212891
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.110 Vali Acc: 0.595 Test Loss: 1.110 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8932619094848633
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.111 Vali Acc: 0.595 Test Loss: 1.111 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9540879726409912
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.113 Vali Acc: 0.595 Test Loss: 1.113 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8563337326049805
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 817284
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9943633079528809
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.8655645847320557
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.349 Vali Acc: 0.351 Test Loss: 1.349 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8732779026031494
Epoch: 3, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.307 Vali Acc: 0.432 Test Loss: 1.307 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.9260756969451904
Epoch: 4, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.8583202362060547
Epoch: 5, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.199 Vali Acc: 0.473 Test Loss: 1.199 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7911756038665771
Epoch: 6, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.8617324829101562
Epoch: 7, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8640904426574707
Epoch: 8, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.145 Vali Acc: 0.514 Test Loss: 1.145 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.7999484539031982
Epoch: 9, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.129 Vali Acc: 0.459 Test Loss: 1.129 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7652332782745361
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8967230319976807
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8802845478057861
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8071770668029785
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6740412712097168
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9581716060638428
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9110543727874756
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8366720676422119
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9062254428863525
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 804484
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1374869346618652
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.396 Vali Acc: 0.324 Test Loss: 1.396 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 0.7816166877746582
Epoch: 2, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.338 Vali Acc: 0.338 Test Loss: 1.338 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.5340991020202637
Epoch: 3, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.337824 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.7761542797088623
Epoch: 4, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.239 Vali Acc: 0.446 Test Loss: 1.239 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7690742015838623
Epoch: 5, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.8263459205627441
Epoch: 6, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.7631874084472656
Epoch: 7, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.145 Vali Acc: 0.473 Test Loss: 1.145 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.858128547668457
Epoch: 8, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.098 Vali Acc: 0.527 Test Loss: 1.098 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.9641444683074951
Epoch: 9, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8573203086853027
Epoch: 10, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9381663799285889
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9854736328125
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.118 Vali Acc: 0.527 Test Loss: 1.118 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9201128482818604
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9058165550231934
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8185529708862305
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8457334041595459
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 0.8188736438751221
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6787502765655518
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8462612628936768
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8953325748443604
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.210 Vali Acc: 0.541 Test Loss: 1.210 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8156695365905762
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9311733245849609
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0321977138519287
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.232 Vali Acc: 0.527 Test Loss: 1.232 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9118802547454834
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.244 Vali Acc: 0.527 Test Loss: 1.244 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.867232084274292
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.248 Vali Acc: 0.554 Test Loss: 1.248 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 26 cost time: 0.967125415802002
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.261 Vali Acc: 0.554 Test Loss: 1.261 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9907193183898926
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8519642353057861
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.273 Vali Acc: 0.541 Test Loss: 1.273 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0228102207183838
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.275 Vali Acc: 0.554 Test Loss: 1.275 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9780261516571045
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.276 Vali Acc: 0.554 Test Loss: 1.276 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8309218883514404
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.284 Vali Acc: 0.527 Test Loss: 1.284 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9152781963348389
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.290 Vali Acc: 0.541 Test Loss: 1.290 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7383406162261963
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6002225875854492
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.309 Vali Acc: 0.541 Test Loss: 1.309 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9752864837646484
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.313 Vali Acc: 0.541 Test Loss: 1.313 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 796804
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.174917459487915
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.334 Vali Acc: 0.446 Test Loss: 1.334 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 0.9882838726043701
Epoch: 2, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 0.9514410495758057
Epoch: 3, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 0.9801411628723145
Epoch: 4, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.009 Vali Acc: 0.554 Test Loss: 1.009 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 5 cost time: 1.019167423248291
Epoch: 5, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.046 Vali Acc: 0.554 Test Loss: 1.046 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9391701221466064
Epoch: 6, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.257 Vali Acc: 0.554 Test Loss: 1.257 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8565633296966553
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.119 Vali Acc: 0.595 Test Loss: 1.119 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 1.0478589534759521
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.154 Vali Acc: 0.595 Test Loss: 1.154 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0373384952545166
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.230 Vali Acc: 0.622 Test Loss: 1.230 Test Acc: 0.622
Validation loss decreased (-0.594583 --> -0.621609).  Saving model ...
Epoch: 10 cost time: 0.8653116226196289
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.159 Vali Acc: 0.581 Test Loss: 1.159 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0631365776062012
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.156 Vali Acc: 0.581 Test Loss: 1.156 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.027064561843872
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.179 Vali Acc: 0.595 Test Loss: 1.179 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8708329200744629
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.193 Vali Acc: 0.608 Test Loss: 1.193 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0024118423461914
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.195 Vali Acc: 0.595 Test Loss: 1.195 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0476391315460205
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.192 Vali Acc: 0.581 Test Loss: 1.192 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9770083427429199
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9425790309906006
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.207 Vali Acc: 0.568 Test Loss: 1.207 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0240628719329834
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.214 Vali Acc: 0.581 Test Loss: 1.214 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.03434419631958
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.581 Test Loss: 1.222 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 413124
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0179176330566406
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.359 Vali Acc: 0.311 Test Loss: 1.359 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8692276477813721
Epoch: 2, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 0.7932968139648438
Epoch: 3, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.837716817855835
Epoch: 4, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8293259143829346
Epoch: 5, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.6570806503295898
Epoch: 6, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6915597915649414
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.6616530418395996
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7286629676818848
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.8573112487792969
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8138139247894287
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7457582950592041
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9290666580200195
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8905246257781982
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8570044040679932
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.980144739151001
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8949873447418213
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9306883811950684
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9252080917358398
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.211 Vali Acc: 0.527 Test Loss: 1.211 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 311364
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8576760292053223
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.399 Vali Acc: 0.216 Test Loss: 1.399 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.8666825294494629
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.337 Vali Acc: 0.311 Test Loss: 1.337 Test Acc: 0.311
Validation loss decreased (-0.216202 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.8658206462860107
Epoch: 3, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.7675631046295166
Epoch: 4, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.8565826416015625
Epoch: 5, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.129 Vali Acc: 0.473 Test Loss: 1.129 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7948830127716064
Epoch: 6, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.8722138404846191
Epoch: 7, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9606831073760986
Epoch: 8, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.898017168045044
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.838249921798706
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.090 Vali Acc: 0.514 Test Loss: 1.090 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9281940460205078
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8598926067352295
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.994645357131958
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9635429382324219
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.001152515411377
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.107541561126709
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9279110431671143
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8612656593322754
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 19 cost time: 1.0689876079559326
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0417964458465576
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8291888236999512
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0125582218170166
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9871275424957275
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8473763465881348
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9389441013336182
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8346719741821289
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8013784885406494
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8915855884552002
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.187 Vali Acc: 0.514 Test Loss: 1.187 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 276164
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9644427299499512
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.365 Vali Acc: 0.270 Test Loss: 1.365 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.7888858318328857
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.300 Vali Acc: 0.459 Test Loss: 1.300 Test Acc: 0.459
Validation loss decreased (-0.270257 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.7642183303833008
Epoch: 3, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.7658507823944092
Epoch: 4, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8617732524871826
Epoch: 5, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.7286169528961182
Epoch: 6, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7088189125061035
Epoch: 7, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8263084888458252
Epoch: 8, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8533618450164795
Epoch: 9, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.953256368637085
Epoch: 10, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.779543399810791
Epoch: 11, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 0.8687357902526855
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8675155639648438
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8228316307067871
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9342837333679199
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.88712477684021
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.130 Vali Acc: 0.541 Test Loss: 1.130 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.929236650466919
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.829603910446167
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.887211799621582
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.149 Vali Acc: 0.541 Test Loss: 1.149 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.935833215713501
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8220846652984619
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 261444
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1937084197998047
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.342 Vali Acc: 0.365 Test Loss: 1.342 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 0.9227845668792725
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.283 Vali Acc: 0.446 Test Loss: 1.283 Test Acc: 0.446
Validation loss decreased (-0.364851 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.7999129295349121
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.214 Vali Acc: 0.527 Test Loss: 1.214 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.8777751922607422
Epoch: 4, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 0.9072258472442627
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.099 Vali Acc: 0.527 Test Loss: 1.099 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7428665161132812
Epoch: 6, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.7252240180969238
Epoch: 7, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.016 Vali Acc: 0.527 Test Loss: 1.016 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.734612226486206
Epoch: 8, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.995 Vali Acc: 0.568 Test Loss: 0.995 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 9 cost time: 0.565781831741333
Epoch: 9, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.973 Vali Acc: 0.554 Test Loss: 0.973 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7794809341430664
Epoch: 10, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.963 Vali Acc: 0.568 Test Loss: 0.963 Test Acc: 0.568
Validation loss decreased (-0.567558 --> -0.567558).  Saving model ...
Epoch: 11 cost time: 0.8158631324768066
Epoch: 11, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.961 Vali Acc: 0.527 Test Loss: 0.961 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7956852912902832
Epoch: 12, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.949 Vali Acc: 0.595 Test Loss: 0.949 Test Acc: 0.595
Validation loss decreased (-0.567558 --> -0.594585).  Saving model ...
Epoch: 13 cost time: 0.9013617038726807
Epoch: 13, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.957 Vali Acc: 0.554 Test Loss: 0.957 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8288660049438477
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.952 Vali Acc: 0.581 Test Loss: 0.952 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8291499614715576
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.959 Vali Acc: 0.581 Test Loss: 0.959 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8811600208282471
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.969 Vali Acc: 0.581 Test Loss: 0.969 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8960976600646973
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.978 Vali Acc: 0.554 Test Loss: 0.978 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8644728660583496
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.960 Vali Acc: 0.568 Test Loss: 0.960 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8411610126495361
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.973 Vali Acc: 0.595 Test Loss: 0.973 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8793289661407471
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.977 Vali Acc: 0.581 Test Loss: 0.977 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8620767593383789
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.975 Vali Acc: 0.581 Test Loss: 0.975 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7228555679321289
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.974 Vali Acc: 0.595 Test Loss: 0.974 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 244804
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.950798511505127
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.828850269317627
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.342 Vali Acc: 0.311 Test Loss: 1.342 Test Acc: 0.311
Validation loss decreased (-0.270257 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.82395339012146
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.283 Vali Acc: 0.392 Test Loss: 1.283 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.7684338092803955
Epoch: 4, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.7577083110809326
Epoch: 5, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.6897532939910889
Epoch: 6, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.7960648536682129
Epoch: 7, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.8115723133087158
Epoch: 8, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8071467876434326
Epoch: 9, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7919521331787109
Epoch: 10, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.093 Vali Acc: 0.486 Test Loss: 1.093 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8031101226806641
Epoch: 11, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.051 Vali Acc: 0.527 Test Loss: 1.051 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8113610744476318
Epoch: 12, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.064 Vali Acc: 0.554 Test Loss: 1.064 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 0.6733429431915283
Epoch: 13, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.050 Vali Acc: 0.541 Test Loss: 1.050 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7224915027618408
Epoch: 14, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.031 Vali Acc: 0.527 Test Loss: 1.031 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7261121273040771
Epoch: 15, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 16 cost time: 0.8710064888000488
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.049 Vali Acc: 0.527 Test Loss: 1.049 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7788524627685547
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 18 cost time: 0.8337452411651611
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.032 Vali Acc: 0.541 Test Loss: 1.032 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7459354400634766
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.051 Vali Acc: 0.541 Test Loss: 1.051 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8077282905578613
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.048 Vali Acc: 0.527 Test Loss: 1.048 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8550751209259033
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7047710418701172
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.052 Vali Acc: 0.554 Test Loss: 1.052 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8761661052703857
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 24 cost time: 0.8978104591369629
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8292782306671143
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 26 cost time: 0.8805193901062012
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8577883243560791
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6732654571533203
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.635101318359375
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8247554302215576
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7430262565612793
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6979713439941406
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8165323734283447
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7629232406616211
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8853988647460938
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 238404
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.074791431427002
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.391 Vali Acc: 0.297 Test Loss: 1.391 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.7117676734924316
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.356 Vali Acc: 0.338 Test Loss: 1.356 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.8057408332824707
Epoch: 3, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.318 Vali Acc: 0.351 Test Loss: 1.318 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7746751308441162
Epoch: 4, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.273 Vali Acc: 0.378 Test Loss: 1.273 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 0.5891175270080566
Epoch: 5, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.246 Vali Acc: 0.432 Test Loss: 1.246 Test Acc: 0.432
Validation loss decreased (-0.378366 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.7751481533050537
Epoch: 6, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.205 Vali Acc: 0.446 Test Loss: 1.205 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.7904157638549805
Epoch: 7, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.180 Vali Acc: 0.473 Test Loss: 1.180 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.8053970336914062
Epoch: 8, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.146 Vali Acc: 0.473 Test Loss: 1.146 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 9 cost time: 0.994457483291626
Epoch: 9, Steps: 10 | Train Loss: 0.498 Vali Loss: 1.173 Vali Acc: 0.432 Test Loss: 1.173 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8444633483886719
Epoch: 10, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.132 Vali Acc: 0.459 Test Loss: 1.132 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.859774112701416
Epoch: 11, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.121 Vali Acc: 0.514 Test Loss: 1.121 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 0.8568131923675537
Epoch: 12, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.134 Vali Acc: 0.486 Test Loss: 1.134 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.802386999130249
Epoch: 13, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8697829246520996
Epoch: 14, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 0.8914487361907959
Epoch: 15, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8499579429626465
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8850729465484619
Epoch: 17, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.132 Vali Acc: 0.486 Test Loss: 1.132 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8334324359893799
Epoch: 18, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.823129415512085
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.784949541091919
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8905484676361084
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9005908966064453
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9406774044036865
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.187 Vali Acc: 0.473 Test Loss: 1.187 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9211513996124268
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.194 Vali Acc: 0.473 Test Loss: 1.194 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 234564
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8261122703552246
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.422 Vali Acc: 0.230 Test Loss: 1.422 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.806398868560791
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.317 Vali Acc: 0.432 Test Loss: 1.317 Test Acc: 0.432
Validation loss decreased (-0.229716 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.8703906536102295
Epoch: 3, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.256 Vali Acc: 0.514 Test Loss: 1.256 Test Acc: 0.514
Validation loss decreased (-0.432419 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.7384805679321289
Epoch: 4, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 0.6490976810455322
Epoch: 5, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.841292142868042
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6376726627349854
Epoch: 7, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.129 Vali Acc: 0.514 Test Loss: 1.129 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7094886302947998
Epoch: 8, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6306028366088867
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.175 Vali Acc: 0.608 Test Loss: 1.175 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608096).  Saving model ...
Epoch: 10 cost time: 0.6359305381774902
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7900729179382324
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.196 Vali Acc: 0.554 Test Loss: 1.196 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7515614032745361
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.183 Vali Acc: 0.541 Test Loss: 1.183 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8335916996002197
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.205 Vali Acc: 0.581 Test Loss: 1.205 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9291346073150635
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.217 Vali Acc: 0.568 Test Loss: 1.217 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7300951480865479
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.217 Vali Acc: 0.541 Test Loss: 1.217 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9897670745849609
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8902816772460938
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.231 Vali Acc: 0.554 Test Loss: 1.231 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7681500911712646
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.236 Vali Acc: 0.554 Test Loss: 1.236 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8871593475341797
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.242 Vali Acc: 0.541 Test Loss: 1.242 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 165604
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8355412483215332
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.426 Vali Acc: 0.176 Test Loss: 1.426 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 0.7520241737365723
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.362 Vali Acc: 0.338 Test Loss: 1.362 Test Acc: 0.338
Validation loss decreased (-0.175661 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.6336779594421387
Epoch: 3, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.331 Vali Acc: 0.351 Test Loss: 1.331 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7412292957305908
Epoch: 4, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.249 Vali Acc: 0.514 Test Loss: 1.249 Test Acc: 0.514
Validation loss decreased (-0.351338 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 0.7538931369781494
Epoch: 5, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.206 Vali Acc: 0.473 Test Loss: 1.206 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7577593326568604
Epoch: 6, Steps: 10 | Train Loss: 0.525 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7555058002471924
Epoch: 7, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.188 Vali Acc: 0.541 Test Loss: 1.188 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.8639614582061768
Epoch: 8, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.136 Vali Acc: 0.486 Test Loss: 1.136 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7955636978149414
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9187617301940918
Epoch: 10, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9413995742797852
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6803839206695557
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.129 Vali Acc: 0.514 Test Loss: 1.129 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8192939758300781
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.151 Vali Acc: 0.568 Test Loss: 1.151 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 0.7491707801818848
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6859273910522461
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.151 Vali Acc: 0.581 Test Loss: 1.151 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 0.6754150390625
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 17 cost time: 0.7564074993133545
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.171 Vali Acc: 0.568 Test Loss: 1.171 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6091451644897461
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.168 Vali Acc: 0.595 Test Loss: 1.168 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8432738780975342
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8124954700469971
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.183 Vali Acc: 0.554 Test Loss: 1.183 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8425099849700928
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.186 Vali Acc: 0.568 Test Loss: 1.186 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8018009662628174
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.180 Vali Acc: 0.608 Test Loss: 1.180 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 23 cost time: 0.7869689464569092
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.186 Vali Acc: 0.595 Test Loss: 1.186 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8337996006011963
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.196 Vali Acc: 0.581 Test Loss: 1.196 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9286565780639648
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.207 Vali Acc: 0.581 Test Loss: 1.207 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8326618671417236
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.208 Vali Acc: 0.581 Test Loss: 1.208 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9031205177307129
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.213 Vali Acc: 0.568 Test Loss: 1.213 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8676533699035645
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.210 Vali Acc: 0.581 Test Loss: 1.210 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7398383617401123
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.223 Vali Acc: 0.568 Test Loss: 1.223 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8826138973236084
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.229 Vali Acc: 0.568 Test Loss: 1.229 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8088836669921875
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.232 Vali Acc: 0.568 Test Loss: 1.232 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8485491275787354
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.231 Vali Acc: 0.581 Test Loss: 1.231 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 114724
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.008275032043457
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.366 Vali Acc: 0.257 Test Loss: 1.366 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.7499494552612305
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.335 Vali Acc: 0.297 Test Loss: 1.335 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.7481803894042969
Epoch: 3, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
Validation loss decreased (-0.297284 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.8256955146789551
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.6957230567932129
Epoch: 5, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.211 Vali Acc: 0.432 Test Loss: 1.211 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8035964965820312
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.142 Vali Acc: 0.486 Test Loss: 1.142 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.7469909191131592
Epoch: 7, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.124 Vali Acc: 0.486 Test Loss: 1.124 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.7096590995788574
Epoch: 8, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.6153264045715332
Epoch: 9, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6205499172210693
Epoch: 10, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6318948268890381
Epoch: 11, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 0.672774076461792
Epoch: 12, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.054 Vali Acc: 0.541 Test Loss: 1.054 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6944103240966797
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7547588348388672
Epoch: 14, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.057 Vali Acc: 0.527 Test Loss: 1.057 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7687332630157471
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6777486801147461
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8192815780639648
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7736873626708984
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6342415809631348
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7846791744232178
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.079 Vali Acc: 0.527 Test Loss: 1.079 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7411408424377441
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 97124
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0578527450561523
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.353 Vali Acc: 0.351 Test Loss: 1.353 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.8341431617736816
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.341 Vali Acc: 0.311 Test Loss: 1.341 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9155216217041016
Epoch: 3, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.302 Vali Acc: 0.405 Test Loss: 1.302 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.8494992256164551
Epoch: 4, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.8596351146697998
Epoch: 5, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.201 Vali Acc: 0.541 Test Loss: 1.201 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9431593418121338
Epoch: 6, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.177 Vali Acc: 0.486 Test Loss: 1.177 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7799396514892578
Epoch: 7, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.165 Vali Acc: 0.473 Test Loss: 1.165 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7299709320068359
Epoch: 8, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9238419532775879
Epoch: 9, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8754024505615234
Epoch: 10, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 0.8457942008972168
Epoch: 11, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 0.8994901180267334
Epoch: 12, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.079 Vali Acc: 0.527 Test Loss: 1.079 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9121901988983154
Epoch: 13, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 14 cost time: 0.8131365776062012
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9073610305786133
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 0.8950624465942383
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.080 Vali Acc: 0.514 Test Loss: 1.080 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7666769027709961
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.096 Vali Acc: 0.514 Test Loss: 1.096 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7523910999298096
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7262153625488281
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7348871231079102
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7366726398468018
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7694685459136963
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.106 Vali Acc: 0.527 Test Loss: 1.106 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8491051197052002
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8461847305297852
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8182082176208496
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 89764
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.077404260635376
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.370 Vali Acc: 0.270 Test Loss: 1.370 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.8500890731811523
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.358 Vali Acc: 0.284 Test Loss: 1.358 Test Acc: 0.284
Validation loss decreased (-0.270257 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.8577501773834229
Epoch: 3, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.8491921424865723
Epoch: 4, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.305 Vali Acc: 0.351 Test Loss: 1.305 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.8119826316833496
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.260 Vali Acc: 0.446 Test Loss: 1.260 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.9200761318206787
Epoch: 6, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.231 Vali Acc: 0.392 Test Loss: 1.231 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8587377071380615
Epoch: 7, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.213 Vali Acc: 0.432 Test Loss: 1.213 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.782867431640625
Epoch: 8, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.192 Vali Acc: 0.419 Test Loss: 1.192 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8606398105621338
Epoch: 9, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459448).  Saving model ...
Epoch: 10 cost time: 0.8708286285400391
Epoch: 10, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.148 Vali Acc: 0.473 Test Loss: 1.148 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 0.8022260665893555
Epoch: 11, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.139 Vali Acc: 0.473 Test Loss: 1.139 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 12 cost time: 0.8977866172790527
Epoch: 12, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.118 Vali Acc: 0.473 Test Loss: 1.118 Test Acc: 0.473
Validation loss decreased (-0.472962 --> -0.472962).  Saving model ...
Epoch: 13 cost time: 0.8859963417053223
Epoch: 13, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.115 Vali Acc: 0.473 Test Loss: 1.115 Test Acc: 0.473
Validation loss decreased (-0.472962 --> -0.472962).  Saving model ...
Epoch: 14 cost time: 0.8120367527008057
Epoch: 14, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.093 Vali Acc: 0.446 Test Loss: 1.093 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9719221591949463
Epoch: 15, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.100 Vali Acc: 0.514 Test Loss: 1.100 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513503).  Saving model ...
Epoch: 16 cost time: 0.8740060329437256
Epoch: 16, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.097 Vali Acc: 0.514 Test Loss: 1.097 Test Acc: 0.514
Validation loss decreased (-0.513503 --> -0.513503).  Saving model ...
Epoch: 17 cost time: 0.7629578113555908
Epoch: 17, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.109 Vali Acc: 0.486 Test Loss: 1.109 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8594748973846436
Epoch: 18, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 19 cost time: 0.8812735080718994
Epoch: 19, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8429844379425049
Epoch: 20, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.114 Vali Acc: 0.527 Test Loss: 1.114 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8197102546691895
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7679059505462646
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7893657684326172
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7089242935180664
Epoch: 24, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7500925064086914
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.130 Vali Acc: 0.541 Test Loss: 1.130 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.721813440322876
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6386759281158447
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7123842239379883
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 81444
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0907583236694336
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.392 Vali Acc: 0.257 Test Loss: 1.392 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.8008549213409424
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.381 Vali Acc: 0.243 Test Loss: 1.381 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7229170799255371
Epoch: 3, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.353 Vali Acc: 0.297 Test Loss: 1.353 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 0.8572385311126709
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.325 Vali Acc: 0.351 Test Loss: 1.325 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.8328640460968018
Epoch: 5, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.297 Vali Acc: 0.432 Test Loss: 1.297 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 0.8588917255401611
Epoch: 6, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 0.9269049167633057
Epoch: 7, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.249 Vali Acc: 0.392 Test Loss: 1.249 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7811882495880127
Epoch: 8, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 0.8642466068267822
Epoch: 9, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.8649871349334717
Epoch: 10, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.797673225402832
Epoch: 11, Steps: 10 | Train Loss: 0.583 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 0.7082419395446777
Epoch: 12, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.8211307525634766
Epoch: 13, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 0.8292479515075684
Epoch: 14, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7393748760223389
Epoch: 15, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 0.8820626735687256
Epoch: 16, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.106 Vali Acc: 0.486 Test Loss: 1.106 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9209728240966797
Epoch: 17, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.115 Vali Acc: 0.486 Test Loss: 1.115 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8401153087615967
Epoch: 18, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.102 Vali Acc: 0.486 Test Loss: 1.102 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8894727230072021
Epoch: 19, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.111 Vali Acc: 0.473 Test Loss: 1.111 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8947081565856934
Epoch: 20, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.127 Vali Acc: 0.486 Test Loss: 1.127 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8298547267913818
Epoch: 21, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.122 Vali Acc: 0.473 Test Loss: 1.122 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9192473888397217
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.127 Vali Acc: 0.446 Test Loss: 1.127 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9111874103546143
Epoch: 23, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.125 Vali Acc: 0.473 Test Loss: 1.125 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7936060428619385
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.139 Vali Acc: 0.473 Test Loss: 1.139 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9236340522766113
Epoch: 25, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.145 Vali Acc: 0.446 Test Loss: 1.145 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 78244
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9872398376464844
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.393 Vali Acc: 0.257 Test Loss: 1.393 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.8387210369110107
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.367 Vali Acc: 0.230 Test Loss: 1.367 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7961630821228027
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.334 Vali Acc: 0.297 Test Loss: 1.334 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 0.653090238571167
Epoch: 4, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.800072431564331
Epoch: 5, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.277 Vali Acc: 0.473 Test Loss: 1.277 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 0.7516705989837646
Epoch: 6, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7830002307891846
Epoch: 7, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 0.7601921558380127
Epoch: 8, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7283263206481934
Epoch: 9, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6695048809051514
Epoch: 10, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7007997035980225
Epoch: 11, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.130 Vali Acc: 0.473 Test Loss: 1.130 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.717170000076294
Epoch: 12, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.120 Vali Acc: 0.459 Test Loss: 1.120 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7766392230987549
Epoch: 13, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.113 Vali Acc: 0.446 Test Loss: 1.113 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7910716533660889
Epoch: 14, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.096 Vali Acc: 0.473 Test Loss: 1.096 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7440943717956543
Epoch: 15, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.079 Vali Acc: 0.486 Test Loss: 1.079 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8165116310119629
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.077 Vali Acc: 0.486 Test Loss: 1.077 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7508773803710938
Epoch: 17, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.082 Vali Acc: 0.473 Test Loss: 1.082 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 76324
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5537197589874268
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.381 Vali Acc: 0.203 Test Loss: 1.381 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.6503310203552246
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.362 Vali Acc: 0.378 Test Loss: 1.362 Test Acc: 0.378
Validation loss decreased (-0.202689 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.5311970710754395
Epoch: 3, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.296 Vali Acc: 0.419 Test Loss: 1.296 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.5394048690795898
Epoch: 4, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.227 Vali Acc: 0.527 Test Loss: 1.227 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.412562370300293
Epoch: 5, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.225 Vali Acc: 0.459 Test Loss: 1.225 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.61700439453125
Epoch: 6, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.447192668914795
Epoch: 7, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.442906141281128
Epoch: 8, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.164 Vali Acc: 0.527 Test Loss: 1.164 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4962587356567383
Epoch: 9, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.183 Vali Acc: 0.527 Test Loss: 1.183 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5435113906860352
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.221 Vali Acc: 0.568 Test Loss: 1.221 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567555).  Saving model ...
Epoch: 11 cost time: 1.3990178108215332
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6329610347747803
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.254 Vali Acc: 0.554 Test Loss: 1.254 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7317559719085693
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.276 Vali Acc: 0.554 Test Loss: 1.276 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.451552152633667
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.285 Vali Acc: 0.581 Test Loss: 1.285 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581068).  Saving model ...
Epoch: 15 cost time: 1.642531394958496
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.301 Vali Acc: 0.554 Test Loss: 1.301 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5524623394012451
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.307 Vali Acc: 0.554 Test Loss: 1.307 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5636012554168701
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.314 Vali Acc: 0.568 Test Loss: 1.314 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.580897569656372
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.343 Vali Acc: 0.554 Test Loss: 1.343 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.618809700012207
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.346 Vali Acc: 0.554 Test Loss: 1.346 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5371921062469482
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.568 Test Loss: 1.357 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.582826852798462
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.364 Vali Acc: 0.568 Test Loss: 1.364 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5307326316833496
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.371 Vali Acc: 0.568 Test Loss: 1.371 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.56235671043396
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.377 Vali Acc: 0.568 Test Loss: 1.377 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.579303503036499
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.390 Vali Acc: 0.568 Test Loss: 1.390 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 657252
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5607755184173584
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.377 Vali Acc: 0.324 Test Loss: 1.377 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.4877588748931885
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.361 Vali Acc: 0.311 Test Loss: 1.361 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5736134052276611
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.343 Vali Acc: 0.419 Test Loss: 1.343 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 1.6210463047027588
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.269 Vali Acc: 0.405 Test Loss: 1.269 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4551854133605957
Epoch: 5, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.418905 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.5919039249420166
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.454375982284546
Epoch: 7, Steps: 10 | Train Loss: 0.627 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.5255346298217773
Epoch: 8, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5756709575653076
Epoch: 9, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.121 Vali Acc: 0.486 Test Loss: 1.121 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3951609134674072
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.6581707000732422
Epoch: 11, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5016443729400635
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.610109567642212
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.125 Vali Acc: 0.527 Test Loss: 1.125 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.603891134262085
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.569162368774414
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.159 Vali Acc: 0.527 Test Loss: 1.159 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4970378875732422
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.364025592803955
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5226097106933594
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.188 Vali Acc: 0.541 Test Loss: 1.188 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5208549499511719
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.479339599609375
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 606372
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5161068439483643
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.386 Vali Acc: 0.324 Test Loss: 1.386 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.4824097156524658
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.361 Vali Acc: 0.338 Test Loss: 1.361 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.5250353813171387
Epoch: 3, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.341 Vali Acc: 0.351 Test Loss: 1.341 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.4820327758789062
Epoch: 4, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.297 Vali Acc: 0.473 Test Loss: 1.297 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.382394790649414
Epoch: 5, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.264 Vali Acc: 0.527 Test Loss: 1.264 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527014).  Saving model ...
Epoch: 6 cost time: 1.5660524368286133
Epoch: 6, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.375540018081665
Epoch: 7, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.190 Vali Acc: 0.541 Test Loss: 1.190 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.4736974239349365
Epoch: 8, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.4329383373260498
Epoch: 9, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.108 Vali Acc: 0.595 Test Loss: 1.108 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.2132697105407715
Epoch: 10, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3884272575378418
Epoch: 11, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.086 Vali Acc: 0.608 Test Loss: 1.086 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 1.2307627201080322
Epoch: 12, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 13 cost time: 1.258009910583496
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.106 Vali Acc: 0.608 Test Loss: 1.106 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4457652568817139
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4027910232543945
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5894553661346436
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4190800189971924
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.140 Vali Acc: 0.581 Test Loss: 1.140 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6115732192993164
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.540989637374878
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.170 Vali Acc: 0.608 Test Loss: 1.170 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.28279709815979
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.189 Vali Acc: 0.581 Test Loss: 1.189 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5170276165008545
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.203 Vali Acc: 0.581 Test Loss: 1.203 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4583005905151367
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.211 Vali Acc: 0.568 Test Loss: 1.211 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 591332
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.846200704574585
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.389 Vali Acc: 0.216 Test Loss: 1.389 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.2920775413513184
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.371 Vali Acc: 0.284 Test Loss: 1.371 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.2178800106048584
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.349 Vali Acc: 0.432 Test Loss: 1.349 Test Acc: 0.432
Validation loss decreased (-0.283770 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.1733875274658203
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.321 Vali Acc: 0.432 Test Loss: 1.321 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.3835668563842773
Epoch: 5, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.280 Vali Acc: 0.473 Test Loss: 1.280 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.1497111320495605
Epoch: 6, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.256 Vali Acc: 0.446 Test Loss: 1.256 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3259491920471191
Epoch: 7, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6185128688812256
Epoch: 8, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.210 Vali Acc: 0.473 Test Loss: 1.210 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.3452527523040771
Epoch: 9, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.5608201026916504
Epoch: 10, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.156 Vali Acc: 0.459 Test Loss: 1.156 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5359327793121338
Epoch: 11, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.178 Vali Acc: 0.473 Test Loss: 1.178 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1356208324432373
Epoch: 12, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.165 Vali Acc: 0.446 Test Loss: 1.165 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2420933246612549
Epoch: 13, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.1238579750061035
Epoch: 14, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.141 Vali Acc: 0.486 Test Loss: 1.141 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1872773170471191
Epoch: 15, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.144 Vali Acc: 0.473 Test Loss: 1.144 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1945912837982178
Epoch: 16, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.037163257598877
Epoch: 17, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5189447402954102
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3295972347259521
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.514777660369873
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4381475448608398
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2367892265319824
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4731473922729492
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 581412
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4822566509246826
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.370 Vali Acc: 0.311 Test Loss: 1.370 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.4521219730377197
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.367 Vali Acc: 0.351 Test Loss: 1.367 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.468968152999878
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.355 Vali Acc: 0.311 Test Loss: 1.355 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.396958351135254
Epoch: 4, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.336 Vali Acc: 0.311 Test Loss: 1.336 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5256853103637695
Epoch: 5, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.313 Vali Acc: 0.473 Test Loss: 1.313 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.4420373439788818
Epoch: 6, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.286 Vali Acc: 0.459 Test Loss: 1.286 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.496997594833374
Epoch: 7, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.254 Vali Acc: 0.473 Test Loss: 1.254 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.2643370628356934
Epoch: 8, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.229 Vali Acc: 0.541 Test Loss: 1.229 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 1.4654510021209717
Epoch: 9, Steps: 10 | Train Loss: 0.772 Vali Loss: 1.198 Vali Acc: 0.554 Test Loss: 1.198 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.454329013824463
Epoch: 10, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.170 Vali Acc: 0.541 Test Loss: 1.170 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3235204219818115
Epoch: 11, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4381158351898193
Epoch: 12, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3117337226867676
Epoch: 13, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.257322072982788
Epoch: 14, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4226326942443848
Epoch: 15, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.376331090927124
Epoch: 16, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6047282218933105
Epoch: 17, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.143 Vali Acc: 0.486 Test Loss: 1.143 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3548884391784668
Epoch: 18, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5153043270111084
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 576932
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.772045135498047
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.369 Vali Acc: 0.392 Test Loss: 1.369 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.4760100841522217
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.363 Vali Acc: 0.432 Test Loss: 1.363 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.4796135425567627
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.345 Vali Acc: 0.432 Test Loss: 1.345 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.4431564807891846
Epoch: 4, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.327 Vali Acc: 0.446 Test Loss: 1.327 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.0955376625061035
Epoch: 5, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.291 Vali Acc: 0.432 Test Loss: 1.291 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3707129955291748
Epoch: 6, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.272 Vali Acc: 0.459 Test Loss: 1.272 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.2266693115234375
Epoch: 7, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.4272854328155518
Epoch: 8, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.232 Vali Acc: 0.514 Test Loss: 1.232 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 1.2993230819702148
Epoch: 9, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.190 Vali Acc: 0.514 Test Loss: 1.190 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.5435993671417236
Epoch: 10, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3993360996246338
Epoch: 11, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3112571239471436
Epoch: 12, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.131 Vali Acc: 0.473 Test Loss: 1.131 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.277522087097168
Epoch: 13, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3705267906188965
Epoch: 14, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.100 Vali Acc: 0.486 Test Loss: 1.100 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3079476356506348
Epoch: 15, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.122 Vali Acc: 0.432 Test Loss: 1.122 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3592109680175781
Epoch: 16, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.124 Vali Acc: 0.432 Test Loss: 1.124 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.496997356414795
Epoch: 17, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.137 Vali Acc: 0.432 Test Loss: 1.137 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5699031352996826
Epoch: 18, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.145 Vali Acc: 0.473 Test Loss: 1.145 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4452996253967285
Epoch: 19, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.159 Vali Acc: 0.473 Test Loss: 1.159 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 572452
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6143298149108887
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.395 Vali Acc: 0.203 Test Loss: 1.395 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.294175386428833
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
Validation loss decreased (-0.202689 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.2465224266052246
Epoch: 3, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.375 Vali Acc: 0.324 Test Loss: 1.375 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.2218680381774902
Epoch: 4, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.349 Vali Acc: 0.378 Test Loss: 1.349 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.4297206401824951
Epoch: 5, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.327 Vali Acc: 0.365 Test Loss: 1.327 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.535703182220459
Epoch: 6, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.299 Vali Acc: 0.392 Test Loss: 1.299 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.452549695968628
Epoch: 7, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.273 Vali Acc: 0.459 Test Loss: 1.273 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.472543478012085
Epoch: 8, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.254 Vali Acc: 0.486 Test Loss: 1.254 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.4944472312927246
Epoch: 9, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.3698477745056152
Epoch: 10, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5777175426483154
Epoch: 11, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.3807291984558105
Epoch: 12, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 13 cost time: 1.4813261032104492
Epoch: 13, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1721298694610596
Epoch: 14, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.165 Vali Acc: 0.446 Test Loss: 1.165 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4872093200683594
Epoch: 15, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5652258396148682
Epoch: 16, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.163 Vali Acc: 0.446 Test Loss: 1.163 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3782248497009277
Epoch: 17, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.155 Vali Acc: 0.459 Test Loss: 1.155 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.409297227859497
Epoch: 18, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.166 Vali Acc: 0.432 Test Loss: 1.166 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3007011413574219
Epoch: 19, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.162 Vali Acc: 0.446 Test Loss: 1.162 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3258986473083496
Epoch: 20, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.172 Vali Acc: 0.459 Test Loss: 1.172 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.123441457748413
Epoch: 21, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.195 Vali Acc: 0.432 Test Loss: 1.195 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0850846767425537
Epoch: 22, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.212 Vali Acc: 0.432 Test Loss: 1.212 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 567972
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8754491806030273
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.389 Vali Acc: 0.284 Test Loss: 1.389 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.4767282009124756
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.359 Vali Acc: 0.365 Test Loss: 1.359 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.6776373386383057
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.6080098152160645
Epoch: 4, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.263 Vali Acc: 0.432 Test Loss: 1.263 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.4292528629302979
Epoch: 5, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.225 Vali Acc: 0.446 Test Loss: 1.225 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.7019414901733398
Epoch: 6, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.155 Vali Acc: 0.459 Test Loss: 1.155 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 1.5096745491027832
Epoch: 7, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.156 Vali Acc: 0.459 Test Loss: 1.156 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6300907135009766
Epoch: 8, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.5087018013000488
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6096489429473877
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4748239517211914
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.242 Vali Acc: 0.541 Test Loss: 1.242 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 1.2902131080627441
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.232 Vali Acc: 0.514 Test Loss: 1.232 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.382894515991211
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.248 Vali Acc: 0.541 Test Loss: 1.248 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3566129207611084
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.270 Vali Acc: 0.541 Test Loss: 1.270 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4290227890014648
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.281 Vali Acc: 0.554 Test Loss: 1.281 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 16 cost time: 1.637902021408081
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5822904109954834
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.768430471420288
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.308 Vali Acc: 0.541 Test Loss: 1.308 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3791017532348633
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.318 Vali Acc: 0.541 Test Loss: 1.318 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1738698482513428
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.324 Vali Acc: 0.541 Test Loss: 1.324 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2310271263122559
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.336 Vali Acc: 0.554 Test Loss: 1.336 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1449267864227295
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.541 Test Loss: 1.350 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2131879329681396
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.355 Vali Acc: 0.541 Test Loss: 1.355 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2609343528747559
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.367 Vali Acc: 0.568 Test Loss: 1.367 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567554).  Saving model ...
Epoch: 25 cost time: 1.4990105628967285
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.374 Vali Acc: 0.568 Test Loss: 1.374 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8316891193389893
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.379 Vali Acc: 0.541 Test Loss: 1.379 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.581531047821045
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.541 Test Loss: 1.386 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5289037227630615
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.554 Test Loss: 1.392 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5436339378356934
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.399 Vali Acc: 0.554 Test Loss: 1.399 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.245224952697754
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.568 Test Loss: 1.407 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5294129848480225
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.554 Test Loss: 1.414 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.452341079711914
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.420 Vali Acc: 0.554 Test Loss: 1.420 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2831392288208008
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.541 Test Loss: 1.429 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6232264041900635
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.554 Test Loss: 1.438 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 648292
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.632524251937866
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.2161307334899902
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.348 Vali Acc: 0.405 Test Loss: 1.348 Test Acc: 0.405
Validation loss decreased (-0.270257 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.5702779293060303
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.308 Vali Acc: 0.392 Test Loss: 1.308 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4770512580871582
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
Validation loss decreased (-0.405392 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.5765273571014404
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4147250652313232
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.4331743717193604
Epoch: 7, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.4342403411865234
Epoch: 8, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1889512538909912
Epoch: 9, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.2144904136657715
Epoch: 10, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.112 Vali Acc: 0.514 Test Loss: 1.112 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.1820647716522217
Epoch: 11, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3865747451782227
Epoch: 12, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5718977451324463
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 14 cost time: 1.6754262447357178
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5893290042877197
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4981093406677246
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.222 Vali Acc: 0.486 Test Loss: 1.222 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.567427396774292
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1959450244903564
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.259 Vali Acc: 0.514 Test Loss: 1.259 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.13277006149292
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.265 Vali Acc: 0.514 Test Loss: 1.265 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5435349941253662
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.282 Vali Acc: 0.514 Test Loss: 1.282 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4535143375396729
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.290 Vali Acc: 0.514 Test Loss: 1.290 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.522486686706543
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.374023199081421
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.302 Vali Acc: 0.514 Test Loss: 1.302 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 597412
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6255099773406982
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.391 Vali Acc: 0.189 Test Loss: 1.391 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.2147026062011719
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.367 Vali Acc: 0.351 Test Loss: 1.367 Test Acc: 0.351
Validation loss decreased (-0.189175 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.4481375217437744
Epoch: 3, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.347 Vali Acc: 0.392 Test Loss: 1.347 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 1.545212984085083
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.3297135829925537
Epoch: 5, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.298 Vali Acc: 0.459 Test Loss: 1.298 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459446).  Saving model ...
Epoch: 6 cost time: 1.5054757595062256
Epoch: 6, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.254 Vali Acc: 0.527 Test Loss: 1.254 Test Acc: 0.527
Validation loss decreased (-0.459446 --> -0.527014).  Saving model ...
Epoch: 7 cost time: 1.4322986602783203
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4329266548156738
Epoch: 8, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.164 Vali Acc: 0.541 Test Loss: 1.164 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.5591557025909424
Epoch: 9, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3938982486724854
Epoch: 10, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.5149309635162354
Epoch: 11, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.111 Vali Acc: 0.527 Test Loss: 1.111 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.472351312637329
Epoch: 12, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.351855993270874
Epoch: 13, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5573489665985107
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4363915920257568
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4522042274475098
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.027479648590088
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2679831981658936
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3950719833374023
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3465402126312256
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.334883213043213
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.214 Vali Acc: 0.527 Test Loss: 1.214 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4203078746795654
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.236 Vali Acc: 0.541 Test Loss: 1.236 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 582372
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7026267051696777
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.387 Vali Acc: 0.216 Test Loss: 1.387 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.3536813259124756
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.376 Vali Acc: 0.230 Test Loss: 1.376 Test Acc: 0.230
Validation loss decreased (-0.216202 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 1.4580326080322266
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.343 Vali Acc: 0.297 Test Loss: 1.343 Test Acc: 0.297
Validation loss decreased (-0.229716 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.4480829238891602
Epoch: 4, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.314 Vali Acc: 0.365 Test Loss: 1.314 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.321669340133667
Epoch: 5, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.269 Vali Acc: 0.405 Test Loss: 1.269 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 1.2597260475158691
Epoch: 6, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.245 Vali Acc: 0.446 Test Loss: 1.245 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.5304253101348877
Epoch: 7, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.222 Vali Acc: 0.405 Test Loss: 1.222 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2525599002838135
Epoch: 8, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.189 Vali Acc: 0.419 Test Loss: 1.189 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2980868816375732
Epoch: 9, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.3433396816253662
Epoch: 10, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.152 Vali Acc: 0.432 Test Loss: 1.152 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1549034118652344
Epoch: 11, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.282461404800415
Epoch: 12, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3776576519012451
Epoch: 13, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4066526889801025
Epoch: 14, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.1942493915557861
Epoch: 15, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1255815029144287
Epoch: 16, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.123 Vali Acc: 0.486 Test Loss: 1.123 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4526267051696777
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 18 cost time: 1.325786828994751
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2836506366729736
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1863622665405273
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0292212963104248
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0627799034118652
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.196 Vali Acc: 0.541 Test Loss: 1.196 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 23 cost time: 1.0135750770568848
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.201 Vali Acc: 0.541 Test Loss: 1.201 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9825747013092041
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.205 Vali Acc: 0.541 Test Loss: 1.205 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1082046031951904
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.217 Vali Acc: 0.554 Test Loss: 1.217 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 26 cost time: 1.2708845138549805
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3254427909851074
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1954758167266846
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.233 Vali Acc: 0.554 Test Loss: 1.233 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3630561828613281
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.245 Vali Acc: 0.554 Test Loss: 1.245 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2758030891418457
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.260 Vali Acc: 0.554 Test Loss: 1.260 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1463544368743896
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.268 Vali Acc: 0.554 Test Loss: 1.268 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4151811599731445
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.270 Vali Acc: 0.554 Test Loss: 1.270 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.436051607131958
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.281 Vali Acc: 0.541 Test Loss: 1.281 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3536231517791748
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.291 Vali Acc: 0.541 Test Loss: 1.291 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2415597438812256
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 572452
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.688633680343628
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.378 Vali Acc: 0.243 Test Loss: 1.378 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.31355619430542
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.373 Vali Acc: 0.230 Test Loss: 1.373 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3290271759033203
Epoch: 3, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.357 Vali Acc: 0.338 Test Loss: 1.357 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.4426188468933105
Epoch: 4, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.324 Vali Acc: 0.459 Test Loss: 1.324 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 1.2286055088043213
Epoch: 5, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.298 Vali Acc: 0.459 Test Loss: 1.298 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459446).  Saving model ...
Epoch: 6 cost time: 1.1877543926239014
Epoch: 6, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.264 Vali Acc: 0.459 Test Loss: 1.264 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.237691879272461
Epoch: 7, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.240 Vali Acc: 0.514 Test Loss: 1.240 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.0358586311340332
Epoch: 8, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.216 Vali Acc: 0.459 Test Loss: 1.216 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1059966087341309
Epoch: 9, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.1292095184326172
Epoch: 10, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2371118068695068
Epoch: 11, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.2628109455108643
Epoch: 12, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 1.2438428401947021
Epoch: 13, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.056394100189209
Epoch: 14, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1160142421722412
Epoch: 15, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.333219051361084
Epoch: 16, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4126453399658203
Epoch: 17, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2761657238006592
Epoch: 18, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3363752365112305
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.257096529006958
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.185 Vali Acc: 0.554 Test Loss: 1.185 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3904311656951904
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3779115676879883
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.218 Vali Acc: 0.554 Test Loss: 1.218 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 567972
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.409256935119629
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.365 Vali Acc: 0.284 Test Loss: 1.365 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.0507216453552246
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.361 Vali Acc: 0.324 Test Loss: 1.361 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.4998056888580322
Epoch: 3, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.348 Vali Acc: 0.284 Test Loss: 1.348 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.498589038848877
Epoch: 4, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.332 Vali Acc: 0.311 Test Loss: 1.332 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.378129243850708
Epoch: 5, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.298 Vali Acc: 0.446 Test Loss: 1.298 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.3027331829071045
Epoch: 6, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.4281642436981201
Epoch: 7, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.248 Vali Acc: 0.473 Test Loss: 1.248 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.343770980834961
Epoch: 8, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.3992300033569336
Epoch: 9, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.188582420349121
Epoch: 10, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.2576959133148193
Epoch: 11, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.162 Vali Acc: 0.459 Test Loss: 1.162 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4149456024169922
Epoch: 12, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 1.0055887699127197
Epoch: 13, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.126 Vali Acc: 0.527 Test Loss: 1.126 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 0.9897480010986328
Epoch: 14, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0999090671539307
Epoch: 15, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9018616676330566
Epoch: 16, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9400196075439453
Epoch: 17, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0231029987335205
Epoch: 18, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.168548822402954
Epoch: 19, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2131047248840332
Epoch: 20, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.222 Vali Acc: 0.486 Test Loss: 1.222 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3188817501068115
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1187105178833008
Epoch: 22, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2286934852600098
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.279 Vali Acc: 0.459 Test Loss: 1.279 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 563492
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.544830322265625
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.2879612445831299
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.354 Vali Acc: 0.405 Test Loss: 1.354 Test Acc: 0.405
Validation loss decreased (-0.270257 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.2928376197814941
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.329 Vali Acc: 0.473 Test Loss: 1.329 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.392960548400879
Epoch: 4, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.303 Vali Acc: 0.541 Test Loss: 1.303 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 1.344977855682373
Epoch: 5, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.279 Vali Acc: 0.527 Test Loss: 1.279 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2821617126464844
Epoch: 6, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4130833148956299
Epoch: 7, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3097898960113525
Epoch: 8, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.2807188034057617
Epoch: 9, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.259953498840332
Epoch: 10, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4355237483978271
Epoch: 11, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.147 Vali Acc: 0.459 Test Loss: 1.147 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2899844646453857
Epoch: 12, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.137 Vali Acc: 0.459 Test Loss: 1.137 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2459783554077148
Epoch: 13, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.128 Vali Acc: 0.459 Test Loss: 1.128 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2633163928985596
Epoch: 14, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.124 Vali Acc: 0.459 Test Loss: 1.124 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.021674633026123
Epoch: 15, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1733283996582031
Epoch: 16, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.124 Vali Acc: 0.486 Test Loss: 1.124 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2431573867797852
Epoch: 17, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4194703102111816
Epoch: 18, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 559012
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.910827398300171
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.328 Vali Acc: 0.338 Test Loss: 1.328 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 1.9361557960510254
Epoch: 2, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.213 Vali Acc: 0.541 Test Loss: 1.213 Test Acc: 0.541
Validation loss decreased (-0.337825 --> -0.540528).  Saving model ...
Epoch: 3 cost time: 1.803621530532837
Epoch: 3, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.057 Vali Acc: 0.527 Test Loss: 1.057 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0228168964385986
Epoch: 4, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8792226314544678
Epoch: 5, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8952043056488037
Epoch: 6, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8936307430267334
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.616 Vali Acc: 0.568 Test Loss: 1.616 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567551).  Saving model ...
Epoch: 8 cost time: 1.8024542331695557
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.595 Test Loss: 1.584 Test Acc: 0.595
Validation loss decreased (-0.567551 --> -0.594579).  Saving model ...
Epoch: 9 cost time: 1.894714593887329
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.568 Test Loss: 1.584 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.035733222961426
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.541 Test Loss: 1.569 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9356694221496582
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.568 Test Loss: 1.568 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.864380121231079
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.581 Test Loss: 1.574 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9075472354888916
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.568 Test Loss: 1.589 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.895684003829956
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.568 Test Loss: 1.589 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9740395545959473
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.568 Test Loss: 1.590 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.080369710922241
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.581 Test Loss: 1.601 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0234375
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.581 Test Loss: 1.606 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.61960768699646
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.581 Test Loss: 1.604 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2293124
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7395546436309814
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.350 Vali Acc: 0.392 Test Loss: 1.350 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.6872727870941162
Epoch: 2, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.391878 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.6970360279083252
Epoch: 3, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.7630367279052734
Epoch: 4, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.6516122817993164
Epoch: 5, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6913120746612549
Epoch: 6, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.37496018409729
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7537477016448975
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.831449270248413
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6902122497558594
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.236 Vali Acc: 0.554 Test Loss: 1.236 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.6988558769226074
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.264 Vali Acc: 0.527 Test Loss: 1.264 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6408193111419678
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.275 Vali Acc: 0.541 Test Loss: 1.275 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5446884632110596
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.554 Test Loss: 1.282 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5536375045776367
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6940319538116455
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.527 Test Loss: 1.311 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.662888526916504
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.527 Test Loss: 1.313 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7862048149108887
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.324 Vali Acc: 0.527 Test Loss: 1.324 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6851027011871338
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8318920135498047
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8322081565856934
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.541 Test Loss: 1.350 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2089604
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7746081352233887
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.380 Vali Acc: 0.176 Test Loss: 1.380 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 1.6580579280853271
Epoch: 2, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.302 Vali Acc: 0.392 Test Loss: 1.302 Test Acc: 0.392
Validation loss decreased (-0.175662 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.6288871765136719
Epoch: 3, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.197 Vali Acc: 0.473 Test Loss: 1.197 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.5377769470214844
Epoch: 4, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.146 Vali Acc: 0.486 Test Loss: 1.146 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.639098882675171
Epoch: 5, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.082 Vali Acc: 0.514 Test Loss: 1.082 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 6 cost time: 1.6449637413024902
Epoch: 6, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.608839750289917
Epoch: 7, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.7458763122558594
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.153 Vali Acc: 0.554 Test Loss: 1.153 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.6651663780212402
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.149 Vali Acc: 0.554 Test Loss: 1.149 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.722365140914917
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.74251127243042
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.182 Vali Acc: 0.568 Test Loss: 1.182 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.6796894073486328
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8699793815612793
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.222 Vali Acc: 0.568 Test Loss: 1.222 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8434793949127197
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.229 Vali Acc: 0.568 Test Loss: 1.229 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.693422555923462
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.717700481414795
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.253 Vali Acc: 0.554 Test Loss: 1.253 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6588332653045654
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.259 Vali Acc: 0.554 Test Loss: 1.259 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7365403175354004
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6199615001678467
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.295 Vali Acc: 0.568 Test Loss: 1.295 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6310436725616455
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.554 Test Loss: 1.292 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.820364236831665
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.554 Test Loss: 1.301 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2019204
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8645074367523193
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.381 Vali Acc: 0.216 Test Loss: 1.381 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.6305503845214844
Epoch: 2, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.328 Vali Acc: 0.392 Test Loss: 1.328 Test Acc: 0.392
Validation loss decreased (-0.216202 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.7419490814208984
Epoch: 3, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.242 Vali Acc: 0.486 Test Loss: 1.242 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.69166898727417
Epoch: 4, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.665902853012085
Epoch: 5, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.121 Vali Acc: 0.446 Test Loss: 1.121 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6659908294677734
Epoch: 6, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.106 Vali Acc: 0.527 Test Loss: 1.106 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.6414401531219482
Epoch: 7, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5684566497802734
Epoch: 8, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.5824699401855469
Epoch: 9, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.132 Vali Acc: 0.568 Test Loss: 1.132 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.6291475296020508
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.237 Vali Acc: 0.554 Test Loss: 1.237 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.475459098815918
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.489389181137085
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.238 Vali Acc: 0.568 Test Loss: 1.238 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.383314847946167
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.257 Vali Acc: 0.541 Test Loss: 1.257 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.521866798400879
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.265 Vali Acc: 0.541 Test Loss: 1.265 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9524500370025635
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.269 Vali Acc: 0.541 Test Loss: 1.269 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6789510250091553
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7840240001678467
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.310 Vali Acc: 0.554 Test Loss: 1.310 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9572746753692627
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.328 Vali Acc: 0.554 Test Loss: 1.328 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7863941192626953
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.331 Vali Acc: 0.541 Test Loss: 1.331 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1989764
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7669365406036377
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.384 Vali Acc: 0.243 Test Loss: 1.384 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.4935243129730225
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.318 Vali Acc: 0.338 Test Loss: 1.318 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.3492083549499512
Epoch: 3, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.249 Vali Acc: 0.419 Test Loss: 1.249 Test Acc: 0.419
Validation loss decreased (-0.337825 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.7123515605926514
Epoch: 4, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.656648874282837
Epoch: 5, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6696116924285889
Epoch: 6, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.064 Vali Acc: 0.527 Test Loss: 1.064 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.630171298980713
Epoch: 7, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.7798357009887695
Epoch: 8, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.030 Vali Acc: 0.568 Test Loss: 1.030 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.631150484085083
Epoch: 9, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.028 Vali Acc: 0.581 Test Loss: 1.028 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.4715750217437744
Epoch: 10, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.052 Vali Acc: 0.554 Test Loss: 1.052 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6967928409576416
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.579787254333496
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.057 Vali Acc: 0.568 Test Loss: 1.057 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5455982685089111
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7146570682525635
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.789377212524414
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6455440521240234
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.142 Vali Acc: 0.554 Test Loss: 1.142 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5163350105285645
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3759257793426514
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.158 Vali Acc: 0.568 Test Loss: 1.158 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.712777853012085
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.168 Vali Acc: 0.568 Test Loss: 1.168 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1961604
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4499475955963135
Epoch: 1, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.379 Vali Acc: 0.324 Test Loss: 1.379 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.9313509464263916
Epoch: 2, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.340 Vali Acc: 0.392 Test Loss: 1.340 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.7704558372497559
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.391878 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.8915679454803467
Epoch: 4, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.6571173667907715
Epoch: 5, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.7391464710235596
Epoch: 6, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.8457207679748535
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.040 Vali Acc: 0.568 Test Loss: 1.040 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.7296838760375977
Epoch: 8, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.035 Vali Acc: 0.500 Test Loss: 1.035 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0220460891723633
Epoch: 9, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.009 Vali Acc: 0.541 Test Loss: 1.009 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7269611358642578
Epoch: 10, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.980 Vali Acc: 0.595 Test Loss: 0.980 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594585).  Saving model ...
Epoch: 11 cost time: 1.7234246730804443
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.003 Vali Acc: 0.568 Test Loss: 1.003 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5777521133422852
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8008160591125488
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.040 Vali Acc: 0.568 Test Loss: 1.040 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7357172966003418
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.075 Vali Acc: 0.568 Test Loss: 1.075 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7166497707366943
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4156365394592285
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.635761022567749
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.097 Vali Acc: 0.568 Test Loss: 1.097 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6973369121551514
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6572191715240479
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8144621849060059
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1943684
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9516096115112305
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.6136136054992676
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.364 Vali Acc: 0.338 Test Loss: 1.364 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.5028491020202637
Epoch: 3, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.298 Vali Acc: 0.378 Test Loss: 1.298 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.6639912128448486
Epoch: 4, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.255 Vali Acc: 0.419 Test Loss: 1.255 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.5762181282043457
Epoch: 5, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.196 Vali Acc: 0.432 Test Loss: 1.196 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.6757054328918457
Epoch: 6, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.136 Vali Acc: 0.527 Test Loss: 1.136 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.6264889240264893
Epoch: 7, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2613976001739502
Epoch: 8, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4530868530273438
Epoch: 9, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3352618217468262
Epoch: 10, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5525727272033691
Epoch: 11, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.059 Vali Acc: 0.541 Test Loss: 1.059 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 1.406944990158081
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5154972076416016
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.6331603527069092
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3484289646148682
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.347198486328125
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4333133697509766
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.137 Vali Acc: 0.554 Test Loss: 1.137 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5129814147949219
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3969323635101318
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2730066776275635
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5656752586364746
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.190 Vali Acc: 0.554 Test Loss: 1.190 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5738980770111084
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.530073881149292
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1936004
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3792431354522705
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.337 Vali Acc: 0.459 Test Loss: 1.337 Test Acc: 0.459
Validation loss decreased (inf --> -0.459446).  Saving model ...
Epoch: 2 cost time: 0.9760076999664307
Epoch: 2, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.3202567100524902
Epoch: 3, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.1174168586730957
Epoch: 4, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3241322040557861
Epoch: 5, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.105987548828125
Epoch: 6, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.5195879936218262
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.243 Vali Acc: 0.554 Test Loss: 1.243 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.5155649185180664
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.182 Vali Acc: 0.554 Test Loss: 1.182 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.410649061203003
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6055095195770264
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.275 Vali Acc: 0.554 Test Loss: 1.275 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6945459842681885
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.568 Test Loss: 1.291 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 12 cost time: 1.5081946849822998
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.305 Vali Acc: 0.554 Test Loss: 1.305 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.582054853439331
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.313 Vali Acc: 0.568 Test Loss: 1.313 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.192309856414795
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.568 Test Loss: 1.329 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5296862125396729
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.346 Vali Acc: 0.554 Test Loss: 1.346 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5038342475891113
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.568 Test Loss: 1.357 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3940999507904053
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.369 Vali Acc: 0.568 Test Loss: 1.369 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5760443210601807
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.568 Test Loss: 1.380 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.469693660736084
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.394 Vali Acc: 0.568 Test Loss: 1.394 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5224220752716064
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.405 Vali Acc: 0.554 Test Loss: 1.405 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.393397331237793
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.554 Test Loss: 1.408 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 720580
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7418556213378906
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.389 Vali Acc: 0.311 Test Loss: 1.389 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.385972023010254
Epoch: 2, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.294 Vali Acc: 0.432 Test Loss: 1.294 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.456852674484253
Epoch: 3, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.247 Vali Acc: 0.419 Test Loss: 1.247 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2987608909606934
Epoch: 4, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.194 Vali Acc: 0.392 Test Loss: 1.194 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4103467464447021
Epoch: 5, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.117 Vali Acc: 0.473 Test Loss: 1.117 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472962).  Saving model ...
Epoch: 6 cost time: 1.486257553100586
Epoch: 6, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.1657872200012207
Epoch: 7, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 1.5205187797546387
Epoch: 8, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4596235752105713
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.100 Vali Acc: 0.514 Test Loss: 1.100 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.371398687362671
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 1.2108688354492188
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.132 Vali Acc: 0.568 Test Loss: 1.132 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1718924045562744
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1352901458740234
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.122347354888916
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0780258178710938
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1353850364685059
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.207 Vali Acc: 0.527 Test Loss: 1.207 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1965703964233398
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.214 Vali Acc: 0.554 Test Loss: 1.214 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2190656661987305
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.223 Vali Acc: 0.554 Test Loss: 1.223 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2752618789672852
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.239 Vali Acc: 0.554 Test Loss: 1.239 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.454787015914917
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.244 Vali Acc: 0.527 Test Loss: 1.244 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 618820
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.575645923614502
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.4483795166015625
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.329 Vali Acc: 0.419 Test Loss: 1.329 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.434645175933838
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.261 Vali Acc: 0.446 Test Loss: 1.261 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.4755055904388428
Epoch: 4, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.4197893142700195
Epoch: 5, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.4931325912475586
Epoch: 6, Steps: 10 | Train Loss: 0.626 Vali Loss: 1.144 Vali Acc: 0.446 Test Loss: 1.144 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4319825172424316
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
Validation loss decreased (-0.486475 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 1.2363739013671875
Epoch: 8, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.109 Vali Acc: 0.527 Test Loss: 1.109 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3724365234375
Epoch: 9, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.29119873046875
Epoch: 10, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.233093023300171
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3991808891296387
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2962307929992676
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5298700332641602
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4489061832427979
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4497301578521729
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.221 Vali Acc: 0.527 Test Loss: 1.221 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.437659740447998
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 583620
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5258495807647705
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.372739553451538
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.358 Vali Acc: 0.324 Test Loss: 1.358 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.2210710048675537
Epoch: 3, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.303 Vali Acc: 0.405 Test Loss: 1.303 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.3998987674713135
Epoch: 4, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.3216331005096436
Epoch: 5, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.294567346572876
Epoch: 6, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.2983996868133545
Epoch: 7, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2132558822631836
Epoch: 8, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.291053056716919
Epoch: 9, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.2347562313079834
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3011083602905273
Epoch: 11, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4171802997589111
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.283003807067871
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 14 cost time: 1.2101497650146484
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.285526990890503
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1483466625213623
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2296559810638428
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.145538568496704
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2156455516815186
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4545996189117432
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2979979515075684
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.280 Vali Acc: 0.514 Test Loss: 1.280 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4258594512939453
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.284 Vali Acc: 0.514 Test Loss: 1.284 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.440932273864746
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 568900
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5979888439178467
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.395 Vali Acc: 0.297 Test Loss: 1.395 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.3233885765075684
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.358 Vali Acc: 0.378 Test Loss: 1.358 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.237943410873413
Epoch: 3, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.307 Vali Acc: 0.446 Test Loss: 1.307 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.2875232696533203
Epoch: 4, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.2735378742218018
Epoch: 5, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.207 Vali Acc: 0.541 Test Loss: 1.207 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540528).  Saving model ...
Epoch: 6 cost time: 1.4198594093322754
Epoch: 6, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.451124668121338
Epoch: 7, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.4221673011779785
Epoch: 8, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3772685527801514
Epoch: 9, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.015 Vali Acc: 0.622 Test Loss: 1.015 Test Acc: 0.622
Validation loss decreased (-0.567556 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 1.1587350368499756
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.036 Vali Acc: 0.568 Test Loss: 1.036 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4095005989074707
Epoch: 11, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.968 Vali Acc: 0.635 Test Loss: 0.968 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 1.3959214687347412
Epoch: 12, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3630495071411133
Epoch: 13, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.962 Vali Acc: 0.554 Test Loss: 0.962 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.472731351852417
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2765326499938965
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.990 Vali Acc: 0.595 Test Loss: 0.990 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2844116687774658
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.998 Vali Acc: 0.595 Test Loss: 0.998 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0169501304626465
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1580100059509277
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.002 Vali Acc: 0.608 Test Loss: 1.002 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0913488864898682
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.030 Vali Acc: 0.622 Test Loss: 1.030 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8892230987548828
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.040 Vali Acc: 0.635 Test Loss: 1.040 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3898999691009521
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.057 Vali Acc: 0.622 Test Loss: 1.057 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 554820
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5808775424957275
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.378 Vali Acc: 0.284 Test Loss: 1.378 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.4013726711273193
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.352 Vali Acc: 0.378 Test Loss: 1.352 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.2654259204864502
Epoch: 3, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.322 Vali Acc: 0.459 Test Loss: 1.322 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 1.3290824890136719
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.2580475807189941
Epoch: 5, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.3649866580963135
Epoch: 6, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.3803038597106934
Epoch: 7, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.175 Vali Acc: 0.486 Test Loss: 1.175 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.199378252029419
Epoch: 8, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.4770188331604004
Epoch: 9, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.123 Vali Acc: 0.527 Test Loss: 1.123 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.1234607696533203
Epoch: 10, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.4279394149780273
Epoch: 11, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3659389019012451
Epoch: 12, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3272631168365479
Epoch: 13, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 14 cost time: 1.34623384475708
Epoch: 14, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1455368995666504
Epoch: 15, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.076 Vali Acc: 0.541 Test Loss: 1.076 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2631275653839111
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 17 cost time: 1.2752468585968018
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3396186828613281
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3555338382720947
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1758241653442383
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.130 Vali Acc: 0.541 Test Loss: 1.130 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3960559368133545
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2689285278320312
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3819286823272705
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3082318305969238
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3620507717132568
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.176 Vali Acc: 0.541 Test Loss: 1.176 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2212910652160645
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 545860
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4248037338256836
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.383 Vali Acc: 0.189 Test Loss: 1.383 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.7900052070617676
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.363 Vali Acc: 0.284 Test Loss: 1.363 Test Acc: 0.284
Validation loss decreased (-0.189175 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.1385204792022705
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.336 Vali Acc: 0.419 Test Loss: 1.336 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.1591966152191162
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.301 Vali Acc: 0.459 Test Loss: 1.301 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 1.162437915802002
Epoch: 5, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.262 Vali Acc: 0.432 Test Loss: 1.262 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9591212272644043
Epoch: 6, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.226 Vali Acc: 0.527 Test Loss: 1.226 Test Acc: 0.527
Validation loss decreased (-0.459446 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.3462297916412354
Epoch: 7, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.3204386234283447
Epoch: 8, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.1847479343414307
Epoch: 9, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.4264163970947266
Epoch: 10, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2788448333740234
Epoch: 11, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3318195343017578
Epoch: 12, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3211843967437744
Epoch: 13, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1711838245391846
Epoch: 14, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.301767349243164
Epoch: 15, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.120 Vali Acc: 0.554 Test Loss: 1.120 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 1.203622579574585
Epoch: 16, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3394298553466797
Epoch: 17, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2743473052978516
Epoch: 18, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3168416023254395
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3850624561309814
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1274094581604004
Epoch: 21, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.186 Vali Acc: 0.541 Test Loss: 1.186 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3783297538757324
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.209 Vali Acc: 0.514 Test Loss: 1.209 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.330186367034912
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.226 Vali Acc: 0.527 Test Loss: 1.226 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1760990619659424
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.243 Vali Acc: 0.486 Test Loss: 1.243 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2568066120147705
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.258 Vali Acc: 0.514 Test Loss: 1.258 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 542020
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9652373790740967
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.372 Vali Acc: 0.297 Test Loss: 1.372 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.9612500667572021
Epoch: 2, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.326 Vali Acc: 0.459 Test Loss: 1.326 Test Acc: 0.459
Validation loss decreased (-0.297284 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.0559484958648682
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.256 Vali Acc: 0.514 Test Loss: 1.256 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.0335264205932617
Epoch: 4, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.188 Vali Acc: 0.473 Test Loss: 1.188 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2743825912475586
Epoch: 5, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.169 Vali Acc: 0.419 Test Loss: 1.169 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2044239044189453
Epoch: 6, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2399165630340576
Epoch: 7, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.114 Vali Acc: 0.486 Test Loss: 1.114 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2551841735839844
Epoch: 8, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.068 Vali Acc: 0.527 Test Loss: 1.068 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.9829764366149902
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.3405518531799316
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2117040157318115
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0359928607940674
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.162104606628418
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.180 Vali Acc: 0.541 Test Loss: 1.180 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8691821098327637
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.192 Vali Acc: 0.568 Test Loss: 1.192 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 1.1519348621368408
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1010284423828125
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.039769172668457
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.238 Vali Acc: 0.541 Test Loss: 1.238 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2766354084014893
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.242 Vali Acc: 0.554 Test Loss: 1.242 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1646931171417236
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.260 Vali Acc: 0.541 Test Loss: 1.260 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.319521188735962
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.266 Vali Acc: 0.541 Test Loss: 1.266 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.149153709411621
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.278 Vali Acc: 0.554 Test Loss: 1.278 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.137573003768921
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.288 Vali Acc: 0.554 Test Loss: 1.288 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.25056791305542
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.300 Vali Acc: 0.554 Test Loss: 1.300 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.198354959487915
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.306 Vali Acc: 0.541 Test Loss: 1.306 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 253796
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.284543514251709
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.405 Vali Acc: 0.216 Test Loss: 1.405 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.1921412944793701
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.350 Vali Acc: 0.284 Test Loss: 1.350 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.8707032203674316
Epoch: 3, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.1557683944702148
Epoch: 4, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.243 Vali Acc: 0.459 Test Loss: 1.243 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9998083114624023
Epoch: 5, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9988036155700684
Epoch: 6, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 7 cost time: 1.0283784866333008
Epoch: 7, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0017213821411133
Epoch: 8, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.018061637878418
Epoch: 9, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.083 Vali Acc: 0.541 Test Loss: 1.083 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8988540172576904
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9418418407440186
Epoch: 11, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.962639570236206
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7549121379852295
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7416636943817139
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8989772796630859
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9347395896911621
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.104 Vali Acc: 0.581 Test Loss: 1.104 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 202916
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1615688800811768
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.418 Vali Acc: 0.203 Test Loss: 1.418 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.0290539264678955
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.387 Vali Acc: 0.257 Test Loss: 1.387 Test Acc: 0.257
Validation loss decreased (-0.202689 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.0150904655456543
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.345 Vali Acc: 0.419 Test Loss: 1.345 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 1.0387978553771973
Epoch: 4, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.326 Vali Acc: 0.446 Test Loss: 1.326 Test Acc: 0.446
Validation loss decreased (-0.418905 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.0327329635620117
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.278 Vali Acc: 0.486 Test Loss: 1.278 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.0324516296386719
Epoch: 6, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 0.9432177543640137
Epoch: 7, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.201 Vali Acc: 0.568 Test Loss: 1.201 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.1862342357635498
Epoch: 8, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.172 Vali Acc: 0.541 Test Loss: 1.172 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9385836124420166
Epoch: 9, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.0455949306488037
Epoch: 10, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.120 Vali Acc: 0.608 Test Loss: 1.120 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 0.8071403503417969
Epoch: 11, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0030181407928467
Epoch: 12, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9650962352752686
Epoch: 13, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8681347370147705
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.093 Vali Acc: 0.581 Test Loss: 1.093 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0236773490905762
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8878235816955566
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9308838844299316
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1655733585357666
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0622859001159668
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.139411211013794
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.201 Vali Acc: 0.541 Test Loss: 1.201 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 185316
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3600809574127197
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.0675764083862305
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 0.9421558380126953
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7779295444488525
Epoch: 4, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.308 Vali Acc: 0.378 Test Loss: 1.308 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.8191962242126465
Epoch: 5, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.282 Vali Acc: 0.378 Test Loss: 1.282 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 6 cost time: 0.9663994312286377
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
Validation loss decreased (-0.378366 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.8961405754089355
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.8977041244506836
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.9324660301208496
Epoch: 9, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.8557853698730469
Epoch: 10, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.088 Vali Acc: 0.514 Test Loss: 1.088 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0427985191345215
Epoch: 11, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 1.0310509204864502
Epoch: 12, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.045 Vali Acc: 0.554 Test Loss: 1.045 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0167925357818604
Epoch: 13, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.024 Vali Acc: 0.554 Test Loss: 1.024 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1780564785003662
Epoch: 14, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7956914901733398
Epoch: 15, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 16 cost time: 1.109569787979126
Epoch: 16, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.004 Vali Acc: 0.568 Test Loss: 1.004 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0083982944488525
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9581401348114014
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9540226459503174
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0254571437835693
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.169553279876709
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9982333183288574
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0545690059661865
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 24 cost time: 1.0072672367095947
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 25 cost time: 0.939530611038208
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.071 Vali Acc: 0.622 Test Loss: 1.071 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.071805477142334
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.085 Vali Acc: 0.622 Test Loss: 1.085 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7698554992675781
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.100 Vali Acc: 0.595 Test Loss: 1.100 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.078277587890625
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.109 Vali Acc: 0.595 Test Loss: 1.109 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.961106538772583
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.121 Vali Acc: 0.595 Test Loss: 1.121 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.075420618057251
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.116 Vali Acc: 0.622 Test Loss: 1.116 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9145300388336182
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.132 Vali Acc: 0.595 Test Loss: 1.132 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.038989782333374
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.139 Vali Acc: 0.608 Test Loss: 1.139 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0854229927062988
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8526482582092285
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.148 Vali Acc: 0.595 Test Loss: 1.148 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 177956
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1827194690704346
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.8420004844665527
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.366 Vali Acc: 0.257 Test Loss: 1.366 Test Acc: 0.257
Validation loss decreased (-0.229716 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 0.655768871307373
Epoch: 3, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.340 Vali Acc: 0.405 Test Loss: 1.340 Test Acc: 0.405
Validation loss decreased (-0.256743 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.8498520851135254
Epoch: 4, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.313 Vali Acc: 0.459 Test Loss: 1.313 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 0.991417646408081
Epoch: 5, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.293 Vali Acc: 0.459 Test Loss: 1.293 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.874500036239624
Epoch: 6, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.9940955638885498
Epoch: 7, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.234 Vali Acc: 0.527 Test Loss: 1.234 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.0302536487579346
Epoch: 8, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9525854587554932
Epoch: 9, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8828115463256836
Epoch: 10, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 0.9200625419616699
Epoch: 11, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 0.9210770130157471
Epoch: 12, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 0.9439363479614258
Epoch: 13, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9206812381744385
Epoch: 14, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.083 Vali Acc: 0.527 Test Loss: 1.083 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8968725204467773
Epoch: 15, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 0.9072449207305908
Epoch: 16, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 17 cost time: 0.9944844245910645
Epoch: 17, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.080 Vali Acc: 0.514 Test Loss: 1.080 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9694597721099854
Epoch: 18, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.077 Vali Acc: 0.527 Test Loss: 1.077 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0017738342285156
Epoch: 19, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.074 Vali Acc: 0.541 Test Loss: 1.074 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9654650688171387
Epoch: 20, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9833841323852539
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8175032138824463
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9530243873596191
Epoch: 23, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 24 cost time: 0.8333258628845215
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9267127513885498
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.128 Vali Acc: 0.581 Test Loss: 1.128 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 26 cost time: 0.8840541839599609
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.027613639831543
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8668155670166016
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.133 Vali Acc: 0.568 Test Loss: 1.133 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9829139709472656
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.148 Vali Acc: 0.568 Test Loss: 1.148 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9566376209259033
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.162 Vali Acc: 0.581 Test Loss: 1.162 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9235234260559082
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.174 Vali Acc: 0.568 Test Loss: 1.174 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9882009029388428
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.185 Vali Acc: 0.581 Test Loss: 1.185 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9801828861236572
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.184 Vali Acc: 0.581 Test Loss: 1.184 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8278789520263672
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0677111148834229
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.199 Vali Acc: 0.568 Test Loss: 1.199 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 170916
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.037541389465332
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.385 Vali Acc: 0.243 Test Loss: 1.385 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9708621501922607
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.379 Vali Acc: 0.284 Test Loss: 1.379 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.82177734375
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.369 Vali Acc: 0.338 Test Loss: 1.369 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.9319815635681152
Epoch: 4, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.352 Vali Acc: 0.378 Test Loss: 1.352 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.8319449424743652
Epoch: 5, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.339 Vali Acc: 0.405 Test Loss: 1.339 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 0.8336348533630371
Epoch: 6, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.326 Vali Acc: 0.392 Test Loss: 1.326 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7674860954284668
Epoch: 7, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.309 Vali Acc: 0.405 Test Loss: 1.309 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 8 cost time: 0.6823303699493408
Epoch: 8, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.280 Vali Acc: 0.432 Test Loss: 1.280 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 0.8535819053649902
Epoch: 9, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 10 cost time: 0.7958881855010986
Epoch: 10, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.245 Vali Acc: 0.432 Test Loss: 1.245 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7428946495056152
Epoch: 11, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.78084397315979
Epoch: 12, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.221 Vali Acc: 0.446 Test Loss: 1.221 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 13 cost time: 0.7439925670623779
Epoch: 13, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.204 Vali Acc: 0.446 Test Loss: 1.204 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 14 cost time: 0.9285717010498047
Epoch: 14, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.9180364608764648
Epoch: 15, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.189 Vali Acc: 0.432 Test Loss: 1.189 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8222041130065918
Epoch: 16, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.181 Vali Acc: 0.432 Test Loss: 1.181 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9295339584350586
Epoch: 17, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.190 Vali Acc: 0.459 Test Loss: 1.190 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8867537975311279
Epoch: 18, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.179 Vali Acc: 0.446 Test Loss: 1.179 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9768393039703369
Epoch: 19, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5912208557128906
Epoch: 20, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9644267559051514
Epoch: 21, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.192 Vali Acc: 0.459 Test Loss: 1.192 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8661983013153076
Epoch: 22, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.215 Vali Acc: 0.459 Test Loss: 1.215 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9900569915771484
Epoch: 23, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8410336971282959
Epoch: 24, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.214 Vali Acc: 0.473 Test Loss: 1.214 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 166436
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2542741298675537
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.367 Vali Acc: 0.297 Test Loss: 1.367 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.9083919525146484
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.363 Vali Acc: 0.324 Test Loss: 1.363 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.9973471164703369
Epoch: 3, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.8839201927185059
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.9490792751312256
Epoch: 5, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.319 Vali Acc: 0.405 Test Loss: 1.319 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 0.8150177001953125
Epoch: 6, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.296 Vali Acc: 0.419 Test Loss: 1.296 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.8210151195526123
Epoch: 7, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 0.910214900970459
Epoch: 8, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.244 Vali Acc: 0.446 Test Loss: 1.244 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 0.980478048324585
Epoch: 9, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 0.9671087265014648
Epoch: 10, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.199 Vali Acc: 0.459 Test Loss: 1.199 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0185999870300293
Epoch: 11, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.176 Vali Acc: 0.486 Test Loss: 1.176 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 0.9531586170196533
Epoch: 12, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9213912487030029
Epoch: 13, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.145 Vali Acc: 0.459 Test Loss: 1.145 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8549237251281738
Epoch: 14, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.135 Vali Acc: 0.459 Test Loss: 1.135 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9612443447113037
Epoch: 15, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.132 Vali Acc: 0.473 Test Loss: 1.132 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9864850044250488
Epoch: 16, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.127 Vali Acc: 0.473 Test Loss: 1.127 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.082413911819458
Epoch: 17, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.119 Vali Acc: 0.459 Test Loss: 1.119 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9873354434967041
Epoch: 18, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 19 cost time: 0.9798290729522705
Epoch: 19, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.125 Vali Acc: 0.473 Test Loss: 1.125 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9745335578918457
Epoch: 20, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0064985752105713
Epoch: 21, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 22 cost time: 0.9188954830169678
Epoch: 22, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.145 Vali Acc: 0.514 Test Loss: 1.145 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.018873929977417
Epoch: 23, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.883004903793335
Epoch: 24, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9636349678039551
Epoch: 25, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8025293350219727
Epoch: 26, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 27 cost time: 0.7980179786682129
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8123507499694824
Epoch: 28, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9318432807922363
Epoch: 29, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7882494926452637
Epoch: 30, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8510575294494629
Epoch: 31, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9520728588104248
Epoch: 32, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0317192077636719
Epoch: 33, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.303 Vali Acc: 0.514 Test Loss: 1.303 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8594536781311035
Epoch: 34, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.320 Vali Acc: 0.486 Test Loss: 1.320 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9959611892700195
Epoch: 35, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.325 Vali Acc: 0.514 Test Loss: 1.325 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9228513240814209
Epoch: 36, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 164516
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.966691493988037
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.338 Vali Acc: 0.405 Test Loss: 1.338 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.7898519039154053
Epoch: 2, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.238 Vali Acc: 0.432 Test Loss: 1.238 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.551243543624878
Epoch: 3, Steps: 10 | Train Loss: 0.600 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.6920950412750244
Epoch: 4, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6808595657348633
Epoch: 5, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.353 Vali Acc: 0.527 Test Loss: 1.353 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527013).  Saving model ...
Epoch: 6 cost time: 1.704909324645996
Epoch: 6, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9131765365600586
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.702 Vali Acc: 0.486 Test Loss: 1.702 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7766833305358887
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.618 Vali Acc: 0.514 Test Loss: 1.618 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8151071071624756
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.527 Test Loss: 1.715 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9417564868927002
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.906 Vali Acc: 0.486 Test Loss: 1.906 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0042333602905273
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.891 Vali Acc: 0.486 Test Loss: 1.891 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.963273048400879
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.486 Test Loss: 1.862 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9060733318328857
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.500 Test Loss: 1.845 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6396121978759766
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.514 Test Loss: 1.840 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7992298603057861
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.527 Test Loss: 1.845 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2277764
model size : 8.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4777650833129883
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.371 Vali Acc: 0.351 Test Loss: 1.371 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.3654146194458008
Epoch: 2, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.279 Vali Acc: 0.392 Test Loss: 1.279 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.4776942729949951
Epoch: 3, Steps: 10 | Train Loss: 0.804 Vali Loss: 1.169 Vali Acc: 0.432 Test Loss: 1.169 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432421).  Saving model ...
Epoch: 4 cost time: 1.479640245437622
Epoch: 4, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.123 Vali Acc: 0.459 Test Loss: 1.123 Test Acc: 0.459
Validation loss decreased (-0.432421 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.3717963695526123
Epoch: 5, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.102 Vali Acc: 0.473 Test Loss: 1.102 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 6 cost time: 1.4946868419647217
Epoch: 6, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.472962 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.5214788913726807
Epoch: 7, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.2378249168395996
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.277 Vali Acc: 0.514 Test Loss: 1.277 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3091297149658203
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2919049263000488
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.326 Vali Acc: 0.514 Test Loss: 1.326 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4081082344055176
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.354 Vali Acc: 0.527 Test Loss: 1.354 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4380884170532227
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.366 Vali Acc: 0.514 Test Loss: 1.366 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.63812255859375
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.514 Test Loss: 1.376 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4368963241577148
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.514 Test Loss: 1.384 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5821642875671387
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5721774101257324
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.514 Test Loss: 1.401 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5799505710601807
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.527 Test Loss: 1.404 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 2074244
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6562862396240234
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.350 Vali Acc: 0.338 Test Loss: 1.350 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.491959810256958
Epoch: 2, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.273 Vali Acc: 0.446 Test Loss: 1.273 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.7112631797790527
Epoch: 3, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 1.4671614170074463
Epoch: 4, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.5896351337432861
Epoch: 5, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.3309893608093262
Epoch: 6, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.071 Vali Acc: 0.581 Test Loss: 1.071 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.4441838264465332
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.335134506225586
Epoch: 8, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4636569023132324
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.298917531967163
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.160 Vali Acc: 0.568 Test Loss: 1.160 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.210226058959961
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.223 Vali Acc: 0.568 Test Loss: 1.223 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1949033737182617
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.271 Vali Acc: 0.581 Test Loss: 1.271 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.450765609741211
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2127206325531006
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3257384300231934
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.264 Vali Acc: 0.568 Test Loss: 1.264 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5680458545684814
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.295 Vali Acc: 0.568 Test Loss: 1.295 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2003844
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.717388868331909
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.350 Vali Acc: 0.405 Test Loss: 1.350 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.7058687210083008
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.295 Vali Acc: 0.527 Test Loss: 1.295 Test Acc: 0.527
Validation loss decreased (-0.405392 --> -0.527014).  Saving model ...
Epoch: 3 cost time: 1.5622289180755615
Epoch: 3, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5076711177825928
Epoch: 4, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.149 Vali Acc: 0.541 Test Loss: 1.149 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.5936994552612305
Epoch: 5, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3771929740905762
Epoch: 6, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4197077751159668
Epoch: 7, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3489980697631836
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6868622303009033
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.623758316040039
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.227 Vali Acc: 0.554 Test Loss: 1.227 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.396193265914917
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.259 Vali Acc: 0.541 Test Loss: 1.259 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6445684432983398
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.270 Vali Acc: 0.554 Test Loss: 1.270 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4701883792877197
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.615490198135376
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.304 Vali Acc: 0.554 Test Loss: 1.304 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6505193710327148
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.313 Vali Acc: 0.554 Test Loss: 1.313 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4013144969940186
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.326 Vali Acc: 0.568 Test Loss: 1.326 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567554).  Saving model ...
Epoch: 17 cost time: 1.5270910263061523
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.355 Vali Acc: 0.554 Test Loss: 1.355 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3873908519744873
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.370 Vali Acc: 0.554 Test Loss: 1.370 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4748198986053467
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.382 Vali Acc: 0.554 Test Loss: 1.382 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4003899097442627
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.554 Test Loss: 1.394 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2920293807983398
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.405 Vali Acc: 0.554 Test Loss: 1.405 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.660555362701416
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.402 Vali Acc: 0.554 Test Loss: 1.402 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5065243244171143
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.416 Vali Acc: 0.554 Test Loss: 1.416 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5904111862182617
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.428 Vali Acc: 0.541 Test Loss: 1.428 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.548497200012207
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.450 Vali Acc: 0.554 Test Loss: 1.450 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.685863733291626
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.448 Vali Acc: 0.554 Test Loss: 1.448 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1974404
model size : 7.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.613590717315674
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.395 Vali Acc: 0.230 Test Loss: 1.395 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.2877256870269775
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.333 Vali Acc: 0.378 Test Loss: 1.333 Test Acc: 0.378
Validation loss decreased (-0.229716 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.4237184524536133
Epoch: 3, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.264 Vali Acc: 0.378 Test Loss: 1.264 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 1.4969849586486816
Epoch: 4, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.174 Vali Acc: 0.446 Test Loss: 1.174 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.1687400341033936
Epoch: 5, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.137 Vali Acc: 0.419 Test Loss: 1.137 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.252547025680542
Epoch: 6, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.4172987937927246
Epoch: 7, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.4163093566894531
Epoch: 8, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.067 Vali Acc: 0.568 Test Loss: 1.067 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.2817978858947754
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.4799494743347168
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5694122314453125
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5308682918548584
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4973289966583252
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5989155769348145
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.524395227432251
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.133 Vali Acc: 0.554 Test Loss: 1.133 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4324195384979248
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.319349765777588
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5851414203643799
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.171 Vali Acc: 0.554 Test Loss: 1.171 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3445689678192139
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.184 Vali Acc: 0.554 Test Loss: 1.184 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1946244
model size : 7.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4939591884613037
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.343 Vali Acc: 0.338 Test Loss: 1.343 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.3284022808074951
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.297 Vali Acc: 0.514 Test Loss: 1.297 Test Acc: 0.514
Validation loss decreased (-0.337824 --> -0.513501).  Saving model ...
Epoch: 3 cost time: 1.4396247863769531
Epoch: 3, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.231 Vali Acc: 0.446 Test Loss: 1.231 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3971540927886963
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3085157871246338
Epoch: 5, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.1820178031921387
Epoch: 6, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.085 Vali Acc: 0.527 Test Loss: 1.085 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.2484478950500488
Epoch: 7, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.031 Vali Acc: 0.595 Test Loss: 1.031 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 1.0698938369750977
Epoch: 8, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.008 Vali Acc: 0.554 Test Loss: 1.008 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2538611888885498
Epoch: 9, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.010 Vali Acc: 0.541 Test Loss: 1.010 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2169256210327148
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.021 Vali Acc: 0.581 Test Loss: 1.021 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3976261615753174
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.030 Vali Acc: 0.554 Test Loss: 1.030 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2572505474090576
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.051 Vali Acc: 0.554 Test Loss: 1.051 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3949573040008545
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3631973266601562
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2328424453735352
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.166170358657837
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1571190357208252
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1928324
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.558617115020752
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.371 Vali Acc: 0.270 Test Loss: 1.371 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.3630435466766357
Epoch: 2, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.325 Vali Acc: 0.392 Test Loss: 1.325 Test Acc: 0.392
Validation loss decreased (-0.270257 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.5218720436096191
Epoch: 3, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.250 Vali Acc: 0.486 Test Loss: 1.250 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.5106327533721924
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4668118953704834
Epoch: 5, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.428335428237915
Epoch: 6, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.105 Vali Acc: 0.486 Test Loss: 1.105 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.4365534782409668
Epoch: 7, Steps: 10 | Train Loss: 0.525 Vali Loss: 1.067 Vali Acc: 0.514 Test Loss: 1.067 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 1.4995663166046143
Epoch: 8, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.035 Vali Acc: 0.527 Test Loss: 1.035 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527017).  Saving model ...
Epoch: 9 cost time: 1.4888989925384521
Epoch: 9, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.021 Vali Acc: 0.541 Test Loss: 1.021 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.3705780506134033
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.026 Vali Acc: 0.554 Test Loss: 1.026 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 11 cost time: 1.5533816814422607
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594585).  Saving model ...
Epoch: 12 cost time: 1.4021575450897217
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.032 Vali Acc: 0.568 Test Loss: 1.032 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4422955513000488
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3614399433135986
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4150974750518799
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.065 Vali Acc: 0.568 Test Loss: 1.065 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2706193923950195
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.490471601486206
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3750560283660889
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3604421615600586
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.128 Vali Acc: 0.568 Test Loss: 1.128 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2399511337280273
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.141 Vali Acc: 0.568 Test Loss: 1.141 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4347915649414062
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.150 Vali Acc: 0.568 Test Loss: 1.150 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1920644
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2947707176208496
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.354 Vali Acc: 0.284 Test Loss: 1.354 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1340904235839844
Epoch: 2, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.262 Vali Acc: 0.486 Test Loss: 1.262 Test Acc: 0.486
Validation loss decreased (-0.283770 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.1141579151153564
Epoch: 3, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.2415430545806885
Epoch: 4, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
Validation loss decreased (-0.499989 --> -0.594583).  Saving model ...
Epoch: 5 cost time: 1.147282600402832
Epoch: 5, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.064 Vali Acc: 0.486 Test Loss: 1.064 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4049859046936035
Epoch: 6, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3310902118682861
Epoch: 7, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3642566204071045
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.199 Vali Acc: 0.608 Test Loss: 1.199 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 9 cost time: 1.3007416725158691
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4087817668914795
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.266 Vali Acc: 0.568 Test Loss: 1.266 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3349919319152832
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.276 Vali Acc: 0.568 Test Loss: 1.276 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.176633596420288
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.568 Test Loss: 1.291 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2014317512512207
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.568 Test Loss: 1.308 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2901201248168945
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.568 Test Loss: 1.327 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0796141624450684
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.554 Test Loss: 1.345 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1932072639465332
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.568 Test Loss: 1.353 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.118690013885498
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4268710613250732
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.568 Test Loss: 1.359 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 712900
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.231480598449707
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.370 Vali Acc: 0.419 Test Loss: 1.370 Test Acc: 0.419
Validation loss decreased (inf --> -0.418905).  Saving model ...
Epoch: 2 cost time: 1.074171781539917
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.305 Vali Acc: 0.419 Test Loss: 1.305 Test Acc: 0.419
Validation loss decreased (-0.418905 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9847819805145264
Epoch: 3, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.259 Vali Acc: 0.473 Test Loss: 1.259 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.8449323177337646
Epoch: 4, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
Validation loss decreased (-0.472960 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 0.9211993217468262
Epoch: 5, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.041761875152588
Epoch: 6, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.033479928970337
Epoch: 7, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.090 Vali Acc: 0.514 Test Loss: 1.090 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8948345184326172
Epoch: 8, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9949150085449219
Epoch: 9, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.074998378753662
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7515244483947754
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.171 Vali Acc: 0.554 Test Loss: 1.171 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1307933330535889
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0436351299285889
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.203 Vali Acc: 0.527 Test Loss: 1.203 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0717990398406982
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.212 Vali Acc: 0.541 Test Loss: 1.212 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9330325126647949
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2351727485656738
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.240 Vali Acc: 0.514 Test Loss: 1.240 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1573586463928223
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.243 Vali Acc: 0.527 Test Loss: 1.243 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0521161556243896
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.253 Vali Acc: 0.527 Test Loss: 1.253 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0912501811981201
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.269 Vali Acc: 0.514 Test Loss: 1.269 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 611140
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4005398750305176
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.383 Vali Acc: 0.189 Test Loss: 1.383 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.9789869785308838
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
Validation loss decreased (-0.189175 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.1213228702545166
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.279 Vali Acc: 0.392 Test Loss: 1.279 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.08976411819458
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.2002577781677246
Epoch: 5, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.0781011581420898
Epoch: 6, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.0992074012756348
Epoch: 7, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.1695432662963867
Epoch: 8, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.0301873683929443
Epoch: 9, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 10 cost time: 0.6536879539489746
Epoch: 10, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9939844608306885
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.037437915802002
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0158405303955078
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1747748851776123
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.200 Vali Acc: 0.541 Test Loss: 1.200 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 1.1031444072723389
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.223 Vali Acc: 0.514 Test Loss: 1.223 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1705787181854248
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.247 Vali Acc: 0.541 Test Loss: 1.247 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1060309410095215
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.256 Vali Acc: 0.541 Test Loss: 1.256 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1401660442352295
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.276 Vali Acc: 0.541 Test Loss: 1.276 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0789926052093506
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.279 Vali Acc: 0.541 Test Loss: 1.279 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.243513584136963
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0478448867797852
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9710445404052734
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.03578519821167
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.329 Vali Acc: 0.527 Test Loss: 1.329 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0691094398498535
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.336 Vali Acc: 0.541 Test Loss: 1.336 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 575940
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.453450918197632
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.389 Vali Acc: 0.257 Test Loss: 1.389 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0131568908691406
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.323 Vali Acc: 0.459 Test Loss: 1.323 Test Acc: 0.459
Validation loss decreased (-0.256743 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.966036319732666
Epoch: 3, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.0256412029266357
Epoch: 4, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.998568058013916
Epoch: 5, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.180 Vali Acc: 0.473 Test Loss: 1.180 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0286202430725098
Epoch: 6, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.141 Vali Acc: 0.473 Test Loss: 1.141 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9823660850524902
Epoch: 7, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.129 Vali Acc: 0.459 Test Loss: 1.129 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9856657981872559
Epoch: 8, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.092 Vali Acc: 0.514 Test Loss: 1.092 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513503).  Saving model ...
Epoch: 9 cost time: 1.0411176681518555
Epoch: 9, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.109 Vali Acc: 0.473 Test Loss: 1.109 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9649181365966797
Epoch: 10, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.113 Vali Acc: 0.486 Test Loss: 1.113 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1008272171020508
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0899605751037598
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.135 Vali Acc: 0.486 Test Loss: 1.135 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9313502311706543
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0536925792694092
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 1.028529167175293
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0066425800323486
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.953021764755249
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.196 Vali Acc: 0.486 Test Loss: 1.196 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1163361072540283
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.210 Vali Acc: 0.514 Test Loss: 1.210 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0211279392242432
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0957214832305908
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1260950565338135
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1274516582489014
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.265 Vali Acc: 0.486 Test Loss: 1.265 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9979426860809326
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.277 Vali Acc: 0.486 Test Loss: 1.277 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1252005100250244
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 561220
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0044379234313965
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.401 Vali Acc: 0.176 Test Loss: 1.401 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 0.8849339485168457
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.365 Vali Acc: 0.270 Test Loss: 1.365 Test Acc: 0.270
Validation loss decreased (-0.175662 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 0.9010138511657715
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.320 Vali Acc: 0.351 Test Loss: 1.320 Test Acc: 0.351
Validation loss decreased (-0.270257 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.0908656120300293
Epoch: 4, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.351338 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.1826820373535156
Epoch: 5, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 1.1373291015625
Epoch: 6, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.150 Vali Acc: 0.581 Test Loss: 1.150 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.0904979705810547
Epoch: 7, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 1.1455094814300537
Epoch: 8, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.068 Vali Acc: 0.541 Test Loss: 1.068 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0414855480194092
Epoch: 9, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 1.1052603721618652
Epoch: 10, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.031 Vali Acc: 0.568 Test Loss: 1.031 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1163945198059082
Epoch: 11, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.990 Vali Acc: 0.622 Test Loss: 0.990 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 1.0640332698822021
Epoch: 12, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.987 Vali Acc: 0.608 Test Loss: 0.987 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0196857452392578
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9131178855895996
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.976 Vali Acc: 0.608 Test Loss: 0.976 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0196952819824219
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0319342613220215
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1195807456970215
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.046 Vali Acc: 0.635 Test Loss: 1.046 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 18 cost time: 1.0637645721435547
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.068 Vali Acc: 0.622 Test Loss: 1.068 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1821284294128418
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.052 Vali Acc: 0.635 Test Loss: 1.052 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1647822856903076
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.062 Vali Acc: 0.635 Test Loss: 1.062 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0764663219451904
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.080 Vali Acc: 0.622 Test Loss: 1.080 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.08689284324646
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.102 Vali Acc: 0.635 Test Loss: 1.102 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1614885330200195
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.108 Vali Acc: 0.649 Test Loss: 1.108 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 24 cost time: 1.1426985263824463
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.110 Vali Acc: 0.635 Test Loss: 1.110 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0470104217529297
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.118 Vali Acc: 0.635 Test Loss: 1.118 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.167358160018921
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.132 Vali Acc: 0.635 Test Loss: 1.132 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1712229251861572
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.144 Vali Acc: 0.635 Test Loss: 1.144 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0966672897338867
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.150 Vali Acc: 0.622 Test Loss: 1.150 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.916325569152832
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.167 Vali Acc: 0.622 Test Loss: 1.167 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9630985260009766
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.172 Vali Acc: 0.622 Test Loss: 1.172 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1061878204345703
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.170 Vali Acc: 0.622 Test Loss: 1.170 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.152069330215454
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.192 Vali Acc: 0.608 Test Loss: 1.192 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.121971845626831
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.194 Vali Acc: 0.622 Test Loss: 1.194 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 547140
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3016321659088135
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.390 Vali Acc: 0.324 Test Loss: 1.390 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.0290405750274658
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.369 Vali Acc: 0.338 Test Loss: 1.369 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.1264784336090088
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.330 Vali Acc: 0.392 Test Loss: 1.330 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0392050743103027
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.301 Vali Acc: 0.365 Test Loss: 1.301 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8075387477874756
Epoch: 5, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.254 Vali Acc: 0.459 Test Loss: 1.254 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8949143886566162
Epoch: 6, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.8258895874023438
Epoch: 7, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.198 Vali Acc: 0.432 Test Loss: 1.198 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7568130493164062
Epoch: 8, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.177 Vali Acc: 0.419 Test Loss: 1.177 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9482190608978271
Epoch: 9, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.145 Vali Acc: 0.405 Test Loss: 1.145 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.927459716796875
Epoch: 10, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.114 Vali Acc: 0.459 Test Loss: 1.114 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 11 cost time: 0.8559455871582031
Epoch: 11, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.122 Vali Acc: 0.446 Test Loss: 1.122 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9085071086883545
Epoch: 12, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.111 Vali Acc: 0.473 Test Loss: 1.111 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 13 cost time: 0.886171817779541
Epoch: 13, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513503).  Saving model ...
Epoch: 14 cost time: 1.172023057937622
Epoch: 14, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.091 Vali Acc: 0.527 Test Loss: 1.091 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 1.0547902584075928
Epoch: 15, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0640788078308105
Epoch: 16, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 1.009277105331421
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 1.190129280090332
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1563165187835693
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9216291904449463
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.004603385925293
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0181200504302979
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.09220552444458
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.198 Vali Acc: 0.541 Test Loss: 1.198 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0834689140319824
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.03444242477417
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.210 Vali Acc: 0.527 Test Loss: 1.210 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.138310432434082
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.226 Vali Acc: 0.541 Test Loss: 1.226 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7384209632873535
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.232 Vali Acc: 0.527 Test Loss: 1.232 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 538180
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.324556589126587
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.379 Vali Acc: 0.338 Test Loss: 1.379 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.8963775634765625
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.352 Vali Acc: 0.432 Test Loss: 1.352 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.9550507068634033
Epoch: 3, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.313 Vali Acc: 0.486 Test Loss: 1.313 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 0.8683109283447266
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.9301104545593262
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.234 Vali Acc: 0.527 Test Loss: 1.234 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.0682651996612549
Epoch: 6, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0262725353240967
Epoch: 7, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0288853645324707
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.120 Vali Acc: 0.473 Test Loss: 1.120 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9363346099853516
Epoch: 9, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.100 Vali Acc: 0.486 Test Loss: 1.100 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.010932207107544
Epoch: 10, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.076 Vali Acc: 0.486 Test Loss: 1.076 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1008944511413574
Epoch: 11, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.064 Vali Acc: 0.486 Test Loss: 1.064 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9965000152587891
Epoch: 12, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.054 Vali Acc: 0.541 Test Loss: 1.054 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 13 cost time: 1.1607120037078857
Epoch: 13, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.050 Vali Acc: 0.500 Test Loss: 1.050 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0644216537475586
Epoch: 14, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.067 Vali Acc: 0.514 Test Loss: 1.067 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9881420135498047
Epoch: 15, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8493030071258545
Epoch: 16, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7745873928070068
Epoch: 17, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.117476463317871
Epoch: 18, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1377711296081543
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.144 Vali Acc: 0.527 Test Loss: 1.144 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0005440711975098
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8825342655181885
Epoch: 21, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.083686351776123
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.197 Vali Acc: 0.554 Test Loss: 1.197 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 23 cost time: 0.9350664615631104
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.937577486038208
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.223 Vali Acc: 0.514 Test Loss: 1.223 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9773826599121094
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.241 Vali Acc: 0.514 Test Loss: 1.241 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2026033401489258
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.259 Vali Acc: 0.541 Test Loss: 1.259 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.072295904159546
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.268 Vali Acc: 0.541 Test Loss: 1.268 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9765827655792236
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1297333240509033
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.294 Vali Acc: 0.514 Test Loss: 1.294 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9538121223449707
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.310 Vali Acc: 0.514 Test Loss: 1.310 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.965893030166626
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.319 Vali Acc: 0.514 Test Loss: 1.319 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0753748416900635
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.326 Vali Acc: 0.527 Test Loss: 1.326 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 534340
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0293726921081543
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.382 Vali Acc: 0.216 Test Loss: 1.382 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.8860173225402832
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.353 Vali Acc: 0.338 Test Loss: 1.353 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.0120065212249756
Epoch: 3, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.277 Vali Acc: 0.473 Test Loss: 1.277 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.9010398387908936
Epoch: 4, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.8915419578552246
Epoch: 5, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0552310943603516
Epoch: 6, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.7373690605163574
Epoch: 7, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.7638375759124756
Epoch: 8, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.7469401359558105
Epoch: 9, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.7894344329833984
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 0.745741605758667
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6640715599060059
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6863789558410645
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7017385959625244
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.221 Vali Acc: 0.527 Test Loss: 1.221 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7808420658111572
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.231 Vali Acc: 0.541 Test Loss: 1.231 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8426949977874756
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.254 Vali Acc: 0.541 Test Loss: 1.254 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8770391941070557
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.264 Vali Acc: 0.554 Test Loss: 1.264 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9617669582366943
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.268 Vali Acc: 0.554 Test Loss: 1.268 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8197846412658691
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.288 Vali Acc: 0.541 Test Loss: 1.288 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0184369087219238
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.293 Vali Acc: 0.541 Test Loss: 1.293 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 249956
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.18493390083313
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.387 Vali Acc: 0.216 Test Loss: 1.387 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.8382587432861328
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.356 Vali Acc: 0.311 Test Loss: 1.356 Test Acc: 0.311
Validation loss decreased (-0.216202 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.082148790359497
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
Validation loss decreased (-0.310797 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.9584412574768066
Epoch: 4, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8110315799713135
Epoch: 5, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.9778070449829102
Epoch: 6, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.8548274040222168
Epoch: 7, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.8029518127441406
Epoch: 8, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.8792550563812256
Epoch: 9, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.053 Vali Acc: 0.595 Test Loss: 1.053 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 0.9005413055419922
Epoch: 10, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8923134803771973
Epoch: 11, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.059 Vali Acc: 0.595 Test Loss: 1.059 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9589264392852783
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.048 Vali Acc: 0.595 Test Loss: 1.048 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 1.0670974254608154
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9575026035308838
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 0.8428256511688232
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.081 Vali Acc: 0.595 Test Loss: 1.081 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0607173442840576
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9601125717163086
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.105 Vali Acc: 0.622 Test Loss: 1.105 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 18 cost time: 0.8624563217163086
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.113 Vali Acc: 0.595 Test Loss: 1.113 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0664162635803223
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9810965061187744
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.131 Vali Acc: 0.608 Test Loss: 1.131 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9363820552825928
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.135 Vali Acc: 0.608 Test Loss: 1.135 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9406542778015137
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.145 Vali Acc: 0.608 Test Loss: 1.145 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9533829689025879
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.144 Vali Acc: 0.622 Test Loss: 1.144 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.084981918334961
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.160 Vali Acc: 0.622 Test Loss: 1.160 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8596718311309814
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.172 Vali Acc: 0.608 Test Loss: 1.172 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9172594547271729
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.172 Vali Acc: 0.608 Test Loss: 1.172 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9926586151123047
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.189 Vali Acc: 0.608 Test Loss: 1.189 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 199076
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.041522979736328
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.385 Vali Acc: 0.311 Test Loss: 1.385 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9891510009765625
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.364 Vali Acc: 0.297 Test Loss: 1.364 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9839980602264404
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.320 Vali Acc: 0.405 Test Loss: 1.320 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.928032636642456
Epoch: 4, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 0.9347593784332275
Epoch: 5, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.07124924659729
Epoch: 6, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.225 Vali Acc: 0.459 Test Loss: 1.225 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9608094692230225
Epoch: 7, Steps: 10 | Train Loss: 0.807 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.8551313877105713
Epoch: 8, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.9135973453521729
Epoch: 9, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.123 Vali Acc: 0.568 Test Loss: 1.123 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 0.835453987121582
Epoch: 10, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 1.0035076141357422
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.082 Vali Acc: 0.568 Test Loss: 1.082 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9821274280548096
Epoch: 12, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 13 cost time: 0.9189283847808838
Epoch: 13, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9156432151794434
Epoch: 14, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.079 Vali Acc: 0.595 Test Loss: 1.079 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2093851566314697
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.085 Vali Acc: 0.568 Test Loss: 1.085 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9296135902404785
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0449678897857666
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1290528774261475
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.926734447479248
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.158 Vali Acc: 0.541 Test Loss: 1.158 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8029701709747314
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0540814399719238
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.171 Vali Acc: 0.554 Test Loss: 1.171 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9760870933532715
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.177 Vali Acc: 0.541 Test Loss: 1.177 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 181476
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8432726860046387
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.6218717098236084
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.386 Vali Acc: 0.311 Test Loss: 1.386 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.6652834415435791
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.353 Vali Acc: 0.324 Test Loss: 1.353 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.6751642227172852
Epoch: 4, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.324 Vali Acc: 0.432 Test Loss: 1.324 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 0.812385082244873
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.283 Vali Acc: 0.473 Test Loss: 1.283 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 0.9701666831970215
Epoch: 6, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.255 Vali Acc: 0.459 Test Loss: 1.255 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7270469665527344
Epoch: 7, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.234 Vali Acc: 0.446 Test Loss: 1.234 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8566708564758301
Epoch: 8, Steps: 10 | Train Loss: 0.811 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 0.8633418083190918
Epoch: 9, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 0.8693296909332275
Epoch: 10, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 0.8373305797576904
Epoch: 11, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 0.6956565380096436
Epoch: 12, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 13 cost time: 0.9407424926757812
Epoch: 13, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7824869155883789
Epoch: 14, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 0.8978381156921387
Epoch: 15, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.041 Vali Acc: 0.541 Test Loss: 1.041 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7180230617523193
Epoch: 16, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9097158908843994
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.050 Vali Acc: 0.541 Test Loss: 1.050 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8062024116516113
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.045 Vali Acc: 0.595 Test Loss: 1.045 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 19 cost time: 0.8490715026855469
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9638993740081787
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.884070873260498
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.054 Vali Acc: 0.581 Test Loss: 1.054 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8670437335968018
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 23 cost time: 0.8329634666442871
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.082 Vali Acc: 0.595 Test Loss: 1.082 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9479701519012451
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8330824375152588
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9185428619384766
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.084 Vali Acc: 0.608 Test Loss: 1.084 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8986327648162842
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.093 Vali Acc: 0.595 Test Loss: 1.093 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8253436088562012
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.112 Vali Acc: 0.595 Test Loss: 1.112 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.721904993057251
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.106 Vali Acc: 0.595 Test Loss: 1.106 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7853338718414307
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7702827453613281
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.120 Vali Acc: 0.595 Test Loss: 1.120 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8272387981414795
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.133 Vali Acc: 0.581 Test Loss: 1.133 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 174116
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0293962955474854
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.384 Vali Acc: 0.392 Test Loss: 1.384 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.7794873714447021
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.379 Vali Acc: 0.311 Test Loss: 1.379 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8927817344665527
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.373 Vali Acc: 0.270 Test Loss: 1.373 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7560901641845703
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.370 Vali Acc: 0.311 Test Loss: 1.370 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.890110969543457
Epoch: 5, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.334 Vali Acc: 0.392 Test Loss: 1.334 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.755871057510376
Epoch: 6, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.308 Vali Acc: 0.419 Test Loss: 1.308 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.8543117046356201
Epoch: 7, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 0.793243408203125
Epoch: 8, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.238 Vali Acc: 0.419 Test Loss: 1.238 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8716998100280762
Epoch: 9, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.223 Vali Acc: 0.446 Test Loss: 1.223 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 0.8817758560180664
Epoch: 10, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.186 Vali Acc: 0.459 Test Loss: 1.186 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 11 cost time: 0.7763688564300537
Epoch: 11, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.8782331943511963
Epoch: 12, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 0.8281633853912354
Epoch: 13, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 0.7213435173034668
Epoch: 14, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.101 Vali Acc: 0.514 Test Loss: 1.101 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 15 cost time: 0.9406113624572754
Epoch: 15, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.088 Vali Acc: 0.527 Test Loss: 1.088 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 0.9318227767944336
Epoch: 16, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.090 Vali Acc: 0.541 Test Loss: 1.090 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 17 cost time: 0.9035515785217285
Epoch: 17, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.074 Vali Acc: 0.541 Test Loss: 1.074 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 18 cost time: 0.8341975212097168
Epoch: 18, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7898638248443604
Epoch: 19, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.082 Vali Acc: 0.527 Test Loss: 1.082 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9476995468139648
Epoch: 20, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.786637544631958
Epoch: 21, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.764768123626709
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8583948612213135
Epoch: 23, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6767644882202148
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.764812707901001
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9133636951446533
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 27 cost time: 1.0361747741699219
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.125 Vali Acc: 0.527 Test Loss: 1.125 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.968205451965332
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7975668907165527
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0354905128479004
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9473893642425537
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.013498306274414
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.035055160522461
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.170 Vali Acc: 0.568 Test Loss: 1.170 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 34 cost time: 0.9414668083190918
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8989572525024414
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9691150188446045
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.194 Vali Acc: 0.554 Test Loss: 1.194 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9539186954498291
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.192 Vali Acc: 0.554 Test Loss: 1.192 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.031022548675537
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.197 Vali Acc: 0.554 Test Loss: 1.197 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9549710750579834
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0060696601867676
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.213 Vali Acc: 0.554 Test Loss: 1.213 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.992828369140625
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.222 Vali Acc: 0.568 Test Loss: 1.222 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7883803844451904
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.231 Vali Acc: 0.568 Test Loss: 1.231 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8912358283996582
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.237 Vali Acc: 0.568 Test Loss: 1.237 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 167076
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3712406158447266
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.382 Vali Acc: 0.216 Test Loss: 1.382 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.9161970615386963
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.379 Vali Acc: 0.243 Test Loss: 1.379 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.0146358013153076
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.366 Vali Acc: 0.311 Test Loss: 1.366 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.0652194023132324
Epoch: 4, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.355 Vali Acc: 0.365 Test Loss: 1.355 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 0.9651713371276855
Epoch: 5, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.344 Vali Acc: 0.405 Test Loss: 1.344 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 1.0809383392333984
Epoch: 6, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.315 Vali Acc: 0.459 Test Loss: 1.315 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459446).  Saving model ...
Epoch: 7 cost time: 0.8296470642089844
Epoch: 7, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.305 Vali Acc: 0.459 Test Loss: 1.305 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459446).  Saving model ...
Epoch: 8 cost time: 0.9149820804595947
Epoch: 8, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.291 Vali Acc: 0.486 Test Loss: 1.291 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.0003631114959717
Epoch: 9, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.266 Vali Acc: 0.459 Test Loss: 1.266 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8958852291107178
Epoch: 10, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.0245180130004883
Epoch: 11, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.8572521209716797
Epoch: 12, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.016251802444458
Epoch: 13, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.999854326248169
Epoch: 14, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8649828433990479
Epoch: 15, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 0.957984209060669
Epoch: 16, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8027958869934082
Epoch: 17, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9312372207641602
Epoch: 18, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.169 Vali Acc: 0.473 Test Loss: 1.169 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8158843517303467
Epoch: 19, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8233981132507324
Epoch: 20, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.180 Vali Acc: 0.473 Test Loss: 1.180 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8827874660491943
Epoch: 21, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9137358665466309
Epoch: 22, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8971686363220215
Epoch: 23, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.203 Vali Acc: 0.473 Test Loss: 1.203 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9015507698059082
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9692137241363525
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 162596
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8527858257293701
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.373 Vali Acc: 0.243 Test Loss: 1.373 Test Acc: 0.243
Validation loss decreased (inf --> -0.243230).  Saving model ...
Epoch: 2 cost time: 0.7584023475646973
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (-0.243230 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.9133152961730957
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.354 Vali Acc: 0.338 Test Loss: 1.354 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.9330339431762695
Epoch: 4, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.335 Vali Acc: 0.365 Test Loss: 1.335 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.7503318786621094
Epoch: 5, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.316 Vali Acc: 0.392 Test Loss: 1.316 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.8728334903717041
Epoch: 6, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.294 Vali Acc: 0.459 Test Loss: 1.294 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.8840427398681641
Epoch: 7, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.0306980609893799
Epoch: 8, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.9219982624053955
Epoch: 9, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9983198642730713
Epoch: 10, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.8123979568481445
Epoch: 11, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.172 Vali Acc: 0.541 Test Loss: 1.172 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 1.1065735816955566
Epoch: 12, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.048006534576416
Epoch: 13, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.008887529373169
Epoch: 14, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.129 Vali Acc: 0.473 Test Loss: 1.129 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8573775291442871
Epoch: 15, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0026953220367432
Epoch: 16, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.98404860496521
Epoch: 17, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.103 Vali Acc: 0.514 Test Loss: 1.103 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9771041870117188
Epoch: 18, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0688016414642334
Epoch: 19, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8966906070709229
Epoch: 20, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.116 Vali Acc: 0.514 Test Loss: 1.116 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9112842082977295
Epoch: 21, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.101 Vali Acc: 0.527 Test Loss: 1.101 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 160676
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9096598625183105
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 1.9425725936889648
Epoch: 2, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.468 Vali Acc: 0.446 Test Loss: 1.468 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9382424354553223
Epoch: 3, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.369 Vali Acc: 0.473 Test Loss: 1.369 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472959).  Saving model ...
Epoch: 4 cost time: 1.601790428161621
Epoch: 4, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.507 Vali Acc: 0.500 Test Loss: 1.507 Test Acc: 0.500
Validation loss decreased (-0.472959 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 1.7236666679382324
Epoch: 5, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.766 Vali Acc: 0.527 Test Loss: 1.766 Test Acc: 0.527
Validation loss decreased (-0.499985 --> -0.527009).  Saving model ...
Epoch: 6 cost time: 1.9638235569000244
Epoch: 6, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.242 Vali Acc: 0.473 Test Loss: 2.242 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6265971660614014
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.675 Vali Acc: 0.473 Test Loss: 2.675 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.923917531967163
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.786 Vali Acc: 0.486 Test Loss: 2.786 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.881601095199585
Epoch: 9, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.435 Vali Acc: 0.459 Test Loss: 3.435 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7831330299377441
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.327 Vali Acc: 0.514 Test Loss: 3.327 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5043997764587402
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.147 Vali Acc: 0.432 Test Loss: 4.147 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.506805181503296
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.030 Vali Acc: 0.432 Test Loss: 4.030 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.526754379272461
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.994 Vali Acc: 0.459 Test Loss: 4.994 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4863605499267578
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.855 Vali Acc: 0.459 Test Loss: 4.855 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9887335300445557
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.023 Vali Acc: 0.459 Test Loss: 5.023 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2251524
model size : 8.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1318531036376953
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 1.1403565406799316
Epoch: 2, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.396 Vali Acc: 0.365 Test Loss: 1.396 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2396843433380127
Epoch: 3, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.162 Vali Acc: 0.581 Test Loss: 1.162 Test Acc: 0.581
Validation loss decreased (-0.445933 --> -0.581069).  Saving model ...
Epoch: 4 cost time: 1.292292833328247
Epoch: 4, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.391 Vali Acc: 0.473 Test Loss: 1.391 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2500512599945068
Epoch: 5, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.440 Vali Acc: 0.514 Test Loss: 1.440 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3787693977355957
Epoch: 6, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.619 Vali Acc: 0.527 Test Loss: 1.619 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.386413812637329
Epoch: 7, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.773 Vali Acc: 0.446 Test Loss: 1.773 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1484394073486328
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.509 Vali Acc: 0.541 Test Loss: 1.509 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4272410869598389
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.614 Vali Acc: 0.486 Test Loss: 1.614 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0273935794830322
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.869 Vali Acc: 0.459 Test Loss: 1.869 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2558112144470215
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.554 Test Loss: 1.614 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1695759296417236
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.568 Test Loss: 1.589 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2765767574310303
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.568 Test Loss: 1.602 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1844484
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2908692359924316
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.343 Vali Acc: 0.365 Test Loss: 1.343 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.1762340068817139
Epoch: 2, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.162 Vali Acc: 0.432 Test Loss: 1.162 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432421).  Saving model ...
Epoch: 3 cost time: 1.2155218124389648
Epoch: 3, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.073 Vali Acc: 0.527 Test Loss: 1.073 Test Acc: 0.527
Validation loss decreased (-0.432421 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 1.1748883724212646
Epoch: 4, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1946704387664795
Epoch: 5, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.1483790874481201
Epoch: 6, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.328 Vali Acc: 0.527 Test Loss: 1.328 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2857956886291504
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.237 Vali Acc: 0.527 Test Loss: 1.237 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0370290279388428
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.269 Vali Acc: 0.541 Test Loss: 1.269 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1290373802185059
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.581 Test Loss: 1.347 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581068).  Saving model ...
Epoch: 10 cost time: 1.0311710834503174
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.581 Test Loss: 1.331 Test Acc: 0.581
Validation loss decreased (-0.581068 --> -0.581068).  Saving model ...
Epoch: 11 cost time: 1.1535084247589111
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.304 Vali Acc: 0.541 Test Loss: 1.304 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2363905906677246
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.554 Test Loss: 1.309 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1543803215026855
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.541 Test Loss: 1.311 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.001314640045166
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.326 Vali Acc: 0.568 Test Loss: 1.326 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.14034104347229
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.554 Test Loss: 1.322 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0413169860839844
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.325 Vali Acc: 0.527 Test Loss: 1.325 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.015923261642456
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.326 Vali Acc: 0.527 Test Loss: 1.326 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0593383312225342
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.541 Test Loss: 1.331 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0805895328521729
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.541 Test Loss: 1.339 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2308847904205322
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.554 Test Loss: 1.344 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1703684
model size : 6.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0953826904296875
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.373 Vali Acc: 0.311 Test Loss: 1.373 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.116184949874878
Epoch: 2, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.261 Vali Acc: 0.419 Test Loss: 1.261 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9569368362426758
Epoch: 3, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.210 Vali Acc: 0.405 Test Loss: 1.210 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0550999641418457
Epoch: 4, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1853113174438477
Epoch: 5, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.183 Vali Acc: 0.459 Test Loss: 1.183 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.202951431274414
Epoch: 6, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.442 Vali Acc: 0.486 Test Loss: 1.442 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.196423053741455
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.221 Vali Acc: 0.527 Test Loss: 1.221 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.1986815929412842
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.208 Vali Acc: 0.568 Test Loss: 1.208 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567555).  Saving model ...
Epoch: 9 cost time: 1.285196304321289
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.260 Vali Acc: 0.554 Test Loss: 1.260 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1031203269958496
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.235 Vali Acc: 0.581 Test Loss: 1.235 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 1.2698726654052734
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.246 Vali Acc: 0.581 Test Loss: 1.246 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1039676666259766
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.254 Vali Acc: 0.541 Test Loss: 1.254 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.148045301437378
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.277 Vali Acc: 0.568 Test Loss: 1.277 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0522160530090332
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.568 Test Loss: 1.292 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1059107780456543
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.568 Test Loss: 1.282 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0787689685821533
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.554 Test Loss: 1.284 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2683939933776855
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.568 Test Loss: 1.301 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1260857582092285
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.568 Test Loss: 1.311 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0494513511657715
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.554 Test Loss: 1.307 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0937979221343994
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.541 Test Loss: 1.311 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1644804
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4066836833953857
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.357 Vali Acc: 0.311 Test Loss: 1.357 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0531017780303955
Epoch: 2, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.287 Vali Acc: 0.405 Test Loss: 1.287 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.1386632919311523
Epoch: 3, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.161 Vali Acc: 0.419 Test Loss: 1.161 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 0.9042837619781494
Epoch: 4, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
Validation loss decreased (-0.418907 --> -0.567557).  Saving model ...
Epoch: 5 cost time: 1.0692706108093262
Epoch: 5, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.143 Vali Acc: 0.486 Test Loss: 1.143 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0125863552093506
Epoch: 6, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.082 Vali Acc: 0.514 Test Loss: 1.082 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0078132152557373
Epoch: 7, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.152 Vali Acc: 0.568 Test Loss: 1.152 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2035841941833496
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.1003801822662354
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.104 Vali Acc: 0.608 Test Loss: 1.104 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 1.2251405715942383
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.133 Vali Acc: 0.622 Test Loss: 1.133 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 11 cost time: 1.053100347518921
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.147 Vali Acc: 0.595 Test Loss: 1.147 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2260563373565674
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.141 Vali Acc: 0.595 Test Loss: 1.141 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1468961238861084
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.143 Vali Acc: 0.595 Test Loss: 1.143 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2391400337219238
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.163 Vali Acc: 0.608 Test Loss: 1.163 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1478416919708252
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.174 Vali Acc: 0.608 Test Loss: 1.174 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1443698406219482
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.172 Vali Acc: 0.581 Test Loss: 1.172 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2009294033050537
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.175 Vali Acc: 0.581 Test Loss: 1.175 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.955082893371582
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.184 Vali Acc: 0.608 Test Loss: 1.184 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1556432247161865
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.186 Vali Acc: 0.608 Test Loss: 1.186 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9242000579833984
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.194 Vali Acc: 0.608 Test Loss: 1.194 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1578244
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0796730518341064
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.317 Vali Acc: 0.378 Test Loss: 1.317 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.0328800678253174
Epoch: 2, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
Validation loss decreased (-0.378365 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 1.0377545356750488
Epoch: 3, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 1.0242068767547607
Epoch: 4, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9395415782928467
Epoch: 5, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.034 Vali Acc: 0.595 Test Loss: 1.034 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 1.1360270977020264
Epoch: 6, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.109 Vali Acc: 0.473 Test Loss: 1.109 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1667523384094238
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.073 Vali Acc: 0.595 Test Loss: 1.073 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.113647222518921
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2144367694854736
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.079 Vali Acc: 0.554 Test Loss: 1.079 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1157970428466797
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8940606117248535
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.158616304397583
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8666467666625977
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.17903733253479
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1854636669158936
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.151 Vali Acc: 0.541 Test Loss: 1.151 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1552644
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3357431888580322
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.400 Vali Acc: 0.284 Test Loss: 1.400 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9815654754638672
Epoch: 2, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.310 Vali Acc: 0.405 Test Loss: 1.310 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.0252819061279297
Epoch: 3, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.192 Vali Acc: 0.405 Test Loss: 1.192 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.9407534599304199
Epoch: 4, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.153 Vali Acc: 0.432 Test Loss: 1.153 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432421).  Saving model ...
Epoch: 5 cost time: 1.0525460243225098
Epoch: 5, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.130 Vali Acc: 0.392 Test Loss: 1.130 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9366357326507568
Epoch: 6, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
Validation loss decreased (-0.432421 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.9984025955200195
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9625401496887207
Epoch: 8, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8923697471618652
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.020186424255371
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 0.9507489204406738
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.0321204662322998
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.188 Vali Acc: 0.527 Test Loss: 1.188 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 13 cost time: 0.9542572498321533
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.225 Vali Acc: 0.541 Test Loss: 1.225 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 14 cost time: 0.9987246990203857
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.216 Vali Acc: 0.527 Test Loss: 1.216 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8814384937286377
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9330587387084961
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.237 Vali Acc: 0.527 Test Loss: 1.237 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0358479022979736
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.268 Vali Acc: 0.541 Test Loss: 1.268 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7912194728851318
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9922621250152588
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9237911701202393
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9685299396514893
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.514 Test Loss: 1.294 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7566320896148682
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.297 Vali Acc: 0.541 Test Loss: 1.297 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.848097562789917
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.304 Vali Acc: 0.527 Test Loss: 1.304 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1537284
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.7798762321472168
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.322 Vali Acc: 0.432 Test Loss: 1.322 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 0.8445422649383545
Epoch: 2, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
Validation loss decreased (-0.432419 --> -0.554043).  Saving model ...
Epoch: 3 cost time: 0.73824143409729
Epoch: 3, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8228838443756104
Epoch: 4, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8935320377349854
Epoch: 5, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9514560699462891
Epoch: 6, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.354 Vali Acc: 0.486 Test Loss: 1.354 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1279876232147217
Epoch: 7, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.486 Test Loss: 1.354 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0154173374176025
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.473 Test Loss: 1.354 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8433196544647217
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.344 Vali Acc: 0.473 Test Loss: 1.344 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.186044692993164
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1007652282714844
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.486 Test Loss: 1.353 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.993607759475708
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.486 Test Loss: 1.355 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 798084
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0766806602478027
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.321 Vali Acc: 0.392 Test Loss: 1.321 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 0.9166586399078369
Epoch: 2, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.9027750492095947
Epoch: 3, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 0.9947967529296875
Epoch: 4, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.9264285564422607
Epoch: 5, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.081 Vali Acc: 0.527 Test Loss: 1.081 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8267288208007812
Epoch: 6, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.144 Vali Acc: 0.595 Test Loss: 1.144 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 7 cost time: 1.0340473651885986
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.161 Vali Acc: 0.568 Test Loss: 1.161 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0087387561798096
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.167 Vali Acc: 0.554 Test Loss: 1.167 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.798069953918457
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.196 Vali Acc: 0.554 Test Loss: 1.196 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0797832012176514
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.212 Vali Acc: 0.581 Test Loss: 1.212 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9043164253234863
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8759381771087646
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9276957511901855
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.248 Vali Acc: 0.568 Test Loss: 1.248 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9560878276824951
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.241 Vali Acc: 0.568 Test Loss: 1.241 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7007405757904053
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.568 Test Loss: 1.240 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8330767154693604
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.527 Test Loss: 1.240 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 594564
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.192661762237549
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.289 Vali Acc: 0.473 Test Loss: 1.289 Test Acc: 0.473
Validation loss decreased (inf --> -0.472960).  Saving model ...
Epoch: 2 cost time: 0.9802227020263672
Epoch: 2, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 0.9373929500579834
Epoch: 3, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 0.9375650882720947
Epoch: 4, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.066 Vali Acc: 0.514 Test Loss: 1.066 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.992588996887207
Epoch: 5, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.023 Vali Acc: 0.541 Test Loss: 1.023 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 0.9349234104156494
Epoch: 6, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 0.8987879753112793
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.951409101486206
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.101 Vali Acc: 0.527 Test Loss: 1.101 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.851193904876709
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9414970874786377
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.088 Vali Acc: 0.581 Test Loss: 1.088 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8281450271606445
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8770992755889893
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9534788131713867
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7997727394104004
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.119 Vali Acc: 0.554 Test Loss: 1.119 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7564413547515869
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8407750129699707
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 524164
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.5692667961120605
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.333 Vali Acc: 0.365 Test Loss: 1.333 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 0.5633912086486816
Epoch: 2, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.229 Vali Acc: 0.486 Test Loss: 1.229 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 0.7072725296020508
Epoch: 3, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 0.8089268207550049
Epoch: 4, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.076 Vali Acc: 0.541 Test Loss: 1.076 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 0.7998216152191162
Epoch: 5, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.078 Vali Acc: 0.568 Test Loss: 1.078 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 0.8228600025177002
Epoch: 6, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.058 Vali Acc: 0.554 Test Loss: 1.058 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.70027756690979
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6135179996490479
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8953783512115479
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.116 Vali Acc: 0.581 Test Loss: 1.116 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.0231623649597168
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.103 Vali Acc: 0.608 Test Loss: 1.103 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 0.9656023979187012
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8621151447296143
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.001288890838623
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9650747776031494
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9275434017181396
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.154 Vali Acc: 0.568 Test Loss: 1.154 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9427285194396973
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0406816005706787
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.154 Vali Acc: 0.568 Test Loss: 1.154 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9225027561187744
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.165 Vali Acc: 0.568 Test Loss: 1.165 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9242448806762695
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.178 Vali Acc: 0.568 Test Loss: 1.178 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7341160774230957
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.176 Vali Acc: 0.568 Test Loss: 1.176 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 494724
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.950666904449463
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.7137923240661621
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.8233346939086914
Epoch: 3, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
Validation loss decreased (-0.364852 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.765380859375
Epoch: 4, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.173 Vali Acc: 0.459 Test Loss: 1.173 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6987862586975098
Epoch: 5, Steps: 10 | Train Loss: 0.525 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 0.8910274505615234
Epoch: 6, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8304932117462158
Epoch: 7, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8325917720794678
Epoch: 8, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8587849140167236
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.050 Vali Acc: 0.568 Test Loss: 1.050 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.7577440738677979
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.069 Vali Acc: 0.568 Test Loss: 1.069 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9422149658203125
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6911914348602295
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8750286102294922
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9736597537994385
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8924064636230469
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8478879928588867
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.133 Vali Acc: 0.581 Test Loss: 1.133 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 1.0119261741638184
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.140 Vali Acc: 0.581 Test Loss: 1.140 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9565057754516602
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7513251304626465
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.903407096862793
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.152 Vali Acc: 0.581 Test Loss: 1.152 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9182097911834717
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.152 Vali Acc: 0.581 Test Loss: 1.152 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7560567855834961
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.964590311050415
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.167 Vali Acc: 0.581 Test Loss: 1.167 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9196527004241943
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.166 Vali Acc: 0.568 Test Loss: 1.166 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8399479389190674
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.173 Vali Acc: 0.568 Test Loss: 1.173 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8714749813079834
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.186 Vali Acc: 0.568 Test Loss: 1.186 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 461444
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9412846565246582
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.453 Vali Acc: 0.203 Test Loss: 1.453 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.718019962310791
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.412 Vali Acc: 0.284 Test Loss: 1.412 Test Acc: 0.284
Validation loss decreased (-0.202688 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.8456792831420898
Epoch: 3, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.337 Vali Acc: 0.378 Test Loss: 1.337 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.819096565246582
Epoch: 4, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.7168235778808594
Epoch: 5, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.207 Vali Acc: 0.446 Test Loss: 1.207 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7719802856445312
Epoch: 6, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.151 Vali Acc: 0.459 Test Loss: 1.151 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7790055274963379
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.743438720703125
Epoch: 8, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.113 Vali Acc: 0.486 Test Loss: 1.113 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8083088397979736
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.151 Vali Acc: 0.473 Test Loss: 1.151 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8011379241943359
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.7320890426635742
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7545969486236572
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8237295150756836
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9291605949401855
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.177 Vali Acc: 0.486 Test Loss: 1.177 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7566781044006348
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9559023380279541
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9665243625640869
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9283576011657715
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9440016746520996
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.035905122756958
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 448644
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9912712574005127
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.386 Vali Acc: 0.284 Test Loss: 1.386 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7481272220611572
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.338 Vali Acc: 0.324 Test Loss: 1.338 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.904726505279541
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.273 Vali Acc: 0.486 Test Loss: 1.273 Test Acc: 0.486
Validation loss decreased (-0.324311 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.9488930702209473
Epoch: 4, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7871387004852295
Epoch: 5, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.9091966152191162
Epoch: 6, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.144 Vali Acc: 0.568 Test Loss: 1.144 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 0.9540560245513916
Epoch: 7, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8944942951202393
Epoch: 8, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.114 Vali Acc: 0.527 Test Loss: 1.114 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9519288539886475
Epoch: 9, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9907310009002686
Epoch: 10, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.110 Vali Acc: 0.514 Test Loss: 1.110 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9188475608825684
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9794676303863525
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9916911125183105
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.126 Vali Acc: 0.527 Test Loss: 1.126 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8930628299713135
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9521875381469727
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0030465126037598
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 440964
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.015631914138794
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.339 Vali Acc: 0.297 Test Loss: 1.339 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.8363986015319824
Epoch: 2, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
Validation loss decreased (-0.297284 --> -0.513502).  Saving model ...
Epoch: 3 cost time: 0.8388688564300537
Epoch: 3, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.146 Vali Acc: 0.473 Test Loss: 1.146 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8031682968139648
Epoch: 4, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9074680805206299
Epoch: 5, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 0.9040169715881348
Epoch: 6, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.167 Vali Acc: 0.554 Test Loss: 1.167 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.046008825302124
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7268848419189453
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.284 Vali Acc: 0.527 Test Loss: 1.284 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8294122219085693
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.239 Vali Acc: 0.514 Test Loss: 1.239 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7694447040557861
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.252 Vali Acc: 0.541 Test Loss: 1.252 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7732968330383301
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6715781688690186
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.270 Vali Acc: 0.541 Test Loss: 1.270 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6835646629333496
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.267 Vali Acc: 0.554 Test Loss: 1.267 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7853567600250244
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.282 Vali Acc: 0.541 Test Loss: 1.282 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.802107572555542
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6862132549285889
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 317124
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8335022926330566
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.420 Vali Acc: 0.189 Test Loss: 1.420 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.7868883609771729
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.326 Vali Acc: 0.392 Test Loss: 1.326 Test Acc: 0.392
Validation loss decreased (-0.189175 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7665841579437256
Epoch: 3, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.270 Vali Acc: 0.432 Test Loss: 1.270 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.655693769454956
Epoch: 4, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.214 Vali Acc: 0.473 Test Loss: 1.214 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.7800557613372803
Epoch: 5, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.8480212688446045
Epoch: 6, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7573115825653076
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.181 Vali Acc: 0.459 Test Loss: 1.181 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8831436634063721
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.802919864654541
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7554686069488525
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7511212825775146
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.210 Vali Acc: 0.541 Test Loss: 1.210 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 0.8020238876342773
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 0.7273263931274414
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7376194000244141
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.205 Vali Acc: 0.581 Test Loss: 1.205 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 15 cost time: 0.751025915145874
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.209 Vali Acc: 0.568 Test Loss: 1.209 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7835726737976074
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.216 Vali Acc: 0.554 Test Loss: 1.216 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7334086894989014
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.224 Vali Acc: 0.554 Test Loss: 1.224 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6367621421813965
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.227 Vali Acc: 0.568 Test Loss: 1.227 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7498769760131836
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.234 Vali Acc: 0.554 Test Loss: 1.234 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7669470310211182
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.240 Vali Acc: 0.554 Test Loss: 1.240 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7155773639678955
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.244 Vali Acc: 0.554 Test Loss: 1.244 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7595696449279785
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.248 Vali Acc: 0.554 Test Loss: 1.248 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6689043045043945
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.255 Vali Acc: 0.554 Test Loss: 1.255 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8706185817718506
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.255 Vali Acc: 0.541 Test Loss: 1.255 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 215364
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.090749740600586
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.375 Vali Acc: 0.284 Test Loss: 1.375 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7465381622314453
Epoch: 2, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.303 Vali Acc: 0.419 Test Loss: 1.303 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.7800915241241455
Epoch: 3, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.236 Vali Acc: 0.473 Test Loss: 1.236 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.7634108066558838
Epoch: 4, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.7503514289855957
Epoch: 5, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.6700522899627686
Epoch: 6, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6039230823516846
Epoch: 7, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7051682472229004
Epoch: 8, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7727136611938477
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.085 Vali Acc: 0.568 Test Loss: 1.085 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.7788369655609131
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7975645065307617
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7834081649780273
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7918758392333984
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7438771724700928
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7592527866363525
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8318803310394287
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6702768802642822
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7015459537506104
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6988890171051025
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 180164
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8833630084991455
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.381 Vali Acc: 0.230 Test Loss: 1.381 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.6951310634613037
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.318 Vali Acc: 0.324 Test Loss: 1.318 Test Acc: 0.324
Validation loss decreased (-0.229716 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.7195990085601807
Epoch: 3, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
Validation loss decreased (-0.324311 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.640404224395752
Epoch: 4, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.7541079521179199
Epoch: 5, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.174 Vali Acc: 0.446 Test Loss: 1.174 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7814397811889648
Epoch: 6, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.7523555755615234
Epoch: 7, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7593965530395508
Epoch: 8, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7459225654602051
Epoch: 9, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.094 Vali Acc: 0.486 Test Loss: 1.094 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7442331314086914
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.082 Vali Acc: 0.581 Test Loss: 1.082 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 0.7365462779998779
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6762130260467529
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7265927791595459
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.097 Vali Acc: 0.595 Test Loss: 1.097 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 0.6963517665863037
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.121 Vali Acc: 0.595 Test Loss: 1.121 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6763825416564941
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.122 Vali Acc: 0.581 Test Loss: 1.122 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6788430213928223
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.125 Vali Acc: 0.581 Test Loss: 1.125 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7694034576416016
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.757523775100708
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.147 Vali Acc: 0.595 Test Loss: 1.147 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7788381576538086
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.150 Vali Acc: 0.581 Test Loss: 1.150 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7756173610687256
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.156 Vali Acc: 0.595 Test Loss: 1.156 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7667744159698486
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.765526533126831
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.167 Vali Acc: 0.595 Test Loss: 1.167 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8091201782226562
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.173 Vali Acc: 0.595 Test Loss: 1.173 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 165444
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9802978038787842
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.7180442810058594
Epoch: 2, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.316 Vali Acc: 0.365 Test Loss: 1.316 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.6894032955169678
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.255 Vali Acc: 0.446 Test Loss: 1.255 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.7354671955108643
Epoch: 4, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.159 Vali Acc: 0.554 Test Loss: 1.159 Test Acc: 0.554
Validation loss decreased (-0.445933 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 0.79229736328125
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.136 Vali Acc: 0.527 Test Loss: 1.136 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7432003021240234
Epoch: 6, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.100 Vali Acc: 0.486 Test Loss: 1.100 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7442014217376709
Epoch: 7, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.7226548194885254
Epoch: 8, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7348084449768066
Epoch: 9, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.040 Vali Acc: 0.527 Test Loss: 1.040 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7140862941741943
Epoch: 10, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.026 Vali Acc: 0.554 Test Loss: 1.026 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8517639636993408
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.042 Vali Acc: 0.514 Test Loss: 1.042 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8243222236633301
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.046 Vali Acc: 0.527 Test Loss: 1.046 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7919468879699707
Epoch: 13, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.009 Vali Acc: 0.581 Test Loss: 1.009 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7538237571716309
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.023 Vali Acc: 0.554 Test Loss: 1.023 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7381744384765625
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.042 Vali Acc: 0.568 Test Loss: 1.042 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7570176124572754
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.030 Vali Acc: 0.568 Test Loss: 1.030 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6726973056793213
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.030 Vali Acc: 0.568 Test Loss: 1.030 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 148804
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.949418067932129
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.432 Vali Acc: 0.189 Test Loss: 1.432 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.6871488094329834
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
Validation loss decreased (-0.189175 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.6904146671295166
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.367 Vali Acc: 0.365 Test Loss: 1.367 Test Acc: 0.365
Validation loss decreased (-0.243229 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.6737761497497559
Epoch: 4, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.332 Vali Acc: 0.419 Test Loss: 1.332 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.7353410720825195
Epoch: 5, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.256 Vali Acc: 0.405 Test Loss: 1.256 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.722052812576294
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.246 Vali Acc: 0.392 Test Loss: 1.246 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.769740104675293
Epoch: 7, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.207 Vali Acc: 0.405 Test Loss: 1.207 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.825230598449707
Epoch: 8, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.181 Vali Acc: 0.405 Test Loss: 1.181 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6796712875366211
Epoch: 9, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.167 Vali Acc: 0.419 Test Loss: 1.167 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 10 cost time: 0.8000147342681885
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.132 Vali Acc: 0.432 Test Loss: 1.132 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432421).  Saving model ...
Epoch: 11 cost time: 0.779346227645874
Epoch: 11, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.125 Vali Acc: 0.419 Test Loss: 1.125 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7881131172180176
Epoch: 12, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.111 Vali Acc: 0.446 Test Loss: 1.111 Test Acc: 0.446
Validation loss decreased (-0.432421 --> -0.445935).  Saving model ...
Epoch: 13 cost time: 0.7052903175354004
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.107 Vali Acc: 0.473 Test Loss: 1.107 Test Acc: 0.473
Validation loss decreased (-0.445935 --> -0.472962).  Saving model ...
Epoch: 14 cost time: 0.7006690502166748
Epoch: 14, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.097 Vali Acc: 0.486 Test Loss: 1.097 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486476).  Saving model ...
Epoch: 15 cost time: 0.7299973964691162
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6855247020721436
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
Validation loss decreased (-0.486476 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 0.7159178256988525
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.107 Vali Acc: 0.486 Test Loss: 1.107 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7234094142913818
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.126 Vali Acc: 0.473 Test Loss: 1.126 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6563689708709717
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.125 Vali Acc: 0.473 Test Loss: 1.125 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.75689697265625
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.122 Vali Acc: 0.459 Test Loss: 1.122 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7215061187744141
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.689523458480835
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.128 Vali Acc: 0.486 Test Loss: 1.128 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6435403823852539
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.153 Vali Acc: 0.486 Test Loss: 1.153 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7699592113494873
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.150 Vali Acc: 0.473 Test Loss: 1.150 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7218165397644043
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.150 Vali Acc: 0.473 Test Loss: 1.150 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6941845417022705
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.160 Vali Acc: 0.527 Test Loss: 1.160 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 27 cost time: 0.6231133937835693
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8016180992126465
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7601451873779297
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7292056083679199
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7418253421783447
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7219727039337158
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7153475284576416
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7044179439544678
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7940783500671387
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8167359828948975
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 142404
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2124974727630615
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.670140266418457
Epoch: 2, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.361 Vali Acc: 0.338 Test Loss: 1.361 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.6383466720581055
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.332 Vali Acc: 0.351 Test Loss: 1.332 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.6832935810089111
Epoch: 4, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.285 Vali Acc: 0.419 Test Loss: 1.285 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.882962703704834
Epoch: 5, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.238 Vali Acc: 0.432 Test Loss: 1.238 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.8111550807952881
Epoch: 6, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 0.7778940200805664
Epoch: 7, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.7234165668487549
Epoch: 8, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.9440178871154785
Epoch: 9, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 0.6928610801696777
Epoch: 10, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.113 Vali Acc: 0.486 Test Loss: 1.113 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6696059703826904
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.138 Vali Acc: 0.486 Test Loss: 1.138 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7741134166717529
Epoch: 12, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.8644516468048096
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7175471782684326
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 0.8498187065124512
Epoch: 15, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6266400814056396
Epoch: 16, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6581971645355225
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8983051776885986
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6561243534088135
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7846274375915527
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8518576622009277
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8466300964355469
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6734886169433594
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7313776016235352
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 138564
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1518986225128174
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.326 Vali Acc: 0.419 Test Loss: 1.326 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 0.7982096672058105
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.263 Vali Acc: 0.473 Test Loss: 1.263 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.7330150604248047
Epoch: 3, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.209 Vali Acc: 0.405 Test Loss: 1.209 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8261165618896484
Epoch: 4, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.107 Vali Acc: 0.527 Test Loss: 1.107 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 0.9205315113067627
Epoch: 5, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.094 Vali Acc: 0.581 Test Loss: 1.094 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.9009649753570557
Epoch: 6, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.063 Vali Acc: 0.527 Test Loss: 1.063 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.789198637008667
Epoch: 7, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7906386852264404
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8923845291137695
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7996816635131836
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7583537101745605
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7146890163421631
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8455610275268555
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.154 Vali Acc: 0.554 Test Loss: 1.154 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7784748077392578
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.149 Vali Acc: 0.541 Test Loss: 1.149 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7949554920196533
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 138084
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0982015132904053
Epoch: 1, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.339 Vali Acc: 0.392 Test Loss: 1.339 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 0.8935866355895996
Epoch: 2, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.298 Vali Acc: 0.405 Test Loss: 1.298 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.8775742053985596
Epoch: 3, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.236 Vali Acc: 0.432 Test Loss: 1.236 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.7823631763458252
Epoch: 4, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.7212920188903809
Epoch: 5, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.133 Vali Acc: 0.568 Test Loss: 1.133 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.7548151016235352
Epoch: 6, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.128 Vali Acc: 0.581 Test Loss: 1.128 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 0.7997546195983887
Epoch: 7, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7554836273193359
Epoch: 8, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7311136722564697
Epoch: 9, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 0.7382218837738037
Epoch: 10, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.078 Vali Acc: 0.581 Test Loss: 1.078 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9254319667816162
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7524890899658203
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.752924919128418
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6524872779846191
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6993410587310791
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7339432239532471
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.097 Vali Acc: 0.568 Test Loss: 1.097 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8296141624450684
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.915475606918335
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6572930812835693
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 87204
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.340362071990967
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.7238588333129883
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.357 Vali Acc: 0.297 Test Loss: 1.357 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.9234943389892578
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.309 Vali Acc: 0.365 Test Loss: 1.309 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.8341999053955078
Epoch: 4, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.248 Vali Acc: 0.473 Test Loss: 1.248 Test Acc: 0.473
Validation loss decreased (-0.364852 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 0.6742382049560547
Epoch: 5, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 0.9671316146850586
Epoch: 6, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7543003559112549
Epoch: 7, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.7620220184326172
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.9616498947143555
Epoch: 9, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.8236100673675537
Epoch: 10, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.882817268371582
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8173010349273682
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0463361740112305
Epoch: 13, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.060 Vali Acc: 0.527 Test Loss: 1.060 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8563888072967529
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.059 Vali Acc: 0.554 Test Loss: 1.059 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8261866569519043
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8116025924682617
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.062 Vali Acc: 0.541 Test Loss: 1.062 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8659846782684326
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.068 Vali Acc: 0.541 Test Loss: 1.068 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9057519435882568
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 1.0082919597625732
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6443474292755127
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8003120422363281
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7255613803863525
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7293257713317871
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.074 Vali Acc: 0.568 Test Loss: 1.074 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7904355525970459
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.786456823348999
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.092 Vali Acc: 0.568 Test Loss: 1.092 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.835679292678833
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7941741943359375
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9772818088531494
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 69604
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.740772247314453
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.441 Vali Acc: 0.257 Test Loss: 1.441 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.750758171081543
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8524479866027832
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.363 Vali Acc: 0.311 Test Loss: 1.363 Test Acc: 0.311
Validation loss decreased (-0.256742 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.8976733684539795
Epoch: 4, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.310 Vali Acc: 0.338 Test Loss: 1.310 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 0.8339633941650391
Epoch: 5, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.280 Vali Acc: 0.351 Test Loss: 1.280 Test Acc: 0.351
Validation loss decreased (-0.337825 --> -0.351339).  Saving model ...
Epoch: 6 cost time: 1.0842390060424805
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.223 Vali Acc: 0.419 Test Loss: 1.223 Test Acc: 0.419
Validation loss decreased (-0.351339 --> -0.418907).  Saving model ...
Epoch: 7 cost time: 0.8058733940124512
Epoch: 7, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.215 Vali Acc: 0.432 Test Loss: 1.215 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 0.8019137382507324
Epoch: 8, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.186 Vali Acc: 0.432 Test Loss: 1.186 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432421).  Saving model ...
Epoch: 9 cost time: 0.7153942584991455
Epoch: 9, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.152 Vali Acc: 0.432 Test Loss: 1.152 Test Acc: 0.432
Validation loss decreased (-0.432421 --> -0.432421).  Saving model ...
Epoch: 10 cost time: 0.7803633213043213
Epoch: 10, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.138 Vali Acc: 0.459 Test Loss: 1.138 Test Acc: 0.459
Validation loss decreased (-0.432421 --> -0.459448).  Saving model ...
Epoch: 11 cost time: 0.797471284866333
Epoch: 11, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.119 Vali Acc: 0.486 Test Loss: 1.119 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 0.8187191486358643
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.116 Vali Acc: 0.473 Test Loss: 1.116 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8178963661193848
Epoch: 13, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 0.9168388843536377
Epoch: 14, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.0178899765014648
Epoch: 15, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 0.9227926731109619
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8037927150726318
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7962076663970947
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9673707485198975
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.121 Vali Acc: 0.514 Test Loss: 1.121 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9265801906585693
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0938987731933594
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.125 Vali Acc: 0.527 Test Loss: 1.125 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9584357738494873
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0916810035705566
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.956951379776001
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8349807262420654
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps40_str20_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 62244
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.468782901763916
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.456 Vali Acc: 0.149 Test Loss: 1.456 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 0.9751522541046143
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.430 Vali Acc: 0.216 Test Loss: 1.430 Test Acc: 0.216
Validation loss decreased (-0.148634 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 0.8924970626831055
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (-0.216202 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 0.8771152496337891
Epoch: 4, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.353 Vali Acc: 0.324 Test Loss: 1.353 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.070840835571289
Epoch: 5, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.327 Vali Acc: 0.392 Test Loss: 1.327 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.9441256523132324
Epoch: 6, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.293 Vali Acc: 0.392 Test Loss: 1.293 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 0.8500804901123047
Epoch: 7, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.267 Vali Acc: 0.405 Test Loss: 1.267 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 8 cost time: 0.8717737197875977
Epoch: 8, Steps: 10 | Train Loss: 0.772 Vali Loss: 1.231 Vali Acc: 0.405 Test Loss: 1.231 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 9 cost time: 0.9621820449829102
Epoch: 9, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.220 Vali Acc: 0.405 Test Loss: 1.220 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 10 cost time: 0.9936814308166504
Epoch: 10, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.195 Vali Acc: 0.432 Test Loss: 1.195 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 11 cost time: 0.8842432498931885
Epoch: 11, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 12 cost time: 0.8280622959136963
Epoch: 12, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.181 Vali Acc: 0.473 Test Loss: 1.181 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 13 cost time: 0.9751405715942383
Epoch: 13, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 14 cost time: 0.8414003849029541
Epoch: 14, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9502549171447754
Epoch: 15, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.155 Vali Acc: 0.473 Test Loss: 1.155 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9613924026489258
Epoch: 16, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.148 Vali Acc: 0.473 Test Loss: 1.148 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 17 cost time: 1.015476942062378
Epoch: 17, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 18 cost time: 1.1107938289642334
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 19 cost time: 0.9266419410705566
Epoch: 19, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9660360813140869
Epoch: 20, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9112787246704102
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8659317493438721
Epoch: 22, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8010551929473877
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8207335472106934
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8791773319244385
Epoch: 25, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 26 cost time: 0.9420592784881592
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8806056976318359
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0051627159118652
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9426624774932861
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.991492748260498
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9355604648590088
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8564615249633789
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9656739234924316
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.080509901046753
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9661610126495361
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 53924
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.820531129837036
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.9500980377197266
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.367 Vali Acc: 0.338 Test Loss: 1.367 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.999579906463623
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.333 Vali Acc: 0.419 Test Loss: 1.333 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.8435213565826416
Epoch: 4, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.321 Vali Acc: 0.351 Test Loss: 1.321 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8927741050720215
Epoch: 5, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.277 Vali Acc: 0.405 Test Loss: 1.277 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.830744743347168
Epoch: 6, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.239 Vali Acc: 0.446 Test Loss: 1.239 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.8655502796173096
Epoch: 7, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.209 Vali Acc: 0.432 Test Loss: 1.209 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0431485176086426
Epoch: 8, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.0453979969024658
Epoch: 9, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0143249034881592
Epoch: 10, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0028033256530762
Epoch: 11, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.111 Vali Acc: 0.514 Test Loss: 1.111 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9152565002441406
Epoch: 12, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.075 Vali Acc: 0.514 Test Loss: 1.075 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9758641719818115
Epoch: 13, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.087 Vali Acc: 0.486 Test Loss: 1.087 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8835272789001465
Epoch: 14, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.042942762374878
Epoch: 15, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.041 Vali Acc: 0.527 Test Loss: 1.041 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527017).  Saving model ...
Epoch: 16 cost time: 0.8489646911621094
Epoch: 16, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.047 Vali Acc: 0.514 Test Loss: 1.047 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9610438346862793
Epoch: 17, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.056 Vali Acc: 0.514 Test Loss: 1.056 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0899910926818848
Epoch: 18, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.044 Vali Acc: 0.500 Test Loss: 1.044 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8589622974395752
Epoch: 19, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.043 Vali Acc: 0.500 Test Loss: 1.043 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7914295196533203
Epoch: 20, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.044 Vali Acc: 0.541 Test Loss: 1.044 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540530).  Saving model ...
Epoch: 21 cost time: 0.8634912967681885
Epoch: 21, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.046 Vali Acc: 0.500 Test Loss: 1.046 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0216624736785889
Epoch: 22, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.042 Vali Acc: 0.527 Test Loss: 1.042 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0018272399902344
Epoch: 23, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.059 Vali Acc: 0.527 Test Loss: 1.059 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8582990169525146
Epoch: 24, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.066 Vali Acc: 0.527 Test Loss: 1.066 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0266308784484863
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.060 Vali Acc: 0.527 Test Loss: 1.060 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.940654993057251
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.075 Vali Acc: 0.527 Test Loss: 1.075 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9988327026367188
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9817166328430176
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0124750137329102
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.083 Vali Acc: 0.541 Test Loss: 1.083 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.19773530960083
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.094 Vali Acc: 0.527 Test Loss: 1.094 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps80_str40_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 50724
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7895991802215576
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.421 Vali Acc: 0.311 Test Loss: 1.421 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9541506767272949
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.409 Vali Acc: 0.351 Test Loss: 1.409 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 0.8177223205566406
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.377 Vali Acc: 0.405 Test Loss: 1.377 Test Acc: 0.405
Validation loss decreased (-0.351337 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.9480123519897461
Epoch: 4, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.349 Vali Acc: 0.405 Test Loss: 1.349 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.0434553623199463
Epoch: 5, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.322 Vali Acc: 0.446 Test Loss: 1.322 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.7925968170166016
Epoch: 6, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.291 Vali Acc: 0.473 Test Loss: 1.291 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 0.7823729515075684
Epoch: 7, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.7543840408325195
Epoch: 8, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.246 Vali Acc: 0.473 Test Loss: 1.246 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6323549747467041
Epoch: 9, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.8032169342041016
Epoch: 10, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9754588603973389
Epoch: 11, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.920161247253418
Epoch: 12, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9824919700622559
Epoch: 13, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.158 Vali Acc: 0.486 Test Loss: 1.158 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0613644123077393
Epoch: 14, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.139 Vali Acc: 0.473 Test Loss: 1.139 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9767680168151855
Epoch: 15, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0043957233428955
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.136 Vali Acc: 0.473 Test Loss: 1.136 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8456404209136963
Epoch: 17, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.121 Vali Acc: 0.473 Test Loss: 1.121 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0056934356689453
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.118 Vali Acc: 0.486 Test Loss: 1.118 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9639596939086914
Epoch: 19, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ModernTCN_UEA_ftM_sl400_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps100_str50_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 48804
model size : 0.20MB
